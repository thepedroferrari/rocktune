2026-01-11T19:27:57.4108537Z Current runner version: '2.330.0'
2026-01-11T19:27:57.4133592Z ##[group]Runner Image Provisioner
2026-01-11T19:27:57.4134358Z Hosted Compute Agent
2026-01-11T19:27:57.4134898Z Version: 20251211.462
2026-01-11T19:27:57.4135437Z Commit: 6cbad8c2bb55d58165063d031ccabf57e2d2db61
2026-01-11T19:27:57.4136099Z Build Date: 2025-12-11T16:28:49Z
2026-01-11T19:27:57.4136687Z Worker ID: {55bf81a1-7ce9-45f0-b6dd-f3a98129a21f}
2026-01-11T19:27:57.4137329Z ##[endgroup]
2026-01-11T19:27:57.4137796Z ##[group]Operating System
2026-01-11T19:27:57.4138380Z Microsoft Windows Server 2025
2026-01-11T19:27:57.4138917Z 10.0.26100
2026-01-11T19:27:57.4139310Z Datacenter
2026-01-11T19:27:57.4140097Z ##[endgroup]
2026-01-11T19:27:57.4140528Z ##[group]Runner Image
2026-01-11T19:27:57.4141021Z Image: windows-2025
2026-01-11T19:27:57.4141563Z Version: 20260105.172.1
2026-01-11T19:27:57.4143569Z Included Software: https://github.com/actions/runner-images/blob/win25/20260105.172/images/windows/Windows2025-Readme.md
2026-01-11T19:27:57.4146283Z Image Release: https://github.com/actions/runner-images/releases/tag/win25%2F20260105.172
2026-01-11T19:27:57.4147878Z ##[endgroup]
2026-01-11T19:27:57.4149657Z ##[group]GITHUB_TOKEN Permissions
2026-01-11T19:27:57.4152107Z Contents: read
2026-01-11T19:27:57.4152915Z Metadata: read
2026-01-11T19:27:57.4153624Z Packages: read
2026-01-11T19:27:57.4154396Z ##[endgroup]
2026-01-11T19:27:57.4157124Z Secret source: Actions
2026-01-11T19:27:57.4158152Z Prepare workflow directory
2026-01-11T19:27:57.4592427Z Prepare all required actions
2026-01-11T19:27:57.4649863Z Getting action download info
2026-01-11T19:27:57.6767170Z Download action repository 'actions/checkout@v4' (SHA:34e114876b0b11c390a56381ad16ebd13914f8d5)
2026-01-11T19:27:57.9259976Z Complete job name: Validate PowerShell Modules
2026-01-11T19:27:58.0688837Z ##[group]Run actions/checkout@v4
2026-01-11T19:27:58.0690000Z with:
2026-01-11T19:27:58.0690464Z   repository: thepedroferrari/rocktune
2026-01-11T19:27:58.0691277Z   token: ***
2026-01-11T19:27:58.0691646Z   ssh-strict: true
2026-01-11T19:27:58.0692013Z   ssh-user: git
2026-01-11T19:27:58.0692383Z   persist-credentials: true
2026-01-11T19:27:58.0692861Z   clean: true
2026-01-11T19:27:58.0693237Z   sparse-checkout-cone-mode: true
2026-01-11T19:27:58.0693697Z   fetch-depth: 1
2026-01-11T19:27:58.0694054Z   fetch-tags: false
2026-01-11T19:27:58.0694423Z   show-progress: true
2026-01-11T19:27:58.0694800Z   lfs: false
2026-01-11T19:27:58.0695129Z   submodules: false
2026-01-11T19:27:58.0695501Z   set-safe-directory: true
2026-01-11T19:27:58.0696115Z ##[endgroup]
2026-01-11T19:27:58.2422978Z Syncing repository: thepedroferrari/rocktune
2026-01-11T19:27:58.2424798Z ##[group]Getting Git version info
2026-01-11T19:27:58.2425476Z Working directory is 'D:\a\rocktune\rocktune'
2026-01-11T19:27:58.3576254Z [command]"C:\Program Files\Git\bin\git.exe" version
2026-01-11T19:27:58.7409450Z git version 2.52.0.windows.1
2026-01-11T19:27:58.7466443Z ##[endgroup]
2026-01-11T19:27:58.7487914Z Temporarily overriding HOME='D:\a\_temp\98d10639-33c5-4aa3-aba9-571d0985b1b6' before making global git config changes
2026-01-11T19:27:58.7489476Z Adding repository directory to the temporary git global config as a safe directory
2026-01-11T19:27:58.7500140Z [command]"C:\Program Files\Git\bin\git.exe" config --global --add safe.directory D:\a\rocktune\rocktune
2026-01-11T19:27:58.8156603Z Deleting the contents of 'D:\a\rocktune\rocktune'
2026-01-11T19:27:58.8163391Z ##[group]Initializing the repository
2026-01-11T19:27:58.8173608Z [command]"C:\Program Files\Git\bin\git.exe" init D:\a\rocktune\rocktune
2026-01-11T19:27:58.9186420Z Initialized empty Git repository in D:/a/rocktune/rocktune/.git/
2026-01-11T19:27:58.9235886Z [command]"C:\Program Files\Git\bin\git.exe" remote add origin https://github.com/thepedroferrari/rocktune
2026-01-11T19:27:58.9876526Z ##[endgroup]
2026-01-11T19:27:58.9877992Z ##[group]Disabling automatic garbage collection
2026-01-11T19:27:58.9879577Z [command]"C:\Program Files\Git\bin\git.exe" config --local gc.auto 0
2026-01-11T19:27:59.0163792Z ##[endgroup]
2026-01-11T19:27:59.0165534Z ##[group]Setting up auth
2026-01-11T19:27:59.0177436Z [command]"C:\Program Files\Git\bin\git.exe" config --local --name-only --get-regexp core\.sshCommand
2026-01-11T19:27:59.0530724Z [command]"C:\Program Files\Git\bin\git.exe" submodule foreach --recursive "sh -c \"git config --local --name-only --get-regexp 'core\.sshCommand' && git config --local --unset-all 'core.sshCommand' || :\""
2026-01-11T19:28:00.6176595Z [command]"C:\Program Files\Git\bin\git.exe" config --local --name-only --get-regexp http\.https\:\/\/github\.com\/\.extraheader
2026-01-11T19:28:00.6490341Z [command]"C:\Program Files\Git\bin\git.exe" submodule foreach --recursive "sh -c \"git config --local --name-only --get-regexp 'http\.https\:\/\/github\.com\/\.extraheader' && git config --local --unset-all 'http.https://github.com/.extraheader' || :\""
2026-01-11T19:28:01.1908944Z [command]"C:\Program Files\Git\bin\git.exe" config --local --name-only --get-regexp ^includeIf\.gitdir:
2026-01-11T19:28:01.2220922Z [command]"C:\Program Files\Git\bin\git.exe" submodule foreach --recursive "git config --local --show-origin --name-only --get-regexp remote.origin.url"
2026-01-11T19:28:01.7623162Z [command]"C:\Program Files\Git\bin\git.exe" config --local http.https://github.com/.extraheader "AUTHORIZATION: basic ***"
2026-01-11T19:28:01.7940564Z ##[endgroup]
2026-01-11T19:28:01.7941193Z ##[group]Fetching the repository
2026-01-11T19:28:01.7953970Z [command]"C:\Program Files\Git\bin\git.exe" -c protocol.version=2 fetch --no-tags --prune --no-recurse-submodules --depth=1 origin +1cdf7fc6aca4f84a8b253d9fcbd656730b2297be:refs/remotes/origin/master
2026-01-11T19:28:02.8698145Z From https://github.com/thepedroferrari/rocktune
2026-01-11T19:28:02.8699082Z  * [new ref]         1cdf7fc6aca4f84a8b253d9fcbd656730b2297be -> origin/master
2026-01-11T19:28:02.9010661Z ##[endgroup]
2026-01-11T19:28:02.9011172Z ##[group]Determining the checkout info
2026-01-11T19:28:02.9013890Z ##[endgroup]
2026-01-11T19:28:02.9029412Z [command]"C:\Program Files\Git\bin\git.exe" sparse-checkout disable
2026-01-11T19:28:02.9494059Z [command]"C:\Program Files\Git\bin\git.exe" config --local --unset-all extensions.worktreeConfig
2026-01-11T19:28:02.9809549Z ##[group]Checking out the ref
2026-01-11T19:28:02.9819870Z [command]"C:\Program Files\Git\bin\git.exe" checkout --progress --force -B master refs/remotes/origin/master
2026-01-11T19:28:03.1222397Z branch 'master' set up to track 'origin/master'.
2026-01-11T19:28:03.1231725Z Reset branch 'master'
2026-01-11T19:28:03.1272156Z ##[endgroup]
2026-01-11T19:28:03.1740289Z [command]"C:\Program Files\Git\bin\git.exe" log -1 --format=%H
2026-01-11T19:28:03.2063590Z 1cdf7fc6aca4f84a8b253d9fcbd656730b2297be
2026-01-11T19:28:03.2467191Z ##[group]Run $errors = @()
2026-01-11T19:28:03.2467657Z [36;1m$errors = @()[0m
2026-01-11T19:28:03.2467951Z [36;1mGet-ChildItem -Path . -Filter *.ps1 -Recurse |[0m
2026-01-11T19:28:03.2468491Z [36;1m  Where-Object { $_.FullName -notlike '*_external*' -and $_.FullName -notlike '*node_modules*' } |[0m
2026-01-11T19:28:03.2469202Z [36;1m  ForEach-Object {[0m
2026-01-11T19:28:03.2469416Z [36;1m    $tokens = $null[0m
2026-01-11T19:28:03.2469619Z [36;1m    $parseErrors = $null[0m
2026-01-11T19:28:03.2470115Z [36;1m    [System.Management.Automation.Language.Parser]::ParseFile($_.FullName, [ref]$tokens, [ref]$parseErrors)[0m
2026-01-11T19:28:03.2470674Z [36;1m    if ($parseErrors) {[0m
2026-01-11T19:28:03.2471112Z [36;1m      $errors += "$($_.Name): $($parseErrors | ForEach-Object { $_.Message })"[0m
2026-01-11T19:28:03.2471597Z [36;1m    }[0m
2026-01-11T19:28:03.2471756Z [36;1m  }[0m
2026-01-11T19:28:03.2472013Z [36;1mGet-ChildItem -Path . -Filter *.psm1 -Recurse |[0m
2026-01-11T19:28:03.2472494Z [36;1m  Where-Object { $_.FullName -notlike '*_external*' -and $_.FullName -notlike '*node_modules*' } |[0m
2026-01-11T19:28:03.2472937Z [36;1m  ForEach-Object {[0m
2026-01-11T19:28:03.2473933Z [36;1m    $tokens = $null[0m
2026-01-11T19:28:03.2474135Z [36;1m    $parseErrors = $null[0m
2026-01-11T19:28:03.2474625Z [36;1m    [System.Management.Automation.Language.Parser]::ParseFile($_.FullName, [ref]$tokens, [ref]$parseErrors)[0m
2026-01-11T19:28:03.2475120Z [36;1m    if ($parseErrors) {[0m
2026-01-11T19:28:03.2475435Z [36;1m      $errors += "$($_.Name): $($parseErrors | ForEach-Object { $_.Message })"[0m
2026-01-11T19:28:03.2475773Z [36;1m    }[0m
2026-01-11T19:28:03.2475916Z [36;1m  }[0m
2026-01-11T19:28:03.2476081Z [36;1mif ($errors.Count -gt 0) {[0m
2026-01-11T19:28:03.2476448Z [36;1m  Write-Host "‚ùå PowerShell syntax errors found:" -ForegroundColor Red[0m
2026-01-11T19:28:03.2476891Z [36;1m  $errors | ForEach-Object { Write-Host "  $_" }[0m
2026-01-11T19:28:03.2477148Z [36;1m  exit 1[0m
2026-01-11T19:28:03.2477301Z [36;1m}[0m
2026-01-11T19:28:03.2477598Z [36;1mWrite-Host "‚úì All PowerShell files have valid syntax" -ForegroundColor Green[0m
2026-01-11T19:28:03.3229829Z shell: C:\Program Files\PowerShell\7\pwsh.EXE -command ". '{0}'"
2026-01-11T19:28:03.3230280Z ##[endgroup]
2026-01-11T19:28:11.6484429Z 
2026-01-11T19:28:11.6491880Z [32;1mAttributes         : [0m{}
2026-01-11T19:28:11.6494774Z [32;1mUsingStatements    : [0m{}
2026-01-11T19:28:11.6495527Z [32;1mParamBlock         : [0mparam(
2026-01-11T19:28:11.6496190Z                          [switch]$ResetConsent,
2026-01-11T19:28:11.6496746Z                          [switch]$AutoAccept
2026-01-11T19:28:11.6497249Z                      )
2026-01-11T19:28:11.6497739Z [32;1mBeginBlock         : [0m
2026-01-11T19:28:11.6498266Z [32;1mProcessBlock       : [0m
2026-01-11T19:28:11.6498790Z [32;1mEndBlock           : [0mparam(
2026-01-11T19:28:11.6500005Z                          [switch]$ResetConsent,
2026-01-11T19:28:11.6500858Z                          [switch]$AutoAccept
2026-01-11T19:28:11.6501570Z                      )
2026-01-11T19:28:11.6501973Z                      
2026-01-11T19:28:11.6503232Z                      
2026-01-11T19:28:11.6503890Z                      # ----------------------------
2026-01-11T19:28:11.6504482Z                      # Global behavior and helpers
2026-01-11T19:28:11.6505391Z                      # ----------------------------
2026-01-11T19:28:11.6506075Z                      
2026-01-11T19:28:11.6506662Z                      $ErrorActionPreference = "Stop"
2026-01-11T19:28:11.6507159Z                      $script:HadFailures = $false
2026-01-11T19:28:11.6507805Z                      $script:WingetAvailable = $false
2026-01-11T19:28:11.6508342Z                      $script:ResetConsent = $ResetConsent
2026-01-11T19:28:11.6513233Z                      $script:ConsentRoot = Join-Path $env:LOCALAPPDATA "WindowsGamingSettings"
2026-01-11T19:28:11.6514505Z                      $script:ConsentFilePath = Join-Path $script:ConsentRoot "benchmark-consent.json"
2026-01-11T19:28:11.6515231Z                      
2026-01-11T19:28:11.6515576Z                      # Progress tracking
2026-01-11T19:28:11.6515983Z                      $script:SectionIndex = 0
2026-01-11T19:28:11.6516417Z                      $script:SectionTotal = 0
2026-01-11T19:28:11.6516812Z                      
2026-01-11T19:28:11.6517145Z                      function Get-SectionTotal {
2026-01-11T19:28:11.6517620Z                          <#
2026-01-11T19:28:11.6517937Z                          .SYNOPSIS
2026-01-11T19:28:11.6518475Z                              Counts the number of Write-Section calls in the main script.
2026-01-11T19:28:11.6519156Z                          #>
2026-01-11T19:28:11.6519529Z                          param(
2026-01-11T19:28:11.6519959Z                              [string]$ScriptPath = $PSCommandPath
2026-01-11T19:28:11.6520481Z                          )
2026-01-11T19:28:11.6520777Z                      
2026-01-11T19:28:11.6521098Z                          if (-not $ScriptPath) {
2026-01-11T19:28:11.6521938Z                              $ScriptPath = $MyInvocation.MyCommand.Path
2026-01-11T19:28:11.6522445Z                          }
2026-01-11T19:28:11.6522733Z                      
2026-01-11T19:28:11.6523164Z                          if (-not $ScriptPath -or -not (Test-Path $ScriptPath)) {
2026-01-11T19:28:11.6523721Z                              return 1
2026-01-11T19:28:11.6524084Z                          }
2026-01-11T19:28:11.6524381Z                      
2026-01-11T19:28:11.6525381Z                          $matches = Select-String -Path $ScriptPath -Pattern 'Write-Section\s+["\']' -AllMatches
2026-01-11T19:28:11.6531967Z                          return [math]::Max(1, $matches.Count)
2026-01-11T19:28:11.6532475Z                      }
2026-01-11T19:28:11.6532758Z                      
2026-01-11T19:28:11.6533169Z                      $script:SectionTotal = Get-SectionTotal
2026-01-11T19:28:11.6533598Z                      
2026-01-11T19:28:11.6533891Z                      function Write-Section {
2026-01-11T19:28:11.6534269Z                          <#
2026-01-11T19:28:11.6534598Z                          .SYNOPSIS
2026-01-11T19:28:11.6535096Z                              Writes a high-visibility section header to the console.
2026-01-11T19:28:11.6535653Z                          .DESCRIPTION
2026-01-11T19:28:11.6536234Z                              Used to separate major phases such as installs, configuration, and launch.
2026-01-11T19:28:11.6536614Z                          #>
2026-01-11T19:28:11.6536796Z                          param(
2026-01-11T19:28:11.6537024Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.6537283Z                              [string]$Title
2026-01-11T19:28:11.6537510Z                          )
2026-01-11T19:28:11.6537688Z                      
2026-01-11T19:28:11.6537874Z                          $script:SectionIndex++
2026-01-11T19:28:11.6538300Z                          $pct = [math]::Min(100, [math]::Round(($script:SectionIndex / $script:SectionTotal) * 100))
2026-01-11T19:28:11.7018622Z                          Write-Progress -Activity "Benchmark Setup" -Status $Title -PercentComplete $pct 
2026-01-11T19:28:11.7020120Z                      -CurrentOperation "Step $($script:SectionIndex) of $($script:SectionTotal)"
2026-01-11T19:28:11.7021089Z                      
2026-01-11T19:28:11.7021576Z                          Write-Host ""
2026-01-11T19:28:11.7022210Z                          Write-Host "=== $Title ===" -ForegroundColor Cyan
2026-01-11T19:28:11.7022940Z                      }
2026-01-11T19:28:11.7023348Z                      
2026-01-11T19:28:11.7023762Z                      function Write-Note {
2026-01-11T19:28:11.7024309Z                          <#
2026-01-11T19:28:11.7026511Z                          .SYNOPSIS
2026-01-11T19:28:11.7027147Z                              Writes informational messages in a consistent format.
2026-01-11T19:28:11.7027778Z                          .DESCRIPTION
2026-01-11T19:28:11.7028650Z                              These messages are non-fatal and describe what the script is doing.
2026-01-11T19:28:11.7029327Z                          #>
2026-01-11T19:28:11.7029684Z                          param(
2026-01-11T19:28:11.7030118Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.7030616Z                              [string]$Message
2026-01-11T19:28:11.7031060Z                          )
2026-01-11T19:28:11.7031377Z                      
2026-01-11T19:28:11.7031871Z                          Write-Host "[INFO] $Message" -ForegroundColor Gray
2026-01-11T19:28:11.7032400Z                      }
2026-01-11T19:28:11.7032749Z                      
2026-01-11T19:28:11.7033062Z                      function Write-Warn {
2026-01-11T19:28:11.7033568Z                          <#
2026-01-11T19:28:11.7033908Z                          .SYNOPSIS
2026-01-11T19:28:11.7034749Z                              Writes warnings that do not stop execution.
2026-01-11T19:28:11.7035593Z                          .DESCRIPTION
2026-01-11T19:28:11.7036197Z                              Warnings indicate reduced automation or missing optional data.
2026-01-11T19:28:11.7036803Z                          #>
2026-01-11T19:28:11.7037129Z                          param(
2026-01-11T19:28:11.7037356Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.7037739Z                              [string]$Message
2026-01-11T19:28:11.7038116Z                          )
2026-01-11T19:28:11.7038376Z                      
2026-01-11T19:28:11.7038633Z                          Write-Host "[WARN] $Message" -ForegroundColor Yellow
2026-01-11T19:28:11.7039084Z                      }
2026-01-11T19:28:11.7039368Z                      
2026-01-11T19:28:11.7040017Z                      function Write-Fail {
2026-01-11T19:28:11.7041250Z                          <#
2026-01-11T19:28:11.7041853Z                          .SYNOPSIS
2026-01-11T19:28:11.7043389Z                              Writes a failure message and marks the run as having errors.
2026-01-11T19:28:11.7043984Z                          .DESCRIPTION
2026-01-11T19:28:11.7044583Z                              The script will still continue to the exit prompt for transparency.
2026-01-11T19:28:11.7045489Z                          #>
2026-01-11T19:28:11.7045818Z                          param(
2026-01-11T19:28:11.7046255Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.7046828Z                              [string]$Message
2026-01-11T19:28:11.7047458Z                          )
2026-01-11T19:28:11.7047804Z                      
2026-01-11T19:28:11.7049047Z                          $script:HadFailures = $true
2026-01-11T19:28:11.7049650Z                          Write-Host "[FAIL] $Message" -ForegroundColor Red
2026-01-11T19:28:11.7050073Z                      }
2026-01-11T19:28:11.7051435Z                      
2026-01-11T19:28:11.7052144Z                      function Write-Ok {
2026-01-11T19:28:11.7052652Z                          <#
2026-01-11T19:28:11.7052989Z                          .SYNOPSIS
2026-01-11T19:28:11.7053380Z                              Writes a success message.
2026-01-11T19:28:11.7053798Z                          .DESCRIPTION
2026-01-11T19:28:11.7054631Z                              Used to confirm expected outcomes like successful installs.
2026-01-11T19:28:11.7055334Z                          #>
2026-01-11T19:28:11.7056699Z                          param(
2026-01-11T19:28:11.7057300Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.7057786Z                              [string]$Message
2026-01-11T19:28:11.7058135Z                          )
2026-01-11T19:28:11.7058851Z                      
2026-01-11T19:28:11.7059736Z                          Write-Host "[OK] $Message" -ForegroundColor Green
2026-01-11T19:28:11.7060234Z                      }
2026-01-11T19:28:11.7060530Z                      
2026-01-11T19:28:11.7060864Z                      function Wait-ForUserExit {
2026-01-11T19:28:11.7061285Z                          <#
2026-01-11T19:28:11.7061592Z                          .SYNOPSIS
2026-01-11T19:28:11.7062031Z                              Always waits for a user key press before exiting.
2026-01-11T19:28:11.7062591Z                          .DESCRIPTION
2026-01-11T19:28:11.7064256Z                              This keeps the console open for users who double-click the script
2026-01-11T19:28:11.7065027Z                              and would otherwise lose the output.
2026-01-11T19:28:11.7065499Z                          #>
2026-01-11T19:28:11.7065950Z                          # Always pause so the user can read output, even on failure.
2026-01-11T19:28:11.7066611Z                          Write-Host ""
2026-01-11T19:28:11.7067422Z                          Write-Host "Press any key to exit..." -ForegroundColor Cyan
2026-01-11T19:28:11.7067922Z                          try {
2026-01-11T19:28:11.7069642Z                              $null = [System.Console]::ReadKey($true)
2026-01-11T19:28:11.7070118Z                          } catch {
2026-01-11T19:28:11.7070578Z                              # Fallback for hosts that do not support ReadKey (e.g., some terminals).
2026-01-11T19:28:11.7070981Z                              Read-Host "Press Enter to exit"
2026-01-11T19:28:11.7071491Z                          }
2026-01-11T19:28:11.7071862Z                      }
2026-01-11T19:28:11.7072417Z                      
2026-01-11T19:28:11.7072819Z                      function Show-RockTuneFinalChecklist {
2026-01-11T19:28:11.7073364Z                          <#
2026-01-11T19:28:11.7074638Z                          .SYNOPSIS
2026-01-11T19:28:11.7075262Z                              Prints a no-guesswork, step-by-step checklist after tools launch.
2026-01-11T19:28:11.7075994Z                          .DESCRIPTION
2026-01-11T19:28:11.7076808Z                              This is intentionally explicit for first-time users who need to know
2026-01-11T19:28:11.7077723Z                              exactly what to click and in what order. The checklist is short and
2026-01-11T19:28:11.7078531Z                              ends with clear completion cues.
2026-01-11T19:28:11.7078990Z                          #>
2026-01-11T19:28:11.7079361Z                          Write-Section "ROCKTUNE Benchmark Steps"
2026-01-11T19:28:11.7079708Z                      
2026-01-11T19:28:11.7080963Z                          $consoleWidth = 0
2026-01-11T19:28:11.7081652Z                          try {
2026-01-11T19:28:11.7082386Z                              $consoleWidth = $Host.UI.RawUI.WindowSize.Width
2026-01-11T19:28:11.7082917Z                          } catch {
2026-01-11T19:28:11.7083299Z                              $consoleWidth = 0
2026-01-11T19:28:11.7083823Z                          }
2026-01-11T19:28:11.7084352Z                      
2026-01-11T19:28:11.7085569Z                          function Get-LeftPad {
2026-01-11T19:28:11.7086057Z                              param(
2026-01-11T19:28:11.7086431Z                                  [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.7087089Z                                  [int]$Width,
2026-01-11T19:28:11.7087490Z                      
2026-01-11T19:28:11.7087804Z                                  [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.7088367Z                                  [int]$MaxLineLength
2026-01-11T19:28:11.7088776Z                              )
2026-01-11T19:28:11.7089112Z                      
2026-01-11T19:28:11.7090318Z                              if ($Width -le 0 -or $MaxLineLength -le 0) {
2026-01-11T19:28:11.7090838Z                                  return ""
2026-01-11T19:28:11.7091429Z                              }
2026-01-11T19:28:11.7091749Z                      
2026-01-11T19:28:11.7092451Z                              $pad = [math]::Floor(($Width - $MaxLineLength) / 2)
2026-01-11T19:28:11.7092953Z                              if ($pad -lt 0) {
2026-01-11T19:28:11.7093415Z                                  $pad = 0
2026-01-11T19:28:11.7093771Z                              }
2026-01-11T19:28:11.7094048Z                      
2026-01-11T19:28:11.7094331Z                              return (" " * $pad)
2026-01-11T19:28:11.7094714Z                          }
2026-01-11T19:28:11.7094981Z                      
2026-01-11T19:28:11.7095448Z                          $bannerLines = @(
2026-01-11T19:28:11.7095887Z                              "  ____   ___   ____ _  __ _______ _   _ _   _ _____",
2026-01-11T19:28:11.7097364Z                              " |  _ \ / _ \ / ___| |/ /|_   _| | | | | \ | | ____|",
2026-01-11T19:28:11.7098028Z                              " | |_) | | | | |   | ' /   | | | | | | |  \| |  _|",
2026-01-11T19:28:11.7098930Z                              " |  _ <| |_| | |___| . \   | | | |_| | | |\  | |___",
2026-01-11T19:28:11.7099404Z                              " |_| \_\\___/ \____|_|\_\  |_|  \___/|_|_| \_|_____|"
2026-01-11T19:28:11.7100220Z                          )
2026-01-11T19:28:11.7100513Z                      
2026-01-11T19:28:11.7101095Z                          $bannerMax = ($bannerLines | Measure-Object -Property Length -Maximum).Maximum
2026-01-11T19:28:11.7102052Z                          $bannerPad = Get-LeftPad -Width $consoleWidth -MaxLineLength $bannerMax
2026-01-11T19:28:11.7102667Z                      
2026-01-11T19:28:11.7103198Z                          foreach ($line in $bannerLines) {
2026-01-11T19:28:11.7103790Z                              Write-Host ($bannerPad + $line) -ForegroundColor Cyan
2026-01-11T19:28:11.7104321Z                          }
2026-01-11T19:28:11.7104645Z                      
2026-01-11T19:28:11.7104871Z                          $useTwoColumns = $false
2026-01-11T19:28:11.7105305Z                          if ($consoleWidth -ge 120) {
2026-01-11T19:28:11.7105806Z                              $useTwoColumns = $true
2026-01-11T19:28:11.7106240Z                          }
2026-01-11T19:28:11.7107289Z                      
2026-01-11T19:28:11.7107795Z                          $sections = @(
2026-01-11T19:28:11.7108205Z                              @{
2026-01-11T19:28:11.7108605Z                                  Title = "FIRST STEPS"
2026-01-11T19:28:11.7109150Z                                  Lines = @(
2026-01-11T19:28:11.7110677Z                                      '[ ] Confirm the tools are open',
2026-01-11T19:28:11.7111105Z                                      '    - CapFrameX is running',
2026-01-11T19:28:11.7111663Z                                      '    - Unigine Superposition is open',
2026-01-11T19:28:11.7112853Z                                      '    - LatencyMon is open'
2026-01-11T19:28:11.7113330Z                                  )
2026-01-11T19:28:11.7113550Z                              },
2026-01-11T19:28:11.7113863Z                              @{
2026-01-11T19:28:11.7114237Z                                  Title = "CONFIGURE CAPFRAMEX (ONCE)"
2026-01-11T19:28:11.7115358Z                                  Lines = @(
2026-01-11T19:28:11.7115873Z                                      '[ ] Capture API: PresentMon',
2026-01-11T19:28:11.7116432Z                                      '[ ] Capture duration: 60s',
2026-01-11T19:28:11.7116902Z                                      '[ ] Start delay: 3s',
2026-01-11T19:28:11.7117455Z                                      '[ ] Hotkey: F11 (start/stop capture)'
2026-01-11T19:28:11.7117939Z                                  )
2026-01-11T19:28:11.7118285Z                              },
2026-01-11T19:28:11.7118725Z                              @{
2026-01-11T19:28:11.7119159Z                                  Title = "CONFIGURE SUPERPOSITION (ONCE)"
2026-01-11T19:28:11.7120663Z                                  Lines = @(
2026-01-11T19:28:11.7121164Z                                      '[ ] Preset: 1080p Medium',
2026-01-11T19:28:11.7121708Z                                      '[ ] Fullscreen: On',
2026-01-11T19:28:11.7122166Z                                      '[ ] VSync: Off'
2026-01-11T19:28:11.7122646Z                                  )
2026-01-11T19:28:11.7123217Z                              },
2026-01-11T19:28:11.7124554Z                              @{
2026-01-11T19:28:11.7125037Z                                  Title = "BEFORE CHANGES"
2026-01-11T19:28:11.7125479Z                                  Lines = @(
2026-01-11T19:28:11.7126155Z                                      '[ ] Warm-up run (no capture)',
2026-01-11T19:28:11.7127574Z                                      '    - Click RUN in Superposition',
2026-01-11T19:28:11.7128115Z                                      '    - Let the run finish',
2026-01-11T19:28:11.7128666Z                                      '[ ] Captured runs (before)',
2026-01-11T19:28:11.7129125Z                                      '    - Press F11 at start, F11 at end',
2026-01-11T19:28:11.7129808Z                                      '    - Do 2 valid runs; discard first if shader compilation occurs'
2026-01-11T19:28:11.7130734Z                                  )
2026-01-11T19:28:11.7131088Z                              },
2026-01-11T19:28:11.7131409Z                              @{
2026-01-11T19:28:11.7131811Z                                  Title = "LATENCYMON"
2026-01-11T19:28:11.7132212Z                                  Lines = @(
2026-01-11T19:28:11.7133505Z                                      '[ ] Click Start, run for ~5 minutes',
2026-01-11T19:28:11.7134051Z                                      '    - Screenshot Main tab',
2026-01-11T19:28:11.7134499Z                                      '    - Screenshot Drivers tab'
2026-01-11T19:28:11.7134937Z                                  )
2026-01-11T19:28:11.7135585Z                              },
2026-01-11T19:28:11.7136843Z                              @{
2026-01-11T19:28:11.7137489Z                                  Title = "APPLY ROCKTUNE CHANGES"
2026-01-11T19:28:11.7138237Z                                  Lines = @(
2026-01-11T19:28:11.7138908Z                                      '[ ] Run your optimization flow',
2026-01-11T19:28:11.7140295Z                                      '[ ] Reboot if requested'
2026-01-11T19:28:11.7140770Z                                  )
2026-01-11T19:28:11.7141096Z                              },
2026-01-11T19:28:11.7141389Z                              @{
2026-01-11T19:28:11.7142639Z                                  Title = "AFTER CHANGES"
2026-01-11T19:28:11.7143124Z                                  Lines = @(
2026-01-11T19:28:11.7143491Z                                      '[ ] Repeat the captured runs',
2026-01-11T19:28:11.7144113Z                                      '    - Same settings, same steps, same number of runs'
2026-01-11T19:28:11.7144773Z                                  )
2026-01-11T19:28:11.7145866Z                              },
2026-01-11T19:28:11.7146870Z                              @{
2026-01-11T19:28:11.7148105Z                                  Title = "EXPORT EVIDENCE"
2026-01-11T19:28:11.7148557Z                                  Lines = @(
2026-01-11T19:28:11.7148958Z                                      '[ ] CapFrameX -> Analysis -> Aggregate',
2026-01-11T19:28:11.7149456Z                                      '[ ] Export CSV + HTML summary'
2026-01-11T19:28:11.7150896Z                                  )
2026-01-11T19:28:11.7151309Z                              },
2026-01-11T19:28:11.7152927Z                              @{
2026-01-11T19:28:11.7153374Z                                  Title = "OPTIONAL INPUT LAG (FREE METHOD)"
2026-01-11T19:28:11.7153910Z                                  Lines = @(
2026-01-11T19:28:11.7154631Z                                      '[ ] Record 10 clicks at 240fps',
2026-01-11T19:28:11.7155154Z                                      '[ ] Count frames from click to pixel change',
2026-01-11T19:28:11.7155637Z                                      '[ ] 1 frame at 240fps = 4.17ms'
2026-01-11T19:28:11.7155889Z                                  )
2026-01-11T19:28:11.7156258Z                              }
2026-01-11T19:28:11.7156591Z                          )
2026-01-11T19:28:11.7156856Z                      
2026-01-11T19:28:11.7157250Z                          function Get-SectionLines {
2026-01-11T19:28:11.7158552Z                              param(
2026-01-11T19:28:11.7158968Z                                  [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.7159603Z                                  [hashtable]$Section
2026-01-11T19:28:11.7160631Z                              )
2026-01-11T19:28:11.7162158Z                      
2026-01-11T19:28:11.7162776Z                              $lines = @("== $($Section.Title) ==")
2026-01-11T19:28:11.7163277Z                              foreach ($line in $Section.Lines) {
2026-01-11T19:28:11.7163782Z                                  $lines += $line
2026-01-11T19:28:11.7164959Z                              }
2026-01-11T19:28:11.7165659Z                      
2026-01-11T19:28:11.7166251Z                              return $lines
2026-01-11T19:28:11.7167459Z                          }
2026-01-11T19:28:11.7167770Z                      
2026-01-11T19:28:11.7169159Z                          $lineItems = @()
2026-01-11T19:28:11.7169564Z                      
2026-01-11T19:28:11.7169851Z                          if ($useTwoColumns) {
2026-01-11T19:28:11.7170424Z                              $leftWidth = 58
2026-01-11T19:28:11.7171754Z                              for ($i = 0; $i -lt $sections.Count; $i += 2) {
2026-01-11T19:28:11.7172459Z                                  $left = Get-SectionLines -Section $sections[$i]
2026-01-11T19:28:11.7173564Z                                  $right = @()
2026-01-11T19:28:11.7174323Z                                  if ($i + 1 -lt $sections.Count) {
2026-01-11T19:28:11.7175607Z                                      $right = Get-SectionLines -Section $sections[$i + 1]
2026-01-11T19:28:11.7176184Z                                  }
2026-01-11T19:28:11.7176509Z                      
2026-01-11T19:28:11.7176907Z                                  $maxLines = [math]::Max($left.Count, $right.Count)
2026-01-11T19:28:11.7177606Z                                  for ($lineIndex = 0; $lineIndex -lt $maxLines; $lineIndex++) {
2026-01-11T19:28:11.7178189Z                                      $leftText = ""
2026-01-11T19:28:11.7178704Z                                      $rightText = ""
2026-01-11T19:28:11.7180123Z                                      if ($lineIndex -lt $left.Count) {
2026-01-11T19:28:11.7180619Z                                          $leftText = $left[$lineIndex]
2026-01-11T19:28:11.7181083Z                                      }
2026-01-11T19:28:11.7182363Z                                      if ($lineIndex -lt $right.Count) {
2026-01-11T19:28:11.7182896Z                                          $rightText = $right[$lineIndex]
2026-01-11T19:28:11.7183466Z                                      }
2026-01-11T19:28:11.7183829Z                      
2026-01-11T19:28:11.7184628Z                                      $lineItems += ($leftText.PadRight($leftWidth) + $rightText)
2026-01-11T19:28:11.7185188Z                                  }
2026-01-11T19:28:11.7185453Z                      
2026-01-11T19:28:11.7185935Z                                  $lineItems += ""
2026-01-11T19:28:11.7186374Z                              }
2026-01-11T19:28:11.7187721Z                          } else {
2026-01-11T19:28:11.7188182Z                              foreach ($section in $sections) {
2026-01-11T19:28:11.7188570Z                                  $lineItems += ""
2026-01-11T19:28:11.7189394Z                                  $lineItems += "== $($section.Title) =="
2026-01-11T19:28:11.7190033Z                                  foreach ($line in $section.Lines) {
2026-01-11T19:28:11.7190572Z                                      $lineItems += $line
2026-01-11T19:28:11.7191029Z                                  }
2026-01-11T19:28:11.7192174Z                              }
2026-01-11T19:28:11.7192483Z                          }
2026-01-11T19:28:11.7193812Z                      
2026-01-11T19:28:11.7194240Z                          if ($lineItems.Count -gt 0 -and $lineItems[0] -eq "") {
2026-01-11T19:28:11.7194883Z                              $lineItems = $lineItems[1..($lineItems.Count - 1)]
2026-01-11T19:28:11.7195370Z                          }
2026-01-11T19:28:11.7195704Z                      
2026-01-11T19:28:11.7196886Z                          $maxLineLength = ($lineItems | Measure-Object -Property Length -Maximum).Maximum
2026-01-11T19:28:11.7197886Z                          $checklistPad = Get-LeftPad -Width $consoleWidth -MaxLineLength $maxLineLength
2026-01-11T19:28:11.7199070Z                          foreach ($line in $lineItems) {
2026-01-11T19:28:11.7199697Z                              Write-Host ($checklistPad + $line) -ForegroundColor White
2026-01-11T19:28:11.7201081Z                          }
2026-01-11T19:28:11.7201260Z                      }
2026-01-11T19:28:11.7201564Z                      
2026-01-11T19:28:11.7201859Z                      function Prompt-YesNo {
2026-01-11T19:28:11.7202263Z                          <#
2026-01-11T19:28:11.7202551Z                          .SYNOPSIS
2026-01-11T19:28:11.7202929Z                              Prompts until a valid yes/no response is provided.
2026-01-11T19:28:11.7203347Z                          .DESCRIPTION
2026-01-11T19:28:11.7203854Z                              Accepts Y/Yes or N/No (case-insensitive). Returns $true for yes,
2026-01-11T19:28:11.7204570Z                              $false for no. This avoids accidental defaults on invalid input.
2026-01-11T19:28:11.7205114Z                          #>
2026-01-11T19:28:11.7205413Z                          param(
2026-01-11T19:28:11.7206541Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.7207063Z                              [string]$Message
2026-01-11T19:28:11.7207828Z                          )
2026-01-11T19:28:11.7209022Z                      
2026-01-11T19:28:11.7209831Z                          while ($true) {
2026-01-11T19:28:11.7210239Z                              $response = Read-Host $Message
2026-01-11T19:28:11.7211106Z                              if ($response -match '^(y|yes)$') {
2026-01-11T19:28:11.7211562Z                                  return $true
2026-01-11T19:28:11.7211929Z                              }
2026-01-11T19:28:11.7212309Z                              if ($response -match '^(n|no)$') {
2026-01-11T19:28:11.7212780Z                                  return $false
2026-01-11T19:28:11.7213188Z                              }
2026-01-11T19:28:11.7213409Z                      
2026-01-11T19:28:11.7213761Z                              Write-Warn "Please answer Y or N."
2026-01-11T19:28:11.7214175Z                          }
2026-01-11T19:28:11.7214577Z                      }
2026-01-11T19:28:11.7214864Z                      
2026-01-11T19:28:11.7215194Z                      function Get-ConsentCache {
2026-01-11T19:28:11.7216058Z                          <#
2026-01-11T19:28:11.7217406Z                          .SYNOPSIS
2026-01-11T19:28:11.7218171Z                              Reads the stored install consent, if present.
2026-01-11T19:28:11.7218817Z                          .DESCRIPTION
2026-01-11T19:28:11.7219874Z                              Returns $true or $false when a saved choice exists, otherwise $null.
2026-01-11T19:28:11.7220783Z                              The cache is stored under the current user profile in LocalAppData.
2026-01-11T19:28:11.7221205Z                          #>
2026-01-11T19:28:11.7221970Z                          if (-not (Test-Path $script:ConsentFilePath)) {
2026-01-11T19:28:11.7222518Z                              return $null
2026-01-11T19:28:11.7222909Z                          }
2026-01-11T19:28:11.7223313Z                      
2026-01-11T19:28:11.7223620Z                          try {
2026-01-11T19:28:11.7225545Z                              $data = Get-Content $script:ConsentFilePath -Raw | ConvertFrom-Json
2026-01-11T19:28:11.7226589Z                          } catch {
2026-01-11T19:28:11.7227219Z                              return $null
2026-01-11T19:28:11.7227595Z                          }
2026-01-11T19:28:11.7227895Z                      
2026-01-11T19:28:11.7228194Z                          if ($null -eq $data) {
2026-01-11T19:28:11.7228800Z                              return $null
2026-01-11T19:28:11.7229242Z                          }
2026-01-11T19:28:11.7229632Z                      
2026-01-11T19:28:11.7231295Z                          if ($data.PSObject.Properties.Name -contains "InstallConsent") {
2026-01-11T19:28:11.7232033Z                              return [bool]$data.InstallConsent
2026-01-11T19:28:11.7232478Z                          }
2026-01-11T19:28:11.7232694Z                      
2026-01-11T19:28:11.7233251Z                          return $null
2026-01-11T19:28:11.7233592Z                      }
2026-01-11T19:28:11.7233873Z                      
2026-01-11T19:28:11.7234216Z                      function Set-ConsentCache {
2026-01-11T19:28:11.7234673Z                          <#
2026-01-11T19:28:11.7235290Z                          .SYNOPSIS
2026-01-11T19:28:11.7236014Z                              Persists the install consent choice for future runs.
2026-01-11T19:28:11.7236572Z                          .DESCRIPTION
2026-01-11T19:28:11.7237044Z                              Stores a small JSON file with the user's choice and a timestamp.
2026-01-11T19:28:11.7237858Z                              Users can reset it with -ResetConsent or by deleting the file.
2026-01-11T19:28:11.7238481Z                          #>
2026-01-11T19:28:11.7238827Z                          param(
2026-01-11T19:28:11.7239637Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.7240119Z                              [bool]$InstallConsent
2026-01-11T19:28:11.7240670Z                          )
2026-01-11T19:28:11.7242057Z                      
2026-01-11T19:28:11.7243881Z                          if (-not (Test-Path $script:ConsentRoot)) {
2026-01-11T19:28:11.7244760Z                              New-Item -Path $script:ConsentRoot -ItemType Directory -Force | Out-Null
2026-01-11T19:28:11.7245445Z                          }
2026-01-11T19:28:11.7245743Z                      
2026-01-11T19:28:11.7246117Z                          $payload = @{
2026-01-11T19:28:11.7247912Z                              InstallConsent = $InstallConsent
2026-01-11T19:28:11.7248655Z                              UpdatedAtUtc = (Get-Date).ToUniversalTime().ToString("o")
2026-01-11T19:28:11.7304482Z                              Source = "benchmark-setup.ps1"
2026-01-11T19:28:11.7305032Z                          }
2026-01-11T19:28:11.7305939Z                      
2026-01-11T19:28:11.7306836Z                          $payload | ConvertTo-Json -Depth 3 | Set-Content -Path $script:ConsentFilePath -Encoding UTF8
2026-01-11T19:28:11.7308021Z                      }
2026-01-11T19:28:11.7308455Z                      
2026-01-11T19:28:11.7308961Z                      function Confirm-InstallConsent {
2026-01-11T19:28:11.7309433Z                          <#
2026-01-11T19:28:11.7309744Z                          .SYNOPSIS
2026-01-11T19:28:11.7310290Z                              Prompts the user for explicit consent before installing software.
2026-01-11T19:28:11.7310917Z                          .DESCRIPTION
2026-01-11T19:28:11.7311712Z                              This script uses winget to install tools. Some users want a hard
2026-01-11T19:28:11.7313835Z                              opt-in before any install activity starts. This function ensures
2026-01-11T19:28:11.7314747Z                              that no package installation occurs without a clear confirmation.
2026-01-11T19:28:11.7315381Z                          #>
2026-01-11T19:28:11.7315698Z                          param(
2026-01-11T19:28:11.7316090Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.7316563Z                              [string[]]$PackageNames
2026-01-11T19:28:11.7316963Z                          )
2026-01-11T19:28:11.7317254Z                      
2026-01-11T19:28:11.7317586Z                          Write-Section "Install Consent"
2026-01-11T19:28:11.7318428Z                          Write-Note "This script can install the following tools via winget:"
2026-01-11T19:28:11.7319309Z                          foreach ($name in $PackageNames) {
2026-01-11T19:28:11.7319978Z                              Write-Host "  - $name" -ForegroundColor White
2026-01-11T19:28:11.7320708Z                          }
2026-01-11T19:28:11.7321360Z                          Write-Note "No installations will occur without your consent."
2026-01-11T19:28:11.7322291Z                          Write-Note "Consent cache path: $script:ConsentFilePath"
2026-01-11T19:28:11.7323861Z                          Write-Note "Reset the cached choice with: .\\benchmark-setup.ps1 -ResetConsent"
2026-01-11T19:28:11.7324570Z                      
2026-01-11T19:28:11.7325298Z                          if ($script:ResetConsent -and (Test-Path $script:ConsentFilePath)) {
2026-01-11T19:28:11.7325939Z                              try {
2026-01-11T19:28:11.7326407Z                                  Remove-Item -Path $script:ConsentFilePath -Force
2026-01-11T19:28:11.7326978Z                                  Write-Ok "Consent cache cleared."
2026-01-11T19:28:11.7327422Z                              } catch {
2026-01-11T19:28:11.7328046Z                                  Write-Warn "Unable to remove consent cache. You may need to delete it manually."
2026-01-11T19:28:11.7328582Z                              }
2026-01-11T19:28:11.7328906Z                              $script:ResetConsent = $false
2026-01-11T19:28:11.7329343Z                          }
2026-01-11T19:28:11.7329614Z                      
2026-01-11T19:28:11.7329938Z                          # -------------------------------------------------------------------------
2026-01-11T19:28:11.7330288Z                          # AUTO-ACCEPT MODE
2026-01-11T19:28:11.7330676Z                          # -------------------------------------------------------------------------
2026-01-11T19:28:11.7331443Z                          # When -AutoAccept is specified, we skip all interactive prompts and
2026-01-11T19:28:11.7332393Z                          # automatically grant install consent. This is useful for:
2026-01-11T19:28:11.7333114Z                          #   - CI/CD pipelines where no human is present to answer prompts
2026-01-11T19:28:11.7333717Z                          #   - Automated testing environments
2026-01-11T19:28:11.7334307Z                          #   - Scripted deployments where you've already reviewed the tools
2026-01-11T19:28:11.7334861Z                          #
2026-01-11T19:28:11.7335326Z                          # The auto-accept does NOT save to the consent cache - it only affects
2026-01-11T19:28:11.7336222Z                          # the current execution. If you want to permanently allow installs without
2026-01-11T19:28:11.7336998Z                          # prompts, run once interactively and choose "Y" to remember.
2026-01-11T19:28:11.7337469Z                          #
2026-01-11T19:28:11.7337713Z                          # Usage: .\benchmark-setup.ps1 -AutoAccept
2026-01-11T19:28:11.7338338Z                          # -------------------------------------------------------------------------
2026-01-11T19:28:11.7338898Z                          if ($script:AutoAccept) {
2026-01-11T19:28:11.7339812Z                              Write-Ok "Auto-accept mode: installs are allowed."
2026-01-11T19:28:11.7340343Z                              return $true
2026-01-11T19:28:11.7340766Z                          }
2026-01-11T19:28:11.7341052Z                      
2026-01-11T19:28:11.7341370Z                          $cached = Get-ConsentCache
2026-01-11T19:28:11.7341827Z                          if ($null -ne $cached) {
2026-01-11T19:28:11.7342213Z                              if ($cached) {
2026-01-11T19:28:11.7342709Z                                  Write-Ok "Using saved consent: installs are allowed."
2026-01-11T19:28:11.7343197Z                              } else {
2026-01-11T19:28:11.7343570Z                                  Write-Warn "Using saved consent: installs are blocked."
2026-01-11T19:28:11.7343982Z                              }
2026-01-11T19:28:11.7344280Z                              return $cached
2026-01-11T19:28:11.7344697Z                          }
2026-01-11T19:28:11.7344972Z                      
2026-01-11T19:28:11.7345364Z                          $installConsent = Prompt-YesNo -Message "Install missing tools now? (Y/N)"
2026-01-11T19:28:11.7346006Z                      
2026-01-11T19:28:11.7346851Z                          $remember = Prompt-YesNo -Message "Remember this choice for next time? (Y/N)"
2026-01-11T19:28:11.7347548Z                          if ($remember) {
2026-01-11T19:28:11.7347913Z                              try {
2026-01-11T19:28:11.7348347Z                                  Set-ConsentCache -InstallConsent $installConsent
2026-01-11T19:28:11.7348805Z                                  Write-Ok "Consent saved."
2026-01-11T19:28:11.7349047Z                              } catch {
2026-01-11T19:28:11.7349394Z                                  Write-Warn "Unable to save consent cache. It will ask again next time."
2026-01-11T19:28:11.7349748Z                              }
2026-01-11T19:28:11.7349936Z                          }
2026-01-11T19:28:11.7350097Z                      
2026-01-11T19:28:11.7350294Z                          if ($installConsent) {
2026-01-11T19:28:11.7350768Z                              Write-Ok "Consent granted. Proceeding with installs when needed."
2026-01-11T19:28:11.7351268Z                          } else {
2026-01-11T19:28:11.7352152Z                              Write-Warn "Consent not granted. Skipping winget install and package installs."
2026-01-11T19:28:11.7352878Z                          }
2026-01-11T19:28:11.7353162Z                      
2026-01-11T19:28:11.7353452Z                          return $installConsent
2026-01-11T19:28:11.7353823Z                      }
2026-01-11T19:28:11.7354042Z                      
2026-01-11T19:28:11.7354313Z                      
2026-01-11T19:28:11.7354589Z                      # ----------------------------
2026-01-11T19:28:11.7354953Z                      # Winget detection and install
2026-01-11T19:28:11.7355366Z                      # ----------------------------
2026-01-11T19:28:11.7355674Z                      
2026-01-11T19:28:11.7356017Z                      function Test-WingetAvailable {
2026-01-11T19:28:11.7356403Z                          <#
2026-01-11T19:28:11.7356640Z                          .SYNOPSIS
2026-01-11T19:28:11.7357044Z                              Returns true if winget is callable.
2026-01-11T19:28:11.7357429Z                          .DESCRIPTION
2026-01-11T19:28:11.7357993Z                              Uses "winget --version" and checks the exit code. This avoids relying
2026-01-11T19:28:11.7358674Z                              on PATH heuristics and provides a simple availability check.
2026-01-11T19:28:11.7359206Z                          #>
2026-01-11T19:28:11.7359527Z                          try {
2026-01-11T19:28:11.7359890Z                              $null = winget --version 2>&1
2026-01-11T19:28:11.7360300Z                              return ($LASTEXITCODE -eq 0)
2026-01-11T19:28:11.7360691Z                          } catch {
2026-01-11T19:28:11.7361414Z                              return $false
2026-01-11T19:28:11.7361877Z                          }
2026-01-11T19:28:11.7362142Z                      }
2026-01-11T19:28:11.7362470Z                      
2026-01-11T19:28:11.7362883Z                      function Install-WingetIfMissing {
2026-01-11T19:28:11.7363327Z                          <#
2026-01-11T19:28:11.7363658Z                          .SYNOPSIS
2026-01-11T19:28:11.7364157Z                              Attempts to install winget if not already available.
2026-01-11T19:28:11.7364630Z                          .DESCRIPTION
2026-01-11T19:28:11.7365251Z                              The Microsoft-supported path is the App Installer package. This function:
2026-01-11T19:28:11.7366039Z                                1) Tries to open the Microsoft Store App Installer page.
2026-01-11T19:28:11.7366838Z                                2) Falls back to downloading the App Installer bundle from aka.ms.
2026-01-11T19:28:11.7367409Z                      
2026-01-11T19:28:11.7367884Z                              This mirrors the logic used in the main gaming-pc-setup script, but is
2026-01-11T19:28:11.7369849Z                              fully self-contained here for a standalone benchmark script.
2026-01-11T19:28:11.7372062Z                          #>
2026-01-11T19:28:11.7372567Z                          Write-Section "Winget Availability"
2026-01-11T19:28:11.7373981Z                          Write-Note "Checking if winget is available..."
2026-01-11T19:28:11.7374500Z                      
2026-01-11T19:28:11.7374786Z                          if (Test-WingetAvailable) {
2026-01-11T19:28:11.7375364Z                              $version = winget --version 2>&1
2026-01-11T19:28:11.7376021Z                              Write-Ok "winget is available ($version)."
2026-01-11T19:28:11.7376529Z                              return $true
2026-01-11T19:28:11.7376856Z                          }
2026-01-11T19:28:11.7377049Z                      
2026-01-11T19:28:11.7377539Z                          Write-Warn "winget is not available. Attempting installation."
2026-01-11T19:28:11.7378058Z                      
2026-01-11T19:28:11.7378477Z                          # Method 1: Microsoft Store App Installer page.
2026-01-11T19:28:11.7379023Z                          try {
2026-01-11T19:28:11.7379703Z                              $storeApp = Get-AppxPackage -Name "Microsoft.WindowsStore" -ErrorAction SilentlyContinue
2026-01-11T19:28:11.7380393Z                              if ($storeApp) {
2026-01-11T19:28:11.7380747Z                                  Write-Note "Opening Microsoft Store App Installer page."
2026-01-11T19:28:11.7381640Z                                  Start-Process "ms-windows-store://pdp/?ProductId=9NBLGGH4NNS1" -ErrorAction 
2026-01-11T19:28:11.7382401Z                      SilentlyContinue
2026-01-11T19:28:11.7383043Z                                  Write-Warn "Install 'App Installer' from the Store, then rerun this script."
2026-01-11T19:28:11.7383791Z                                  return $false
2026-01-11T19:28:11.7384171Z                              } else {
2026-01-11T19:28:11.7384794Z                                  Write-Warn "Microsoft Store not detected. Using direct download fallback."
2026-01-11T19:28:11.7385357Z                              }
2026-01-11T19:28:11.7385556Z                          } catch {
2026-01-11T19:28:11.7386081Z                              Write-Warn "Unable to open the Microsoft Store. Using direct download fallback."
2026-01-11T19:28:11.7386718Z                          }
2026-01-11T19:28:11.7387009Z                      
2026-01-11T19:28:11.7387334Z                          # Method 2: Direct download from Microsoft.
2026-01-11T19:28:11.7387793Z                          try {
2026-01-11T19:28:11.7388280Z                              $appInstallerUrl = "https://aka.ms/getwinget"
2026-01-11T19:28:11.7389273Z                              $downloadPath = Join-Path $env:TEMP "Microsoft.DesktopAppInstaller.msixbundle"
2026-01-11T19:28:11.7390125Z                      
2026-01-11T19:28:11.7390501Z                              Write-Note "Downloading App Installer bundle from $appInstallerUrl"
2026-01-11T19:28:11.7391507Z                              Invoke-WebRequest -Uri $appInstallerUrl -OutFile $downloadPath -UseBasicParsing 
2026-01-11T19:28:11.7392217Z                      -TimeoutSec 60 -ErrorAction Stop
2026-01-11T19:28:11.7392586Z                      
2026-01-11T19:28:11.7392947Z                              Write-Note "Installing App Installer bundle"
2026-01-11T19:28:11.7393411Z                              Add-AppxPackage -Path $downloadPath -ErrorAction Stop
2026-01-11T19:28:11.7393895Z                      
2026-01-11T19:28:11.7394306Z                              Remove-Item $downloadPath -ErrorAction SilentlyContinue
2026-01-11T19:28:11.7394799Z                      
2026-01-11T19:28:11.7395410Z                              Write-Ok "App Installer installed. Please restart PowerShell and rerun this script."
2026-01-11T19:28:11.7396068Z                              return $false
2026-01-11T19:28:11.7396522Z                          } catch {
2026-01-11T19:28:11.7397321Z                              Write-Fail "Failed to install App Installer. Install manually from 
2026-01-11T19:28:11.7397907Z                      https://aka.ms/getwinget"
2026-01-11T19:28:11.7398160Z                              return $false
2026-01-11T19:28:11.7398546Z                          }
2026-01-11T19:28:11.7398838Z                      }
2026-01-11T19:28:11.7399098Z                      
2026-01-11T19:28:11.7399355Z                      
2026-01-11T19:28:11.7399691Z                      # ----------------------------
2026-01-11T19:28:11.7400145Z                      # Package install and path resolution
2026-01-11T19:28:11.7400621Z                      # ----------------------------
2026-01-11T19:28:11.7400835Z                      
2026-01-11T19:28:11.7401061Z                      function Test-WingetPackageInstalled {
2026-01-11T19:28:11.7401430Z                          <#
2026-01-11T19:28:11.7401760Z                          .SYNOPSIS
2026-01-11T19:28:11.7402134Z                              Checks if a package is installed via winget list output.
2026-01-11T19:28:11.7402521Z                          .DESCRIPTION
2026-01-11T19:28:11.7403060Z                              Uses "winget list" and matches the package identifier in the output.
2026-01-11T19:28:11.7403796Z                              This works even when winget cannot reliably report install locations.
2026-01-11T19:28:11.7404356Z                          #>
2026-01-11T19:28:11.7404549Z                          param(
2026-01-11T19:28:11.7404856Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.7405316Z                              [string]$PackageId
2026-01-11T19:28:11.7405671Z                          )
2026-01-11T19:28:11.7406002Z                      
2026-01-11T19:28:11.7406295Z                          try {
2026-01-11T19:28:11.7406944Z                              $output = winget list --id $PackageId --source winget --accept-source-agreements 2>&1
2026-01-11T19:28:11.7407580Z                              if ($LASTEXITCODE -ne 0) {
2026-01-11T19:28:11.7408020Z                                  return $false
2026-01-11T19:28:11.7408277Z                              }
2026-01-11T19:28:11.7408451Z                      
2026-01-11T19:28:11.7408869Z                              return ($output -match [regex]::Escape($PackageId))
2026-01-11T19:28:11.7409310Z                          } catch {
2026-01-11T19:28:11.7409645Z                              return $false
2026-01-11T19:28:11.7410359Z                          }
2026-01-11T19:28:11.7410540Z                      }
2026-01-11T19:28:11.7410694Z                      
2026-01-11T19:28:11.7410889Z                      function Install-WingetPackage {
2026-01-11T19:28:11.7411308Z                          <#
2026-01-11T19:28:11.7411999Z                          .SYNOPSIS
2026-01-11T19:28:11.7412513Z                              Installs a package by winget ID, with verification.
2026-01-11T19:28:11.7412959Z                          .DESCRIPTION
2026-01-11T19:28:11.7413500Z                              Some winget installers return non-zero exit codes even when successful.
2026-01-11T19:28:11.7414277Z                              This function re-checks install state to avoid false negatives.
2026-01-11T19:28:11.7414850Z                          #>
2026-01-11T19:28:11.7415128Z                          param(
2026-01-11T19:28:11.7415413Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.7415671Z                              [string]$PackageId,
2026-01-11T19:28:11.7416068Z                      
2026-01-11T19:28:11.7416377Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.7416840Z                              [string]$PackageName
2026-01-11T19:28:11.7417209Z                          )
2026-01-11T19:28:11.7417571Z                      
2026-01-11T19:28:11.7418009Z                          if (Test-WingetPackageInstalled -PackageId $PackageId) {
2026-01-11T19:28:11.7418881Z                              Write-Ok "$PackageName already installed."
2026-01-11T19:28:11.7419180Z                              return $true
2026-01-11T19:28:11.7419497Z                          }
2026-01-11T19:28:11.7419787Z                      
2026-01-11T19:28:11.7420147Z                          Write-Note "Installing $PackageName via winget ($PackageId)."
2026-01-11T19:28:11.7421127Z                          $null = winget install --id $PackageId --source winget --accept-package-agreements 
2026-01-11T19:28:11.7421921Z                      --accept-source-agreements --silent 2>&1
2026-01-11T19:28:11.7422345Z                      
2026-01-11T19:28:11.7422637Z                          if ($LASTEXITCODE -eq 0) {
2026-01-11T19:28:11.7423058Z                              Write-Ok "$PackageName installed."
2026-01-11T19:28:11.7423485Z                              return $true
2026-01-11T19:28:11.7423769Z                          }
2026-01-11T19:28:11.7424048Z                      
2026-01-11T19:28:11.7424472Z                          # Some installs return a non-zero exit code even if the package is present.
2026-01-11T19:28:11.7425208Z                          if (Test-WingetPackageInstalled -PackageId $PackageId) {
2026-01-11T19:28:11.7426037Z                              Write-Ok "$PackageName already installed (post-install verification)."
2026-01-11T19:28:11.7426648Z                              return $true
2026-01-11T19:28:11.7427012Z                          }
2026-01-11T19:28:11.7427289Z                      
2026-01-11T19:28:11.7427768Z                          Write-Fail "Failed to install $PackageName (winget exit code $LASTEXITCODE)."
2026-01-11T19:28:11.7428380Z                          return $false
2026-01-11T19:28:11.7428579Z                      }
2026-01-11T19:28:11.7428832Z                      
2026-01-11T19:28:11.7429196Z                      function Get-RegistryInstallLocations {
2026-01-11T19:28:11.7429600Z                          <#
2026-01-11T19:28:11.7429940Z                          .SYNOPSIS
2026-01-11T19:28:11.7430689Z                              Finds install locations using registry uninstall entries.
2026-01-11T19:28:11.7431318Z                          .DESCRIPTION
2026-01-11T19:28:11.7431860Z                              This is a reliable fallback when installers register their paths.
2026-01-11T19:28:11.7432630Z                              It checks both 64-bit and 32-bit views to cover legacy installers.
2026-01-11T19:28:11.7433191Z                          #>
2026-01-11T19:28:11.7433512Z                          param(
2026-01-11T19:28:11.7433904Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.7434387Z                              [string]$DisplayNamePattern
2026-01-11T19:28:11.7435028Z                          )
2026-01-11T19:28:11.7435326Z                      
2026-01-11T19:28:11.7435922Z                          # Look for installer entries in HKLM and HKCU (both 64-bit and 32-bit views).
2026-01-11T19:28:11.7436566Z                          $registryPaths = @(
2026-01-11T19:28:11.7436985Z                              "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*",
2026-01-11T19:28:11.7437806Z                              "HKLM:\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall\*",
2026-01-11T19:28:11.7438691Z                              "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*"
2026-01-11T19:28:11.7439236Z                          )
2026-01-11T19:28:11.7439521Z                      
2026-01-11T19:28:11.7439778Z                          $locations = @()
2026-01-11T19:28:11.7440232Z                          foreach ($path in $registryPaths) {
2026-01-11T19:28:11.7440667Z                              try {
2026-01-11T19:28:11.7441256Z                                  $items = Get-ItemProperty -Path $path -ErrorAction SilentlyContinue |
2026-01-11T19:28:11.7442055Z                                      Where-Object { $_.DisplayName -like $DisplayNamePattern }
2026-01-11T19:28:11.7442773Z                      
2026-01-11T19:28:11.7443026Z                                  foreach ($item in $items) {
2026-01-11T19:28:11.7443514Z                                      if ($item.InstallLocation) {
2026-01-11T19:28:11.7444096Z                                          $locations += $item.InstallLocation
2026-01-11T19:28:11.7444700Z                                      } elseif ($item.DisplayIcon) {
2026-01-11T19:28:11.7445308Z                                          $locations += (Split-Path -Parent $item.DisplayIcon)
2026-01-11T19:28:11.7445877Z                                      }
2026-01-11T19:28:11.7446268Z                                  }
2026-01-11T19:28:11.7446588Z                              } catch {
2026-01-11T19:28:11.7447097Z                                  # Ignore registry access errors to keep the script robust.
2026-01-11T19:28:11.7447636Z                              }
2026-01-11T19:28:11.7447926Z                          }
2026-01-11T19:28:11.7448213Z                      
2026-01-11T19:28:11.7448559Z                          return $locations | Select-Object -Unique
2026-01-11T19:28:11.7448830Z                      }
2026-01-11T19:28:11.7450422Z                      
2026-01-11T19:28:11.7450882Z                      function Get-WingetInstalledLocation {
2026-01-11T19:28:11.7451340Z                          <#
2026-01-11T19:28:11.7451658Z                          .SYNOPSIS
2026-01-11T19:28:11.7452216Z                              Attempts to read the installed location from winget JSON output.
2026-01-11T19:28:11.7452807Z                          .DESCRIPTION
2026-01-11T19:28:11.7453319Z                              Newer winget versions can output JSON for "winget list".
2026-01-11T19:28:11.7454811Z                              When present, the JSON may include an install location field.
2026-01-11T19:28:11.7455658Z                              This is not guaranteed across versions, so this is best-effort only.
2026-01-11T19:28:11.7456201Z                          .OUTPUTS
2026-01-11T19:28:11.7456717Z                              [string] Install location path or $null if not available.
2026-01-11T19:28:11.7457585Z                          #>
2026-01-11T19:28:11.7458142Z                          param(
2026-01-11T19:28:11.7459555Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.7460084Z                              [string]$PackageId
2026-01-11T19:28:11.7461477Z                          )
2026-01-11T19:28:11.7461845Z                      
2026-01-11T19:28:11.7462657Z                          if (-not $script:WingetAvailable) {
2026-01-11T19:28:11.7463325Z                              return $null
2026-01-11T19:28:11.7463866Z                          }
2026-01-11T19:28:11.7465427Z                      
2026-01-11T19:28:11.7465745Z                          try {
2026-01-11T19:28:11.7467235Z                              $jsonText = winget list --id $PackageId --source winget --accept-source-agreements 
2026-01-11T19:28:11.7468067Z                      --output json 2>&1
2026-01-11T19:28:11.7468519Z                              if ($LASTEXITCODE -ne 0) {
2026-01-11T19:28:11.7468951Z                                  return $null
2026-01-11T19:28:11.7469384Z                              }
2026-01-11T19:28:11.7469709Z                      
2026-01-11T19:28:11.7470212Z                              $data = $jsonText | ConvertFrom-Json -ErrorAction Stop
2026-01-11T19:28:11.7471163Z                          } catch {
2026-01-11T19:28:11.7471565Z                              return $null
2026-01-11T19:28:11.7472246Z                          }
2026-01-11T19:28:11.7472763Z                      
2026-01-11T19:28:11.7473862Z                          $packages = @()
2026-01-11T19:28:11.7474312Z                          if ($data.Sources) {
2026-01-11T19:28:11.7474795Z                              foreach ($source in $data.Sources) {
2026-01-11T19:28:11.7476686Z                                  if ($source.Packages) {
2026-01-11T19:28:11.7477244Z                                      $packages += $source.Packages
2026-01-11T19:28:11.7477557Z                                  }
2026-01-11T19:28:11.7477781Z                              }
2026-01-11T19:28:11.7478152Z                          } elseif ($data.Packages) {
2026-01-11T19:28:11.7478831Z                              $packages += $data.Packages
2026-01-11T19:28:11.7479195Z                          }
2026-01-11T19:28:11.7479604Z                      
2026-01-11T19:28:11.7480183Z                          $match = $packages | Where-Object {
2026-01-11T19:28:11.7481021Z                              $_.PackageIdentifier -eq $PackageId -or $_.Id -eq $PackageId
2026-01-11T19:28:11.7481635Z                          } | Select-Object -First 1
2026-01-11T19:28:11.7482458Z                      
2026-01-11T19:28:11.7483061Z                          if (-not $match) {
2026-01-11T19:28:11.7483458Z                              return $null
2026-01-11T19:28:11.7483824Z                          }
2026-01-11T19:28:11.7484104Z                      
2026-01-11T19:28:11.7485729Z                          $locationProps = @("InstallLocation", "InstalledLocation", "Location", "InstallPath", 
2026-01-11T19:28:11.7486837Z                      "InstalledPath")
2026-01-11T19:28:11.7487204Z                          foreach ($prop in $locationProps) {
2026-01-11T19:28:11.7487840Z                              if ($match.PSObject.Properties.Name -contains $prop -and $match.$prop) {
2026-01-11T19:28:11.7488466Z                                  return $match.$prop
2026-01-11T19:28:11.7488827Z                              }
2026-01-11T19:28:11.7489011Z                          }
2026-01-11T19:28:11.7489396Z                      
2026-01-11T19:28:11.7491235Z                          return $null
2026-01-11T19:28:11.7491657Z                      }
2026-01-11T19:28:11.7491903Z                      
2026-01-11T19:28:11.7493205Z                      function Resolve-ExecutablePath {
2026-01-11T19:28:11.7493864Z                          <#
2026-01-11T19:28:11.7494648Z                          .SYNOPSIS
2026-01-11T19:28:11.7495259Z                              Resolves the full path to a tool executable.
2026-01-11T19:28:11.7495914Z                          .DESCRIPTION
2026-01-11T19:28:11.7496331Z                              Uses a multi-step strategy:
2026-01-11T19:28:11.7496892Z                                1) Known default paths (fast and deterministic)
2026-01-11T19:28:11.7497457Z                                2) Winget JSON install location (best effort)
2026-01-11T19:28:11.7498041Z                                3) Registry uninstall entries (best effort)
2026-01-11T19:28:11.7499018Z                                4) Limited folder scan under known vendor roots
2026-01-11T19:28:11.7499503Z                          #>
2026-01-11T19:28:11.7499804Z                          param(
2026-01-11T19:28:11.7500217Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.7500831Z                              [string[]]$ExeNames,
2026-01-11T19:28:11.7501467Z                      
2026-01-11T19:28:11.7502685Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.7503219Z                              [string[]]$DefaultCandidates,
2026-01-11T19:28:11.7504505Z                      
2026-01-11T19:28:11.7505017Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.7505589Z                              [string]$RegistryNamePattern,
2026-01-11T19:28:11.7505872Z                      
2026-01-11T19:28:11.7506441Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.7506940Z                              [string]$PackageId
2026-01-11T19:28:11.7507613Z                          )
2026-01-11T19:28:11.7508279Z                      
2026-01-11T19:28:11.7509124Z                          # Winget does not reliably expose install paths for all packages, so we use:
2026-01-11T19:28:11.7510163Z                          # 1) Known default paths (fast and predictable)
2026-01-11T19:28:11.7510955Z                          # 2) Winget JSON install location (best effort)
2026-01-11T19:28:11.7511776Z                          # 3) Registry uninstall entries (best effort)
2026-01-11T19:28:11.7512396Z                          # 4) Limited directory search under known vendor roots
2026-01-11T19:28:11.7512852Z                          #
2026-01-11T19:28:11.7513474Z                          # This keeps the script deterministic while still finding installs that
2026-01-11T19:28:11.7515001Z                          # do not use the defaults.
2026-01-11T19:28:11.7516007Z                      
2026-01-11T19:28:11.7516406Z                          # 1) Check known default paths first (fast and predictable).
2026-01-11T19:28:11.7517338Z                          foreach ($candidate in $DefaultCandidates) {
2026-01-11T19:28:11.7518075Z                              if (Test-Path $candidate) {
2026-01-11T19:28:11.7518563Z                                  return $candidate
2026-01-11T19:28:11.7518936Z                              }
2026-01-11T19:28:11.7519251Z                          }
2026-01-11T19:28:11.7520090Z                      
2026-01-11T19:28:11.7521113Z                          # 2) Check winget JSON install location (if supported by the local winget).
2026-01-11T19:28:11.7522031Z                          $wingetLocation = Get-WingetInstalledLocation -PackageId $PackageId
2026-01-11T19:28:11.7522791Z                          if ($wingetLocation -and (Test-Path $wingetLocation)) {
2026-01-11T19:28:11.7523489Z                              $wingetItem = Get-Item $wingetLocation -ErrorAction SilentlyContinue
2026-01-11T19:28:11.7524425Z                              if ($wingetItem -and -not $wingetItem.PSIsContainer) {
2026-01-11T19:28:11.7524834Z                                  return $wingetLocation
2026-01-11T19:28:11.7525122Z                              }
2026-01-11T19:28:11.7525458Z                      
2026-01-11T19:28:11.7525803Z                              foreach ($exeName in $ExeNames) {
2026-01-11T19:28:11.7526342Z                                  $wingetExe = Join-Path $wingetLocation $exeName
2026-01-11T19:28:11.7527084Z                                  if (Test-Path $wingetExe) {
2026-01-11T19:28:11.7527889Z                                      return $wingetExe
2026-01-11T19:28:11.7529093Z                                  }
2026-01-11T19:28:11.7529314Z                      
2026-01-11T19:28:11.7530021Z                                  $wingetBinExe = Join-Path (Join-Path $wingetLocation "bin") $exeName
2026-01-11T19:28:11.7530629Z                                  if (Test-Path $wingetBinExe) {
2026-01-11T19:28:11.7531961Z                                      return $wingetBinExe
2026-01-11T19:28:11.7532441Z                                  }
2026-01-11T19:28:11.7532661Z                              }
2026-01-11T19:28:11.7533884Z                          }
2026-01-11T19:28:11.7534427Z                      
2026-01-11T19:28:11.7535705Z                          # 3) Check install locations reported in the registry.
2026-01-11T19:28:11.7536743Z                          $registryLocations = Get-RegistryInstallLocations -DisplayNamePattern $RegistryNamePattern
2026-01-11T19:28:11.7537708Z                          foreach ($location in $registryLocations) {
2026-01-11T19:28:11.7538244Z                              foreach ($exeName in $ExeNames) {
2026-01-11T19:28:11.7538783Z                                  $exePath = Join-Path $location $exeName
2026-01-11T19:28:11.7539200Z                                  if (Test-Path $exePath) {
2026-01-11T19:28:11.7539667Z                                      return $exePath
2026-01-11T19:28:11.7540097Z                                  }
2026-01-11T19:28:11.7540408Z                      
2026-01-11T19:28:11.7540839Z                                  # Some installers put binaries in a subfolder like "bin".
2026-01-11T19:28:11.7541825Z                                  $binExePath = Join-Path (Join-Path $location "bin") $exeName
2026-01-11T19:28:11.7542398Z                                  if (Test-Path $binExePath) {
2026-01-11T19:28:11.7542765Z                                      return $binExePath
2026-01-11T19:28:11.7542998Z                                  }
2026-01-11T19:28:11.7543371Z                              }
2026-01-11T19:28:11.7543689Z                          }
2026-01-11T19:28:11.7544042Z                      
2026-01-11T19:28:11.7544696Z                          # 4) Last resort: search a specific root if it exists.
2026-01-11T19:28:11.7545762Z                          # This is intentionally limited to known vendor roots to avoid a full disk scan.
2026-01-11T19:28:11.7546522Z                          foreach ($location in $registryLocations) {
2026-01-11T19:28:11.7547574Z                              if (Test-Path $location) {
2026-01-11T19:28:11.7548041Z                                  try {
2026-01-11T19:28:11.7548692Z                                      foreach ($exeName in $ExeNames) {
2026-01-11T19:28:11.7550040Z                                          $found = Get-ChildItem -Path $location -Recurse -Filter $exeName -ErrorAction 
2026-01-11T19:28:11.7550798Z                      SilentlyContinue |
2026-01-11T19:28:11.7551179Z                                              Select-Object -First 1
2026-01-11T19:28:11.7551637Z                                          if ($found) {
2026-01-11T19:28:11.7552191Z                                              return $found.FullName
2026-01-11T19:28:11.7553536Z                                          }
2026-01-11T19:28:11.7554115Z                                      }
2026-01-11T19:28:11.7555344Z                                  } catch {
2026-01-11T19:28:11.7555776Z                                      # Ignore access errors.
2026-01-11T19:28:11.7556227Z                                  }
2026-01-11T19:28:11.7557234Z                              }
2026-01-11T19:28:11.7557607Z                          }
2026-01-11T19:28:11.7558923Z                      
2026-01-11T19:28:11.7559530Z                          return $null
2026-01-11T19:28:11.7560370Z                      }
2026-01-11T19:28:11.7560828Z                      
2026-01-11T19:28:11.7562002Z                      
2026-01-11T19:28:11.7562629Z                      # ----------------------------
2026-01-11T19:28:11.7563112Z                      # Benchmark stack definition
2026-01-11T19:28:11.7563617Z                      # ----------------------------
2026-01-11T19:28:11.7564932Z                      
2026-01-11T19:28:11.7565588Z                      Write-Section "Benchmark Stack"
2026-01-11T19:28:11.7566683Z                      Write-Note "This script installs a small, free toolchain for FPS and frametime testing."
2026-01-11T19:28:11.7567425Z                      Write-Note "It does not change system settings. It only installs tools and launches them."
2026-01-11T19:28:11.7568452Z                      Write-Note "These tools were chosen because they are repeatable and measurable:"
2026-01-11T19:28:11.7570455Z                      Write-Note "- CapFrameX: frametime capture and percentile lows (more honest than avg FPS alone)."
2026-01-11T19:28:11.7571526Z                      Write-Note "- Superposition: fixed GPU workload with repeatable scoring."
2026-01-11T19:28:11.7572412Z                      Write-Note "- LatencyMon: validates DPC/ISR latency to explain micro-stutter."
2026-01-11T19:28:11.7573309Z                      Write-Note "Windows 10 and 11 use the same default install paths for these tools."
2026-01-11T19:28:11.7574333Z                      Write-Note "The script targets 64-bit installs and still checks legacy locations for safety."
2026-01-11T19:28:11.7575004Z                      
2026-01-11T19:28:11.7575283Z                      $packages = @(
2026-01-11T19:28:11.7575695Z                          # Each package entry defines:
2026-01-11T19:28:11.7576377Z                          #   - Winget ID for installation
2026-01-11T19:28:11.7576883Z                          #   - Default executable paths for x64 installs
2026-01-11T19:28:11.7577412Z                          #   - Config checklist steps for repeatable results
2026-01-11T19:28:11.7578003Z                          #   - Whether to launch automatically when found
2026-01-11T19:28:11.7578523Z                          @{
2026-01-11T19:28:11.7578840Z                              Id = "CXWorld.CapFrameX"
2026-01-11T19:28:11.7579183Z                              Name = "CapFrameX"
2026-01-11T19:28:11.7579768Z                              Purpose = "Captures frametimes and computes avg FPS, 1% low, and 0.1% low."
2026-01-11T19:28:11.7580492Z                              ExeNames = @("CapFrameX.exe")
2026-01-11T19:28:11.7580781Z                              RegistryPattern = "*CapFrameX*"
2026-01-11T19:28:11.7581242Z                              DefaultPaths = @(
2026-01-11T19:28:11.7581744Z                                  "C:\Program Files\CapFrameX\CapFrameX.exe",
2026-01-11T19:28:11.7582293Z                                  "C:\Program Files (x86)\CapFrameX\CapFrameX.exe"
2026-01-11T19:28:11.7582797Z                              )
2026-01-11T19:28:11.7583132Z                              Configure = @(
2026-01-11T19:28:11.7583529Z                                  "Capture API: PresentMon",
2026-01-11T19:28:11.7584009Z                                  "Capture duration: 60s",
2026-01-11T19:28:11.7584477Z                                  "Start delay: 3s",
2026-01-11T19:28:11.7584954Z                                  "Hotkey: F11 (start/stop capture)",
2026-01-11T19:28:11.7585554Z                                  "Overlay optional; do not enable additional overlays for clean results"
2026-01-11T19:28:11.7586114Z                              )
2026-01-11T19:28:11.7586466Z                              Launch = $true
2026-01-11T19:28:11.7586815Z                          },
2026-01-11T19:28:11.7586989Z                          @{
2026-01-11T19:28:11.7588098Z                              Id = "Unigine.SuperpositionBenchmark"
2026-01-11T19:28:11.7588691Z                              Name = "Unigine Superposition"
2026-01-11T19:28:11.7589606Z                              Purpose = "Repeatable GPU benchmark for consistent before/after comparisons."
2026-01-11T19:28:11.7590356Z                              ExeNames = @("Superposition.exe")
2026-01-11T19:28:11.7590784Z                              RegistryPattern = "*Superposition*"
2026-01-11T19:28:11.7591076Z                              DefaultPaths = @(
2026-01-11T19:28:11.7591629Z                                  "C:\Program Files\Unigine\Superposition\Superposition.exe",
2026-01-11T19:28:11.7592576Z                                  "C:\Program Files\Unigine\Superposition\bin\Superposition.exe"
2026-01-11T19:28:11.7593282Z                              )
2026-01-11T19:28:11.7593652Z                              Configure = @(
2026-01-11T19:28:11.7594144Z                                  "Preset: 1080p Medium",
2026-01-11T19:28:11.7594566Z                                  "Fullscreen: On",
2026-01-11T19:28:11.7595129Z                                  "VSync: Off",
2026-01-11T19:28:11.7595811Z                                  "Run 3 passes; discard the first (shader compilation), average the rest"
2026-01-11T19:28:11.7596699Z                              )
2026-01-11T19:28:11.7597014Z                              Launch = $true
2026-01-11T19:28:11.7597396Z                          },
2026-01-11T19:28:11.7597989Z                          @{
2026-01-11T19:28:11.7599201Z                              Id = "Resplendence.LatencyMon"
2026-01-11T19:28:11.7599711Z                              Name = "LatencyMon"
2026-01-11T19:28:11.7601418Z                              Purpose = "Detects DPC/ISR latency spikes that can cause stutter or audio crackle."
2026-01-11T19:28:11.7602280Z                              ExeNames = @("LatencyMon.exe", "LatMon.exe")
2026-01-11T19:28:11.7603048Z                              RegistryPattern = "*LatencyMon*"
2026-01-11T19:28:11.7603495Z                              DefaultPaths = @(
2026-01-11T19:28:11.7603923Z                                  "C:\Program Files\LatencyMon\LatencyMon.exe",
2026-01-11T19:28:11.7604423Z                                  "C:\Program Files\LatencyMon\LatMon.exe",
2026-01-11T19:28:11.7605023Z                                  "C:\Program Files (x86)\LatencyMon\LatencyMon.exe",
2026-01-11T19:28:11.7605640Z                                  "C:\Program Files (x86)\LatencyMon\LatMon.exe",
2026-01-11T19:28:11.7606634Z                                  "C:\Program Files\Resplendence\LatencyMon\LatencyMon.exe",
2026-01-11T19:28:11.7607320Z                                  "C:\Program Files\Resplendence\LatencyMon\LatMon.exe",
2026-01-11T19:28:11.7608303Z                                  "C:\Program Files (x86)\Resplendence\LatencyMon\LatencyMon.exe",
2026-01-11T19:28:11.7609164Z                                  "C:\Program Files (x86)\Resplendence\LatencyMon\LatMon.exe"
2026-01-11T19:28:11.7609704Z                              )
2026-01-11T19:28:11.7611044Z                              Configure = @(
2026-01-11T19:28:11.7611551Z                                  "Run for 5 minutes while Superposition is running",
2026-01-11T19:28:11.7612168Z                                  "Record Main + Drivers tab screenshots for evidence"
2026-01-11T19:28:11.7612675Z                              )
2026-01-11T19:28:11.7613029Z                              Launch = $true
2026-01-11T19:28:11.7613426Z                          }
2026-01-11T19:28:11.7613689Z                      )
2026-01-11T19:28:11.7614509Z                      
2026-01-11T19:28:11.7615052Z                      
2026-01-11T19:28:11.7616115Z                      # ----------------------------
2026-01-11T19:28:11.7616560Z                      # Main flow
2026-01-11T19:28:11.7616938Z                      # ----------------------------
2026-01-11T19:28:11.7618158Z                      
2026-01-11T19:28:11.7618457Z                      try {
2026-01-11T19:28:11.7619662Z                          Write-Section "Pre-Checks"
2026-01-11T19:28:11.7620220Z                          Write-Note "Ensure the following for fair results:"
2026-01-11T19:28:11.7621732Z                          Write-Note "- Close browsers, launchers, and overlays (except CapFrameX)."
2026-01-11T19:28:11.7622731Z                          Write-Note "- Keep power plan and NVIDIA Control Panel settings identical before/after."
2026-01-11T19:28:11.7623541Z                          Write-Note "- Reboot before the before and after runs, if possible."
2026-01-11T19:28:11.7624457Z                          Write-Note "- If you double-clicked this script and it closes immediately, run:"
2026-01-11T19:28:11.7625391Z                          Write-Note "  powershell -ExecutionPolicy Bypass -File .\\benchmark-setup.ps1"
2026-01-11T19:28:11.7626089Z                      
2026-01-11T19:28:11.7626655Z                          $installConsent = Confirm-InstallConsent -PackageNames ($packages | ForEach-Object { $_.Name 
2026-01-11T19:28:11.7627311Z                      })
2026-01-11T19:28:11.7627501Z                      
2026-01-11T19:28:11.7627807Z                          if ($installConsent) {
2026-01-11T19:28:11.7628266Z                              if (-not (Install-WingetIfMissing)) {
2026-01-11T19:28:11.7628752Z                                  throw "winget is required to continue."
2026-01-11T19:28:11.7629473Z                              }
2026-01-11T19:28:11.7629768Z                      
2026-01-11T19:28:11.7630142Z                              $script:WingetAvailable = Test-WingetAvailable
2026-01-11T19:28:11.7630672Z                      
2026-01-11T19:28:11.7631028Z                              Write-Section "Install Required Tools"
2026-01-11T19:28:11.7631462Z                              $totalPkgs = $packages.Count
2026-01-11T19:28:11.7632157Z                              $currentPkg = 0
2026-01-11T19:28:11.7632657Z                              foreach ($package in $packages) {
2026-01-11T19:28:11.7633504Z                                  $currentPkg++
2026-01-11T19:28:11.7634502Z                                  $pct = [math]::Round(($currentPkg / $totalPkgs) * 100)
2026-01-11T19:28:11.7635350Z                                  Write-Progress -Activity "Installing Tools" -Status $package.Name -PercentComplete 
2026-01-11T19:28:11.7636209Z                      $pct -CurrentOperation "$currentPkg of $totalPkgs"
2026-01-11T19:28:11.7636766Z                                  Write-Note "$($package.Name): $($package.Purpose)"
2026-01-11T19:28:11.7637640Z                                  $installed = Install-WingetPackage -PackageId $package.Id -PackageName $package.Name
2026-01-11T19:28:11.7638372Z                                  if (-not $installed) {
2026-01-11T19:28:11.7639131Z                                      Write-Warn "$($package.Name) failed to install. The script will continue, but 
2026-01-11T19:28:11.7639869Z                      launching may fail."
2026-01-11T19:28:11.7640153Z                                  }
2026-01-11T19:28:11.7640602Z                              }
2026-01-11T19:28:11.7641086Z                              Write-Progress -Activity "Installing Tools" -Completed
2026-01-11T19:28:11.7641823Z                          } else {
2026-01-11T19:28:11.7642558Z                              # The user did not approve installs. We still try to locate and launch
2026-01-11T19:28:11.7643185Z                              # any tools that are already installed.
2026-01-11T19:28:11.7643768Z                              $script:WingetAvailable = Test-WingetAvailable
2026-01-11T19:28:11.7644332Z                              if (-not $script:WingetAvailable) {
2026-01-11T19:28:11.7646082Z                                  Write-Warn "winget is not available, so install-location lookup via winget is 
2026-01-11T19:28:11.7646832Z                      disabled."
2026-01-11T19:28:11.7647205Z                              }
2026-01-11T19:28:11.7647458Z                          }
2026-01-11T19:28:11.7647747Z                      
2026-01-11T19:28:11.7648513Z                          Write-Section "Locate Executables"
2026-01-11T19:28:11.7650149Z                          foreach ($package in $packages) {
2026-01-11T19:28:11.7651177Z                              $path = Resolve-ExecutablePath -ExeNames $package.ExeNames `
2026-01-11T19:28:11.7651851Z                                  -DefaultCandidates $package.DefaultPaths `
2026-01-11T19:28:11.7652415Z                                  -RegistryNamePattern $package.RegistryPattern `
2026-01-11T19:28:11.7653305Z                                  -PackageId $package.Id
2026-01-11T19:28:11.7653767Z                      
2026-01-11T19:28:11.7654766Z                              if ($path) {
2026-01-11T19:28:11.7655626Z                                  Write-Ok "$($package.Name) executable found at: $path"
2026-01-11T19:28:11.7656272Z                                  $package["Path"] = $path
2026-01-11T19:28:11.7656952Z                              } else {
2026-01-11T19:28:11.7657866Z                                  Write-Warn "Could not locate $($package.Name) executable. Launch will be skipped."
2026-01-11T19:28:11.7658635Z                                  $package["Path"] = $null
2026-01-11T19:28:11.7660032Z                              }
2026-01-11T19:28:11.7660388Z                          }
2026-01-11T19:28:11.7661603Z                      
2026-01-11T19:28:11.7662278Z                          Write-Section "Configuration Checklist"
2026-01-11T19:28:11.7663288Z                          foreach ($package in $packages) {
2026-01-11T19:28:11.7664585Z                              Write-Host ""
2026-01-11T19:28:11.7665244Z                              Write-Host "$($package.Name) configuration:" -ForegroundColor Cyan
2026-01-11T19:28:11.7665755Z                              foreach ($step in $package.Configure) {
2026-01-11T19:28:11.7665977Z                                  Write-Host "  - $step" -ForegroundColor White
2026-01-11T19:28:11.7666095Z                              }
2026-01-11T19:28:11.7666949Z                          }
2026-01-11T19:28:11.7667893Z                      
2026-01-11T19:28:11.7668640Z                          Write-Section "Launch Tools"
2026-01-11T19:28:11.7670118Z                          foreach ($package in $packages) {
2026-01-11T19:28:11.7670698Z                              if (-not $package.Launch) {
2026-01-11T19:28:11.7671148Z                                  continue
2026-01-11T19:28:11.7672276Z                              }
2026-01-11T19:28:11.7673160Z                      
2026-01-11T19:28:11.7674110Z                              if ($package["Path"]) {
2026-01-11T19:28:11.7674740Z                                  Write-Note "Launching $($package.Name)..."
2026-01-11T19:28:11.7675329Z                                  try {
2026-01-11T19:28:11.7676401Z                                      $process = Start-Process -FilePath $package["Path"] -PassThru -ErrorAction Stop
2026-01-11T19:28:11.7676653Z                                      Start-Sleep -Milliseconds 300
2026-01-11T19:28:11.7678522Z                                      if ($process -and -not $process.HasExited) {
2026-01-11T19:28:11.7679136Z                                          Write-Ok "$($package.Name) launched (PID $($process.Id))."
2026-01-11T19:28:11.7679391Z                                      } else {
2026-01-11T19:28:11.7681206Z                                          Write-Warn "$($package.Name) launched but exited immediately. Try starting it 
2026-01-11T19:28:11.7681357Z                      manually:"
2026-01-11T19:28:11.7681792Z                                          Write-Warn "  $($package["Path"])"
2026-01-11T19:28:11.7681986Z                                      }
2026-01-11T19:28:11.7683268Z                                  } catch {
2026-01-11T19:28:11.7684311Z                                      Write-Warn "Failed to launch $($package.Name). Try starting it manually:"
2026-01-11T19:28:11.7685250Z                                      Write-Warn "  $($package["Path"])"
2026-01-11T19:28:11.7686889Z                                      Write-Warn "Error: $($_.Exception.Message)"
2026-01-11T19:28:11.7687203Z                                  }
2026-01-11T19:28:11.7688376Z                              } else {
2026-01-11T19:28:11.7688733Z                                  Write-Warn "Skipping launch for $($package.Name) (path not found)."
2026-01-11T19:28:11.7689724Z                              }
2026-01-11T19:28:11.7689882Z                          }
2026-01-11T19:28:11.7691175Z                      
2026-01-11T19:28:11.7691756Z                          Write-Section "Input Lag Evidence (Free Method)"
2026-01-11T19:28:11.7692895Z                          Write-Note "Use a 240fps phone video to measure click-to-photon latency:"
2026-01-11T19:28:11.7693351Z                          Write-Note "1) Fullscreen a click-response test (any simple local page or app)."
2026-01-11T19:28:11.7694371Z                          Write-Note "2) Record 10 clicks in slow motion."
2026-01-11T19:28:11.7695028Z                          Write-Note "3) Count frames between click and on-screen change."
2026-01-11T19:28:11.7696187Z                          Write-Note "At 240fps, 1 frame = 4.17ms. Average the 10 results."
2026-01-11T19:28:11.7696304Z                      
2026-01-11T19:28:11.7697179Z                          Write-Section "Run Protocol Summary"
2026-01-11T19:28:11.7698266Z                          Write-Note "Warm up once without capturing."
2026-01-11T19:28:11.7699603Z                          Write-Note "Capture 2 valid runs with CapFrameX (press F11 to start/stop)."
2026-01-11T19:28:11.7699844Z                          Write-Note "Apply your app changes."
2026-01-11T19:28:11.7701075Z                          Write-Note "Repeat the warmup + 2 runs."
2026-01-11T19:28:11.7701739Z                          Write-Note "Compare Avg FPS, 1% low, 0.1% low, and frametime graphs."
2026-01-11T19:28:11.7702030Z                      
2026-01-11T19:28:11.7703501Z                          Write-Ok "Benchmark stack is ready."
2026-01-11T19:28:11.7703827Z                          Write-Progress -Activity "Benchmark Setup" -Completed
2026-01-11T19:28:11.7703931Z                      
2026-01-11T19:28:11.7705336Z                          Show-RockTuneFinalChecklist
2026-01-11T19:28:11.7705450Z                      } catch {
2026-01-11T19:28:11.7706630Z                          Write-Fail "Script failed: $($_.Exception.Message)"
2026-01-11T19:28:11.7706743Z                      } finally {
2026-01-11T19:28:11.7707634Z                          if ($script:HadFailures) {
2026-01-11T19:28:11.7708182Z                              Write-Warn "One or more steps failed. Review the messages above."
2026-01-11T19:28:11.7709196Z                          }
2026-01-11T19:28:11.7710041Z                          Wait-ForUserExit
2026-01-11T19:28:11.7710873Z                      }
2026-01-11T19:28:11.7711976Z                      
2026-01-11T19:28:11.7712484Z [32;1mCleanBlock         : [0m
2026-01-11T19:28:11.7713663Z [32;1mDynamicParamBlock  : [0m
2026-01-11T19:28:11.7714154Z [32;1mScriptRequirements : [0mSystem.Management.Automation.Language.ScriptRequirements
2026-01-11T19:28:11.7717696Z [32;1mExtent             : [0m<#
2026-01-11T19:28:11.7717823Z                      .SYNOPSIS
2026-01-11T19:28:11.7718656Z                          One-click installer and launcher for a reproducible FPS + frametime benchmark stack.
2026-01-11T19:28:11.7719487Z                      .DESCRIPTION
2026-01-11T19:28:11.7720448Z                          This script installs and launches the minimum free tools required to produce
2026-01-11T19:28:11.7721538Z                          credible before/after FPS and frametime results:
2026-01-11T19:28:11.7721814Z                            - CapFrameX (frametime capture, 1%/0.1% lows)
2026-01-11T19:28:11.7722087Z                            - Unigine Superposition (repeatable GPU benchmark)
2026-01-11T19:28:11.7722485Z                            - LatencyMon (DPC/ISR latency diagnostics)
2026-01-11T19:28:11.7723442Z                      
2026-01-11T19:28:11.7724586Z                          The script is intentionally verbose and transparent. It explains:
2026-01-11T19:28:11.7724750Z                            - What each tool does
2026-01-11T19:28:11.7724897Z                            - Why it is included
2026-01-11T19:28:11.7726130Z                            - What configuration is required for repeatable runs
2026-01-11T19:28:11.7726839Z                            - How to launch the tools and capture results
2026-01-11T19:28:11.7727026Z                      
2026-01-11T19:28:11.7728320Z                          Configuration is done via explicit instructions because these tools do not
2026-01-11T19:28:11.7728959Z                          expose stable, documented config file formats for automation. This approach
2026-01-11T19:28:11.7729359Z                          avoids silently writing unknown settings and keeps the process reproducible.
2026-01-11T19:28:11.7729460Z                      
2026-01-11T19:28:11.7730695Z                          Run this script in an elevated PowerShell (Run as Administrator).
2026-01-11T19:28:11.7730797Z                      
2026-01-11T19:28:11.7732169Z                      .PARAMETER ResetConsent
2026-01-11T19:28:11.7732563Z                          Clears the saved install consent cache and re-prompts on next run.
2026-01-11T19:28:11.7732937Z                          Use this if you previously declined installs but now want to allow them.
2026-01-11T19:28:11.7733928Z                      
2026-01-11T19:28:11.7734789Z                      .PARAMETER AutoAccept
2026-01-11T19:28:11.7735820Z                          Automatically accepts install consent without prompting.
2026-01-11T19:28:11.7736467Z                          Useful for CI/CD pipelines, automated testing, or scripted deployments.
2026-01-11T19:28:11.7737412Z                          This bypasses both the install prompt and the "remember choice" prompt.
2026-01-11T19:28:11.7737749Z                      
2026-01-11T19:28:11.7738797Z                      .USAGE
2026-01-11T19:28:11.7739157Z                          1) Right-click this file and select "Run as administrator".
2026-01-11T19:28:11.7740418Z                          2) Let the script install tools via winget if missing.
2026-01-11T19:28:11.7740724Z                          3) Follow the configuration checklist printed for each tool.
2026-01-11T19:28:11.7741013Z                          4) Run the benchmark before/after your changes and export results.
2026-01-11T19:28:11.7741896Z                      
2026-01-11T19:28:11.7742188Z                          Hosted one-liner (downloads and runs this script):
2026-01-11T19:28:11.7743214Z                            irm https://rocktune.pedroferrari.com/benchmark.ps1 | iex
2026-01-11T19:28:11.7744473Z                      
2026-01-11T19:28:11.7744841Z                          You can inspect the source before running:
2026-01-11T19:28:11.7745968Z                            .\benchmark-setup.ps1
2026-01-11T19:28:11.7746444Z                            https://rocktune.pedroferrari.com/benchmark.ps1
2026-01-11T19:28:11.7747272Z                      
2026-01-11T19:28:11.7748363Z                          If double-clicking closes the window immediately, run:
2026-01-11T19:28:11.7748710Z                            powershell -ExecutionPolicy Bypass -File .\benchmark-setup.ps1
2026-01-11T19:28:11.7748807Z                      
2026-01-11T19:28:11.7749513Z                          Unattended/automated execution (skips all prompts):
2026-01-11T19:28:11.7750648Z                            .\benchmark-setup.ps1 -AutoAccept
2026-01-11T19:28:11.7750948Z                      
2026-01-11T19:28:11.7751989Z                          To clear the saved install consent and re-prompt:
2026-01-11T19:28:11.7752462Z                            .\benchmark-setup.ps1 -ResetConsent
2026-01-11T19:28:11.7753453Z                      
2026-01-11T19:28:11.7753862Z                      .NOTES
2026-01-11T19:28:11.7755313Z                          Requires Administrator because winget installation and app installs may
2026-01-11T19:28:11.7755651Z                          require elevation on some systems. Also uses the Microsoft Store fallback
2026-01-11T19:28:11.7756124Z                          flow if winget is missing.
2026-01-11T19:28:11.7756776Z                      
2026-01-11T19:28:11.7757979Z                          Documentation: https://rocktune.pedroferrari.com
2026-01-11T19:28:11.7759112Z                          Source: https://github.com/thepedroferrari/rocktune
2026-01-11T19:28:11.7760079Z                          Issues: https://github.com/thepedroferrari/rocktune/issues
2026-01-11T19:28:11.7760232Z                      #>
2026-01-11T19:28:11.7760385Z                      #Requires -RunAsAdministrator
2026-01-11T19:28:11.7760853Z                      
2026-01-11T19:28:11.7761610Z                      [CmdletBinding()]
2026-01-11T19:28:11.7762006Z                      param(
2026-01-11T19:28:11.7763408Z                          [switch]$ResetConsent,
2026-01-11T19:28:11.7763900Z                          [switch]$AutoAccept
2026-01-11T19:28:11.7764028Z                      )
2026-01-11T19:28:11.7764193Z                      
2026-01-11T19:28:11.7765865Z                      
2026-01-11T19:28:11.7766047Z                      # ----------------------------
2026-01-11T19:28:11.7767589Z                      # Global behavior and helpers
2026-01-11T19:28:11.7767830Z                      # ----------------------------
2026-01-11T19:28:11.7768383Z                      
2026-01-11T19:28:11.7769314Z                      $ErrorActionPreference = "Stop"
2026-01-11T19:28:11.7769783Z                      $script:HadFailures = $false
2026-01-11T19:28:11.7770850Z                      $script:WingetAvailable = $false
2026-01-11T19:28:11.7771625Z                      $script:ResetConsent = $ResetConsent
2026-01-11T19:28:11.7773132Z                      $script:ConsentRoot = Join-Path $env:LOCALAPPDATA "WindowsGamingSettings"
2026-01-11T19:28:11.7773549Z                      $script:ConsentFilePath = Join-Path $script:ConsentRoot "benchmark-consent.json"
2026-01-11T19:28:11.7773770Z                      
2026-01-11T19:28:11.7774931Z                      # Progress tracking
2026-01-11T19:28:11.7775141Z                      $script:SectionIndex = 0
2026-01-11T19:28:11.7776032Z                      $script:SectionTotal = 0
2026-01-11T19:28:11.7776186Z                      
2026-01-11T19:28:11.7777098Z                      function Get-SectionTotal {
2026-01-11T19:28:11.7778356Z                          <#
2026-01-11T19:28:11.7779173Z                          .SYNOPSIS
2026-01-11T19:28:11.7780271Z                              Counts the number of Write-Section calls in the main script.
2026-01-11T19:28:11.7780741Z                          #>
2026-01-11T19:28:11.7781748Z                          param(
2026-01-11T19:28:11.7781970Z                              [string]$ScriptPath = $PSCommandPath
2026-01-11T19:28:11.7782857Z                          )
2026-01-11T19:28:11.7783723Z                      
2026-01-11T19:28:11.7784488Z                          if (-not $ScriptPath) {
2026-01-11T19:28:11.7785948Z                              $ScriptPath = $MyInvocation.MyCommand.Path
2026-01-11T19:28:11.7786195Z                          }
2026-01-11T19:28:11.7786594Z                      
2026-01-11T19:28:11.7787358Z                          if (-not $ScriptPath -or -not (Test-Path $ScriptPath)) {
2026-01-11T19:28:11.7788444Z                              return 1
2026-01-11T19:28:11.7788580Z                          }
2026-01-11T19:28:11.7789606Z                      
2026-01-11T19:28:11.7790337Z                          $matches = Select-String -Path $ScriptPath -Pattern 'Write-Section\s+["\']' -AllMatches
2026-01-11T19:28:11.7791349Z                          return [math]::Max(1, $matches.Count)
2026-01-11T19:28:11.7792499Z                      }
2026-01-11T19:28:11.7792598Z                      
2026-01-11T19:28:11.7793803Z                      $script:SectionTotal = Get-SectionTotal
2026-01-11T19:28:11.7794239Z                      
2026-01-11T19:28:11.7795297Z                      function Write-Section {
2026-01-11T19:28:11.7795744Z                          <#
2026-01-11T19:28:11.7796611Z                          .SYNOPSIS
2026-01-11T19:28:11.7796888Z                              Writes a high-visibility section header to the console.
2026-01-11T19:28:11.7797465Z                          .DESCRIPTION
2026-01-11T19:28:11.7798564Z                              Used to separate major phases such as installs, configuration, and launch.
2026-01-11T19:28:11.7798764Z                          #>
2026-01-11T19:28:11.7800104Z                          param(
2026-01-11T19:28:11.7801195Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.7802308Z                              [string]$Title
2026-01-11T19:28:11.7802509Z                          )
2026-01-11T19:28:11.7803896Z                      
2026-01-11T19:28:11.7804644Z                          $script:SectionIndex++
2026-01-11T19:28:11.7806046Z                          $pct = [math]::Min(100, [math]::Round(($script:SectionIndex / $script:SectionTotal) * 100))
2026-01-11T19:28:11.7807343Z                          Write-Progress -Activity "Benchmark Setup" -Status $Title -PercentComplete $pct 
2026-01-11T19:28:11.7808141Z                      -CurrentOperation "Step $($script:SectionIndex) of $($script:SectionTotal)"
2026-01-11T19:28:11.7808343Z                      
2026-01-11T19:28:11.7809103Z                          Write-Host ""
2026-01-11T19:28:11.7810453Z                          Write-Host "=== $Title ===" -ForegroundColor Cyan
2026-01-11T19:28:11.7810821Z                      }
2026-01-11T19:28:11.7812256Z                      
2026-01-11T19:28:11.7812649Z                      function Write-Note {
2026-01-11T19:28:11.7814262Z                          <#
2026-01-11T19:28:11.7814438Z                          .SYNOPSIS
2026-01-11T19:28:11.7816056Z                              Writes informational messages in a consistent format.
2026-01-11T19:28:11.7816209Z                          .DESCRIPTION
2026-01-11T19:28:11.7816724Z                              These messages are non-fatal and describe what the script is doing.
2026-01-11T19:28:11.7817668Z                          #>
2026-01-11T19:28:11.7818171Z                          param(
2026-01-11T19:28:11.7819324Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.7819783Z                              [string]$Message
2026-01-11T19:28:11.7820925Z                          )
2026-01-11T19:28:11.7821057Z                      
2026-01-11T19:28:11.7822241Z                          Write-Host "[INFO] $Message" -ForegroundColor Gray
2026-01-11T19:28:11.7822621Z                      }
2026-01-11T19:28:11.7823717Z                      
2026-01-11T19:28:11.7823925Z                      function Write-Warn {
2026-01-11T19:28:11.7824384Z                          <#
2026-01-11T19:28:11.7825224Z                          .SYNOPSIS
2026-01-11T19:28:11.7826755Z                              Writes warnings that do not stop execution.
2026-01-11T19:28:11.7826902Z                          .DESCRIPTION
2026-01-11T19:28:11.7828259Z                              Warnings indicate reduced automation or missing optional data.
2026-01-11T19:28:11.7828405Z                          #>
2026-01-11T19:28:11.7829441Z                          param(
2026-01-11T19:28:11.7829989Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.7831131Z                              [string]$Message
2026-01-11T19:28:11.7831267Z                          )
2026-01-11T19:28:11.7832311Z                      
2026-01-11T19:28:11.7833724Z                          Write-Host "[WARN] $Message" -ForegroundColor Yellow
2026-01-11T19:28:11.7833880Z                      }
2026-01-11T19:28:11.7834667Z                      
2026-01-11T19:28:11.7835577Z                      function Write-Fail {
2026-01-11T19:28:11.7836348Z                          <#
2026-01-11T19:28:11.7836681Z                          .SYNOPSIS
2026-01-11T19:28:11.7837835Z                              Writes a failure message and marks the run as having errors.
2026-01-11T19:28:11.7838281Z                          .DESCRIPTION
2026-01-11T19:28:11.7839405Z                              The script will still continue to the exit prompt for transparency.
2026-01-11T19:28:11.7839564Z                          #>
2026-01-11T19:28:11.7839956Z                          param(
2026-01-11T19:28:11.7840904Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.7841390Z                              [string]$Message
2026-01-11T19:28:11.7841932Z                          )
2026-01-11T19:28:11.7842421Z                      
2026-01-11T19:28:11.7843933Z                          $script:HadFailures = $true
2026-01-11T19:28:11.7844525Z                          Write-Host "[FAIL] $Message" -ForegroundColor Red
2026-01-11T19:28:11.7845471Z                      }
2026-01-11T19:28:11.7845609Z                      
2026-01-11T19:28:11.7846760Z                      function Write-Ok {
2026-01-11T19:28:11.7847168Z                          <#
2026-01-11T19:28:11.7848473Z                          .SYNOPSIS
2026-01-11T19:28:11.7848728Z                              Writes a success message.
2026-01-11T19:28:11.7849063Z                          .DESCRIPTION
2026-01-11T19:28:11.7850342Z                              Used to confirm expected outcomes like successful installs.
2026-01-11T19:28:11.7851007Z                          #>
2026-01-11T19:28:11.7852164Z                          param(
2026-01-11T19:28:11.7853371Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.7853579Z                              [string]$Message
2026-01-11T19:28:11.7854774Z                          )
2026-01-11T19:28:11.7854952Z                      
2026-01-11T19:28:11.7856053Z                          Write-Host "[OK] $Message" -ForegroundColor Green
2026-01-11T19:28:11.7856691Z                      }
2026-01-11T19:28:11.7856855Z                      
2026-01-11T19:28:11.7857083Z                      function Wait-ForUserExit {
2026-01-11T19:28:11.7857805Z                          <#
2026-01-11T19:28:11.7858954Z                          .SYNOPSIS
2026-01-11T19:28:11.7859816Z                              Always waits for a user key press before exiting.
2026-01-11T19:28:11.7860717Z                          .DESCRIPTION
2026-01-11T19:28:11.7862108Z                              This keeps the console open for users who double-click the script
2026-01-11T19:28:11.7862656Z                              and would otherwise lose the output.
2026-01-11T19:28:11.7863612Z                          #>
2026-01-11T19:28:11.7863933Z                          # Always pause so the user can read output, even on failure.
2026-01-11T19:28:11.7864075Z                          Write-Host ""
2026-01-11T19:28:11.7865102Z                          Write-Host "Press any key to exit..." -ForegroundColor Cyan
2026-01-11T19:28:11.7865231Z                          try {
2026-01-11T19:28:11.7866309Z                              $null = [System.Console]::ReadKey($true)
2026-01-11T19:28:11.7866708Z                          } catch {
2026-01-11T19:28:11.7868171Z                              # Fallback for hosts that do not support ReadKey (e.g., some terminals).
2026-01-11T19:28:11.7868372Z                              Read-Host "Press Enter to exit"
2026-01-11T19:28:11.7868631Z                          }
2026-01-11T19:28:11.7870034Z                      }
2026-01-11T19:28:11.7870215Z                      
2026-01-11T19:28:11.7870807Z                      function Show-RockTuneFinalChecklist {
2026-01-11T19:28:11.7871788Z                          <#
2026-01-11T19:28:11.7872825Z                          .SYNOPSIS
2026-01-11T19:28:11.7874172Z                              Prints a no-guesswork, step-by-step checklist after tools launch.
2026-01-11T19:28:11.7874365Z                          .DESCRIPTION
2026-01-11T19:28:11.7875614Z                              This is intentionally explicit for first-time users who need to know
2026-01-11T19:28:11.7875996Z                              exactly what to click and in what order. The checklist is short and
2026-01-11T19:28:11.7876165Z                              ends with clear completion cues.
2026-01-11T19:28:11.7876914Z                          #>
2026-01-11T19:28:11.7877522Z                          Write-Section "ROCKTUNE Benchmark Steps"
2026-01-11T19:28:11.7877643Z                      
2026-01-11T19:28:11.7878491Z                          $consoleWidth = 0
2026-01-11T19:28:11.7879569Z                          try {
2026-01-11T19:28:11.7879824Z                              $consoleWidth = $Host.UI.RawUI.WindowSize.Width
2026-01-11T19:28:11.7881022Z                          } catch {
2026-01-11T19:28:11.7881246Z                              $consoleWidth = 0
2026-01-11T19:28:11.7882489Z                          }
2026-01-11T19:28:11.7882648Z                      
2026-01-11T19:28:11.7883590Z                          function Get-LeftPad {
2026-01-11T19:28:11.7884470Z                              param(
2026-01-11T19:28:11.7885392Z                                  [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.7886834Z                                  [int]$Width,
2026-01-11T19:28:11.7887166Z                      
2026-01-11T19:28:11.7888260Z                                  [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.7888459Z                                  [int]$MaxLineLength
2026-01-11T19:28:11.7888839Z                              )
2026-01-11T19:28:11.7889120Z                      
2026-01-11T19:28:11.7890339Z                              if ($Width -le 0 -or $MaxLineLength -le 0) {
2026-01-11T19:28:11.7890483Z                                  return ""
2026-01-11T19:28:11.7891508Z                              }
2026-01-11T19:28:11.7891653Z                      
2026-01-11T19:28:11.7892711Z                              $pad = [math]::Floor(($Width - $MaxLineLength) / 2)
2026-01-11T19:28:11.7893651Z                              if ($pad -lt 0) {
2026-01-11T19:28:11.7894448Z                                  $pad = 0
2026-01-11T19:28:11.7895361Z                              }
2026-01-11T19:28:11.7895607Z                      
2026-01-11T19:28:11.7896976Z                              return (" " * $pad)
2026-01-11T19:28:11.7897122Z                          }
2026-01-11T19:28:11.7898745Z                      
2026-01-11T19:28:11.7899111Z                          $bannerLines = @(
2026-01-11T19:28:11.7899582Z                              "  ____   ___   ____ _  __ _______ _   _ _   _ _____",
2026-01-11T19:28:11.7900062Z                              " |  _ \ / _ \ / ___| |/ /|_   _| | | | | \ | | ____|",
2026-01-11T19:28:11.7900516Z                              " | |_) | | | | |   | ' /   | | | | | | |  \| |  _|",
2026-01-11T19:28:11.7901005Z                              " |  _ <| |_| | |___| . \   | | | |_| | | |\  | |___",
2026-01-11T19:28:11.7901493Z                              " |_| \_\\___/ \____|_|\_\  |_|  \___/|_|_| \_|_____|"
2026-01-11T19:28:11.7901902Z                          )
2026-01-11T19:28:11.7902560Z                      
2026-01-11T19:28:11.7903862Z                          $bannerMax = ($bannerLines | Measure-Object -Property Length -Maximum).Maximum
2026-01-11T19:28:11.7905308Z                          $bannerPad = Get-LeftPad -Width $consoleWidth -MaxLineLength $bannerMax
2026-01-11T19:28:11.7905966Z                      
2026-01-11T19:28:11.7923581Z                          foreach ($line in $bannerLines) {
2026-01-11T19:28:11.7924472Z                              Write-Host ($bannerPad + $line) -ForegroundColor Cyan
2026-01-11T19:28:11.7925078Z                          }
2026-01-11T19:28:11.7925400Z                      
2026-01-11T19:28:11.7925719Z                          $useTwoColumns = $false
2026-01-11T19:28:11.7926204Z                          if ($consoleWidth -ge 120) {
2026-01-11T19:28:11.7926667Z                              $useTwoColumns = $true
2026-01-11T19:28:11.7927092Z                          }
2026-01-11T19:28:11.7927395Z                      
2026-01-11T19:28:11.7927700Z                          $sections = @(
2026-01-11T19:28:11.7928070Z                              @{
2026-01-11T19:28:11.7928929Z                                  Title = "FIRST STEPS"
2026-01-11T19:28:11.7929785Z                                  Lines = @(
2026-01-11T19:28:11.7930255Z                                      '[ ] Confirm the tools are open',
2026-01-11T19:28:11.7930796Z                                      '    - CapFrameX is running',
2026-01-11T19:28:11.7931331Z                                      '    - Unigine Superposition is open',
2026-01-11T19:28:11.7931871Z                                      '    - LatencyMon is open'
2026-01-11T19:28:11.7932305Z                                  )
2026-01-11T19:28:11.7932644Z                              },
2026-01-11T19:28:11.7932995Z                              @{
2026-01-11T19:28:11.7933397Z                                  Title = "CONFIGURE CAPFRAMEX (ONCE)"
2026-01-11T19:28:11.7934068Z                                  Lines = @(
2026-01-11T19:28:11.7934498Z                                      '[ ] Capture API: PresentMon',
2026-01-11T19:28:11.7934988Z                                      '[ ] Capture duration: 60s',
2026-01-11T19:28:11.7935438Z                                      '[ ] Start delay: 3s',
2026-01-11T19:28:11.7935903Z                                      '[ ] Hotkey: F11 (start/stop capture)'
2026-01-11T19:28:11.7936616Z                                  )
2026-01-11T19:28:11.7937217Z                              },
2026-01-11T19:28:11.7937537Z                              @{
2026-01-11T19:28:11.7937914Z                                  Title = "CONFIGURE SUPERPOSITION (ONCE)"
2026-01-11T19:28:11.7938634Z                                  Lines = @(
2026-01-11T19:28:11.7939056Z                                      '[ ] Preset: 1080p Medium',
2026-01-11T19:28:11.7939528Z                                      '[ ] Fullscreen: On',
2026-01-11T19:28:11.7939964Z                                      '[ ] VSync: Off'
2026-01-11T19:28:11.7940342Z                                  )
2026-01-11T19:28:11.7940650Z                              },
2026-01-11T19:28:11.7940923Z                              @{
2026-01-11T19:28:11.7941282Z                                  Title = "BEFORE CHANGES"
2026-01-11T19:28:11.7941633Z                                  Lines = @(
2026-01-11T19:28:11.7942072Z                                      '[ ] Warm-up run (no capture)',
2026-01-11T19:28:11.7942523Z                                      '    - Click RUN in Superposition',
2026-01-11T19:28:11.7943050Z                                      '    - Let the run finish',
2026-01-11T19:28:11.7943512Z                                      '[ ] Captured runs (before)',
2026-01-11T19:28:11.7943989Z                                      '    - Press F11 at start, F11 at end',
2026-01-11T19:28:11.7944556Z                                      '    - Do 2 valid runs; discard first if shader compilation occurs'
2026-01-11T19:28:11.7945145Z                                  )
2026-01-11T19:28:11.7945394Z                              },
2026-01-11T19:28:11.7945720Z                              @{
2026-01-11T19:28:11.7946037Z                                  Title = "LATENCYMON"
2026-01-11T19:28:11.7946377Z                                  Lines = @(
2026-01-11T19:28:11.7946837Z                                      '[ ] Click Start, run for ~5 minutes',
2026-01-11T19:28:11.7947271Z                                      '    - Screenshot Main tab',
2026-01-11T19:28:11.7947940Z                                      '    - Screenshot Drivers tab'
2026-01-11T19:28:11.7948349Z                                  )
2026-01-11T19:28:11.7948692Z                              },
2026-01-11T19:28:11.7948977Z                              @{
2026-01-11T19:28:11.7949278Z                                  Title = "APPLY ROCKTUNE CHANGES"
2026-01-11T19:28:11.7949735Z                                  Lines = @(
2026-01-11T19:28:11.7950086Z                                      '[ ] Run your optimization flow',
2026-01-11T19:28:11.7950586Z                                      '[ ] Reboot if requested'
2026-01-11T19:28:11.7951209Z                                  )
2026-01-11T19:28:11.7951583Z                              },
2026-01-11T19:28:11.7951809Z                              @{
2026-01-11T19:28:11.7952101Z                                  Title = "AFTER CHANGES"
2026-01-11T19:28:11.7952500Z                                  Lines = @(
2026-01-11T19:28:11.7952895Z                                      '[ ] Repeat the captured runs',
2026-01-11T19:28:11.7953235Z                                      '    - Same settings, same steps, same number of runs'
2026-01-11T19:28:11.7953539Z                                  )
2026-01-11T19:28:11.7953907Z                              },
2026-01-11T19:28:11.7954242Z                              @{
2026-01-11T19:28:11.7954602Z                                  Title = "EXPORT EVIDENCE"
2026-01-11T19:28:11.7954959Z                                  Lines = @(
2026-01-11T19:28:11.7955388Z                                      '[ ] CapFrameX -> Analysis -> Aggregate',
2026-01-11T19:28:11.7955981Z                                      '[ ] Export CSV + HTML summary'
2026-01-11T19:28:11.7956706Z                                  )
2026-01-11T19:28:11.7957597Z                              },
2026-01-11T19:28:11.7958475Z                              @{
2026-01-11T19:28:11.7958805Z                                  Title = "OPTIONAL INPUT LAG (FREE METHOD)"
2026-01-11T19:28:11.7959285Z                                  Lines = @(
2026-01-11T19:28:11.7959770Z                                      '[ ] Record 10 clicks at 240fps',
2026-01-11T19:28:11.7960739Z                                      '[ ] Count frames from click to pixel change',
2026-01-11T19:28:11.7961289Z                                      '[ ] 1 frame at 240fps = 4.17ms'
2026-01-11T19:28:11.7961683Z                                  )
2026-01-11T19:28:11.7962141Z                              }
2026-01-11T19:28:11.7963477Z                          )
2026-01-11T19:28:11.7964111Z                      
2026-01-11T19:28:11.7965596Z                          function Get-SectionLines {
2026-01-11T19:28:11.7966047Z                              param(
2026-01-11T19:28:11.7966462Z                                  [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.7966974Z                                  [hashtable]$Section
2026-01-11T19:28:11.7967414Z                              )
2026-01-11T19:28:11.7967998Z                      
2026-01-11T19:28:11.7969215Z                              $lines = @("== $($Section.Title) ==")
2026-01-11T19:28:11.7970293Z                              foreach ($line in $Section.Lines) {
2026-01-11T19:28:11.7970983Z                                  $lines += $line
2026-01-11T19:28:11.7971446Z                              }
2026-01-11T19:28:11.7971766Z                      
2026-01-11T19:28:11.7972069Z                              return $lines
2026-01-11T19:28:11.7972433Z                          }
2026-01-11T19:28:11.7972741Z                      
2026-01-11T19:28:11.7973369Z                          $lineItems = @()
2026-01-11T19:28:11.7973600Z                      
2026-01-11T19:28:11.7974033Z                          if ($useTwoColumns) {
2026-01-11T19:28:11.7974605Z                              $leftWidth = 58
2026-01-11T19:28:11.7975280Z                              for ($i = 0; $i -lt $sections.Count; $i += 2) {
2026-01-11T19:28:11.7975894Z                                  $left = Get-SectionLines -Section $sections[$i]
2026-01-11T19:28:11.7976688Z                                  $right = @()
2026-01-11T19:28:11.7977163Z                                  if ($i + 1 -lt $sections.Count) {
2026-01-11T19:28:11.7978042Z                                      $right = Get-SectionLines -Section $sections[$i + 1]
2026-01-11T19:28:11.7979306Z                                  }
2026-01-11T19:28:11.7979662Z                      
2026-01-11T19:28:11.7980330Z                                  $maxLines = [math]::Max($left.Count, $right.Count)
2026-01-11T19:28:11.7981243Z                                  for ($lineIndex = 0; $lineIndex -lt $maxLines; $lineIndex++) {
2026-01-11T19:28:11.7981720Z                                      $leftText = ""
2026-01-11T19:28:11.7982162Z                                      $rightText = ""
2026-01-11T19:28:11.7982655Z                                      if ($lineIndex -lt $left.Count) {
2026-01-11T19:28:11.7983187Z                                          $leftText = $left[$lineIndex]
2026-01-11T19:28:11.7983636Z                                      }
2026-01-11T19:28:11.7983993Z                                      if ($lineIndex -lt $right.Count) {
2026-01-11T19:28:11.7984627Z                                          $rightText = $right[$lineIndex]
2026-01-11T19:28:11.7985094Z                                      }
2026-01-11T19:28:11.7985480Z                      
2026-01-11T19:28:11.7986119Z                                      $lineItems += ($leftText.PadRight($leftWidth) + $rightText)
2026-01-11T19:28:11.7987150Z                                  }
2026-01-11T19:28:11.7987708Z                      
2026-01-11T19:28:11.7988804Z                                  $lineItems += ""
2026-01-11T19:28:11.7989731Z                              }
2026-01-11T19:28:11.7990318Z                          } else {
2026-01-11T19:28:11.7990708Z                              foreach ($section in $sections) {
2026-01-11T19:28:11.7991543Z                                  $lineItems += ""
2026-01-11T19:28:11.7992010Z                                  $lineItems += "== $($section.Title) =="
2026-01-11T19:28:11.7992787Z                                  foreach ($line in $section.Lines) {
2026-01-11T19:28:11.7993421Z                                      $lineItems += $line
2026-01-11T19:28:11.7993866Z                                  }
2026-01-11T19:28:11.7994228Z                              }
2026-01-11T19:28:11.7994537Z                          }
2026-01-11T19:28:11.7995704Z                      
2026-01-11T19:28:11.7996451Z                          if ($lineItems.Count -gt 0 -and $lineItems[0] -eq "") {
2026-01-11T19:28:11.7997187Z                              $lineItems = $lineItems[1..($lineItems.Count - 1)]
2026-01-11T19:28:11.7997995Z                          }
2026-01-11T19:28:11.7998327Z                      
2026-01-11T19:28:11.7999412Z                          $maxLineLength = ($lineItems | Measure-Object -Property Length -Maximum).Maximum
2026-01-11T19:28:11.8000368Z                          $checklistPad = Get-LeftPad -Width $consoleWidth -MaxLineLength $maxLineLength
2026-01-11T19:28:11.8001161Z                          foreach ($line in $lineItems) {
2026-01-11T19:28:11.8001763Z                              Write-Host ($checklistPad + $line) -ForegroundColor White
2026-01-11T19:28:11.8002358Z                          }
2026-01-11T19:28:11.8002655Z                      }
2026-01-11T19:28:11.8002908Z                      
2026-01-11T19:28:11.8003617Z                      function Prompt-YesNo {
2026-01-11T19:28:11.8004044Z                          <#
2026-01-11T19:28:11.8005264Z                          .SYNOPSIS
2026-01-11T19:28:11.8005765Z                              Prompts until a valid yes/no response is provided.
2026-01-11T19:28:11.8006348Z                          .DESCRIPTION
2026-01-11T19:28:11.8006914Z                              Accepts Y/Yes or N/No (case-insensitive). Returns $true for yes,
2026-01-11T19:28:11.8007757Z                              $false for no. This avoids accidental defaults on invalid input.
2026-01-11T19:28:11.8008377Z                          #>
2026-01-11T19:28:11.8008731Z                          param(
2026-01-11T19:28:11.8009112Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.8009593Z                              [string]$Message
2026-01-11T19:28:11.8010208Z                          )
2026-01-11T19:28:11.8010500Z                      
2026-01-11T19:28:11.8010813Z                          while ($true) {
2026-01-11T19:28:11.8012455Z                              $response = Read-Host $Message
2026-01-11T19:28:11.8013352Z                              if ($response -match '^(y|yes)$') {
2026-01-11T19:28:11.8013645Z                                  return $true
2026-01-11T19:28:11.8014103Z                              }
2026-01-11T19:28:11.8014736Z                              if ($response -match '^(n|no)$') {
2026-01-11T19:28:11.8015201Z                                  return $false
2026-01-11T19:28:11.8015831Z                              }
2026-01-11T19:28:11.8016917Z                      
2026-01-11T19:28:11.8017284Z                              Write-Warn "Please answer Y or N."
2026-01-11T19:28:11.8018020Z                          }
2026-01-11T19:28:11.8018560Z                      }
2026-01-11T19:28:11.8019513Z                      
2026-01-11T19:28:11.8020801Z                      function Get-ConsentCache {
2026-01-11T19:28:11.8021421Z                          <#
2026-01-11T19:28:11.8021740Z                          .SYNOPSIS
2026-01-11T19:28:11.8022233Z                              Reads the stored install consent, if present.
2026-01-11T19:28:11.8022884Z                          .DESCRIPTION
2026-01-11T19:28:11.8024847Z                              Returns $true or $false when a saved choice exists, otherwise $null.
2026-01-11T19:28:11.8025700Z                              The cache is stored under the current user profile in LocalAppData.
2026-01-11T19:28:11.8026247Z                          #>
2026-01-11T19:28:11.8026562Z                          if (-not (Test-Path $script:ConsentFilePath)) {
2026-01-11T19:28:11.8027012Z                              return $null
2026-01-11T19:28:11.8027327Z                          }
2026-01-11T19:28:11.8027505Z                      
2026-01-11T19:28:11.8028093Z                          try {
2026-01-11T19:28:11.8028966Z                              $data = Get-Content $script:ConsentFilePath -Raw | ConvertFrom-Json
2026-01-11T19:28:11.8029515Z                          } catch {
2026-01-11T19:28:11.8030143Z                              return $null
2026-01-11T19:28:11.8030548Z                          }
2026-01-11T19:28:11.8032139Z                      
2026-01-11T19:28:11.8032515Z                          if ($null -eq $data) {
2026-01-11T19:28:11.8033168Z                              return $null
2026-01-11T19:28:11.8033525Z                          }
2026-01-11T19:28:11.8034391Z                      
2026-01-11T19:28:11.8035914Z                          if ($data.PSObject.Properties.Name -contains "InstallConsent") {
2026-01-11T19:28:11.8036639Z                              return [bool]$data.InstallConsent
2026-01-11T19:28:11.8037065Z                          }
2026-01-11T19:28:11.8037384Z                      
2026-01-11T19:28:11.8037659Z                          return $null
2026-01-11T19:28:11.8037979Z                      }
2026-01-11T19:28:11.8039024Z                      
2026-01-11T19:28:11.8039398Z                      function Set-ConsentCache {
2026-01-11T19:28:11.8040004Z                          <#
2026-01-11T19:28:11.8040376Z                          .SYNOPSIS
2026-01-11T19:28:11.8040843Z                              Persists the install consent choice for future runs.
2026-01-11T19:28:11.8041389Z                          .DESCRIPTION
2026-01-11T19:28:11.8042409Z                              Stores a small JSON file with the user's choice and a timestamp.
2026-01-11T19:28:11.8043259Z                              Users can reset it with -ResetConsent or by deleting the file.
2026-01-11T19:28:11.8043901Z                          #>
2026-01-11T19:28:11.8044205Z                          param(
2026-01-11T19:28:11.8044580Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.8045014Z                              [bool]$InstallConsent
2026-01-11T19:28:11.8045465Z                          )
2026-01-11T19:28:11.8046680Z                      
2026-01-11T19:28:11.8047792Z                          if (-not (Test-Path $script:ConsentRoot)) {
2026-01-11T19:28:11.8048596Z                              New-Item -Path $script:ConsentRoot -ItemType Directory -Force | Out-Null
2026-01-11T19:28:11.8049318Z                          }
2026-01-11T19:28:11.8049619Z                      
2026-01-11T19:28:11.8049904Z                          $payload = @{
2026-01-11T19:28:11.8050299Z                              InstallConsent = $InstallConsent
2026-01-11T19:28:11.8050881Z                              UpdatedAtUtc = (Get-Date).ToUniversalTime().ToString("o")
2026-01-11T19:28:11.8051537Z                              Source = "benchmark-setup.ps1"
2026-01-11T19:28:11.8052018Z                          }
2026-01-11T19:28:11.8052318Z                      
2026-01-11T19:28:11.8053293Z                          $payload | ConvertTo-Json -Depth 3 | Set-Content -Path $script:ConsentFilePath -Encoding UTF8
2026-01-11T19:28:11.8054138Z                      }
2026-01-11T19:28:11.8054405Z                      
2026-01-11T19:28:11.8054724Z                      function Confirm-InstallConsent {
2026-01-11T19:28:11.8055189Z                          <#
2026-01-11T19:28:11.8055506Z                          .SYNOPSIS
2026-01-11T19:28:11.8056355Z                              Prompts the user for explicit consent before installing software.
2026-01-11T19:28:11.8057005Z                          .DESCRIPTION
2026-01-11T19:28:11.8057538Z                              This script uses winget to install tools. Some users want a hard
2026-01-11T19:28:11.8058367Z                              opt-in before any install activity starts. This function ensures
2026-01-11T19:28:11.8059551Z                              that no package installation occurs without a clear confirmation.
2026-01-11T19:28:11.8060240Z                          #>
2026-01-11T19:28:11.8060585Z                          param(
2026-01-11T19:28:11.8060989Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.8061473Z                              [string[]]$PackageNames
2026-01-11T19:28:11.8061861Z                          )
2026-01-11T19:28:11.8062031Z                      
2026-01-11T19:28:11.8063082Z                          Write-Section "Install Consent"
2026-01-11T19:28:11.8063716Z                          Write-Note "This script can install the following tools via winget:"
2026-01-11T19:28:11.8064949Z                          foreach ($name in $PackageNames) {
2026-01-11T19:28:11.8065526Z                              Write-Host "  - $name" -ForegroundColor White
2026-01-11T19:28:11.8066191Z                          }
2026-01-11T19:28:11.8066694Z                          Write-Note "No installations will occur without your consent."
2026-01-11T19:28:11.8067482Z                          Write-Note "Consent cache path: $script:ConsentFilePath"
2026-01-11T19:28:11.8068379Z                          Write-Note "Reset the cached choice with: .\\benchmark-setup.ps1 -ResetConsent"
2026-01-11T19:28:11.8069070Z                      
2026-01-11T19:28:11.8069587Z                          if ($script:ResetConsent -and (Test-Path $script:ConsentFilePath)) {
2026-01-11T19:28:11.8070226Z                              try {
2026-01-11T19:28:11.8070733Z                                  Remove-Item -Path $script:ConsentFilePath -Force
2026-01-11T19:28:11.8071382Z                                  Write-Ok "Consent cache cleared."
2026-01-11T19:28:11.8071883Z                              } catch {
2026-01-11T19:28:11.8072572Z                                  Write-Warn "Unable to remove consent cache. You may need to delete it manually."
2026-01-11T19:28:11.8073317Z                              }
2026-01-11T19:28:11.8073756Z                              $script:ResetConsent = $false
2026-01-11T19:28:11.8074530Z                          }
2026-01-11T19:28:11.8074834Z                      
2026-01-11T19:28:11.8075293Z                          # -------------------------------------------------------------------------
2026-01-11T19:28:11.8076709Z                          # AUTO-ACCEPT MODE
2026-01-11T19:28:11.8077357Z                          # -------------------------------------------------------------------------
2026-01-11T19:28:11.8078219Z                          # When -AutoAccept is specified, we skip all interactive prompts and
2026-01-11T19:28:11.8079068Z                          # automatically grant install consent. This is useful for:
2026-01-11T19:28:11.8079600Z                          #   - CI/CD pipelines where no human is present to answer prompts
2026-01-11T19:28:11.8080427Z                          #   - Automated testing environments
2026-01-11T19:28:11.8081438Z                          #   - Scripted deployments where you've already reviewed the tools
2026-01-11T19:28:11.8082073Z                          #
2026-01-11T19:28:11.8082606Z                          # The auto-accept does NOT save to the consent cache - it only affects
2026-01-11T19:28:11.8083404Z                          # the current execution. If you want to permanently allow installs without
2026-01-11T19:28:11.8084255Z                          # prompts, run once interactively and choose "Y" to remember.
2026-01-11T19:28:11.8084866Z                          #
2026-01-11T19:28:11.8085544Z                          # Usage: .\benchmark-setup.ps1 -AutoAccept
2026-01-11T19:28:11.8086196Z                          # -------------------------------------------------------------------------
2026-01-11T19:28:11.8086802Z                          if ($script:AutoAccept) {
2026-01-11T19:28:11.8087572Z                              Write-Ok "Auto-accept mode: installs are allowed."
2026-01-11T19:28:11.8088037Z                              return $true
2026-01-11T19:28:11.8088395Z                          }
2026-01-11T19:28:11.8088676Z                      
2026-01-11T19:28:11.8088960Z                          $cached = Get-ConsentCache
2026-01-11T19:28:11.8089277Z                          if ($null -ne $cached) {
2026-01-11T19:28:11.8089570Z                              if ($cached) {
2026-01-11T19:28:11.8090116Z                                  Write-Ok "Using saved consent: installs are allowed."
2026-01-11T19:28:11.8090676Z                              } else {
2026-01-11T19:28:11.8091210Z                                  Write-Warn "Using saved consent: installs are blocked."
2026-01-11T19:28:11.8091794Z                              }
2026-01-11T19:28:11.8092118Z                              return $cached
2026-01-11T19:28:11.8092470Z                          }
2026-01-11T19:28:11.8092765Z                      
2026-01-11T19:28:11.8093570Z                          $installConsent = Prompt-YesNo -Message "Install missing tools now? (Y/N)"
2026-01-11T19:28:11.8094221Z                      
2026-01-11T19:28:11.8094765Z                          $remember = Prompt-YesNo -Message "Remember this choice for next time? (Y/N)"
2026-01-11T19:28:11.8095677Z                          if ($remember) {
2026-01-11T19:28:11.8096138Z                              try {
2026-01-11T19:28:11.8096638Z                                  Set-ConsentCache -InstallConsent $installConsent
2026-01-11T19:28:11.8097436Z                                  Write-Ok "Consent saved."
2026-01-11T19:28:11.8098138Z                              } catch {
2026-01-11T19:28:11.8098776Z                                  Write-Warn "Unable to save consent cache. It will ask again next time."
2026-01-11T19:28:11.8099540Z                              }
2026-01-11T19:28:11.8099873Z                          }
2026-01-11T19:28:11.8100177Z                      
2026-01-11T19:28:11.8100466Z                          if ($installConsent) {
2026-01-11T19:28:11.8101000Z                              Write-Ok "Consent granted. Proceeding with installs when needed."
2026-01-11T19:28:11.8101609Z                          } else {
2026-01-11T19:28:11.8102273Z                              Write-Warn "Consent not granted. Skipping winget install and package installs."
2026-01-11T19:28:11.8102704Z                          }
2026-01-11T19:28:11.8103291Z                      
2026-01-11T19:28:11.8103611Z                          return $installConsent
2026-01-11T19:28:11.8103969Z                      }
2026-01-11T19:28:11.8104184Z                      
2026-01-11T19:28:11.8104454Z                      
2026-01-11T19:28:11.8104729Z                      # ----------------------------
2026-01-11T19:28:11.8105166Z                      # Winget detection and install
2026-01-11T19:28:11.8105601Z                      # ----------------------------
2026-01-11T19:28:11.8105979Z                      
2026-01-11T19:28:11.8106312Z                      function Test-WingetAvailable {
2026-01-11T19:28:11.8106728Z                          <#
2026-01-11T19:28:11.8107066Z                          .SYNOPSIS
2026-01-11T19:28:11.8107460Z                              Returns true if winget is callable.
2026-01-11T19:28:11.8107943Z                          .DESCRIPTION
2026-01-11T19:28:11.8108572Z                              Uses "winget --version" and checks the exit code. This avoids relying
2026-01-11T19:28:11.8109597Z                              on PATH heuristics and provides a simple availability check.
2026-01-11T19:28:11.8110531Z                          #>
2026-01-11T19:28:11.8110822Z                          try {
2026-01-11T19:28:11.8111191Z                              $null = winget --version 2>&1
2026-01-11T19:28:11.8112009Z                              return ($LASTEXITCODE -eq 0)
2026-01-11T19:28:11.8112454Z                          } catch {
2026-01-11T19:28:11.8112812Z                              return $false
2026-01-11T19:28:11.8113374Z                          }
2026-01-11T19:28:11.8113721Z                      }
2026-01-11T19:28:11.8114742Z                      
2026-01-11T19:28:11.8115355Z                      function Install-WingetIfMissing {
2026-01-11T19:28:11.8115967Z                          <#
2026-01-11T19:28:11.8116492Z                          .SYNOPSIS
2026-01-11T19:28:11.8117189Z                              Attempts to install winget if not already available.
2026-01-11T19:28:11.8117767Z                          .DESCRIPTION
2026-01-11T19:28:11.8118435Z                              The Microsoft-supported path is the App Installer package. This function:
2026-01-11T19:28:11.8119720Z                                1) Tries to open the Microsoft Store App Installer page.
2026-01-11T19:28:11.8120459Z                                2) Falls back to downloading the App Installer bundle from aka.ms.
2026-01-11T19:28:11.8121142Z                      
2026-01-11T19:28:11.8121682Z                              This mirrors the logic used in the main gaming-pc-setup script, but is
2026-01-11T19:28:11.8122514Z                              fully self-contained here for a standalone benchmark script.
2026-01-11T19:28:11.8123149Z                          #>
2026-01-11T19:28:11.8123514Z                          Write-Section "Winget Availability"
2026-01-11T19:28:11.8123912Z                          Write-Note "Checking if winget is available..."
2026-01-11T19:28:11.8124373Z                      
2026-01-11T19:28:11.8124683Z                          if (Test-WingetAvailable) {
2026-01-11T19:28:11.8125230Z                              $version = winget --version 2>&1
2026-01-11T19:28:11.8125788Z                              Write-Ok "winget is available ($version)."
2026-01-11T19:28:11.8126294Z                              return $true
2026-01-11T19:28:11.8126701Z                          }
2026-01-11T19:28:11.8127047Z                      
2026-01-11T19:28:11.8127529Z                          Write-Warn "winget is not available. Attempting installation."
2026-01-11T19:28:11.8128128Z                      
2026-01-11T19:28:11.8128510Z                          # Method 1: Microsoft Store App Installer page.
2026-01-11T19:28:11.8128982Z                          try {
2026-01-11T19:28:11.8129708Z                              $storeApp = Get-AppxPackage -Name "Microsoft.WindowsStore" -ErrorAction SilentlyContinue
2026-01-11T19:28:11.8130438Z                              if ($storeApp) {
2026-01-11T19:28:11.8130757Z                                  Write-Note "Opening Microsoft Store App Installer page."
2026-01-11T19:28:11.8131524Z                                  Start-Process "ms-windows-store://pdp/?ProductId=9NBLGGH4NNS1" -ErrorAction 
2026-01-11T19:28:11.8132305Z                      SilentlyContinue
2026-01-11T19:28:11.8132951Z                                  Write-Warn "Install 'App Installer' from the Store, then rerun this script."
2026-01-11T19:28:11.8134321Z                                  return $false
2026-01-11T19:28:11.8134705Z                              } else {
2026-01-11T19:28:11.8135162Z                                  Write-Warn "Microsoft Store not detected. Using direct download fallback."
2026-01-11T19:28:11.8135758Z                              }
2026-01-11T19:28:11.8136114Z                          } catch {
2026-01-11T19:28:11.8136750Z                              Write-Warn "Unable to open the Microsoft Store. Using direct download fallback."
2026-01-11T19:28:11.8137445Z                          }
2026-01-11T19:28:11.8137723Z                      
2026-01-11T19:28:11.8138318Z                          # Method 2: Direct download from Microsoft.
2026-01-11T19:28:11.8138613Z                          try {
2026-01-11T19:28:11.8139084Z                              $appInstallerUrl = "https://aka.ms/getwinget"
2026-01-11T19:28:11.8140102Z                              $downloadPath = Join-Path $env:TEMP "Microsoft.DesktopAppInstaller.msixbundle"
2026-01-11T19:28:11.8140861Z                      
2026-01-11T19:28:11.8141217Z                              Write-Note "Downloading App Installer bundle from $appInstallerUrl"
2026-01-11T19:28:11.8142269Z                              Invoke-WebRequest -Uri $appInstallerUrl -OutFile $downloadPath -UseBasicParsing 
2026-01-11T19:28:11.8143092Z                      -TimeoutSec 60 -ErrorAction Stop
2026-01-11T19:28:11.8143541Z                      
2026-01-11T19:28:11.8143939Z                              Write-Note "Installing App Installer bundle"
2026-01-11T19:28:11.8144553Z                              Add-AppxPackage -Path $downloadPath -ErrorAction Stop
2026-01-11T19:28:11.8145106Z                      
2026-01-11T19:28:11.8145379Z                              Remove-Item $downloadPath -ErrorAction SilentlyContinue
2026-01-11T19:28:11.8145861Z                      
2026-01-11T19:28:11.8146447Z                              Write-Ok "App Installer installed. Please restart PowerShell and rerun this script."
2026-01-11T19:28:11.8147187Z                              return $false
2026-01-11T19:28:11.8147600Z                          } catch {
2026-01-11T19:28:11.8148215Z                              Write-Fail "Failed to install App Installer. Install manually from 
2026-01-11T19:28:11.8148859Z                      https://aka.ms/getwinget"
2026-01-11T19:28:11.8149111Z                              return $false
2026-01-11T19:28:11.8149473Z                          }
2026-01-11T19:28:11.8150665Z                      }
2026-01-11T19:28:11.8151023Z                      
2026-01-11T19:28:11.8151662Z                      
2026-01-11T19:28:11.8152047Z                      # ----------------------------
2026-01-11T19:28:11.8152680Z                      # Package install and path resolution
2026-01-11T19:28:11.8153306Z                      # ----------------------------
2026-01-11T19:28:11.8154580Z                      
2026-01-11T19:28:11.8155039Z                      function Test-WingetPackageInstalled {
2026-01-11T19:28:11.8155636Z                          <#
2026-01-11T19:28:11.8155993Z                          .SYNOPSIS
2026-01-11T19:28:11.8156570Z                              Checks if a package is installed via winget list output.
2026-01-11T19:28:11.8157144Z                          .DESCRIPTION
2026-01-11T19:28:11.8158887Z                              Uses "winget list" and matches the package identifier in the output.
2026-01-11T19:28:11.8159623Z                              This works even when winget cannot reliably report install locations.
2026-01-11T19:28:11.8160276Z                          #>
2026-01-11T19:28:11.8160637Z                          param(
2026-01-11T19:28:11.8161654Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.8162171Z                              [string]$PackageId
2026-01-11T19:28:11.8162521Z                          )
2026-01-11T19:28:11.8162697Z                      
2026-01-11T19:28:11.8163012Z                          try {
2026-01-11T19:28:11.8164028Z                              $output = winget list --id $PackageId --source winget --accept-source-agreements 2>&1
2026-01-11T19:28:11.8164814Z                              if ($LASTEXITCODE -ne 0) {
2026-01-11T19:28:11.8165259Z                                  return $false
2026-01-11T19:28:11.8165649Z                              }
2026-01-11T19:28:11.8165831Z                      
2026-01-11T19:28:11.8166394Z                              return ($output -match [regex]::Escape($PackageId))
2026-01-11T19:28:11.8166965Z                          } catch {
2026-01-11T19:28:11.8167806Z                              return $false
2026-01-11T19:28:11.8168221Z                          }
2026-01-11T19:28:11.8168516Z                      }
2026-01-11T19:28:11.8168851Z                      
2026-01-11T19:28:11.8170491Z                      function Install-WingetPackage {
2026-01-11T19:28:11.8170951Z                          <#
2026-01-11T19:28:11.8171282Z                          .SYNOPSIS
2026-01-11T19:28:11.8171787Z                              Installs a package by winget ID, with verification.
2026-01-11T19:28:11.8172804Z                          .DESCRIPTION
2026-01-11T19:28:11.8173614Z                              Some winget installers return non-zero exit codes even when successful.
2026-01-11T19:28:11.8174448Z                              This function re-checks install state to avoid false negatives.
2026-01-11T19:28:11.8174966Z                          #>
2026-01-11T19:28:11.8175971Z                          param(
2026-01-11T19:28:11.8176421Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.8177132Z                              [string]$PackageId,
2026-01-11T19:28:11.8177558Z                      
2026-01-11T19:28:11.8177934Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.8178408Z                              [string]$PackageName
2026-01-11T19:28:11.8178822Z                          )
2026-01-11T19:28:11.8179121Z                      
2026-01-11T19:28:11.8179634Z                          if (Test-WingetPackageInstalled -PackageId $PackageId) {
2026-01-11T19:28:11.8180184Z                              Write-Ok "$PackageName already installed."
2026-01-11T19:28:11.8180663Z                              return $true
2026-01-11T19:28:11.8181045Z                          }
2026-01-11T19:28:11.8182314Z                      
2026-01-11T19:28:11.8183260Z                          Write-Note "Installing $PackageName via winget ($PackageId)."
2026-01-11T19:28:11.8184233Z                          $null = winget install --id $PackageId --source winget --accept-package-agreements 
2026-01-11T19:28:11.8185099Z                      --accept-source-agreements --silent 2>&1
2026-01-11T19:28:11.8185593Z                      
2026-01-11T19:28:11.8185935Z                          if ($LASTEXITCODE -eq 0) {
2026-01-11T19:28:11.8186409Z                              Write-Ok "$PackageName installed."
2026-01-11T19:28:11.8186882Z                              return $true
2026-01-11T19:28:11.8187277Z                          }
2026-01-11T19:28:11.8187561Z                      
2026-01-11T19:28:11.8187989Z                          # Some installs return a non-zero exit code even if the package is present.
2026-01-11T19:28:11.8188914Z                          if (Test-WingetPackageInstalled -PackageId $PackageId) {
2026-01-11T19:28:11.8190733Z                              Write-Ok "$PackageName already installed (post-install verification)."
2026-01-11T19:28:11.8191776Z                              return $true
2026-01-11T19:28:11.8192227Z                          }
2026-01-11T19:28:11.8192483Z                      
2026-01-11T19:28:11.8193004Z                          Write-Fail "Failed to install $PackageName (winget exit code $LASTEXITCODE)."
2026-01-11T19:28:11.8194548Z                          return $false
2026-01-11T19:28:11.8195273Z                      }
2026-01-11T19:28:11.8195610Z                      
2026-01-11T19:28:11.8195961Z                      function Get-RegistryInstallLocations {
2026-01-11T19:28:11.8196598Z                          <#
2026-01-11T19:28:11.8197083Z                          .SYNOPSIS
2026-01-11T19:28:11.8197705Z                              Finds install locations using registry uninstall entries.
2026-01-11T19:28:11.8198869Z                          .DESCRIPTION
2026-01-11T19:28:11.8199677Z                              This is a reliable fallback when installers register their paths.
2026-01-11T19:28:11.8200500Z                              It checks both 64-bit and 32-bit views to cover legacy installers.
2026-01-11T19:28:11.8201349Z                          #>
2026-01-11T19:28:11.8201665Z                          param(
2026-01-11T19:28:11.8202042Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.8202563Z                              [string]$DisplayNamePattern
2026-01-11T19:28:11.8202965Z                          )
2026-01-11T19:28:11.8203297Z                      
2026-01-11T19:28:11.8203838Z                          # Look for installer entries in HKLM and HKCU (both 64-bit and 32-bit views).
2026-01-11T19:28:11.8204573Z                          $registryPaths = @(
2026-01-11T19:28:11.8205197Z                              "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*",
2026-01-11T19:28:11.8206051Z                              "HKLM:\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall\*",
2026-01-11T19:28:11.8206915Z                              "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*"
2026-01-11T19:28:11.8207531Z                          )
2026-01-11T19:28:11.8207838Z                      
2026-01-11T19:28:11.8208151Z                          $locations = @()
2026-01-11T19:28:11.8208435Z                          foreach ($path in $registryPaths) {
2026-01-11T19:28:11.8208857Z                              try {
2026-01-11T19:28:11.8209288Z                                  $items = Get-ItemProperty -Path $path -ErrorAction SilentlyContinue |
2026-01-11T19:28:11.8209602Z                                      Where-Object { $_.DisplayName -like $DisplayNamePattern }
2026-01-11T19:28:11.8209685Z                      
2026-01-11T19:28:11.8211054Z                                  foreach ($item in $items) {
2026-01-11T19:28:11.8211247Z                                      if ($item.InstallLocation) {
2026-01-11T19:28:11.8211510Z                                          $locations += $item.InstallLocation
2026-01-11T19:28:11.8212070Z                                      } elseif ($item.DisplayIcon) {
2026-01-11T19:28:11.8213480Z                                          $locations += (Split-Path -Parent $item.DisplayIcon)
2026-01-11T19:28:11.8213644Z                                      }
2026-01-11T19:28:11.8214669Z                                  }
2026-01-11T19:28:11.8215401Z                              } catch {
2026-01-11T19:28:11.8216769Z                                  # Ignore registry access errors to keep the script robust.
2026-01-11T19:28:11.8216919Z                              }
2026-01-11T19:28:11.8217951Z                          }
2026-01-11T19:28:11.8218181Z                      
2026-01-11T19:28:11.8219482Z                          return $locations | Select-Object -Unique
2026-01-11T19:28:11.8219781Z                      }
2026-01-11T19:28:11.8220010Z                      
2026-01-11T19:28:11.8221385Z                      function Get-WingetInstalledLocation {
2026-01-11T19:28:11.8221583Z                          <#
2026-01-11T19:28:11.8222967Z                          .SYNOPSIS
2026-01-11T19:28:11.8223398Z                              Attempts to read the installed location from winget JSON output.
2026-01-11T19:28:11.8224621Z                          .DESCRIPTION
2026-01-11T19:28:11.8224951Z                              Newer winget versions can output JSON for "winget list".
2026-01-11T19:28:11.8225902Z                              When present, the JSON may include an install location field.
2026-01-11T19:28:11.8227077Z                              This is not guaranteed across versions, so this is best-effort only.
2026-01-11T19:28:11.8227218Z                          .OUTPUTS
2026-01-11T19:28:11.8228294Z                              [string] Install location path or $null if not available.
2026-01-11T19:28:11.8228427Z                          #>
2026-01-11T19:28:11.8229227Z                          param(
2026-01-11T19:28:11.8229737Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.8230620Z                              [string]$PackageId
2026-01-11T19:28:11.8232083Z                          )
2026-01-11T19:28:11.8232794Z                      
2026-01-11T19:28:11.8234074Z                          if (-not $script:WingetAvailable) {
2026-01-11T19:28:11.8234625Z                              return $null
2026-01-11T19:28:11.8234727Z                          }
2026-01-11T19:28:11.8235551Z                      
2026-01-11T19:28:11.8236481Z                          try {
2026-01-11T19:28:11.8237734Z                              $jsonText = winget list --id $PackageId --source winget --accept-source-agreements 
2026-01-11T19:28:11.8237879Z                      --output json 2>&1
2026-01-11T19:28:11.8238839Z                              if ($LASTEXITCODE -ne 0) {
2026-01-11T19:28:11.8239012Z                                  return $null
2026-01-11T19:28:11.8240006Z                              }
2026-01-11T19:28:11.8240168Z                      
2026-01-11T19:28:11.8241760Z                              $data = $jsonText | ConvertFrom-Json -ErrorAction Stop
2026-01-11T19:28:11.8241905Z                          } catch {
2026-01-11T19:28:11.8242484Z                              return $null
2026-01-11T19:28:11.8242823Z                          }
2026-01-11T19:28:11.8243835Z                      
2026-01-11T19:28:11.8244564Z                          $packages = @()
2026-01-11T19:28:11.8245361Z                          if ($data.Sources) {
2026-01-11T19:28:11.8246404Z                              foreach ($source in $data.Sources) {
2026-01-11T19:28:11.8246888Z                                  if ($source.Packages) {
2026-01-11T19:28:11.8248167Z                                      $packages += $source.Packages
2026-01-11T19:28:11.8248472Z                                  }
2026-01-11T19:28:11.8249007Z                              }
2026-01-11T19:28:11.8249914Z                          } elseif ($data.Packages) {
2026-01-11T19:28:11.8251281Z                              $packages += $data.Packages
2026-01-11T19:28:11.8251464Z                          }
2026-01-11T19:28:11.8251571Z                      
2026-01-11T19:28:11.8253078Z                          $match = $packages | Where-Object {
2026-01-11T19:28:11.8253402Z                              $_.PackageIdentifier -eq $PackageId -or $_.Id -eq $PackageId
2026-01-11T19:28:11.8253955Z                          } | Select-Object -First 1
2026-01-11T19:28:11.8254345Z                      
2026-01-11T19:28:11.8254840Z                          if (-not $match) {
2026-01-11T19:28:11.8255855Z                              return $null
2026-01-11T19:28:11.8256378Z                          }
2026-01-11T19:28:11.8257175Z                      
2026-01-11T19:28:11.8258699Z                          $locationProps = @("InstallLocation", "InstalledLocation", "Location", "InstallPath", 
2026-01-11T19:28:11.8258864Z                      "InstalledPath")
2026-01-11T19:28:11.8259049Z                          foreach ($prop in $locationProps) {
2026-01-11T19:28:11.8259968Z                              if ($match.PSObject.Properties.Name -contains $prop -and $match.$prop) {
2026-01-11T19:28:11.8260979Z                                  return $match.$prop
2026-01-11T19:28:11.8261443Z                              }
2026-01-11T19:28:11.8262510Z                          }
2026-01-11T19:28:11.8262985Z                      
2026-01-11T19:28:11.8263950Z                          return $null
2026-01-11T19:28:11.8264437Z                      }
2026-01-11T19:28:11.8264608Z                      
2026-01-11T19:28:11.8266064Z                      function Resolve-ExecutablePath {
2026-01-11T19:28:11.8266241Z                          <#
2026-01-11T19:28:11.8267203Z                          .SYNOPSIS
2026-01-11T19:28:11.8267875Z                              Resolves the full path to a tool executable.
2026-01-11T19:28:11.8268751Z                          .DESCRIPTION
2026-01-11T19:28:11.8269308Z                              Uses a multi-step strategy:
2026-01-11T19:28:11.8270343Z                                1) Known default paths (fast and deterministic)
2026-01-11T19:28:11.8270979Z                                2) Winget JSON install location (best effort)
2026-01-11T19:28:11.8271475Z                                3) Registry uninstall entries (best effort)
2026-01-11T19:28:11.8272529Z                                4) Limited folder scan under known vendor roots
2026-01-11T19:28:11.8273519Z                          #>
2026-01-11T19:28:11.8273731Z                          param(
2026-01-11T19:28:11.8275178Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.8275395Z                              [string[]]$ExeNames,
2026-01-11T19:28:11.8275869Z                      
2026-01-11T19:28:11.8276763Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.8277222Z                              [string[]]$DefaultCandidates,
2026-01-11T19:28:11.8278348Z                      
2026-01-11T19:28:11.8278573Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.8279401Z                              [string]$RegistryNamePattern,
2026-01-11T19:28:11.8279965Z                      
2026-01-11T19:28:11.8280404Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:11.8281356Z                              [string]$PackageId
2026-01-11T19:28:11.8282318Z                          )
2026-01-11T19:28:11.8282439Z                      
2026-01-11T19:28:11.8283918Z                          # Winget does not reliably expose install paths for all packages, so we use:
2026-01-11T19:28:11.8284201Z                          # 1) Known default paths (fast and predictable)
2026-01-11T19:28:11.8285503Z                          # 2) Winget JSON install location (best effort)
2026-01-11T19:28:11.8285801Z                          # 3) Registry uninstall entries (best effort)
2026-01-11T19:28:11.8286301Z                          # 4) Limited directory search under known vendor roots
2026-01-11T19:28:11.8287056Z                          #
2026-01-11T19:28:11.8288032Z                          # This keeps the script deterministic while still finding installs that
2026-01-11T19:28:11.8288760Z                          # do not use the defaults.
2026-01-11T19:28:11.8288860Z                      
2026-01-11T19:28:11.8289607Z                          # 1) Check known default paths first (fast and predictable).
2026-01-11T19:28:11.8290067Z                          foreach ($candidate in $DefaultCandidates) {
2026-01-11T19:28:11.8291298Z                              if (Test-Path $candidate) {
2026-01-11T19:28:11.8292208Z                                  return $candidate
2026-01-11T19:28:11.8293276Z                              }
2026-01-11T19:28:11.8294154Z                          }
2026-01-11T19:28:11.8295153Z                      
2026-01-11T19:28:11.8295711Z                          # 2) Check winget JSON install location (if supported by the local winget).
2026-01-11T19:28:11.8296797Z                          $wingetLocation = Get-WingetInstalledLocation -PackageId $PackageId
2026-01-11T19:28:11.8297283Z                          if ($wingetLocation -and (Test-Path $wingetLocation)) {
2026-01-11T19:28:11.8298369Z                              $wingetItem = Get-Item $wingetLocation -ErrorAction SilentlyContinue
2026-01-11T19:28:11.8298727Z                              if ($wingetItem -and -not $wingetItem.PSIsContainer) {
2026-01-11T19:28:11.8299999Z                                  return $wingetLocation
2026-01-11T19:28:11.8300749Z                              }
2026-01-11T19:28:11.8301534Z                      
2026-01-11T19:28:11.8302431Z                              foreach ($exeName in $ExeNames) {
2026-01-11T19:28:11.8303281Z                                  $wingetExe = Join-Path $wingetLocation $exeName
2026-01-11T19:28:11.8303986Z                                  if (Test-Path $wingetExe) {
2026-01-11T19:28:11.8304743Z                                      return $wingetExe
2026-01-11T19:28:11.8305201Z                                  }
2026-01-11T19:28:11.8306286Z                      
2026-01-11T19:28:11.8307293Z                                  $wingetBinExe = Join-Path (Join-Path $wingetLocation "bin") $exeName
2026-01-11T19:28:11.8307551Z                                  if (Test-Path $wingetBinExe) {
2026-01-11T19:28:11.8309289Z                                      return $wingetBinExe
2026-01-11T19:28:11.8309507Z                                  }
2026-01-11T19:28:11.8310474Z                              }
2026-01-11T19:28:11.8311248Z                          }
2026-01-11T19:28:11.8311822Z                      
2026-01-11T19:28:11.8312749Z                          # 3) Check install locations reported in the registry.
2026-01-11T19:28:11.8313942Z                          $registryLocations = Get-RegistryInstallLocations -DisplayNamePattern $RegistryNamePattern
2026-01-11T19:28:11.8314178Z                          foreach ($location in $registryLocations) {
2026-01-11T19:28:11.8314875Z                              foreach ($exeName in $ExeNames) {
2026-01-11T19:28:11.8315253Z                                  $exePath = Join-Path $location $exeName
2026-01-11T19:28:11.8319760Z                                  if (Test-Path $exePath) {
2026-01-11T19:28:11.8321004Z                                      return $exePath
2026-01-11T19:28:11.8321713Z                                  }
2026-01-11T19:28:11.8322576Z                      
2026-01-11T19:28:11.8323574Z                                  # Some installers put binaries in a subfolder like "bin".
2026-01-11T19:28:11.8323976Z                                  $binExePath = Join-Path (Join-Path $location "bin") $exeName
2026-01-11T19:28:11.8325037Z                                  if (Test-Path $binExePath) {
2026-01-11T19:28:11.8325842Z                                      return $binExePath
2026-01-11T19:28:11.8326567Z                                  }
2026-01-11T19:28:11.8327334Z                              }
2026-01-11T19:28:11.8328120Z                          }
2026-01-11T19:28:11.8328907Z                      
2026-01-11T19:28:11.8330015Z                          # 4) Last resort: search a specific root if it exists.
2026-01-11T19:28:11.8331250Z                          # This is intentionally limited to known vendor roots to avoid a full disk scan.
2026-01-11T19:28:11.8331502Z                          foreach ($location in $registryLocations) {
2026-01-11T19:28:11.8332431Z                              if (Test-Path $location) {
2026-01-11T19:28:11.8333212Z                                  try {
2026-01-11T19:28:11.8333913Z                                      foreach ($exeName in $ExeNames) {
2026-01-11T19:28:11.8336324Z                                          $found = Get-ChildItem -Path $location -Recurse -Filter $exeName -ErrorAction 
2026-01-11T19:28:11.8336723Z                      SilentlyContinue |
2026-01-11T19:28:11.8336974Z                                              Select-Object -First 1
2026-01-11T19:28:11.8338230Z                                          if ($found) {
2026-01-11T19:28:11.8338994Z                                              return $found.FullName
2026-01-11T19:28:11.8339805Z                                          }
2026-01-11T19:28:11.8340571Z                                      }
2026-01-11T19:28:11.8341358Z                                  } catch {
2026-01-11T19:28:11.8342184Z                                      # Ignore access errors.
2026-01-11T19:28:11.8342903Z                                  }
2026-01-11T19:28:11.8343692Z                              }
2026-01-11T19:28:11.8344487Z                          }
2026-01-11T19:28:11.8345229Z                      
2026-01-11T19:28:11.8346009Z                          return $null
2026-01-11T19:28:11.8346752Z                      }
2026-01-11T19:28:11.8347494Z                      
2026-01-11T19:28:11.8348263Z                      
2026-01-11T19:28:11.8349085Z                      # ----------------------------
2026-01-11T19:28:11.8350164Z                      # Benchmark stack definition
2026-01-11T19:28:11.8350868Z                      # ----------------------------
2026-01-11T19:28:11.8351388Z                      
2026-01-11T19:28:11.8352336Z                      Write-Section "Benchmark Stack"
2026-01-11T19:28:11.8353542Z                      Write-Note "This script installs a small, free toolchain for FPS and frametime testing."
2026-01-11T19:28:11.8353966Z                      Write-Note "It does not change system settings. It only installs tools and launches them."
2026-01-11T19:28:11.8355085Z                      Write-Note "These tools were chosen because they are repeatable and measurable:"
2026-01-11T19:28:11.8355575Z                      Write-Note "- CapFrameX: frametime capture and percentile lows (more honest than avg FPS alone)."
2026-01-11T19:28:11.8356602Z                      Write-Note "- Superposition: fixed GPU workload with repeatable scoring."
2026-01-11T19:28:11.8356977Z                      Write-Note "- LatencyMon: validates DPC/ISR latency to explain micro-stutter."
2026-01-11T19:28:11.8358083Z                      Write-Note "Windows 10 and 11 use the same default install paths for these tools."
2026-01-11T19:28:11.8358715Z                      Write-Note "The script targets 64-bit installs and still checks legacy locations for safety."
2026-01-11T19:28:11.8359444Z                      
2026-01-11T19:28:11.8360255Z                      $packages = @(
2026-01-11T19:28:11.8361081Z                          # Each package entry defines:
2026-01-11T19:28:11.8361970Z                          #   - Winget ID for installation
2026-01-11T19:28:11.8362833Z                          #   - Default executable paths for x64 installs
2026-01-11T19:28:11.8363670Z                          #   - Config checklist steps for repeatable results
2026-01-11T19:28:11.8364395Z                          #   - Whether to launch automatically when found
2026-01-11T19:28:11.8365054Z                          @{
2026-01-11T19:28:11.8365877Z                              Id = "CXWorld.CapFrameX"
2026-01-11T19:28:11.8366586Z                              Name = "CapFrameX"
2026-01-11T19:28:11.8367569Z                              Purpose = "Captures frametimes and computes avg FPS, 1% low, and 0.1% low."
2026-01-11T19:28:11.8367903Z                              ExeNames = @("CapFrameX.exe")
2026-01-11T19:28:11.8368920Z                              RegistryPattern = "*CapFrameX*"
2026-01-11T19:28:11.8369318Z                              DefaultPaths = @(
2026-01-11T19:28:11.8370320Z                                  "C:\Program Files\CapFrameX\CapFrameX.exe",
2026-01-11T19:28:11.8371223Z                                  "C:\Program Files (x86)\CapFrameX\CapFrameX.exe"
2026-01-11T19:28:11.8372316Z                              )
2026-01-11T19:28:11.8372609Z                              Configure = @(
2026-01-11T19:28:11.8373784Z                                  "Capture API: PresentMon",
2026-01-11T19:28:11.8374542Z                                  "Capture duration: 60s",
2026-01-11T19:28:11.8375292Z                                  "Start delay: 3s",
2026-01-11T19:28:11.8376082Z                                  "Hotkey: F11 (start/stop capture)",
2026-01-11T19:28:11.8376983Z                                  "Overlay optional; do not enable additional overlays for clean results"
2026-01-11T19:28:11.8377234Z                              )
2026-01-11T19:28:11.8378406Z                              Launch = $true
2026-01-11T19:28:11.8379236Z                          },
2026-01-11T19:28:11.8380073Z                          @{
2026-01-11T19:28:11.8381016Z                              Id = "Unigine.SuperpositionBenchmark"
2026-01-11T19:28:11.8381843Z                              Name = "Unigine Superposition"
2026-01-11T19:28:11.8382854Z                              Purpose = "Repeatable GPU benchmark for consistent before/after comparisons."
2026-01-11T19:28:11.8383079Z                              ExeNames = @("Superposition.exe")
2026-01-11T19:28:11.8384327Z                              RegistryPattern = "*Superposition*"
2026-01-11T19:28:11.8384623Z                              DefaultPaths = @(
2026-01-11T19:28:11.8385783Z                                  "C:\Program Files\Unigine\Superposition\Superposition.exe",
2026-01-11T19:28:11.8386620Z                                  "C:\Program Files\Unigine\Superposition\bin\Superposition.exe"
2026-01-11T19:28:11.8386884Z                              )
2026-01-11T19:28:11.8388048Z                              Configure = @(
2026-01-11T19:28:11.8388975Z                                  "Preset: 1080p Medium",
2026-01-11T19:28:11.8389744Z                                  "Fullscreen: On",
2026-01-11T19:28:11.8390522Z                                  "VSync: Off",
2026-01-11T19:28:11.8391769Z                                  "Run 3 passes; discard the first (shader compilation), average the rest"
2026-01-11T19:28:11.8391947Z                              )
2026-01-11T19:28:11.8393168Z                              Launch = $true
2026-01-11T19:28:11.8394019Z                          },
2026-01-11T19:28:11.8394826Z                          @{
2026-01-11T19:28:11.8395695Z                              Id = "Resplendence.LatencyMon"
2026-01-11T19:28:11.8396442Z                              Name = "LatencyMon"
2026-01-11T19:28:11.8397442Z                              Purpose = "Detects DPC/ISR latency spikes that can cause stutter or audio crackle."
2026-01-11T19:28:11.8397787Z                              ExeNames = @("LatencyMon.exe", "LatMon.exe")
2026-01-11T19:28:11.8398796Z                              RegistryPattern = "*LatencyMon*"
2026-01-11T19:28:11.8399491Z                              DefaultPaths = @(
2026-01-11T19:28:11.8400417Z                                  "C:\Program Files\LatencyMon\LatencyMon.exe",
2026-01-11T19:28:11.8401162Z                                  "C:\Program Files\LatencyMon\LatMon.exe",
2026-01-11T19:28:11.8401960Z                                  "C:\Program Files (x86)\LatencyMon\LatencyMon.exe",
2026-01-11T19:28:11.8402735Z                                  "C:\Program Files (x86)\LatencyMon\LatMon.exe",
2026-01-11T19:28:11.8403560Z                                  "C:\Program Files\Resplendence\LatencyMon\LatencyMon.exe",
2026-01-11T19:28:11.8403920Z                                  "C:\Program Files\Resplendence\LatencyMon\LatMon.exe",
2026-01-11T19:28:11.8405059Z                                  "C:\Program Files (x86)\Resplendence\LatencyMon\LatencyMon.exe",
2026-01-11T19:28:11.8405436Z                                  "C:\Program Files (x86)\Resplendence\LatencyMon\LatMon.exe"
2026-01-11T19:28:11.8406397Z                              )
2026-01-11T19:28:11.8407142Z                              Configure = @(
2026-01-11T19:28:11.8408284Z                                  "Run for 5 minutes while Superposition is running",
2026-01-11T19:28:11.8408567Z                                  "Record Main + Drivers tab screenshots for evidence"
2026-01-11T19:28:11.8409502Z                              )
2026-01-11T19:28:11.8410408Z                              Launch = $true
2026-01-11T19:28:11.8410983Z                          }
2026-01-11T19:28:11.8411895Z                      )
2026-01-11T19:28:11.8412899Z                      
2026-01-11T19:28:11.8413671Z                      
2026-01-11T19:28:11.8414508Z                      # ----------------------------
2026-01-11T19:28:11.8415269Z                      # Main flow
2026-01-11T19:28:11.8416081Z                      # ----------------------------
2026-01-11T19:28:11.8416822Z                      
2026-01-11T19:28:11.8417601Z                      try {
2026-01-11T19:28:11.8418426Z                          Write-Section "Pre-Checks"
2026-01-11T19:28:11.8419303Z                          Write-Note "Ensure the following for fair results:"
2026-01-11T19:28:11.8420165Z                          Write-Note "- Close browsers, launchers, and overlays (except CapFrameX)."
2026-01-11T19:28:11.8420925Z                          Write-Note "- Keep power plan and NVIDIA Control Panel settings identical before/after."
2026-01-11T19:28:11.8421802Z                          Write-Note "- Reboot before the before and after runs, if possible."
2026-01-11T19:28:11.8422405Z                          Write-Note "- If you double-clicked this script and it closes immediately, run:"
2026-01-11T19:28:11.8423396Z                          Write-Note "  powershell -ExecutionPolicy Bypass -File .\\benchmark-setup.ps1"
2026-01-11T19:28:11.8423570Z                      
2026-01-11T19:28:11.8425155Z                          $installConsent = Confirm-InstallConsent -PackageNames ($packages | ForEach-Object { $_.Name 
2026-01-11T19:28:11.8425366Z                      })
2026-01-11T19:28:11.8426322Z                      
2026-01-11T19:28:11.8427208Z                          if ($installConsent) {
2026-01-11T19:28:11.8428074Z                              if (-not (Install-WingetIfMissing)) {
2026-01-11T19:28:11.8428889Z                                  throw "winget is required to continue."
2026-01-11T19:28:11.8429554Z                              }
2026-01-11T19:28:11.8430538Z                      
2026-01-11T19:28:11.8431683Z                              $script:WingetAvailable = Test-WingetAvailable
2026-01-11T19:28:11.8432210Z                      
2026-01-11T19:28:11.8433136Z                              Write-Section "Install Required Tools"
2026-01-11T19:28:11.8433952Z                              $totalPkgs = $packages.Count
2026-01-11T19:28:11.8434686Z                              $currentPkg = 0
2026-01-11T19:28:11.8435520Z                              foreach ($package in $packages) {
2026-01-11T19:28:11.8436247Z                                  $currentPkg++
2026-01-11T19:28:11.8437151Z                                  $pct = [math]::Round(($currentPkg / $totalPkgs) * 100)
2026-01-11T19:28:11.8438200Z                                  Write-Progress -Activity "Installing Tools" -Status $package.Name -PercentComplete 
2026-01-11T19:28:11.8438439Z                      $pct -CurrentOperation "$currentPkg of $totalPkgs"
2026-01-11T19:28:11.8439616Z                                  Write-Note "$($package.Name): $($package.Purpose)"
2026-01-11T19:28:11.8440557Z                                  $installed = Install-WingetPackage -PackageId $package.Id -PackageName $package.Name
2026-01-11T19:28:11.8440725Z                                  if (-not $installed) {
2026-01-11T19:28:11.8442292Z                                      Write-Warn "$($package.Name) failed to install. The script will continue, but 
2026-01-11T19:28:11.8442570Z                      launching may fail."
2026-01-11T19:28:11.8443702Z                                  }
2026-01-11T19:28:11.8445121Z                              }
2026-01-11T19:28:11.8445510Z                              Write-Progress -Activity "Installing Tools" -Completed
2026-01-11T19:28:11.8446517Z                          } else {
2026-01-11T19:28:11.8447445Z                              # The user did not approve installs. We still try to locate and launch
2026-01-11T19:28:11.8448168Z                              # any tools that are already installed.
2026-01-11T19:28:11.8448948Z                              $script:WingetAvailable = Test-WingetAvailable
2026-01-11T19:28:11.8449589Z                              if (-not $script:WingetAvailable) {
2026-01-11T19:28:11.8451746Z                                  Write-Warn "winget is not available, so install-location lookup via winget is 
2026-01-11T19:28:11.8452114Z                      disabled."
2026-01-11T19:28:11.8452854Z                              }
2026-01-11T19:28:11.8452999Z                          }
2026-01-11T19:28:11.8453112Z                      
2026-01-11T19:28:11.8453324Z                          Write-Section "Locate Executables"
2026-01-11T19:28:11.8453926Z                          foreach ($package in $packages) {
2026-01-11T19:28:11.8454375Z                              $path = Resolve-ExecutablePath -ExeNames $package.ExeNames `
2026-01-11T19:28:11.8455429Z                                  -DefaultCandidates $package.DefaultPaths `
2026-01-11T19:28:11.8456181Z                                  -RegistryNamePattern $package.RegistryPattern `
2026-01-11T19:28:11.8456501Z                                  -PackageId $package.Id
2026-01-11T19:28:11.8457461Z                      
2026-01-11T19:28:11.8458104Z                              if ($path) {
2026-01-11T19:28:11.8458896Z                                  Write-Ok "$($package.Name) executable found at: $path"
2026-01-11T19:28:11.8459072Z                                  $package["Path"] = $path
2026-01-11T19:28:11.8459909Z                              } else {
2026-01-11T19:28:11.8460874Z                                  Write-Warn "Could not locate $($package.Name) executable. Launch will be skipped."
2026-01-11T19:28:11.8461214Z                                  $package["Path"] = $null
2026-01-11T19:28:11.8462235Z                              }
2026-01-11T19:28:11.8462810Z                          }
2026-01-11T19:28:11.8463060Z                      
2026-01-11T19:28:11.8464052Z                          Write-Section "Configuration Checklist"
2026-01-11T19:28:11.8464401Z                          foreach ($package in $packages) {
2026-01-11T19:28:11.8465385Z                              Write-Host ""
2026-01-11T19:28:11.8465886Z                              Write-Host "$($package.Name) configuration:" -ForegroundColor Cyan
2026-01-11T19:28:11.8466814Z                              foreach ($step in $package.Configure) {
2026-01-11T19:28:11.8467231Z                                  Write-Host "  - $step" -ForegroundColor White
2026-01-11T19:28:11.8469420Z                              }
2026-01-11T19:28:11.8470246Z                          }
2026-01-11T19:28:11.8471175Z                      
2026-01-11T19:28:11.8472198Z                          Write-Section "Launch Tools"
2026-01-11T19:28:11.8472443Z                          foreach ($package in $packages) {
2026-01-11T19:28:11.8473198Z                              if (-not $package.Launch) {
2026-01-11T19:28:11.8473988Z                                  continue
2026-01-11T19:28:11.8474534Z                              }
2026-01-11T19:28:11.8475108Z                      
2026-01-11T19:28:11.8475283Z                              if ($package["Path"]) {
2026-01-11T19:28:11.8476216Z                                  Write-Note "Launching $($package.Name)..."
2026-01-11T19:28:11.8476391Z                                  try {
2026-01-11T19:28:11.8477751Z                                      $process = Start-Process -FilePath $package["Path"] -PassThru -ErrorAction Stop
2026-01-11T19:28:11.8478181Z                                      Start-Sleep -Milliseconds 300
2026-01-11T19:28:11.8479009Z                                      if ($process -and -not $process.HasExited) {
2026-01-11T19:28:11.8479344Z                                          Write-Ok "$($package.Name) launched (PID $($process.Id))."
2026-01-11T19:28:11.8480031Z                                      } else {
2026-01-11T19:28:11.8481527Z                                          Write-Warn "$($package.Name) launched but exited immediately. Try starting it 
2026-01-11T19:28:11.8481791Z                      manually:"
2026-01-11T19:28:11.8482754Z                                          Write-Warn "  $($package["Path"])"
2026-01-11T19:28:11.8482925Z                                      }
2026-01-11T19:28:11.8483900Z                                  } catch {
2026-01-11T19:28:11.8484332Z                                      Write-Warn "Failed to launch $($package.Name). Try starting it manually:"
2026-01-11T19:28:11.8484716Z                                      Write-Warn "  $($package["Path"])"
2026-01-11T19:28:11.8485358Z                                      Write-Warn "Error: $($_.Exception.Message)"
2026-01-11T19:28:11.8486011Z                                  }
2026-01-11T19:28:11.8486384Z                              } else {
2026-01-11T19:28:11.8487671Z                                  Write-Warn "Skipping launch for $($package.Name) (path not found)."
2026-01-11T19:28:11.8488308Z                              }
2026-01-11T19:28:11.8489731Z                          }
2026-01-11T19:28:11.8490148Z                      
2026-01-11T19:28:11.8490853Z                          Write-Section "Input Lag Evidence (Free Method)"
2026-01-11T19:28:11.8491630Z                          Write-Note "Use a 240fps phone video to measure click-to-photon latency:"
2026-01-11T19:28:11.8492072Z                          Write-Note "1) Fullscreen a click-response test (any simple local page or app)."
2026-01-11T19:28:11.8493050Z                          Write-Note "2) Record 10 clicks in slow motion."
2026-01-11T19:28:11.8493515Z                          Write-Note "3) Count frames between click and on-screen change."
2026-01-11T19:28:11.8494507Z                          Write-Note "At 240fps, 1 frame = 4.17ms. Average the 10 results."
2026-01-11T19:28:11.8494632Z                      
2026-01-11T19:28:11.8495730Z                          Write-Section "Run Protocol Summary"
2026-01-11T19:28:11.8496005Z                          Write-Note "Warm up once without capturing."
2026-01-11T19:28:11.8497328Z                          Write-Note "Capture 2 valid runs with CapFrameX (press F11 to start/stop)."
2026-01-11T19:28:11.8497527Z                          Write-Note "Apply your app changes."
2026-01-11T19:28:11.8498561Z                          Write-Note "Repeat the warmup + 2 runs."
2026-01-11T19:28:11.8498988Z                          Write-Note "Compare Avg FPS, 1% low, 0.1% low, and frametime graphs."
2026-01-11T19:28:11.8499658Z                      
2026-01-11T19:28:11.8500310Z                          Write-Ok "Benchmark stack is ready."
2026-01-11T19:28:11.8500786Z                          Write-Progress -Activity "Benchmark Setup" -Completed
2026-01-11T19:28:11.8501599Z                      
2026-01-11T19:28:11.8502234Z                          Show-RockTuneFinalChecklist
2026-01-11T19:28:11.8502620Z                      } catch {
2026-01-11T19:28:11.8503679Z                          Write-Fail "Script failed: $($_.Exception.Message)"
2026-01-11T19:28:11.8503812Z                      } finally {
2026-01-11T19:28:11.8504876Z                          if ($script:HadFailures) {
2026-01-11T19:28:11.8505674Z                              Write-Warn "One or more steps failed. Review the messages above."
2026-01-11T19:28:11.8505839Z                          }
2026-01-11T19:28:11.8506890Z                          Wait-ForUserExit
2026-01-11T19:28:11.8507143Z                      }
2026-01-11T19:28:11.8508378Z                      
2026-01-11T19:28:11.8509086Z [32;1mParent             : [0m
2026-01-11T19:28:11.8509158Z 
2026-01-11T19:28:12.1979000Z [32;1mAttributes         : [0m{}
2026-01-11T19:28:12.1980084Z [32;1mUsingStatements    : [0m{}
2026-01-11T19:28:12.1980752Z [32;1mParamBlock         : [0mparam(
2026-01-11T19:28:12.1981608Z                          [switch]$SkipConfirmations,
2026-01-11T19:28:12.1982109Z                          [switch]$EnableFirewallRules
2026-01-11T19:28:12.1982386Z                      )
2026-01-11T19:28:12.1982654Z [32;1mBeginBlock         : [0m
2026-01-11T19:28:12.1982903Z [32;1mProcessBlock       : [0m
2026-01-11T19:28:12.1985406Z [32;1mEndBlock           : [0mparam(
2026-01-11T19:28:12.1985865Z                          [switch]$SkipConfirmations,
2026-01-11T19:28:12.1987024Z                          [switch]$EnableFirewallRules
2026-01-11T19:28:12.1987437Z                      )
2026-01-11T19:28:12.1988346Z                      
2026-01-11T19:28:12.1989477Z                      # Fail fast to avoid partial application when an error is encountered.
2026-01-11T19:28:12.1989999Z                      $ErrorActionPreference = "Stop"
2026-01-11T19:28:12.1990605Z                      $script:LogPath = ".\extreme-privacy.log"
2026-01-11T19:28:12.1992157Z                      
2026-01-11T19:28:12.1992508Z                      <#
2026-01-11T19:28:12.1993681Z                      .SYNOPSIS
2026-01-11T19:28:12.1994674Z                          Writes a structured log line to file and console.
2026-01-11T19:28:12.1995115Z                      .DESCRIPTION
2026-01-11T19:28:12.1996457Z                          Prepends timestamp and severity level, appends to the log file, and mirrors
2026-01-11T19:28:12.1996945Z                          the message to the console with a level-aware color.
2026-01-11T19:28:12.1997974Z                      .PARAMETER Message
2026-01-11T19:28:12.1998779Z                          Human-readable log text.
2026-01-11T19:28:12.1999229Z                      .PARAMETER Level
2026-01-11T19:28:12.2000366Z                          Severity marker: INFO, SUCCESS, or ERROR.
2026-01-11T19:28:12.2000735Z                      .OUTPUTS
2026-01-11T19:28:12.2001772Z                          None.
2026-01-11T19:28:12.2002745Z                      #>
2026-01-11T19:28:12.2003225Z                      # Progress tracking
2026-01-11T19:28:12.2003903Z                      $script:SectionIndex = 0
2026-01-11T19:28:12.2004940Z                      $script:SectionTotal = if ($EnableFirewallRules) { 24 } else { 23 }
2026-01-11T19:28:12.2006660Z                      
2026-01-11T19:28:12.2007241Z                      function Write-Log {
2026-01-11T19:28:12.2008130Z                          param([string]$Message, [string]$Level = "INFO")
2026-01-11T19:28:12.2008790Z                          $timestamp = Get-Date -Format "yyyy-MM-dd HH:mm:ss"
2026-01-11T19:28:12.2009415Z                          $logMessage = "[$timestamp] [$Level] $Message"
2026-01-11T19:28:12.2009920Z                      
2026-01-11T19:28:12.2010852Z                          try {
2026-01-11T19:28:12.2012037Z                              Add-Content -Path $script:LogPath -Value $logMessage -ErrorAction Stop
2026-01-11T19:28:12.2012710Z                          } catch {
2026-01-11T19:28:12.2013048Z                          }
2026-01-11T19:28:12.2013634Z                      
2026-01-11T19:28:12.2014316Z                          Write-Host $logMessage -ForegroundColor $(if ($Level -eq "ERROR") { "Red" } elseif ($Level 
2026-01-11T19:28:12.2015389Z                      -eq "SUCCESS") { "Green" } else { "White" })
2026-01-11T19:28:12.2015886Z                      }
2026-01-11T19:28:12.2016170Z                      
2026-01-11T19:28:12.2016480Z                      function Write-Section {
2026-01-11T19:28:12.2016884Z                          param([string]$Title)
2026-01-11T19:28:12.2017305Z                          $script:SectionIndex++
2026-01-11T19:28:12.2018914Z                          $pct = [math]::Min(100, [math]::Round(($script:SectionIndex / $script:SectionTotal) * 100))
2026-01-11T19:28:12.2020048Z                          Write-Progress -Activity "Extreme Privacy" -Status $Title -PercentComplete $pct 
2026-01-11T19:28:12.2021045Z                      -CurrentOperation "Step $($script:SectionIndex) of $($script:SectionTotal)"
2026-01-11T19:28:12.2022222Z                          Write-Log "=== $Title ==="
2026-01-11T19:28:12.2022685Z                      }
2026-01-11T19:28:12.2022956Z                      
2026-01-11T19:28:12.2023250Z                      <#
2026-01-11T19:28:12.2023597Z                      .SYNOPSIS
2026-01-11T19:28:12.2024432Z                          Sets a registry value, creating the key if needed.
2026-01-11T19:28:12.2025639Z                      .DESCRIPTION
2026-01-11T19:28:12.2026376Z                          Ensures the registry path exists, writes the requested value and type,
2026-01-11T19:28:12.2027606Z                          and logs success or failure.
2026-01-11T19:28:12.2028203Z                      .PARAMETER Path
2026-01-11T19:28:12.2028756Z                          Registry path (e.g., HKLM:\Software\...).
2026-01-11T19:28:12.2029445Z                      .PARAMETER Name
2026-01-11T19:28:12.2032527Z                          Registry value name.
2026-01-11T19:28:12.2044658Z                      .PARAMETER Value
2026-01-11T19:28:12.2045168Z                          Data to store at the registry value.
2026-01-11T19:28:12.2045658Z                      .PARAMETER Type
2026-01-11T19:28:12.2046042Z                          Registry value type (defaults to DWORD).
2026-01-11T19:28:12.2046796Z                      .OUTPUTS
2026-01-11T19:28:12.2048188Z                          [bool] True on success, false on failure.
2026-01-11T19:28:12.2049477Z                      #>
2026-01-11T19:28:12.2049856Z                      function Set-RegistryValue {
2026-01-11T19:28:12.2050306Z                          param(
2026-01-11T19:28:12.2050664Z                              [string]$Path,
2026-01-11T19:28:12.2051106Z                              [string]$Name,
2026-01-11T19:28:12.2051515Z                              [object]$Value,
2026-01-11T19:28:12.2051953Z                              [string]$Type = "DWORD"
2026-01-11T19:28:12.2052455Z                          )
2026-01-11T19:28:12.2052772Z                          try {
2026-01-11T19:28:12.2053156Z                              if (-not (Test-Path $Path)) {
2026-01-11T19:28:12.2054071Z                                  New-Item -Path $Path -Force | Out-Null
2026-01-11T19:28:12.2054572Z                              }
2026-01-11T19:28:12.2055263Z                              Set-ItemProperty -Path $Path -Name $Name -Value $Value -Type $Type -ErrorAction Stop
2026-01-11T19:28:12.2056173Z                              Write-Log "Set: $Path\$Name = $Value" "SUCCESS"
2026-01-11T19:28:12.2056701Z                              return $true
2026-01-11T19:28:12.2057089Z                          } catch {
2026-01-11T19:28:12.2057536Z                              Write-Log "Failed: $Path\$Name - $_" "ERROR"
2026-01-11T19:28:12.2058057Z                              return $false
2026-01-11T19:28:12.2058431Z                          }
2026-01-11T19:28:12.2058729Z                      }
2026-01-11T19:28:12.2059005Z                      
2026-01-11T19:28:12.2059566Z                      Write-Log "=== Extreme Privacy & Anti-Tracking Script Started ===" "SUCCESS"
2026-01-11T19:28:12.2060652Z                      Write-Host ""
2026-01-11T19:28:12.2061471Z                      Write-Host "=== EXTREME PRIVACY MODE ===" -ForegroundColor Red
2026-01-11T19:28:12.2062417Z                      Write-Host "This script applies AGGRESSIVE privacy hardening." -ForegroundColor Yellow
2026-01-11T19:28:12.2063351Z                      Write-Host "Some Windows features may break (Store, Cortana, etc.)" -ForegroundColor Yellow
2026-01-11T19:28:12.2064042Z                      Write-Host ""
2026-01-11T19:28:12.2064249Z                      
2026-01-11T19:28:12.2064820Z                      if (-not $SkipConfirmations) {
2026-01-11T19:28:12.2065258Z                          $confirm = Read-Host "Continue with extreme privacy mode? (Y/N)"
2026-01-11T19:28:12.2065884Z                          if ($confirm -ne "Y") {
2026-01-11T19:28:12.2066325Z                              Write-Log "Cancelled by user" "ERROR"
2026-01-11T19:28:12.2066760Z                              exit 0
2026-01-11T19:28:12.2067084Z                          }
2026-01-11T19:28:12.2067362Z                      }
2026-01-11T19:28:12.2067630Z                      
2026-01-11T19:28:12.2068153Z                      # Windows Update is disabled to prevent telemetry and background bandwidth usage.
2026-01-11T19:28:12.2068982Z                      Write-Section "Disabling Windows Update Completely"
2026-01-11T19:28:12.2069467Z                      try {
2026-01-11T19:28:12.2069925Z                          Stop-Service wuauserv -Force -ErrorAction SilentlyContinue
2026-01-11T19:28:12.2070560Z                          Set-Service wuauserv -StartupType Disabled
2026-01-11T19:28:12.2071048Z                      
2026-01-11T19:28:12.2071637Z                          Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU" -Name 
2026-01-11T19:28:12.2072782Z                      "NoAutoUpdate" -Value 1
2026-01-11T19:28:12.2073541Z                          Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU" -Name 
2026-01-11T19:28:12.2074377Z                      "AUOptions" -Value 2
2026-01-11T19:28:12.2075162Z                          Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU" -Name 
2026-01-11T19:28:12.2075948Z                      "AutoInstallMinorUpdates" -Value 0
2026-01-11T19:28:12.2076984Z                          Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU" -Name 
2026-01-11T19:28:12.2077608Z                      "NoAutoRebootWithLoggedOnUsers" -Value 1
2026-01-11T19:28:12.2078093Z                      
2026-01-11T19:28:12.2078493Z                          Stop-Service UsoSvc -Force -ErrorAction SilentlyContinue
2026-01-11T19:28:12.2079377Z                          Set-Service UsoSvc -StartupType Disabled -ErrorAction SilentlyContinue
2026-01-11T19:28:12.2080000Z                      
2026-01-11T19:28:12.2080446Z                          Write-Log "Windows Update completely disabled" "SUCCESS"
2026-01-11T19:28:12.2080988Z                      } catch {
2026-01-11T19:28:12.2081438Z                          Write-Log "Error disabling Windows Update: $_" "ERROR"
2026-01-11T19:28:12.2081925Z                      }
2026-01-11T19:28:12.2082208Z                      
2026-01-11T19:28:12.2082453Z                      
2026-01-11T19:28:12.2082856Z                      # Disable telemetry and diagnostic services that phone home.
2026-01-11T19:28:12.2083481Z                      Write-Section "Disabling All Telemetry Services"
2026-01-11T19:28:12.2084012Z                      $telemetryServices = @(
2026-01-11T19:28:12.2084398Z                          "DiagTrack",
2026-01-11T19:28:12.2084800Z                          "dmwappushservice",
2026-01-11T19:28:12.2085265Z                          "diagnosticshub.standardcollector.service",
2026-01-11T19:28:12.2085671Z                          "DPS",
2026-01-11T19:28:12.2085861Z                          "WdiSystemHost",
2026-01-11T19:28:12.2086216Z                          "WdiServiceHost",
2026-01-11T19:28:12.2086582Z                          "PcaSvc",
2026-01-11T19:28:12.2086895Z                          "WerSvc",
2026-01-11T19:28:12.2087227Z                          "Wecsvc",
2026-01-11T19:28:12.2087569Z                          "BDESVC",
2026-01-11T19:28:12.2087864Z                          "wercplsupport",
2026-01-11T19:28:12.2088215Z                          "RetailDemo"
2026-01-11T19:28:12.2088508Z                      )
2026-01-11T19:28:12.2088751Z                      
2026-01-11T19:28:12.2090045Z                      foreach ($svc in $telemetryServices) {
2026-01-11T19:28:12.2090534Z                          try {
2026-01-11T19:28:12.2091054Z                              $service = Get-Service -Name $svc -ErrorAction SilentlyContinue
2026-01-11T19:28:12.2091673Z                              if ($service) {
2026-01-11T19:28:12.2092187Z                                  Stop-Service $svc -Force -ErrorAction Stop
2026-01-11T19:28:12.2092667Z                                  Set-Service $svc -StartupType Disabled
2026-01-11T19:28:12.2092987Z                                  Write-Log "Disabled service: $svc" "SUCCESS"
2026-01-11T19:28:12.2093263Z                              }
2026-01-11T19:28:12.2093557Z                          } catch {
2026-01-11T19:28:12.2093938Z                              Write-Log "Could not disable $svc : $_" "ERROR"
2026-01-11T19:28:12.2094469Z                          }
2026-01-11T19:28:12.2094751Z                      }
2026-01-11T19:28:12.2095008Z                      
2026-01-11T19:28:12.2095226Z                      
2026-01-11T19:28:12.2095546Z                      # Disable telemetry scheduled task
2026-01-11T19:28:12.2096024Z                      Write-Section "Disabling Telemetry Scheduled Tasks"
2026-01-11T19:28:12.2097052Z                      $telemetryTasks = @(
2026-01-11T19:28:12.2097466Z                          "Microsoft\Windows\Autochk\Proxy",
2026-01-11T19:28:12.2098072Z                          "Microsoft\Windows\Customer Experience Improvement Program\Consolidator",
2026-01-11T19:28:12.2098880Z                          "Microsoft\Windows\Customer Experience Improvement Program\UsbCeip",
2026-01-11T19:28:12.2099834Z                          "Microsoft\Windows\DiskDiagnostic\Microsoft-Windows-DiskDiagnosticDataCollector",
2026-01-11T19:28:12.2100614Z                          "Microsoft\Windows\Feedback\Siuf\DmClient",
2026-01-11T19:28:12.2101291Z                          "Microsoft\Windows\Feedback\Siuf\DmClientOnScenarioDownload",
2026-01-11T19:28:12.2102041Z                          "Microsoft\Windows\Windows Error Reporting\QueueReporting",
2026-01-11T19:28:12.2102741Z                          "Microsoft\Windows\Application Experience\MareBackup",
2026-01-11T19:28:12.2103381Z                          "Microsoft\Windows\Application Experience\StartupAppTask",
2026-01-11T19:28:12.2104099Z                          "Microsoft\Windows\Application Experience\PcaPatchDbTask"
2026-01-11T19:28:12.2104608Z                      )
2026-01-11T19:28:12.2104814Z                      foreach ($task in $telemetryTasks) {
2026-01-11T19:28:12.2105216Z                          try {
2026-01-11T19:28:12.2105845Z                              Disable-ScheduledTask -TaskName $task -ErrorAction SilentlyContinue | Out-Null
2026-01-11T19:28:12.2106396Z                              Write-Log "Disabled scheduled task: $task" "SUCCESS"
2026-01-11T19:28:12.2107163Z                          } catch {
2026-01-11T19:28:12.2107647Z                              Write-Log "Could not disable task $task : $_" "ERROR"
2026-01-11T19:28:12.2108169Z                          }
2026-01-11T19:28:12.2108440Z                      }
2026-01-11T19:28:12.2108682Z                      
2026-01-11T19:28:12.2108874Z                      
2026-01-11T19:28:12.2109061Z                      # Disable Windows Copilot completely
2026-01-11T19:28:12.2109548Z                      Write-Section "Disabling Windows Copilot"
2026-01-11T19:28:12.2109865Z                      try {
2026-01-11T19:28:12.2110042Z                          # Policy keys
2026-01-11T19:28:12.2111788Z                          Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsCopilot" -Name 
2026-01-11T19:28:12.2112811Z                      "TurnOffWindowsCopilot" -Value 1
2026-01-11T19:28:12.2114050Z                          Set-RegistryValue -Path "HKCU:\Software\Policies\Microsoft\Windows\WindowsCopilot" -Name 
2026-01-11T19:28:12.2115967Z                      "TurnOffWindowsCopilot" -Value 1
2026-01-11T19:28:12.2116416Z                      
2026-01-11T19:28:12.2116973Z                          # UI visibility
2026-01-11T19:28:12.2117989Z                          Set-RegistryValue -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" 
2026-01-11T19:28:12.2118855Z                      -Name "ShowCopilotButton" -Value 0
2026-01-11T19:28:12.2119446Z                      
2026-01-11T19:28:12.2120132Z                          # Availability flags
2026-01-11T19:28:12.2121215Z                          Set-RegistryValue -Path "HKLM:\SOFTWARE\Microsoft\Windows\Shell\Copilot" -Name 
2026-01-11T19:28:12.2122840Z                      "IsCopilotAvailable" -Value 0
2026-01-11T19:28:12.2123610Z                          Set-RegistryValue -Path "HKLM:\SOFTWARE\Microsoft\Windows\Shell\Copilot" -Name 
2026-01-11T19:28:12.2124646Z                      "CopilotDisabledReason" -Value "IsEnabledForGeographicRegionFailed" -Type "String"
2026-01-11T19:28:12.2125714Z                          Set-RegistryValue -Path "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsCopilot" 
2026-01-11T19:28:12.2126534Z                      -Name "AllowCopilotRuntime" -Value 0
2026-01-11T19:28:12.2127199Z                      
2026-01-11T19:28:12.2127512Z                          # Shell extension blocking
2026-01-11T19:28:12.2128284Z                          Set-RegistryValue -Path "HKLM:\SOFTWARE\Microsoft\Windows\Shell Extensions\Blocked" -Name 
2026-01-11T19:28:12.2129210Z                      "{CB3B0003-8088-4EDE-8769-8B354AB2FF8C}" -Value "" -Type "String"
2026-01-11T19:28:12.2130085Z                          Set-RegistryValue -Path "HKLM:\SOFTWARE\Microsoft\Windows\Shell\Copilot\BingChat" -Name 
2026-01-11T19:28:12.2130527Z                      "IsUserEligible" -Value 0
2026-01-11T19:28:12.2130882Z                      
2026-01-11T19:28:12.2131194Z                          # Remove Copilot packages
2026-01-11T19:28:12.2132010Z                          Get-AppxPackage -AllUsers *Copilot* -ErrorAction SilentlyContinue | Remove-AppxPackage 
2026-01-11T19:28:12.2133038Z                      -AllUsers -ErrorAction SilentlyContinue
2026-01-11T19:28:12.2133630Z                          Get-AppxPackage -AllUsers Microsoft.MicrosoftOfficeHub -ErrorAction SilentlyContinue | 
2026-01-11T19:28:12.2134525Z                      Remove-AppxPackage -AllUsers -ErrorAction SilentlyContinue
2026-01-11T19:28:12.2135016Z                      
2026-01-11T19:28:12.2135449Z                          Write-Log "Copilot disabled and packages removed" "SUCCESS"
2026-01-11T19:28:12.2135971Z                      } catch {
2026-01-11T19:28:12.2136340Z                          Write-Log "Error disabling Copilot: $_" "ERROR"
2026-01-11T19:28:12.2136760Z                      }
2026-01-11T19:28:12.2137061Z                      
2026-01-11T19:28:12.2137323Z                      
2026-01-11T19:28:12.2137760Z                      # Disable location sensors and location-based permission stores.
2026-01-11T19:28:12.2138435Z                      Write-Section "Disabling Location Tracking"
2026-01-11T19:28:12.2139172Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\LocationAndSensors" -Name 
2026-01-11T19:28:12.2139805Z                      "DisableLocation" -Value 1
2026-01-11T19:28:12.2140556Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\LocationAndSensors" -Name 
2026-01-11T19:28:12.2141455Z                      "DisableWindowsLocationProvider" -Value 1
2026-01-11T19:28:12.2142721Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\LocationAndSensors" -Name 
2026-01-11T19:28:12.2143559Z                      "DisableLocationScripting" -Value 1
2026-01-11T19:28:12.2144032Z                      Set-RegistryValue -Path 
2026-01-11T19:28:12.2144828Z                      "HKCU:\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\location" 
2026-01-11T19:28:12.2146391Z                      -Name "Value" -Value "Deny" -Type "String"
2026-01-11T19:28:12.2146855Z                      
2026-01-11T19:28:12.2147091Z                      
2026-01-11T19:28:12.2147652Z                      # Block camera access for UWP/modern apps, keep microphone enabled for voice chat.
2026-01-11T19:28:12.2148391Z                      Write-Section "Hardening Camera Privacy"
2026-01-11T19:28:12.2149141Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy" -Name 
2026-01-11T19:28:12.2149888Z                      "LetAppsAccessCamera" -Value 2
2026-01-11T19:28:12.2150328Z                      Set-RegistryValue -Path 
2026-01-11T19:28:12.2151052Z                      "HKCU:\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\webcam" 
2026-01-11T19:28:12.2151676Z                      -Name "Value" -Value "Deny" -Type "String"
2026-01-11T19:28:12.2152194Z                      
2026-01-11T19:28:12.2152682Z                      
2026-01-11T19:28:12.2153166Z                      Write-Log "Camera blocked | Microphone enabled for gaming voice chat" "SUCCESS"
2026-01-11T19:28:12.2153763Z                      
2026-01-11T19:28:12.2154248Z                      
2026-01-11T19:28:12.2154676Z                      # Disable Windows Hello biometrics and PIN logon for domain usage.
2026-01-11T19:28:12.2155291Z                      Write-Section "Disabling Biometrics"
2026-01-11T19:28:12.2156086Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Biometrics" -Name "Enabled" -Value 0
2026-01-11T19:28:12.2156950Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\System" -Name 
2026-01-11T19:28:12.2157659Z                      "AllowDomainPINLogon" -Value 0
2026-01-11T19:28:12.2158052Z                      
2026-01-11T19:28:12.2158310Z                      
2026-01-11T19:28:12.2158687Z                      # Remove OneDrive background sync and shell integration.
2026-01-11T19:28:12.2159209Z                      Write-Section "Disabling OneDrive"
2026-01-11T19:28:12.2159631Z                      try {
2026-01-11T19:28:12.2159983Z                          taskkill /f /im OneDrive.exe 2>&1 | Out-Null
2026-01-11T19:28:12.2160426Z                      
2026-01-11T19:28:12.2160837Z                          if (Test-Path "$env:SystemRoot\System32\OneDriveSetup.exe") {
2026-01-11T19:28:12.2161526Z                              & "$env:SystemRoot\System32\OneDriveSetup.exe" /uninstall
2026-01-11T19:28:12.2162052Z                          }
2026-01-11T19:28:12.2162520Z                          if (Test-Path "$env:SystemRoot\SysWOW64\OneDriveSetup.exe") {
2026-01-11T19:28:12.2163203Z                              & "$env:SystemRoot\SysWOW64\OneDriveSetup.exe" /uninstall
2026-01-11T19:28:12.2164098Z                          }
2026-01-11T19:28:12.2164501Z                      
2026-01-11T19:28:12.2165293Z                          Set-RegistryValue -Path "HKCR:\CLSID\{018D5C66-4533-4307-9B53-224DE2ED1FE6}" -Name 
2026-01-11T19:28:12.2166087Z                      "System.IsPinnedToNameSpaceTree" -Value 0
2026-01-11T19:28:12.2166865Z                          Set-RegistryValue -Path "HKCR:\Wow6432Node\CLSID\{018D5C66-4533-4307-9B53-224DE2ED1FE6}" 
2026-01-11T19:28:12.2167698Z                      -Name "System.IsPinnedToNameSpaceTree" -Value 0
2026-01-11T19:28:12.2168141Z                      
2026-01-11T19:28:12.2168744Z                          Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\OneDrive" -Name 
2026-01-11T19:28:12.2169487Z                      "DisableFileSyncNGSC" -Value 1
2026-01-11T19:28:12.2170196Z                          Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\OneDrive" -Name 
2026-01-11T19:28:12.2170927Z                      "DisableFileSync" -Value 1
2026-01-11T19:28:12.2171303Z                      
2026-01-11T19:28:12.2172242Z                          Remove-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Run" -Name 
2026-01-11T19:28:12.2173387Z                      "OneDrive" -ErrorAction SilentlyContinue
2026-01-11T19:28:12.2173868Z                      
2026-01-11T19:28:12.2174310Z                          Write-Log "OneDrive disabled and uninstalled" "SUCCESS"
2026-01-11T19:28:12.2174802Z                      } catch {
2026-01-11T19:28:12.2175142Z                          Write-Log "Error disabling OneDrive: $_" "ERROR"
2026-01-11T19:28:12.2175591Z                      }
2026-01-11T19:28:12.2175750Z                      
2026-01-11T19:28:12.2176035Z                      
2026-01-11T19:28:12.2176419Z                      # Disable Windows settings sync to reduce cloud footprint.
2026-01-11T19:28:12.2176898Z                      Write-Section "Disabling Sync Settings"
2026-01-11T19:28:12.2177687Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\SettingSync" -Name 
2026-01-11T19:28:12.2178278Z                      "DisableSettingSync" -Value 2
2026-01-11T19:28:12.2178972Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\SettingSync" -Name 
2026-01-11T19:28:12.2179585Z                      "DisableSettingSyncUserOverride" -Value 1
2026-01-11T19:28:12.2180621Z                      Set-RegistryValue -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\SettingSync" -Name 
2026-01-11T19:28:12.2181289Z                      "SyncPolicy" -Value 5
2026-01-11T19:28:12.2182424Z                      Set-RegistryValue -Path 
2026-01-11T19:28:12.2183245Z                      "HKCU:\Software\Microsoft\Windows\CurrentVersion\SettingSync\Groups\Personalization" -Name 
2026-01-11T19:28:12.2183898Z                      "Enabled" -Value 0
2026-01-11T19:28:12.2184529Z                      Set-RegistryValue -Path 
2026-01-11T19:28:12.2186098Z                      "HKCU:\Software\Microsoft\Windows\CurrentVersion\SettingSync\Groups\BrowserSettings" -Name 
2026-01-11T19:28:12.2186733Z                      "Enabled" -Value 0
2026-01-11T19:28:12.2187109Z                      Set-RegistryValue -Path 
2026-01-11T19:28:12.2188728Z                      "HKCU:\Software\Microsoft\Windows\CurrentVersion\SettingSync\Groups\Credentials" -Name "Enabled" 
2026-01-11T19:28:12.2189520Z                      -Value 0
2026-01-11T19:28:12.2189738Z                      Set-RegistryValue -Path 
2026-01-11T19:28:12.2190553Z                      "HKCU:\Software\Microsoft\Windows\CurrentVersion\SettingSync\Groups\Language" -Name "Enabled" 
2026-01-11T19:28:12.2191320Z                      -Value 0
2026-01-11T19:28:12.2191693Z                      Set-RegistryValue -Path 
2026-01-11T19:28:12.2192424Z                      "HKCU:\Software\Microsoft\Windows\CurrentVersion\SettingSync\Groups\Accessibility" -Name 
2026-01-11T19:28:12.2193429Z                      "Enabled" -Value 0
2026-01-11T19:28:12.2193790Z                      Set-RegistryValue -Path 
2026-01-11T19:28:12.2194512Z                      "HKCU:\Software\Microsoft\Windows\CurrentVersion\SettingSync\Groups\Windows" -Name "Enabled" 
2026-01-11T19:28:12.2195280Z                      -Value 0
2026-01-11T19:28:12.2195549Z                      
2026-01-11T19:28:12.2195783Z                      
2026-01-11T19:28:12.2196282Z                      # Prevent Microsoft account sign-in integration (local account bias).
2026-01-11T19:28:12.2196911Z                      Write-Section "Disabling Microsoft Account Integration"
2026-01-11T19:28:12.2197739Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Microsoft\PolicyManager\current\device\Accounts" -Name 
2026-01-11T19:28:12.2198460Z                      "AllowMicrosoftAccountConnection" -Value 0
2026-01-11T19:28:12.2199276Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\MicrosoftAccount" -Name 
2026-01-11T19:28:12.2199951Z                      "DisableUserAuth" -Value 1
2026-01-11T19:28:12.2200177Z                      
2026-01-11T19:28:12.2200673Z                      
2026-01-11T19:28:12.2201237Z                      # Disable consumer cloud content delivery and spotlight suggestions.
2026-01-11T19:28:12.2201909Z                      Write-Section "Disabling Cloud Content"
2026-01-11T19:28:12.2202707Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\CloudContent" -Name 
2026-01-11T19:28:12.2203213Z                      "DisableWindowsConsumerFeatures" -Value 1
2026-01-11T19:28:12.2203875Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\CloudContent" -Name 
2026-01-11T19:28:12.2204379Z                      "DisableCloudOptimizedContent" -Value 1
2026-01-11T19:28:12.2205221Z                      Set-RegistryValue -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" 
2026-01-11T19:28:12.2206173Z                      -Name "ContentDeliveryAllowed" -Value 0
2026-01-11T19:28:12.2206986Z                      Set-RegistryValue -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" 
2026-01-11T19:28:12.2207910Z                      -Name "OemPreInstalledAppsEnabled" -Value 0
2026-01-11T19:28:12.2208707Z                      Set-RegistryValue -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" 
2026-01-11T19:28:12.2209502Z                      -Name "PreInstalledAppsEnabled" -Value 0
2026-01-11T19:28:12.2209976Z                      Set-RegistryValue -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" 
2026-01-11T19:28:12.2210857Z                      -Name "PreInstalledAppsEverEnabled" -Value 0
2026-01-11T19:28:12.2211617Z                      Set-RegistryValue -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" 
2026-01-11T19:28:12.2212462Z                      -Name "SilentInstalledAppsEnabled" -Value 0
2026-01-11T19:28:12.2213529Z                      Set-RegistryValue -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" 
2026-01-11T19:28:12.2214496Z                      -Name "SubscribedContent-338387Enabled" -Value 0
2026-01-11T19:28:12.2215471Z                      Set-RegistryValue -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" 
2026-01-11T19:28:12.2216061Z                      -Name "SubscribedContent-338388Enabled" -Value 0
2026-01-11T19:28:12.2216985Z                      Set-RegistryValue -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" 
2026-01-11T19:28:12.2217854Z                      -Name "SubscribedContent-338389Enabled" -Value 0
2026-01-11T19:28:12.2218490Z                      Set-RegistryValue -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" 
2026-01-11T19:28:12.2219290Z                      -Name "SubscribedContent-353698Enabled" -Value 0
2026-01-11T19:28:12.2220091Z                      Set-RegistryValue -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" 
2026-01-11T19:28:12.2220969Z                      -Name "SystemPaneSuggestionsEnabled" -Value 0
2026-01-11T19:28:12.2221479Z                      
2026-01-11T19:28:12.2221756Z                      
2026-01-11T19:28:12.2222189Z                      # Stop app suggestions and sync provider notifications.
2026-01-11T19:28:12.2222843Z                      Write-Section "Disabling App Suggestions"
2026-01-11T19:28:12.2223405Z                      Set-RegistryValue -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" 
2026-01-11T19:28:12.2224243Z                      -Name "SoftLandingEnabled" -Value 0
2026-01-11T19:28:12.2225122Z                      Set-RegistryValue -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -Name 
2026-01-11T19:28:12.2226019Z                      "ShowSyncProviderNotifications" -Value 0
2026-01-11T19:28:12.2226456Z                      
2026-01-11T19:28:12.2226698Z                      
2026-01-11T19:28:12.2227299Z                      # Disable typing/ink data collection used for personalization.
2026-01-11T19:28:12.2228020Z                      Write-Section "Disabling Typing Data Collection"
2026-01-11T19:28:12.2228824Z                      Set-RegistryValue -Path "HKCU:\Software\Microsoft\InputPersonalization" -Name 
2026-01-11T19:28:12.2229609Z                      "RestrictImplicitInkCollection" -Value 1
2026-01-11T19:28:12.2230406Z                      Set-RegistryValue -Path "HKCU:\Software\Microsoft\InputPersonalization" -Name 
2026-01-11T19:28:12.2231200Z                      "RestrictImplicitTextCollection" -Value 1
2026-01-11T19:28:12.2232028Z                      Set-RegistryValue -Path "HKCU:\Software\Microsoft\InputPersonalization\TrainedDataStore" -Name 
2026-01-11T19:28:12.2233144Z                      "HarvestContacts" -Value 0
2026-01-11T19:28:12.2233846Z                      Set-RegistryValue -Path "HKCU:\Software\Microsoft\Personalization\Settings" -Name 
2026-01-11T19:28:12.2234561Z                      "AcceptedPrivacyPolicy" -Value 0
2026-01-11T19:28:12.2234855Z                      
2026-01-11T19:28:12.2235119Z                      
2026-01-11T19:28:12.2235425Z                      # Block handwriting data sharing.
2026-01-11T19:28:12.2236076Z                      Write-Section "Disabling Handwriting Data Collection"
2026-01-11T19:28:12.2237708Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\TabletPC" -Name 
2026-01-11T19:28:12.2238576Z                      "PreventHandwritingDataSharing" -Value 1
2026-01-11T19:28:12.2240071Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\HandwritingErrorReports" -Name 
2026-01-11T19:28:12.2241029Z                      "PreventHandwritingErrorReports" -Value 1
2026-01-11T19:28:12.2241509Z                      
2026-01-11T19:28:12.2241775Z                      
2026-01-11T19:28:12.2242260Z                      # Disable Microsoft experimentation/feature rollouts (A/B testing).
2026-01-11T19:28:12.2243033Z                      Write-Section "Disabling Microsoft Experimentation"
2026-01-11T19:28:12.2243705Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Microsoft\PolicyManager\current\device\System" -Name 
2026-01-11T19:28:12.2244520Z                      "AllowExperimentation" -Value 0
2026-01-11T19:28:12.2244950Z                      Set-RegistryValue -Path 
2026-01-11T19:28:12.2245484Z                      "HKLM:\SOFTWARE\Microsoft\PolicyManager\default\System\AllowExperimentation" -Name "value" -Value 
2026-01-11T19:28:12.2246295Z                      0
2026-01-11T19:28:12.2246590Z                      
2026-01-11T19:28:12.2246820Z                      
2026-01-11T19:28:12.2247166Z                      # Deny UWP app access to account data and identity info.
2026-01-11T19:28:12.2247534Z                      Write-Section "Disabling App Access to Account Info"
2026-01-11T19:28:12.2249074Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\C
2026-01-11T19:28:12.2250234Z                      onsentStore\userAccountInformation" -Name "Value" -Value "Deny" -Type "String"
2026-01-11T19:28:12.2251101Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy" -Name 
2026-01-11T19:28:12.2251689Z                      "LetAppsAccessAccountInfo" -Value 2
2026-01-11T19:28:12.2251935Z                      
2026-01-11T19:28:12.2252202Z                      
2026-01-11T19:28:12.2252894Z                      # Deny app access to contacts and PIM data sources.
2026-01-11T19:28:12.2253714Z                      Write-Section "Disabling App Access to Contacts"
2026-01-11T19:28:12.2254663Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy" -Name 
2026-01-11T19:28:12.2255275Z                      "LetAppsAccessContacts" -Value 2
2026-01-11T19:28:12.2255707Z                      
2026-01-11T19:28:12.2256879Z                      
2026-01-11T19:28:12.2257583Z                      # Deny app access to calendar entries.
2026-01-11T19:28:12.2258167Z                      Write-Section "Disabling App Access to Calendar"
2026-01-11T19:28:12.2258821Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy" -Name 
2026-01-11T19:28:12.2259551Z                      "LetAppsAccessCalendar" -Value 2
2026-01-11T19:28:12.2259946Z                      
2026-01-11T19:28:12.2260195Z                      
2026-01-11T19:28:12.2260497Z                      # Deny app access to call history logs.
2026-01-11T19:28:12.2261712Z                      Write-Section "Disabling App Access to Call History"
2026-01-11T19:28:12.2262528Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy" -Name 
2026-01-11T19:28:12.2263143Z                      "LetAppsAccessCallHistory" -Value 2
2026-01-11T19:28:12.2263587Z                      
2026-01-11T19:28:12.2263854Z                      
2026-01-11T19:28:12.2265021Z                      # Deny app access to email data.
2026-01-11T19:28:12.2265542Z                      Write-Section "Disabling App Access to Email"
2026-01-11T19:28:12.2267788Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy" -Name 
2026-01-11T19:28:12.2268839Z                      "LetAppsAccessEmail" -Value 2
2026-01-11T19:28:12.2269239Z                      
2026-01-11T19:28:12.2269508Z                      
2026-01-11T19:28:12.2269846Z                      # Deny app access to notifications history.
2026-01-11T19:28:12.2270407Z                      Write-Section "Disabling App Access to Notifications"
2026-01-11T19:28:12.2271242Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy" -Name 
2026-01-11T19:28:12.2272005Z                      "LetAppsAccessNotifications" -Value 2
2026-01-11T19:28:12.2272471Z                      
2026-01-11T19:28:12.2272752Z                      
2026-01-11T19:28:12.2273933Z                      # Prevent automatic map package downloads.
2026-01-11T19:28:12.2274544Z                      Write-Section "Disabling Maps Auto-Update"
2026-01-11T19:28:12.2275280Z                      Set-RegistryValue -Path "HKLM:\SYSTEM\Maps" -Name "AutoUpdateEnabled" -Value 0
2026-01-11T19:28:12.2276503Z                      
2026-01-11T19:28:12.2276823Z                      
2026-01-11T19:28:12.2277281Z                      # Adds telemetry domains to hosts file; requires ownership/ACL changes.
2026-01-11T19:28:12.2277960Z                      Write-Section "Advanced Hosts File Telemetry Blocking"
2026-01-11T19:28:12.2279048Z                      try {
2026-01-11T19:28:12.2279497Z                          $hostsFile = "$env:SystemRoot\System32\drivers\etc\hosts"
2026-01-11T19:28:12.2280026Z                      
2026-01-11T19:28:12.2280634Z                          # Ownership and permissions are required for hardened builds or customized ACLs.
2026-01-11T19:28:12.2281771Z                          Write-Log "Taking ownership of hosts file (required for X-Lite builds)..."
2026-01-11T19:28:12.2282403Z                      
2026-01-11T19:28:12.2282800Z                          $takeownResult = takeown.exe /F $hostsFile /A 2>&1
2026-01-11T19:28:12.2283306Z                          if ($LASTEXITCODE -eq 0) {
2026-01-11T19:28:12.2283882Z                              Write-Log "Successfully took ownership of hosts file" "SUCCESS"
2026-01-11T19:28:12.2284489Z                          } else {
2026-01-11T19:28:12.2284933Z                              Write-Log "Takeown result: $takeownResult" "ERROR"
2026-01-11T19:28:12.2285438Z                          }
2026-01-11T19:28:12.2285619Z                      
2026-01-11T19:28:12.2286129Z                          $icaclsResult = icacls.exe $hostsFile /grant "Administrators:F" 2>&1
2026-01-11T19:28:12.2286589Z                          if ($LASTEXITCODE -eq 0) {
2026-01-11T19:28:12.2287575Z                              Write-Log "Successfully granted full permissions to Administrators" "SUCCESS"
2026-01-11T19:28:12.2288681Z                          } else {
2026-01-11T19:28:12.2289235Z                              Write-Log "Icacls result: $icaclsResult" "ERROR"
2026-01-11T19:28:12.2289789Z                          }
2026-01-11T19:28:12.2290082Z                      
2026-01-11T19:28:12.2290746Z                          $currentUser = [System.Security.Principal.WindowsIdentity]::GetCurrent().Name
2026-01-11T19:28:12.2291560Z                          icacls.exe $hostsFile /grant "${currentUser}:F" 2>&1 | Out-Null
2026-01-11T19:28:12.2291883Z                      
2026-01-11T19:28:12.2292443Z                          # DNS Client can keep the hosts file locked; stop it temporarily if running.
2026-01-11T19:28:12.2293318Z                          Write-Log "Stopping DNS Client service to unlock hosts file..."
2026-01-11T19:28:12.2294072Z                          $dnsService = Get-Service -Name "Dnscache" -ErrorAction SilentlyContinue
2026-01-11T19:28:12.2294739Z                          $dnsWasRunning = $false
2026-01-11T19:28:12.2295085Z                      
2026-01-11T19:28:12.2295749Z                          if ($dnsService) {
2026-01-11T19:28:12.2296699Z                              if ($dnsService.Status -eq "Running") {
2026-01-11T19:28:12.2297137Z                                  try {
2026-01-11T19:28:12.2298343Z                                      # Try using sc.exe as alternative (works better on X-Lite builds)
2026-01-11T19:28:12.2299048Z                                      $stopResult = sc.exe stop "Dnscache" 2>&1
2026-01-11T19:28:12.2299508Z                                      if ($LASTEXITCODE -eq 0) {
2026-01-11T19:28:12.2299883Z                                          $dnsWasRunning = $true
2026-01-11T19:28:12.2300679Z                                          Write-Log "DNS Client service stopped" "SUCCESS"
2026-01-11T19:28:12.2301202Z                                          Start-Sleep -Seconds 3
2026-01-11T19:28:12.2301661Z                                      } else {
2026-01-11T19:28:12.2302982Z                                          Write-Log "DNS Client service could not be stopped (X-Lite build 
2026-01-11T19:28:12.2303598Z                      restrictions)" "ERROR"
2026-01-11T19:28:12.2304285Z                                          Write-Log "Continuing with ownership/permissions changes..." "SUCCESS"
2026-01-11T19:28:12.2304774Z                                      }
2026-01-11T19:28:12.2305861Z                                  } catch {
2026-01-11T19:28:12.2306700Z                                      Write-Log "DNS Client service stop failed: $_" "ERROR"
2026-01-11T19:28:12.2307972Z                                      Write-Log "Continuing with ownership/permissions changes..." "SUCCESS"
2026-01-11T19:28:12.2308931Z                                  }
2026-01-11T19:28:12.2309278Z                              } else {
2026-01-11T19:28:12.2309829Z                                  Write-Log "DNS Client service is not running" "SUCCESS"
2026-01-11T19:28:12.2310349Z                              }
2026-01-11T19:28:12.2311060Z                          } else {
2026-01-11T19:28:12.2312671Z                              Write-Log "DNS Client service not found (disabled on X-Lite builds)" "SUCCESS"
2026-01-11T19:28:12.2313367Z                          }
2026-01-11T19:28:12.2313640Z                      
2026-01-11T19:28:12.2313904Z                          try {
2026-01-11T19:28:12.2314774Z                              $backupPath = "$hostsFile.backup-$(Get-Date -Format 'yyyyMMdd-HHmmss')"
2026-01-11T19:28:12.2315449Z                      
2026-01-11T19:28:12.2315902Z                              $hostsBytes = [System.IO.File]::ReadAllBytes($hostsFile)
2026-01-11T19:28:12.2316609Z                              [System.IO.File]::WriteAllBytes($backupPath, $hostsBytes)
2026-01-11T19:28:12.2317539Z                              Write-Log "Backed up hosts file to: $backupPath" "SUCCESS"
2026-01-11T19:28:12.2318138Z                      
2026-01-11T19:28:12.2318578Z                              # Curated list of telemetry/ads endpoints to null-route.
2026-01-11T19:28:12.2319213Z                              $telemetryDomains = @(
2026-01-11T19:28:12.2319716Z                                  "vortex.data.microsoft.com",
2026-01-11T19:28:12.2320280Z                                  "vortex-win.data.microsoft.com",
2026-01-11T19:28:12.2320818Z                                  "telecommand.telemetry.microsoft.com",
2026-01-11T19:28:12.2321472Z                                  "telecommand.telemetry.microsoft.com.nsatc.net",
2026-01-11T19:28:12.2321694Z                                  "oca.telemetry.microsoft.com",
2026-01-11T19:28:12.2321906Z                                  "oca.telemetry.microsoft.com.nsatc.net",
2026-01-11T19:28:12.2322014Z                                  "sqm.telemetry.microsoft.com",
2026-01-11T19:28:12.2322443Z                                  "sqm.telemetry.microsoft.com.nsatc.net",
2026-01-11T19:28:12.2323452Z                                  "watson.telemetry.microsoft.com",
2026-01-11T19:28:12.2324107Z                                  "watson.telemetry.microsoft.com.nsatc.net",
2026-01-11T19:28:12.2324917Z                                  "redir.metaservices.microsoft.com",
2026-01-11T19:28:12.2325114Z                                  "choice.microsoft.com",
2026-01-11T19:28:12.2326281Z                                  "choice.microsoft.com.nsatc.net",
2026-01-11T19:28:12.2326466Z                                  "df.telemetry.microsoft.com",
2026-01-11T19:28:12.2327816Z                                  "reports.wes.df.telemetry.microsoft.com",
2026-01-11T19:28:12.2328015Z                                  "wes.df.telemetry.microsoft.com",
2026-01-11T19:28:12.2328220Z                                  "services.wes.df.telemetry.microsoft.com",
2026-01-11T19:28:12.2329254Z                                  "sqm.df.telemetry.microsoft.com",
2026-01-11T19:28:12.2330041Z                                  "telemetry.microsoft.com",
2026-01-11T19:28:12.2331156Z                                  "telemetry.appex.bing.net",
2026-01-11T19:28:12.2331359Z                                  "telemetry.urs.microsoft.com",
2026-01-11T19:28:12.2332268Z                                  "telemetry.appex.bing.net:443",
2026-01-11T19:28:12.2332488Z                                  "settings-sandbox.data.microsoft.com",
2026-01-11T19:28:12.2333783Z                                  "vortex-sandbox.data.microsoft.com",
2026-01-11T19:28:12.2334183Z                                  "survey.watson.microsoft.com",
2026-01-11T19:28:12.2335042Z                                  "watson.live.com",
2026-01-11T19:28:12.2336021Z                                  "watson.microsoft.com",
2026-01-11T19:28:12.2337050Z                                  "statsfe2.ws.microsoft.com",
2026-01-11T19:28:12.2338295Z                                  "corpext.msitadfs.glbdns2.microsoft.com",
2026-01-11T19:28:12.2338506Z                                  "compatexchange.cloudapp.net",
2026-01-11T19:28:12.2339205Z                                  "cs1.wpc.v0cdn.net",
2026-01-11T19:28:12.2339996Z                                  "a-0001.a-msedge.net",
2026-01-11T19:28:12.2340992Z                                  "statsfe2.update.microsoft.com.akadns.net",
2026-01-11T19:28:12.2341771Z                                  "sls.update.microsoft.com.akadns.net",
2026-01-11T19:28:12.2342472Z                                  "fe2.update.microsoft.com.akadns.net",
2026-01-11T19:28:12.2343738Z                                  "diagnostics.support.microsoft.com",
2026-01-11T19:28:12.2343939Z                                  "corp.sts.microsoft.com",
2026-01-11T19:28:12.2344293Z                                  "statsfe1.ws.microsoft.com",
2026-01-11T19:28:12.2345607Z                                  "pre.footprintpredict.com",
2026-01-11T19:28:12.2346401Z                                  "i1.services.social.microsoft.com",
2026-01-11T19:28:12.2347294Z                                  "i1.services.social.microsoft.com.nsatc.net",
2026-01-11T19:28:12.2347825Z                                  "feedback.windows.com",
2026-01-11T19:28:12.2349147Z                                  "feedback.microsoft-hohm.com",
2026-01-11T19:28:12.2349693Z                                  "feedback.search.microsoft.com",
2026-01-11T19:28:12.2350736Z                                  "fe3.delivery.dsp.mp.microsoft.com.nsatc.net",
2026-01-11T19:28:12.2351142Z                                  "tlu.dl.delivery.mp.microsoft.com",
2026-01-11T19:28:12.2352054Z                                  "ads.msn.com",
2026-01-11T19:28:12.2353077Z                                  "ads1.msn.com",
2026-01-11T19:28:12.2353698Z                                  "ads2.msn.com",
2026-01-11T19:28:12.2354646Z                                  "bingads.microsoft.com",
2026-01-11T19:28:12.2355510Z                                  "rad.msn.com",
2026-01-11T19:28:12.2356590Z                                  "flex.msn.com"
2026-01-11T19:28:12.2356689Z                              )
2026-01-11T19:28:12.2357570Z                      
2026-01-11T19:28:12.2358652Z                              $hostsContentRaw = [System.IO.File]::ReadAllText($hostsFile)
2026-01-11T19:28:12.2359759Z                              $hostsContent = $hostsContentRaw -split "`r?`n"
2026-01-11T19:28:12.2360580Z                              $newEntries = @()
2026-01-11T19:28:12.2361489Z                      
2026-01-11T19:28:12.2362821Z                              foreach ($domain in $telemetryDomains) {
2026-01-11T19:28:12.2362998Z                                  $entry = "0.0.0.0 $domain"
2026-01-11T19:28:12.2363597Z                                  if ($hostsContent -notcontains $entry) {
2026-01-11T19:28:12.2364665Z                                      $newEntries += $entry
2026-01-11T19:28:12.2364848Z                                  }
2026-01-11T19:28:12.2366183Z                              }
2026-01-11T19:28:12.2366273Z                      
2026-01-11T19:28:12.2368323Z                              if ($newEntries.Count -gt 0) {
2026-01-11T19:28:12.2368518Z                                  $newContent = $hostsContentRaw
2026-01-11T19:28:12.2370113Z                                  if (-not $hostsContentRaw.EndsWith("`n")) {
2026-01-11T19:28:12.2370280Z                                      $newContent += "`r`n"
2026-01-11T19:28:12.2370388Z                                  }
2026-01-11T19:28:12.2371811Z                                  $newContent += "`r`n# Extreme Privacy - Microsoft Telemetry Blocking ($(Get-Date 
2026-01-11T19:28:12.2371978Z                      -Format 'yyyy-MM-dd'))`r`n"
2026-01-11T19:28:12.2373814Z                                  $newContent += ($newEntries -join "`r`n")
2026-01-11T19:28:12.2373958Z                                  $newContent += "`r`n"
2026-01-11T19:28:12.2374043Z                      
2026-01-11T19:28:12.2374561Z                                  # Preserve UTF-8 without BOM to avoid compatibility issues.
2026-01-11T19:28:12.2375382Z                                  $utf8NoBom = New-Object System.Text.UTF8Encoding $false
2026-01-11T19:28:12.2377046Z                                  [System.IO.File]::WriteAllText($hostsFile, $newContent, $utf8NoBom)
2026-01-11T19:28:12.2377173Z                      
2026-01-11T19:28:12.2377585Z                                  Write-Log "Added $($newEntries.Count) telemetry domains to hosts file" "SUCCESS"
2026-01-11T19:28:12.2378193Z                              } else {
2026-01-11T19:28:12.2378604Z                                  Write-Log "All telemetry domains already blocked in hosts file" "SUCCESS"
2026-01-11T19:28:12.2379048Z                              }
2026-01-11T19:28:12.2380165Z                      
2026-01-11T19:28:12.2380848Z                          } finally {
2026-01-11T19:28:12.2381658Z                              if ($dnsWasRunning) {
2026-01-11T19:28:12.2382728Z                                  try {
2026-01-11T19:28:12.2383294Z                                      $startResult = sc.exe start "Dnscache" 2>&1
2026-01-11T19:28:12.2384409Z                                      if ($LASTEXITCODE -eq 0) {
2026-01-11T19:28:12.2384645Z                                          Write-Log "DNS Client service restarted" "SUCCESS"
2026-01-11T19:28:12.2385288Z                                      } else {
2026-01-11T19:28:12.2386665Z                                          Start-Service -Name "Dnscache" -ErrorAction SilentlyContinue
2026-01-11T19:28:12.2387300Z                                          Write-Log "DNS Client service restarted" "SUCCESS"
2026-01-11T19:28:12.2387406Z                                      }
2026-01-11T19:28:12.2388370Z                                  } catch {
2026-01-11T19:28:12.2390096Z                                      Write-Log "DNS Client service could not be restarted (may require manual 
2026-01-11T19:28:12.2390238Z                      restart)" "ERROR"
2026-01-11T19:28:12.2390387Z                                  }
2026-01-11T19:28:12.2391151Z                      
2026-01-11T19:28:12.2392020Z                                  try {
2026-01-11T19:28:12.2393011Z                                      ipconfig /flushdns | Out-Null
2026-01-11T19:28:12.2394115Z                                      Write-Log "DNS cache flushed" "SUCCESS"
2026-01-11T19:28:12.2394236Z                                  } catch {
2026-01-11T19:28:12.2395389Z                                      Write-Log "Could not flush DNS cache" "ERROR"
2026-01-11T19:28:12.2395513Z                                  }
2026-01-11T19:28:12.2396418Z                              }
2026-01-11T19:28:12.2397555Z                          }
2026-01-11T19:28:12.2397779Z                      
2026-01-11T19:28:12.2399337Z                      } catch {
2026-01-11T19:28:12.2400325Z                          Write-Log "Error modifying hosts file: $_" "ERROR"
2026-01-11T19:28:12.2400791Z                      }
2026-01-11T19:28:12.2401257Z                      
2026-01-11T19:28:12.2401672Z                      
2026-01-11T19:28:12.2402743Z                      if ($EnableFirewallRules) {
2026-01-11T19:28:12.2403104Z                          # Optional: outbound firewall rules for known telemetry IPs.
2026-01-11T19:28:12.2404576Z                          Write-Section "Creating Firewall Rules to Block Telemetry"
2026-01-11T19:28:12.2404744Z                          try {
2026-01-11T19:28:12.2405476Z                              $telemetryIPs = @(
2026-01-11T19:28:12.2406052Z                                  "134.170.30.202",
2026-01-11T19:28:12.2406745Z                                  "137.116.81.24",
2026-01-11T19:28:12.2408248Z                                  "157.56.106.189",
2026-01-11T19:28:12.2408369Z                                  "184.86.53.99",
2026-01-11T19:28:12.2408578Z                                  "2.22.61.43",
2026-01-11T19:28:12.2409257Z                                  "2.22.61.66",
2026-01-11T19:28:12.2410459Z                                  "204.79.197.200",
2026-01-11T19:28:12.2410985Z                                  "23.218.212.69",
2026-01-11T19:28:12.2411690Z                                  "65.39.117.230",
2026-01-11T19:28:12.2412806Z                                  "65.52.108.33",
2026-01-11T19:28:12.2413871Z                                  "65.55.108.23"
2026-01-11T19:28:12.2414816Z                              )
2026-01-11T19:28:12.2415036Z                      
2026-01-11T19:28:12.2416071Z                              foreach ($ip in $telemetryIPs) {
2026-01-11T19:28:12.2416423Z                                  $ruleName = "Block Telemetry IP $ip"
2026-01-11T19:28:12.2417738Z                                  if (-not (Get-NetFirewallRule -DisplayName $ruleName -ErrorAction SilentlyContinue)) {
2026-01-11T19:28:12.2418803Z                                      New-NetFirewallRule -DisplayName $ruleName -Direction Outbound -RemoteAddress $ip 
2026-01-11T19:28:12.2419449Z                      -Action Block -ErrorAction SilentlyContinue | Out-Null
2026-01-11T19:28:12.2419727Z                                      Write-Log "Created firewall rule: $ruleName" "SUCCESS"
2026-01-11T19:28:12.2420359Z                                  }
2026-01-11T19:28:12.2420476Z                              }
2026-01-11T19:28:12.2421784Z                      
2026-01-11T19:28:12.2422129Z                              Write-Log "Firewall rules created to block telemetry IPs" "SUCCESS"
2026-01-11T19:28:12.2423464Z                          } catch {
2026-01-11T19:28:12.2424186Z                              Write-Log "Error creating firewall rules: $_" "ERROR"
2026-01-11T19:28:12.2425048Z                          }
2026-01-11T19:28:12.2425474Z                      }
2026-01-11T19:28:12.2427832Z                      
2026-01-11T19:28:12.2427968Z                      
2026-01-11T19:28:12.2429153Z                      Write-Progress -Activity "Extreme Privacy" -Completed
2026-01-11T19:28:12.2429981Z                      Write-Log "=== Extreme Privacy Script Completed ===" "SUCCESS"
2026-01-11T19:28:12.2430932Z                      Write-Host ""
2026-01-11T19:28:12.2431854Z                      Write-Host "=== EXTREME PRIVACY APPLIED ===" -ForegroundColor Green
2026-01-11T19:28:12.2432353Z                      Write-Host ""
2026-01-11T19:28:12.2433421Z                      Write-Host "WARNING: Some Windows features are now disabled:" -ForegroundColor Yellow
2026-01-11T19:28:12.2434076Z                      Write-Host "  - Windows Update (disabled completely)" -ForegroundColor White
2026-01-11T19:28:12.2434602Z                      Write-Host "  - OneDrive (uninstalled)" -ForegroundColor White
2026-01-11T19:28:12.2435282Z                      Write-Host "  - Microsoft Account sync" -ForegroundColor White
2026-01-11T19:28:12.2436390Z                      Write-Host "  - Store auto-updates may be affected" -ForegroundColor White
2026-01-11T19:28:12.2436786Z                      Write-Host "  - Cortana completely disabled" -ForegroundColor White
2026-01-11T19:28:12.2437865Z                      Write-Host "  - Cloud features disabled" -ForegroundColor White
2026-01-11T19:28:12.2438011Z                      Write-Host ""
2026-01-11T19:28:12.2439294Z                      Write-Host "To re-enable Windows Update (if needed):" -ForegroundColor Cyan
2026-01-11T19:28:12.2439708Z                      Write-Host "  Set-Service wuauserv -StartupType Manual" -ForegroundColor White
2026-01-11T19:28:12.2440317Z                      Write-Host "  Start-Service wuauserv" -ForegroundColor White
2026-01-11T19:28:12.2441133Z                      Write-Host ""
2026-01-11T19:28:12.2442323Z                      Write-Host "REBOOT recommended for all changes to take effect." -ForegroundColor Yellow
2026-01-11T19:28:12.2442476Z                      Write-Host ""
2026-01-11T19:28:12.2443273Z [32;1mCleanBlock         : [0m
2026-01-11T19:28:12.2443522Z [32;1mDynamicParamBlock  : [0m
2026-01-11T19:28:12.2444897Z [32;1mScriptRequirements : [0mSystem.Management.Automation.Language.ScriptRequirements
2026-01-11T19:28:12.2448001Z [32;1mExtent             : [0m<#
2026-01-11T19:28:12.2448126Z                      .SYNOPSIS
2026-01-11T19:28:12.2448517Z                          Applies aggressive privacy and anti-tracking hardening to Windows.
2026-01-11T19:28:12.2448629Z                      .DESCRIPTION
2026-01-11T19:28:12.2449439Z                          Disables Windows Update, telemetry services, location and cloud features,
2026-01-11T19:28:12.2449836Z                          Microsoft account integration, and other data collection paths. This is an
2026-01-11T19:28:12.2450200Z                          intentionally heavy-handed profile that may break features like Store apps,
2026-01-11T19:28:12.2450724Z                          Cortana, or cloud sync. Use only if you fully understand the tradeoffs.
2026-01-11T19:28:12.2451125Z                      .PARAMETER SkipConfirmations
2026-01-11T19:28:12.2452105Z                          Skips the interactive confirmation prompt.
2026-01-11T19:28:12.2452636Z                      .PARAMETER EnableFirewallRules
2026-01-11T19:28:12.2453874Z                          When set, adds outbound firewall rules to block known telemetry IPs.
2026-01-11T19:28:12.2454019Z                      .EXAMPLE
2026-01-11T19:28:12.2455071Z                          .\extreme-privacy.ps1
2026-01-11T19:28:12.2455835Z                      .EXAMPLE
2026-01-11T19:28:12.2456405Z                          .\extreme-privacy.ps1 -SkipConfirmations
2026-01-11T19:28:12.2457462Z                      .NOTES
2026-01-11T19:28:12.2458029Z                          Requires Administrator. Writes `extreme-privacy.log` in the current directory.
2026-01-11T19:28:12.2459315Z                          Many changes are registry- and service-based and may require a reboot.
2026-01-11T19:28:12.2459447Z                      #>
2026-01-11T19:28:12.2459714Z                      #Requires -RunAsAdministrator
2026-01-11T19:28:12.2460752Z                      
2026-01-11T19:28:12.2461563Z                      
2026-01-11T19:28:12.2462193Z                      
2026-01-11T19:28:12.2463049Z                      param(
2026-01-11T19:28:12.2463866Z                          [switch]$SkipConfirmations,
2026-01-11T19:28:12.2464645Z                          [switch]$EnableFirewallRules
2026-01-11T19:28:12.2465329Z                      )
2026-01-11T19:28:12.2466230Z                      
2026-01-11T19:28:12.2466640Z                      # Fail fast to avoid partial application when an error is encountered.
2026-01-11T19:28:12.2467728Z                      $ErrorActionPreference = "Stop"
2026-01-11T19:28:12.2468215Z                      $script:LogPath = ".\extreme-privacy.log"
2026-01-11T19:28:12.2469358Z                      
2026-01-11T19:28:12.2469580Z                      <#
2026-01-11T19:28:12.2470275Z                      .SYNOPSIS
2026-01-11T19:28:12.2471351Z                          Writes a structured log line to file and console.
2026-01-11T19:28:12.2472127Z                      .DESCRIPTION
2026-01-11T19:28:12.2473467Z                          Prepends timestamp and severity level, appends to the log file, and mirrors
2026-01-11T19:28:12.2473742Z                          the message to the console with a level-aware color.
2026-01-11T19:28:12.2474781Z                      .PARAMETER Message
2026-01-11T19:28:12.2475004Z                          Human-readable log text.
2026-01-11T19:28:12.2475915Z                      .PARAMETER Level
2026-01-11T19:28:12.2477389Z                          Severity marker: INFO, SUCCESS, or ERROR.
2026-01-11T19:28:12.2477497Z                      .OUTPUTS
2026-01-11T19:28:12.2477931Z                          None.
2026-01-11T19:28:12.2478828Z                      #>
2026-01-11T19:28:12.2480105Z                      # Progress tracking
2026-01-11T19:28:12.2480485Z                      $script:SectionIndex = 0
2026-01-11T19:28:12.2481678Z                      $script:SectionTotal = if ($EnableFirewallRules) { 24 } else { 23 }
2026-01-11T19:28:12.2482018Z                      
2026-01-11T19:28:12.2482974Z                      function Write-Log {
2026-01-11T19:28:12.2483898Z                          param([string]$Message, [string]$Level = "INFO")
2026-01-11T19:28:12.2484230Z                          $timestamp = Get-Date -Format "yyyy-MM-dd HH:mm:ss"
2026-01-11T19:28:12.2485424Z                          $logMessage = "[$timestamp] [$Level] $Message"
2026-01-11T19:28:12.2486035Z                      
2026-01-11T19:28:12.2486704Z                          try {
2026-01-11T19:28:12.2487802Z                              Add-Content -Path $script:LogPath -Value $logMessage -ErrorAction Stop
2026-01-11T19:28:12.2488829Z                          } catch {
2026-01-11T19:28:12.2489018Z                          }
2026-01-11T19:28:12.2489815Z                      
2026-01-11T19:28:12.2491378Z                          Write-Host $logMessage -ForegroundColor $(if ($Level -eq "ERROR") { "Red" } elseif ($Level 
2026-01-11T19:28:12.2491594Z                      -eq "SUCCESS") { "Green" } else { "White" })
2026-01-11T19:28:12.2492521Z                      }
2026-01-11T19:28:12.2493180Z                      
2026-01-11T19:28:12.2493994Z                      function Write-Section {
2026-01-11T19:28:12.2495004Z                          param([string]$Title)
2026-01-11T19:28:12.2495691Z                          $script:SectionIndex++
2026-01-11T19:28:12.2496931Z                          $pct = [math]::Min(100, [math]::Round(($script:SectionIndex / $script:SectionTotal) * 100))
2026-01-11T19:28:12.2498049Z                          Write-Progress -Activity "Extreme Privacy" -Status $Title -PercentComplete $pct 
2026-01-11T19:28:12.2498432Z                      -CurrentOperation "Step $($script:SectionIndex) of $($script:SectionTotal)"
2026-01-11T19:28:12.2499524Z                          Write-Log "=== $Title ==="
2026-01-11T19:28:12.2499648Z                      }
2026-01-11T19:28:12.2501286Z                      
2026-01-11T19:28:12.2501411Z                      <#
2026-01-11T19:28:12.2502284Z                      .SYNOPSIS
2026-01-11T19:28:12.2502803Z                          Sets a registry value, creating the key if needed.
2026-01-11T19:28:12.2503851Z                      .DESCRIPTION
2026-01-11T19:28:12.2504564Z                          Ensures the registry path exists, writes the requested value and type,
2026-01-11T19:28:12.2504928Z                          and logs success or failure.
2026-01-11T19:28:12.2506078Z                      .PARAMETER Path
2026-01-11T19:28:12.2506968Z                          Registry path (e.g., HKLM:\Software\...).
2026-01-11T19:28:12.2507097Z                      .PARAMETER Name
2026-01-11T19:28:12.2508621Z                          Registry value name.
2026-01-11T19:28:12.2508759Z                      .PARAMETER Value
2026-01-11T19:28:12.2509348Z                          Data to store at the registry value.
2026-01-11T19:28:12.2510585Z                      .PARAMETER Type
2026-01-11T19:28:12.2511568Z                          Registry value type (defaults to DWORD).
2026-01-11T19:28:12.2512668Z                      .OUTPUTS
2026-01-11T19:28:12.2512942Z                          [bool] True on success, false on failure.
2026-01-11T19:28:12.2513776Z                      #>
2026-01-11T19:28:12.2514693Z                      function Set-RegistryValue {
2026-01-11T19:28:12.2515527Z                          param(
2026-01-11T19:28:12.2517032Z                              [string]$Path,
2026-01-11T19:28:12.2517247Z                              [string]$Name,
2026-01-11T19:28:12.2518545Z                              [object]$Value,
2026-01-11T19:28:12.2519119Z                              [string]$Type = "DWORD"
2026-01-11T19:28:12.2520194Z                          )
2026-01-11T19:28:12.2520978Z                          try {
2026-01-11T19:28:12.2521835Z                              if (-not (Test-Path $Path)) {
2026-01-11T19:28:12.2522768Z                                  New-Item -Path $Path -Force | Out-Null
2026-01-11T19:28:12.2523541Z                              }
2026-01-11T19:28:12.2524993Z                              Set-ItemProperty -Path $Path -Name $Name -Value $Value -Type $Type -ErrorAction Stop
2026-01-11T19:28:12.2525262Z                              Write-Log "Set: $Path\$Name = $Value" "SUCCESS"
2026-01-11T19:28:12.2526236Z                              return $true
2026-01-11T19:28:12.2527458Z                          } catch {
2026-01-11T19:28:12.2528318Z                              Write-Log "Failed: $Path\$Name - $_" "ERROR"
2026-01-11T19:28:12.2528754Z                              return $false
2026-01-11T19:28:12.2529835Z                          }
2026-01-11T19:28:12.2530154Z                      }
2026-01-11T19:28:12.2531076Z                      
2026-01-11T19:28:12.2532209Z                      Write-Log "=== Extreme Privacy & Anti-Tracking Script Started ===" "SUCCESS"
2026-01-11T19:28:12.2532645Z                      Write-Host ""
2026-01-11T19:28:12.2533265Z                      Write-Host "=== EXTREME PRIVACY MODE ===" -ForegroundColor Red
2026-01-11T19:28:12.2533828Z                      Write-Host "This script applies AGGRESSIVE privacy hardening." -ForegroundColor Yellow
2026-01-11T19:28:12.2534425Z                      Write-Host "Some Windows features may break (Store, Cortana, etc.)" -ForegroundColor Yellow
2026-01-11T19:28:12.2535360Z                      Write-Host ""
2026-01-11T19:28:12.2536068Z                      
2026-01-11T19:28:12.2537196Z                      if (-not $SkipConfirmations) {
2026-01-11T19:28:12.2538052Z                          $confirm = Read-Host "Continue with extreme privacy mode? (Y/N)"
2026-01-11T19:28:12.2538580Z                          if ($confirm -ne "Y") {
2026-01-11T19:28:12.2539501Z                              Write-Log "Cancelled by user" "ERROR"
2026-01-11T19:28:12.2540528Z                              exit 0
2026-01-11T19:28:12.2540932Z                          }
2026-01-11T19:28:12.2541774Z                      }
2026-01-11T19:28:12.2542544Z                      
2026-01-11T19:28:12.2544662Z                      # Windows Update is disabled to prevent telemetry and background bandwidth usage.
2026-01-11T19:28:12.2544905Z                      Write-Section "Disabling Windows Update Completely"
2026-01-11T19:28:12.2545004Z                      try {
2026-01-11T19:28:12.2545298Z                          Stop-Service wuauserv -Force -ErrorAction SilentlyContinue
2026-01-11T19:28:12.2545491Z                          Set-Service wuauserv -StartupType Disabled
2026-01-11T19:28:12.2545580Z                      
2026-01-11T19:28:12.2547017Z                          Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU" -Name 
2026-01-11T19:28:12.2547213Z                      "NoAutoUpdate" -Value 1
2026-01-11T19:28:12.2548573Z                          Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU" -Name 
2026-01-11T19:28:12.2549499Z                      "AUOptions" -Value 2
2026-01-11T19:28:12.2550372Z                          Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU" -Name 
2026-01-11T19:28:12.2550977Z                      "AutoInstallMinorUpdates" -Value 0
2026-01-11T19:28:12.2552386Z                          Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU" -Name 
2026-01-11T19:28:12.2552645Z                      "NoAutoRebootWithLoggedOnUsers" -Value 1
2026-01-11T19:28:12.2553544Z                      
2026-01-11T19:28:12.2554243Z                          Stop-Service UsoSvc -Force -ErrorAction SilentlyContinue
2026-01-11T19:28:12.2555373Z                          Set-Service UsoSvc -StartupType Disabled -ErrorAction SilentlyContinue
2026-01-11T19:28:12.2556072Z                      
2026-01-11T19:28:12.2556378Z                          Write-Log "Windows Update completely disabled" "SUCCESS"
2026-01-11T19:28:12.2557183Z                      } catch {
2026-01-11T19:28:12.2558274Z                          Write-Log "Error disabling Windows Update: $_" "ERROR"
2026-01-11T19:28:12.2558931Z                      }
2026-01-11T19:28:12.2559963Z                      
2026-01-11T19:28:12.2560151Z                      
2026-01-11T19:28:12.2561228Z                      # Disable telemetry and diagnostic services that phone home.
2026-01-11T19:28:12.2562301Z                      Write-Section "Disabling All Telemetry Services"
2026-01-11T19:28:12.2562818Z                      $telemetryServices = @(
2026-01-11T19:28:12.2563934Z                          "DiagTrack",
2026-01-11T19:28:12.2564102Z                          "dmwappushservice",
2026-01-11T19:28:12.2565442Z                          "diagnosticshub.standardcollector.service",
2026-01-11T19:28:12.2565881Z                          "DPS",
2026-01-11T19:28:12.2567012Z                          "WdiSystemHost",
2026-01-11T19:28:12.2567194Z                          "WdiServiceHost",
2026-01-11T19:28:12.2568377Z                          "PcaSvc",
2026-01-11T19:28:12.2568745Z                          "WerSvc",
2026-01-11T19:28:12.2569899Z                          "Wecsvc",
2026-01-11T19:28:12.2570556Z                          "BDESVC",
2026-01-11T19:28:12.2571597Z                          "wercplsupport",
2026-01-11T19:28:12.2572063Z                          "RetailDemo"
2026-01-11T19:28:12.2573298Z                      )
2026-01-11T19:28:12.2573495Z                      
2026-01-11T19:28:12.2574700Z                      foreach ($svc in $telemetryServices) {
2026-01-11T19:28:12.2575351Z                          try {
2026-01-11T19:28:12.2575743Z                              $service = Get-Service -Name $svc -ErrorAction SilentlyContinue
2026-01-11T19:28:12.2577005Z                              if ($service) {
2026-01-11T19:28:12.2577239Z                                  Stop-Service $svc -Force -ErrorAction Stop
2026-01-11T19:28:12.2578495Z                                  Set-Service $svc -StartupType Disabled
2026-01-11T19:28:12.2578714Z                                  Write-Log "Disabled service: $svc" "SUCCESS"
2026-01-11T19:28:12.2579916Z                              }
2026-01-11T19:28:12.2580763Z                          } catch {
2026-01-11T19:28:12.2582037Z                              Write-Log "Could not disable $svc : $_" "ERROR"
2026-01-11T19:28:12.2582164Z                          }
2026-01-11T19:28:12.2582670Z                      }
2026-01-11T19:28:12.2583879Z                      
2026-01-11T19:28:12.2584643Z                      
2026-01-11T19:28:12.2586232Z                      # Disable telemetry scheduled task
2026-01-11T19:28:12.2586519Z                      Write-Section "Disabling Telemetry Scheduled Tasks"
2026-01-11T19:28:12.2587558Z                      $telemetryTasks = @(
2026-01-11T19:28:12.2588448Z                          "Microsoft\Windows\Autochk\Proxy",
2026-01-11T19:28:12.2589619Z                          "Microsoft\Windows\Customer Experience Improvement Program\Consolidator",
2026-01-11T19:28:12.2590036Z                          "Microsoft\Windows\Customer Experience Improvement Program\UsbCeip",
2026-01-11T19:28:12.2591317Z                          "Microsoft\Windows\DiskDiagnostic\Microsoft-Windows-DiskDiagnosticDataCollector",
2026-01-11T19:28:12.2591555Z                          "Microsoft\Windows\Feedback\Siuf\DmClient",
2026-01-11T19:28:12.2592747Z                          "Microsoft\Windows\Feedback\Siuf\DmClientOnScenarioDownload",
2026-01-11T19:28:12.2593102Z                          "Microsoft\Windows\Windows Error Reporting\QueueReporting",
2026-01-11T19:28:12.2594129Z                          "Microsoft\Windows\Application Experience\MareBackup",
2026-01-11T19:28:12.2594676Z                          "Microsoft\Windows\Application Experience\StartupAppTask",
2026-01-11T19:28:12.2595847Z                          "Microsoft\Windows\Application Experience\PcaPatchDbTask"
2026-01-11T19:28:12.2595980Z                      )
2026-01-11T19:28:12.2596408Z                      foreach ($task in $telemetryTasks) {
2026-01-11T19:28:12.2597126Z                          try {
2026-01-11T19:28:12.2598714Z                              Disable-ScheduledTask -TaskName $task -ErrorAction SilentlyContinue | Out-Null
2026-01-11T19:28:12.2598954Z                              Write-Log "Disabled scheduled task: $task" "SUCCESS"
2026-01-11T19:28:12.2599837Z                          } catch {
2026-01-11T19:28:12.2600815Z                              Write-Log "Could not disable task $task : $_" "ERROR"
2026-01-11T19:28:12.2601439Z                          }
2026-01-11T19:28:12.2602391Z                      }
2026-01-11T19:28:12.2603124Z                      
2026-01-11T19:28:12.2603901Z                      
2026-01-11T19:28:12.2605120Z                      # Disable Windows Copilot completely
2026-01-11T19:28:12.2606767Z                      Write-Section "Disabling Windows Copilot"
2026-01-11T19:28:12.2606931Z                      try {
2026-01-11T19:28:12.2607059Z                          # Policy keys
2026-01-11T19:28:12.2607557Z                          Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsCopilot" -Name 
2026-01-11T19:28:12.2608785Z                      "TurnOffWindowsCopilot" -Value 1
2026-01-11T19:28:12.2609254Z                          Set-RegistryValue -Path "HKCU:\Software\Policies\Microsoft\Windows\WindowsCopilot" -Name 
2026-01-11T19:28:12.2609428Z                      "TurnOffWindowsCopilot" -Value 1
2026-01-11T19:28:12.2610601Z                      
2026-01-11T19:28:12.2611622Z                          # UI visibility
2026-01-11T19:28:12.2612134Z                          Set-RegistryValue -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" 
2026-01-11T19:28:12.2612527Z                      -Name "ShowCopilotButton" -Value 0
2026-01-11T19:28:12.2613443Z                      
2026-01-11T19:28:12.2614128Z                          # Availability flags
2026-01-11T19:28:12.2615458Z                          Set-RegistryValue -Path "HKLM:\SOFTWARE\Microsoft\Windows\Shell\Copilot" -Name 
2026-01-11T19:28:12.2615900Z                      "IsCopilotAvailable" -Value 0
2026-01-11T19:28:12.2617296Z                          Set-RegistryValue -Path "HKLM:\SOFTWARE\Microsoft\Windows\Shell\Copilot" -Name 
2026-01-11T19:28:12.2617825Z                      "CopilotDisabledReason" -Value "IsEnabledForGeographicRegionFailed" -Type "String"
2026-01-11T19:28:12.2618498Z                          Set-RegistryValue -Path "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsCopilot" 
2026-01-11T19:28:12.2618962Z                      -Name "AllowCopilotRuntime" -Value 0
2026-01-11T19:28:12.2619773Z                      
2026-01-11T19:28:12.2620672Z                          # Shell extension blocking
2026-01-11T19:28:12.2621626Z                          Set-RegistryValue -Path "HKLM:\SOFTWARE\Microsoft\Windows\Shell Extensions\Blocked" -Name 
2026-01-11T19:28:12.2622199Z                      "{CB3B0003-8088-4EDE-8769-8B354AB2FF8C}" -Value "" -Type "String"
2026-01-11T19:28:12.2624071Z                          Set-RegistryValue -Path "HKLM:\SOFTWARE\Microsoft\Windows\Shell\Copilot\BingChat" -Name 
2026-01-11T19:28:12.2624249Z                      "IsUserEligible" -Value 0
2026-01-11T19:28:12.2624350Z                      
2026-01-11T19:28:12.2625238Z                          # Remove Copilot packages
2026-01-11T19:28:12.2627219Z                          Get-AppxPackage -AllUsers *Copilot* -ErrorAction SilentlyContinue | Remove-AppxPackage 
2026-01-11T19:28:12.2627420Z                      -AllUsers -ErrorAction SilentlyContinue
2026-01-11T19:28:12.2627905Z                          Get-AppxPackage -AllUsers Microsoft.MicrosoftOfficeHub -ErrorAction SilentlyContinue | 
2026-01-11T19:28:12.2628192Z                      Remove-AppxPackage -AllUsers -ErrorAction SilentlyContinue
2026-01-11T19:28:12.2628906Z                      
2026-01-11T19:28:12.2629471Z                          Write-Log "Copilot disabled and packages removed" "SUCCESS"
2026-01-11T19:28:12.2630337Z                      } catch {
2026-01-11T19:28:12.2631289Z                          Write-Log "Error disabling Copilot: $_" "ERROR"
2026-01-11T19:28:12.2632255Z                      }
2026-01-11T19:28:12.2632491Z                      
2026-01-11T19:28:12.2633102Z                      
2026-01-11T19:28:12.2634801Z                      # Disable location sensors and location-based permission stores.
2026-01-11T19:28:12.2634984Z                      Write-Section "Disabling Location Tracking"
2026-01-11T19:28:12.2636416Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\LocationAndSensors" -Name 
2026-01-11T19:28:12.2636572Z                      "DisableLocation" -Value 1
2026-01-11T19:28:12.2637402Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\LocationAndSensors" -Name 
2026-01-11T19:28:12.2637786Z                      "DisableWindowsLocationProvider" -Value 1
2026-01-11T19:28:12.2638782Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\LocationAndSensors" -Name 
2026-01-11T19:28:12.2638961Z                      "DisableLocationScripting" -Value 1
2026-01-11T19:28:12.2639104Z                      Set-RegistryValue -Path 
2026-01-11T19:28:12.2640117Z                      "HKCU:\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\location" 
2026-01-11T19:28:12.2640386Z                      -Name "Value" -Value "Deny" -Type "String"
2026-01-11T19:28:12.2640733Z                      
2026-01-11T19:28:12.2641721Z                      
2026-01-11T19:28:12.2642862Z                      # Block camera access for UWP/modern apps, keep microphone enabled for voice chat.
2026-01-11T19:28:12.2643109Z                      Write-Section "Hardening Camera Privacy"
2026-01-11T19:28:12.2645760Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy" -Name 
2026-01-11T19:28:12.2645940Z                      "LetAppsAccessCamera" -Value 2
2026-01-11T19:28:12.2646330Z                      Set-RegistryValue -Path 
2026-01-11T19:28:12.2646968Z                      "HKCU:\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\webcam" 
2026-01-11T19:28:12.2647183Z                      -Name "Value" -Value "Deny" -Type "String"
2026-01-11T19:28:12.2647578Z                      
2026-01-11T19:28:12.2648729Z                      
2026-01-11T19:28:12.2649242Z                      Write-Log "Camera blocked | Microphone enabled for gaming voice chat" "SUCCESS"
2026-01-11T19:28:12.2649756Z                      
2026-01-11T19:28:12.2650032Z                      
2026-01-11T19:28:12.2651228Z                      # Disable Windows Hello biometrics and PIN logon for domain usage.
2026-01-11T19:28:12.2651450Z                      Write-Section "Disabling Biometrics"
2026-01-11T19:28:12.2653113Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Biometrics" -Name "Enabled" -Value 0
2026-01-11T19:28:12.2653584Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\System" -Name 
2026-01-11T19:28:12.2653780Z                      "AllowDomainPINLogon" -Value 0
2026-01-11T19:28:12.2654573Z                      
2026-01-11T19:28:12.2655444Z                      
2026-01-11T19:28:12.2656656Z                      # Remove OneDrive background sync and shell integration.
2026-01-11T19:28:12.2656827Z                      Write-Section "Disabling OneDrive"
2026-01-11T19:28:12.2657993Z                      try {
2026-01-11T19:28:12.2658562Z                          taskkill /f /im OneDrive.exe 2>&1 | Out-Null
2026-01-11T19:28:12.2659492Z                      
2026-01-11T19:28:12.2660141Z                          if (Test-Path "$env:SystemRoot\System32\OneDriveSetup.exe") {
2026-01-11T19:28:12.2660676Z                              & "$env:SystemRoot\System32\OneDriveSetup.exe" /uninstall
2026-01-11T19:28:12.2660891Z                          }
2026-01-11T19:28:12.2662390Z                          if (Test-Path "$env:SystemRoot\SysWOW64\OneDriveSetup.exe") {
2026-01-11T19:28:12.2662653Z                              & "$env:SystemRoot\SysWOW64\OneDriveSetup.exe" /uninstall
2026-01-11T19:28:12.2663078Z                          }
2026-01-11T19:28:12.2664278Z                      
2026-01-11T19:28:12.2664974Z                          Set-RegistryValue -Path "HKCR:\CLSID\{018D5C66-4533-4307-9B53-224DE2ED1FE6}" -Name 
2026-01-11T19:28:12.2665245Z                      "System.IsPinnedToNameSpaceTree" -Value 0
2026-01-11T19:28:12.2666806Z                          Set-RegistryValue -Path "HKCR:\Wow6432Node\CLSID\{018D5C66-4533-4307-9B53-224DE2ED1FE6}" 
2026-01-11T19:28:12.2667639Z                      -Name "System.IsPinnedToNameSpaceTree" -Value 0
2026-01-11T19:28:12.2667765Z                      
2026-01-11T19:28:12.2668724Z                          Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\OneDrive" -Name 
2026-01-11T19:28:12.2669738Z                      "DisableFileSyncNGSC" -Value 1
2026-01-11T19:28:12.2671029Z                          Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\OneDrive" -Name 
2026-01-11T19:28:12.2671194Z                      "DisableFileSync" -Value 1
2026-01-11T19:28:12.2671287Z                      
2026-01-11T19:28:12.2673005Z                          Remove-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Run" -Name 
2026-01-11T19:28:12.2673191Z                      "OneDrive" -ErrorAction SilentlyContinue
2026-01-11T19:28:12.2673520Z                      
2026-01-11T19:28:12.2674624Z                          Write-Log "OneDrive disabled and uninstalled" "SUCCESS"
2026-01-11T19:28:12.2675308Z                      } catch {
2026-01-11T19:28:12.2676485Z                          Write-Log "Error disabling OneDrive: $_" "ERROR"
2026-01-11T19:28:12.2676603Z                      }
2026-01-11T19:28:12.2676956Z                      
2026-01-11T19:28:12.2678227Z                      
2026-01-11T19:28:12.2678611Z                      # Disable Windows settings sync to reduce cloud footprint.
2026-01-11T19:28:12.2680062Z                      Write-Section "Disabling Sync Settings"
2026-01-11T19:28:12.2680851Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\SettingSync" -Name 
2026-01-11T19:28:12.2681003Z                      "DisableSettingSync" -Value 2
2026-01-11T19:28:12.2682122Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\SettingSync" -Name 
2026-01-11T19:28:12.2682340Z                      "DisableSettingSyncUserOverride" -Value 1
2026-01-11T19:28:12.2683732Z                      Set-RegistryValue -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\SettingSync" -Name 
2026-01-11T19:28:12.2683869Z                      "SyncPolicy" -Value 5
2026-01-11T19:28:12.2684903Z                      Set-RegistryValue -Path 
2026-01-11T19:28:12.2687324Z                      "HKCU:\Software\Microsoft\Windows\CurrentVersion\SettingSync\Groups\Personalization" -Name 
2026-01-11T19:28:12.2687455Z                      "Enabled" -Value 0
2026-01-11T19:28:12.2687603Z                      Set-RegistryValue -Path 
2026-01-11T19:28:12.2688425Z                      "HKCU:\Software\Microsoft\Windows\CurrentVersion\SettingSync\Groups\BrowserSettings" -Name 
2026-01-11T19:28:12.2688936Z                      "Enabled" -Value 0
2026-01-11T19:28:12.2690027Z                      Set-RegistryValue -Path 
2026-01-11T19:28:12.2690719Z                      "HKCU:\Software\Microsoft\Windows\CurrentVersion\SettingSync\Groups\Credentials" -Name "Enabled" 
2026-01-11T19:28:12.2691326Z                      -Value 0
2026-01-11T19:28:12.2692379Z                      Set-RegistryValue -Path 
2026-01-11T19:28:12.2692859Z                      "HKCU:\Software\Microsoft\Windows\CurrentVersion\SettingSync\Groups\Language" -Name "Enabled" 
2026-01-11T19:28:12.2692989Z                      -Value 0
2026-01-11T19:28:12.2694489Z                      Set-RegistryValue -Path 
2026-01-11T19:28:12.2695152Z                      "HKCU:\Software\Microsoft\Windows\CurrentVersion\SettingSync\Groups\Accessibility" -Name 
2026-01-11T19:28:12.2695660Z                      "Enabled" -Value 0
2026-01-11T19:28:12.2696791Z                      Set-RegistryValue -Path 
2026-01-11T19:28:12.2697532Z                      "HKCU:\Software\Microsoft\Windows\CurrentVersion\SettingSync\Groups\Windows" -Name "Enabled" 
2026-01-11T19:28:12.2697996Z                      -Value 0
2026-01-11T19:28:12.2698723Z                      
2026-01-11T19:28:12.2699486Z                      
2026-01-11T19:28:12.2700489Z                      # Prevent Microsoft account sign-in integration (local account bias).
2026-01-11T19:28:12.2701303Z                      Write-Section "Disabling Microsoft Account Integration"
2026-01-11T19:28:12.2702909Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Microsoft\PolicyManager\current\device\Accounts" -Name 
2026-01-11T19:28:12.2703080Z                      "AllowMicrosoftAccountConnection" -Value 0
2026-01-11T19:28:12.2704305Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\MicrosoftAccount" -Name 
2026-01-11T19:28:12.2704844Z                      "DisableUserAuth" -Value 1
2026-01-11T19:28:12.2704993Z                      
2026-01-11T19:28:12.2705107Z                      
2026-01-11T19:28:12.2706209Z                      # Disable consumer cloud content delivery and spotlight suggestions.
2026-01-11T19:28:12.2706431Z                      Write-Section "Disabling Cloud Content"
2026-01-11T19:28:12.2707915Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\CloudContent" -Name 
2026-01-11T19:28:12.2708582Z                      "DisableWindowsConsumerFeatures" -Value 1
2026-01-11T19:28:12.2709301Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\CloudContent" -Name 
2026-01-11T19:28:12.2709999Z                      "DisableCloudOptimizedContent" -Value 1
2026-01-11T19:28:12.2711266Z                      Set-RegistryValue -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" 
2026-01-11T19:28:12.2711504Z                      -Name "ContentDeliveryAllowed" -Value 0
2026-01-11T19:28:12.2713194Z                      Set-RegistryValue -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" 
2026-01-11T19:28:12.2713460Z                      -Name "OemPreInstalledAppsEnabled" -Value 0
2026-01-11T19:28:12.2714795Z                      Set-RegistryValue -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" 
2026-01-11T19:28:12.2715001Z                      -Name "PreInstalledAppsEnabled" -Value 0
2026-01-11T19:28:12.2716828Z                      Set-RegistryValue -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" 
2026-01-11T19:28:12.2716977Z                      -Name "PreInstalledAppsEverEnabled" -Value 0
2026-01-11T19:28:12.2718253Z                      Set-RegistryValue -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" 
2026-01-11T19:28:12.2718896Z                      -Name "SilentInstalledAppsEnabled" -Value 0
2026-01-11T19:28:12.2719422Z                      Set-RegistryValue -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" 
2026-01-11T19:28:12.2719641Z                      -Name "SubscribedContent-338387Enabled" -Value 0
2026-01-11T19:28:12.2721069Z                      Set-RegistryValue -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" 
2026-01-11T19:28:12.2721308Z                      -Name "SubscribedContent-338388Enabled" -Value 0
2026-01-11T19:28:12.2721889Z                      Set-RegistryValue -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" 
2026-01-11T19:28:12.2722122Z                      -Name "SubscribedContent-338389Enabled" -Value 0
2026-01-11T19:28:12.2723713Z                      Set-RegistryValue -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" 
2026-01-11T19:28:12.2723942Z                      -Name "SubscribedContent-353698Enabled" -Value 0
2026-01-11T19:28:12.2725651Z                      Set-RegistryValue -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" 
2026-01-11T19:28:12.2726212Z                      -Name "SystemPaneSuggestionsEnabled" -Value 0
2026-01-11T19:28:12.2726533Z                      
2026-01-11T19:28:12.2726663Z                      
2026-01-11T19:28:12.2727291Z                      # Stop app suggestions and sync provider notifications.
2026-01-11T19:28:12.2727650Z                      Write-Section "Disabling App Suggestions"
2026-01-11T19:28:12.2729708Z                      Set-RegistryValue -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" 
2026-01-11T19:28:12.2729900Z                      -Name "SoftLandingEnabled" -Value 0
2026-01-11T19:28:12.2730674Z                      Set-RegistryValue -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -Name 
2026-01-11T19:28:12.2731258Z                      "ShowSyncProviderNotifications" -Value 0
2026-01-11T19:28:12.2732016Z                      
2026-01-11T19:28:12.2733054Z                      
2026-01-11T19:28:12.2733345Z                      # Disable typing/ink data collection used for personalization.
2026-01-11T19:28:12.2734541Z                      Write-Section "Disabling Typing Data Collection"
2026-01-11T19:28:12.2736172Z                      Set-RegistryValue -Path "HKCU:\Software\Microsoft\InputPersonalization" -Name 
2026-01-11T19:28:12.2736390Z                      "RestrictImplicitInkCollection" -Value 1
2026-01-11T19:28:12.2737540Z                      Set-RegistryValue -Path "HKCU:\Software\Microsoft\InputPersonalization" -Name 
2026-01-11T19:28:12.2737763Z                      "RestrictImplicitTextCollection" -Value 1
2026-01-11T19:28:12.2738506Z                      Set-RegistryValue -Path "HKCU:\Software\Microsoft\InputPersonalization\TrainedDataStore" -Name 
2026-01-11T19:28:12.2738699Z                      "HarvestContacts" -Value 0
2026-01-11T19:28:12.2740794Z                      Set-RegistryValue -Path "HKCU:\Software\Microsoft\Personalization\Settings" -Name 
2026-01-11T19:28:12.2740916Z                      "AcceptedPrivacyPolicy" -Value 0
2026-01-11T19:28:12.2741346Z                      
2026-01-11T19:28:12.2742173Z                      
2026-01-11T19:28:12.2742459Z                      # Block handwriting data sharing.
2026-01-11T19:28:12.2743492Z                      Write-Section "Disabling Handwriting Data Collection"
2026-01-11T19:28:12.2744963Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\TabletPC" -Name 
2026-01-11T19:28:12.2745187Z                      "PreventHandwritingDataSharing" -Value 1
2026-01-11T19:28:12.2746778Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\HandwritingErrorReports" -Name 
2026-01-11T19:28:12.2747018Z                      "PreventHandwritingErrorReports" -Value 1
2026-01-11T19:28:12.2747357Z                      
2026-01-11T19:28:12.2748071Z                      
2026-01-11T19:28:12.2749347Z                      # Disable Microsoft experimentation/feature rollouts (A/B testing).
2026-01-11T19:28:12.2749630Z                      Write-Section "Disabling Microsoft Experimentation"
2026-01-11T19:28:12.2751003Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Microsoft\PolicyManager\current\device\System" -Name 
2026-01-11T19:28:12.2751209Z                      "AllowExperimentation" -Value 0
2026-01-11T19:28:12.2752626Z                      Set-RegistryValue -Path 
2026-01-11T19:28:12.2753151Z                      "HKLM:\SOFTWARE\Microsoft\PolicyManager\default\System\AllowExperimentation" -Name "value" -Value 
2026-01-11T19:28:12.2753255Z                      0
2026-01-11T19:28:12.2754336Z                      
2026-01-11T19:28:12.2754440Z                      
2026-01-11T19:28:12.2755796Z                      # Deny UWP app access to account data and identity info.
2026-01-11T19:28:12.2756292Z                      Write-Section "Disabling App Access to Account Info"
2026-01-11T19:28:12.2757785Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\C
2026-01-11T19:28:12.2758101Z                      onsentStore\userAccountInformation" -Name "Value" -Value "Deny" -Type "String"
2026-01-11T19:28:12.2759678Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy" -Name 
2026-01-11T19:28:12.2759864Z                      "LetAppsAccessAccountInfo" -Value 2
2026-01-11T19:28:12.2760255Z                      
2026-01-11T19:28:12.2760785Z                      
2026-01-11T19:28:12.2762028Z                      # Deny app access to contacts and PIM data sources.
2026-01-11T19:28:12.2762641Z                      Write-Section "Disabling App Access to Contacts"
2026-01-11T19:28:12.2764184Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy" -Name 
2026-01-11T19:28:12.2764400Z                      "LetAppsAccessContacts" -Value 2
2026-01-11T19:28:12.2764476Z                      
2026-01-11T19:28:12.2765674Z                      
2026-01-11T19:28:12.2766455Z                      # Deny app access to calendar entries.
2026-01-11T19:28:12.2767309Z                      Write-Section "Disabling App Access to Calendar"
2026-01-11T19:28:12.2768558Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy" -Name 
2026-01-11T19:28:12.2769047Z                      "LetAppsAccessCalendar" -Value 2
2026-01-11T19:28:12.2769211Z                      
2026-01-11T19:28:12.2769828Z                      
2026-01-11T19:28:12.2771009Z                      # Deny app access to call history logs.
2026-01-11T19:28:12.2771480Z                      Write-Section "Disabling App Access to Call History"
2026-01-11T19:28:12.2772176Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy" -Name 
2026-01-11T19:28:12.2773165Z                      "LetAppsAccessCallHistory" -Value 2
2026-01-11T19:28:12.2773716Z                      
2026-01-11T19:28:12.2774450Z                      
2026-01-11T19:28:12.2775276Z                      # Deny app access to email data.
2026-01-11T19:28:12.2776138Z                      Write-Section "Disabling App Access to Email"
2026-01-11T19:28:12.2777315Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy" -Name 
2026-01-11T19:28:12.2777608Z                      "LetAppsAccessEmail" -Value 2
2026-01-11T19:28:12.2777991Z                      
2026-01-11T19:28:12.2778764Z                      
2026-01-11T19:28:12.2780158Z                      # Deny app access to notifications history.
2026-01-11T19:28:12.2780496Z                      Write-Section "Disabling App Access to Notifications"
2026-01-11T19:28:12.2781611Z                      Set-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy" -Name 
2026-01-11T19:28:12.2781813Z                      "LetAppsAccessNotifications" -Value 2
2026-01-11T19:28:12.2782125Z                      
2026-01-11T19:28:12.2783370Z                      
2026-01-11T19:28:12.2784191Z                      # Prevent automatic map package downloads.
2026-01-11T19:28:12.2784454Z                      Write-Section "Disabling Maps Auto-Update"
2026-01-11T19:28:12.2785487Z                      Set-RegistryValue -Path "HKLM:\SYSTEM\Maps" -Name "AutoUpdateEnabled" -Value 0
2026-01-11T19:28:12.2785769Z                      
2026-01-11T19:28:12.2786204Z                      
2026-01-11T19:28:12.2787091Z                      # Adds telemetry domains to hosts file; requires ownership/ACL changes.
2026-01-11T19:28:12.2787490Z                      Write-Section "Advanced Hosts File Telemetry Blocking"
2026-01-11T19:28:12.2787858Z                      try {
2026-01-11T19:28:12.2789289Z                          $hostsFile = "$env:SystemRoot\System32\drivers\etc\hosts"
2026-01-11T19:28:12.2789426Z                      
2026-01-11T19:28:12.2790844Z                          # Ownership and permissions are required for hardened builds or customized ACLs.
2026-01-11T19:28:12.2791198Z                          Write-Log "Taking ownership of hosts file (required for X-Lite builds)..."
2026-01-11T19:28:12.2791297Z                      
2026-01-11T19:28:12.2792008Z                          $takeownResult = takeown.exe /F $hostsFile /A 2>&1
2026-01-11T19:28:12.2792182Z                          if ($LASTEXITCODE -eq 0) {
2026-01-11T19:28:12.2793637Z                              Write-Log "Successfully took ownership of hosts file" "SUCCESS"
2026-01-11T19:28:12.2793896Z                          } else {
2026-01-11T19:28:12.2794727Z                              Write-Log "Takeown result: $takeownResult" "ERROR"
2026-01-11T19:28:12.2795494Z                          }
2026-01-11T19:28:12.2796264Z                      
2026-01-11T19:28:12.2797641Z                          $icaclsResult = icacls.exe $hostsFile /grant "Administrators:F" 2>&1
2026-01-11T19:28:12.2797798Z                          if ($LASTEXITCODE -eq 0) {
2026-01-11T19:28:12.2798946Z                              Write-Log "Successfully granted full permissions to Administrators" "SUCCESS"
2026-01-11T19:28:12.2799096Z                          } else {
2026-01-11T19:28:12.2800049Z                              Write-Log "Icacls result: $icaclsResult" "ERROR"
2026-01-11T19:28:12.2800491Z                          }
2026-01-11T19:28:12.2801301Z                      
2026-01-11T19:28:12.2802446Z                          $currentUser = [System.Security.Principal.WindowsIdentity]::GetCurrent().Name
2026-01-11T19:28:12.2803008Z                          icacls.exe $hostsFile /grant "${currentUser}:F" 2>&1 | Out-Null
2026-01-11T19:28:12.2804111Z                      
2026-01-11T19:28:12.2804773Z                          # DNS Client can keep the hosts file locked; stop it temporarily if running.
2026-01-11T19:28:12.2805477Z                          Write-Log "Stopping DNS Client service to unlock hosts file..."
2026-01-11T19:28:12.2805814Z                          $dnsService = Get-Service -Name "Dnscache" -ErrorAction SilentlyContinue
2026-01-11T19:28:12.2805904Z                          $dnsWasRunning = $false
2026-01-11T19:28:12.2806509Z                      
2026-01-11T19:28:12.2807010Z                          if ($dnsService) {
2026-01-11T19:28:12.2807940Z                              if ($dnsService.Status -eq "Running") {
2026-01-11T19:28:12.2808681Z                                  try {
2026-01-11T19:28:12.2809945Z                                      # Try using sc.exe as alternative (works better on X-Lite builds)
2026-01-11T19:28:12.2810155Z                                      $stopResult = sc.exe stop "Dnscache" 2>&1
2026-01-11T19:28:12.2810380Z                                      if ($LASTEXITCODE -eq 0) {
2026-01-11T19:28:12.2812272Z                                          $dnsWasRunning = $true
2026-01-11T19:28:12.2812536Z                                          Write-Log "DNS Client service stopped" "SUCCESS"
2026-01-11T19:28:12.2812843Z                                          Start-Sleep -Seconds 3
2026-01-11T19:28:12.2813610Z                                      } else {
2026-01-11T19:28:12.2814853Z                                          Write-Log "DNS Client service could not be stopped (X-Lite build 
2026-01-11T19:28:12.2815067Z                      restrictions)" "ERROR"
2026-01-11T19:28:12.2816604Z                                          Write-Log "Continuing with ownership/permissions changes..." "SUCCESS"
2026-01-11T19:28:12.2825862Z                                      }
2026-01-11T19:28:12.2826052Z                                  } catch {
2026-01-11T19:28:12.2826579Z                                      Write-Log "DNS Client service stop failed: $_" "ERROR"
2026-01-11T19:28:12.2826982Z                                      Write-Log "Continuing with ownership/permissions changes..." "SUCCESS"
2026-01-11T19:28:12.2827099Z                                  }
2026-01-11T19:28:12.2827229Z                              } else {
2026-01-11T19:28:12.2827470Z                                  Write-Log "DNS Client service is not running" "SUCCESS"
2026-01-11T19:28:12.2827565Z                              }
2026-01-11T19:28:12.2827671Z                          } else {
2026-01-11T19:28:12.2828136Z                              Write-Log "DNS Client service not found (disabled on X-Lite builds)" "SUCCESS"
2026-01-11T19:28:12.2828477Z                          }
2026-01-11T19:28:12.2828588Z                      
2026-01-11T19:28:12.2828714Z                          try {
2026-01-11T19:28:12.2829191Z                              $backupPath = "$hostsFile.backup-$(Get-Date -Format 'yyyyMMdd-HHmmss')"
2026-01-11T19:28:12.2829320Z                      
2026-01-11T19:28:12.2829532Z                              $hostsBytes = [System.IO.File]::ReadAllBytes($hostsFile)
2026-01-11T19:28:12.2829845Z                              [System.IO.File]::WriteAllBytes($backupPath, $hostsBytes)
2026-01-11T19:28:12.2830111Z                              Write-Log "Backed up hosts file to: $backupPath" "SUCCESS"
2026-01-11T19:28:12.2830221Z                      
2026-01-11T19:28:12.2830478Z                              # Curated list of telemetry/ads endpoints to null-route.
2026-01-11T19:28:12.2830628Z                              $telemetryDomains = @(
2026-01-11T19:28:12.2830810Z                                  "vortex.data.microsoft.com",
2026-01-11T19:28:12.2831009Z                                  "vortex-win.data.microsoft.com",
2026-01-11T19:28:12.2831231Z                                  "telecommand.telemetry.microsoft.com",
2026-01-11T19:28:12.2831875Z                                  "telecommand.telemetry.microsoft.com.nsatc.net",
2026-01-11T19:28:12.2832258Z                                  "oca.telemetry.microsoft.com",
2026-01-11T19:28:12.2833451Z                                  "oca.telemetry.microsoft.com.nsatc.net",
2026-01-11T19:28:12.2833891Z                                  "sqm.telemetry.microsoft.com",
2026-01-11T19:28:12.2834874Z                                  "sqm.telemetry.microsoft.com.nsatc.net",
2026-01-11T19:28:12.2835320Z                                  "watson.telemetry.microsoft.com",
2026-01-11T19:28:12.2836497Z                                  "watson.telemetry.microsoft.com.nsatc.net",
2026-01-11T19:28:12.2837153Z                                  "redir.metaservices.microsoft.com",
2026-01-11T19:28:12.2837685Z                                  "choice.microsoft.com",
2026-01-11T19:28:12.2838803Z                                  "choice.microsoft.com.nsatc.net",
2026-01-11T19:28:12.2839240Z                                  "df.telemetry.microsoft.com",
2026-01-11T19:28:12.2840333Z                                  "reports.wes.df.telemetry.microsoft.com",
2026-01-11T19:28:12.2840875Z                                  "wes.df.telemetry.microsoft.com",
2026-01-11T19:28:12.2841910Z                                  "services.wes.df.telemetry.microsoft.com",
2026-01-11T19:28:12.2842473Z                                  "sqm.df.telemetry.microsoft.com",
2026-01-11T19:28:12.2843250Z                                  "telemetry.microsoft.com",
2026-01-11T19:28:12.2844215Z                                  "telemetry.appex.bing.net",
2026-01-11T19:28:12.2845065Z                                  "telemetry.urs.microsoft.com",
2026-01-11T19:28:12.2846112Z                                  "telemetry.appex.bing.net:443",
2026-01-11T19:28:12.2847223Z                                  "settings-sandbox.data.microsoft.com",
2026-01-11T19:28:12.2847788Z                                  "vortex-sandbox.data.microsoft.com",
2026-01-11T19:28:12.2848859Z                                  "survey.watson.microsoft.com",
2026-01-11T19:28:12.2849828Z                                  "watson.live.com",
2026-01-11T19:28:12.2850052Z                                  "watson.microsoft.com",
2026-01-11T19:28:12.2850513Z                                  "statsfe2.ws.microsoft.com",
2026-01-11T19:28:12.2851091Z                                  "corpext.msitadfs.glbdns2.microsoft.com",
2026-01-11T19:28:12.2852055Z                                  "compatexchange.cloudapp.net",
2026-01-11T19:28:12.2853326Z                                  "cs1.wpc.v0cdn.net",
2026-01-11T19:28:12.2853973Z                                  "a-0001.a-msedge.net",
2026-01-11T19:28:12.2855013Z                                  "statsfe2.update.microsoft.com.akadns.net",
2026-01-11T19:28:12.2855497Z                                  "sls.update.microsoft.com.akadns.net",
2026-01-11T19:28:12.2856495Z                                  "fe2.update.microsoft.com.akadns.net",
2026-01-11T19:28:12.2857179Z                                  "diagnostics.support.microsoft.com",
2026-01-11T19:28:12.2857382Z                                  "corp.sts.microsoft.com",
2026-01-11T19:28:12.2858552Z                                  "statsfe1.ws.microsoft.com",
2026-01-11T19:28:12.2859110Z                                  "pre.footprintpredict.com",
2026-01-11T19:28:12.2859414Z                                  "i1.services.social.microsoft.com",
2026-01-11T19:28:12.2859912Z                                  "i1.services.social.microsoft.com.nsatc.net",
2026-01-11T19:28:12.2861091Z                                  "feedback.windows.com",
2026-01-11T19:28:12.2861317Z                                  "feedback.microsoft-hohm.com",
2026-01-11T19:28:12.2862165Z                                  "feedback.search.microsoft.com",
2026-01-11T19:28:12.2863420Z                                  "fe3.delivery.dsp.mp.microsoft.com.nsatc.net",
2026-01-11T19:28:12.2863692Z                                  "tlu.dl.delivery.mp.microsoft.com",
2026-01-11T19:28:12.2865057Z                                  "ads.msn.com",
2026-01-11T19:28:12.2865350Z                                  "ads1.msn.com",
2026-01-11T19:28:12.2866547Z                                  "ads2.msn.com",
2026-01-11T19:28:12.2867278Z                                  "bingads.microsoft.com",
2026-01-11T19:28:12.2868427Z                                  "rad.msn.com",
2026-01-11T19:28:12.2868907Z                                  "flex.msn.com"
2026-01-11T19:28:12.2870001Z                              )
2026-01-11T19:28:12.2870113Z                      
2026-01-11T19:28:12.2871278Z                              $hostsContentRaw = [System.IO.File]::ReadAllText($hostsFile)
2026-01-11T19:28:12.2871906Z                              $hostsContent = $hostsContentRaw -split "`r?`n"
2026-01-11T19:28:12.2872712Z                              $newEntries = @()
2026-01-11T19:28:12.2873068Z                      
2026-01-11T19:28:12.2874232Z                              foreach ($domain in $telemetryDomains) {
2026-01-11T19:28:12.2874365Z                                  $entry = "0.0.0.0 $domain"
2026-01-11T19:28:12.2875562Z                                  if ($hostsContent -notcontains $entry) {
2026-01-11T19:28:12.2875718Z                                      $newEntries += $entry
2026-01-11T19:28:12.2876521Z                                  }
2026-01-11T19:28:12.2877343Z                              }
2026-01-11T19:28:12.2878141Z                      
2026-01-11T19:28:12.2879155Z                              if ($newEntries.Count -gt 0) {
2026-01-11T19:28:12.2879806Z                                  $newContent = $hostsContentRaw
2026-01-11T19:28:12.2880030Z                                  if (-not $hostsContentRaw.EndsWith("`n")) {
2026-01-11T19:28:12.2881106Z                                      $newContent += "`r`n"
2026-01-11T19:28:12.2881947Z                                  }
2026-01-11T19:28:12.2883437Z                                  $newContent += "`r`n# Extreme Privacy - Microsoft Telemetry Blocking ($(Get-Date 
2026-01-11T19:28:12.2883607Z                      -Format 'yyyy-MM-dd'))`r`n"
2026-01-11T19:28:12.2883791Z                                  $newContent += ($newEntries -join "`r`n")
2026-01-11T19:28:12.2884159Z                                  $newContent += "`r`n"
2026-01-11T19:28:12.2885375Z                      
2026-01-11T19:28:12.2885676Z                                  # Preserve UTF-8 without BOM to avoid compatibility issues.
2026-01-11T19:28:12.2886414Z                                  $utf8NoBom = New-Object System.Text.UTF8Encoding $false
2026-01-11T19:28:12.2887788Z                                  [System.IO.File]::WriteAllText($hostsFile, $newContent, $utf8NoBom)
2026-01-11T19:28:12.2888092Z                      
2026-01-11T19:28:12.2888566Z                                  Write-Log "Added $($newEntries.Count) telemetry domains to hosts file" "SUCCESS"
2026-01-11T19:28:12.2889455Z                              } else {
2026-01-11T19:28:12.2890342Z                                  Write-Log "All telemetry domains already blocked in hosts file" "SUCCESS"
2026-01-11T19:28:12.2890680Z                              }
2026-01-11T19:28:12.2891484Z                      
2026-01-11T19:28:12.2892421Z                          } finally {
2026-01-11T19:28:12.2892657Z                              if ($dnsWasRunning) {
2026-01-11T19:28:12.2893790Z                                  try {
2026-01-11T19:28:12.2894300Z                                      $startResult = sc.exe start "Dnscache" 2>&1
2026-01-11T19:28:12.2895421Z                                      if ($LASTEXITCODE -eq 0) {
2026-01-11T19:28:12.2896029Z                                          Write-Log "DNS Client service restarted" "SUCCESS"
2026-01-11T19:28:12.2896182Z                                      } else {
2026-01-11T19:28:12.2897202Z                                          Start-Service -Name "Dnscache" -ErrorAction SilentlyContinue
2026-01-11T19:28:12.2897762Z                                          Write-Log "DNS Client service restarted" "SUCCESS"
2026-01-11T19:28:12.2898931Z                                      }
2026-01-11T19:28:12.2899124Z                                  } catch {
2026-01-11T19:28:12.2901905Z                                      Write-Log "DNS Client service could not be restarted (may require manual 
2026-01-11T19:28:12.2901999Z                      restart)" "ERROR"
2026-01-11T19:28:12.6424450Z                                  }
2026-01-11T19:28:12.6425275Z                      
2026-01-11T19:28:12.6426429Z                                  try {
2026-01-11T19:28:12.6426924Z                                      ipconfig /flushdns | Out-Null
2026-01-11T19:28:12.6427764Z                                      Write-Log "DNS cache flushed" "SUCCESS"
2026-01-11T19:28:12.6428300Z                                  } catch {
2026-01-11T19:28:12.6429045Z                                      Write-Log "Could not flush DNS cache" "ERROR"
2026-01-11T19:28:12.6430374Z                                  }
2026-01-11T19:28:12.6431038Z                              }
2026-01-11T19:28:12.6431978Z                          }
2026-01-11T19:28:12.6432897Z                      
2026-01-11T19:28:12.6433925Z                      } catch {
2026-01-11T19:28:12.6434933Z                          Write-Log "Error modifying hosts file: $_" "ERROR"
2026-01-11T19:28:12.6436496Z                      }
2026-01-11T19:28:12.6437623Z                      
2026-01-11T19:28:12.6438760Z                      
2026-01-11T19:28:12.6439924Z                      if ($EnableFirewallRules) {
2026-01-11T19:28:12.6441285Z                          # Optional: outbound firewall rules for known telemetry IPs.
2026-01-11T19:28:12.6443288Z                          Write-Section "Creating Firewall Rules to Block Telemetry"
2026-01-11T19:28:12.6443870Z                          try {
2026-01-11T19:28:12.6444549Z                              $telemetryIPs = @(
2026-01-11T19:28:12.6445269Z                                  "134.170.30.202",
2026-01-11T19:28:12.6445717Z                                  "137.116.81.24",
2026-01-11T19:28:12.6446149Z                                  "157.56.106.189",
2026-01-11T19:28:12.6446549Z                                  "184.86.53.99",
2026-01-11T19:28:12.6447034Z                                  "2.22.61.43",
2026-01-11T19:28:12.6447600Z                                  "2.22.61.66",
2026-01-11T19:28:12.6448063Z                                  "204.79.197.200",
2026-01-11T19:28:12.6448700Z                                  "23.218.212.69",
2026-01-11T19:28:12.6449402Z                                  "65.39.117.230",
2026-01-11T19:28:12.6450322Z                                  "65.52.108.33",
2026-01-11T19:28:12.6451251Z                                  "65.55.108.23"
2026-01-11T19:28:12.6452064Z                              )
2026-01-11T19:28:12.6452407Z                      
2026-01-11T19:28:12.6452796Z                              foreach ($ip in $telemetryIPs) {
2026-01-11T19:28:12.6453503Z                                  $ruleName = "Block Telemetry IP $ip"
2026-01-11T19:28:12.6454367Z                                  if (-not (Get-NetFirewallRule -DisplayName $ruleName -ErrorAction SilentlyContinue)) {
2026-01-11T19:28:12.6455503Z                                      New-NetFirewallRule -DisplayName $ruleName -Direction Outbound -RemoteAddress $ip 
2026-01-11T19:28:12.6456915Z                      -Action Block -ErrorAction SilentlyContinue | Out-Null
2026-01-11T19:28:12.6457865Z                                      Write-Log "Created firewall rule: $ruleName" "SUCCESS"
2026-01-11T19:28:12.6458461Z                                  }
2026-01-11T19:28:12.6458792Z                              }
2026-01-11T19:28:12.6459128Z                      
2026-01-11T19:28:12.6459640Z                              Write-Log "Firewall rules created to block telemetry IPs" "SUCCESS"
2026-01-11T19:28:12.6460582Z                          } catch {
2026-01-11T19:28:12.6461036Z                              Write-Log "Error creating firewall rules: $_" "ERROR"
2026-01-11T19:28:12.6461546Z                          }
2026-01-11T19:28:12.6461846Z                      }
2026-01-11T19:28:12.6462104Z                      
2026-01-11T19:28:12.6462360Z                      
2026-01-11T19:28:12.6462780Z                      Write-Progress -Activity "Extreme Privacy" -Completed
2026-01-11T19:28:12.6463471Z                      Write-Log "=== Extreme Privacy Script Completed ===" "SUCCESS"
2026-01-11T19:28:12.6464032Z                      Write-Host ""
2026-01-11T19:28:12.6464576Z                      Write-Host "=== EXTREME PRIVACY APPLIED ===" -ForegroundColor Green
2026-01-11T19:28:12.6465175Z                      Write-Host ""
2026-01-11T19:28:12.6465849Z                      Write-Host "WARNING: Some Windows features are now disabled:" -ForegroundColor Yellow
2026-01-11T19:28:12.6467793Z                      Write-Host "  - Windows Update (disabled completely)" -ForegroundColor White
2026-01-11T19:28:12.6469212Z                      Write-Host "  - OneDrive (uninstalled)" -ForegroundColor White
2026-01-11T19:28:12.6469947Z                      Write-Host "  - Microsoft Account sync" -ForegroundColor White
2026-01-11T19:28:12.6472018Z                      Write-Host "  - Store auto-updates may be affected" -ForegroundColor White
2026-01-11T19:28:12.6473563Z                      Write-Host "  - Cortana completely disabled" -ForegroundColor White
2026-01-11T19:28:12.6474835Z                      Write-Host "  - Cloud features disabled" -ForegroundColor White
2026-01-11T19:28:12.6476007Z                      Write-Host ""
2026-01-11T19:28:12.6476936Z                      Write-Host "To re-enable Windows Update (if needed):" -ForegroundColor Cyan
2026-01-11T19:28:12.6477917Z                      Write-Host "  Set-Service wuauserv -StartupType Manual" -ForegroundColor White
2026-01-11T19:28:12.6478959Z                      Write-Host "  Start-Service wuauserv" -ForegroundColor White
2026-01-11T19:28:12.6479711Z                      Write-Host ""
2026-01-11T19:28:12.6480383Z                      Write-Host "REBOOT recommended for all changes to take effect." -ForegroundColor Yellow
2026-01-11T19:28:12.6481174Z                      Write-Host ""
2026-01-11T19:28:12.6481459Z                      
2026-01-11T19:28:12.6481875Z [32;1mParent             : [0m
2026-01-11T19:28:12.6482018Z 
2026-01-11T19:28:12.6514993Z [32;1mAttributes         : [0m{}
2026-01-11T19:28:12.6515948Z [32;1mUsingStatements    : [0m{}
2026-01-11T19:28:12.6516515Z [32;1mParamBlock         : [0mparam(
2026-01-11T19:28:12.6517250Z                          [switch]$DryRun,
2026-01-11T19:28:12.6518157Z                          [switch]$SkipConfirmation,
2026-01-11T19:28:12.6518665Z                          [string]$ConfigFile,
2026-01-11T19:28:12.6519124Z                          [string]$Profile
2026-01-11T19:28:12.6519491Z                      )
2026-01-11T19:28:12.6519799Z [32;1mBeginBlock         : [0m
2026-01-11T19:28:12.6520104Z [32;1mProcessBlock       : [0m
2026-01-11T19:28:12.6521597Z [32;1mEndBlock           : [0mparam(
2026-01-11T19:28:12.6522128Z                          [switch]$DryRun,
2026-01-11T19:28:12.6522596Z                          [switch]$SkipConfirmation,
2026-01-11T19:28:12.6523155Z                          [string]$ConfigFile,
2026-01-11T19:28:12.6523952Z                          [string]$Profile
2026-01-11T19:28:12.6524680Z                      )
2026-01-11T19:28:12.6526022Z                      
2026-01-11T19:28:12.6526297Z                      
2026-01-11T19:28:12.6527853Z                      # Resolve script root even when invoked from a different working directory.
2026-01-11T19:28:12.6528982Z                      $ScriptRoot = $PSScriptRoot
2026-01-11T19:28:12.6529482Z                      if (-not $ScriptRoot) {
2026-01-11T19:28:12.6530755Z                          $ScriptRoot = Split-Path -Parent $MyInvocation.MyCommand.Path
2026-01-11T19:28:12.6531620Z                      }
2026-01-11T19:28:12.6531910Z                      
2026-01-11T19:28:12.6532175Z                      Write-Host ""
2026-01-11T19:28:12.6532692Z                      Write-Host "=== Gaming PC Setup (Modular) ===" -ForegroundColor Cyan
2026-01-11T19:28:12.6533541Z                      Write-Host "Evidence-based Windows optimizations for gaming" -ForegroundColor Yellow
2026-01-11T19:28:12.6534060Z                      Write-Host ""
2026-01-11T19:28:12.6534402Z                      
2026-01-11T19:28:12.6534665Z                      if ($DryRun) {
2026-01-11T19:28:12.6535235Z                          Write-Host "DRY RUN MODE: No changes will be applied" -ForegroundColor Yellow
2026-01-11T19:28:12.6535883Z                          Write-Host ""
2026-01-11T19:28:12.6536183Z                      }
2026-01-11T19:28:12.6536546Z                      
2026-01-11T19:28:12.6537910Z                      
2026-01-11T19:28:12.6538398Z                      
2026-01-11T19:28:12.6538797Z                      Write-Host "Loading modules..." -ForegroundColor Cyan
2026-01-11T19:28:12.6539269Z                      
2026-01-11T19:28:12.6539905Z                      # Core infrastructure for logging, registry helpers, config, and menus.
2026-01-11T19:28:12.6540679Z                      Import-Module (Join-Path $ScriptRoot "modules\core\logger.psm1") -Force -Global
2026-01-11T19:28:12.6541610Z                      Import-Module (Join-Path $ScriptRoot "modules\core\registry.psm1") -Force -Global
2026-01-11T19:28:12.6542365Z                      Import-Module (Join-Path $ScriptRoot "modules\core\config.psm1") -Force -Global
2026-01-11T19:28:12.6543011Z                      Import-Module (Join-Path $ScriptRoot "modules\core\menu.psm1") -Force -Global
2026-01-11T19:28:12.6543675Z                      
2026-01-11T19:28:12.6544202Z                      # Optimization categories (system, performance, power, network, etc.).
2026-01-11T19:28:12.6545192Z                      Import-Module (Join-Path $ScriptRoot "modules\optimizations\system.psm1") -Force -Global
2026-01-11T19:28:12.6546284Z                      Import-Module (Join-Path $ScriptRoot "modules\optimizations\amd-x3d.psm1") -Force -Global
2026-01-11T19:28:12.6547678Z                      Import-Module (Join-Path $ScriptRoot "modules\optimizations\performance.psm1") -Force -Global
2026-01-11T19:28:12.6548614Z                      Import-Module (Join-Path $ScriptRoot "modules\optimizations\power.psm1") -Force -Global
2026-01-11T19:28:12.6549607Z                      Import-Module (Join-Path $ScriptRoot "modules\optimizations\network.psm1") -Force -Global
2026-01-11T19:28:12.6550981Z                      Import-Module (Join-Path $ScriptRoot "modules\optimizations\audio.psm1") -Force -Global
2026-01-11T19:28:12.6552109Z                      Import-Module (Join-Path $ScriptRoot "modules\optimizations\privacy.psm1") -Force -Global
2026-01-11T19:28:12.6553307Z                      Import-Module (Join-Path $ScriptRoot "modules\optimizations\gpu.psm1") -Force -Global
2026-01-11T19:28:12.6554366Z                      Import-Module (Join-Path $ScriptRoot "modules\optimizations\peripherals.psm1") -Force -Global
2026-01-11T19:28:12.6555440Z                      Import-Module (Join-Path $ScriptRoot "modules\optimizations\browsers.psm1") -Force -Global
2026-01-11T19:28:12.6556440Z                      Import-Module (Join-Path $ScriptRoot "modules\software\installer.psm1") -Force -Global
2026-01-11T19:28:12.6557214Z                      
2026-01-11T19:28:12.6557660Z                      Write-Host "All modules loaded successfully" -ForegroundColor Green
2026-01-11T19:28:12.6558192Z                      Write-Host ""
2026-01-11T19:28:12.6558533Z                      
2026-01-11T19:28:12.6558779Z                      
2026-01-11T19:28:12.6558948Z                      
2026-01-11T19:28:12.6559233Z                      # Central log for all modules and sections.
2026-01-11T19:28:12.6560003Z                      $logPath = Join-Path $ScriptRoot "gaming-pc-setup.log"
2026-01-11T19:28:12.6560467Z                      Initialize-Logger -LogPath $logPath -ClearExisting $true
2026-01-11T19:28:12.6560982Z                      
2026-01-11T19:28:12.6561260Z                      Write-Log "=== Gaming PC Setup Started ===" "SUCCESS"
2026-01-11T19:28:12.6561660Z                      Write-Log "Script root: $ScriptRoot" "INFO"
2026-01-11T19:28:12.6562113Z                      Write-Log "Dry run: $DryRun" "INFO"
2026-01-11T19:28:12.6562459Z                      
2026-01-11T19:28:12.6562684Z                      
2026-01-11T19:28:12.6562870Z                      
2026-01-11T19:28:12.6563131Z                      <#
2026-01-11T19:28:12.6563385Z                      .SYNOPSIS
2026-01-11T19:28:12.6563909Z                          Collects a lightweight hardware/OS summary for logging and UI output.
2026-01-11T19:28:12.6564514Z                      .DESCRIPTION
2026-01-11T19:28:12.6565129Z                          Queries CPU, total RAM, primary GPU, OS caption, and OS build using CIM.
2026-01-11T19:28:12.6565980Z                          This data is used for the console summary and for the post-setup checklist.
2026-01-11T19:28:12.6566574Z                      .OUTPUTS
2026-01-11T19:28:12.6566884Z                          [hashtable] with keys CPU, RAM, GPU, OS, Build.
2026-01-11T19:28:12.6567384Z                      .NOTES
2026-01-11T19:28:12.6567814Z                          Does not require admin privileges, but script overall does.
2026-01-11T19:28:12.6568304Z                      #>
2026-01-11T19:28:12.6568650Z                      function Get-SystemInfo {
2026-01-11T19:28:12.6569091Z                          $cpu = (Get-CimInstance Win32_Processor).Name
2026-01-11T19:28:12.6569840Z                          $totalRAM = [math]::Round((Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property 
2026-01-11T19:28:12.6570656Z                      Capacity -Sum).Sum / 1GB)
2026-01-11T19:28:12.6571187Z                          $gpu = (Get-CimInstance Win32_VideoController | Select-Object -First 1).Name
2026-01-11T19:28:12.6571906Z                          $os = (Get-CimInstance Win32_OperatingSystem).Caption
2026-01-11T19:28:12.6572859Z                          $build = (Get-CimInstance Win32_OperatingSystem).BuildNumber
2026-01-11T19:28:12.6573407Z                      
2026-01-11T19:28:12.6573723Z                          return @{
2026-01-11T19:28:12.6574339Z                              CPU = $cpu
2026-01-11T19:28:12.6575218Z                              RAM = "${totalRAM}GB"
2026-01-11T19:28:12.6575654Z                              GPU = $gpu
2026-01-11T19:28:12.6576059Z                              OS = $os
2026-01-11T19:28:12.6576517Z                              Build = $build
2026-01-11T19:28:12.6576746Z                          }
2026-01-11T19:28:12.6576992Z                      }
2026-01-11T19:28:12.6577284Z                      
2026-01-11T19:28:12.6577752Z                      $sysInfo = Get-SystemInfo
2026-01-11T19:28:12.6578162Z                      
2026-01-11T19:28:12.6578843Z                      Write-Host "System Information:" -ForegroundColor Cyan
2026-01-11T19:28:12.6579963Z                      Write-Host "  CPU:   $($sysInfo.CPU)" -ForegroundColor White
2026-01-11T19:28:12.6580505Z                      Write-Host "  RAM:   $($sysInfo.RAM)" -ForegroundColor White
2026-01-11T19:28:12.6581900Z                      Write-Host "  GPU:   $($sysInfo.GPU)" -ForegroundColor White
2026-01-11T19:28:12.6583464Z                      Write-Host "  OS:    $($sysInfo.OS) (Build $($sysInfo.Build))" -ForegroundColor White
2026-01-11T19:28:12.6584384Z                      Write-Host ""
2026-01-11T19:28:12.6584743Z                      
2026-01-11T19:28:12.6585450Z                      Write-Log "System: $($sysInfo.CPU) | $($sysInfo.RAM) | $($sysInfo.GPU)" "INFO"
2026-01-11T19:28:12.6586113Z                      
2026-01-11T19:28:12.6586382Z                      
2026-01-11T19:28:12.6586935Z                      
2026-01-11T19:28:12.6587434Z                      # Ordered list of optimization sections to execute.
2026-01-11T19:28:12.6587970Z                      $sections = @(
2026-01-11T19:28:12.6588332Z                          @{
2026-01-11T19:28:12.6588707Z                              Name = "AMD X3D Optimizations"
2026-01-11T19:28:12.6589257Z                              Function = "Invoke-X3DOptimizations"
2026-01-11T19:28:12.6590576Z                              TestFunction = "Test-X3DOptimizations"
2026-01-11T19:28:12.6591565Z                              Condition = { Test-X3DCpu }
2026-01-11T19:28:12.6592003Z                              Weight = 5
2026-01-11T19:28:12.6593718Z                              Description = "CPPC enabled, Game Bar detection enabled, overlays disabled"
2026-01-11T19:28:12.6594407Z                          },
2026-01-11T19:28:12.6594582Z                          @{
2026-01-11T19:28:12.6594932Z                              Name = "System Optimizations"
2026-01-11T19:28:12.6595439Z                              Function = "Invoke-SystemOptimizations"
2026-01-11T19:28:12.6595915Z                              TestFunction = "Test-SystemOptimizations"
2026-01-11T19:28:12.6596524Z                              Condition = $null
2026-01-11T19:28:12.6596939Z                              Weight = 10
2026-01-11T19:28:12.6597836Z                              Description = "Page file, fast startup off, classic context menu, Storage Sense off, 
2026-01-11T19:28:12.6598680Z                      display performance, End Task in taskbar, Explorer cleanup"
2026-01-11T19:28:12.6599169Z                          },
2026-01-11T19:28:12.6599365Z                          @{
2026-01-11T19:28:12.6600499Z                              Name = "Performance Optimizations"
2026-01-11T19:28:12.6601120Z                              Function = "Invoke-PerformanceOptimizations"
2026-01-11T19:28:12.6601818Z                              TestFunction = "Test-PerformanceOptimizations"
2026-01-11T19:28:12.6602333Z                              Condition = $null
2026-01-11T19:28:12.6602561Z                              Weight = 15
2026-01-11T19:28:12.6603815Z                              Description = "GameDVR/FSO off, MSI mode, scheduler, timer resolution, MMCSS gaming 
2026-01-11T19:28:12.6604581Z                      tweaks, Game Mode"
2026-01-11T19:28:12.6604948Z                          },
2026-01-11T19:28:12.6605398Z                          @{
2026-01-11T19:28:12.6605692Z                              Name = "Power Optimizations"
2026-01-11T19:28:12.6606080Z                              Function = "Invoke-PowerOptimizations"
2026-01-11T19:28:12.6607272Z                              TestFunction = "Test-PowerOptimizations"
2026-01-11T19:28:12.6607789Z                              Condition = $null
2026-01-11T19:28:12.6609060Z                              Weight = 10
2026-01-11T19:28:12.6610349Z                              Description = "High performance plan, PCIe/USB power mgmt, 5% min processor state"
2026-01-11T19:28:12.6611403Z                          },
2026-01-11T19:28:12.6611600Z                          @{
2026-01-11T19:28:12.6612419Z                              Name = "Network Optimizations"
2026-01-11T19:28:12.6612995Z                              Function = "Invoke-NetworkOptimizations"
2026-01-11T19:28:12.6614393Z                              TestFunction = "Test-NetworkOptimizations"
2026-01-11T19:28:12.6614832Z                              Condition = $null
2026-01-11T19:28:12.6615916Z                              Weight = 10
2026-01-11T19:28:12.6617193Z                              Description = "DNS provider, RSS enabled, adapter advanced properties (Interrupt 
2026-01-11T19:28:12.6618327Z                      Moderation, Flow Control, EEE), IPv4 prefer/Teredo toggle, QoS opt-in"
2026-01-11T19:28:12.6619050Z                          },
2026-01-11T19:28:12.6619240Z                          @{
2026-01-11T19:28:12.6621324Z                              Name = "Peripheral Optimizations"
2026-01-11T19:28:12.6621713Z                              Function = "Invoke-PeripheralOptimizations"
2026-01-11T19:28:12.6622881Z                              TestFunction = "Test-MouseAcceleration"
2026-01-11T19:28:12.6623274Z                              Condition = $null
2026-01-11T19:28:12.6623560Z                              Weight = 5
2026-01-11T19:28:12.6624961Z                              Description = "Mouse acceleration disabled (Enhance pointer precision off)"
2026-01-11T19:28:12.6626046Z                          },
2026-01-11T19:28:12.6626387Z                          @{
2026-01-11T19:28:12.6627124Z                              Name = "Browser Optimizations"
2026-01-11T19:28:12.6627564Z                              Function = "Invoke-BrowserOptimizations"
2026-01-11T19:28:12.6628736Z                              TestFunction = "Test-BrowserBackgroundApps"
2026-01-11T19:28:12.6629164Z                              Condition = $null
2026-01-11T19:28:12.6630801Z                              Weight = 5
2026-01-11T19:28:12.6632233Z                              Description = "Chrome/Edge background apps disabled, Edge startup boost disabled"
2026-01-11T19:28:12.6633382Z                          },
2026-01-11T19:28:12.6633956Z                          @{
2026-01-11T19:28:12.6634406Z                              Name = "Audio Optimizations"
2026-01-11T19:28:12.6635860Z                              Function = "Invoke-AudioOptimizations"
2026-01-11T19:28:12.6636537Z                              TestFunction = "Test-AudioOptimizations"
2026-01-11T19:28:12.6637293Z                              Condition = $null
2026-01-11T19:28:12.6637710Z                              Weight = 10
2026-01-11T19:28:12.6638448Z                              Description = "Audio enhancements disabled, driver power mgmt disabled"
2026-01-11T19:28:12.6638955Z                          },
2026-01-11T19:28:12.6640065Z                          @{
2026-01-11T19:28:12.6641236Z                              Name = "GPU Optimizations"
2026-01-11T19:28:12.6641991Z                              Function = "Invoke-GPUOptimizations"
2026-01-11T19:28:12.6642519Z                              TestFunction = "Test-GPUOptimizations"
2026-01-11T19:28:12.6643803Z                              Condition = $null
2026-01-11T19:28:12.6644422Z                              Weight = 10
2026-01-11T19:28:12.6644921Z                              Description = "HAGS disabled (opt-in), vendor-specific tweaks"
2026-01-11T19:28:12.6646238Z                          },
2026-01-11T19:28:12.6646667Z                          @{
2026-01-11T19:28:12.6647775Z                              Name = "Privacy Optimizations"
2026-01-11T19:28:12.6648437Z                              Function = "Invoke-PrivacyOptimizations"
2026-01-11T19:28:12.6649923Z                              TestFunction = "Test-PrivacyOptimizations"
2026-01-11T19:28:12.6650285Z                              Condition = $null
2026-01-11T19:28:12.6651430Z                              Weight = 15
2026-01-11T19:28:12.6652708Z                              Description = "Telemetry reduced, notifications off, WPBT blocked, PS7 telemetry off, 
2026-01-11T19:28:12.6653702Z                      background apps off, Edge debloat, Copilot disable"
2026-01-11T19:28:12.6654232Z                          },
2026-01-11T19:28:12.6654550Z                          @{
2026-01-11T19:28:12.6655590Z                              Name = "Software Installation"
2026-01-11T19:28:12.6656540Z                              Function = "Invoke-SoftwareInstallation"
2026-01-11T19:28:12.6656951Z                              TestFunction = $null
2026-01-11T19:28:12.6658047Z                              Condition = $null
2026-01-11T19:28:12.6659104Z                              Weight = 15
2026-01-11T19:28:12.6659804Z                              Description = "Essential + recommended packages, peripheral software"
2026-01-11T19:28:12.6660393Z                          }
2026-01-11T19:28:12.6661599Z                      )
2026-01-11T19:28:12.6662388Z                      
2026-01-11T19:28:12.6663201Z                      $totalWeight = 0
2026-01-11T19:28:12.6663745Z                      foreach ($section in $sections) {
2026-01-11T19:28:12.6664818Z                          $totalWeight += $section.Weight
2026-01-11T19:28:12.6665245Z                      }
2026-01-11T19:28:12.6666255Z                      $completedWeight = 0
2026-01-11T19:28:12.6666672Z                      
2026-01-11T19:28:12.6667649Z                      
2026-01-11T19:28:12.6668440Z                      
2026-01-11T19:28:12.6669507Z                      Write-Host "The following optimizations will be applied:" -ForegroundColor Yellow
2026-01-11T19:28:12.6670801Z                      Write-Host ""
2026-01-11T19:28:12.6672124Z                      
2026-01-11T19:28:12.6672478Z                      foreach ($section in $sections) {
2026-01-11T19:28:12.6672849Z                          if ($section.Condition) {
2026-01-11T19:28:12.6673124Z                              if (-not (& $section.Condition)) {
2026-01-11T19:28:12.6674173Z                                  Write-Host "  [SKIP] $($section.Name) (condition not met)" -ForegroundColor Gray
2026-01-11T19:28:12.6674895Z                                  continue
2026-01-11T19:28:12.6675251Z                              }
2026-01-11T19:28:12.6675437Z                          }
2026-01-11T19:28:12.6676426Z                      
2026-01-11T19:28:12.6677069Z                          Write-Host "  [X] $($section.Name)" -ForegroundColor Green
2026-01-11T19:28:12.6678286Z                          Write-Host "      $($section.Description)" -ForegroundColor Gray
2026-01-11T19:28:12.6678923Z                      }
2026-01-11T19:28:12.6679222Z                      
2026-01-11T19:28:12.6680122Z                      Write-Host ""
2026-01-11T19:28:12.6681429Z                      Write-Host "SmartScreen and Windows Update remain ENABLED (security)" -ForegroundColor Yellow
2026-01-11T19:28:12.6682262Z                      Write-Host ""
2026-01-11T19:28:12.6682612Z                      
2026-01-11T19:28:12.6683008Z                      if (-not $DryRun -and -not $SkipConfirmation) {
2026-01-11T19:28:12.6683524Z                          $confirm = (Read-Host "Apply these optimizations? (Y/N)").Trim()
2026-01-11T19:28:12.6684004Z                          if ($confirm -notmatch '^(?i:y|yes)$') {
2026-01-11T19:28:12.6684654Z                              Write-Log "User cancelled script" "INFO"
2026-01-11T19:28:12.6685797Z                              Write-Host "Script cancelled by user" -ForegroundColor Yellow
2026-01-11T19:28:12.6686209Z                              exit 0
2026-01-11T19:28:12.6688302Z                          }
2026-01-11T19:28:12.6688686Z                      }
2026-01-11T19:28:12.6688969Z                      
2026-01-11T19:28:12.6689152Z                      Write-Host ""
2026-01-11T19:28:12.6689602Z                      Write-Host "Starting optimizations..." -ForegroundColor Cyan
2026-01-11T19:28:12.6690672Z                      Write-Host ""
2026-01-11T19:28:12.6691423Z                      
2026-01-11T19:28:12.6692807Z                      # Create a restore point before making any changes (safety feature).
2026-01-11T19:28:12.6693236Z                      if (-not $DryRun) {
2026-01-11T19:28:12.6694768Z                          Write-Host "Creating System Restore Point..." -ForegroundColor Yellow
2026-01-11T19:28:12.6695655Z                          New-RestorePoint -Description "Pre-Gaming-PC-Setup-$(Get-Date -Format 'yyyyMMdd-HHmm')"
2026-01-11T19:28:12.6696462Z                          Write-Host ""
2026-01-11T19:28:12.6696808Z                      }
2026-01-11T19:28:12.6697775Z                      
2026-01-11T19:28:12.6698241Z                      
2026-01-11T19:28:12.6699370Z                      
2026-01-11T19:28:12.6700231Z                      foreach ($section in $sections) {
2026-01-11T19:28:12.6700840Z                          if ($section.Condition) {
2026-01-11T19:28:12.6701463Z                              if (-not (& $section.Condition)) {
2026-01-11T19:28:12.6702665Z                                  Write-Log "Skipping $($section.Name) (condition not met)" "INFO"
2026-01-11T19:28:12.6703105Z                                  continue
2026-01-11T19:28:12.6704148Z                              }
2026-01-11T19:28:12.6704540Z                          }
2026-01-11T19:28:12.6705669Z                      
2026-01-11T19:28:12.6706646Z                          $progressPercent = [int](($completedWeight / $totalWeight) * 100)
2026-01-11T19:28:12.6707487Z                          Write-Progress -Activity "Gaming PC Setup" -Status $section.Name -PercentComplete 
2026-01-11T19:28:12.6708324Z                      $progressPercent
2026-01-11T19:28:12.6709011Z                      
2026-01-11T19:28:12.6709549Z                          Write-Log "=== $($section.Name) ===" "INFO"
2026-01-11T19:28:12.6710499Z                          Write-Host "[$progressPercent%] $($section.Name)..." -ForegroundColor Cyan
2026-01-11T19:28:12.6711046Z                      
2026-01-11T19:28:12.6711217Z                          try {
2026-01-11T19:28:12.6711431Z                              if ($DryRun) {
2026-01-11T19:28:12.6712767Z                                  Write-Log "DRY RUN: Would execute $($section.Function)" "INFO"
2026-01-11T19:28:12.6713455Z                                  Write-Host "  DRY RUN: Would apply optimizations" -ForegroundColor Yellow
2026-01-11T19:28:12.6713972Z                              } else {
2026-01-11T19:28:12.6715082Z                                  & $section.Function
2026-01-11T19:28:12.6715540Z                      
2026-01-11T19:28:12.6716816Z                                  if ($section.TestFunction) {
2026-01-11T19:28:12.6717250Z                                      Write-Log "Verifying $($section.Name)..." "INFO"
2026-01-11T19:28:12.6718365Z                                      $testResult = & $section.TestFunction
2026-01-11T19:28:12.6718768Z                                      if ($testResult) {
2026-01-11T19:28:12.6719931Z                                          Write-Log "$($section.Name) verification: PASSED" "SUCCESS"
2026-01-11T19:28:12.6720302Z                                      } else {
2026-01-11T19:28:12.6721545Z                                          Write-Log "$($section.Name) verification: FAILED (review above logs)" "ERROR"
2026-01-11T19:28:12.6722030Z                                      }
2026-01-11T19:28:12.6723032Z                                  }
2026-01-11T19:28:12.6723518Z                              }
2026-01-11T19:28:12.6724570Z                      
2026-01-11T19:28:12.6725671Z                              $completedWeight += $section.Weight
2026-01-11T19:28:12.6726244Z                      
2026-01-11T19:28:12.6726878Z                          } catch {
2026-01-11T19:28:12.6727298Z                              Write-Log "Error in $($section.Name): $_" "ERROR"
2026-01-11T19:28:12.6728589Z                              Write-Host "  ERROR: $($_.Exception.Message)" -ForegroundColor Red
2026-01-11T19:28:12.6729488Z                          }
2026-01-11T19:28:12.6729918Z                      
2026-01-11T19:28:12.6731001Z                          Write-Host ""
2026-01-11T19:28:12.6731412Z                      }
2026-01-11T19:28:12.6732594Z                      
2026-01-11T19:28:12.6733517Z                      Write-Progress -Activity "Gaming PC Setup" -Completed
2026-01-11T19:28:12.6734315Z                      
2026-01-11T19:28:12.6734613Z                      
2026-01-11T19:28:12.6735522Z                      
2026-01-11T19:28:12.6735995Z                      if (-not $DryRun) {
2026-01-11T19:28:12.6737309Z                          $checklistPath = Join-Path $ScriptRoot "POST-SETUP-CHECKLIST.txt"
2026-01-11T19:28:12.6737991Z                      
2026-01-11T19:28:12.6738413Z                          # The checklist is a human-focused, post-setup reminder sheet.
2026-01-11T19:28:12.6739094Z                          $checklistContent = @"
2026-01-11T19:28:12.6740417Z                      ================================================================================
2026-01-11T19:28:12.6740879Z                          GAMING PC SETUP - POST-INSTALLATION CHECKLIST
2026-01-11T19:28:12.6741929Z                      ================================================================================
2026-01-11T19:28:12.6742289Z                      
2026-01-11T19:28:12.6743426Z                      Completed: $(Get-Date -Format "yyyy-MM-dd HH:mm:ss")
2026-01-11T19:28:12.6743955Z                      System: $($sysInfo.CPU) | $($sysInfo.RAM) | $($sysInfo.GPU)
2026-01-11T19:28:12.6744597Z                      
2026-01-11T19:28:12.6745750Z                      ================================================================================
2026-01-11T19:28:12.6746150Z                          REBOOT REQUIRED
2026-01-11T19:28:12.6747221Z                      ================================================================================
2026-01-11T19:28:12.6747609Z                      
2026-01-11T19:28:12.6748801Z                      [X] REBOOT YOUR SYSTEM NOW
2026-01-11T19:28:12.6749728Z                          - HPET, MSI Mode, and power changes require a restart
2026-01-11T19:28:12.6750151Z                          - Page file changes require a restart
2026-01-11T19:28:12.6751138Z                      
2026-01-11T19:28:12.6752049Z                      ================================================================================
2026-01-11T19:28:12.6752434Z                          BEFORE GAMING - TIMER TOOL
2026-01-11T19:28:12.6753566Z                      ================================================================================
2026-01-11T19:28:12.6753899Z                      
2026-01-11T19:28:12.6754999Z                      [X] Run timer-tool.ps1 BEFORE starting any game
2026-01-11T19:28:12.6755354Z                      
2026-01-11T19:28:12.6756381Z                          Command:
2026-01-11T19:28:12.6757212Z                          .\timer-tool.ps1
2026-01-11T19:28:12.6757655Z                      
2026-01-11T19:28:12.6758783Z                          OR (auto-exit when game closes):
2026-01-11T19:28:12.6759193Z                          .\timer-tool.ps1 -GameProcess "dota2"
2026-01-11T19:28:12.6760223Z                          .\timer-tool.ps1 -GameProcess "cs2"
2026-01-11T19:28:12.6760602Z                      
2026-01-11T19:28:12.6761652Z                          What it does:
2026-01-11T19:28:12.6762657Z                          - Sets Windows timer resolution to 0.5ms (from 15.6ms default)
2026-01-11T19:28:12.6763440Z                          - Eliminates micro-stutters and improves frame pacing
2026-01-11T19:28:12.6763946Z                          - MUST be running during gameplay
2026-01-11T19:28:12.6764585Z                          - Press Ctrl+C when done gaming
2026-01-11T19:28:12.6765712Z                      
2026-01-11T19:28:12.6766588Z                      ================================================================================
2026-01-11T19:28:12.6767238Z                          GPU DRIVER SETTINGS (MANUAL CONFIGURATION)
2026-01-11T19:28:12.6768010Z                      ================================================================================
2026-01-11T19:28:12.6769381Z                      
2026-01-11T19:28:12.6769803Z                      NVIDIA Control Panel (if you have NVIDIA GPU):
2026-01-11T19:28:12.6770900Z                      --------------------------------------------
2026-01-11T19:28:12.6771365Z                      1. Open NVIDIA Control Panel
2026-01-11T19:28:12.6772507Z                      2. Manage 3D Settings > Global Settings:
2026-01-11T19:28:12.6772934Z                         [X] Power management mode: Prefer maximum performance
2026-01-11T19:28:12.6774030Z                         [X] Low latency mode: Ultra (or On)
2026-01-11T19:28:12.6774629Z                         [X] Vertical sync: Off (or Fast if you have G-Sync)
2026-01-11T19:28:12.6775358Z                         [X] Texture filtering - Quality: High performance
2026-01-11T19:28:12.6776397Z                         [X] Shader Cache: On
2026-01-11T19:28:12.6776753Z                      
2026-01-11T19:28:12.6777860Z                      AMD Radeon Software (if you have AMD GPU):
2026-01-11T19:28:12.6778304Z                      ------------------------------------------
2026-01-11T19:28:12.6779304Z                      1. Open AMD Radeon Software
2026-01-11T19:28:12.6780143Z                      2. Gaming > Global Graphics:
2026-01-11T19:28:12.6780626Z                         [X] Radeon Anti-Lag: On
2026-01-11T19:28:12.6781954Z                         [X] Radeon Boost: On (if supported)
2026-01-11T19:28:12.6782373Z                         [X] Wait for Vertical Refresh: Off
2026-01-11T19:28:12.6783454Z                         [X] Texture Filtering Quality: Performance
2026-01-11T19:28:12.6783917Z                         [X] Radeon Image Sharpening: 80% (optional)
2026-01-11T19:28:12.6784828Z                      
2026-01-11T19:28:12.6785408Z                      ================================================================================
2026-01-11T19:28:12.6786706Z                          GAME-SPECIFIC LAUNCH OPTIONS
2026-01-11T19:28:12.6787248Z                      ================================================================================
2026-01-11T19:28:12.6787886Z                      
2026-01-11T19:28:12.6788954Z                      Steam Games:
2026-01-11T19:28:12.6789599Z                      -----------
2026-01-11T19:28:12.6790987Z                      Right-click game > Properties > General > Launch Options
2026-01-11T19:28:12.6791435Z                      
2026-01-11T19:28:12.6792459Z                      Dota 2:
2026-01-11T19:28:12.6793328Z                          -dx11 -high -nojoy -console +fps_max 0
2026-01-11T19:28:12.6793721Z                      
2026-01-11T19:28:12.6794813Z                      CS2 (Counter-Strike 2):
2026-01-11T19:28:12.6795368Z                          -high -freq 240 -refresh 240 +fps_max 0 -nojoy
2026-01-11T19:28:12.6796014Z                      
2026-01-11T19:28:12.6797062Z                      Helldivers 2:
2026-01-11T19:28:12.6797878Z                          -dx11 -high
2026-01-11T19:28:12.6798982Z                      
2026-01-11T19:28:12.6799390Z                      General recommendations:
2026-01-11T19:28:12.6799845Z                          -high           (High CPU priority)
2026-01-11T19:28:12.6800543Z                          -nojoy          (Disable joystick support, reduces input latency)
2026-01-11T19:28:12.6801466Z                          -freq 240       (Match your monitor refresh rate)
2026-01-11T19:28:12.6801814Z                          +fps_max 0      (Unlimited FPS)
2026-01-11T19:28:12.6802979Z                      
2026-01-11T19:28:12.6803441Z                      ================================================================================
2026-01-11T19:28:12.6804485Z                          SOFTWARE POST-CONFIGURATION
2026-01-11T19:28:12.6804961Z                      ================================================================================
2026-01-11T19:28:12.6805908Z                      
2026-01-11T19:28:12.6806799Z                      Spotify (if installed):
2026-01-11T19:28:12.6807236Z                      -----------------------
2026-01-11T19:28:12.6808402Z                      [X] Disable auto-start on boot:
2026-01-11T19:28:12.6809074Z                          Settings > Show Advanced Settings > Startup and Window Behaviour
2026-01-11T19:28:12.6810029Z                          > Open Spotify automatically after you log into the computer: OFF
2026-01-11T19:28:12.6810818Z                      
2026-01-11T19:28:12.6811190Z                      [X] Set audio quality to "Very High":
2026-01-11T19:28:12.6811798Z                          Settings > Audio Quality > Streaming quality: Very High
2026-01-11T19:28:12.6812852Z                      
2026-01-11T19:28:12.6813364Z                      qBittorrent (if installed):
2026-01-11T19:28:12.6814498Z                      ---------------------------
2026-01-11T19:28:12.6815013Z                      [X] Install search plugins:
2026-01-11T19:28:12.6816146Z                          View > Search Engine > Search plugins...
2026-01-11T19:28:12.6816600Z                          Install popular plugins (ThePirateBay, 1337x, etc.)
2026-01-11T19:28:12.6817485Z                      
2026-01-11T19:28:12.6817993Z                      [X] Set download location:
2026-01-11T19:28:12.6819109Z                          Tools > Options > Downloads > Default save path
2026-01-11T19:28:12.6819453Z                      
2026-01-11T19:28:12.6820513Z                      Discord:
2026-01-11T19:28:12.6821330Z                      --------
2026-01-11T19:28:12.6821942Z                      [X] Disable hardware acceleration if you experience stutters:
2026-01-11T19:28:12.6822611Z                          Settings > Advanced > Hardware Acceleration: OFF
2026-01-11T19:28:12.6823586Z                      
2026-01-11T19:28:12.6824405Z                      [X] Reduce CPU usage:
2026-01-11T19:28:12.6824880Z                          Settings > Voice & Video > Video Codec: H.264
2026-01-11T19:28:12.6825839Z                      
2026-01-11T19:28:12.6826685Z                      Philips Hue Sync (if installed):
2026-01-11T19:28:12.6827094Z                      --------------------------------
2026-01-11T19:28:12.6828240Z                      [X] Close before gaming if you experience stutters
2026-01-11T19:28:12.6829300Z                          RGB software can cause DPC latency issues
2026-01-11T19:28:12.6829619Z                      
2026-01-11T19:28:12.6830989Z                      Logitech G HUB / Razer Synapse / Corsair iCUE:
2026-01-11T19:28:12.6831516Z                      ----------------------------------------------
2026-01-11T19:28:12.6832904Z                      [X] Configure your devices, then close the software before gaming
2026-01-11T19:28:12.6833446Z                          Peripheral software is a common source of DPC latency
2026-01-11T19:28:12.6834110Z                          Settings are saved to device memory
2026-01-11T19:28:12.6835069Z                      
2026-01-11T19:28:12.6835969Z                      ================================================================================
2026-01-11T19:28:12.6836372Z                          AMD RYZEN X3D USERS (7900X3D / 7950X3D / 9800X3D)
2026-01-11T19:28:12.6837473Z                      ================================================================================
2026-01-11T19:28:12.6838049Z                      
2026-01-11T19:28:12.6838988Z                      BIOS Settings:
2026-01-11T19:28:12.6839483Z                      ------------------------
2026-01-11T19:28:12.6840788Z                      [X] CPPC (Collaborative Processor Performance Control): ENABLED or AUTO/DRIVER
2026-01-11T19:28:12.6841869Z                          - DO NOT DISABLE (required for AMD 3D V-Cache Performance Optimizer)
2026-01-11T19:28:12.6842547Z                      
2026-01-11T19:28:12.6842848Z                      [X] CPPC Preferred Cores: AUTO or DRIVER
2026-01-11T19:28:12.6843219Z                      
2026-01-11T19:28:12.6844424Z                      [X] AGESA: Update to 1.0.0.7+ or latest
2026-01-11T19:28:12.6844850Z                      
2026-01-11T19:28:12.6845907Z                      [X] EXPO/XMP: Enabled (for RAM)
2026-01-11T19:28:12.6846293Z                      
2026-01-11T19:28:12.6847309Z                      Drivers:
2026-01-11T19:28:12.6848013Z                      --------
2026-01-11T19:28:12.6849586Z                      [X] Install latest AMD Chipset Drivers:
2026-01-11T19:28:12.6850347Z                          https://www.amd.com/en/support
2026-01-11T19:28:12.6850873Z                      
2026-01-11T19:28:12.6851413Z                          Includes:
2026-01-11T19:28:12.6851767Z                          - AMD 3D V-Cache Performance Optimizer
2026-01-11T19:28:12.6852456Z                          - PPM Provisioning File Driver
2026-01-11T19:28:12.6853607Z                          - Required for proper X3D thread steering
2026-01-11T19:28:12.6853901Z                      
2026-01-11T19:28:12.6854934Z                      Verification:
2026-01-11T19:28:12.6855765Z                      -------------
2026-01-11T19:28:12.6856275Z                      [X] After reboot, verify in Device Manager:
2026-01-11T19:28:12.6857404Z                          System Devices > Look for:
2026-01-11T19:28:12.6857941Z                          - "AMD 3D V-Cache Performance Optimizer"
2026-01-11T19:28:12.6858902Z                          - "AMD PPM Provisioning File Driver"
2026-01-11T19:28:12.6859283Z                      
2026-01-11T19:28:12.6860450Z                          If missing, reinstall AMD Chipset Drivers
2026-01-11T19:28:12.6860803Z                      
2026-01-11T19:28:12.6861899Z                      ================================================================================
2026-01-11T19:28:12.6862312Z                          TROUBLESHOOTING
2026-01-11T19:28:12.6863383Z                      ================================================================================
2026-01-11T19:28:12.6863781Z                      
2026-01-11T19:28:12.6864860Z                      Still getting micro-stutters?
2026-01-11T19:28:12.6865300Z                      -----------------------------
2026-01-11T19:28:12.6866451Z                      1. [X] Download LatencyMon: https://www.resplendence.com/latencymon
2026-01-11T19:28:12.6867865Z                         - Identifies drivers causing DPC latency
2026-01-11T19:28:12.6868434Z                         - Run for 5 minutes while gaming
2026-01-11T19:28:12.6868832Z                      
2026-01-11T19:28:12.6869126Z                      2. [X] Update audio drivers (most common DPC latency source)
2026-01-11T19:28:12.6870363Z                         - Visit motherboard manufacturer website
2026-01-11T19:28:12.6870701Z                         - Download latest audio drivers
2026-01-11T19:28:12.6871765Z                      
2026-01-11T19:28:12.6872358Z                      3. [X] Close RGB software (iCUE, Razer Synapse, G HUB)
2026-01-11T19:28:12.6873392Z                         - Major source of DPC latency
2026-01-11T19:28:12.6874052Z                      
2026-01-11T19:28:12.6874413Z                      4. [X] Toggle GPU Scheduling:
2026-01-11T19:28:12.6875721Z                         - Settings > System > Display > Graphics > Hardware-accelerated GPU scheduling
2026-01-11T19:28:12.6876702Z                         - Try both ON and OFF, benchmark both
2026-01-11T19:28:12.6877326Z                      
2026-01-11T19:28:12.6877773Z                      5. [X] Verify timer tool is running:
2026-01-11T19:28:12.6878198Z                         - Must run timer-tool.ps1 before gaming
2026-01-11T19:28:12.6879212Z                      
2026-01-11T19:28:12.6880058Z                      Network still laggy?
2026-01-11T19:28:12.6880496Z                      -------------------
2026-01-11T19:28:12.6881619Z                      1. [X] Update network adapter drivers
2026-01-11T19:28:12.6882015Z                      2. [X] Check router QoS settings
2026-01-11T19:28:12.6883084Z                      3. [X] Try different DNS (script set Cloudflare 1.1.1.1)
2026-01-11T19:28:12.6883519Z                      4. [X] Test with ethernet (not WiFi)
2026-01-11T19:28:12.6884474Z                      
2026-01-11T19:28:12.6885369Z                      X3D performance inconsistent?
2026-01-11T19:28:12.6885817Z                      -----------------------------
2026-01-11T19:28:12.6887018Z                      1. [X] Verify CPPC is ENABLED in BIOS (not disabled)
2026-01-11T19:28:12.6888358Z                      2. [X] Install latest AMD Chipset Drivers
2026-01-11T19:28:12.6889070Z                      3. [X] Check Device Manager for 3D V-Cache optimizer driver
2026-01-11T19:28:12.6889742Z                      4. [X] Ensure Game Bar detection is enabled (script keeps it on)
2026-01-11T19:28:12.6890805Z                      
2026-01-11T19:28:12.6892246Z                      ================================================================================
2026-01-11T19:28:12.6892678Z                          BENCHMARKING & VALIDATION
2026-01-11T19:28:12.6893925Z                      ================================================================================
2026-01-11T19:28:12.6894274Z                      
2026-01-11T19:28:12.6895584Z                      Before/After Testing:
2026-01-11T19:28:12.6897005Z                      --------------------
2026-01-11T19:28:12.6897513Z                      [X] Run benchmarks before and after optimizations:
2026-01-11T19:28:12.6897835Z                          - 3DMark Time Spy
2026-01-11T19:28:12.6898490Z                          - In-game benchmarks
2026-01-11T19:28:12.6899037Z                          - Focus on 1% Low FPS (more important than average)
2026-01-11T19:28:12.6899600Z                      
2026-01-11T19:28:12.6900014Z                      [X] Monitor frame times:
2026-01-11T19:28:12.6900569Z                          - Use MSI Afterburner + RivaTuner Statistics Server
2026-01-11T19:28:12.6901699Z                          - Look for frame time consistency (lower variance = smoother)
2026-01-11T19:28:12.6902054Z                      
2026-01-11T19:28:12.6903242Z                      Performance Monitoring:
2026-01-11T19:28:12.6903647Z                      ----------------------
2026-01-11T19:28:12.6904807Z                      [X] HWiNFO64: https://www.hwinfo.com/
2026-01-11T19:28:12.6905246Z                          - Monitor CPU/GPU temps, clocks, power
2026-01-11T19:28:12.6906301Z                          - Check for thermal throttling
2026-01-11T19:28:12.6906679Z                      
2026-01-11T19:28:12.6907860Z                      [X] CapFrameX: https://www.capframex.com/
2026-01-11T19:28:12.6908997Z                          - Advanced frame time analysis
2026-01-11T19:28:12.6909458Z                          - 1% Low and 0.1% Low FPS tracking
2026-01-11T19:28:12.6910442Z                      
2026-01-11T19:28:12.6911307Z                      ================================================================================
2026-01-11T19:28:12.6911666Z                          ADDITIONAL RESOURCES
2026-01-11T19:28:12.6912780Z                      ================================================================================
2026-01-11T19:28:12.6913154Z                      
2026-01-11T19:28:12.6914161Z                      Drivers:
2026-01-11T19:28:12.6915180Z                      --------
2026-01-11T19:28:12.6915500Z                      - AMD Chipset Drivers: https://www.amd.com/en/support
2026-01-11T19:28:12.6916724Z                      - NVIDIA Drivers: https://www.nvidia.com/Download/index.aspx
2026-01-11T19:28:12.6917916Z                      - Intel Drivers: https://www.intel.com/content/www/us/en/support.html
2026-01-11T19:28:12.6918360Z                      
2026-01-11T19:28:12.6918531Z                      Tools:
2026-01-11T19:28:12.6918815Z                      ------
2026-01-11T19:28:12.6920197Z                      - LatencyMon: https://www.resplendence.com/latencymon
2026-01-11T19:28:12.6920633Z                      - HWiNFO64: https://www.hwinfo.com/
2026-01-11T19:28:12.6921716Z                      - MSI Afterburner: https://www.msi.com/Landing/afterburner
2026-01-11T19:28:12.6922176Z                      - CapFrameX: https://www.capframex.com/
2026-01-11T19:28:12.6923165Z                      
2026-01-11T19:28:12.6923625Z                      Support:
2026-01-11T19:28:12.6924702Z                      --------
2026-01-11T19:28:12.6925502Z                      - Log file: $logPath
2026-01-11T19:28:12.6926149Z                      - GitHub Issues: https://github.com/thepedroferrari/gaming-pc-setup/issues
2026-01-11T19:28:12.6926732Z                      
2026-01-11T19:28:12.6927898Z                      ================================================================================
2026-01-11T19:28:12.6929088Z                          DONE! ENJOY YOUR OPTIMIZED GAMING PC
2026-01-11T19:28:12.6929545Z                      ================================================================================
2026-01-11T19:28:12.6930562Z                      
2026-01-11T19:28:12.6931297Z                      Remember:
2026-01-11T19:28:12.6932158Z                      1. REBOOT NOW
2026-01-11T19:28:12.6932664Z                      2. Run timer-tool.ps1 BEFORE gaming
2026-01-11T19:28:12.6933888Z                      3. Configure GPU driver settings manually
2026-01-11T19:28:12.6934745Z                      
2026-01-11T19:28:12.6936011Z                      Happy gaming! üéÆ
2026-01-11T19:28:12.6936745Z                      
2026-01-11T19:28:12.6937221Z                      "@
2026-01-11T19:28:12.6937432Z                      
2026-01-11T19:28:12.6938852Z                          Set-Content -Path $checklistPath -Value $checklistContent -Encoding UTF8
2026-01-11T19:28:12.6939556Z                          Write-Log "Post-setup checklist created: $checklistPath" "SUCCESS"
2026-01-11T19:28:12.6939998Z                      
2026-01-11T19:28:12.6941101Z                          Start-Process "notepad.exe" -ArgumentList $checklistPath
2026-01-11T19:28:12.6942016Z                      }
2026-01-11T19:28:12.6942325Z                      
2026-01-11T19:28:12.6943246Z                      
2026-01-11T19:28:12.6943662Z                      
2026-01-11T19:28:12.6944771Z                      Write-Host ""
2026-01-11T19:28:12.6945810Z                      Write-Host "=== Gaming PC Setup Complete ===" -ForegroundColor Green
2026-01-11T19:28:12.6946176Z                      Write-Host ""
2026-01-11T19:28:12.6947431Z                      
2026-01-11T19:28:12.6947647Z                      if (-not $DryRun) {
2026-01-11T19:28:12.6949038Z                          Write-Host "Next steps:" -ForegroundColor Yellow
2026-01-11T19:28:12.6949619Z                          Write-Host "  1. REBOOT your system for changes to take effect" -ForegroundColor White
2026-01-11T19:28:12.6950873Z                          Write-Host "  2. Run timer-tool.ps1 during gameplay for optimal timer resolution" 
2026-01-11T19:28:12.6951395Z                      -ForegroundColor White
2026-01-11T19:28:12.6952236Z                          Write-Host "  3. Review POST-SETUP-CHECKLIST.txt (opening in notepad...)" -ForegroundColor 
2026-01-11T19:28:12.6953157Z                      White
2026-01-11T19:28:12.6953572Z                          Write-Host ""
2026-01-11T19:28:12.6954990Z                          Write-Host "Log file: $logPath" -ForegroundColor Cyan
2026-01-11T19:28:12.6955738Z                          Write-Host ""
2026-01-11T19:28:12.6956058Z                      
2026-01-11T19:28:12.6957060Z                          $summary = Get-LogSummary
2026-01-11T19:28:12.6957626Z                          Write-Host "Summary:" -ForegroundColor Cyan
2026-01-11T19:28:12.6958750Z                          Write-Host "  SUCCESS: $($summary.Success)" -ForegroundColor Green
2026-01-11T19:28:12.6959214Z                          Write-Host "  ERROR:   $($summary.Error)" -ForegroundColor Red
2026-01-11T19:28:12.6960349Z                          Write-Host "  INFO:    $($summary.Info)" -ForegroundColor Gray
2026-01-11T19:28:12.6960704Z                          Write-Host ""
2026-01-11T19:28:12.6961632Z                      
2026-01-11T19:28:12.6962488Z                          Write-Log "=== Gaming PC Setup Complete ===" "SUCCESS"
2026-01-11T19:28:12.6963423Z                          Write-Log "Summary: $($summary.Success) success, $($summary.Error) errors, $($summary.Info) 
2026-01-11T19:28:12.6964565Z                      info" "SUCCESS"
2026-01-11T19:28:12.6964934Z                      } else {
2026-01-11T19:28:12.6965763Z                          Write-Host "DRY RUN complete. No changes were applied." -ForegroundColor Yellow
2026-01-11T19:28:12.6966226Z                          Write-Host ""
2026-01-11T19:28:12.6967253Z                      }
2026-01-11T19:28:12.6968252Z [32;1mCleanBlock         : [0m
2026-01-11T19:28:12.6968883Z [32;1mDynamicParamBlock  : [0m
2026-01-11T19:28:12.6970274Z [32;1mScriptRequirements : [0mSystem.Management.Automation.Language.ScriptRequirements
2026-01-11T19:28:12.6972021Z [32;1mExtent             : [0m<#
2026-01-11T19:28:12.6972516Z                      .SYNOPSIS
2026-01-11T19:28:12.6973733Z                          Main entry point for applying evidence-based Windows gaming optimizations.
2026-01-11T19:28:12.6974593Z                      .DESCRIPTION
2026-01-11T19:28:12.6975220Z                          Loads core and optimization modules, collects basic system information, previews
2026-01-11T19:28:12.6975991Z                          planned changes, optionally asks for confirmation, creates a restore point, and
2026-01-11T19:28:12.6976843Z                          then executes each optimization section with per-section verification.
2026-01-11T19:28:12.6978089Z                          Generates a log file and a post-setup checklist on success.
2026-01-11T19:28:12.6978879Z                      .PARAMETER DryRun
2026-01-11T19:28:12.6979385Z                          When set, the script prints intended actions and skips all system changes.
2026-01-11T19:28:12.6979825Z                      .PARAMETER SkipConfirmation
2026-01-11T19:28:12.6981173Z                          When set, skips the "Apply these optimizations?" prompt for unattended execution.
2026-01-11T19:28:12.6982131Z                      .PARAMETER ConfigFile
2026-01-11T19:28:12.6983250Z                          Optional path to a JSON configuration file. This parameter is reserved for
2026-01-11T19:28:12.6984236Z                          future config wiring and is not consumed by this script today.
2026-01-11T19:28:12.6984921Z                      .PARAMETER Profile
2026-01-11T19:28:12.6995232Z                          Optional profile name (e.g., competitive, balanced). This parameter is reserved
2026-01-11T19:28:12.6996215Z                          for future config wiring and is not consumed by this script today.
2026-01-11T19:28:12.6996670Z                      .EXAMPLE
2026-01-11T19:28:12.6996908Z                          .\gaming-pc-setup.ps1
2026-01-11T19:28:12.6997142Z                      .EXAMPLE
2026-01-11T19:28:12.6997365Z                          .\gaming-pc-setup.ps1 -DryRun
2026-01-11T19:28:12.6997610Z                      .EXAMPLE
2026-01-11T19:28:12.6998059Z                          .\gaming-pc-setup.ps1 -SkipConfirmation
2026-01-11T19:28:12.6998733Z                      .NOTES
2026-01-11T19:28:12.6999044Z                          Requires Administrator. Produces `gaming-pc-setup.log` and
2026-01-11T19:28:12.6999556Z                          `POST-SETUP-CHECKLIST.txt`. See module files for exact registry/service changes.
2026-01-11T19:28:12.6999958Z                      #>
2026-01-11T19:28:12.7000161Z                      #Requires -RunAsAdministrator
2026-01-11T19:28:12.7000394Z                      
2026-01-11T19:28:12.7000549Z                      
2026-01-11T19:28:12.7000690Z                      
2026-01-11T19:28:12.7000842Z                      param(
2026-01-11T19:28:12.7001027Z                          [switch]$DryRun,
2026-01-11T19:28:12.7001269Z                          [switch]$SkipConfirmation,
2026-01-11T19:28:12.7001514Z                          [string]$ConfigFile,
2026-01-11T19:28:12.7001733Z                          [string]$Profile
2026-01-11T19:28:12.7001947Z                      )
2026-01-11T19:28:12.7002101Z                      
2026-01-11T19:28:12.7002342Z                      
2026-01-11T19:28:12.7002861Z                      # Resolve script root even when invoked from a different working directory.
2026-01-11T19:28:12.7003510Z                      $ScriptRoot = $PSScriptRoot
2026-01-11T19:28:12.7003760Z                      if (-not $ScriptRoot) {
2026-01-11T19:28:12.7004083Z                          $ScriptRoot = Split-Path -Parent $MyInvocation.MyCommand.Path
2026-01-11T19:28:12.7004415Z                      }
2026-01-11T19:28:12.7004665Z                      
2026-01-11T19:28:12.7004953Z                      Write-Host ""
2026-01-11T19:28:12.7005500Z                      Write-Host "=== Gaming PC Setup (Modular) ===" -ForegroundColor Cyan
2026-01-11T19:28:12.7006167Z                      Write-Host "Evidence-based Windows optimizations for gaming" -ForegroundColor Yellow
2026-01-11T19:28:12.7006904Z                      Write-Host ""
2026-01-11T19:28:12.7007243Z                      
2026-01-11T19:28:12.7007662Z                      if ($DryRun) {
2026-01-11T19:28:12.7009282Z                          Write-Host "DRY RUN MODE: No changes will be applied" -ForegroundColor Yellow
2026-01-11T19:28:12.7009812Z                          Write-Host ""
2026-01-11T19:28:12.7010747Z                      }
2026-01-11T19:28:12.7011182Z                      
2026-01-11T19:28:12.7012102Z                      
2026-01-11T19:28:12.7012829Z                      
2026-01-11T19:28:12.7013760Z                      Write-Host "Loading modules..." -ForegroundColor Cyan
2026-01-11T19:28:12.7014518Z                      
2026-01-11T19:28:12.7015074Z                      # Core infrastructure for logging, registry helpers, config, and menus.
2026-01-11T19:28:12.7015817Z                      Import-Module (Join-Path $ScriptRoot "modules\core\logger.psm1") -Force -Global
2026-01-11T19:28:12.7017062Z                      Import-Module (Join-Path $ScriptRoot "modules\core\registry.psm1") -Force -Global
2026-01-11T19:28:12.7018007Z                      Import-Module (Join-Path $ScriptRoot "modules\core\config.psm1") -Force -Global
2026-01-11T19:28:12.7018993Z                      Import-Module (Join-Path $ScriptRoot "modules\core\menu.psm1") -Force -Global
2026-01-11T19:28:12.7019427Z                      
2026-01-11T19:28:12.7019717Z                      # Optimization categories (system, performance, power, network, etc.).
2026-01-11T19:28:12.7020456Z                      Import-Module (Join-Path $ScriptRoot "modules\optimizations\system.psm1") -Force -Global
2026-01-11T19:28:12.7021235Z                      Import-Module (Join-Path $ScriptRoot "modules\optimizations\amd-x3d.psm1") -Force -Global
2026-01-11T19:28:12.7022482Z                      Import-Module (Join-Path $ScriptRoot "modules\optimizations\performance.psm1") -Force -Global
2026-01-11T19:28:12.7023471Z                      Import-Module (Join-Path $ScriptRoot "modules\optimizations\power.psm1") -Force -Global
2026-01-11T19:28:12.7024517Z                      Import-Module (Join-Path $ScriptRoot "modules\optimizations\network.psm1") -Force -Global
2026-01-11T19:28:12.7025629Z                      Import-Module (Join-Path $ScriptRoot "modules\optimizations\audio.psm1") -Force -Global
2026-01-11T19:28:12.7026852Z                      Import-Module (Join-Path $ScriptRoot "modules\optimizations\privacy.psm1") -Force -Global
2026-01-11T19:28:12.7028096Z                      Import-Module (Join-Path $ScriptRoot "modules\optimizations\gpu.psm1") -Force -Global
2026-01-11T19:28:12.7028924Z                      Import-Module (Join-Path $ScriptRoot "modules\optimizations\peripherals.psm1") -Force -Global
2026-01-11T19:28:12.7029701Z                      Import-Module (Join-Path $ScriptRoot "modules\optimizations\browsers.psm1") -Force -Global
2026-01-11T19:28:12.7030962Z                      Import-Module (Join-Path $ScriptRoot "modules\software\installer.psm1") -Force -Global
2026-01-11T19:28:12.7031600Z                      
2026-01-11T19:28:12.7032049Z                      Write-Host "All modules loaded successfully" -ForegroundColor Green
2026-01-11T19:28:12.7032530Z                      Write-Host ""
2026-01-11T19:28:12.7033677Z                      
2026-01-11T19:28:12.7034144Z                      
2026-01-11T19:28:12.7035141Z                      
2026-01-11T19:28:12.7036053Z                      # Central log for all modules and sections.
2026-01-11T19:28:12.7036543Z                      $logPath = Join-Path $ScriptRoot "gaming-pc-setup.log"
2026-01-11T19:28:12.7037712Z                      Initialize-Logger -LogPath $logPath -ClearExisting $true
2026-01-11T19:28:12.7038059Z                      
2026-01-11T19:28:12.7039216Z                      Write-Log "=== Gaming PC Setup Started ===" "SUCCESS"
2026-01-11T19:28:12.7040346Z                      Write-Log "Script root: $ScriptRoot" "INFO"
2026-01-11T19:28:12.7040863Z                      Write-Log "Dry run: $DryRun" "INFO"
2026-01-11T19:28:12.7041325Z                      
2026-01-11T19:28:12.7042611Z                      
2026-01-11T19:28:12.7042901Z                      
2026-01-11T19:28:12.7043851Z                      <#
2026-01-11T19:28:12.7044193Z                      .SYNOPSIS
2026-01-11T19:28:12.7045577Z                          Collects a lightweight hardware/OS summary for logging and UI output.
2026-01-11T19:28:12.7046223Z                      .DESCRIPTION
2026-01-11T19:28:12.7047057Z                          Queries CPU, total RAM, primary GPU, OS caption, and OS build using CIM.
2026-01-11T19:28:12.7047956Z                          This data is used for the console summary and for the post-setup checklist.
2026-01-11T19:28:12.7048619Z                      .OUTPUTS
2026-01-11T19:28:12.7049047Z                          [hashtable] with keys CPU, RAM, GPU, OS, Build.
2026-01-11T19:28:12.7049578Z                      .NOTES
2026-01-11T19:28:12.7050640Z                          Does not require admin privileges, but script overall does.
2026-01-11T19:28:12.7051484Z                      #>
2026-01-11T19:28:12.7052202Z                      function Get-SystemInfo {
2026-01-11T19:28:12.7052950Z                          $cpu = (Get-CimInstance Win32_Processor).Name
2026-01-11T19:28:12.7054313Z                          $totalRAM = [math]::Round((Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property 
2026-01-11T19:28:12.7055115Z                      Capacity -Sum).Sum / 1GB)
2026-01-11T19:28:12.7055755Z                          $gpu = (Get-CimInstance Win32_VideoController | Select-Object -First 1).Name
2026-01-11T19:28:12.7057045Z                          $os = (Get-CimInstance Win32_OperatingSystem).Caption
2026-01-11T19:28:12.7057682Z                          $build = (Get-CimInstance Win32_OperatingSystem).BuildNumber
2026-01-11T19:28:12.7058198Z                      
2026-01-11T19:28:12.7058474Z                          return @{
2026-01-11T19:28:12.7058825Z                              CPU = $cpu
2026-01-11T19:28:12.7059544Z                              RAM = "${totalRAM}GB"
2026-01-11T19:28:12.7060066Z                              GPU = $gpu
2026-01-11T19:28:12.7061199Z                              OS = $os
2026-01-11T19:28:12.7061598Z                              Build = $build
2026-01-11T19:28:12.7062707Z                          }
2026-01-11T19:28:12.7063031Z                      }
2026-01-11T19:28:12.7064068Z                      
2026-01-11T19:28:12.7064390Z                      $sysInfo = Get-SystemInfo
2026-01-11T19:28:12.7065251Z                      
2026-01-11T19:28:12.7065828Z                      Write-Host "System Information:" -ForegroundColor Cyan
2026-01-11T19:28:12.7067283Z                      Write-Host "  CPU:   $($sysInfo.CPU)" -ForegroundColor White
2026-01-11T19:28:12.7068115Z                      Write-Host "  RAM:   $($sysInfo.RAM)" -ForegroundColor White
2026-01-11T19:28:12.7069061Z                      Write-Host "  GPU:   $($sysInfo.GPU)" -ForegroundColor White
2026-01-11T19:28:12.7069983Z                      Write-Host "  OS:    $($sysInfo.OS) (Build $($sysInfo.Build))" -ForegroundColor White
2026-01-11T19:28:12.7070661Z                      Write-Host ""
2026-01-11T19:28:12.7071010Z                      
2026-01-11T19:28:12.7071861Z                      Write-Log "System: $($sysInfo.CPU) | $($sysInfo.RAM) | $($sysInfo.GPU)" "INFO"
2026-01-11T19:28:12.7072487Z                      
2026-01-11T19:28:12.7072906Z                      
2026-01-11T19:28:12.7073853Z                      
2026-01-11T19:28:12.7074289Z                      # Ordered list of optimization sections to execute.
2026-01-11T19:28:12.7074981Z                      $sections = @(
2026-01-11T19:28:12.7076026Z                          @{
2026-01-11T19:28:12.7076619Z                              Name = "AMD X3D Optimizations"
2026-01-11T19:28:12.7077695Z                              Function = "Invoke-X3DOptimizations"
2026-01-11T19:28:12.7078297Z                              TestFunction = "Test-X3DOptimizations"
2026-01-11T19:28:12.7078831Z                              Condition = { Test-X3DCpu }
2026-01-11T19:28:12.7079888Z                              Weight = 5
2026-01-11T19:28:12.7080630Z                              Description = "CPPC enabled, Game Bar detection enabled, overlays disabled"
2026-01-11T19:28:12.7081607Z                          },
2026-01-11T19:28:12.7082241Z                          @{
2026-01-11T19:28:12.7083260Z                              Name = "System Optimizations"
2026-01-11T19:28:12.7083955Z                              Function = "Invoke-SystemOptimizations"
2026-01-11T19:28:12.7085514Z                              TestFunction = "Test-SystemOptimizations"
2026-01-11T19:28:12.7087298Z                              Condition = $null
2026-01-11T19:28:12.7087660Z                              Weight = 10
2026-01-11T19:28:12.7088285Z                              Description = "Page file, fast startup off, classic context menu, Storage Sense off, 
2026-01-11T19:28:12.7089001Z                      display performance, End Task in taskbar, Explorer cleanup"
2026-01-11T19:28:12.7090313Z                          },
2026-01-11T19:28:12.7091178Z                          @{
2026-01-11T19:28:12.7092155Z                              Name = "Performance Optimizations"
2026-01-11T19:28:12.7092645Z                              Function = "Invoke-PerformanceOptimizations"
2026-01-11T19:28:12.7093821Z                              TestFunction = "Test-PerformanceOptimizations"
2026-01-11T19:28:12.7094406Z                              Condition = $null
2026-01-11T19:28:12.7094853Z                              Weight = 15
2026-01-11T19:28:12.7096136Z                              Description = "GameDVR/FSO off, MSI mode, scheduler, timer resolution, MMCSS gaming 
2026-01-11T19:28:12.7096949Z                      tweaks, Game Mode"
2026-01-11T19:28:12.7097334Z                          },
2026-01-11T19:28:12.7097739Z                          @{
2026-01-11T19:28:12.7098668Z                              Name = "Power Optimizations"
2026-01-11T19:28:12.7099881Z                              Function = "Invoke-PowerOptimizations"
2026-01-11T19:28:12.7100791Z                              TestFunction = "Test-PowerOptimizations"
2026-01-11T19:28:12.7101351Z                              Condition = $null
2026-01-11T19:28:12.7101772Z                              Weight = 10
2026-01-11T19:28:12.7102436Z                              Description = "High performance plan, PCIe/USB power mgmt, 5% min processor state"
2026-01-11T19:28:12.7102883Z                          },
2026-01-11T19:28:12.7103823Z                          @{
2026-01-11T19:28:12.7104641Z                              Name = "Network Optimizations"
2026-01-11T19:28:12.7105120Z                              Function = "Invoke-NetworkOptimizations"
2026-01-11T19:28:12.7106166Z                              TestFunction = "Test-NetworkOptimizations"
2026-01-11T19:28:12.7106660Z                              Condition = $null
2026-01-11T19:28:12.7107852Z                              Weight = 10
2026-01-11T19:28:12.7109171Z                              Description = "DNS provider, RSS enabled, adapter advanced properties (Interrupt 
2026-01-11T19:28:12.7110184Z                      Moderation, Flow Control, EEE), IPv4 prefer/Teredo toggle, QoS opt-in"
2026-01-11T19:28:12.7110923Z                          },
2026-01-11T19:28:12.7111098Z                          @{
2026-01-11T19:28:12.7111478Z                              Name = "Peripheral Optimizations"
2026-01-11T19:28:12.7112717Z                              Function = "Invoke-PeripheralOptimizations"
2026-01-11T19:28:12.7113169Z                              TestFunction = "Test-MouseAcceleration"
2026-01-11T19:28:12.7114202Z                              Condition = $null
2026-01-11T19:28:12.7114629Z                              Weight = 5
2026-01-11T19:28:12.7115847Z                              Description = "Mouse acceleration disabled (Enhance pointer precision off)"
2026-01-11T19:28:12.7116348Z                          },
2026-01-11T19:28:12.7117210Z                          @{
2026-01-11T19:28:12.7118188Z                              Name = "Browser Optimizations"
2026-01-11T19:28:12.7118639Z                              Function = "Invoke-BrowserOptimizations"
2026-01-11T19:28:12.7119736Z                              TestFunction = "Test-BrowserBackgroundApps"
2026-01-11T19:28:12.7120149Z                              Condition = $null
2026-01-11T19:28:12.7121174Z                              Weight = 5
2026-01-11T19:28:12.7122247Z                              Description = "Chrome/Edge background apps disabled, Edge startup boost disabled"
2026-01-11T19:28:12.7123146Z                          },
2026-01-11T19:28:12.7123535Z                          @{
2026-01-11T19:28:12.7123908Z                              Name = "Audio Optimizations"
2026-01-11T19:28:12.7124606Z                              Function = "Invoke-AudioOptimizations"
2026-01-11T19:28:12.7125186Z                              TestFunction = "Test-AudioOptimizations"
2026-01-11T19:28:12.7126275Z                              Condition = $null
2026-01-11T19:28:12.7126833Z                              Weight = 10
2026-01-11T19:28:12.7128511Z                              Description = "Audio enhancements disabled, driver power mgmt disabled"
2026-01-11T19:28:12.7129426Z                          },
2026-01-11T19:28:12.7129850Z                          @{
2026-01-11T19:28:12.7130801Z                              Name = "GPU Optimizations"
2026-01-11T19:28:12.7131853Z                              Function = "Invoke-GPUOptimizations"
2026-01-11T19:28:12.7132365Z                              TestFunction = "Test-GPUOptimizations"
2026-01-11T19:28:12.7133553Z                              Condition = $null
2026-01-11T19:28:12.7133980Z                              Weight = 10
2026-01-11T19:28:12.7135151Z                              Description = "HAGS disabled (opt-in), vendor-specific tweaks"
2026-01-11T19:28:12.7135743Z                          },
2026-01-11T19:28:12.7136649Z                          @{
2026-01-11T19:28:12.7137225Z                              Name = "Privacy Optimizations"
2026-01-11T19:28:12.7138416Z                              Function = "Invoke-PrivacyOptimizations"
2026-01-11T19:28:12.7138963Z                              TestFunction = "Test-PrivacyOptimizations"
2026-01-11T19:28:12.7140132Z                              Condition = $null
2026-01-11T19:28:12.7140585Z                              Weight = 15
2026-01-11T19:28:12.7142140Z                              Description = "Telemetry reduced, notifications off, WPBT blocked, PS7 telemetry off, 
2026-01-11T19:28:12.7143056Z                      background apps off, Edge debloat, Copilot disable"
2026-01-11T19:28:12.7143576Z                          },
2026-01-11T19:28:12.7144403Z                          @{
2026-01-11T19:28:12.7145262Z                              Name = "Software Installation"
2026-01-11T19:28:12.7145706Z                              Function = "Invoke-SoftwareInstallation"
2026-01-11T19:28:12.7146770Z                              TestFunction = $null
2026-01-11T19:28:12.7147972Z                              Condition = $null
2026-01-11T19:28:12.7148440Z                              Weight = 15
2026-01-11T19:28:12.7149688Z                              Description = "Essential + recommended packages, peripheral software"
2026-01-11T19:28:12.7150073Z                          }
2026-01-11T19:28:12.7151065Z                      )
2026-01-11T19:28:12.7151814Z                      
2026-01-11T19:28:12.7152637Z                      $totalWeight = 0
2026-01-11T19:28:12.7153097Z                      foreach ($section in $sections) {
2026-01-11T19:28:12.7154165Z                          $totalWeight += $section.Weight
2026-01-11T19:28:12.7154574Z                      }
2026-01-11T19:28:12.7155605Z                      $completedWeight = 0
2026-01-11T19:28:12.7156333Z                      
2026-01-11T19:28:12.7157118Z                      
2026-01-11T19:28:12.7157858Z                      
2026-01-11T19:28:12.7158951Z                      Write-Host "The following optimizations will be applied:" -ForegroundColor Yellow
2026-01-11T19:28:12.7159905Z                      Write-Host ""
2026-01-11T19:28:12.7160289Z                      
2026-01-11T19:28:12.7160872Z                      foreach ($section in $sections) {
2026-01-11T19:28:12.7161947Z                          if ($section.Condition) {
2026-01-11T19:28:12.7162428Z                              if (-not (& $section.Condition)) {
2026-01-11T19:28:12.7163640Z                                  Write-Host "  [SKIP] $($section.Name) (condition not met)" -ForegroundColor Gray
2026-01-11T19:28:12.7164465Z                                  continue
2026-01-11T19:28:12.7164844Z                              }
2026-01-11T19:28:12.7165668Z                          }
2026-01-11T19:28:12.7166124Z                      
2026-01-11T19:28:12.7167331Z                          Write-Host "  [X] $($section.Name)" -ForegroundColor Green
2026-01-11T19:28:12.7168231Z                          Write-Host "      $($section.Description)" -ForegroundColor Gray
2026-01-11T19:28:12.7168798Z                      }
2026-01-11T19:28:12.7169795Z                      
2026-01-11T19:28:12.7170592Z                      Write-Host ""
2026-01-11T19:28:12.7171363Z                      Write-Host "SmartScreen and Windows Update remain ENABLED (security)" -ForegroundColor Yellow
2026-01-11T19:28:12.7171826Z                      Write-Host ""
2026-01-11T19:28:12.7172946Z                      
2026-01-11T19:28:12.7173849Z                      if (-not $DryRun -and -not $SkipConfirmation) {
2026-01-11T19:28:12.7174395Z                          $confirm = (Read-Host "Apply these optimizations? (Y/N)").Trim()
2026-01-11T19:28:12.7175472Z                          if ($confirm -notmatch '^(?i:y|yes)$') {
2026-01-11T19:28:12.7175939Z                              Write-Log "User cancelled script" "INFO"
2026-01-11T19:28:12.7177544Z                              Write-Host "Script cancelled by user" -ForegroundColor Yellow
2026-01-11T19:28:12.7178238Z                              exit 0
2026-01-11T19:28:12.7178762Z                          }
2026-01-11T19:28:12.7179774Z                      }
2026-01-11T19:28:12.7180609Z                      
2026-01-11T19:28:12.7181402Z                      Write-Host ""
2026-01-11T19:28:12.7181951Z                      Write-Host "Starting optimizations..." -ForegroundColor Cyan
2026-01-11T19:28:12.7182951Z                      Write-Host ""
2026-01-11T19:28:12.7183409Z                      
2026-01-11T19:28:12.7185544Z                      # Create a restore point before making any changes (safety feature).
2026-01-11T19:28:12.7185911Z                      if (-not $DryRun) {
2026-01-11T19:28:12.7186777Z                          Write-Host "Creating System Restore Point..." -ForegroundColor Yellow
2026-01-11T19:28:12.7188053Z                          New-RestorePoint -Description "Pre-Gaming-PC-Setup-$(Get-Date -Format 'yyyyMMdd-HHmm')"
2026-01-11T19:28:12.7188580Z                          Write-Host ""
2026-01-11T19:28:12.7188793Z                      }
2026-01-11T19:28:12.7189142Z                      
2026-01-11T19:28:12.7189305Z                      
2026-01-11T19:28:12.7189653Z                      
2026-01-11T19:28:12.7190724Z                      foreach ($section in $sections) {
2026-01-11T19:28:12.7191595Z                          if ($section.Condition) {
2026-01-11T19:28:12.7192095Z                              if (-not (& $section.Condition)) {
2026-01-11T19:28:12.7193267Z                                  Write-Log "Skipping $($section.Name) (condition not met)" "INFO"
2026-01-11T19:28:12.7193636Z                                  continue
2026-01-11T19:28:12.7194673Z                              }
2026-01-11T19:28:12.7195124Z                          }
2026-01-11T19:28:12.7196155Z                      
2026-01-11T19:28:12.7197113Z                          $progressPercent = [int](($completedWeight / $totalWeight) * 100)
2026-01-11T19:28:12.7197923Z                          Write-Progress -Activity "Gaming PC Setup" -Status $section.Name -PercentComplete 
2026-01-11T19:28:12.7198925Z                      $progressPercent
2026-01-11T19:28:12.7199267Z                      
2026-01-11T19:28:12.7199530Z                          Write-Log "=== $($section.Name) ===" "INFO"
2026-01-11T19:28:12.7200843Z                          Write-Host "[$progressPercent%] $($section.Name)..." -ForegroundColor Cyan
2026-01-11T19:28:12.7201554Z                      
2026-01-11T19:28:12.7202487Z                          try {
2026-01-11T19:28:12.7202837Z                              if ($DryRun) {
2026-01-11T19:28:12.7204475Z                                  Write-Log "DRY RUN: Would execute $($section.Function)" "INFO"
2026-01-11T19:28:12.7206144Z                                  Write-Host "  DRY RUN: Would apply optimizations" -ForegroundColor Yellow
2026-01-11T19:28:12.7207329Z                              } else {
2026-01-11T19:28:12.7207598Z                                  & $section.Function
2026-01-11T19:28:12.7207823Z                      
2026-01-11T19:28:12.7208282Z                                  if ($section.TestFunction) {
2026-01-11T19:28:12.7209995Z                                      Write-Log "Verifying $($section.Name)..." "INFO"
2026-01-11T19:28:12.7210624Z                                      $testResult = & $section.TestFunction
2026-01-11T19:28:12.7211622Z                                      if ($testResult) {
2026-01-11T19:28:12.7213027Z                                          Write-Log "$($section.Name) verification: PASSED" "SUCCESS"
2026-01-11T19:28:12.7214018Z                                      } else {
2026-01-11T19:28:12.7215031Z                                          Write-Log "$($section.Name) verification: FAILED (review above logs)" "ERROR"
2026-01-11T19:28:12.7215769Z                                      }
2026-01-11T19:28:12.7216535Z                                  }
2026-01-11T19:28:12.7218006Z                              }
2026-01-11T19:28:12.7218354Z                      
2026-01-11T19:28:12.7219654Z                              $completedWeight += $section.Weight
2026-01-11T19:28:12.7220016Z                      
2026-01-11T19:28:12.7221031Z                          } catch {
2026-01-11T19:28:12.7222016Z                              Write-Log "Error in $($section.Name): $_" "ERROR"
2026-01-11T19:28:12.7222502Z                              Write-Host "  ERROR: $($_.Exception.Message)" -ForegroundColor Red
2026-01-11T19:28:12.7223450Z                          }
2026-01-11T19:28:12.7224173Z                      
2026-01-11T19:28:12.7225146Z                          Write-Host ""
2026-01-11T19:28:12.7226151Z                      }
2026-01-11T19:28:12.7226961Z                      
2026-01-11T19:28:12.7227956Z                      Write-Progress -Activity "Gaming PC Setup" -Completed
2026-01-11T19:28:12.7228302Z                      
2026-01-11T19:28:12.7229309Z                      
2026-01-11T19:28:12.7230052Z                      
2026-01-11T19:28:12.7230514Z                      if (-not $DryRun) {
2026-01-11T19:28:12.7231642Z                          $checklistPath = Join-Path $ScriptRoot "POST-SETUP-CHECKLIST.txt"
2026-01-11T19:28:12.7232424Z                      
2026-01-11T19:28:12.7233285Z                          # The checklist is a human-focused, post-setup reminder sheet.
2026-01-11T19:28:12.7234147Z                          $checklistContent = @"
2026-01-11T19:28:12.7235075Z                      ================================================================================
2026-01-11T19:28:12.7235865Z                          GAMING PC SETUP - POST-INSTALLATION CHECKLIST
2026-01-11T19:28:12.7236742Z                      ================================================================================
2026-01-11T19:28:12.7237379Z                      
2026-01-11T19:28:12.7238270Z                      Completed: $(Get-Date -Format "yyyy-MM-dd HH:mm:ss")
2026-01-11T19:28:12.7239044Z                      System: $($sysInfo.CPU) | $($sysInfo.RAM) | $($sysInfo.GPU)
2026-01-11T19:28:12.7239645Z                      
2026-01-11T19:28:12.7240585Z                      ================================================================================
2026-01-11T19:28:12.7241329Z                          REBOOT REQUIRED
2026-01-11T19:28:12.7242180Z                      ================================================================================
2026-01-11T19:28:12.7242789Z                      
2026-01-11T19:28:12.7243629Z                      [X] REBOOT YOUR SYSTEM NOW
2026-01-11T19:28:12.7244505Z                          - HPET, MSI Mode, and power changes require a restart
2026-01-11T19:28:12.7245313Z                          - Page file changes require a restart
2026-01-11T19:28:12.7246293Z                      
2026-01-11T19:28:12.7247084Z                      ================================================================================
2026-01-11T19:28:12.7247269Z                          BEFORE GAMING - TIMER TOOL
2026-01-11T19:28:12.7248255Z                      ================================================================================
2026-01-11T19:28:12.7248985Z                      
2026-01-11T19:28:12.7249881Z                      [X] Run timer-tool.ps1 BEFORE starting any game
2026-01-11T19:28:12.7250575Z                      
2026-01-11T19:28:12.7251403Z                          Command:
2026-01-11T19:28:12.7252190Z                          .\timer-tool.ps1
2026-01-11T19:28:12.7252964Z                      
2026-01-11T19:28:12.7253778Z                          OR (auto-exit when game closes):
2026-01-11T19:28:12.7254560Z                          .\timer-tool.ps1 -GameProcess "dota2"
2026-01-11T19:28:12.7255303Z                          .\timer-tool.ps1 -GameProcess "cs2"
2026-01-11T19:28:12.7255978Z                      
2026-01-11T19:28:12.7257010Z                          What it does:
2026-01-11T19:28:12.7257369Z                          - Sets Windows timer resolution to 0.5ms (from 15.6ms default)
2026-01-11T19:28:12.7258478Z                          - Eliminates micro-stutters and improves frame pacing
2026-01-11T19:28:12.7259166Z                          - MUST be running during gameplay
2026-01-11T19:28:12.7260601Z                          - Press Ctrl+C when done gaming
2026-01-11T19:28:12.7260699Z                      
2026-01-11T19:28:12.7261144Z                      ================================================================================
2026-01-11T19:28:12.7262286Z                          GPU DRIVER SETTINGS (MANUAL CONFIGURATION)
2026-01-11T19:28:12.7262852Z                      ================================================================================
2026-01-11T19:28:12.7263617Z                      
2026-01-11T19:28:12.7264396Z                      NVIDIA Control Panel (if you have NVIDIA GPU):
2026-01-11T19:28:12.7265728Z                      --------------------------------------------
2026-01-11T19:28:12.7266131Z                      1. Open NVIDIA Control Panel
2026-01-11T19:28:12.7267336Z                      2. Manage 3D Settings > Global Settings:
2026-01-11T19:28:12.7267900Z                         [X] Power management mode: Prefer maximum performance
2026-01-11T19:28:12.7268932Z                         [X] Low latency mode: Ultra (or On)
2026-01-11T19:28:12.7269755Z                         [X] Vertical sync: Off (or Fast if you have G-Sync)
2026-01-11T19:28:12.7270591Z                         [X] Texture filtering - Quality: High performance
2026-01-11T19:28:12.7271276Z                         [X] Shader Cache: On
2026-01-11T19:28:12.7271952Z                      
2026-01-11T19:28:12.7272873Z                      AMD Radeon Software (if you have AMD GPU):
2026-01-11T19:28:12.7273645Z                      ------------------------------------------
2026-01-11T19:28:12.7274444Z                      1. Open AMD Radeon Software
2026-01-11T19:28:12.7275178Z                      2. Gaming > Global Graphics:
2026-01-11T19:28:12.7275959Z                         [X] Radeon Anti-Lag: On
2026-01-11T19:28:12.7276757Z                         [X] Radeon Boost: On (if supported)
2026-01-11T19:28:12.7277492Z                         [X] Wait for Vertical Refresh: Off
2026-01-11T19:28:12.7278278Z                         [X] Texture Filtering Quality: Performance
2026-01-11T19:28:12.7279125Z                         [X] Radeon Image Sharpening: 80% (optional)
2026-01-11T19:28:12.7279777Z                      
2026-01-11T19:28:12.7280598Z                      ================================================================================
2026-01-11T19:28:12.7281486Z                          GAME-SPECIFIC LAUNCH OPTIONS
2026-01-11T19:28:12.7282353Z                      ================================================================================
2026-01-11T19:28:12.7282909Z                      
2026-01-11T19:28:12.7283679Z                      Steam Games:
2026-01-11T19:28:12.7284504Z                      -----------
2026-01-11T19:28:12.7285010Z                      Right-click game > Properties > General > Launch Options
2026-01-11T19:28:12.7285876Z                      
2026-01-11T19:28:12.7286941Z                      Dota 2:
2026-01-11T19:28:12.7287875Z                          -dx11 -high -nojoy -console +fps_max 0
2026-01-11T19:28:12.7288579Z                      
2026-01-11T19:28:12.7289423Z                      CS2 (Counter-Strike 2):
2026-01-11T19:28:12.7290299Z                          -high -freq 240 -refresh 240 +fps_max 0 -nojoy
2026-01-11T19:28:12.7290934Z                      
2026-01-11T19:28:12.7291744Z                      Helldivers 2:
2026-01-11T19:28:12.7292525Z                          -dx11 -high
2026-01-11T19:28:12.7293216Z                      
2026-01-11T19:28:12.7294081Z                      General recommendations:
2026-01-11T19:28:12.7295675Z                          -high           (High CPU priority)
2026-01-11T19:28:12.7296013Z                          -nojoy          (Disable joystick support, reduces input latency)
2026-01-11T19:28:12.7296560Z                          -freq 240       (Match your monitor refresh rate)
2026-01-11T19:28:12.7297281Z                          +fps_max 0      (Unlimited FPS)
2026-01-11T19:28:12.7297986Z                      
2026-01-11T19:28:12.7298889Z                      ================================================================================
2026-01-11T19:28:12.7299549Z                          SOFTWARE POST-CONFIGURATION
2026-01-11T19:28:12.7300395Z                      ================================================================================
2026-01-11T19:28:12.7301087Z                      
2026-01-11T19:28:12.7301907Z                      Spotify (if installed):
2026-01-11T19:28:12.7302757Z                      -----------------------
2026-01-11T19:28:12.7303591Z                      [X] Disable auto-start on boot:
2026-01-11T19:28:12.7304588Z                          Settings > Show Advanced Settings > Startup and Window Behaviour
2026-01-11T19:28:12.7305543Z                          > Open Spotify automatically after you log into the computer: OFF
2026-01-11T19:28:12.7306536Z                      
2026-01-11T19:28:12.7307557Z                      [X] Set audio quality to "Very High":
2026-01-11T19:28:12.7308445Z                          Settings > Audio Quality > Streaming quality: Very High
2026-01-11T19:28:12.7309147Z                      
2026-01-11T19:28:12.7310009Z                      qBittorrent (if installed):
2026-01-11T19:28:12.7310748Z                      ---------------------------
2026-01-11T19:28:12.7311515Z                      [X] Install search plugins:
2026-01-11T19:28:12.7312285Z                          View > Search Engine > Search plugins...
2026-01-11T19:28:12.7313083Z                          Install popular plugins (ThePirateBay, 1337x, etc.)
2026-01-11T19:28:12.7313677Z                      
2026-01-11T19:28:12.7314463Z                      [X] Set download location:
2026-01-11T19:28:12.7315281Z                          Tools > Options > Downloads > Default save path
2026-01-11T19:28:12.7315929Z                      
2026-01-11T19:28:12.7316700Z                      Discord:
2026-01-11T19:28:12.7317451Z                      --------
2026-01-11T19:28:12.7318360Z                      [X] Disable hardware acceleration if you experience stutters:
2026-01-11T19:28:12.7319059Z                          Settings > Advanced > Hardware Acceleration: OFF
2026-01-11T19:28:12.7319683Z                      
2026-01-11T19:28:12.7320469Z                      [X] Reduce CPU usage:
2026-01-11T19:28:12.7321224Z                          Settings > Voice & Video > Video Codec: H.264
2026-01-11T19:28:12.7322027Z                      
2026-01-11T19:28:12.7322850Z                      Philips Hue Sync (if installed):
2026-01-11T19:28:12.7323683Z                      --------------------------------
2026-01-11T19:28:12.7324549Z                      [X] Close before gaming if you experience stutters
2026-01-11T19:28:12.7325267Z                          RGB software can cause DPC latency issues
2026-01-11T19:28:12.7325721Z                      
2026-01-11T19:28:12.7326862Z                      Logitech G HUB / Razer Synapse / Corsair iCUE:
2026-01-11T19:28:12.7327774Z                      ----------------------------------------------
2026-01-11T19:28:12.7328887Z                      [X] Configure your devices, then close the software before gaming
2026-01-11T19:28:12.7329643Z                          Peripheral software is a common source of DPC latency
2026-01-11T19:28:12.7330458Z                          Settings are saved to device memory
2026-01-11T19:28:12.7331167Z                      
2026-01-11T19:28:12.7332051Z                      ================================================================================
2026-01-11T19:28:12.7333080Z                          AMD RYZEN X3D USERS (7900X3D / 7950X3D / 9800X3D)
2026-01-11T19:28:12.7333341Z                      ================================================================================
2026-01-11T19:28:12.7334341Z                      
2026-01-11T19:28:12.7335101Z                      BIOS Settings:
2026-01-11T19:28:12.7335917Z                      ------------------------
2026-01-11T19:28:12.7336815Z                      [X] CPPC (Collaborative Processor Performance Control): ENABLED or AUTO/DRIVER
2026-01-11T19:28:12.7337811Z                          - DO NOT DISABLE (required for AMD 3D V-Cache Performance Optimizer)
2026-01-11T19:28:12.7338497Z                      
2026-01-11T19:28:12.7339382Z                      [X] CPPC Preferred Cores: AUTO or DRIVER
2026-01-11T19:28:12.7340105Z                      
2026-01-11T19:28:12.7341000Z                      [X] AGESA: Update to 1.0.0.7+ or latest
2026-01-11T19:28:12.7341560Z                      
2026-01-11T19:28:12.7342752Z                      [X] EXPO/XMP: Enabled (for RAM)
2026-01-11T19:28:12.7344509Z                      
2026-01-11T19:28:12.7345187Z                      Drivers:
2026-01-11T19:28:12.7346038Z                      --------
2026-01-11T19:28:12.7346956Z                      [X] Install latest AMD Chipset Drivers:
2026-01-11T19:28:12.7347759Z                          https://www.amd.com/en/support
2026-01-11T19:28:12.7348483Z                      
2026-01-11T19:28:12.7349303Z                          Includes:
2026-01-11T19:28:12.7350182Z                          - AMD 3D V-Cache Performance Optimizer
2026-01-11T19:28:12.7350895Z                          - PPM Provisioning File Driver
2026-01-11T19:28:12.7351662Z                          - Required for proper X3D thread steering
2026-01-11T19:28:12.7352297Z                      
2026-01-11T19:28:12.7353079Z                      Verification:
2026-01-11T19:28:12.7353816Z                      -------------
2026-01-11T19:28:12.7354683Z                      [X] After reboot, verify in Device Manager:
2026-01-11T19:28:12.7355433Z                          System Devices > Look for:
2026-01-11T19:28:12.7356283Z                          - "AMD 3D V-Cache Performance Optimizer"
2026-01-11T19:28:12.7357025Z                          - "AMD PPM Provisioning File Driver"
2026-01-11T19:28:12.7357668Z                      
2026-01-11T19:28:12.7358511Z                          If missing, reinstall AMD Chipset Drivers
2026-01-11T19:28:12.7359168Z                      
2026-01-11T19:28:12.7360056Z                      ================================================================================
2026-01-11T19:28:12.7360694Z                          TROUBLESHOOTING
2026-01-11T19:28:12.7361519Z                      ================================================================================
2026-01-11T19:28:12.7362352Z                      
2026-01-11T19:28:12.7363192Z                      Still getting micro-stutters?
2026-01-11T19:28:12.7364041Z                      -----------------------------
2026-01-11T19:28:12.7365223Z                      1. [X] Download LatencyMon: https://www.resplendence.com/latencymon
2026-01-11T19:28:12.7365587Z                         - Identifies drivers causing DPC latency
2026-01-11T19:28:12.7366733Z                         - Run for 5 minutes while gaming
2026-01-11T19:28:12.7367445Z                      
2026-01-11T19:28:12.7368245Z                      2. [X] Update audio drivers (most common DPC latency source)
2026-01-11T19:28:12.7369148Z                         - Visit motherboard manufacturer website
2026-01-11T19:28:12.7370000Z                         - Download latest audio drivers
2026-01-11T19:28:12.7370686Z                      
2026-01-11T19:28:12.7371596Z                      3. [X] Close RGB software (iCUE, Razer Synapse, G HUB)
2026-01-11T19:28:12.7372296Z                         - Major source of DPC latency
2026-01-11T19:28:12.7373378Z                      
2026-01-11T19:28:12.7374126Z                      4. [X] Toggle GPU Scheduling:
2026-01-11T19:28:12.7375488Z                         - Settings > System > Display > Graphics > Hardware-accelerated GPU scheduling
2026-01-11T19:28:12.7375730Z                         - Try both ON and OFF, benchmark both
2026-01-11T19:28:12.7376814Z                      
2026-01-11T19:28:12.7377642Z                      5. [X] Verify timer tool is running:
2026-01-11T19:28:12.7378588Z                         - Must run timer-tool.ps1 before gaming
2026-01-11T19:28:12.7379558Z                      
2026-01-11T19:28:12.7380475Z                      Network still laggy?
2026-01-11T19:28:12.7381430Z                      -------------------
2026-01-11T19:28:12.7382270Z                      1. [X] Update network adapter drivers
2026-01-11T19:28:12.7383462Z                      2. [X] Check router QoS settings
2026-01-11T19:28:12.7384636Z                      3. [X] Try different DNS (script set Cloudflare 1.1.1.1)
2026-01-11T19:28:12.7386181Z                      4. [X] Test with ethernet (not WiFi)
2026-01-11T19:28:12.7386964Z                      
2026-01-11T19:28:12.7388144Z                      X3D performance inconsistent?
2026-01-11T19:28:12.7389055Z                      -----------------------------
2026-01-11T19:28:12.7389661Z                      1. [X] Verify CPPC is ENABLED in BIOS (not disabled)
2026-01-11T19:28:12.7390939Z                      2. [X] Install latest AMD Chipset Drivers
2026-01-11T19:28:12.7391903Z                      3. [X] Check Device Manager for 3D V-Cache optimizer driver
2026-01-11T19:28:12.7392844Z                      4. [X] Ensure Game Bar detection is enabled (script keeps it on)
2026-01-11T19:28:12.7393700Z                      
2026-01-11T19:28:12.7394822Z                      ================================================================================
2026-01-11T19:28:12.7395648Z                          BENCHMARKING & VALIDATION
2026-01-11T19:28:12.7396720Z                      ================================================================================
2026-01-11T19:28:12.7397359Z                      
2026-01-11T19:28:12.7398293Z                      Before/After Testing:
2026-01-11T19:28:12.7399094Z                      --------------------
2026-01-11T19:28:12.7400148Z                      [X] Run benchmarks before and after optimizations:
2026-01-11T19:28:12.7400849Z                          - 3DMark Time Spy
2026-01-11T19:28:12.7401637Z                          - In-game benchmarks
2026-01-11T19:28:12.7402487Z                          - Focus on 1% Low FPS (more important than average)
2026-01-11T19:28:12.7403084Z                      
2026-01-11T19:28:12.7404889Z                      [X] Monitor frame times:
2026-01-11T19:28:12.7405197Z                          - Use MSI Afterburner + RivaTuner Statistics Server
2026-01-11T19:28:12.7405482Z                          - Look for frame time consistency (lower variance = smoother)
2026-01-11T19:28:12.7405651Z                      
2026-01-11T19:28:12.7406079Z                      Performance Monitoring:
2026-01-11T19:28:12.7406752Z                      ----------------------
2026-01-11T19:28:12.7407484Z                      [X] HWiNFO64: https://www.hwinfo.com/
2026-01-11T19:28:12.7408346Z                          - Monitor CPU/GPU temps, clocks, power
2026-01-11T19:28:12.7409109Z                          - Check for thermal throttling
2026-01-11T19:28:12.7409865Z                      
2026-01-11T19:28:12.7410696Z                      [X] CapFrameX: https://www.capframex.com/
2026-01-11T19:28:12.7411466Z                          - Advanced frame time analysis
2026-01-11T19:28:12.7412239Z                          - 1% Low and 0.1% Low FPS tracking
2026-01-11T19:28:12.7412896Z                      
2026-01-11T19:28:12.7413808Z                      ================================================================================
2026-01-11T19:28:12.7414477Z                          ADDITIONAL RESOURCES
2026-01-11T19:28:12.7415527Z                      ================================================================================
2026-01-11T19:28:12.7415680Z                      
2026-01-11T19:28:12.7416750Z                      Drivers:
2026-01-11T19:28:12.7417500Z                      --------
2026-01-11T19:28:12.7418472Z                      - AMD Chipset Drivers: https://www.amd.com/en/support
2026-01-11T19:28:12.7419299Z                      - NVIDIA Drivers: https://www.nvidia.com/Download/index.aspx
2026-01-11T19:28:12.7420109Z                      - Intel Drivers: https://www.intel.com/content/www/us/en/support.html
2026-01-11T19:28:12.7420350Z                      
2026-01-11T19:28:12.7421422Z                      Tools:
2026-01-11T19:28:12.7422177Z                      ------
2026-01-11T19:28:12.7423117Z                      - LatencyMon: https://www.resplendence.com/latencymon
2026-01-11T19:28:12.7424034Z                      - HWiNFO64: https://www.hwinfo.com/
2026-01-11T19:28:12.7424319Z                      - MSI Afterburner: https://www.msi.com/Landing/afterburner
2026-01-11T19:28:12.7425673Z                      - CapFrameX: https://www.capframex.com/
2026-01-11T19:28:12.7426342Z                      
2026-01-11T19:28:12.7427165Z                      Support:
2026-01-11T19:28:12.7427600Z                      --------
2026-01-11T19:28:12.7428672Z                      - Log file: $logPath
2026-01-11T19:28:12.7429651Z                      - GitHub Issues: https://github.com/thepedroferrari/gaming-pc-setup/issues
2026-01-11T19:28:12.7430298Z                      
2026-01-11T19:28:12.7431237Z                      ================================================================================
2026-01-11T19:28:12.7431978Z                          DONE! ENJOY YOUR OPTIMIZED GAMING PC
2026-01-11T19:28:12.7432816Z                      ================================================================================
2026-01-11T19:28:12.7433497Z                      
2026-01-11T19:28:12.7434229Z                      Remember:
2026-01-11T19:28:12.7435147Z                      1. REBOOT NOW
2026-01-11T19:28:12.7436035Z                      2. Run timer-tool.ps1 BEFORE gaming
2026-01-11T19:28:12.7436883Z                      3. Configure GPU driver settings manually
2026-01-11T19:28:12.7437607Z                      
2026-01-11T19:28:12.7438667Z                      Happy gaming! üéÆ
2026-01-11T19:28:12.7438830Z                      
2026-01-11T19:28:12.7439870Z                      "@
2026-01-11T19:28:12.7440631Z                      
2026-01-11T19:28:12.7441586Z                          Set-Content -Path $checklistPath -Value $checklistContent -Encoding UTF8
2026-01-11T19:28:12.7442072Z                          Write-Log "Post-setup checklist created: $checklistPath" "SUCCESS"
2026-01-11T19:28:12.7442897Z                      
2026-01-11T19:28:12.7443844Z                          Start-Process "notepad.exe" -ArgumentList $checklistPath
2026-01-11T19:28:12.7444730Z                      }
2026-01-11T19:28:12.7445709Z                      
2026-01-11T19:28:12.7446522Z                      
2026-01-11T19:28:12.7447246Z                      
2026-01-11T19:28:12.7448005Z                      Write-Host ""
2026-01-11T19:28:12.7448943Z                      Write-Host "=== Gaming PC Setup Complete ===" -ForegroundColor Green
2026-01-11T19:28:12.7449189Z                      Write-Host ""
2026-01-11T19:28:12.7450259Z                      
2026-01-11T19:28:12.7451044Z                      if (-not $DryRun) {
2026-01-11T19:28:12.7451920Z                          Write-Host "Next steps:" -ForegroundColor Yellow
2026-01-11T19:28:12.7452664Z                          Write-Host "  1. REBOOT your system for changes to take effect" -ForegroundColor White
2026-01-11T19:28:12.7453717Z                          Write-Host "  2. Run timer-tool.ps1 during gameplay for optimal timer resolution" 
2026-01-11T19:28:12.7453991Z                      -ForegroundColor White
2026-01-11T19:28:12.7455615Z                          Write-Host "  3. Review POST-SETUP-CHECKLIST.txt (opening in notepad...)" -ForegroundColor 
2026-01-11T19:28:12.7455778Z                      White
2026-01-11T19:28:12.7456728Z                          Write-Host ""
2026-01-11T19:28:12.7457600Z                          Write-Host "Log file: $logPath" -ForegroundColor Cyan
2026-01-11T19:28:12.7458226Z                          Write-Host ""
2026-01-11T19:28:12.7458932Z                      
2026-01-11T19:28:12.7459728Z                          $summary = Get-LogSummary
2026-01-11T19:28:12.7460533Z                          Write-Host "Summary:" -ForegroundColor Cyan
2026-01-11T19:28:12.7461328Z                          Write-Host "  SUCCESS: $($summary.Success)" -ForegroundColor Green
2026-01-11T19:28:12.7461689Z                          Write-Host "  ERROR:   $($summary.Error)" -ForegroundColor Red
2026-01-11T19:28:12.7462745Z                          Write-Host "  INFO:    $($summary.Info)" -ForegroundColor Gray
2026-01-11T19:28:12.7463350Z                          Write-Host ""
2026-01-11T19:28:12.7464110Z                      
2026-01-11T19:28:12.7465299Z                          Write-Log "=== Gaming PC Setup Complete ===" "SUCCESS"
2026-01-11T19:28:12.7466319Z                          Write-Log "Summary: $($summary.Success) success, $($summary.Error) errors, $($summary.Info) 
2026-01-11T19:28:12.7466688Z                      info" "SUCCESS"
2026-01-11T19:28:12.7467569Z                      } else {
2026-01-11T19:28:12.7468506Z                          Write-Host "DRY RUN complete. No changes were applied." -ForegroundColor Yellow
2026-01-11T19:28:12.7469091Z                          Write-Host ""
2026-01-11T19:28:12.7469859Z                      }
2026-01-11T19:28:12.7470583Z                      
2026-01-11T19:28:12.7471494Z [32;1mParent             : [0m
2026-01-11T19:28:12.7471674Z 
2026-01-11T19:28:12.7534156Z [32;1mAttributes         : [0m{}
2026-01-11T19:28:12.7534440Z [32;1mUsingStatements    : [0m{}
2026-01-11T19:28:12.7535729Z [32;1mParamBlock         : [0mparam(
2026-01-11T19:28:12.7536698Z                          [ValidateSet("gamer", "pro_gamer", "streamer", "benchmarker")]
2026-01-11T19:28:12.7537072Z                          [string]$Preset,
2026-01-11T19:28:12.7538226Z                          [switch]$SkipConfirmation,
2026-01-11T19:28:12.7538974Z                          [switch]$DryRun
2026-01-11T19:28:12.7539695Z                      )
2026-01-11T19:28:12.7540659Z [32;1mBeginBlock         : [0m
2026-01-11T19:28:12.7541257Z [32;1mProcessBlock       : [0m
2026-01-11T19:28:12.7543969Z [32;1mEndBlock           : [0mparam(
2026-01-11T19:28:12.7544266Z                          [ValidateSet("gamer", "pro_gamer", "streamer", "benchmarker")]
2026-01-11T19:28:12.7545130Z                          [string]$Preset,
2026-01-11T19:28:12.7545928Z                          [switch]$SkipConfirmation,
2026-01-11T19:28:12.7546613Z                          [switch]$DryRun
2026-01-11T19:28:12.7547342Z                      )
2026-01-11T19:28:12.7548087Z                      
2026-01-11T19:28:12.7549260Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:12.7549384Z                      # OS DETECTION
2026-01-11T19:28:12.7550768Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:12.7551004Z                      
2026-01-11T19:28:12.7552294Z                      $script:WinBuild = [int](Get-CimInstance Win32_OperatingSystem).BuildNumber
2026-01-11T19:28:12.7553020Z                      $script:IsWin11 = $script:WinBuild -ge 22000
2026-01-11T19:28:12.7553924Z                      $script:IsWin11_24H2 = $script:WinBuild -ge 26100
2026-01-11T19:28:12.7554797Z                      $script:WinVersion = if ($script:IsWin11) { "Windows 11" } else { "Windows 10" }
2026-01-11T19:28:12.7554973Z                      
2026-01-11T19:28:12.7556032Z                      # IDs that only work on Windows 11
2026-01-11T19:28:12.7557220Z                      $script:Win11OnlyIds = @('18', '21', '22')
2026-01-11T19:28:12.7557384Z                      $script:Win11_24H2OnlyIds = @('86')
2026-01-11T19:28:12.7558391Z                      
2026-01-11T19:28:12.7559492Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:12.7559638Z                      # COUNTERS & STATE
2026-01-11T19:28:12.7561001Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:12.7561244Z                      
2026-01-11T19:28:12.7562356Z                      $script:SuccessCount = 0
2026-01-11T19:28:12.7562958Z                      $script:FailCount = 0
2026-01-11T19:28:12.7564350Z                      $script:WarningCount = 0
2026-01-11T19:28:12.7565122Z                      $script:ScanResults = @()
2026-01-11T19:28:12.7565879Z                      
2026-01-11T19:28:12.7567040Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:12.7567217Z                      # HELPER FUNCTIONS
2026-01-11T19:28:12.7568521Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:12.7568906Z                      
2026-01-11T19:28:12.7569896Z                      function Write-Banner {
2026-01-11T19:28:12.7570602Z                          Clear-Host
2026-01-11T19:28:12.7571397Z                          Write-Host @'
2026-01-11T19:28:12.7572103Z                      
2026-01-11T19:28:12.7572908Z                          ____             __   ______
2026-01-11T19:28:12.7574106Z                         / __ \____  _____/ /__/_  __/_  ______  ___
2026-01-11T19:28:12.7574843Z                        / /_/ / __ \/ ___/ //_/ / / / / / / __ \/ _ \
2026-01-11T19:28:12.7575572Z                       / _, _/ /_/ / /__/ ,<   / / / /_/ / / / /  __/
2026-01-11T19:28:12.7576358Z                      /_/ |_|\____/\___/_/|_| /_/  \__,_/_/ /_/\___/
2026-01-11T19:28:12.7577024Z                      
2026-01-11T19:28:12.7577844Z                              Windows Gaming Loadout Builder
2026-01-11T19:28:12.7578577Z                      '@ -ForegroundColor Magenta
2026-01-11T19:28:12.7579418Z                          Write-Host ""
2026-01-11T19:28:12.7580175Z                      }
2026-01-11T19:28:12.7580976Z                      
2026-01-11T19:28:12.7582101Z                      function Write-Step { param([string]$M) Write-Host "`n>> $M" -ForegroundColor Cyan }
2026-01-11T19:28:12.7583278Z                      function Write-OK { param([string]$M) $script:SuccessCount++; Write-Host "  [OK] $M" 
2026-01-11T19:28:12.7583492Z                      -ForegroundColor Green }
2026-01-11T19:28:12.7584560Z                      function Write-Fail { param([string]$M) $script:FailCount++; Write-Host "  [FAIL] $M" 
2026-01-11T19:28:12.7585316Z                      -ForegroundColor Red }
2026-01-11T19:28:12.7586428Z                      function Write-Warn { param([string]$M) $script:WarningCount++; Write-Host "  [!] $M" 
2026-01-11T19:28:12.7586649Z                      -ForegroundColor Yellow }
2026-01-11T19:28:12.7587676Z                      
2026-01-11T19:28:12.7588468Z                      function Set-Reg {
2026-01-11T19:28:12.7589499Z                          param([string]$Path, [string]$Name, $Value, [string]$Type = "DWORD", [switch]$PassThru)
2026-01-11T19:28:12.7589711Z                          $success = $false
2026-01-11T19:28:12.7590827Z                          try {
2026-01-11T19:28:12.7591877Z                              if (-not (Test-Path $Path)) { New-Item -Path $Path -Force | Out-Null }
2026-01-11T19:28:12.7592758Z                              $existing = Get-ItemProperty -Path $Path -Name $Name -EA SilentlyContinue
2026-01-11T19:28:12.7593033Z                              if ($null -eq $existing) {
2026-01-11T19:28:12.7594763Z                                  New-ItemProperty -Path $Path -Name $Name -Value $Value -PropertyType $Type -Force | 
2026-01-11T19:28:12.7594894Z                      Out-Null
2026-01-11T19:28:12.7595938Z                              } else {
2026-01-11T19:28:12.7596899Z                                  Set-ItemProperty -Path $Path -Name $Name -Value $Value -EA Stop
2026-01-11T19:28:12.7597152Z                              }
2026-01-11T19:28:12.7598282Z                              $success = $true
2026-01-11T19:28:12.7599126Z                          } catch { $success = $false }
2026-01-11T19:28:12.7599945Z                          if ($PassThru) { return $success }
2026-01-11T19:28:12.7600680Z                      }
2026-01-11T19:28:12.7601415Z                      
2026-01-11T19:28:12.7602223Z                      function Add-ScanResult {
2026-01-11T19:28:12.7603567Z                          param([string]$Name, [string]$Current, [string]$Target, [string]$Status = "CHANGE")
2026-01-11T19:28:12.7603792Z                          $script:ScanResults += [PSCustomObject]@{
2026-01-11T19:28:12.7604586Z                              Name = $Name
2026-01-11T19:28:12.7604755Z                              Current = $Current
2026-01-11T19:28:12.7605077Z                              Target = $Target
2026-01-11T19:28:12.7606516Z                              Status = $Status
2026-01-11T19:28:12.7607185Z                          }
2026-01-11T19:28:12.7607987Z                      }
2026-01-11T19:28:12.7608765Z                      
2026-01-11T19:28:12.7609639Z                      function Write-ScanResults {
2026-01-11T19:28:12.7610483Z                          if ($script:ScanResults.Count -eq 0) { return }
2026-01-11T19:28:12.7611117Z                      
2026-01-11T19:28:12.7611890Z                          $nameWidth = 36
2026-01-11T19:28:12.7612699Z                          $currentWidth = 14
2026-01-11T19:28:12.7613453Z                          $targetWidth = 18
2026-01-11T19:28:12.7614187Z                      
2026-01-11T19:28:12.7614961Z                          Write-Host ""
2026-01-11T19:28:12.7615999Z                          Write-Host "  +$('-' * $nameWidth)+$('-' * $currentWidth)+$('-' * $targetWidth)+" 
2026-01-11T19:28:12.7616288Z                      -ForegroundColor White
2026-01-11T19:28:12.7618008Z                          Write-Host "  | Setting$(' ' * ($nameWidth - 9))| Current$(' ' * ($currentWidth - 9))| 
2026-01-11T19:28:12.7618670Z                      Target$(' ' * ($targetWidth - 8))|" -ForegroundColor White
2026-01-11T19:28:12.7619685Z                          Write-Host "  +$('-' * $nameWidth)+$('-' * $currentWidth)+$('-' * $targetWidth)+" 
2026-01-11T19:28:12.7620361Z                      -ForegroundColor White
2026-01-11T19:28:12.7621142Z                      
2026-01-11T19:28:12.7622001Z                          foreach ($result in $script:ScanResults) {
2026-01-11T19:28:12.7622636Z                              $name = $result.Name
2026-01-11T19:28:12.7624105Z                              if ($name.Length -gt ($nameWidth - 2)) { $name = $name.Substring(0, $nameWidth - 5) + 
2026-01-11T19:28:12.7624731Z                      "..." }
2026-01-11T19:28:12.7625683Z                              $name = " " + $name.PadRight($nameWidth - 2)
2026-01-11T19:28:12.7626553Z                      
2026-01-11T19:28:12.7627489Z                              $current = $result.Current
2026-01-11T19:28:12.7628475Z                              if ($current.Length -gt ($currentWidth - 2)) { $current = $current.Substring(0, 
2026-01-11T19:28:12.7628731Z                      $currentWidth - 5) + "..." }
2026-01-11T19:28:12.7629833Z                              $current = " " + $current.PadRight($currentWidth - 2)
2026-01-11T19:28:12.7630500Z                      
2026-01-11T19:28:12.7631327Z                              $target = $result.Target
2026-01-11T19:28:12.7632338Z                              if ($target.Length -gt ($targetWidth - 2)) { $target = $target.Substring(0, $targetWidth 
2026-01-11T19:28:12.7632555Z                      - 5) + "..." }
2026-01-11T19:28:12.7634054Z                              $target = " " + $target.PadRight($targetWidth - 2)
2026-01-11T19:28:12.7634265Z                      
2026-01-11T19:28:12.7635510Z                              $color = switch ($result.Status) {
2026-01-11T19:28:12.7636385Z                                  "OK"      { "Green" }
2026-01-11T19:28:12.7637222Z                                  "CHANGE"  { "Yellow" }
2026-01-11T19:28:12.7637907Z                                  "INFO"    { "Cyan" }
2026-01-11T19:28:12.7638813Z                                  "PENDING" { "Gray" }
2026-01-11T19:28:12.7639594Z                                  default   { "White" }
2026-01-11T19:28:12.7640414Z                              }
2026-01-11T19:28:12.7641140Z                      
2026-01-11T19:28:12.7642186Z                              Write-Host "  |" -NoNewline -ForegroundColor White
2026-01-11T19:28:12.7642944Z                              Write-Host $name -NoNewline -ForegroundColor $color
2026-01-11T19:28:12.7644303Z                              Write-Host "|" -NoNewline -ForegroundColor White
2026-01-11T19:28:12.7644727Z                              Write-Host $current -NoNewline -ForegroundColor $color
2026-01-11T19:28:12.7645888Z                              Write-Host "|" -NoNewline -ForegroundColor White
2026-01-11T19:28:12.7646700Z                              Write-Host $target -NoNewline -ForegroundColor $color
2026-01-11T19:28:12.7647499Z                              Write-Host "|" -ForegroundColor White
2026-01-11T19:28:12.7648179Z                          }
2026-01-11T19:28:12.7648840Z                      
2026-01-11T19:28:12.7649991Z                          Write-Host "  +$('-' * $nameWidth)+$('-' * $currentWidth)+$('-' * $targetWidth)+" 
2026-01-11T19:28:12.7650624Z                      -ForegroundColor White
2026-01-11T19:28:12.7651501Z                          Write-Host ""
2026-01-11T19:28:12.7652388Z                      
2026-01-11T19:28:12.7653562Z                          $changeCount = ($script:ScanResults | Where-Object { $_.Status -eq "CHANGE" }).Count
2026-01-11T19:28:12.7654303Z                          $okCount = ($script:ScanResults | Where-Object { $_.Status -eq "OK" }).Count
2026-01-11T19:28:12.7655362Z                          Write-Host "  Summary: $changeCount changes needed, $okCount already configured" 
2026-01-11T19:28:12.7655573Z                      -ForegroundColor Gray
2026-01-11T19:28:12.7656770Z                          Write-Host ""
2026-01-11T19:28:12.7657574Z                      }
2026-01-11T19:28:12.7658325Z                      
2026-01-11T19:28:12.7659452Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:12.7659613Z                      # PRESET DEFINITIONS
2026-01-11T19:28:12.7661861Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:12.7662000Z                      
2026-01-11T19:28:12.7662744Z                      $PRESETS = @{
2026-01-11T19:28:12.7664168Z                          'gamer' = @{
2026-01-11T19:28:12.7664888Z                              name = 'Casual Gamer'
2026-01-11T19:28:12.7665719Z                              desc = 'Safe defaults for everyday gaming'
2026-01-11T19:28:12.7666935Z                              color = 'Green'
2026-01-11T19:28:12.7667677Z                              opts = @('2','4','10','11','13','20','26','28','29','105','106','107','108')
2026-01-11T19:28:12.7668397Z                          }
2026-01-11T19:28:12.7669091Z                          'pro_gamer' = @{
2026-01-11T19:28:12.7669713Z                              name = 'Competitive Gamer'
2026-01-11T19:28:12.7670470Z                              desc = 'Maximum performance for esports'
2026-01-11T19:28:12.7671246Z                              color = 'Cyan'
2026-01-11T19:28:12.7672582Z                              opts = @('2','4','5','6','8','10','11','13','20','25','26','28','29','43','52','54','63','
2026-01-11T19:28:12.7673214Z                      64','104','105','106','107','108')
2026-01-11T19:28:12.7674062Z                          }
2026-01-11T19:28:12.7674862Z                          'streamer' = @{
2026-01-11T19:28:12.7675382Z                              name = 'Content Creator'
2026-01-11T19:28:12.7676505Z                              desc = 'Balanced for streaming + gaming'
2026-01-11T19:28:12.7677226Z                              color = 'Magenta'
2026-01-11T19:28:12.7678221Z                              opts = @('2','4','10','11','13','20','26','28','29','60','105','106','107','108')
2026-01-11T19:28:12.7678854Z                          }
2026-01-11T19:28:12.7679671Z                          'benchmarker' = @{
2026-01-11T19:28:12.7680485Z                              name = 'Benchmarker'
2026-01-11T19:28:12.7681652Z                              desc = 'Absolute maximum performance'
2026-01-11T19:28:12.7682476Z                              color = 'Yellow'
2026-01-11T19:28:12.7683594Z                              opts = @('2','4','5','6','8','10','11','13','20','25','26','28','29','43','50','51','52','
2026-01-11T19:28:12.7684412Z                      53','54','55','63','64','65','66','104','105','106','107','108')
2026-01-11T19:28:12.7685230Z                          }
2026-01-11T19:28:12.7686378Z                      }
2026-01-11T19:28:12.7687325Z                      
2026-01-11T19:28:12.7688244Z                      $OPT_DESCRIPTIONS = @{
2026-01-11T19:28:12.7689441Z                          '2'  = @{ name='Fast Startup'; tier='SAFE'; desc='Disable Fast Boot for cleaner shutdowns' }
2026-01-11T19:28:12.7689867Z                          '4'  = @{ name='Power Plan'; tier='SAFE'; desc='Enable High Performance power plan' }
2026-01-11T19:28:12.7690977Z                          '5'  = @{ name='USB Power'; tier='SAFE'; desc='Disable USB selective suspend' }
2026-01-11T19:28:12.7691825Z                          '6'  = @{ name='PCIe Power'; tier='SAFE'; desc='Disable PCIe power saving' }
2026-01-11T19:28:12.7692642Z                          '8'  = @{ name='Nagle Algorithm'; tier='SAFE'; desc='Disable network buffering' }
2026-01-11T19:28:12.7693028Z                          '10' = @{ name='Game DVR'; tier='SAFE'; desc='Disable background recording' }
2026-01-11T19:28:12.7694153Z                          '11' = @{ name='Background Apps'; tier='SAFE'; desc='Disable background app activity' }
2026-01-11T19:28:12.7694498Z                          '13' = @{ name='Copilot'; tier='SAFE'; desc='Disable Windows Copilot' }
2026-01-11T19:28:12.7695592Z                          '20' = @{ name='Visual Effects'; tier='SAFE'; desc='Set to performance mode' }
2026-01-11T19:28:12.7696509Z                          '25' = @{ name='Multiplane Overlay'; tier='SAFE'; desc='Disable DWM overlay' }
2026-01-11T19:28:12.7696903Z                          '26' = @{ name='Mouse Acceleration'; tier='SAFE'; desc='Disable for raw input' }
2026-01-11T19:28:12.7698143Z                          '28' = @{ name='Keyboard Response'; tier='SAFE'; desc='Minimize delay' }
2026-01-11T19:28:12.7698370Z                          '29' = @{ name='Game Mode'; tier='SAFE'; desc='Enable Windows Game Mode' }
2026-01-11T19:28:12.7699480Z                          '43' = @{ name='Input Buffer'; tier='SAFE'; desc='Increase for high poll rate' }
2026-01-11T19:28:12.7699834Z                          '50' = @{ name='MSI Mode'; tier='CAUTION'; desc='Lower DPC latency for GPU' }
2026-01-11T19:28:12.7700885Z                          '51' = @{ name='HPET'; tier='CAUTION'; desc='Disable timer (test before/after)' }
2026-01-11T19:28:12.7701743Z                          '52' = @{ name='Game Bar Overlay'; tier='CAUTION'; desc='Disable overlays' }
2026-01-11T19:28:12.7702382Z                          '53' = @{ name='HAGS'; tier='CAUTION'; desc='Enable GPU scheduling' }
2026-01-11T19:28:12.7703382Z                          '54' = @{ name='FSO'; tier='CAUTION'; desc='Disable fullscreen optimizations' }
2026-01-11T19:28:12.7703735Z                          '55' = @{ name='Ultimate Perf'; tier='CAUTION'; desc='Ultimate power plan' }
2026-01-11T19:28:12.7704859Z                          '60' = @{ name='Network Throttle'; tier='CAUTION'; desc='Disable throttling' }
2026-01-11T19:28:12.7705264Z                          '63' = @{ name='MMCSS'; tier='CAUTION'; desc='Multimedia scheduler gaming' }
2026-01-11T19:28:12.7706334Z                          '64' = @{ name='Scheduler'; tier='CAUTION'; desc='Optimize for responsiveness' }
2026-01-11T19:28:12.7707211Z                          '65' = @{ name='Core Parking'; tier='CAUTION'; desc='Disable core parking' }
2026-01-11T19:28:12.7707590Z                          '66' = @{ name='Timer Registry'; tier='CAUTION'; desc='Enable timer requests' }
2026-01-11T19:28:12.7708708Z                          '104' = @{ name='Background Polling'; tier='SAFE'; desc='Full mouse rate in background' }
2026-01-11T19:28:12.7709129Z                          '105' = @{ name='NIC Interrupt Mod'; tier='SAFE'; desc='Disable interrupt moderation' }
2026-01-11T19:28:12.7710138Z                          '106' = @{ name='NIC Flow Control'; tier='SAFE'; desc='Disable flow control' }
2026-01-11T19:28:12.7711064Z                          '107' = @{ name='NIC Energy Efficient'; tier='SAFE'; desc='Disable EEE/Green Ethernet' }
2026-01-11T19:28:12.7711514Z                          '108' = @{ name='Browser Background'; tier='SAFE'; desc='Disable Chrome/Edge background' }
2026-01-11T19:28:12.7712320Z                      }
2026-01-11T19:28:12.7712949Z                      
2026-01-11T19:28:12.7714065Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:12.7714273Z                      # OPTIMIZATION FUNCTIONS
2026-01-11T19:28:12.7715527Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:12.7715730Z                      
2026-01-11T19:28:12.7717069Z                      $OPT_FUNCTIONS = @{
2026-01-11T19:28:12.7717884Z                          '2' = {
2026-01-11T19:28:12.7719064Z                              if (Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Power" 
2026-01-11T19:28:12.7719888Z                      "HiberbootEnabled" 0 -PassThru) { Write-OK "Fast startup disabled" }
2026-01-11T19:28:12.7720395Z                          }
2026-01-11T19:28:12.7721174Z                          '4' = {
2026-01-11T19:28:12.7722464Z                              powercfg /setactive 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c 2>&1 | Out-Null
2026-01-11T19:28:12.7722914Z                              if ($LASTEXITCODE -eq 0) { Write-OK "High Performance power plan enabled" } else { 
2026-01-11T19:28:12.7723864Z                      Write-Warn "High Performance plan not available" }
2026-01-11T19:28:12.7724598Z                          }
2026-01-11T19:28:12.7725387Z                          '5' = {
2026-01-11T19:28:12.7726718Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Services\USB\DisableSelectiveSuspend" 
2026-01-11T19:28:12.7726844Z                      "DisableSelectiveSuspend" 1
2026-01-11T19:28:12.7727842Z                              Write-OK "USB selective suspend disabled"
2026-01-11T19:28:12.7728581Z                          }
2026-01-11T19:28:12.7729273Z                          '6' = {
2026-01-11T19:28:12.7730340Z                              powercfg /setacvalueindex scheme_current sub_pciexpress 
2026-01-11T19:28:12.7731030Z                      ee12f906-d166-476a-8f3a-af931b6e9d31 0 2>&1 | Out-Null
2026-01-11T19:28:12.7732084Z                              if ($LASTEXITCODE -eq 0) { powercfg /setactive scheme_current 2>&1 | Out-Null; Write-OK 
2026-01-11T19:28:12.7732375Z                      "PCIe power saving disabled" }
2026-01-11T19:28:12.7733364Z                          }
2026-01-11T19:28:12.7734132Z                          '8' = {
2026-01-11T19:28:12.7735166Z                              $adapters = Get-NetAdapter | Where-Object {$_.Status -eq "Up"}
2026-01-11T19:28:12.7735795Z                              foreach ($adapter in $adapters) {
2026-01-11T19:28:12.7736631Z                                  $path = 
2026-01-11T19:28:12.7737711Z                      "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces\$($adapter.InterfaceGuid)"
2026-01-11T19:28:12.7738538Z                                  Set-Reg $path "TcpAckFrequency" 1
2026-01-11T19:28:12.7738899Z                                  Set-Reg $path "TCPNoDelay" 1
2026-01-11T19:28:12.7740041Z                              }
2026-01-11T19:28:12.7740908Z                              Write-OK "Nagle algorithm disabled"
2026-01-11T19:28:12.7741602Z                          }
2026-01-11T19:28:12.7742903Z                          '10' = {
2026-01-11T19:28:12.7743253Z                              Set-Reg "HKCU:\System\GameConfigStore" "GameDVR_Enabled" 0
2026-01-11T19:28:12.7744373Z                              Set-Reg "HKLM:\SOFTWARE\Policies\Microsoft\Windows\GameDVR" "AllowGameDVR" 0
2026-01-11T19:28:12.7745044Z                              Write-OK "Game DVR disabled"
2026-01-11T19:28:12.7745730Z                          }
2026-01-11T19:28:12.7746431Z                          '11' = {
2026-01-11T19:28:12.7747562Z                              Set-Reg "HKCU:\Software\Microsoft\Windows\CurrentVersion\BackgroundAccessApplications" 
2026-01-11T19:28:12.7747748Z                      "GlobalUserDisabled" 1
2026-01-11T19:28:12.7748904Z                              Write-OK "Background apps disabled"
2026-01-11T19:28:12.7749685Z                          }
2026-01-11T19:28:12.7750399Z                          '13' = {
2026-01-11T19:28:12.7751476Z                              Set-Reg "HKCU:\Software\Policies\Microsoft\Windows\WindowsCopilot" 
2026-01-11T19:28:12.7752118Z                      "TurnOffWindowsCopilot" 1
2026-01-11T19:28:12.7752914Z                              Write-OK "Copilot disabled"
2026-01-11T19:28:12.7753594Z                          }
2026-01-11T19:28:12.7754316Z                          '20' = {
2026-01-11T19:28:12.7755390Z                              Set-Reg "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects" 
2026-01-11T19:28:12.7755659Z                      "VisualFXSetting" 2
2026-01-11T19:28:12.7756843Z                              Write-OK "Visual effects set to performance"
2026-01-11T19:28:12.7757617Z                          }
2026-01-11T19:28:12.7758438Z                          '25' = {
2026-01-11T19:28:12.7759461Z                              Set-Reg "HKLM:\SOFTWARE\Microsoft\Windows\Dwm" "OverlayTestMode" 5
2026-01-11T19:28:12.7760144Z                              Write-OK "Multiplane Overlay disabled"
2026-01-11T19:28:12.7760764Z                          }
2026-01-11T19:28:12.7761664Z                          '26' = {
2026-01-11T19:28:12.7762881Z                              if (Set-Reg "HKCU:\Control Panel\Mouse" "MouseSpeed" 0 -PassThru) { Write-OK "Mouse 
2026-01-11T19:28:12.7763302Z                      acceleration disabled" }
2026-01-11T19:28:12.7764405Z                              Set-Reg "HKCU:\Control Panel\Mouse" "MouseThreshold1" 0
2026-01-11T19:28:12.7765367Z                              Set-Reg "HKCU:\Control Panel\Mouse" "MouseThreshold2" 0
2026-01-11T19:28:12.7766108Z                          }
2026-01-11T19:28:12.7766794Z                          '28' = {
2026-01-11T19:28:12.7767999Z                              if (Set-Reg "HKCU:\Control Panel\Keyboard" "KeyboardDelay" 0 -PassThru) { Write-OK 
2026-01-11T19:28:12.7768209Z                      "Keyboard delay minimized" }
2026-01-11T19:28:12.7769305Z                              Set-Reg "HKCU:\Control Panel\Keyboard" "KeyboardSpeed" 31
2026-01-11T19:28:12.7769988Z                          }
2026-01-11T19:28:12.7770741Z                          '29' = {
2026-01-11T19:28:12.7771736Z                              Set-Reg "HKCU:\Software\Microsoft\GameBar" "AllowAutoGameMode" 1
2026-01-11T19:28:12.7772120Z                              Set-Reg "HKCU:\Software\Microsoft\GameBar" "AutoGameModeEnabled" 1
2026-01-11T19:28:12.7773068Z                              Write-OK "Game Mode enabled"
2026-01-11T19:28:12.7773796Z                          }
2026-01-11T19:28:12.7774267Z                          '43' = {
2026-01-11T19:28:12.7775661Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Services\mouclass\Parameters" 
2026-01-11T19:28:12.7776255Z                      "MouseDataQueueSize" 32
2026-01-11T19:28:12.7777285Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Services\kbdclass\Parameters" 
2026-01-11T19:28:12.7777904Z                      "KeyboardDataQueueSize" 32
2026-01-11T19:28:12.7778801Z                              Write-OK "Input buffer increased (8000Hz ready)"
2026-01-11T19:28:12.7779417Z                          }
2026-01-11T19:28:12.7780091Z                          '50' = {
2026-01-11T19:28:12.7781298Z                              $gpu = Get-PnpDevice -Class Display | Where-Object {$_.Status -eq "OK"} | Select-Object 
2026-01-11T19:28:12.7781505Z                      -First 1
2026-01-11T19:28:12.7783223Z                              if ($gpu) {
2026-01-11T19:28:12.7784168Z                                  $msiPath = "HKLM:\SYSTEM\CurrentControlSet\Enum\$($gpu.InstanceId)\Device 
2026-01-11T19:28:12.7784505Z                      Parameters\Interrupt Management\MessageSignaledInterruptProperties"
2026-01-11T19:28:12.7785799Z                                  if (Test-Path $msiPath) { Set-Reg $msiPath "MSISupported" 1; Write-OK "MSI mode 
2026-01-11T19:28:12.7786073Z                      enabled for GPU" }
2026-01-11T19:28:12.7787126Z                              }
2026-01-11T19:28:12.7787881Z                          }
2026-01-11T19:28:12.7788642Z                          '51' = {
2026-01-11T19:28:12.7789530Z                              bcdedit /set useplatformclock false 2>$null
2026-01-11T19:28:12.7790208Z                              bcdedit /set disabledynamictick yes 2>$null
2026-01-11T19:28:12.7791046Z                              Write-OK "HPET disabled (reboot required)"
2026-01-11T19:28:12.7791676Z                          }
2026-01-11T19:28:12.7792506Z                          '52' = {
2026-01-11T19:28:12.7793402Z                              Set-Reg "HKCU:\Software\Microsoft\GameBar" "ShowStartupPanel" 0
2026-01-11T19:28:12.7794443Z                              Set-Reg "HKCU:\Software\Microsoft\GameBar" "GamePanelStartupTipIndex" 3
2026-01-11T19:28:12.7795207Z                              Write-OK "Game Bar overlays disabled"
2026-01-11T19:28:12.7795836Z                          }
2026-01-11T19:28:12.7796535Z                          '53' = {
2026-01-11T19:28:12.7797673Z                              if (Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Control\GraphicsDrivers" "HwSchMode" 2 
2026-01-11T19:28:12.7797953Z                      -PassThru) { Write-OK "HAGS enabled" }
2026-01-11T19:28:12.7798914Z                          }
2026-01-11T19:28:12.7799796Z                          '54' = {
2026-01-11T19:28:12.7800684Z                              Set-Reg "HKCU:\System\GameConfigStore" "GameDVR_FSEBehaviorMode" 2
2026-01-11T19:28:12.7801115Z                              Set-Reg "HKCU:\System\GameConfigStore" "GameDVR_HonorUserFSEBehaviorMode" 1
2026-01-11T19:28:12.7802547Z                              Set-Reg "HKCU:\System\GameConfigStore" "GameDVR_FSEBehavior" 2
2026-01-11T19:28:12.7802739Z                              Write-OK "Fullscreen optimizations disabled"
2026-01-11T19:28:12.7804161Z                          }
2026-01-11T19:28:12.7804953Z                          '55' = {
2026-01-11T19:28:12.7805983Z                              powercfg /duplicatescheme e9a42b02-d5df-448d-aa00-03f14749eb61 >$null 2>&1
2026-01-11T19:28:12.7806257Z                              $planOutput = powercfg /list 2>&1
2026-01-11T19:28:12.7807406Z                              $plans = $planOutput | Select-String "Ultimate Performance"
2026-01-11T19:28:12.7808058Z                              if ($plans) {
2026-01-11T19:28:12.7808993Z                                  $guidMatch = [regex]::Match($plans.Line, "([A-Fa-f0-9-]{36})")
2026-01-11T19:28:12.7809726Z                                  if ($guidMatch.Success) {
2026-01-11T19:28:12.7810281Z                                      powercfg /setactive $guidMatch.Value 2>&1 | Out-Null
2026-01-11T19:28:12.7811377Z                                      Write-OK "Ultimate Performance enabled"
2026-01-11T19:28:12.7812052Z                                  }
2026-01-11T19:28:12.7812980Z                              } else { Write-Warn "Ultimate Performance not available" }
2026-01-11T19:28:12.7813578Z                          }
2026-01-11T19:28:12.7814254Z                          '60' = {
2026-01-11T19:28:12.7815400Z                              Set-Reg "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile" 
2026-01-11T19:28:12.7815641Z                      "NetworkThrottlingIndex" 0xffffffff
2026-01-11T19:28:12.7816709Z                              Write-OK "Network throttling disabled"
2026-01-11T19:28:12.7817444Z                          }
2026-01-11T19:28:12.7818194Z                          '63' = {
2026-01-11T19:28:12.7819174Z                              $mmcss = "HKLM:\SOFTWARE\Microsoft\Windows 
2026-01-11T19:28:12.7820005Z                      NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games"
2026-01-11T19:28:12.7820616Z                              Set-Reg $mmcss "GPU Priority" 8
2026-01-11T19:28:12.7821988Z                              Set-Reg $mmcss "Priority" 6
2026-01-11T19:28:12.7823255Z                              Set-Reg $mmcss "Scheduling Category" "High" "String"
2026-01-11T19:28:12.7824051Z                              Set-Reg $mmcss "SFIO Priority" "High" "String"
2026-01-11T19:28:12.7824882Z                              Write-OK "MMCSS gaming priority configured"
2026-01-11T19:28:12.7825592Z                          }
2026-01-11T19:28:12.7826375Z                          '64' = {
2026-01-11T19:28:12.7827415Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Control\PriorityControl" 
2026-01-11T19:28:12.7828036Z                      "Win32PrioritySeparation" 26
2026-01-11T19:28:12.7828876Z                              Write-OK "Scheduler optimized"
2026-01-11T19:28:12.7829533Z                          }
2026-01-11T19:28:12.7830288Z                          '65' = {
2026-01-11T19:28:12.7831348Z                              powercfg /setacvalueindex scheme_current sub_processor CPMINCORES 100 2>&1 | Out-Null
2026-01-11T19:28:12.7832252Z                              if ($LASTEXITCODE -eq 0) { powercfg /setactive scheme_current 2>&1 | Out-Null; Write-OK 
2026-01-11T19:28:12.7832475Z                      "Core parking disabled" }
2026-01-11T19:28:12.7833435Z                          }
2026-01-11T19:28:12.7834219Z                          '66' = {
2026-01-11T19:28:12.7835418Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\kernel" 
2026-01-11T19:28:12.7835610Z                      "GlobalTimerResolutionRequests" 1
2026-01-11T19:28:12.7836705Z                              Write-OK "Timer resolution registry configured"
2026-01-11T19:28:12.7837397Z                          }
2026-01-11T19:28:12.7838224Z                          '104' = {
2026-01-11T19:28:12.7839554Z                              if (Set-Reg "HKCU:\Control Panel\Mouse" "RawMouseThrottleEnabled" 0 -PassThru) {
2026-01-11T19:28:12.7840285Z                                  Write-OK "Background mouse polling unlocked"
2026-01-11T19:28:12.7840792Z                              }
2026-01-11T19:28:12.7841601Z                          }
2026-01-11T19:28:12.7842355Z                          '105' = {
2026-01-11T19:28:12.7843429Z                              $adapter = Get-NetAdapter | Where-Object {$_.Status -eq "Up" -and 
2026-01-11T19:28:12.7844302Z                      ($_.InterfaceDescription -like "*Ethernet*" -or $_.InterfaceDescription -like "*Wi-Fi*")} | 
2026-01-11T19:28:12.7844465Z                      Select-Object -First 1
2026-01-11T19:28:12.7845772Z                              if ($adapter) {
2026-01-11T19:28:12.7846304Z                                  try {
2026-01-11T19:28:12.7848458Z                                      Set-NetAdapterAdvancedProperty -Name $adapter.Name -RegistryKeyword 
2026-01-11T19:28:12.7848866Z                      "*InterruptModeration" -RegistryValue "0" -ErrorAction SilentlyContinue
2026-01-11T19:28:12.7849100Z                                      Write-OK "NIC interrupt moderation disabled"
2026-01-11T19:28:12.7849355Z                                  } catch { Write-Warn "NIC property not supported" }
2026-01-11T19:28:12.7849639Z                              }
2026-01-11T19:28:12.7849746Z                          }
2026-01-11T19:28:12.7850470Z                          '106' = {
2026-01-11T19:28:12.7851584Z                              $adapter = Get-NetAdapter | Where-Object {$_.Status -eq "Up" -and 
2026-01-11T19:28:12.7852283Z                      ($_.InterfaceDescription -like "*Ethernet*" -or $_.InterfaceDescription -like "*Wi-Fi*")} | 
2026-01-11T19:28:12.7852942Z                      Select-Object -First 1
2026-01-11T19:28:12.7853765Z                              if ($adapter) {
2026-01-11T19:28:12.7854398Z                                  try {
2026-01-11T19:28:12.7855451Z                                      Set-NetAdapterAdvancedProperty -Name $adapter.Name -RegistryKeyword 
2026-01-11T19:28:12.7855820Z                      "*FlowControl" -RegistryValue "0" -ErrorAction SilentlyContinue
2026-01-11T19:28:12.7856783Z                                      Write-OK "NIC flow control disabled"
2026-01-11T19:28:12.7857674Z                                  } catch { Write-Warn "NIC property not supported" }
2026-01-11T19:28:12.7858308Z                              }
2026-01-11T19:28:12.7859049Z                          }
2026-01-11T19:28:12.7859731Z                          '107' = {
2026-01-11T19:28:12.7861424Z                              $adapter = Get-NetAdapter | Where-Object {$_.Status -eq "Up" -and 
2026-01-11T19:28:12.7861951Z                      ($_.InterfaceDescription -like "*Ethernet*" -or $_.InterfaceDescription -like "*Wi-Fi*")} | 
2026-01-11T19:28:12.7862215Z                      Select-Object -First 1
2026-01-11T19:28:12.7863307Z                              if ($adapter) {
2026-01-11T19:28:12.7863996Z                                  try {
2026-01-11T19:28:12.7865082Z                                      Set-NetAdapterAdvancedProperty -Name $adapter.Name -RegistryKeyword 
2026-01-11T19:28:12.7866092Z                      "EEELinkAdvertisement" -RegistryValue "0" -ErrorAction SilentlyContinue
2026-01-11T19:28:12.7866318Z                                      Write-OK "NIC energy efficient ethernet disabled"
2026-01-11T19:28:12.7867318Z                                  } catch {
2026-01-11T19:28:12.7868082Z                                      try {
2026-01-11T19:28:12.7869305Z                                          Set-NetAdapterAdvancedProperty -Name $adapter.Name -RegistryKeyword 
2026-01-11T19:28:12.7869647Z                      "GreenEthernet" -RegistryValue "0" -ErrorAction SilentlyContinue
2026-01-11T19:28:12.7870636Z                                          Write-OK "NIC green ethernet disabled"
2026-01-11T19:28:12.7871161Z                                      } catch { Write-Warn "NIC energy property not supported" }
2026-01-11T19:28:12.7872076Z                                  }
2026-01-11T19:28:12.7872819Z                              }
2026-01-11T19:28:12.7873608Z                          }
2026-01-11T19:28:12.7874362Z                          '108' = {
2026-01-11T19:28:12.7875095Z                              # Chrome
2026-01-11T19:28:12.7876006Z                              if (-not (Test-Path "HKLM:\SOFTWARE\Policies\Google\Chrome")) {
2026-01-11T19:28:12.7876418Z                                  New-Item -Path "HKLM:\SOFTWARE\Policies\Google\Chrome" -Force | Out-Null
2026-01-11T19:28:12.7877323Z                              }
2026-01-11T19:28:12.7878308Z                              Set-Reg "HKLM:\SOFTWARE\Policies\Google\Chrome" "BackgroundModeEnabled" 0
2026-01-11T19:28:12.7879690Z                              # Edge
2026-01-11T19:28:12.7879876Z                              if (-not (Test-Path "HKLM:\SOFTWARE\Policies\Microsoft\Edge")) {
2026-01-11T19:28:12.7880315Z                                  New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Edge" -Force | Out-Null
2026-01-11T19:28:12.7881356Z                              }
2026-01-11T19:28:12.7881961Z                              Set-Reg "HKLM:\SOFTWARE\Policies\Microsoft\Edge" "StartupBoostEnabled" 0
2026-01-11T19:28:12.7883054Z                              Set-Reg "HKLM:\SOFTWARE\Policies\Microsoft\Edge" "BackgroundModeEnabled" 0
2026-01-11T19:28:12.7883462Z                              Set-Reg "HKLM:\SOFTWARE\Policies\Microsoft\Edge" "BackgroundExtensionsEnabled" 0
2026-01-11T19:28:12.7884413Z                              Write-OK "Browser background apps disabled"
2026-01-11T19:28:12.7885111Z                          }
2026-01-11T19:28:12.7886062Z                      }
2026-01-11T19:28:12.7886807Z                      
2026-01-11T19:28:12.7888111Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:12.7888218Z                      # MAIN EXECUTION
2026-01-11T19:28:12.7889407Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:12.7889964Z                      
2026-01-11T19:28:12.7890803Z                      Write-Banner
2026-01-11T19:28:12.7891520Z                      
2026-01-11T19:28:12.7892298Z                      # Show system info
2026-01-11T19:28:12.7893038Z                      $cpu = (Get-CimInstance Win32_Processor).Name
2026-01-11T19:28:12.7894151Z                      $gpu = (Get-CimInstance Win32_VideoController | Where-Object {$_.Status -eq "OK"} | Select-Object 
2026-01-11T19:28:12.7894999Z                      -First 1).Name
2026-01-11T19:28:12.7896031Z                      $ram = [math]::Round((Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property Capacity 
2026-01-11T19:28:12.7896231Z                      -Sum).Sum / 1GB)
2026-01-11T19:28:12.7897185Z                      
2026-01-11T19:28:12.7898004Z                      Write-Host "  System:" -ForegroundColor White
2026-01-11T19:28:12.7898964Z                      Write-Host "    OS:  $script:WinVersion (Build $script:WinBuild)" -ForegroundColor $(if 
2026-01-11T19:28:12.7899239Z                      ($script:IsWin11) { "Gray" } else { "Yellow" })
2026-01-11T19:28:12.7900259Z                      Write-Host "    CPU: $cpu" -ForegroundColor Gray
2026-01-11T19:28:12.7900743Z                      Write-Host "    GPU: $gpu" -ForegroundColor Gray
2026-01-11T19:28:12.7902010Z                      Write-Host "    RAM: ${ram}GB" -ForegroundColor Gray
2026-01-11T19:28:12.7902981Z                      
2026-01-11T19:28:12.7903293Z                      if (-not $script:IsWin11) {
2026-01-11T19:28:12.7904319Z                          Write-Host ""
2026-01-11T19:28:12.7905245Z                          Write-Host "  ! Windows 10 detected - some Win11-only options will be skipped" 
2026-01-11T19:28:12.7905507Z                      -ForegroundColor Yellow
2026-01-11T19:28:12.7906503Z                      }
2026-01-11T19:28:12.7907306Z                      Write-Host ""
2026-01-11T19:28:12.7908142Z                      
2026-01-11T19:28:12.7908996Z                      # Preset selection
2026-01-11T19:28:12.7909786Z                      if (-not $Preset) {
2026-01-11T19:28:12.7910732Z                          Write-Host "  Select a profile:" -ForegroundColor White
2026-01-11T19:28:12.7911274Z                          Write-Host ""
2026-01-11T19:28:12.7912491Z                          Write-Host "    [1] " -NoNewline; Write-Host "Casual Gamer" -NoNewline -ForegroundColor 
2026-01-11T19:28:12.7912787Z                      Green; Write-Host " - Safe defaults for everyday gaming"
2026-01-11T19:28:12.7914209Z                          Write-Host "    [2] " -NoNewline; Write-Host "Competitive Gamer" -NoNewline -ForegroundColor 
2026-01-11T19:28:12.7914609Z                      Cyan; Write-Host " - Maximum performance for esports"
2026-01-11T19:28:12.7915984Z                          Write-Host "    [3] " -NoNewline; Write-Host "Content Creator" -NoNewline -ForegroundColor 
2026-01-11T19:28:12.7917080Z                      Magenta; Write-Host " - Balanced for streaming + gaming"
2026-01-11T19:28:12.7917605Z                          Write-Host "    [4] " -NoNewline; Write-Host "Benchmarker" -NoNewline -ForegroundColor 
2026-01-11T19:28:12.7918436Z                      Yellow; Write-Host " - Absolute maximum performance"
2026-01-11T19:28:12.7918661Z                          Write-Host ""
2026-01-11T19:28:12.7919951Z                          Write-Host "  Choice (1-4): " -NoNewline -ForegroundColor Cyan
2026-01-11T19:28:12.7920183Z                          $choice = Read-Host
2026-01-11T19:28:12.7921227Z                      
2026-01-11T19:28:12.7922088Z                          $Preset = switch ($choice) {
2026-01-11T19:28:12.7922399Z                              '1' { 'gamer' }
2026-01-11T19:28:12.7923461Z                              '2' { 'pro_gamer' }
2026-01-11T19:28:12.7924250Z                              '3' { 'streamer' }
2026-01-11T19:28:12.7924873Z                              '4' { 'benchmarker' }
2026-01-11T19:28:12.7926028Z                              default { 'gamer' }
2026-01-11T19:28:12.7926627Z                          }
2026-01-11T19:28:12.7927335Z                      }
2026-01-11T19:28:12.7927441Z                      
2026-01-11T19:28:12.7928637Z                      $selectedPreset = $PRESETS[$Preset]
2026-01-11T19:28:12.7928892Z                      $optIds = $selectedPreset.opts
2026-01-11T19:28:12.7929916Z                      
2026-01-11T19:28:12.7930778Z                      Write-Host ""
2026-01-11T19:28:12.7931486Z                      Write-Host "  Selected: " -NoNewline
2026-01-11T19:28:12.7932076Z                      Write-Host $selectedPreset.name -ForegroundColor $selectedPreset.color
2026-01-11T19:28:12.7932719Z                      Write-Host "  $($selectedPreset.desc)" -ForegroundColor Gray
2026-01-11T19:28:12.7933189Z                      Write-Host "  Optimizations: $($optIds.Count)" -ForegroundColor Gray
2026-01-11T19:28:12.7933898Z                      Write-Host ""
2026-01-11T19:28:12.7934689Z                      
2026-01-11T19:28:12.7935333Z                      # Pre-flight scan
2026-01-11T19:28:12.7936521Z                      Write-Host "  Scanning current system state..." -ForegroundColor Gray
2026-01-11T19:28:12.7936908Z                      
2026-01-11T19:28:12.7937127Z                      foreach ($id in $optIds) {
2026-01-11T19:28:12.7939589Z                          $info = $OPT_DESCRIPTIONS[$id]
2026-01-11T19:28:12.7939782Z                          if (-not $info) { continue }
2026-01-11T19:28:12.7939866Z                      
2026-01-11T19:28:12.7940038Z                          $name = "[$($info.tier)] $($info.name)"
2026-01-11T19:28:12.7940495Z                          $current = "-"
2026-01-11T19:28:12.7941443Z                          $target = "Apply"
2026-01-11T19:28:12.7942182Z                          $status = "PENDING"
2026-01-11T19:28:12.7943012Z                      
2026-01-11T19:28:12.7943994Z                          switch ($id) {
2026-01-11T19:28:12.7944604Z                              '2' {
2026-01-11T19:28:12.7945186Z                                  try {
2026-01-11T19:28:12.7946894Z                                      $val = Get-ItemProperty "HKLM:\SYSTEM\CurrentControlSet\Control\Session 
2026-01-11T19:28:12.7947477Z                      Manager\Power" -Name "HiberbootEnabled" -EA SilentlyContinue
2026-01-11T19:28:12.7948361Z                                      if ($val.HiberbootEnabled -eq 0) { $current = "OFF"; $status = "OK" }
2026-01-11T19:28:12.7948882Z                                      else { $current = "ON"; $target = "OFF"; $status = "CHANGE" }
2026-01-11T19:28:12.7949796Z                                  } catch { }
2026-01-11T19:28:12.7950000Z                              }
2026-01-11T19:28:12.7951031Z                              '10' {
2026-01-11T19:28:12.7951613Z                                  try {
2026-01-11T19:28:12.7953410Z                                      $val = Get-ItemProperty "HKCU:\System\GameConfigStore" -Name "GameDVR_Enabled" 
2026-01-11T19:28:12.7953816Z                      -EA SilentlyContinue
2026-01-11T19:28:12.7954187Z                                      if ($val.GameDVR_Enabled -eq 0) { $current = "OFF"; $status = "OK" }
2026-01-11T19:28:12.7954942Z                                      else { $current = "ON"; $target = "OFF"; $status = "CHANGE" }
2026-01-11T19:28:12.7955305Z                                  } catch { }
2026-01-11T19:28:12.7955423Z                              }
2026-01-11T19:28:12.7955545Z                              '26' {
2026-01-11T19:28:12.7955877Z                                  try {
2026-01-11T19:28:12.7957503Z                                      $val = Get-ItemProperty "HKCU:\Control Panel\Mouse" -Name "MouseSpeed" -EA 
2026-01-11T19:28:12.7957864Z                      SilentlyContinue
2026-01-11T19:28:12.7958315Z                                      if ($val.MouseSpeed -eq "0") { $current = "OFF"; $status = "OK" }
2026-01-11T19:28:12.7959317Z                                      else { $current = "ON"; $target = "OFF"; $status = "CHANGE" }
2026-01-11T19:28:12.7959988Z                                  } catch { }
2026-01-11T19:28:12.7960844Z                              }
2026-01-11T19:28:12.7961719Z                              '29' {
2026-01-11T19:28:12.7962757Z                                  try {
2026-01-11T19:28:12.7964160Z                                      $val = Get-ItemProperty "HKCU:\Software\Microsoft\GameBar" -Name 
2026-01-11T19:28:12.7964423Z                      "AutoGameModeEnabled" -EA SilentlyContinue
2026-01-11T19:28:12.7965454Z                                      if ($val.AutoGameModeEnabled -eq 1) { $current = "ON"; $status = "OK" }
2026-01-11T19:28:12.7965691Z                                      else { $current = "OFF"; $target = "ON"; $status = "CHANGE" }
2026-01-11T19:28:12.7966161Z                                  } catch { }
2026-01-11T19:28:12.7966537Z                              }
2026-01-11T19:28:12.7967053Z                          }
2026-01-11T19:28:12.7967644Z                      
2026-01-11T19:28:12.7968415Z                          Add-ScanResult $name $current $target $status
2026-01-11T19:28:12.7968712Z                      }
2026-01-11T19:28:12.7969721Z                      
2026-01-11T19:28:12.7970349Z                      Write-ScanResults
2026-01-11T19:28:12.7970875Z                      
2026-01-11T19:28:12.7971680Z                      # Confirmation
2026-01-11T19:28:12.7972428Z                      if (-not $SkipConfirmation -and -not $DryRun) {
2026-01-11T19:28:12.7973512Z                          Write-Host "  Apply these optimizations? [Y]es / [N]o: " -NoNewline -ForegroundColor Cyan
2026-01-11T19:28:12.7973836Z                          $confirm = Read-Host
2026-01-11T19:28:12.7974991Z                          if ($confirm -notmatch '^[Yy]') {
2026-01-11T19:28:12.7975513Z                              Write-Host ""
2026-01-11T19:28:12.7976480Z                              Write-Host "  Cancelled by user" -ForegroundColor Yellow
2026-01-11T19:28:12.7976590Z                              exit 0
2026-01-11T19:28:12.7977450Z                          }
2026-01-11T19:28:12.7977968Z                      }
2026-01-11T19:28:12.7978656Z                      
2026-01-11T19:28:12.7979255Z                      if ($DryRun) {
2026-01-11T19:28:12.7980534Z                          Write-Host ""
2026-01-11T19:28:12.7981598Z                          Write-Host "  DRY RUN - No changes applied" -ForegroundColor Yellow
2026-01-11T19:28:12.7981810Z                          exit 0
2026-01-11T19:28:12.7982859Z                      }
2026-01-11T19:28:12.7983233Z                      
2026-01-11T19:28:12.7984369Z                      # Apply optimizations
2026-01-11T19:28:12.7984534Z                      Write-Step "Applying Optimizations"
2026-01-11T19:28:12.7985569Z                      
2026-01-11T19:28:12.7986386Z                      foreach ($id in $optIds) {
2026-01-11T19:28:12.7987278Z                          if (-not $OPT_FUNCTIONS.ContainsKey($id)) { continue }
2026-01-11T19:28:12.7987905Z                      
2026-01-11T19:28:12.7988803Z                          # Skip Win11-only on Win10
2026-01-11T19:28:12.7989654Z                          if (-not $script:IsWin11 -and $id -in $script:Win11OnlyIds) {
2026-01-11T19:28:12.7990662Z                              $info = $OPT_DESCRIPTIONS[$id]
2026-01-11T19:28:12.7991746Z                              Write-Host "  [SKIP] $($info.name) (requires Windows 11)" -ForegroundColor DarkGray
2026-01-11T19:28:12.7992341Z                              continue
2026-01-11T19:28:12.7993047Z                          }
2026-01-11T19:28:12.7993833Z                      
2026-01-11T19:28:12.7994556Z                          try {
2026-01-11T19:28:12.7995391Z                              & $OPT_FUNCTIONS[$id]
2026-01-11T19:28:12.7996238Z                          } catch {
2026-01-11T19:28:12.7997100Z                              Write-Fail "Failed: $($_.Exception.Message)"
2026-01-11T19:28:12.7997730Z                          }
2026-01-11T19:28:12.7998451Z                      }
2026-01-11T19:28:12.7999240Z                      
2026-01-11T19:28:12.7999940Z                      # Summary
2026-01-11T19:28:12.8000778Z                      Write-Step "Complete"
2026-01-11T19:28:12.8001526Z                      Write-Host ""
2026-01-11T19:28:12.8002566Z                      Write-Host "  +----------------------------------------+" -ForegroundColor White
2026-01-11T19:28:12.8002984Z                      Write-Host "  |           LOADOUT SUMMARY              |" -ForegroundColor White
2026-01-11T19:28:12.8003988Z                      Write-Host "  +----------------------------------------+" -ForegroundColor White
2026-01-11T19:28:12.8004729Z                      Write-Host ""
2026-01-11T19:28:12.8004974Z                      Write-Host "  Applied:  $($script:SuccessCount) changes" -ForegroundColor Green
2026-01-11T19:28:12.8006178Z                      if ($script:WarningCount -gt 0) { Write-Host "  Warnings: $($script:WarningCount)" 
2026-01-11T19:28:12.8006406Z                      -ForegroundColor Yellow }
2026-01-11T19:28:12.8007864Z                      if ($script:FailCount -gt 0) { Write-Host "  Failed:   $($script:FailCount)" -ForegroundColor Red 
2026-01-11T19:28:12.8008081Z                      }
2026-01-11T19:28:12.8017754Z                      Write-Host ""
2026-01-11T19:28:12.8019471Z                      Write-Host "  Reboot recommended for all changes to take effect." -ForegroundColor Cyan
2026-01-11T19:28:12.8019700Z                      Write-Host ""
2026-01-11T19:28:12.8020616Z                      Write-Host "  Source: https://rocktune.pedroferrari.com" -ForegroundColor DarkGray
2026-01-11T19:28:12.8020731Z                      Write-Host ""
2026-01-11T19:28:12.8021317Z [32;1mCleanBlock         : [0m
2026-01-11T19:28:12.8021528Z [32;1mDynamicParamBlock  : [0m
2026-01-11T19:28:12.8022143Z [32;1mScriptRequirements : [0mSystem.Management.Automation.Language.ScriptRequirements
2026-01-11T19:28:12.8022402Z [32;1mExtent             : [0m#Requires -RunAsAdministrator
2026-01-11T19:28:12.8022461Z                      <#
2026-01-11T19:28:12.8022525Z                      .SYNOPSIS
2026-01-11T19:28:12.8022683Z                          RockTune - Windows Gaming Optimization Loadout Builder
2026-01-11T19:28:12.8022739Z                      
2026-01-11T19:28:12.8022813Z                      .DESCRIPTION
2026-01-11T19:28:12.8023076Z                          Interactive gaming optimization script with the same polished UX as the web app.
2026-01-11T19:28:12.8023553Z                          Provides preset-based or custom optimization selection with before/after scanning.
2026-01-11T19:28:12.8023691Z                      
2026-01-11T19:28:12.8023799Z                      .EXAMPLE
2026-01-11T19:28:12.8023920Z                          .\rocktune.ps1
2026-01-11T19:28:12.8024011Z                      
2026-01-11T19:28:12.8024108Z                      .EXAMPLE
2026-01-11T19:28:12.8024287Z                          .\rocktune.ps1 -Preset pro_gamer
2026-01-11T19:28:12.8024385Z                      
2026-01-11T19:28:12.8024727Z                      .EXAMPLE
2026-01-11T19:28:12.8024956Z                          .\rocktune.ps1 -SkipConfirmation
2026-01-11T19:28:12.8025897Z                      
2026-01-11T19:28:12.8026660Z                      .NOTES
2026-01-11T19:28:12.8027519Z                          Source: https://github.com/thepedroferrari/rocktune
2026-01-11T19:28:12.8028406Z                          Web App: https://rocktune.pedroferrari.com
2026-01-11T19:28:12.8029112Z                      #>
2026-01-11T19:28:12.8029854Z                      
2026-01-11T19:28:12.8030605Z                      param(
2026-01-11T19:28:12.8031585Z                          [ValidateSet("gamer", "pro_gamer", "streamer", "benchmarker")]
2026-01-11T19:28:12.8032168Z                          [string]$Preset,
2026-01-11T19:28:12.8032995Z                          [switch]$SkipConfirmation,
2026-01-11T19:28:12.8033711Z                          [switch]$DryRun
2026-01-11T19:28:12.8034453Z                      )
2026-01-11T19:28:12.8035597Z                      
2026-01-11T19:28:12.8036293Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:12.8036991Z                      # OS DETECTION
2026-01-11T19:28:12.8037713Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:12.8038458Z                      
2026-01-11T19:28:12.8039682Z                      $script:WinBuild = [int](Get-CimInstance Win32_OperatingSystem).BuildNumber
2026-01-11T19:28:12.8039935Z                      $script:IsWin11 = $script:WinBuild -ge 22000
2026-01-11T19:28:12.8041126Z                      $script:IsWin11_24H2 = $script:WinBuild -ge 26100
2026-01-11T19:28:12.8041756Z                      $script:WinVersion = if ($script:IsWin11) { "Windows 11" } else { "Windows 10" }
2026-01-11T19:28:12.8041858Z                      
2026-01-11T19:28:12.8042629Z                      # IDs that only work on Windows 11
2026-01-11T19:28:12.8043015Z                      $script:Win11OnlyIds = @('18', '21', '22')
2026-01-11T19:28:12.8044146Z                      $script:Win11_24H2OnlyIds = @('86')
2026-01-11T19:28:12.8045088Z                      
2026-01-11T19:28:12.8046210Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:12.8046357Z                      # COUNTERS & STATE
2026-01-11T19:28:12.8047183Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:12.8048249Z                      
2026-01-11T19:28:12.8048944Z                      $script:SuccessCount = 0
2026-01-11T19:28:12.8049560Z                      $script:FailCount = 0
2026-01-11T19:28:12.8050183Z                      $script:WarningCount = 0
2026-01-11T19:28:12.8050793Z                      $script:ScanResults = @()
2026-01-11T19:28:12.8051360Z                      
2026-01-11T19:28:12.8052323Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:12.8052449Z                      # HELPER FUNCTIONS
2026-01-11T19:28:12.8053783Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:12.8053883Z                      
2026-01-11T19:28:12.8054893Z                      function Write-Banner {
2026-01-11T19:28:12.8055407Z                          Clear-Host
2026-01-11T19:28:12.8056031Z                          Write-Host @'
2026-01-11T19:28:12.8056585Z                      
2026-01-11T19:28:12.8057434Z                          ____             __   ______
2026-01-11T19:28:12.8058022Z                         / __ \____  _____/ /__/_  __/_  ______  ___
2026-01-11T19:28:12.8058555Z                        / /_/ / __ \/ ___/ //_/ / / / / / / __ \/ _ \
2026-01-11T19:28:12.8059208Z                       / _, _/ /_/ / /__/ ,<   / / / /_/ / / / /  __/
2026-01-11T19:28:12.8060016Z                      /_/ |_|\____/\___/_/|_| /_/  \__,_/_/ /_/\___/
2026-01-11T19:28:12.8060607Z                      
2026-01-11T19:28:12.8061223Z                              Windows Gaming Loadout Builder
2026-01-11T19:28:12.8061563Z                      '@ -ForegroundColor Magenta
2026-01-11T19:28:12.8062553Z                          Write-Host ""
2026-01-11T19:28:12.8063150Z                      }
2026-01-11T19:28:12.8063714Z                      
2026-01-11T19:28:12.8064606Z                      function Write-Step { param([string]$M) Write-Host "`n>> $M" -ForegroundColor Cyan }
2026-01-11T19:28:12.8066016Z                      function Write-OK { param([string]$M) $script:SuccessCount++; Write-Host "  [OK] $M" 
2026-01-11T19:28:12.8066197Z                      -ForegroundColor Green }
2026-01-11T19:28:12.8067238Z                      function Write-Fail { param([string]$M) $script:FailCount++; Write-Host "  [FAIL] $M" 
2026-01-11T19:28:12.8067835Z                      -ForegroundColor Red }
2026-01-11T19:28:12.8068268Z                      function Write-Warn { param([string]$M) $script:WarningCount++; Write-Host "  [!] $M" 
2026-01-11T19:28:12.8068437Z                      -ForegroundColor Yellow }
2026-01-11T19:28:12.8069254Z                      
2026-01-11T19:28:12.8069788Z                      function Set-Reg {
2026-01-11T19:28:12.8070971Z                          param([string]$Path, [string]$Name, $Value, [string]$Type = "DWORD", [switch]$PassThru)
2026-01-11T19:28:12.8071110Z                          $success = $false
2026-01-11T19:28:12.8072100Z                          try {
2026-01-11T19:28:12.8072932Z                              if (-not (Test-Path $Path)) { New-Item -Path $Path -Force | Out-Null }
2026-01-11T19:28:12.8073781Z                              $existing = Get-ItemProperty -Path $Path -Name $Name -EA SilentlyContinue
2026-01-11T19:28:12.8073938Z                              if ($null -eq $existing) {
2026-01-11T19:28:12.8075395Z                                  New-ItemProperty -Path $Path -Name $Name -Value $Value -PropertyType $Type -Force | 
2026-01-11T19:28:12.8075502Z                      Out-Null
2026-01-11T19:28:12.8076333Z                              } else {
2026-01-11T19:28:12.8077249Z                                  Set-ItemProperty -Path $Path -Name $Name -Value $Value -EA Stop
2026-01-11T19:28:12.8077723Z                              }
2026-01-11T19:28:12.8078724Z                              $success = $true
2026-01-11T19:28:12.8079119Z                          } catch { $success = $false }
2026-01-11T19:28:12.8080356Z                          if ($PassThru) { return $success }
2026-01-11T19:28:12.8080641Z                      }
2026-01-11T19:28:12.8081663Z                      
2026-01-11T19:28:12.8082349Z                      function Add-ScanResult {
2026-01-11T19:28:12.8082961Z                          param([string]$Name, [string]$Current, [string]$Target, [string]$Status = "CHANGE")
2026-01-11T19:28:12.8083800Z                          $script:ScanResults += [PSCustomObject]@{
2026-01-11T19:28:12.8084707Z                              Name = $Name
2026-01-11T19:28:12.8085754Z                              Current = $Current
2026-01-11T19:28:12.8086686Z                              Target = $Target
2026-01-11T19:28:12.8087487Z                              Status = $Status
2026-01-11T19:28:12.8088427Z                          }
2026-01-11T19:28:12.8089188Z                      }
2026-01-11T19:28:12.8089954Z                      
2026-01-11T19:28:12.8090834Z                      function Write-ScanResults {
2026-01-11T19:28:12.8091649Z                          if ($script:ScanResults.Count -eq 0) { return }
2026-01-11T19:28:12.8092279Z                      
2026-01-11T19:28:12.8093047Z                          $nameWidth = 36
2026-01-11T19:28:12.8093792Z                          $currentWidth = 14
2026-01-11T19:28:12.8094539Z                          $targetWidth = 18
2026-01-11T19:28:12.8095251Z                      
2026-01-11T19:28:12.8096003Z                          Write-Host ""
2026-01-11T19:28:12.8097055Z                          Write-Host "  +$('-' * $nameWidth)+$('-' * $currentWidth)+$('-' * $targetWidth)+" 
2026-01-11T19:28:12.8097572Z                      -ForegroundColor White
2026-01-11T19:28:12.8098773Z                          Write-Host "  | Setting$(' ' * ($nameWidth - 9))| Current$(' ' * ($currentWidth - 9))| 
2026-01-11T19:28:12.8099099Z                      Target$(' ' * ($targetWidth - 8))|" -ForegroundColor White
2026-01-11T19:28:12.8100651Z                          Write-Host "  +$('-' * $nameWidth)+$('-' * $currentWidth)+$('-' * $targetWidth)+" 
2026-01-11T19:28:12.8101295Z                      -ForegroundColor White
2026-01-11T19:28:12.8102178Z                      
2026-01-11T19:28:12.8103063Z                          foreach ($result in $script:ScanResults) {
2026-01-11T19:28:12.8103718Z                              $name = $result.Name
2026-01-11T19:28:12.8104889Z                              if ($name.Length -gt ($nameWidth - 2)) { $name = $name.Substring(0, $nameWidth - 5) + 
2026-01-11T19:28:12.8105702Z                      "..." }
2026-01-11T19:28:12.8106613Z                              $name = " " + $name.PadRight($nameWidth - 2)
2026-01-11T19:28:12.8107630Z                      
2026-01-11T19:28:12.8108498Z                              $current = $result.Current
2026-01-11T19:28:12.8109584Z                              if ($current.Length -gt ($currentWidth - 2)) { $current = $current.Substring(0, 
2026-01-11T19:28:12.8110168Z                      $currentWidth - 5) + "..." }
2026-01-11T19:28:12.8111136Z                              $current = " " + $current.PadRight($currentWidth - 2)
2026-01-11T19:28:12.8111819Z                      
2026-01-11T19:28:12.8112666Z                              $target = $result.Target
2026-01-11T19:28:12.8113650Z                              if ($target.Length -gt ($targetWidth - 2)) { $target = $target.Substring(0, $targetWidth 
2026-01-11T19:28:12.8113873Z                      - 5) + "..." }
2026-01-11T19:28:12.8115056Z                              $target = " " + $target.PadRight($targetWidth - 2)
2026-01-11T19:28:12.8115845Z                      
2026-01-11T19:28:12.8116679Z                              $color = switch ($result.Status) {
2026-01-11T19:28:12.8117525Z                                  "OK"      { "Green" }
2026-01-11T19:28:12.8118323Z                                  "CHANGE"  { "Yellow" }
2026-01-11T19:28:12.8119229Z                                  "INFO"    { "Cyan" }
2026-01-11T19:28:12.8120780Z                                  "PENDING" { "Gray" }
2026-01-11T19:28:12.8120933Z                                  default   { "White" }
2026-01-11T19:28:12.8121407Z                              }
2026-01-11T19:28:12.8122161Z                      
2026-01-11T19:28:12.8123195Z                              Write-Host "  |" -NoNewline -ForegroundColor White
2026-01-11T19:28:12.8124036Z                              Write-Host $name -NoNewline -ForegroundColor $color
2026-01-11T19:28:12.8124849Z                              Write-Host "|" -NoNewline -ForegroundColor White
2026-01-11T19:28:12.8125551Z                              Write-Host $current -NoNewline -ForegroundColor $color
2026-01-11T19:28:12.8126666Z                              Write-Host "|" -NoNewline -ForegroundColor White
2026-01-11T19:28:12.8127564Z                              Write-Host $target -NoNewline -ForegroundColor $color
2026-01-11T19:28:12.8128305Z                              Write-Host "|" -ForegroundColor White
2026-01-11T19:28:12.8128786Z                          }
2026-01-11T19:28:12.8129750Z                      
2026-01-11T19:28:12.8130900Z                          Write-Host "  +$('-' * $nameWidth)+$('-' * $currentWidth)+$('-' * $targetWidth)+" 
2026-01-11T19:28:12.8131757Z                      -ForegroundColor White
2026-01-11T19:28:12.8132028Z                          Write-Host ""
2026-01-11T19:28:12.8132945Z                      
2026-01-11T19:28:12.8133948Z                          $changeCount = ($script:ScanResults | Where-Object { $_.Status -eq "CHANGE" }).Count
2026-01-11T19:28:12.8134369Z                          $okCount = ($script:ScanResults | Where-Object { $_.Status -eq "OK" }).Count
2026-01-11T19:28:12.8135851Z                          Write-Host "  Summary: $changeCount changes needed, $okCount already configured" 
2026-01-11T19:28:12.8136030Z                      -ForegroundColor Gray
2026-01-11T19:28:12.8136336Z                          Write-Host ""
2026-01-11T19:28:12.8137080Z                      }
2026-01-11T19:28:12.8137938Z                      
2026-01-11T19:28:12.8139458Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:12.8140491Z                      # PRESET DEFINITIONS
2026-01-11T19:28:12.8142464Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:12.8145895Z                      
2026-01-11T19:28:12.8146191Z                      $PRESETS = @{
2026-01-11T19:28:12.8146515Z                          'gamer' = @{
2026-01-11T19:28:12.8146894Z                              name = 'Casual Gamer'
2026-01-11T19:28:12.8147611Z                              desc = 'Safe defaults for everyday gaming'
2026-01-11T19:28:12.8148955Z                              color = 'Green'
2026-01-11T19:28:12.8151513Z                              opts = @('2','4','10','11','13','20','26','28','29','105','106','107','108')
2026-01-11T19:28:12.8152119Z                          }
2026-01-11T19:28:12.8152456Z                          'pro_gamer' = @{
2026-01-11T19:28:12.8152881Z                              name = 'Competitive Gamer'
2026-01-11T19:28:12.8153410Z                              desc = 'Maximum performance for esports'
2026-01-11T19:28:12.8156695Z                              color = 'Cyan'
2026-01-11T19:28:12.8158089Z                              opts = @('2','4','5','6','8','10','11','13','20','25','26','28','29','43','52','54','63','
2026-01-11T19:28:12.8158764Z                      64','104','105','106','107','108')
2026-01-11T19:28:12.8159831Z                          }
2026-01-11T19:28:12.8160160Z                          'streamer' = @{
2026-01-11T19:28:12.8160546Z                              name = 'Content Creator'
2026-01-11T19:28:12.8161302Z                              desc = 'Balanced for streaming + gaming'
2026-01-11T19:28:12.8162528Z                              color = 'Magenta'
2026-01-11T19:28:12.8164319Z                              opts = @('2','4','10','11','13','20','26','28','29','60','105','106','107','108')
2026-01-11T19:28:12.8166189Z                          }
2026-01-11T19:28:12.8167447Z                          'benchmarker' = @{
2026-01-11T19:28:12.8168294Z                              name = 'Benchmarker'
2026-01-11T19:28:12.8168793Z                              desc = 'Absolute maximum performance'
2026-01-11T19:28:12.8169293Z                              color = 'Yellow'
2026-01-11T19:28:12.8170959Z                              opts = @('2','4','5','6','8','10','11','13','20','25','26','28','29','43','50','51','52','
2026-01-11T19:28:12.8171968Z                      53','54','55','63','64','65','66','104','105','106','107','108')
2026-01-11T19:28:12.8172498Z                          }
2026-01-11T19:28:12.8172830Z                      }
2026-01-11T19:28:12.8173820Z                      
2026-01-11T19:28:12.8174860Z                      $OPT_DESCRIPTIONS = @{
2026-01-11T19:28:12.8175648Z                          '2'  = @{ name='Fast Startup'; tier='SAFE'; desc='Disable Fast Boot for cleaner shutdowns' }
2026-01-11T19:28:12.8177898Z                          '4'  = @{ name='Power Plan'; tier='SAFE'; desc='Enable High Performance power plan' }
2026-01-11T19:28:12.8178864Z                          '5'  = @{ name='USB Power'; tier='SAFE'; desc='Disable USB selective suspend' }
2026-01-11T19:28:12.8179702Z                          '6'  = @{ name='PCIe Power'; tier='SAFE'; desc='Disable PCIe power saving' }
2026-01-11T19:28:12.8180582Z                          '8'  = @{ name='Nagle Algorithm'; tier='SAFE'; desc='Disable network buffering' }
2026-01-11T19:28:12.8182936Z                          '10' = @{ name='Game DVR'; tier='SAFE'; desc='Disable background recording' }
2026-01-11T19:28:12.8183865Z                          '11' = @{ name='Background Apps'; tier='SAFE'; desc='Disable background app activity' }
2026-01-11T19:28:12.8184752Z                          '13' = @{ name='Copilot'; tier='SAFE'; desc='Disable Windows Copilot' }
2026-01-11T19:28:12.8185940Z                          '20' = @{ name='Visual Effects'; tier='SAFE'; desc='Set to performance mode' }
2026-01-11T19:28:12.8187464Z                          '25' = @{ name='Multiplane Overlay'; tier='SAFE'; desc='Disable DWM overlay' }
2026-01-11T19:28:12.8188618Z                          '26' = @{ name='Mouse Acceleration'; tier='SAFE'; desc='Disable for raw input' }
2026-01-11T19:28:12.8189888Z                          '28' = @{ name='Keyboard Response'; tier='SAFE'; desc='Minimize delay' }
2026-01-11T19:28:12.8191341Z                          '29' = @{ name='Game Mode'; tier='SAFE'; desc='Enable Windows Game Mode' }
2026-01-11T19:28:12.8192674Z                          '43' = @{ name='Input Buffer'; tier='SAFE'; desc='Increase for high poll rate' }
2026-01-11T19:28:12.8193594Z                          '50' = @{ name='MSI Mode'; tier='CAUTION'; desc='Lower DPC latency for GPU' }
2026-01-11T19:28:12.8194466Z                          '51' = @{ name='HPET'; tier='CAUTION'; desc='Disable timer (test before/after)' }
2026-01-11T19:28:12.8195323Z                          '52' = @{ name='Game Bar Overlay'; tier='CAUTION'; desc='Disable overlays' }
2026-01-11T19:28:12.8196117Z                          '53' = @{ name='HAGS'; tier='CAUTION'; desc='Enable GPU scheduling' }
2026-01-11T19:28:12.8196905Z                          '54' = @{ name='FSO'; tier='CAUTION'; desc='Disable fullscreen optimizations' }
2026-01-11T19:28:12.8197798Z                          '55' = @{ name='Ultimate Perf'; tier='CAUTION'; desc='Ultimate power plan' }
2026-01-11T19:28:12.8198721Z                          '60' = @{ name='Network Throttle'; tier='CAUTION'; desc='Disable throttling' }
2026-01-11T19:28:12.8199574Z                          '63' = @{ name='MMCSS'; tier='CAUTION'; desc='Multimedia scheduler gaming' }
2026-01-11T19:28:12.8200469Z                          '64' = @{ name='Scheduler'; tier='CAUTION'; desc='Optimize for responsiveness' }
2026-01-11T19:28:12.8201913Z                          '65' = @{ name='Core Parking'; tier='CAUTION'; desc='Disable core parking' }
2026-01-11T19:28:12.8203614Z                          '66' = @{ name='Timer Registry'; tier='CAUTION'; desc='Enable timer requests' }
2026-01-11T19:28:12.8204734Z                          '104' = @{ name='Background Polling'; tier='SAFE'; desc='Full mouse rate in background' }
2026-01-11T19:28:12.8206409Z                          '105' = @{ name='NIC Interrupt Mod'; tier='SAFE'; desc='Disable interrupt moderation' }
2026-01-11T19:28:12.8207360Z                          '106' = @{ name='NIC Flow Control'; tier='SAFE'; desc='Disable flow control' }
2026-01-11T19:28:12.8209633Z                          '107' = @{ name='NIC Energy Efficient'; tier='SAFE'; desc='Disable EEE/Green Ethernet' }
2026-01-11T19:28:12.8211110Z                          '108' = @{ name='Browser Background'; tier='SAFE'; desc='Disable Chrome/Edge background' }
2026-01-11T19:28:12.8211854Z                      }
2026-01-11T19:28:12.8212125Z                      
2026-01-11T19:28:12.8212885Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:12.8213470Z                      # OPTIMIZATION FUNCTIONS
2026-01-11T19:28:12.8214240Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:12.8214769Z                      
2026-01-11T19:28:12.8215048Z                      $OPT_FUNCTIONS = @{
2026-01-11T19:28:12.8215429Z                          '2' = {
2026-01-11T19:28:12.8216005Z                              if (Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Power" 
2026-01-11T19:28:12.8217162Z                      "HiberbootEnabled" 0 -PassThru) { Write-OK "Fast startup disabled" }
2026-01-11T19:28:12.8217811Z                          }
2026-01-11T19:28:12.8219438Z                          '4' = {
2026-01-11T19:28:12.8221802Z                              powercfg /setactive 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c 2>&1 | Out-Null
2026-01-11T19:28:12.8224425Z                              if ($LASTEXITCODE -eq 0) { Write-OK "High Performance power plan enabled" } else { 
2026-01-11T19:28:12.8226998Z                      Write-Warn "High Performance plan not available" }
2026-01-11T19:28:12.8228808Z                          }
2026-01-11T19:28:12.8230234Z                          '5' = {
2026-01-11T19:28:12.8231973Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Services\USB\DisableSelectiveSuspend" 
2026-01-11T19:28:12.8232802Z                      "DisableSelectiveSuspend" 1
2026-01-11T19:28:12.8233355Z                              Write-OK "USB selective suspend disabled"
2026-01-11T19:28:12.8234116Z                          }
2026-01-11T19:28:12.8234451Z                          '6' = {
2026-01-11T19:28:12.8235202Z                              powercfg /setacvalueindex scheme_current sub_pciexpress 
2026-01-11T19:28:12.8236150Z                      ee12f906-d166-476a-8f3a-af931b6e9d31 0 2>&1 | Out-Null
2026-01-11T19:28:12.8236992Z                              if ($LASTEXITCODE -eq 0) { powercfg /setactive scheme_current 2>&1 | Out-Null; Write-OK 
2026-01-11T19:28:12.8237814Z                      "PCIe power saving disabled" }
2026-01-11T19:28:12.8238245Z                          }
2026-01-11T19:28:12.8238919Z                          '8' = {
2026-01-11T19:28:12.8239718Z                              $adapters = Get-NetAdapter | Where-Object {$_.Status -eq "Up"}
2026-01-11T19:28:12.8240484Z                              foreach ($adapter in $adapters) {
2026-01-11T19:28:12.8240986Z                                  $path = 
2026-01-11T19:28:12.8242253Z                      "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces\$($adapter.InterfaceGuid)"
2026-01-11T19:28:12.8243215Z                                  Set-Reg $path "TcpAckFrequency" 1
2026-01-11T19:28:12.8243759Z                                  Set-Reg $path "TCPNoDelay" 1
2026-01-11T19:28:12.8244232Z                              }
2026-01-11T19:28:12.8244648Z                              Write-OK "Nagle algorithm disabled"
2026-01-11T19:28:12.8245112Z                          }
2026-01-11T19:28:12.8245428Z                          '10' = {
2026-01-11T19:28:12.8245945Z                              Set-Reg "HKCU:\System\GameConfigStore" "GameDVR_Enabled" 0
2026-01-11T19:28:12.8246823Z                              Set-Reg "HKLM:\SOFTWARE\Policies\Microsoft\Windows\GameDVR" "AllowGameDVR" 0
2026-01-11T19:28:12.8247681Z                              Write-OK "Game DVR disabled"
2026-01-11T19:28:12.8248213Z                          }
2026-01-11T19:28:12.8248547Z                          '11' = {
2026-01-11T19:28:12.8249295Z                              Set-Reg "HKCU:\Software\Microsoft\Windows\CurrentVersion\BackgroundAccessApplications" 
2026-01-11T19:28:12.8250152Z                      "GlobalUserDisabled" 1
2026-01-11T19:28:12.8250649Z                              Write-OK "Background apps disabled"
2026-01-11T19:28:12.8251118Z                          }
2026-01-11T19:28:12.8251414Z                          '13' = {
2026-01-11T19:28:12.8251998Z                              Set-Reg "HKCU:\Software\Policies\Microsoft\Windows\WindowsCopilot" 
2026-01-11T19:28:12.8252689Z                      "TurnOffWindowsCopilot" 1
2026-01-11T19:28:12.8253150Z                              Write-OK "Copilot disabled"
2026-01-11T19:28:12.8253573Z                          }
2026-01-11T19:28:12.8253858Z                          '20' = {
2026-01-11T19:28:12.8254523Z                              Set-Reg "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects" 
2026-01-11T19:28:12.8255486Z                      "VisualFXSetting" 2
2026-01-11T19:28:12.8255982Z                              Write-OK "Visual effects set to performance"
2026-01-11T19:28:12.8256491Z                          }
2026-01-11T19:28:12.8256800Z                          '25' = {
2026-01-11T19:28:12.8257363Z                              Set-Reg "HKLM:\SOFTWARE\Microsoft\Windows\Dwm" "OverlayTestMode" 5
2026-01-11T19:28:12.8258025Z                              Write-OK "Multiplane Overlay disabled"
2026-01-11T19:28:12.8258507Z                          }
2026-01-11T19:28:12.8258823Z                          '26' = {
2026-01-11T19:28:12.8259499Z                              if (Set-Reg "HKCU:\Control Panel\Mouse" "MouseSpeed" 0 -PassThru) { Write-OK "Mouse 
2026-01-11T19:28:12.8260303Z                      acceleration disabled" }
2026-01-11T19:28:12.8260861Z                              Set-Reg "HKCU:\Control Panel\Mouse" "MouseThreshold1" 0
2026-01-11T19:28:12.8261589Z                              Set-Reg "HKCU:\Control Panel\Mouse" "MouseThreshold2" 0
2026-01-11T19:28:12.8262516Z                          }
2026-01-11T19:28:12.8262836Z                          '28' = {
2026-01-11T19:28:12.8263506Z                              if (Set-Reg "HKCU:\Control Panel\Keyboard" "KeyboardDelay" 0 -PassThru) { Write-OK 
2026-01-11T19:28:12.8264508Z                      "Keyboard delay minimized" }
2026-01-11T19:28:12.8265064Z                              Set-Reg "HKCU:\Control Panel\Keyboard" "KeyboardSpeed" 31
2026-01-11T19:28:12.8265577Z                          }
2026-01-11T19:28:12.8265864Z                          '29' = {
2026-01-11T19:28:12.8266334Z                              Set-Reg "HKCU:\Software\Microsoft\GameBar" "AllowAutoGameMode" 1
2026-01-11T19:28:12.8267159Z                              Set-Reg "HKCU:\Software\Microsoft\GameBar" "AutoGameModeEnabled" 1
2026-01-11T19:28:12.8267816Z                              Write-OK "Game Mode enabled"
2026-01-11T19:28:12.8268426Z                          }
2026-01-11T19:28:12.8268727Z                          '43' = {
2026-01-11T19:28:12.8269804Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Services\mouclass\Parameters" 
2026-01-11T19:28:12.8271149Z                      "MouseDataQueueSize" 32
2026-01-11T19:28:12.8272324Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Services\kbdclass\Parameters" 
2026-01-11T19:28:12.8273066Z                      "KeyboardDataQueueSize" 32
2026-01-11T19:28:12.8273640Z                              Write-OK "Input buffer increased (8000Hz ready)"
2026-01-11T19:28:12.8274216Z                          }
2026-01-11T19:28:12.8275478Z                          '50' = {
2026-01-11T19:28:12.8277210Z                              $gpu = Get-PnpDevice -Class Display | Where-Object {$_.Status -eq "OK"} | Select-Object 
2026-01-11T19:28:12.8278415Z                      -First 1
2026-01-11T19:28:12.8278780Z                              if ($gpu) {
2026-01-11T19:28:12.8280105Z                                  $msiPath = "HKLM:\SYSTEM\CurrentControlSet\Enum\$($gpu.InstanceId)\Device 
2026-01-11T19:28:12.8281016Z                      Parameters\Interrupt Management\MessageSignaledInterruptProperties"
2026-01-11T19:28:12.8282024Z                                  if (Test-Path $msiPath) { Set-Reg $msiPath "MSISupported" 1; Write-OK "MSI mode 
2026-01-11T19:28:12.8282722Z                      enabled for GPU" }
2026-01-11T19:28:12.8283072Z                              }
2026-01-11T19:28:12.8283377Z                          }
2026-01-11T19:28:12.8284122Z                          '51' = {
2026-01-11T19:28:12.8284753Z                              bcdedit /set useplatformclock false 2>$null
2026-01-11T19:28:12.8285676Z                              bcdedit /set disabledynamictick yes 2>$null
2026-01-11T19:28:12.8286430Z                              Write-OK "HPET disabled (reboot required)"
2026-01-11T19:28:12.8286883Z                          }
2026-01-11T19:28:12.8287174Z                          '52' = {
2026-01-11T19:28:12.8287902Z                              Set-Reg "HKCU:\Software\Microsoft\GameBar" "ShowStartupPanel" 0
2026-01-11T19:28:12.8288755Z                              Set-Reg "HKCU:\Software\Microsoft\GameBar" "GamePanelStartupTipIndex" 3
2026-01-11T19:28:12.8289472Z                              Write-OK "Game Bar overlays disabled"
2026-01-11T19:28:12.8289888Z                          }
2026-01-11T19:28:12.8290170Z                          '53' = {
2026-01-11T19:28:12.8290812Z                              if (Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Control\GraphicsDrivers" "HwSchMode" 2 
2026-01-11T19:28:12.8292036Z                      -PassThru) { Write-OK "HAGS enabled" }
2026-01-11T19:28:12.8292733Z                          }
2026-01-11T19:28:12.8293031Z                          '54' = {
2026-01-11T19:28:12.8293906Z                              Set-Reg "HKCU:\System\GameConfigStore" "GameDVR_FSEBehaviorMode" 2
2026-01-11T19:28:12.8295117Z                              Set-Reg "HKCU:\System\GameConfigStore" "GameDVR_HonorUserFSEBehaviorMode" 1
2026-01-11T19:28:12.8295975Z                              Set-Reg "HKCU:\System\GameConfigStore" "GameDVR_FSEBehavior" 2
2026-01-11T19:28:12.8297988Z                              Write-OK "Fullscreen optimizations disabled"
2026-01-11T19:28:12.8298482Z                          }
2026-01-11T19:28:12.8298758Z                          '55' = {
2026-01-11T19:28:12.8299372Z                              powercfg /duplicatescheme e9a42b02-d5df-448d-aa00-03f14749eb61 >$null 2>&1
2026-01-11T19:28:12.8300084Z                              $planOutput = powercfg /list 2>&1
2026-01-11T19:28:12.8300753Z                              $plans = $planOutput | Select-String "Ultimate Performance"
2026-01-11T19:28:12.8301340Z                              if ($plans) {
2026-01-11T19:28:12.8301916Z                                  $guidMatch = [regex]::Match($plans.Line, "([A-Fa-f0-9-]{36})")
2026-01-11T19:28:12.8303358Z                                  if ($guidMatch.Success) {
2026-01-11T19:28:12.8304233Z                                      powercfg /setactive $guidMatch.Value 2>&1 | Out-Null
2026-01-11T19:28:12.8304890Z                                      Write-OK "Ultimate Performance enabled"
2026-01-11T19:28:12.8305724Z                                  }
2026-01-11T19:28:12.8306298Z                              } else { Write-Warn "Ultimate Performance not available" }
2026-01-11T19:28:12.8306957Z                          }
2026-01-11T19:28:12.8307330Z                          '60' = {
2026-01-11T19:28:12.8307965Z                              Set-Reg "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile" 
2026-01-11T19:28:12.8308787Z                      "NetworkThrottlingIndex" 0xffffffff
2026-01-11T19:28:12.8309309Z                              Write-OK "Network throttling disabled"
2026-01-11T19:28:12.8309769Z                          }
2026-01-11T19:28:12.8310074Z                          '63' = {
2026-01-11T19:28:12.8310502Z                              $mmcss = "HKLM:\SOFTWARE\Microsoft\Windows 
2026-01-11T19:28:12.8311474Z                      NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games"
2026-01-11T19:28:12.8312412Z                              Set-Reg $mmcss "GPU Priority" 8
2026-01-11T19:28:12.8319020Z                              Set-Reg $mmcss "Priority" 6
2026-01-11T19:28:12.8320729Z                              Set-Reg $mmcss "Scheduling Category" "High" "String"
2026-01-11T19:28:12.8321650Z                              Set-Reg $mmcss "SFIO Priority" "High" "String"
2026-01-11T19:28:12.8322261Z                              Write-OK "MMCSS gaming priority configured"
2026-01-11T19:28:12.8322750Z                          }
2026-01-11T19:28:12.8323046Z                          '64' = {
2026-01-11T19:28:12.8323600Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Control\PriorityControl" 
2026-01-11T19:28:12.8324710Z                      "Win32PrioritySeparation" 26
2026-01-11T19:28:12.8325485Z                              Write-OK "Scheduler optimized"
2026-01-11T19:28:12.8326407Z                          }
2026-01-11T19:28:12.8326683Z                          '65' = {
2026-01-11T19:28:12.8327315Z                              powercfg /setacvalueindex scheme_current sub_processor CPMINCORES 100 2>&1 | Out-Null
2026-01-11T19:28:12.8328306Z                              if ($LASTEXITCODE -eq 0) { powercfg /setactive scheme_current 2>&1 | Out-Null; Write-OK 
2026-01-11T19:28:12.8329071Z                      "Core parking disabled" }
2026-01-11T19:28:12.8329458Z                          }
2026-01-11T19:28:12.8329751Z                          '66' = {
2026-01-11T19:28:12.8330487Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\kernel" 
2026-01-11T19:28:12.8331183Z                      "GlobalTimerResolutionRequests" 1
2026-01-11T19:28:12.8331719Z                              Write-OK "Timer resolution registry configured"
2026-01-11T19:28:12.8332184Z                          }
2026-01-11T19:28:12.8332473Z                          '104' = {
2026-01-11T19:28:12.8333104Z                              if (Set-Reg "HKCU:\Control Panel\Mouse" "RawMouseThrottleEnabled" 0 -PassThru) {
2026-01-11T19:28:12.8334140Z                                  Write-OK "Background mouse polling unlocked"
2026-01-11T19:28:12.8334621Z                              }
2026-01-11T19:28:12.8334917Z                          }
2026-01-11T19:28:12.8335208Z                          '105' = {
2026-01-11T19:28:12.8335752Z                              $adapter = Get-NetAdapter | Where-Object {$_.Status -eq "Up" -and 
2026-01-11T19:28:12.8336723Z                      ($_.InterfaceDescription -like "*Ethernet*" -or $_.InterfaceDescription -like "*Wi-Fi*")} | 
2026-01-11T19:28:12.8338178Z                      Select-Object -First 1
2026-01-11T19:28:12.8340093Z                              if ($adapter) {
2026-01-11T19:28:12.8342282Z                                  try {
2026-01-11T19:28:12.8343941Z                                      Set-NetAdapterAdvancedProperty -Name $adapter.Name -RegistryKeyword 
2026-01-11T19:28:12.8345261Z                      "*InterruptModeration" -RegistryValue "0" -ErrorAction SilentlyContinue
2026-01-11T19:28:12.8346836Z                                      Write-OK "NIC interrupt moderation disabled"
2026-01-11T19:28:12.8348629Z                                  } catch { Write-Warn "NIC property not supported" }
2026-01-11T19:28:12.8349442Z                              }
2026-01-11T19:28:12.8350069Z                          }
2026-01-11T19:28:12.8350998Z                          '106' = {
2026-01-11T19:28:12.8356161Z                              $adapter = Get-NetAdapter | Where-Object {$_.Status -eq "Up" -and 
2026-01-11T19:28:12.8416170Z                      ($_.InterfaceDescription -like "*Ethernet*" -or $_.InterfaceDescription -like "*Wi-Fi*")} | 
2026-01-11T19:28:12.8417056Z                      Select-Object -First 1
2026-01-11T19:28:12.8417520Z                              if ($adapter) {
2026-01-11T19:28:12.8417948Z                                  try {
2026-01-11T19:28:12.8418997Z                                      Set-NetAdapterAdvancedProperty -Name $adapter.Name -RegistryKeyword 
2026-01-11T19:28:12.8419955Z                      "*FlowControl" -RegistryValue "0" -ErrorAction SilentlyContinue
2026-01-11T19:28:12.8420656Z                                      Write-OK "NIC flow control disabled"
2026-01-11T19:28:12.8421289Z                                  } catch { Write-Warn "NIC property not supported" }
2026-01-11T19:28:12.8421878Z                              }
2026-01-11T19:28:12.8422228Z                          }
2026-01-11T19:28:12.8422534Z                          '107' = {
2026-01-11T19:28:12.8423102Z                              $adapter = Get-NetAdapter | Where-Object {$_.Status -eq "Up" -and 
2026-01-11T19:28:12.8424253Z                      ($_.InterfaceDescription -like "*Ethernet*" -or $_.InterfaceDescription -like "*Wi-Fi*")} | 
2026-01-11T19:28:12.8425026Z                      Select-Object -First 1
2026-01-11T19:28:12.8425474Z                              if ($adapter) {
2026-01-11T19:28:12.8425862Z                                  try {
2026-01-11T19:28:12.8426544Z                                      Set-NetAdapterAdvancedProperty -Name $adapter.Name -RegistryKeyword 
2026-01-11T19:28:12.8427482Z                      "EEELinkAdvertisement" -RegistryValue "0" -ErrorAction SilentlyContinue
2026-01-11T19:28:12.8428042Z                                      Write-OK "NIC energy efficient ethernet disabled"
2026-01-11T19:28:12.8428582Z                                  } catch {
2026-01-11T19:28:12.8428969Z                                      try {
2026-01-11T19:28:12.8429701Z                                          Set-NetAdapterAdvancedProperty -Name $adapter.Name -RegistryKeyword 
2026-01-11T19:28:12.8430616Z                      "GreenEthernet" -RegistryValue "0" -ErrorAction SilentlyContinue
2026-01-11T19:28:12.8431381Z                                          Write-OK "NIC green ethernet disabled"
2026-01-11T19:28:12.8432061Z                                      } catch { Write-Warn "NIC energy property not supported" }
2026-01-11T19:28:12.8432958Z                                  }
2026-01-11T19:28:12.8433306Z                              }
2026-01-11T19:28:12.8433627Z                          }
2026-01-11T19:28:12.8434001Z                          '108' = {
2026-01-11T19:28:12.8434602Z                              # Chrome
2026-01-11T19:28:12.8435642Z                              if (-not (Test-Path "HKLM:\SOFTWARE\Policies\Google\Chrome")) {
2026-01-11T19:28:12.8436533Z                                  New-Item -Path "HKLM:\SOFTWARE\Policies\Google\Chrome" -Force | Out-Null
2026-01-11T19:28:12.8437902Z                              }
2026-01-11T19:28:12.8438534Z                              Set-Reg "HKLM:\SOFTWARE\Policies\Google\Chrome" "BackgroundModeEnabled" 0
2026-01-11T19:28:12.8439507Z                              # Edge
2026-01-11T19:28:12.8440065Z                              if (-not (Test-Path "HKLM:\SOFTWARE\Policies\Microsoft\Edge")) {
2026-01-11T19:28:12.8440900Z                                  New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Edge" -Force | Out-Null
2026-01-11T19:28:12.8441606Z                              }
2026-01-11T19:28:12.8442222Z                              Set-Reg "HKLM:\SOFTWARE\Policies\Microsoft\Edge" "StartupBoostEnabled" 0
2026-01-11T19:28:12.8443158Z                              Set-Reg "HKLM:\SOFTWARE\Policies\Microsoft\Edge" "BackgroundModeEnabled" 0
2026-01-11T19:28:12.8444117Z                              Set-Reg "HKLM:\SOFTWARE\Policies\Microsoft\Edge" "BackgroundExtensionsEnabled" 0
2026-01-11T19:28:12.8444983Z                              Write-OK "Browser background apps disabled"
2026-01-11T19:28:12.8445453Z                          }
2026-01-11T19:28:12.8445744Z                      }
2026-01-11T19:28:12.8446021Z                      
2026-01-11T19:28:12.8446981Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:12.8447678Z                      # MAIN EXECUTION
2026-01-11T19:28:12.8448593Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:12.8449703Z                      
2026-01-11T19:28:12.8449961Z                      Write-Banner
2026-01-11T19:28:12.8450299Z                      
2026-01-11T19:28:12.8450646Z                      # Show system info
2026-01-11T19:28:12.8451206Z                      $cpu = (Get-CimInstance Win32_Processor).Name
2026-01-11T19:28:12.8452681Z                      $gpu = (Get-CimInstance Win32_VideoController | Where-Object {$_.Status -eq "OK"} | Select-Object 
2026-01-11T19:28:12.8453759Z                      -First 1).Name
2026-01-11T19:28:12.8454846Z                      $ram = [math]::Round((Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property Capacity 
2026-01-11T19:28:12.8455754Z                      -Sum).Sum / 1GB)
2026-01-11T19:28:12.8456113Z                      
2026-01-11T19:28:12.8458259Z                      Write-Host "  System:" -ForegroundColor White
2026-01-11T19:28:12.8459178Z                      Write-Host "    OS:  $script:WinVersion (Build $script:WinBuild)" -ForegroundColor $(if 
2026-01-11T19:28:12.8459998Z                      ($script:IsWin11) { "Gray" } else { "Yellow" })
2026-01-11T19:28:12.8460575Z                      Write-Host "    CPU: $cpu" -ForegroundColor Gray
2026-01-11T19:28:12.8461167Z                      Write-Host "    GPU: $gpu" -ForegroundColor Gray
2026-01-11T19:28:12.8461779Z                      Write-Host "    RAM: ${ram}GB" -ForegroundColor Gray
2026-01-11T19:28:12.8462273Z                      
2026-01-11T19:28:12.8462577Z                      if (-not $script:IsWin11) {
2026-01-11T19:28:12.8462996Z                          Write-Host ""
2026-01-11T19:28:12.8463639Z                          Write-Host "  ! Windows 10 detected - some Win11-only options will be skipped" 
2026-01-11T19:28:12.8464361Z                      -ForegroundColor Yellow
2026-01-11T19:28:12.8464950Z                      }
2026-01-11T19:28:12.8465238Z                      Write-Host ""
2026-01-11T19:28:12.8465577Z                      
2026-01-11T19:28:12.8465861Z                      # Preset selection
2026-01-11T19:28:12.8466247Z                      if (-not $Preset) {
2026-01-11T19:28:12.8466762Z                          Write-Host "  Select a profile:" -ForegroundColor White
2026-01-11T19:28:12.8467302Z                          Write-Host ""
2026-01-11T19:28:12.8467996Z                          Write-Host "    [1] " -NoNewline; Write-Host "Casual Gamer" -NoNewline -ForegroundColor 
2026-01-11T19:28:12.8468858Z                      Green; Write-Host " - Safe defaults for everyday gaming"
2026-01-11T19:28:12.8469755Z                          Write-Host "    [2] " -NoNewline; Write-Host "Competitive Gamer" -NoNewline -ForegroundColor 
2026-01-11T19:28:12.8470654Z                      Cyan; Write-Host " - Maximum performance for esports"
2026-01-11T19:28:12.8471508Z                          Write-Host "    [3] " -NoNewline; Write-Host "Content Creator" -NoNewline -ForegroundColor 
2026-01-11T19:28:12.8472389Z                      Magenta; Write-Host " - Balanced for streaming + gaming"
2026-01-11T19:28:12.8473244Z                          Write-Host "    [4] " -NoNewline; Write-Host "Benchmarker" -NoNewline -ForegroundColor 
2026-01-11T19:28:12.8474063Z                      Yellow; Write-Host " - Absolute maximum performance"
2026-01-11T19:28:12.8474584Z                          Write-Host ""
2026-01-11T19:28:12.8475125Z                          Write-Host "  Choice (1-4): " -NoNewline -ForegroundColor Cyan
2026-01-11T19:28:12.8475721Z                          $choice = Read-Host
2026-01-11T19:28:12.8476093Z                      
2026-01-11T19:28:12.8476404Z                          $Preset = switch ($choice) {
2026-01-11T19:28:12.8477135Z                              '1' { 'gamer' }
2026-01-11T19:28:12.8477521Z                              '2' { 'pro_gamer' }
2026-01-11T19:28:12.8477941Z                              '3' { 'streamer' }
2026-01-11T19:28:12.8478351Z                              '4' { 'benchmarker' }
2026-01-11T19:28:12.8478765Z                              default { 'gamer' }
2026-01-11T19:28:12.8479140Z                          }
2026-01-11T19:28:12.8479430Z                      }
2026-01-11T19:28:12.8479697Z                      
2026-01-11T19:28:12.8498838Z                      $selectedPreset = $PRESETS[$Preset]
2026-01-11T19:28:12.8500631Z                      $optIds = $selectedPreset.opts
2026-01-11T19:28:12.8502050Z                      
2026-01-11T19:28:12.8502723Z                      Write-Host ""
2026-01-11T19:28:12.8503905Z                      Write-Host "  Selected: " -NoNewline
2026-01-11T19:28:12.8506538Z                      Write-Host $selectedPreset.name -ForegroundColor $selectedPreset.color
2026-01-11T19:28:12.8507821Z                      Write-Host "  $($selectedPreset.desc)" -ForegroundColor Gray
2026-01-11T19:28:12.8508595Z                      Write-Host "  Optimizations: $($optIds.Count)" -ForegroundColor Gray
2026-01-11T19:28:12.8509216Z                      Write-Host ""
2026-01-11T19:28:12.8509564Z                      
2026-01-11T19:28:12.8510052Z                      # Pre-flight scan
2026-01-11T19:28:12.8510727Z                      Write-Host "  Scanning current system state..." -ForegroundColor Gray
2026-01-11T19:28:12.8511422Z                      
2026-01-11T19:28:12.8511740Z                      foreach ($id in $optIds) {
2026-01-11T19:28:12.8512198Z                          $info = $OPT_DESCRIPTIONS[$id]
2026-01-11T19:28:12.8512651Z                          if (-not $info) { continue }
2026-01-11T19:28:12.8513054Z                      
2026-01-11T19:28:12.8513631Z                          $name = "[$($info.tier)] $($info.name)"
2026-01-11T19:28:12.8514100Z                          $current = "-"
2026-01-11T19:28:12.8514477Z                          $target = "Apply"
2026-01-11T19:28:12.8514861Z                          $status = "PENDING"
2026-01-11T19:28:12.8516297Z                      
2026-01-11T19:28:12.8516576Z                          switch ($id) {
2026-01-11T19:28:12.8516932Z                              '2' {
2026-01-11T19:28:12.8517574Z                                  try {
2026-01-11T19:28:12.8518225Z                                      $val = Get-ItemProperty "HKLM:\SYSTEM\CurrentControlSet\Control\Session 
2026-01-11T19:28:12.8519084Z                      Manager\Power" -Name "HiberbootEnabled" -EA SilentlyContinue
2026-01-11T19:28:12.8519904Z                                      if ($val.HiberbootEnabled -eq 0) { $current = "OFF"; $status = "OK" }
2026-01-11T19:28:12.8520717Z                                      else { $current = "ON"; $target = "OFF"; $status = "CHANGE" }
2026-01-11T19:28:12.8521288Z                                  } catch { }
2026-01-11T19:28:12.8521654Z                              }
2026-01-11T19:28:12.8521957Z                              '10' {
2026-01-11T19:28:12.8522302Z                                  try {
2026-01-11T19:28:12.8522979Z                                      $val = Get-ItemProperty "HKCU:\System\GameConfigStore" -Name "GameDVR_Enabled" 
2026-01-11T19:28:12.8523721Z                      -EA SilentlyContinue
2026-01-11T19:28:12.8524351Z                                      if ($val.GameDVR_Enabled -eq 0) { $current = "OFF"; $status = "OK" }
2026-01-11T19:28:12.8525136Z                                      else { $current = "ON"; $target = "OFF"; $status = "CHANGE" }
2026-01-11T19:28:12.8526124Z                                  } catch { }
2026-01-11T19:28:12.8526564Z                              }
2026-01-11T19:28:12.8526862Z                              '26' {
2026-01-11T19:28:12.8527185Z                                  try {
2026-01-11T19:28:12.8527882Z                                      $val = Get-ItemProperty "HKCU:\Control Panel\Mouse" -Name "MouseSpeed" -EA 
2026-01-11T19:28:12.8528646Z                      SilentlyContinue
2026-01-11T19:28:12.8529243Z                                      if ($val.MouseSpeed -eq "0") { $current = "OFF"; $status = "OK" }
2026-01-11T19:28:12.8530068Z                                      else { $current = "ON"; $target = "OFF"; $status = "CHANGE" }
2026-01-11T19:28:12.8530649Z                                  } catch { }
2026-01-11T19:28:12.8531026Z                              }
2026-01-11T19:28:12.8531328Z                              '29' {
2026-01-11T19:28:12.8531724Z                                  try {
2026-01-11T19:28:12.8532346Z                                      $val = Get-ItemProperty "HKCU:\Software\Microsoft\GameBar" -Name 
2026-01-11T19:28:12.8533096Z                      "AutoGameModeEnabled" -EA SilentlyContinue
2026-01-11T19:28:12.8534136Z                                      if ($val.AutoGameModeEnabled -eq 1) { $current = "ON"; $status = "OK" }
2026-01-11T19:28:12.8535079Z                                      else { $current = "OFF"; $target = "ON"; $status = "CHANGE" }
2026-01-11T19:28:12.8536017Z                                  } catch { }
2026-01-11T19:28:12.8536445Z                              }
2026-01-11T19:28:12.8536751Z                          }
2026-01-11T19:28:12.8537036Z                      
2026-01-11T19:28:12.8537657Z                          Add-ScanResult $name $current $target $status
2026-01-11T19:28:12.8538138Z                      }
2026-01-11T19:28:12.8538396Z                      
2026-01-11T19:28:12.8538679Z                      Write-ScanResults
2026-01-11T19:28:12.8539022Z                      
2026-01-11T19:28:12.8539284Z                      # Confirmation
2026-01-11T19:28:12.8539731Z                      if (-not $SkipConfirmation -and -not $DryRun) {
2026-01-11T19:28:12.8540583Z                          Write-Host "  Apply these optimizations? [Y]es / [N]o: " -NoNewline -ForegroundColor Cyan
2026-01-11T19:28:12.8541356Z                          $confirm = Read-Host
2026-01-11T19:28:12.8541784Z                          if ($confirm -notmatch '^[Yy]') {
2026-01-11T19:28:12.8542429Z                              Write-Host ""
2026-01-11T19:28:12.8542968Z                              Write-Host "  Cancelled by user" -ForegroundColor Yellow
2026-01-11T19:28:12.8543509Z                              exit 0
2026-01-11T19:28:12.8543840Z                          }
2026-01-11T19:28:12.8544113Z                      }
2026-01-11T19:28:12.8544372Z                      
2026-01-11T19:28:12.8544634Z                      if ($DryRun) {
2026-01-11T19:28:12.8544980Z                          Write-Host ""
2026-01-11T19:28:12.8545542Z                          Write-Host "  DRY RUN - No changes applied" -ForegroundColor Yellow
2026-01-11T19:28:12.8546144Z                          exit 0
2026-01-11T19:28:12.8546450Z                      }
2026-01-11T19:28:12.8546709Z                      
2026-01-11T19:28:12.8547000Z                      # Apply optimizations
2026-01-11T19:28:12.8547434Z                      Write-Step "Applying Optimizations"
2026-01-11T19:28:12.8547856Z                      
2026-01-11T19:28:12.8548146Z                      foreach ($id in $optIds) {
2026-01-11T19:28:12.8548676Z                          if (-not $OPT_FUNCTIONS.ContainsKey($id)) { continue }
2026-01-11T19:28:12.8549166Z                      
2026-01-11T19:28:12.8549463Z                          # Skip Win11-only on Win10
2026-01-11T19:28:12.8550020Z                          if (-not $script:IsWin11 -and $id -in $script:Win11OnlyIds) {
2026-01-11T19:28:12.8550619Z                              $info = $OPT_DESCRIPTIONS[$id]
2026-01-11T19:28:12.8554323Z                              Write-Host "  [SKIP] $($info.name) (requires Windows 11)" -ForegroundColor DarkGray
2026-01-11T19:28:12.8555758Z                              continue
2026-01-11T19:28:12.8556751Z                          }
2026-01-11T19:28:12.8561093Z                      
2026-01-11T19:28:12.8562045Z                          try {
2026-01-11T19:28:12.8571603Z                              & $OPT_FUNCTIONS[$id]
2026-01-11T19:28:12.8572718Z                          } catch {
2026-01-11T19:28:12.8576730Z                              Write-Fail "Failed: $($_.Exception.Message)"
2026-01-11T19:28:12.8578297Z                          }
2026-01-11T19:28:12.8582082Z                      }
2026-01-11T19:28:12.8582871Z                      
2026-01-11T19:28:12.8583359Z                      # Summary
2026-01-11T19:28:12.8583899Z                      Write-Step "Complete"
2026-01-11T19:28:12.8584285Z                      Write-Host ""
2026-01-11T19:28:12.8585067Z                      Write-Host "  +----------------------------------------+" -ForegroundColor White
2026-01-11T19:28:12.8585940Z                      Write-Host "  |           LOADOUT SUMMARY              |" -ForegroundColor White
2026-01-11T19:28:12.8587630Z                      Write-Host "  +----------------------------------------+" -ForegroundColor White
2026-01-11T19:28:12.8588305Z                      Write-Host ""
2026-01-11T19:28:12.8588946Z                      Write-Host "  Applied:  $($script:SuccessCount) changes" -ForegroundColor Green
2026-01-11T19:28:12.8589924Z                      if ($script:WarningCount -gt 0) { Write-Host "  Warnings: $($script:WarningCount)" 
2026-01-11T19:28:12.8590652Z                      -ForegroundColor Yellow }
2026-01-11T19:28:12.8591522Z                      if ($script:FailCount -gt 0) { Write-Host "  Failed:   $($script:FailCount)" -ForegroundColor Red 
2026-01-11T19:28:12.8592282Z                      }
2026-01-11T19:28:12.8592573Z                      Write-Host ""
2026-01-11T19:28:12.8594137Z                      Write-Host "  Reboot recommended for all changes to take effect." -ForegroundColor Cyan
2026-01-11T19:28:12.8594967Z                      Write-Host ""
2026-01-11T19:28:12.8595685Z                      Write-Host "  Source: https://rocktune.pedroferrari.com" -ForegroundColor DarkGray
2026-01-11T19:28:12.8597006Z                      Write-Host ""
2026-01-11T19:28:12.8597557Z                      
2026-01-11T19:28:12.8598362Z [32;1mParent             : [0m
2026-01-11T19:28:12.8598609Z 
2026-01-11T19:28:12.8740807Z [32;1mAttributes         : [0m{}
2026-01-11T19:28:12.8741668Z [32;1mUsingStatements    : [0m{}
2026-01-11T19:28:12.8742134Z [32;1mParamBlock         : [0mparam(
2026-01-11T19:28:12.8742466Z                          [string]$GameProcess = "",
2026-01-11T19:28:12.8743265Z                          [double]$Resolution = 0.5
2026-01-11T19:28:12.8743933Z                      )
2026-01-11T19:28:12.8744393Z [32;1mBeginBlock         : [0m
2026-01-11T19:28:12.8744784Z [32;1mProcessBlock       : [0m
2026-01-11T19:28:12.8745295Z [32;1mEndBlock           : [0mparam(
2026-01-11T19:28:12.8746583Z                          [string]$GameProcess = "",
2026-01-11T19:28:12.8746987Z                          [double]$Resolution = 0.5
2026-01-11T19:28:12.8748046Z                      )
2026-01-11T19:28:12.8748875Z                      
2026-01-11T19:28:12.8749835Z                      # Native interop wrapper for timer resolution APIs.
2026-01-11T19:28:12.8750239Z                      Add-Type @"
2026-01-11T19:28:12.8751306Z                      using System;
2026-01-11T19:28:12.8752174Z                      using System.Runtime.InteropServices;
2026-01-11T19:28:12.8752616Z                      
2026-01-11T19:28:12.8753750Z                      public class TimerResolution {
2026-01-11T19:28:12.8754224Z                          [DllImport("ntdll.dll", SetLastError = true)]
2026-01-11T19:28:12.8756011Z                          public static extern uint NtSetTimerResolution(uint DesiredResolution, bool SetResolution, 
2026-01-11T19:28:12.8757313Z                      out uint CurrentResolution);
2026-01-11T19:28:12.8757573Z                          
2026-01-11T19:28:12.8757942Z                          [DllImport("ntdll.dll", SetLastError = true)]
2026-01-11T19:28:12.8759461Z                          public static extern uint NtQueryTimerResolution(out uint MinimumResolution, out uint 
2026-01-11T19:28:12.8760640Z                      MaximumResolution, out uint CurrentResolution);
2026-01-11T19:28:12.8761142Z                          
2026-01-11T19:28:12.8761543Z                          [DllImport("winmm.dll", SetLastError = true)]
2026-01-11T19:28:12.8761970Z                          public static extern uint timeBeginPeriod(uint uPeriod);
2026-01-11T19:28:12.8762271Z                          
2026-01-11T19:28:12.8762763Z                          [DllImport("winmm.dll", SetLastError = true)]
2026-01-11T19:28:12.8763482Z                          public static extern uint timeEndPeriod(uint uPeriod);
2026-01-11T19:28:12.8764437Z                      }
2026-01-11T19:28:12.8764898Z                      "@
2026-01-11T19:28:12.8765959Z                      
2026-01-11T19:28:12.8767075Z                      <#
2026-01-11T19:28:12.8767366Z                      .SYNOPSIS
2026-01-11T19:28:12.8768422Z                          Requests a specific system timer resolution.
2026-01-11T19:28:12.8768751Z                      .DESCRIPTION
2026-01-11T19:28:12.8770290Z                          Converts milliseconds to the 100-nanosecond units required by NtSetTimerResolution
2026-01-11T19:28:12.8771307Z                          and requests the OS to adopt that resolution while this process is running.
2026-01-11T19:28:12.8771825Z                      .PARAMETER Milliseconds
2026-01-11T19:28:12.8773054Z                          Desired resolution in milliseconds.
2026-01-11T19:28:12.8774220Z                      .OUTPUTS
2026-01-11T19:28:12.8777484Z                          [bool] True when the native call reports STATUS_SUCCESS (0).
2026-01-11T19:28:12.8778052Z                      .NOTES
2026-01-11T19:28:12.8781047Z                          Requires admin privileges. This call is process-scoped and will be released when
2026-01-11T19:28:12.8785199Z                          the process exits.
2026-01-11T19:28:12.8786491Z                      #>
2026-01-11T19:28:12.8788131Z                      function Set-TimerResolution {
2026-01-11T19:28:12.8789205Z                          param([double]$Milliseconds)
2026-01-11T19:28:12.8789337Z                      
2026-01-11T19:28:12.8790944Z                          # Convert milliseconds to 100-nanosecond units (required by NtSetTimerResolution)
2026-01-11T19:28:12.8791923Z                          $period = [uint32]($Milliseconds * 10000)
2026-01-11T19:28:12.8792522Z                      
2026-01-11T19:28:12.8793448Z                          try {
2026-01-11T19:28:12.8794931Z                              $currentRes = [uint32]0
2026-01-11T19:28:12.8795804Z                              $result = [TimerResolution]::NtSetTimerResolution($period, $true, [ref]$currentRes)
2026-01-11T19:28:12.8796088Z                      
2026-01-11T19:28:12.8797544Z                              # NtSetTimerResolution returns 0 (STATUS_SUCCESS) on success
2026-01-11T19:28:12.8797785Z                              if ($result -eq 0) {
2026-01-11T19:28:12.8798621Z                                  return $true
2026-01-11T19:28:12.8799634Z                              } else {
2026-01-11T19:28:12.8801146Z                                  Write-Host "NtSetTimerResolution failed with status: 0x$($result.ToString('X8'))" 
2026-01-11T19:28:12.8801331Z                      -ForegroundColor Yellow
2026-01-11T19:28:12.8802178Z                                  return $false
2026-01-11T19:28:12.8803045Z                              }
2026-01-11T19:28:12.8804041Z                          } catch {
2026-01-11T19:28:12.8805009Z                              Write-Host "Error setting timer resolution: $_" -ForegroundColor Red
2026-01-11T19:28:12.8805258Z                              return $false
2026-01-11T19:28:12.8806359Z                          }
2026-01-11T19:28:12.8807145Z                      }
2026-01-11T19:28:12.8807910Z                      
2026-01-11T19:28:12.8808738Z                      <#
2026-01-11T19:28:12.8809544Z                      .SYNOPSIS
2026-01-11T19:28:12.8810396Z                          Reads the current system timer resolution.
2026-01-11T19:28:12.8811080Z                      .DESCRIPTION
2026-01-11T19:28:12.8812107Z                          Queries NtQueryTimerResolution and converts the current resolution to milliseconds.
2026-01-11T19:28:12.8812301Z                      .OUTPUTS
2026-01-11T19:28:12.8813541Z                          [double] Current timer resolution in milliseconds, or $null on failure.
2026-01-11T19:28:12.8814121Z                      #>
2026-01-11T19:28:12.8815118Z                      function Get-CurrentTimerResolution {
2026-01-11T19:28:12.8815842Z                          try {
2026-01-11T19:28:12.8816684Z                              $minRes = [uint32]0
2026-01-11T19:28:12.8817652Z                              $maxRes = [uint32]0
2026-01-11T19:28:12.8817861Z                              $curRes = [uint32]0
2026-01-11T19:28:12.8818927Z                              
2026-01-11T19:28:12.8819920Z                              $result = [TimerResolution]::NtQueryTimerResolution([ref]$minRes, [ref]$maxRes, 
2026-01-11T19:28:12.8820109Z                      [ref]$curRes)
2026-01-11T19:28:12.8821447Z                              
2026-01-11T19:28:12.8822329Z                              if ($result -eq 0) {
2026-01-11T19:28:12.8823152Z                                  $currentMs = $curRes / 10000.0
2026-01-11T19:28:12.8823884Z                                  return $currentMs
2026-01-11T19:28:12.8824540Z                              }
2026-01-11T19:28:12.8825401Z                              return $null
2026-01-11T19:28:12.8826201Z                          } catch {
2026-01-11T19:28:12.8827030Z                              return $null
2026-01-11T19:28:12.8827841Z                          }
2026-01-11T19:28:12.8828664Z                      }
2026-01-11T19:28:12.8829352Z                      
2026-01-11T19:28:12.8830329Z                      Write-Host "=== Timer Resolution Tool ===" -ForegroundColor Cyan
2026-01-11T19:28:12.8831179Z                      Write-Host "Maintaining $Resolution ms timer resolution to eliminate micro-stutters" 
2026-01-11T19:28:12.8831939Z                      -ForegroundColor Yellow
2026-01-11T19:28:12.8832685Z                      Write-Host ""
2026-01-11T19:28:12.8833621Z                      
2026-01-11T19:28:12.8834474Z                      $currentRes = Get-CurrentTimerResolution
2026-01-11T19:28:12.8835503Z                      if ($currentRes) {
2026-01-11T19:28:12.8836554Z                          Write-Host "Current system timer resolution: $([math]::Round($currentRes, 2)) ms" 
2026-01-11T19:28:12.8836779Z                      -ForegroundColor Yellow
2026-01-11T19:28:12.8837959Z                          Write-Host "Target timer resolution: $Resolution ms" -ForegroundColor Green
2026-01-11T19:28:12.8838569Z                      } else {
2026-01-11T19:28:12.8839579Z                          Write-Host "Could not query current timer resolution" -ForegroundColor Yellow
2026-01-11T19:28:12.8839783Z                      }
2026-01-11T19:28:12.8841166Z                      
2026-01-11T19:28:12.8842004Z                      Write-Host ""
2026-01-11T19:28:12.8843087Z                      Write-Host "Setting timer resolution to $Resolution ms..." -ForegroundColor Cyan
2026-01-11T19:28:12.8843303Z                      
2026-01-11T19:28:12.8844508Z                      if (Set-TimerResolution -Milliseconds $Resolution) {
2026-01-11T19:28:12.8845306Z                          $newRes = Get-CurrentTimerResolution
2026-01-11T19:28:12.8845978Z                          if ($newRes) {
2026-01-11T19:28:12.8847073Z                              Write-Host "Timer resolution set to: $([math]::Round($newRes, 2)) ms" -ForegroundColor 
2026-01-11T19:28:12.8847308Z                      Green
2026-01-11T19:28:12.8848381Z                          } else {
2026-01-11T19:28:12.8849375Z                              Write-Host "Timer resolution set (unable to verify)" -ForegroundColor Green
2026-01-11T19:28:12.8850022Z                          }
2026-01-11T19:28:12.8850751Z                      } else {
2026-01-11T19:28:12.8851872Z                          Write-Host "Failed to set timer resolution. Ensure you're running as Administrator." 
2026-01-11T19:28:12.8852126Z                      -ForegroundColor Red
2026-01-11T19:28:12.8853556Z                          exit 1
2026-01-11T19:28:12.8853657Z                      }
2026-01-11T19:28:12.8854529Z                      
2026-01-11T19:28:12.8855750Z                      Write-Host ""
2026-01-11T19:28:12.8856860Z                      Write-Host "Timer resolution will be maintained while this script is running." -ForegroundColor 
2026-01-11T19:28:12.8857053Z                      Yellow
2026-01-11T19:28:12.8858567Z                      Write-Host "Keep this window open while gaming." -ForegroundColor Yellow
2026-01-11T19:28:12.8859017Z                      Write-Host "Press Ctrl+C to stop and restore default timer resolution." -ForegroundColor Yellow
2026-01-11T19:28:12.8859795Z                      Write-Host ""
2026-01-11T19:28:12.8860588Z                      
2026-01-11T19:28:12.8861507Z                      if ($GameProcess) {
2026-01-11T19:28:12.8862444Z                          Write-Host "Monitoring for process: $GameProcess" -ForegroundColor Cyan
2026-01-11T19:28:12.8863401Z                          Write-Host "Script will exit when game closes." -ForegroundColor Yellow
2026-01-11T19:28:12.8864073Z                          Write-Host ""
2026-01-11T19:28:12.8864810Z                          
2026-01-11T19:28:12.8865790Z                          # Poll for process exit every few seconds to avoid busy looping.
2026-01-11T19:28:12.8866510Z                          $processRunning = $true
2026-01-11T19:28:12.8867351Z                          while ($processRunning) {
2026-01-11T19:28:12.8868330Z                              $process = Get-Process -Name $GameProcess -ErrorAction SilentlyContinue
2026-01-11T19:28:12.8868674Z                              if (-not $process) {
2026-01-11T19:28:12.8869863Z                                  Write-Host "Game process '$GameProcess' not found. Exiting..." -ForegroundColor Yellow
2026-01-11T19:28:12.8870092Z                                  $processRunning = $false
2026-01-11T19:28:12.8871160Z                              } else {
2026-01-11T19:28:12.8871977Z                                  Start-Sleep -Seconds 5
2026-01-11T19:28:12.8872829Z                              }
2026-01-11T19:28:12.8873582Z                          }
2026-01-11T19:28:12.8874402Z                      } else {
2026-01-11T19:28:12.8875486Z                          Write-Host "Running indefinitely. Press Ctrl+C to stop." -ForegroundColor Yellow
2026-01-11T19:28:12.8875710Z                          Write-Host ""
2026-01-11T19:28:12.8876762Z                          
2026-01-11T19:28:12.8877527Z                          try {
2026-01-11T19:28:12.8878282Z                              while ($true) {
2026-01-11T19:28:12.8879591Z                                  Start-Sleep -Seconds 1
2026-01-11T19:28:12.8879826Z                                  
2026-01-11T19:28:12.8881247Z                                  $current = Get-CurrentTimerResolution
2026-01-11T19:28:12.8881499Z                                  if ($current -and $current -gt ($Resolution * 2)) {
2026-01-11T19:28:12.8883018Z                                      Write-Host "[$(Get-Date -Format 'HH:mm:ss')] Timer resolution reset detected 
2026-01-11T19:28:12.8883649Z                      ($([math]::Round($current, 2)) ms). Re-applying..." -ForegroundColor Yellow
2026-01-11T19:28:12.8883989Z                                      Set-TimerResolution -Milliseconds $Resolution | Out-Null
2026-01-11T19:28:12.8884905Z                                  }
2026-01-11T19:28:12.8885715Z                              }
2026-01-11T19:28:12.8886336Z                          } catch {
2026-01-11T19:28:12.8886649Z                          }
2026-01-11T19:28:12.8887736Z                      }
2026-01-11T19:28:12.8888314Z                      
2026-01-11T19:28:12.8888448Z                      Write-Host ""
2026-01-11T19:28:12.8889960Z                      Write-Host "Timer resolution will be restored to default on exit." -ForegroundColor Yellow
2026-01-11T19:28:12.8890213Z                      Write-Host "Exiting..." -ForegroundColor Cyan
2026-01-11T19:28:12.8891586Z [32;1mCleanBlock         : [0m
2026-01-11T19:28:12.8892066Z [32;1mDynamicParamBlock  : [0m
2026-01-11T19:28:12.8892761Z [32;1mScriptRequirements : [0mSystem.Management.Automation.Language.ScriptRequirements
2026-01-11T19:28:12.8894314Z [32;1mExtent             : [0m<#
2026-01-11T19:28:12.8894525Z                      .SYNOPSIS
2026-01-11T19:28:12.8896431Z                          Forces and maintains a lower Windows timer resolution while gaming.
2026-01-11T19:28:12.8896685Z                      .DESCRIPTION
2026-01-11T19:28:12.8898084Z                          Uses native Windows APIs (NtSetTimerResolution / NtQueryTimerResolution)
2026-01-11T19:28:12.8898480Z                          to request a target timer resolution (default 0.5ms). When a GameProcess
2026-01-11T19:28:12.8899600Z                          is provided, the script monitors that process and exits when the game closes.
2026-01-11T19:28:12.8899762Z                      .PARAMETER GameProcess
2026-01-11T19:28:12.8901359Z                          Optional process name without extension (e.g., "cs2"). When supplied, the
2026-01-11T19:28:12.8901706Z                          script exits automatically once the process is no longer running.
2026-01-11T19:28:12.8902001Z                      .PARAMETER Resolution
2026-01-11T19:28:12.8903538Z                          Target timer resolution in milliseconds. Default is 0.5.
2026-01-11T19:28:12.8904340Z                      .EXAMPLE
2026-01-11T19:28:12.8905405Z                          .\timer-tool.ps1
2026-01-11T19:28:12.8906477Z                      .EXAMPLE
2026-01-11T19:28:12.8907562Z                          .\timer-tool.ps1 -GameProcess "dota2"
2026-01-11T19:28:12.8908342Z                      .EXAMPLE
2026-01-11T19:28:12.8909211Z                          .\timer-tool.ps1 -Resolution 1.0
2026-01-11T19:28:12.8909863Z                      .NOTES
2026-01-11T19:28:12.8910906Z                          Requires Administrator. The timer request is active only while the script runs.
2026-01-11T19:28:12.8911616Z                          Use Ctrl+C to exit if running in manual mode.
2026-01-11T19:28:12.8912318Z                      #>
2026-01-11T19:28:12.8913176Z                      #Requires -RunAsAdministrator
2026-01-11T19:28:12.8913647Z                      
2026-01-11T19:28:12.8914659Z                      
2026-01-11T19:28:12.8915509Z                      
2026-01-11T19:28:12.8916320Z                      param(
2026-01-11T19:28:12.8917136Z                          [string]$GameProcess = "",
2026-01-11T19:28:12.8917882Z                          [double]$Resolution = 0.5
2026-01-11T19:28:12.8918626Z                      )
2026-01-11T19:28:12.8919388Z                      
2026-01-11T19:28:12.8920305Z                      # Native interop wrapper for timer resolution APIs.
2026-01-11T19:28:12.8920953Z                      Add-Type @"
2026-01-11T19:28:12.8922002Z                      using System;
2026-01-11T19:28:12.8922857Z                      using System.Runtime.InteropServices;
2026-01-11T19:28:12.8923568Z                      
2026-01-11T19:28:12.8924508Z                      public class TimerResolution {
2026-01-11T19:28:12.8925310Z                          [DllImport("ntdll.dll", SetLastError = true)]
2026-01-11T19:28:12.8926459Z                          public static extern uint NtSetTimerResolution(uint DesiredResolution, bool SetResolution, 
2026-01-11T19:28:12.8927232Z                      out uint CurrentResolution);
2026-01-11T19:28:12.8928004Z                          
2026-01-11T19:28:12.8928779Z                          [DllImport("ntdll.dll", SetLastError = true)]
2026-01-11T19:28:12.8929877Z                          public static extern uint NtQueryTimerResolution(out uint MinimumResolution, out uint 
2026-01-11T19:28:12.8930200Z                      MaximumResolution, out uint CurrentResolution);
2026-01-11T19:28:12.8931818Z                          
2026-01-11T19:28:12.8932238Z                          [DllImport("winmm.dll", SetLastError = true)]
2026-01-11T19:28:12.8933418Z                          public static extern uint timeBeginPeriod(uint uPeriod);
2026-01-11T19:28:12.8934726Z                          
2026-01-11T19:28:12.8935482Z                          [DllImport("winmm.dll", SetLastError = true)]
2026-01-11T19:28:12.8936193Z                          public static extern uint timeEndPeriod(uint uPeriod);
2026-01-11T19:28:12.8936337Z                      }
2026-01-11T19:28:12.8937486Z                      "@
2026-01-11T19:28:12.8938323Z                      
2026-01-11T19:28:12.8939057Z                      <#
2026-01-11T19:28:12.8939911Z                      .SYNOPSIS
2026-01-11T19:28:12.8940789Z                          Requests a specific system timer resolution.
2026-01-11T19:28:12.8941542Z                      .DESCRIPTION
2026-01-11T19:28:12.8942649Z                          Converts milliseconds to the 100-nanosecond units required by NtSetTimerResolution
2026-01-11T19:28:12.8942956Z                          and requests the OS to adopt that resolution while this process is running.
2026-01-11T19:28:12.8943872Z                      .PARAMETER Milliseconds
2026-01-11T19:28:12.8944710Z                          Desired resolution in milliseconds.
2026-01-11T19:28:12.8945433Z                      .OUTPUTS
2026-01-11T19:28:12.8946361Z                          [bool] True when the native call reports STATUS_SUCCESS (0).
2026-01-11T19:28:12.8946928Z                      .NOTES
2026-01-11T19:28:12.8947965Z                          Requires admin privileges. This call is process-scoped and will be released when
2026-01-11T19:28:12.8948339Z                          the process exits.
2026-01-11T19:28:12.8949204Z                      #>
2026-01-11T19:28:12.8950037Z                      function Set-TimerResolution {
2026-01-11T19:28:12.8951391Z                          param([double]$Milliseconds)
2026-01-11T19:28:12.8951490Z                      
2026-01-11T19:28:12.8952237Z                          # Convert milliseconds to 100-nanosecond units (required by NtSetTimerResolution)
2026-01-11T19:28:12.8953073Z                          $period = [uint32]($Milliseconds * 10000)
2026-01-11T19:28:12.8953194Z                      
2026-01-11T19:28:12.8954173Z                          try {
2026-01-11T19:28:12.8954746Z                              $currentRes = [uint32]0
2026-01-11T19:28:12.8955342Z                              $result = [TimerResolution]::NtSetTimerResolution($period, $true, [ref]$currentRes)
2026-01-11T19:28:12.8956148Z                      
2026-01-11T19:28:12.8956688Z                              # NtSetTimerResolution returns 0 (STATUS_SUCCESS) on success
2026-01-11T19:28:12.8957634Z                              if ($result -eq 0) {
2026-01-11T19:28:12.8957966Z                                  return $true
2026-01-11T19:28:12.8959086Z                              } else {
2026-01-11T19:28:12.8960225Z                                  Write-Host "NtSetTimerResolution failed with status: 0x$($result.ToString('X8'))" 
2026-01-11T19:28:12.8960423Z                      -ForegroundColor Yellow
2026-01-11T19:28:12.8961446Z                                  return $false
2026-01-11T19:28:12.8962229Z                              }
2026-01-11T19:28:12.8963008Z                          } catch {
2026-01-11T19:28:12.8964045Z                              Write-Host "Error setting timer resolution: $_" -ForegroundColor Red
2026-01-11T19:28:12.8964298Z                              return $false
2026-01-11T19:28:12.8965359Z                          }
2026-01-11T19:28:12.8966156Z                      }
2026-01-11T19:28:12.8966899Z                      
2026-01-11T19:28:12.8967736Z                      <#
2026-01-11T19:28:12.8968522Z                      .SYNOPSIS
2026-01-11T19:28:12.8969394Z                          Reads the current system timer resolution.
2026-01-11T19:28:12.8970048Z                      .DESCRIPTION
2026-01-11T19:28:12.8971148Z                          Queries NtQueryTimerResolution and converts the current resolution to milliseconds.
2026-01-11T19:28:12.8971295Z                      .OUTPUTS
2026-01-11T19:28:12.8973056Z                          [double] Current timer resolution in milliseconds, or $null on failure.
2026-01-11T19:28:12.8973402Z                      #>
2026-01-11T19:28:12.8974668Z                      function Get-CurrentTimerResolution {
2026-01-11T19:28:12.8974928Z                          try {
2026-01-11T19:28:12.8975897Z                              $minRes = [uint32]0
2026-01-11T19:28:12.8976693Z                              $maxRes = [uint32]0
2026-01-11T19:28:12.8977465Z                              $curRes = [uint32]0
2026-01-11T19:28:12.8978111Z                              
2026-01-11T19:28:12.8979234Z                              $result = [TimerResolution]::NtQueryTimerResolution([ref]$minRes, [ref]$maxRes, 
2026-01-11T19:28:12.8979490Z                      [ref]$curRes)
2026-01-11T19:28:12.8980594Z                              
2026-01-11T19:28:12.8981376Z                              if ($result -eq 0) {
2026-01-11T19:28:12.8982203Z                                  $currentMs = $curRes / 10000.0
2026-01-11T19:28:12.8982984Z                                  return $currentMs
2026-01-11T19:28:12.8983699Z                              }
2026-01-11T19:28:12.8984526Z                              return $null
2026-01-11T19:28:12.8985245Z                          } catch {
2026-01-11T19:28:12.8985994Z                              return $null
2026-01-11T19:28:12.8986767Z                          }
2026-01-11T19:28:12.8987208Z                      }
2026-01-11T19:28:12.8988264Z                      
2026-01-11T19:28:12.8989179Z                      Write-Host "=== Timer Resolution Tool ===" -ForegroundColor Cyan
2026-01-11T19:28:12.8990243Z                      Write-Host "Maintaining $Resolution ms timer resolution to eliminate micro-stutters" 
2026-01-11T19:28:12.8990430Z                      -ForegroundColor Yellow
2026-01-11T19:28:12.8991683Z                      Write-Host ""
2026-01-11T19:28:12.8992516Z                      
2026-01-11T19:28:12.8993402Z                      $currentRes = Get-CurrentTimerResolution
2026-01-11T19:28:12.8994237Z                      if ($currentRes) {
2026-01-11T19:28:12.8995318Z                          Write-Host "Current system timer resolution: $([math]::Round($currentRes, 2)) ms" 
2026-01-11T19:28:12.8995566Z                      -ForegroundColor Yellow
2026-01-11T19:28:12.8996761Z                          Write-Host "Target timer resolution: $Resolution ms" -ForegroundColor Green
2026-01-11T19:28:12.8997329Z                      } else {
2026-01-11T19:28:12.8998382Z                          Write-Host "Could not query current timer resolution" -ForegroundColor Yellow
2026-01-11T19:28:12.8999128Z                      }
2026-01-11T19:28:12.8999892Z                      
2026-01-11T19:28:12.9000640Z                      Write-Host ""
2026-01-11T19:28:12.9001573Z                      Write-Host "Setting timer resolution to $Resolution ms..." -ForegroundColor Cyan
2026-01-11T19:28:12.9001953Z                      
2026-01-11T19:28:12.9003224Z                      if (Set-TimerResolution -Milliseconds $Resolution) {
2026-01-11T19:28:12.9003496Z                          $newRes = Get-CurrentTimerResolution
2026-01-11T19:28:12.9004498Z                          if ($newRes) {
2026-01-11T19:28:12.9006224Z                              Write-Host "Timer resolution set to: $([math]::Round($newRes, 2)) ms" -ForegroundColor 
2026-01-11T19:28:12.9006373Z                      Green
2026-01-11T19:28:12.9006524Z                          } else {
2026-01-11T19:28:12.9006922Z                              Write-Host "Timer resolution set (unable to verify)" -ForegroundColor Green
2026-01-11T19:28:12.9007058Z                          }
2026-01-11T19:28:12.9008147Z                      } else {
2026-01-11T19:28:12.9009742Z                          Write-Host "Failed to set timer resolution. Ensure you're running as Administrator." 
2026-01-11T19:28:12.9009910Z                      -ForegroundColor Red
2026-01-11T19:28:12.9010362Z                          exit 1
2026-01-11T19:28:12.9010480Z                      }
2026-01-11T19:28:12.9011310Z                      
2026-01-11T19:28:12.9012331Z                      Write-Host ""
2026-01-11T19:28:12.9013309Z                      Write-Host "Timer resolution will be maintained while this script is running." -ForegroundColor 
2026-01-11T19:28:12.9013651Z                      Yellow
2026-01-11T19:28:12.9014682Z                      Write-Host "Keep this window open while gaming." -ForegroundColor Yellow
2026-01-11T19:28:12.9015846Z                      Write-Host "Press Ctrl+C to stop and restore default timer resolution." -ForegroundColor Yellow
2026-01-11T19:28:12.9016101Z                      Write-Host ""
2026-01-11T19:28:12.9017104Z                      
2026-01-11T19:28:12.9017895Z                      if ($GameProcess) {
2026-01-11T19:28:12.9018965Z                          Write-Host "Monitoring for process: $GameProcess" -ForegroundColor Cyan
2026-01-11T19:28:12.9019298Z                          Write-Host "Script will exit when game closes." -ForegroundColor Yellow
2026-01-11T19:28:12.9020229Z                          Write-Host ""
2026-01-11T19:28:12.9021088Z                          
2026-01-11T19:28:12.9022091Z                          # Poll for process exit every few seconds to avoid busy looping.
2026-01-11T19:28:12.9022956Z                          $processRunning = $true
2026-01-11T19:28:12.9023573Z                          while ($processRunning) {
2026-01-11T19:28:12.9024871Z                              $process = Get-Process -Name $GameProcess -ErrorAction SilentlyContinue
2026-01-11T19:28:12.9025171Z                              if (-not $process) {
2026-01-11T19:28:12.9026381Z                                  Write-Host "Game process '$GameProcess' not found. Exiting..." -ForegroundColor Yellow
2026-01-11T19:28:12.9027034Z                                  $processRunning = $false
2026-01-11T19:28:12.9027754Z                              } else {
2026-01-11T19:28:12.9028588Z                                  Start-Sleep -Seconds 5
2026-01-11T19:28:12.9029307Z                              }
2026-01-11T19:28:12.9030054Z                          }
2026-01-11T19:28:12.9030766Z                      } else {
2026-01-11T19:28:12.9031832Z                          Write-Host "Running indefinitely. Press Ctrl+C to stop." -ForegroundColor Yellow
2026-01-11T19:28:12.9032667Z                          Write-Host ""
2026-01-11T19:28:12.9033730Z                          
2026-01-11T19:28:12.9034458Z                          try {
2026-01-11T19:28:12.9035410Z                              while ($true) {
2026-01-11T19:28:12.9036049Z                                  Start-Sleep -Seconds 1
2026-01-11T19:28:12.9036954Z                                  
2026-01-11T19:28:12.9037930Z                                  $current = Get-CurrentTimerResolution
2026-01-11T19:28:12.9038709Z                                  if ($current -and $current -gt ($Resolution * 2)) {
2026-01-11T19:28:12.9039772Z                                      Write-Host "[$(Get-Date -Format 'HH:mm:ss')] Timer resolution reset detected 
2026-01-11T19:28:12.9040591Z                      ($([math]::Round($current, 2)) ms). Re-applying..." -ForegroundColor Yellow
2026-01-11T19:28:12.9041325Z                                      Set-TimerResolution -Milliseconds $Resolution | Out-Null
2026-01-11T19:28:12.9041987Z                                  }
2026-01-11T19:28:12.9042698Z                              }
2026-01-11T19:28:12.9043540Z                          } catch {
2026-01-11T19:28:12.9044331Z                          }
2026-01-11T19:28:12.9045130Z                      }
2026-01-11T19:28:12.9045856Z                      
2026-01-11T19:28:12.9046682Z                      Write-Host ""
2026-01-11T19:28:12.9047621Z                      Write-Host "Timer resolution will be restored to default on exit." -ForegroundColor Yellow
2026-01-11T19:28:12.9048368Z                      Write-Host "Exiting..." -ForegroundColor Cyan
2026-01-11T19:28:12.9049085Z                      
2026-01-11T19:28:12.9050175Z [32;1mParent             : [0m
2026-01-11T19:28:12.9050300Z 
2026-01-11T19:28:12.9093858Z [32;1mAttributes         : [0m{}
2026-01-11T19:28:12.9094470Z [32;1mUsingStatements    : [0m{}
2026-01-11T19:28:12.9095502Z [32;1mParamBlock         : [0mparam(
2026-01-11T19:28:12.9096281Z                          [switch]$ResetConsent,
2026-01-11T19:28:12.9096977Z                          [switch]$AutoAccept
2026-01-11T19:28:12.9097808Z                      )
2026-01-11T19:28:12.9098746Z [32;1mBeginBlock         : [0m
2026-01-11T19:28:12.9099460Z [32;1mProcessBlock       : [0m
2026-01-11T19:28:12.9102676Z [32;1mEndBlock           : [0mparam(
2026-01-11T19:28:12.9112644Z                          [switch]$ResetConsent,
2026-01-11T19:28:12.9112924Z                          [switch]$AutoAccept
2026-01-11T19:28:12.9113013Z                      )
2026-01-11T19:28:12.9113108Z                      
2026-01-11T19:28:12.9113197Z                      
2026-01-11T19:28:12.9113337Z                      # ----------------------------
2026-01-11T19:28:12.9113491Z                      # Global behavior and helpers
2026-01-11T19:28:12.9113627Z                      # ----------------------------
2026-01-11T19:28:12.9113727Z                      
2026-01-11T19:28:12.9113898Z                      $ErrorActionPreference = "Stop"
2026-01-11T19:28:12.9114253Z                      $script:HadFailures = $false
2026-01-11T19:28:12.9114347Z                      $script:WingetAvailable = $false
2026-01-11T19:28:12.9114447Z                      $script:ResetConsent = $ResetConsent
2026-01-11T19:28:12.9114676Z                      $script:ConsentRoot = Join-Path $env:LOCALAPPDATA "WindowsGamingSettings"
2026-01-11T19:28:12.9114920Z                      $script:ConsentFilePath = Join-Path $script:ConsentRoot "benchmark-consent.json"
2026-01-11T19:28:12.9114975Z                      
2026-01-11T19:28:12.9115059Z                      # Progress tracking
2026-01-11T19:28:12.9115135Z                      $script:SectionIndex = 0
2026-01-11T19:28:12.9115208Z                      $script:SectionTotal = 0
2026-01-11T19:28:12.9115357Z                      
2026-01-11T19:28:12.9116569Z                      function Get-SectionTotal {
2026-01-11T19:28:12.9117371Z                          <#
2026-01-11T19:28:12.9118155Z                          .SYNOPSIS
2026-01-11T19:28:12.9119164Z                              Counts the number of Write-Section calls in the main script.
2026-01-11T19:28:12.9119425Z                          #>
2026-01-11T19:28:12.9120527Z                          param(
2026-01-11T19:28:12.9121816Z                              [string]$ScriptPath = $PSCommandPath
2026-01-11T19:28:12.9122542Z                          )
2026-01-11T19:28:12.9123328Z                      
2026-01-11T19:28:12.9124236Z                          if (-not $ScriptPath) {
2026-01-11T19:28:12.9125122Z                              $ScriptPath = $MyInvocation.MyCommand.Path
2026-01-11T19:28:12.9125796Z                          }
2026-01-11T19:28:12.9126548Z                      
2026-01-11T19:28:12.9127527Z                          if (-not $ScriptPath -or -not (Test-Path $ScriptPath)) {
2026-01-11T19:28:12.9128241Z                              return 1
2026-01-11T19:28:12.9129044Z                          }
2026-01-11T19:28:12.9129786Z                      
2026-01-11T19:28:12.9131888Z                          $matches = Select-String -Path $ScriptPath -Pattern 'Write-Section\s+["\']' -AllMatches
2026-01-11T19:28:12.9132309Z                          return [math]::Max(1, $matches.Count)
2026-01-11T19:28:12.9132641Z                      }
2026-01-11T19:28:12.9132909Z                      
2026-01-11T19:28:12.9133314Z                      $script:SectionTotal = Get-SectionTotal
2026-01-11T19:28:12.9133459Z                      
2026-01-11T19:28:12.9134249Z                      function Write-Section {
2026-01-11T19:28:12.9135026Z                          <#
2026-01-11T19:28:12.9135777Z                          .SYNOPSIS
2026-01-11T19:28:12.9136681Z                              Writes a high-visibility section header to the console.
2026-01-11T19:28:12.9137754Z                          .DESCRIPTION
2026-01-11T19:28:12.9138632Z                              Used to separate major phases such as installs, configuration, and launch.
2026-01-11T19:28:12.9139265Z                          #>
2026-01-11T19:28:12.9139846Z                          param(
2026-01-11T19:28:12.9140472Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:12.9140807Z                              [string]$Title
2026-01-11T19:28:12.9141888Z                          )
2026-01-11T19:28:12.9142018Z                      
2026-01-11T19:28:12.9143237Z                          $script:SectionIndex++
2026-01-11T19:28:12.9143902Z                          $pct = [math]::Min(100, [math]::Round(($script:SectionIndex / $script:SectionTotal) * 100))
2026-01-11T19:28:12.9145129Z                          Write-Progress -Activity "Benchmark Setup" -Status $Title -PercentComplete $pct 
2026-01-11T19:28:12.9146140Z                      -CurrentOperation "Step $($script:SectionIndex) of $($script:SectionTotal)"
2026-01-11T19:28:12.9146327Z                      
2026-01-11T19:28:12.9146459Z                          Write-Host ""
2026-01-11T19:28:12.9147722Z                          Write-Host "=== $Title ===" -ForegroundColor Cyan
2026-01-11T19:28:12.9148005Z                      }
2026-01-11T19:28:12.9148954Z                      
2026-01-11T19:28:12.9149238Z                      function Write-Note {
2026-01-11T19:28:12.9150403Z                          <#
2026-01-11T19:28:12.9151352Z                          .SYNOPSIS
2026-01-11T19:28:12.9152119Z                              Writes informational messages in a consistent format.
2026-01-11T19:28:12.9152273Z                          .DESCRIPTION
2026-01-11T19:28:12.9153326Z                              These messages are non-fatal and describe what the script is doing.
2026-01-11T19:28:12.9153449Z                          #>
2026-01-11T19:28:12.9154476Z                          param(
2026-01-11T19:28:12.9154797Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:12.9155774Z                              [string]$Message
2026-01-11T19:28:12.9156737Z                          )
2026-01-11T19:28:12.9157326Z                      
2026-01-11T19:28:12.9158064Z                          Write-Host "[INFO] $Message" -ForegroundColor Gray
2026-01-11T19:28:12.9158197Z                      }
2026-01-11T19:28:12.9159230Z                      
2026-01-11T19:28:12.9160168Z                      function Write-Warn {
2026-01-11T19:28:12.9160473Z                          <#
2026-01-11T19:28:12.9161575Z                          .SYNOPSIS
2026-01-11T19:28:12.9162302Z                              Writes warnings that do not stop execution.
2026-01-11T19:28:12.9162555Z                          .DESCRIPTION
2026-01-11T19:28:12.9163651Z                              Warnings indicate reduced automation or missing optional data.
2026-01-11T19:28:12.9163861Z                          #>
2026-01-11T19:28:12.9164804Z                          param(
2026-01-11T19:28:12.9165185Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:12.9166095Z                              [string]$Message
2026-01-11T19:28:12.9167257Z                          )
2026-01-11T19:28:12.9168013Z                      
2026-01-11T19:28:12.9168898Z                          Write-Host "[WARN] $Message" -ForegroundColor Yellow
2026-01-11T19:28:12.9170181Z                      }
2026-01-11T19:28:12.9170535Z                      
2026-01-11T19:28:12.9170753Z                      function Write-Fail {
2026-01-11T19:28:12.9170948Z                          <#
2026-01-11T19:28:12.9172304Z                          .SYNOPSIS
2026-01-11T19:28:12.9173631Z                              Writes a failure message and marks the run as having errors.
2026-01-11T19:28:12.9174214Z                          .DESCRIPTION
2026-01-11T19:28:12.9176003Z                              The script will still continue to the exit prompt for transparency.
2026-01-11T19:28:12.9176472Z                          #>
2026-01-11T19:28:12.9176571Z                          param(
2026-01-11T19:28:12.9176710Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:12.9176830Z                              [string]$Message
2026-01-11T19:28:12.9177235Z                          )
2026-01-11T19:28:12.9178451Z                      
2026-01-11T19:28:12.9179151Z                          $script:HadFailures = $true
2026-01-11T19:28:12.9179413Z                          Write-Host "[FAIL] $Message" -ForegroundColor Red
2026-01-11T19:28:12.9180575Z                      }
2026-01-11T19:28:12.9180730Z                      
2026-01-11T19:28:12.9181592Z                      function Write-Ok {
2026-01-11T19:28:12.9181845Z                          <#
2026-01-11T19:28:12.9183444Z                          .SYNOPSIS
2026-01-11T19:28:12.9183652Z                              Writes a success message.
2026-01-11T19:28:12.9184213Z                          .DESCRIPTION
2026-01-11T19:28:12.9185013Z                              Used to confirm expected outcomes like successful installs.
2026-01-11T19:28:12.9185562Z                          #>
2026-01-11T19:28:12.9186467Z                          param(
2026-01-11T19:28:12.9186679Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:12.9187806Z                              [string]$Message
2026-01-11T19:28:12.9188601Z                          )
2026-01-11T19:28:12.9188936Z                      
2026-01-11T19:28:12.9190211Z                          Write-Host "[OK] $Message" -ForegroundColor Green
2026-01-11T19:28:12.9190339Z                      }
2026-01-11T19:28:12.9191590Z                      
2026-01-11T19:28:12.9192833Z                      function Wait-ForUserExit {
2026-01-11T19:28:12.9193397Z                          <#
2026-01-11T19:28:12.9194561Z                          .SYNOPSIS
2026-01-11T19:28:12.9195000Z                              Always waits for a user key press before exiting.
2026-01-11T19:28:12.9195246Z                          .DESCRIPTION
2026-01-11T19:28:12.9196643Z                              This keeps the console open for users who double-click the script
2026-01-11T19:28:12.9197435Z                              and would otherwise lose the output.
2026-01-11T19:28:12.9198130Z                          #>
2026-01-11T19:28:12.9199108Z                          # Always pause so the user can read output, even on failure.
2026-01-11T19:28:12.9199707Z                          Write-Host ""
2026-01-11T19:28:12.9200511Z                          Write-Host "Press any key to exit..." -ForegroundColor Cyan
2026-01-11T19:28:12.9201329Z                          try {
2026-01-11T19:28:12.9202195Z                              $null = [System.Console]::ReadKey($true)
2026-01-11T19:28:12.9202917Z                          } catch {
2026-01-11T19:28:12.9203946Z                              # Fallback for hosts that do not support ReadKey (e.g., some terminals).
2026-01-11T19:28:12.9204247Z                              Read-Host "Press Enter to exit"
2026-01-11T19:28:12.9205279Z                          }
2026-01-11T19:28:12.9206028Z                      }
2026-01-11T19:28:12.9206799Z                      
2026-01-11T19:28:12.9207686Z                      function Show-RockTuneFinalChecklist {
2026-01-11T19:28:12.9208355Z                          <#
2026-01-11T19:28:12.9209117Z                          .SYNOPSIS
2026-01-11T19:28:12.9210068Z                              Prints a no-guesswork, step-by-step checklist after tools launch.
2026-01-11T19:28:12.9210304Z                          .DESCRIPTION
2026-01-11T19:28:12.9211948Z                              This is intentionally explicit for first-time users who need to know
2026-01-11T19:28:12.9212487Z                              exactly what to click and in what order. The checklist is short and
2026-01-11T19:28:12.9213380Z                              ends with clear completion cues.
2026-01-11T19:28:12.9214301Z                          #>
2026-01-11T19:28:12.9215058Z                          Write-Section "ROCKTUNE Benchmark Steps"
2026-01-11T19:28:12.9215658Z                      
2026-01-11T19:28:12.9216539Z                          $consoleWidth = 0
2026-01-11T19:28:12.9217289Z                          try {
2026-01-11T19:28:12.9218236Z                              $consoleWidth = $Host.UI.RawUI.WindowSize.Width
2026-01-11T19:28:12.9218872Z                          } catch {
2026-01-11T19:28:12.9219647Z                              $consoleWidth = 0
2026-01-11T19:28:12.9220348Z                          }
2026-01-11T19:28:12.9221108Z                      
2026-01-11T19:28:12.9221973Z                          function Get-LeftPad {
2026-01-11T19:28:12.9222646Z                              param(
2026-01-11T19:28:12.9223495Z                                  [Parameter(Mandatory=$true)]
2026-01-11T19:28:12.9224183Z                                  [int]$Width,
2026-01-11T19:28:12.9224855Z                      
2026-01-11T19:28:12.9225743Z                                  [Parameter(Mandatory=$true)]
2026-01-11T19:28:12.9226478Z                                  [int]$MaxLineLength
2026-01-11T19:28:12.9227467Z                              )
2026-01-11T19:28:12.9227752Z                      
2026-01-11T19:28:12.9228833Z                              if ($Width -le 0 -or $MaxLineLength -le 0) {
2026-01-11T19:28:12.9229576Z                                  return ""
2026-01-11T19:28:12.9230363Z                              }
2026-01-11T19:28:12.9231127Z                      
2026-01-11T19:28:12.9232334Z                              $pad = [math]::Floor(($Width - $MaxLineLength) / 2)
2026-01-11T19:28:12.9233007Z                              if ($pad -lt 0) {
2026-01-11T19:28:12.9233861Z                                  $pad = 0
2026-01-11T19:28:12.9234598Z                              }
2026-01-11T19:28:12.9235412Z                      
2026-01-11T19:28:12.9236213Z                              return (" " * $pad)
2026-01-11T19:28:12.9236956Z                          }
2026-01-11T19:28:12.9237786Z                      
2026-01-11T19:28:12.9238640Z                          $bannerLines = @(
2026-01-11T19:28:12.9239564Z                              "  ____   ___   ____ _  __ _______ _   _ _   _ _____",
2026-01-11T19:28:12.9240542Z                              " |  _ \ / _ \ / ___| |/ /|_   _| | | | | \ | | ____|",
2026-01-11T19:28:12.9241378Z                              " | |_) | | | | |   | ' /   | | | | | | |  \| |  _|",
2026-01-11T19:28:12.9242243Z                              " |  _ <| |_| | |___| . \   | | | |_| | | |\  | |___",
2026-01-11T19:28:12.9243097Z                              " |_| \_\\___/ \____|_|\_\  |_|  \___/|_|_| \_|_____|"
2026-01-11T19:28:12.9243805Z                          )
2026-01-11T19:28:12.9244560Z                      
2026-01-11T19:28:12.9245619Z                          $bannerMax = ($bannerLines | Measure-Object -Property Length -Maximum).Maximum
2026-01-11T19:28:12.9245937Z                          $bannerPad = Get-LeftPad -Width $consoleWidth -MaxLineLength $bannerMax
2026-01-11T19:28:12.9246808Z                      
2026-01-11T19:28:12.9247664Z                          foreach ($line in $bannerLines) {
2026-01-11T19:28:12.9248424Z                              Write-Host ($bannerPad + $line) -ForegroundColor Cyan
2026-01-11T19:28:12.9249876Z                          }
2026-01-11T19:28:12.9251041Z                      
2026-01-11T19:28:12.9251404Z                          $useTwoColumns = $false
2026-01-11T19:28:12.9252176Z                          if ($consoleWidth -ge 120) {
2026-01-11T19:28:12.9253947Z                              $useTwoColumns = $true
2026-01-11T19:28:12.9254481Z                          }
2026-01-11T19:28:12.9255840Z                      
2026-01-11T19:28:12.9256125Z                          $sections = @(
2026-01-11T19:28:12.9257171Z                              @{
2026-01-11T19:28:12.9258196Z                                  Title = "FIRST STEPS"
2026-01-11T19:28:12.9258855Z                                  Lines = @(
2026-01-11T19:28:12.9259861Z                                      '[ ] Confirm the tools are open',
2026-01-11T19:28:12.9260606Z                                      '    - CapFrameX is running',
2026-01-11T19:28:12.9260862Z                                      '    - Unigine Superposition is open',
2026-01-11T19:28:12.9261840Z                                      '    - LatencyMon is open'
2026-01-11T19:28:12.9262790Z                                  )
2026-01-11T19:28:12.9263591Z                              },
2026-01-11T19:28:12.9264369Z                              @{
2026-01-11T19:28:12.9265269Z                                  Title = "CONFIGURE CAPFRAMEX (ONCE)"
2026-01-11T19:28:12.9265925Z                                  Lines = @(
2026-01-11T19:28:12.9266752Z                                      '[ ] Capture API: PresentMon',
2026-01-11T19:28:12.9267490Z                                      '[ ] Capture duration: 60s',
2026-01-11T19:28:12.9268225Z                                      '[ ] Start delay: 3s',
2026-01-11T19:28:12.9269001Z                                      '[ ] Hotkey: F11 (start/stop capture)'
2026-01-11T19:28:12.9269716Z                                  )
2026-01-11T19:28:12.9270796Z                              },
2026-01-11T19:28:12.9271600Z                              @{
2026-01-11T19:28:12.9272751Z                                  Title = "CONFIGURE SUPERPOSITION (ONCE)"
2026-01-11T19:28:12.9272964Z                                  Lines = @(
2026-01-11T19:28:12.9274094Z                                      '[ ] Preset: 1080p Medium',
2026-01-11T19:28:12.9274835Z                                      '[ ] Fullscreen: On',
2026-01-11T19:28:12.9275605Z                                      '[ ] VSync: Off'
2026-01-11T19:28:12.9276353Z                                  )
2026-01-11T19:28:12.9277105Z                              },
2026-01-11T19:28:12.9277841Z                              @{
2026-01-11T19:28:12.9278612Z                                  Title = "BEFORE CHANGES"
2026-01-11T19:28:12.9279428Z                                  Lines = @(
2026-01-11T19:28:12.9280315Z                                      '[ ] Warm-up run (no capture)',
2026-01-11T19:28:12.9281126Z                                      '    - Click RUN in Superposition',
2026-01-11T19:28:12.9281919Z                                      '    - Let the run finish',
2026-01-11T19:28:12.9282676Z                                      '[ ] Captured runs (before)',
2026-01-11T19:28:12.9283432Z                                      '    - Press F11 at start, F11 at end',
2026-01-11T19:28:12.9284350Z                                      '    - Do 2 valid runs; discard first if shader compilation occurs'
2026-01-11T19:28:12.9284888Z                                  )
2026-01-11T19:28:12.9285656Z                              },
2026-01-11T19:28:12.9286428Z                              @{
2026-01-11T19:28:12.9287266Z                                  Title = "LATENCYMON"
2026-01-11T19:28:12.9288026Z                                  Lines = @(
2026-01-11T19:28:12.9288868Z                                      '[ ] Click Start, run for ~5 minutes',
2026-01-11T19:28:12.9289911Z                                      '    - Screenshot Main tab',
2026-01-11T19:28:12.9290135Z                                      '    - Screenshot Drivers tab'
2026-01-11T19:28:12.9290947Z                                  )
2026-01-11T19:28:12.9291740Z                              },
2026-01-11T19:28:12.9292527Z                              @{
2026-01-11T19:28:12.9293504Z                                  Title = "APPLY ROCKTUNE CHANGES"
2026-01-11T19:28:12.9293775Z                                  Lines = @(
2026-01-11T19:28:12.9294984Z                                      '[ ] Run your optimization flow',
2026-01-11T19:28:12.9295831Z                                      '[ ] Reboot if requested'
2026-01-11T19:28:12.9296799Z                                  )
2026-01-11T19:28:12.9297058Z                              },
2026-01-11T19:28:12.9298134Z                              @{
2026-01-11T19:28:12.9298987Z                                  Title = "AFTER CHANGES"
2026-01-11T19:28:12.9299761Z                                  Lines = @(
2026-01-11T19:28:12.9300644Z                                      '[ ] Repeat the captured runs',
2026-01-11T19:28:12.9301555Z                                      '    - Same settings, same steps, same number of runs'
2026-01-11T19:28:12.9302147Z                                  )
2026-01-11T19:28:12.9302944Z                              },
2026-01-11T19:28:12.9303695Z                              @{
2026-01-11T19:28:12.9304544Z                                  Title = "EXPORT EVIDENCE"
2026-01-11T19:28:12.9305285Z                                  Lines = @(
2026-01-11T19:28:12.9306222Z                                      '[ ] CapFrameX -> Analysis -> Aggregate',
2026-01-11T19:28:12.9306926Z                                      '[ ] Export CSV + HTML summary'
2026-01-11T19:28:12.9307661Z                                  )
2026-01-11T19:28:12.9308172Z                              },
2026-01-11T19:28:12.9309229Z                              @{
2026-01-11T19:28:12.9310211Z                                  Title = "OPTIONAL INPUT LAG (FREE METHOD)"
2026-01-11T19:28:12.9311124Z                                  Lines = @(
2026-01-11T19:28:12.9312010Z                                      '[ ] Record 10 clicks at 240fps',
2026-01-11T19:28:12.9313262Z                                      '[ ] Count frames from click to pixel change',
2026-01-11T19:28:12.9313491Z                                      '[ ] 1 frame at 240fps = 4.17ms'
2026-01-11T19:28:12.9314515Z                                  )
2026-01-11T19:28:12.9314830Z                              }
2026-01-11T19:28:12.9315809Z                          )
2026-01-11T19:28:12.9316050Z                      
2026-01-11T19:28:12.9317032Z                          function Get-SectionLines {
2026-01-11T19:28:12.9317792Z                              param(
2026-01-11T19:28:12.9318651Z                                  [Parameter(Mandatory=$true)]
2026-01-11T19:28:12.9319037Z                                  [hashtable]$Section
2026-01-11T19:28:12.9320023Z                              )
2026-01-11T19:28:12.9320672Z                      
2026-01-11T19:28:12.9321802Z                              $lines = @("== $($Section.Title) ==")
2026-01-11T19:28:12.9322584Z                              foreach ($line in $Section.Lines) {
2026-01-11T19:28:12.9323657Z                                  $lines += $line
2026-01-11T19:28:12.9324295Z                              }
2026-01-11T19:28:12.9324387Z                      
2026-01-11T19:28:12.9325204Z                              return $lines
2026-01-11T19:28:12.9326266Z                          }
2026-01-11T19:28:12.9327366Z                      
2026-01-11T19:28:12.9327670Z                          $lineItems = @()
2026-01-11T19:28:12.9328612Z                      
2026-01-11T19:28:12.9329189Z                          if ($useTwoColumns) {
2026-01-11T19:28:12.9330322Z                              $leftWidth = 58
2026-01-11T19:28:12.9331261Z                              for ($i = 0; $i -lt $sections.Count; $i += 2) {
2026-01-11T19:28:12.9332248Z                                  $left = Get-SectionLines -Section $sections[$i]
2026-01-11T19:28:12.9332411Z                                  $right = @()
2026-01-11T19:28:12.9333682Z                                  if ($i + 1 -lt $sections.Count) {
2026-01-11T19:28:12.9334072Z                                      $right = Get-SectionLines -Section $sections[$i + 1]
2026-01-11T19:28:12.9335016Z                                  }
2026-01-11T19:28:12.9335302Z                      
2026-01-11T19:28:12.9336524Z                                  $maxLines = [math]::Max($left.Count, $right.Count)
2026-01-11T19:28:12.9337133Z                                  for ($lineIndex = 0; $lineIndex -lt $maxLines; $lineIndex++) {
2026-01-11T19:28:12.9337769Z                                      $leftText = ""
2026-01-11T19:28:12.9338352Z                                      $rightText = ""
2026-01-11T19:28:12.9338974Z                                      if ($lineIndex -lt $left.Count) {
2026-01-11T19:28:12.9339664Z                                          $leftText = $left[$lineIndex]
2026-01-11T19:28:12.9339856Z                                      }
2026-01-11T19:28:12.9340976Z                                      if ($lineIndex -lt $right.Count) {
2026-01-11T19:28:12.9341344Z                                          $rightText = $right[$lineIndex]
2026-01-11T19:28:12.9342349Z                                      }
2026-01-11T19:28:12.9342663Z                      
2026-01-11T19:28:12.9343992Z                                      $lineItems += ($leftText.PadRight($leftWidth) + $rightText)
2026-01-11T19:28:12.9344122Z                                  }
2026-01-11T19:28:12.9345110Z                      
2026-01-11T19:28:12.9345750Z                                  $lineItems += ""
2026-01-11T19:28:12.9346426Z                              }
2026-01-11T19:28:12.9348410Z                          } else {
2026-01-11T19:28:12.9348587Z                              foreach ($section in $sections) {
2026-01-11T19:28:12.9349161Z                                  $lineItems += ""
2026-01-11T19:28:12.9349396Z                                  $lineItems += "== $($section.Title) =="
2026-01-11T19:28:12.9349718Z                                  foreach ($line in $section.Lines) {
2026-01-11T19:28:12.9350450Z                                      $lineItems += $line
2026-01-11T19:28:12.9351215Z                                  }
2026-01-11T19:28:12.9351999Z                              }
2026-01-11T19:28:12.9352315Z                          }
2026-01-11T19:28:12.9353274Z                      
2026-01-11T19:28:12.9354274Z                          if ($lineItems.Count -gt 0 -and $lineItems[0] -eq "") {
2026-01-11T19:28:12.9355086Z                              $lineItems = $lineItems[1..($lineItems.Count - 1)]
2026-01-11T19:28:12.9355303Z                          }
2026-01-11T19:28:12.9356406Z                      
2026-01-11T19:28:12.9357062Z                          $maxLineLength = ($lineItems | Measure-Object -Property Length -Maximum).Maximum
2026-01-11T19:28:12.9358077Z                          $checklistPad = Get-LeftPad -Width $consoleWidth -MaxLineLength $maxLineLength
2026-01-11T19:28:12.9358251Z                          foreach ($line in $lineItems) {
2026-01-11T19:28:12.9359475Z                              Write-Host ($checklistPad + $line) -ForegroundColor White
2026-01-11T19:28:12.9359590Z                          }
2026-01-11T19:28:12.9360710Z                      }
2026-01-11T19:28:12.9361369Z                      
2026-01-11T19:28:12.9362204Z                      function Prompt-YesNo {
2026-01-11T19:28:12.9362992Z                          <#
2026-01-11T19:28:12.9363798Z                          .SYNOPSIS
2026-01-11T19:28:12.9364699Z                              Prompts until a valid yes/no response is provided.
2026-01-11T19:28:12.9365272Z                          .DESCRIPTION
2026-01-11T19:28:12.9366263Z                              Accepts Y/Yes or N/No (case-insensitive). Returns $true for yes,
2026-01-11T19:28:12.9366611Z                              $false for no. This avoids accidental defaults on invalid input.
2026-01-11T19:28:12.9367523Z                          #>
2026-01-11T19:28:12.9368287Z                          param(
2026-01-11T19:28:12.9369119Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:12.9369810Z                              [string]$Message
2026-01-11T19:28:12.9370781Z                          )
2026-01-11T19:28:12.9371637Z                      
2026-01-11T19:28:12.9372421Z                          while ($true) {
2026-01-11T19:28:12.9373477Z                              $response = Read-Host $Message
2026-01-11T19:28:12.9373715Z                              if ($response -match '^(y|yes)$') {
2026-01-11T19:28:12.9374736Z                                  return $true
2026-01-11T19:28:12.9375610Z                              }
2026-01-11T19:28:12.9376438Z                              if ($response -match '^(n|no)$') {
2026-01-11T19:28:12.9377180Z                                  return $false
2026-01-11T19:28:12.9377891Z                              }
2026-01-11T19:28:12.9378608Z                      
2026-01-11T19:28:12.9379489Z                              Write-Warn "Please answer Y or N."
2026-01-11T19:28:12.9380143Z                          }
2026-01-11T19:28:12.9380926Z                      }
2026-01-11T19:28:12.9381714Z                      
2026-01-11T19:28:12.9382517Z                      function Get-ConsentCache {
2026-01-11T19:28:12.9383245Z                          <#
2026-01-11T19:28:12.9384060Z                          .SYNOPSIS
2026-01-11T19:28:12.9384970Z                              Reads the stored install consent, if present.
2026-01-11T19:28:12.9385700Z                          .DESCRIPTION
2026-01-11T19:28:12.9386327Z                              Returns $true or $false when a saved choice exists, otherwise $null.
2026-01-11T19:28:12.9387549Z                              The cache is stored under the current user profile in LocalAppData.
2026-01-11T19:28:12.9388164Z                          #>
2026-01-11T19:28:12.9389137Z                          if (-not (Test-Path $script:ConsentFilePath)) {
2026-01-11T19:28:12.9390072Z                              return $null
2026-01-11T19:28:12.9391556Z                          }
2026-01-11T19:28:12.9392349Z                      
2026-01-11T19:28:12.9393113Z                          try {
2026-01-11T19:28:12.9394206Z                              $data = Get-Content $script:ConsentFilePath -Raw | ConvertFrom-Json
2026-01-11T19:28:12.9394455Z                          } catch {
2026-01-11T19:28:12.9395590Z                              return $null
2026-01-11T19:28:12.9396372Z                          }
2026-01-11T19:28:12.9397170Z                      
2026-01-11T19:28:12.9398016Z                          if ($null -eq $data) {
2026-01-11T19:28:12.9398801Z                              return $null
2026-01-11T19:28:12.9399549Z                          }
2026-01-11T19:28:12.9400253Z                      
2026-01-11T19:28:12.9401411Z                          if ($data.PSObject.Properties.Name -contains "InstallConsent") {
2026-01-11T19:28:12.9401756Z                              return [bool]$data.InstallConsent
2026-01-11T19:28:12.9402808Z                          }
2026-01-11T19:28:12.9403604Z                      
2026-01-11T19:28:12.9404412Z                          return $null
2026-01-11T19:28:12.9405126Z                      }
2026-01-11T19:28:12.9405915Z                      
2026-01-11T19:28:12.9406755Z                      function Set-ConsentCache {
2026-01-11T19:28:12.9407519Z                          <#
2026-01-11T19:28:12.9409378Z                          .SYNOPSIS
2026-01-11T19:28:12.9410312Z                              Persists the install consent choice for future runs.
2026-01-11T19:28:12.9410608Z                          .DESCRIPTION
2026-01-11T19:28:12.9411971Z                              Stores a small JSON file with the user's choice and a timestamp.
2026-01-11T19:28:12.9412375Z                              Users can reset it with -ResetConsent or by deleting the file.
2026-01-11T19:28:12.9413386Z                          #>
2026-01-11T19:28:12.9413994Z                          param(
2026-01-11T19:28:12.9415039Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:12.9419561Z                              [bool]$InstallConsent
2026-01-11T19:28:12.9420582Z                          )
2026-01-11T19:28:12.9421329Z                      
2026-01-11T19:28:12.9423175Z                          if (-not (Test-Path $script:ConsentRoot)) {
2026-01-11T19:28:12.9423580Z                              New-Item -Path $script:ConsentRoot -ItemType Directory -Force | Out-Null
2026-01-11T19:28:12.9423724Z                          }
2026-01-11T19:28:12.9424905Z                      
2026-01-11T19:28:12.9425772Z                          $payload = @{
2026-01-11T19:28:12.9426625Z                              InstallConsent = $InstallConsent
2026-01-11T19:28:12.9427539Z                              UpdatedAtUtc = (Get-Date).ToUniversalTime().ToString("o")
2026-01-11T19:28:12.9428533Z                              Source = "benchmark-setup.ps1"
2026-01-11T19:28:12.9428661Z                          }
2026-01-11T19:28:12.9429523Z                      
2026-01-11T19:28:12.9430667Z                          $payload | ConvertTo-Json -Depth 3 | Set-Content -Path $script:ConsentFilePath -Encoding UTF8
2026-01-11T19:28:12.9430817Z                      }
2026-01-11T19:28:12.9431851Z                      
2026-01-11T19:28:12.9432693Z                      function Confirm-InstallConsent {
2026-01-11T19:28:12.9433427Z                          <#
2026-01-11T19:28:12.9434242Z                          .SYNOPSIS
2026-01-11T19:28:12.9434855Z                              Prompts the user for explicit consent before installing software.
2026-01-11T19:28:12.9435803Z                          .DESCRIPTION
2026-01-11T19:28:12.9436710Z                              This script uses winget to install tools. Some users want a hard
2026-01-11T19:28:12.9437522Z                              opt-in before any install activity starts. This function ensures
2026-01-11T19:28:12.9437908Z                              that no package installation occurs without a clear confirmation.
2026-01-11T19:28:12.9438812Z                          #>
2026-01-11T19:28:12.9439619Z                          param(
2026-01-11T19:28:12.9440459Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:12.9441219Z                              [string[]]$PackageNames
2026-01-11T19:28:12.9441920Z                          )
2026-01-11T19:28:12.9442637Z                      
2026-01-11T19:28:12.9443434Z                          Write-Section "Install Consent"
2026-01-11T19:28:12.9444332Z                          Write-Note "This script can install the following tools via winget:"
2026-01-11T19:28:12.9444614Z                          foreach ($name in $PackageNames) {
2026-01-11T19:28:12.9445695Z                              Write-Host "  - $name" -ForegroundColor White
2026-01-11T19:28:12.9446372Z                          }
2026-01-11T19:28:12.9447339Z                          Write-Note "No installations will occur without your consent."
2026-01-11T19:28:12.9448070Z                          Write-Note "Consent cache path: $script:ConsentFilePath"
2026-01-11T19:28:12.9449288Z                          Write-Note "Reset the cached choice with: .\\benchmark-setup.ps1 -ResetConsent"
2026-01-11T19:28:12.9449845Z                      
2026-01-11T19:28:12.9450882Z                          if ($script:ResetConsent -and (Test-Path $script:ConsentFilePath)) {
2026-01-11T19:28:12.9451118Z                              try {
2026-01-11T19:28:12.9452304Z                                  Remove-Item -Path $script:ConsentFilePath -Force
2026-01-11T19:28:12.9453167Z                                  Write-Ok "Consent cache cleared."
2026-01-11T19:28:12.9453858Z                              } catch {
2026-01-11T19:28:12.9454931Z                                  Write-Warn "Unable to remove consent cache. You may need to delete it manually."
2026-01-11T19:28:12.9455109Z                              }
2026-01-11T19:28:12.9456238Z                              $script:ResetConsent = $false
2026-01-11T19:28:12.9456985Z                          }
2026-01-11T19:28:12.9457746Z                      
2026-01-11T19:28:12.9458704Z                          # -------------------------------------------------------------------------
2026-01-11T19:28:12.9459508Z                          # AUTO-ACCEPT MODE
2026-01-11T19:28:12.9459835Z                          # -------------------------------------------------------------------------
2026-01-11T19:28:12.9460993Z                          # When -AutoAccept is specified, we skip all interactive prompts and
2026-01-11T19:28:12.9461349Z                          # automatically grant install consent. This is useful for:
2026-01-11T19:28:12.9462403Z                          #   - CI/CD pipelines where no human is present to answer prompts
2026-01-11T19:28:12.9463112Z                          #   - Automated testing environments
2026-01-11T19:28:12.9464020Z                          #   - Scripted deployments where you've already reviewed the tools
2026-01-11T19:28:12.9464263Z                          #
2026-01-11T19:28:12.9465507Z                          # The auto-accept does NOT save to the consent cache - it only affects
2026-01-11T19:28:12.9466464Z                          # the current execution. If you want to permanently allow installs without
2026-01-11T19:28:12.9466794Z                          # prompts, run once interactively and choose "Y" to remember.
2026-01-11T19:28:12.9467728Z                          #
2026-01-11T19:28:12.9468291Z                          # Usage: .\benchmark-setup.ps1 -AutoAccept
2026-01-11T19:28:12.9470279Z                          # -------------------------------------------------------------------------
2026-01-11T19:28:12.9470447Z                          if ($script:AutoAccept) {
2026-01-11T19:28:12.9470879Z                              Write-Ok "Auto-accept mode: installs are allowed."
2026-01-11T19:28:12.9471147Z                              return $true
2026-01-11T19:28:12.9472255Z                          }
2026-01-11T19:28:12.9473026Z                      
2026-01-11T19:28:12.9473943Z                          $cached = Get-ConsentCache
2026-01-11T19:28:12.9474707Z                          if ($null -ne $cached) {
2026-01-11T19:28:12.9475489Z                              if ($cached) {
2026-01-11T19:28:12.9476405Z                                  Write-Ok "Using saved consent: installs are allowed."
2026-01-11T19:28:12.9477011Z                              } else {
2026-01-11T19:28:12.9477925Z                                  Write-Warn "Using saved consent: installs are blocked."
2026-01-11T19:28:12.9478610Z                              }
2026-01-11T19:28:12.9479397Z                              return $cached
2026-01-11T19:28:12.9480139Z                          }
2026-01-11T19:28:12.9480871Z                      
2026-01-11T19:28:12.9481924Z                          $installConsent = Prompt-YesNo -Message "Install missing tools now? (Y/N)"
2026-01-11T19:28:12.9482126Z                      
2026-01-11T19:28:12.9483374Z                          $remember = Prompt-YesNo -Message "Remember this choice for next time? (Y/N)"
2026-01-11T19:28:12.9484065Z                          if ($remember) {
2026-01-11T19:28:12.9484824Z                              try {
2026-01-11T19:28:12.9485751Z                                  Set-ConsentCache -InstallConsent $installConsent
2026-01-11T19:28:12.9486382Z                                  Write-Ok "Consent saved."
2026-01-11T19:28:12.9487075Z                              } catch {
2026-01-11T19:28:12.9488062Z                                  Write-Warn "Unable to save consent cache. It will ask again next time."
2026-01-11T19:28:12.9488302Z                              }
2026-01-11T19:28:12.9489821Z                          }
2026-01-11T19:28:12.9490460Z                      
2026-01-11T19:28:12.9491309Z                          if ($installConsent) {
2026-01-11T19:28:12.9492270Z                              Write-Ok "Consent granted. Proceeding with installs when needed."
2026-01-11T19:28:12.9492520Z                          } else {
2026-01-11T19:28:12.9493806Z                              Write-Warn "Consent not granted. Skipping winget install and package installs."
2026-01-11T19:28:12.9494435Z                          }
2026-01-11T19:28:12.9495412Z                      
2026-01-11T19:28:12.9496126Z                          return $installConsent
2026-01-11T19:28:12.9496799Z                      }
2026-01-11T19:28:12.9497613Z                      
2026-01-11T19:28:12.9498397Z                      
2026-01-11T19:28:12.9499195Z                      # ----------------------------
2026-01-11T19:28:12.9499978Z                      # Winget detection and install
2026-01-11T19:28:12.9500770Z                      # ----------------------------
2026-01-11T19:28:12.9501529Z                      
2026-01-11T19:28:12.9502353Z                      function Test-WingetAvailable {
2026-01-11T19:28:12.9503081Z                          <#
2026-01-11T19:28:12.9503809Z                          .SYNOPSIS
2026-01-11T19:28:12.9504672Z                              Returns true if winget is callable.
2026-01-11T19:28:12.9505320Z                          .DESCRIPTION
2026-01-11T19:28:12.9506327Z                              Uses "winget --version" and checks the exit code. This avoids relying
2026-01-11T19:28:12.9506682Z                              on PATH heuristics and provides a simple availability check.
2026-01-11T19:28:12.9507706Z                          #>
2026-01-11T19:28:12.9508401Z                          try {
2026-01-11T19:28:12.9509595Z                              $null = winget --version 2>&1
2026-01-11T19:28:12.9510584Z                              return ($LASTEXITCODE -eq 0)
2026-01-11T19:28:12.9511349Z                          } catch {
2026-01-11T19:28:12.9512206Z                              return $false
2026-01-11T19:28:12.9512981Z                          }
2026-01-11T19:28:12.9513684Z                      }
2026-01-11T19:28:12.9514455Z                      
2026-01-11T19:28:12.9515324Z                      function Install-WingetIfMissing {
2026-01-11T19:28:12.9515972Z                          <#
2026-01-11T19:28:12.9516741Z                          .SYNOPSIS
2026-01-11T19:28:12.9517663Z                              Attempts to install winget if not already available.
2026-01-11T19:28:12.9518262Z                          .DESCRIPTION
2026-01-11T19:28:12.9519258Z                              The Microsoft-supported path is the App Installer package. This function:
2026-01-11T19:28:12.9519569Z                                1) Tries to open the Microsoft Store App Installer page.
2026-01-11T19:28:12.9520721Z                                2) Falls back to downloading the App Installer bundle from aka.ms.
2026-01-11T19:28:12.9521323Z                      
2026-01-11T19:28:12.9522396Z                              This mirrors the logic used in the main gaming-pc-setup script, but is
2026-01-11T19:28:12.9523115Z                              fully self-contained here for a standalone benchmark script.
2026-01-11T19:28:12.9523718Z                          #>
2026-01-11T19:28:12.9524644Z                          Write-Section "Winget Availability"
2026-01-11T19:28:12.9525461Z                          Write-Note "Checking if winget is available..."
2026-01-11T19:28:12.9526041Z                      
2026-01-11T19:28:12.9526918Z                          if (Test-WingetAvailable) {
2026-01-11T19:28:12.9527670Z                              $version = winget --version 2>&1
2026-01-11T19:28:12.9528496Z                              Write-Ok "winget is available ($version)."
2026-01-11T19:28:12.9529244Z                              return $true
2026-01-11T19:28:12.9530039Z                          }
2026-01-11T19:28:12.9530799Z                      
2026-01-11T19:28:12.9531785Z                          Write-Warn "winget is not available. Attempting installation."
2026-01-11T19:28:12.9532337Z                      
2026-01-11T19:28:12.9533195Z                          # Method 1: Microsoft Store App Installer page.
2026-01-11T19:28:12.9533868Z                          try {
2026-01-11T19:28:12.9535115Z                              $storeApp = Get-AppxPackage -Name "Microsoft.WindowsStore" -ErrorAction SilentlyContinue
2026-01-11T19:28:12.9535310Z                              if ($storeApp) {
2026-01-11T19:28:12.9536276Z                                  Write-Note "Opening Microsoft Store App Installer page."
2026-01-11T19:28:12.9537268Z                                  Start-Process "ms-windows-store://pdp/?ProductId=9NBLGGH4NNS1" -ErrorAction 
2026-01-11T19:28:12.9537485Z                      SilentlyContinue
2026-01-11T19:28:12.9538784Z                                  Write-Warn "Install 'App Installer' from the Store, then rerun this script."
2026-01-11T19:28:12.9539489Z                                  return $false
2026-01-11T19:28:12.9540259Z                              } else {
2026-01-11T19:28:12.9541252Z                                  Write-Warn "Microsoft Store not detected. Using direct download fallback."
2026-01-11T19:28:12.9541441Z                              }
2026-01-11T19:28:12.9542507Z                          } catch {
2026-01-11T19:28:12.9543635Z                              Write-Warn "Unable to open the Microsoft Store. Using direct download fallback."
2026-01-11T19:28:12.9543828Z                          }
2026-01-11T19:28:12.9544787Z                      
2026-01-11T19:28:12.9545695Z                          # Method 2: Direct download from Microsoft.
2026-01-11T19:28:12.9546420Z                          try {
2026-01-11T19:28:12.9547286Z                              $appInstallerUrl = "https://aka.ms/getwinget"
2026-01-11T19:28:12.9548153Z                              $downloadPath = Join-Path $env:TEMP "Microsoft.DesktopAppInstaller.msixbundle"
2026-01-11T19:28:12.9548343Z                      
2026-01-11T19:28:12.9550577Z                              Write-Note "Downloading App Installer bundle from $appInstallerUrl"
2026-01-11T19:28:12.9551296Z                              Invoke-WebRequest -Uri $appInstallerUrl -OutFile $downloadPath -UseBasicParsing 
2026-01-11T19:28:12.9551683Z                      -TimeoutSec 60 -ErrorAction Stop
2026-01-11T19:28:12.9551804Z                      
2026-01-11T19:28:12.9552836Z                              Write-Note "Installing App Installer bundle"
2026-01-11T19:28:12.9553800Z                              Add-AppxPackage -Path $downloadPath -ErrorAction Stop
2026-01-11T19:28:12.9554391Z                      
2026-01-11T19:28:12.9555316Z                              Remove-Item $downloadPath -ErrorAction SilentlyContinue
2026-01-11T19:28:12.9555573Z                      
2026-01-11T19:28:12.9556916Z                              Write-Ok "App Installer installed. Please restart PowerShell and rerun this script."
2026-01-11T19:28:12.9557198Z                              return $false
2026-01-11T19:28:12.9558208Z                          } catch {
2026-01-11T19:28:12.9559176Z                              Write-Fail "Failed to install App Installer. Install manually from 
2026-01-11T19:28:12.9559853Z                      https://aka.ms/getwinget"
2026-01-11T19:28:12.9560605Z                              return $false
2026-01-11T19:28:12.9561400Z                          }
2026-01-11T19:28:12.9562215Z                      }
2026-01-11T19:28:12.9562941Z                      
2026-01-11T19:28:12.9563668Z                      
2026-01-11T19:28:12.9564449Z                      # ----------------------------
2026-01-11T19:28:12.9565252Z                      # Package install and path resolution
2026-01-11T19:28:12.9565911Z                      # ----------------------------
2026-01-11T19:28:12.9567090Z                      
2026-01-11T19:28:12.9567897Z                      function Test-WingetPackageInstalled {
2026-01-11T19:28:12.9568996Z                          <#
2026-01-11T19:28:12.9569809Z                          .SYNOPSIS
2026-01-11T19:28:12.9570755Z                              Checks if a package is installed via winget list output.
2026-01-11T19:28:12.9571367Z                          .DESCRIPTION
2026-01-11T19:28:12.9572536Z                              Uses "winget list" and matches the package identifier in the output.
2026-01-11T19:28:12.9572928Z                              This works even when winget cannot reliably report install locations.
2026-01-11T19:28:12.9573676Z                          #>
2026-01-11T19:28:12.9574428Z                          param(
2026-01-11T19:28:12.9575265Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:12.9575973Z                              [string]$PackageId
2026-01-11T19:28:12.9576669Z                          )
2026-01-11T19:28:12.9577399Z                      
2026-01-11T19:28:12.9578150Z                          try {
2026-01-11T19:28:12.9579260Z                              $output = winget list --id $PackageId --source winget --accept-source-agreements 2>&1
2026-01-11T19:28:12.9579459Z                              if ($LASTEXITCODE -ne 0) {
2026-01-11T19:28:12.9580572Z                                  return $false
2026-01-11T19:28:12.9581399Z                              }
2026-01-11T19:28:12.9582181Z                      
2026-01-11T19:28:12.9583140Z                              return ($output -match [regex]::Escape($PackageId))
2026-01-11T19:28:12.9583720Z                          } catch {
2026-01-11T19:28:12.9584228Z                              return $false
2026-01-11T19:28:12.9585275Z                          }
2026-01-11T19:28:12.9586050Z                      }
2026-01-11T19:28:12.9586798Z                      
2026-01-11T19:28:12.9588111Z                      function Install-WingetPackage {
2026-01-11T19:28:12.9588337Z                          <#
2026-01-11T19:28:12.9589404Z                          .SYNOPSIS
2026-01-11T19:28:12.9590247Z                              Installs a package by winget ID, with verification.
2026-01-11T19:28:12.9590945Z                          .DESCRIPTION
2026-01-11T19:28:12.9591930Z                              Some winget installers return non-zero exit codes even when successful.
2026-01-11T19:28:12.9592261Z                              This function re-checks install state to avoid false negatives.
2026-01-11T19:28:12.9593235Z                          #>
2026-01-11T19:28:12.9593948Z                          param(
2026-01-11T19:28:12.9594801Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:12.9595512Z                              [string]$PackageId,
2026-01-11T19:28:12.9596234Z                      
2026-01-11T19:28:12.9597048Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:12.9597783Z                              [string]$PackageName
2026-01-11T19:28:12.9598505Z                          )
2026-01-11T19:28:12.9599232Z                      
2026-01-11T19:28:12.9600237Z                          if (Test-WingetPackageInstalled -PackageId $PackageId) {
2026-01-11T19:28:12.9600930Z                              Write-Ok "$PackageName already installed."
2026-01-11T19:28:12.9601566Z                              return $true
2026-01-11T19:28:12.9602282Z                          }
2026-01-11T19:28:12.9602995Z                      
2026-01-11T19:28:12.9603871Z                          Write-Note "Installing $PackageName via winget ($PackageId)."
2026-01-11T19:28:12.9604916Z                          $null = winget install --id $PackageId --source winget --accept-package-agreements 
2026-01-11T19:28:12.9605150Z                      --accept-source-agreements --silent 2>&1
2026-01-11T19:28:12.9606102Z                      
2026-01-11T19:28:12.9606923Z                          if ($LASTEXITCODE -eq 0) {
2026-01-11T19:28:12.9607921Z                              Write-Ok "$PackageName installed."
2026-01-11T19:28:12.9608663Z                              return $true
2026-01-11T19:28:12.9609403Z                          }
2026-01-11T19:28:12.9610142Z                      
2026-01-11T19:28:12.9611154Z                          # Some installs return a non-zero exit code even if the package is present.
2026-01-11T19:28:12.9611461Z                          if (Test-WingetPackageInstalled -PackageId $PackageId) {
2026-01-11T19:28:12.9612756Z                              Write-Ok "$PackageName already installed (post-install verification)."
2026-01-11T19:28:12.9612888Z                              return $true
2026-01-11T19:28:12.9613895Z                          }
2026-01-11T19:28:12.9614583Z                      
2026-01-11T19:28:12.9615640Z                          Write-Fail "Failed to install $PackageName (winget exit code $LASTEXITCODE)."
2026-01-11T19:28:12.9615853Z                          return $false
2026-01-11T19:28:12.9616926Z                      }
2026-01-11T19:28:12.9617687Z                      
2026-01-11T19:28:12.9618584Z                      function Get-RegistryInstallLocations {
2026-01-11T19:28:12.9619331Z                          <#
2026-01-11T19:28:12.9620092Z                          .SYNOPSIS
2026-01-11T19:28:12.9621072Z                              Finds install locations using registry uninstall entries.
2026-01-11T19:28:12.9621397Z                          .DESCRIPTION
2026-01-11T19:28:12.9622605Z                              This is a reliable fallback when installers register their paths.
2026-01-11T19:28:12.9623554Z                              It checks both 64-bit and 32-bit views to cover legacy installers.
2026-01-11T19:28:12.9623928Z                          #>
2026-01-11T19:28:12.9625007Z                          param(
2026-01-11T19:28:12.9625928Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:12.9626734Z                              [string]$DisplayNamePattern
2026-01-11T19:28:12.9627879Z                          )
2026-01-11T19:28:12.9628702Z                      
2026-01-11T19:28:12.9629774Z                          # Look for installer entries in HKLM and HKCU (both 64-bit and 32-bit views).
2026-01-11T19:28:12.9630423Z                          $registryPaths = @(
2026-01-11T19:28:12.9631451Z                              "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*",
2026-01-11T19:28:12.9632315Z                              "HKLM:\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall\*",
2026-01-11T19:28:12.9632622Z                              "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*"
2026-01-11T19:28:12.9633560Z                          )
2026-01-11T19:28:12.9634293Z                      
2026-01-11T19:28:12.9635091Z                          $locations = @()
2026-01-11T19:28:12.9635917Z                          foreach ($path in $registryPaths) {
2026-01-11T19:28:12.9636598Z                              try {
2026-01-11T19:28:12.9637480Z                                  $items = Get-ItemProperty -Path $path -ErrorAction SilentlyContinue |
2026-01-11T19:28:12.9638488Z                                      Where-Object { $_.DisplayName -like $DisplayNamePattern }
2026-01-11T19:28:12.9639044Z                      
2026-01-11T19:28:12.9639896Z                                  foreach ($item in $items) {
2026-01-11T19:28:12.9640648Z                                      if ($item.InstallLocation) {
2026-01-11T19:28:12.9641431Z                                          $locations += $item.InstallLocation
2026-01-11T19:28:12.9642134Z                                      } elseif ($item.DisplayIcon) {
2026-01-11T19:28:12.9642986Z                                          $locations += (Split-Path -Parent $item.DisplayIcon)
2026-01-11T19:28:12.9643498Z                                      }
2026-01-11T19:28:12.9644280Z                                  }
2026-01-11T19:28:12.9645057Z                              } catch {
2026-01-11T19:28:12.9645975Z                                  # Ignore registry access errors to keep the script robust.
2026-01-11T19:28:12.9646533Z                              }
2026-01-11T19:28:12.9647263Z                          }
2026-01-11T19:28:12.9647766Z                      
2026-01-11T19:28:12.9649116Z                          return $locations | Select-Object -Unique
2026-01-11T19:28:12.9649834Z                      }
2026-01-11T19:28:12.9650883Z                      
2026-01-11T19:28:12.9651651Z                      function Get-WingetInstalledLocation {
2026-01-11T19:28:12.9652336Z                          <#
2026-01-11T19:28:12.9653093Z                          .SYNOPSIS
2026-01-11T19:28:12.9654028Z                              Attempts to read the installed location from winget JSON output.
2026-01-11T19:28:12.9654629Z                          .DESCRIPTION
2026-01-11T19:28:12.9655585Z                              Newer winget versions can output JSON for "winget list".
2026-01-11T19:28:12.9656401Z                              When present, the JSON may include an install location field.
2026-01-11T19:28:12.9657207Z                              This is not guaranteed across versions, so this is best-effort only.
2026-01-11T19:28:12.9657766Z                          .OUTPUTS
2026-01-11T19:28:12.9658704Z                              [string] Install location path or $null if not available.
2026-01-11T19:28:12.9659303Z                          #>
2026-01-11T19:28:12.9660067Z                          param(
2026-01-11T19:28:12.9660847Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:12.9661566Z                              [string]$PackageId
2026-01-11T19:28:12.9661994Z                          )
2026-01-11T19:28:12.9663116Z                      
2026-01-11T19:28:12.9663962Z                          if (-not $script:WingetAvailable) {
2026-01-11T19:28:12.9664691Z                              return $null
2026-01-11T19:28:12.9665446Z                          }
2026-01-11T19:28:12.9666199Z                      
2026-01-11T19:28:12.9666861Z                          try {
2026-01-11T19:28:12.9668520Z                              $jsonText = winget list --id $PackageId --source winget --accept-source-agreements 
2026-01-11T19:28:12.9668741Z                      --output json 2>&1
2026-01-11T19:28:12.9669953Z                              if ($LASTEXITCODE -ne 0) {
2026-01-11T19:28:12.9670809Z                                  return $null
2026-01-11T19:28:12.9671563Z                              }
2026-01-11T19:28:12.9672336Z                      
2026-01-11T19:28:12.9673323Z                              $data = $jsonText | ConvertFrom-Json -ErrorAction Stop
2026-01-11T19:28:12.9673963Z                          } catch {
2026-01-11T19:28:12.9674723Z                              return $null
2026-01-11T19:28:12.9675440Z                          }
2026-01-11T19:28:12.9676169Z                      
2026-01-11T19:28:12.9676944Z                          $packages = @()
2026-01-11T19:28:12.9677718Z                          if ($data.Sources) {
2026-01-11T19:28:12.9678513Z                              foreach ($source in $data.Sources) {
2026-01-11T19:28:12.9679208Z                                  if ($source.Packages) {
2026-01-11T19:28:12.9680041Z                                      $packages += $source.Packages
2026-01-11T19:28:12.9680709Z                                  }
2026-01-11T19:28:12.9681426Z                              }
2026-01-11T19:28:12.9682214Z                          } elseif ($data.Packages) {
2026-01-11T19:28:12.9682989Z                              $packages += $data.Packages
2026-01-11T19:28:12.9683664Z                          }
2026-01-11T19:28:12.9684448Z                      
2026-01-11T19:28:12.9685278Z                          $match = $packages | Where-Object {
2026-01-11T19:28:12.9686189Z                              $_.PackageIdentifier -eq $PackageId -or $_.Id -eq $PackageId
2026-01-11T19:28:12.9686470Z                          } | Select-Object -First 1
2026-01-11T19:28:12.9687444Z                      
2026-01-11T19:28:12.9688480Z                          if (-not $match) {
2026-01-11T19:28:12.9689390Z                              return $null
2026-01-11T19:28:12.9690138Z                          }
2026-01-11T19:28:12.9690844Z                      
2026-01-11T19:28:12.9692140Z                          $locationProps = @("InstallLocation", "InstalledLocation", "Location", "InstallPath", 
2026-01-11T19:28:12.9692262Z                      "InstalledPath")
2026-01-11T19:28:12.9693311Z                          foreach ($prop in $locationProps) {
2026-01-11T19:28:12.9694258Z                              if ($match.PSObject.Properties.Name -contains $prop -and $match.$prop) {
2026-01-11T19:28:12.9694524Z                                  return $match.$prop
2026-01-11T19:28:12.9695546Z                              }
2026-01-11T19:28:12.9696305Z                          }
2026-01-11T19:28:12.9697035Z                      
2026-01-11T19:28:12.9697877Z                          return $null
2026-01-11T19:28:12.9698584Z                      }
2026-01-11T19:28:12.9699305Z                      
2026-01-11T19:28:12.9700164Z                      function Resolve-ExecutablePath {
2026-01-11T19:28:12.9700886Z                          <#
2026-01-11T19:28:12.9701676Z                          .SYNOPSIS
2026-01-11T19:28:12.9702684Z                              Resolves the full path to a tool executable.
2026-01-11T19:28:12.9703431Z                          .DESCRIPTION
2026-01-11T19:28:12.9704430Z                              Uses a multi-step strategy:
2026-01-11T19:28:12.9705567Z                                1) Known default paths (fast and deterministic)
2026-01-11T19:28:12.9706366Z                                2) Winget JSON install location (best effort)
2026-01-11T19:28:12.9707232Z                                3) Registry uninstall entries (best effort)
2026-01-11T19:28:12.9708370Z                                4) Limited folder scan under known vendor roots
2026-01-11T19:28:12.9709507Z                          #>
2026-01-11T19:28:12.9710094Z                          param(
2026-01-11T19:28:12.9711221Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:12.9711930Z                              [string[]]$ExeNames,
2026-01-11T19:28:12.9712679Z                      
2026-01-11T19:28:12.9713600Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:12.9714897Z                              [string[]]$DefaultCandidates,
2026-01-11T19:28:12.9715024Z                      
2026-01-11T19:28:12.9716057Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:12.9716245Z                              [string]$RegistryNamePattern,
2026-01-11T19:28:12.9717199Z                      
2026-01-11T19:28:12.9718420Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:12.9718901Z                              [string]$PackageId
2026-01-11T19:28:12.9719539Z                          )
2026-01-11T19:28:12.9720661Z                      
2026-01-11T19:28:12.9721105Z                          # Winget does not reliably expose install paths for all packages, so we use:
2026-01-11T19:28:12.9721652Z                          # 1) Known default paths (fast and predictable)
2026-01-11T19:28:12.9722737Z                          # 2) Winget JSON install location (best effort)
2026-01-11T19:28:12.9723452Z                          # 3) Registry uninstall entries (best effort)
2026-01-11T19:28:12.9723727Z                          # 4) Limited directory search under known vendor roots
2026-01-11T19:28:12.9724690Z                          #
2026-01-11T19:28:12.9725091Z                          # This keeps the script deterministic while still finding installs that
2026-01-11T19:28:12.9725898Z                          # do not use the defaults.
2026-01-11T19:28:12.9727252Z                      
2026-01-11T19:28:12.9727572Z                          # 1) Check known default paths first (fast and predictable).
2026-01-11T19:28:12.9728691Z                          foreach ($candidate in $DefaultCandidates) {
2026-01-11T19:28:12.9729452Z                              if (Test-Path $candidate) {
2026-01-11T19:28:12.9730225Z                                  return $candidate
2026-01-11T19:28:12.9731257Z                              }
2026-01-11T19:28:12.9731366Z                          }
2026-01-11T19:28:12.9732416Z                      
2026-01-11T19:28:12.9733632Z                          # 2) Check winget JSON install location (if supported by the local winget).
2026-01-11T19:28:12.9734030Z                          $wingetLocation = Get-WingetInstalledLocation -PackageId $PackageId
2026-01-11T19:28:12.9734618Z                          if ($wingetLocation -and (Test-Path $wingetLocation)) {
2026-01-11T19:28:12.9735780Z                              $wingetItem = Get-Item $wingetLocation -ErrorAction SilentlyContinue
2026-01-11T19:28:12.9736078Z                              if ($wingetItem -and -not $wingetItem.PSIsContainer) {
2026-01-11T19:28:12.9737087Z                                  return $wingetLocation
2026-01-11T19:28:12.9737197Z                              }
2026-01-11T19:28:12.9738622Z                      
2026-01-11T19:28:12.9738830Z                              foreach ($exeName in $ExeNames) {
2026-01-11T19:28:12.9740030Z                                  $wingetExe = Join-Path $wingetLocation $exeName
2026-01-11T19:28:12.9740236Z                                  if (Test-Path $wingetExe) {
2026-01-11T19:28:12.9741375Z                                      return $wingetExe
2026-01-11T19:28:12.9741736Z                                  }
2026-01-11T19:28:12.9741868Z                      
2026-01-11T19:28:12.9743350Z                                  $wingetBinExe = Join-Path (Join-Path $wingetLocation "bin") $exeName
2026-01-11T19:28:12.9743802Z                                  if (Test-Path $wingetBinExe) {
2026-01-11T19:28:12.9744615Z                                      return $wingetBinExe
2026-01-11T19:28:12.9745357Z                                  }
2026-01-11T19:28:12.9746599Z                              }
2026-01-11T19:28:12.9747605Z                          }
2026-01-11T19:28:12.9748243Z                      
2026-01-11T19:28:12.9749525Z                          # 3) Check install locations reported in the registry.
2026-01-11T19:28:12.9750368Z                          $registryLocations = Get-RegistryInstallLocations -DisplayNamePattern $RegistryNamePattern
2026-01-11T19:28:12.9750579Z                          foreach ($location in $registryLocations) {
2026-01-11T19:28:12.9751097Z                              foreach ($exeName in $ExeNames) {
2026-01-11T19:28:12.9751316Z                                  $exePath = Join-Path $location $exeName
2026-01-11T19:28:12.9752122Z                                  if (Test-Path $exePath) {
2026-01-11T19:28:12.9752941Z                                      return $exePath
2026-01-11T19:28:12.9754098Z                                  }
2026-01-11T19:28:12.9754217Z                      
2026-01-11T19:28:12.9755559Z                                  # Some installers put binaries in a subfolder like "bin".
2026-01-11T19:28:12.9755843Z                                  $binExePath = Join-Path (Join-Path $location "bin") $exeName
2026-01-11T19:28:12.9756863Z                                  if (Test-Path $binExePath) {
2026-01-11T19:28:12.9757505Z                                      return $binExePath
2026-01-11T19:28:12.9757614Z                                  }
2026-01-11T19:28:12.9758504Z                              }
2026-01-11T19:28:12.9759260Z                          }
2026-01-11T19:28:12.9760116Z                      
2026-01-11T19:28:12.9761116Z                          # 4) Last resort: search a specific root if it exists.
2026-01-11T19:28:12.9762078Z                          # This is intentionally limited to known vendor roots to avoid a full disk scan.
2026-01-11T19:28:12.9762518Z                          foreach ($location in $registryLocations) {
2026-01-11T19:28:12.9763642Z                              if (Test-Path $location) {
2026-01-11T19:28:12.9764271Z                                  try {
2026-01-11T19:28:12.9765346Z                                      foreach ($exeName in $ExeNames) {
2026-01-11T19:28:12.9766061Z                                          $found = Get-ChildItem -Path $location -Recurse -Filter $exeName -ErrorAction 
2026-01-11T19:28:12.9766539Z                      SilentlyContinue |
2026-01-11T19:28:12.9767267Z                                              Select-Object -First 1
2026-01-11T19:28:12.9768066Z                                          if ($found) {
2026-01-11T19:28:12.9769067Z                                              return $found.FullName
2026-01-11T19:28:12.9769522Z                                          }
2026-01-11T19:28:12.9770401Z                                      }
2026-01-11T19:28:12.9770530Z                                  } catch {
2026-01-11T19:28:12.9771322Z                                      # Ignore access errors.
2026-01-11T19:28:12.9772111Z                                  }
2026-01-11T19:28:12.9772934Z                              }
2026-01-11T19:28:12.9774172Z                          }
2026-01-11T19:28:12.9774923Z                      
2026-01-11T19:28:12.9775908Z                          return $null
2026-01-11T19:28:12.9776630Z                      }
2026-01-11T19:28:12.9777417Z                      
2026-01-11T19:28:12.9778252Z                      
2026-01-11T19:28:12.9779174Z                      # ----------------------------
2026-01-11T19:28:12.9780091Z                      # Benchmark stack definition
2026-01-11T19:28:12.9780223Z                      # ----------------------------
2026-01-11T19:28:12.9781355Z                      
2026-01-11T19:28:12.9781623Z                      Write-Section "Benchmark Stack"
2026-01-11T19:28:12.9782910Z                      Write-Note "This script installs a small, free toolchain for FPS and frametime testing."
2026-01-11T19:28:12.9783372Z                      Write-Note "It does not change system settings. It only installs tools and launches them."
2026-01-11T19:28:12.9783823Z                      Write-Note "These tools were chosen because they are repeatable and measurable:"
2026-01-11T19:28:12.9784917Z                      Write-Note "- CapFrameX: frametime capture and percentile lows (more honest than avg FPS alone)."
2026-01-11T19:28:12.9785302Z                      Write-Note "- Superposition: fixed GPU workload with repeatable scoring."
2026-01-11T19:28:12.9785681Z                      Write-Note "- LatencyMon: validates DPC/ISR latency to explain micro-stutter."
2026-01-11T19:28:12.9786295Z                      Write-Note "Windows 10 and 11 use the same default install paths for these tools."
2026-01-11T19:28:12.9787731Z                      Write-Note "The script targets 64-bit installs and still checks legacy locations for safety."
2026-01-11T19:28:12.9787844Z                      
2026-01-11T19:28:12.9788590Z                      $packages = @(
2026-01-11T19:28:12.9789465Z                          # Each package entry defines:
2026-01-11T19:28:12.9790565Z                          #   - Winget ID for installation
2026-01-11T19:28:12.9791103Z                          #   - Default executable paths for x64 installs
2026-01-11T19:28:12.9791845Z                          #   - Config checklist steps for repeatable results
2026-01-11T19:28:12.9793140Z                          #   - Whether to launch automatically when found
2026-01-11T19:28:12.9793277Z                          @{
2026-01-11T19:28:12.9794462Z                              Id = "CXWorld.CapFrameX"
2026-01-11T19:28:12.9794759Z                              Name = "CapFrameX"
2026-01-11T19:28:12.9796387Z                              Purpose = "Captures frametimes and computes avg FPS, 1% low, and 0.1% low."
2026-01-11T19:28:12.9796556Z                              ExeNames = @("CapFrameX.exe")
2026-01-11T19:28:12.9796964Z                              RegistryPattern = "*CapFrameX*"
2026-01-11T19:28:12.9797667Z                              DefaultPaths = @(
2026-01-11T19:28:12.9798506Z                                  "C:\Program Files\CapFrameX\CapFrameX.exe",
2026-01-11T19:28:12.9799294Z                                  "C:\Program Files (x86)\CapFrameX\CapFrameX.exe"
2026-01-11T19:28:12.9800533Z                              )
2026-01-11T19:28:12.9800676Z                              Configure = @(
2026-01-11T19:28:12.9801766Z                                  "Capture API: PresentMon",
2026-01-11T19:28:12.9802291Z                                  "Capture duration: 60s",
2026-01-11T19:28:12.9802989Z                                  "Start delay: 3s",
2026-01-11T19:28:12.9804055Z                                  "Hotkey: F11 (start/stop capture)",
2026-01-11T19:28:12.9805025Z                                  "Overlay optional; do not enable additional overlays for clean results"
2026-01-11T19:28:12.9805834Z                              )
2026-01-11T19:28:12.9806923Z                              Launch = $true
2026-01-11T19:28:12.9807718Z                          },
2026-01-11T19:28:12.9808520Z                          @{
2026-01-11T19:28:12.9809716Z                              Id = "Unigine.SuperpositionBenchmark"
2026-01-11T19:28:12.9809895Z                              Name = "Unigine Superposition"
2026-01-11T19:28:12.9810724Z                              Purpose = "Repeatable GPU benchmark for consistent before/after comparisons."
2026-01-11T19:28:12.9811753Z                              ExeNames = @("Superposition.exe")
2026-01-11T19:28:12.9812265Z                              RegistryPattern = "*Superposition*"
2026-01-11T19:28:12.9812398Z                              DefaultPaths = @(
2026-01-11T19:28:12.9813842Z                                  "C:\Program Files\Unigine\Superposition\Superposition.exe",
2026-01-11T19:28:12.9814207Z                                  "C:\Program Files\Unigine\Superposition\bin\Superposition.exe"
2026-01-11T19:28:12.9814356Z                              )
2026-01-11T19:28:12.9815497Z                              Configure = @(
2026-01-11T19:28:12.9815653Z                                  "Preset: 1080p Medium",
2026-01-11T19:28:12.9816585Z                                  "Fullscreen: On",
2026-01-11T19:28:12.9816980Z                                  "VSync: Off",
2026-01-11T19:28:12.9818027Z                                  "Run 3 passes; discard the first (shader compilation), average the rest"
2026-01-11T19:28:12.9818609Z                              )
2026-01-11T19:28:12.9819458Z                              Launch = $true
2026-01-11T19:28:12.9820568Z                          },
2026-01-11T19:28:12.9820723Z                          @{
2026-01-11T19:28:12.9822037Z                              Id = "Resplendence.LatencyMon"
2026-01-11T19:28:12.9822754Z                              Name = "LatencyMon"
2026-01-11T19:28:12.9823224Z                              Purpose = "Detects DPC/ISR latency spikes that can cause stutter or audio crackle."
2026-01-11T19:28:12.9824273Z                              ExeNames = @("LatencyMon.exe", "LatMon.exe")
2026-01-11T19:28:12.9824907Z                              RegistryPattern = "*LatencyMon*"
2026-01-11T19:28:12.9825535Z                              DefaultPaths = @(
2026-01-11T19:28:12.9826920Z                                  "C:\Program Files\LatencyMon\LatencyMon.exe",
2026-01-11T19:28:12.9827341Z                                  "C:\Program Files\LatencyMon\LatMon.exe",
2026-01-11T19:28:12.9828417Z                                  "C:\Program Files (x86)\LatencyMon\LatencyMon.exe",
2026-01-11T19:28:12.9828872Z                                  "C:\Program Files (x86)\LatencyMon\LatMon.exe",
2026-01-11T19:28:12.9829930Z                                  "C:\Program Files\Resplendence\LatencyMon\LatencyMon.exe",
2026-01-11T19:28:12.9830176Z                                  "C:\Program Files\Resplendence\LatencyMon\LatMon.exe",
2026-01-11T19:28:12.9831212Z                                  "C:\Program Files (x86)\Resplendence\LatencyMon\LatencyMon.exe",
2026-01-11T19:28:12.9831733Z                                  "C:\Program Files (x86)\Resplendence\LatencyMon\LatMon.exe"
2026-01-11T19:28:12.9832365Z                              )
2026-01-11T19:28:12.9833480Z                              Configure = @(
2026-01-11T19:28:12.9834121Z                                  "Run for 5 minutes while Superposition is running",
2026-01-11T19:28:12.9834778Z                                  "Record Main + Drivers tab screenshots for evidence"
2026-01-11T19:28:12.9834910Z                              )
2026-01-11T19:28:12.9835818Z                              Launch = $true
2026-01-11T19:28:12.9836409Z                          }
2026-01-11T19:28:12.9837441Z                      )
2026-01-11T19:28:12.9837849Z                      
2026-01-11T19:28:12.9839020Z                      
2026-01-11T19:28:12.9839164Z                      # ----------------------------
2026-01-11T19:28:12.9839884Z                      # Main flow
2026-01-11T19:28:12.9840941Z                      # ----------------------------
2026-01-11T19:28:12.9841044Z                      
2026-01-11T19:28:12.9842104Z                      try {
2026-01-11T19:28:12.9842933Z                          Write-Section "Pre-Checks"
2026-01-11T19:28:12.9843868Z                          Write-Note "Ensure the following for fair results:"
2026-01-11T19:28:12.9845170Z                          Write-Note "- Close browsers, launchers, and overlays (except CapFrameX)."
2026-01-11T19:28:12.9845863Z                          Write-Note "- Keep power plan and NVIDIA Control Panel settings identical before/after."
2026-01-11T19:28:12.9847272Z                          Write-Note "- Reboot before the before and after runs, if possible."
2026-01-11T19:28:12.9848445Z                          Write-Note "- If you double-clicked this script and it closes immediately, run:"
2026-01-11T19:28:12.9848904Z                          Write-Note "  powershell -ExecutionPolicy Bypass -File .\\benchmark-setup.ps1"
2026-01-11T19:28:12.9849290Z                      
2026-01-11T19:28:12.9851252Z                          $installConsent = Confirm-InstallConsent -PackageNames ($packages | ForEach-Object { $_.Name 
2026-01-11T19:28:12.9851380Z                      })
2026-01-11T19:28:12.9851481Z                      
2026-01-11T19:28:12.9852000Z                          if ($installConsent) {
2026-01-11T19:28:12.9853047Z                              if (-not (Install-WingetIfMissing)) {
2026-01-11T19:28:12.9853521Z                                  throw "winget is required to continue."
2026-01-11T19:28:12.9854246Z                              }
2026-01-11T19:28:12.9855018Z                      
2026-01-11T19:28:12.9855373Z                              $script:WingetAvailable = Test-WingetAvailable
2026-01-11T19:28:12.9856453Z                      
2026-01-11T19:28:12.9857288Z                              Write-Section "Install Required Tools"
2026-01-11T19:28:12.9857790Z                              $totalPkgs = $packages.Count
2026-01-11T19:28:12.9858864Z                              $currentPkg = 0
2026-01-11T19:28:12.9859052Z                              foreach ($package in $packages) {
2026-01-11T19:28:12.9859968Z                                  $currentPkg++
2026-01-11T19:28:12.9860979Z                                  $pct = [math]::Round(($currentPkg / $totalPkgs) * 100)
2026-01-11T19:28:12.9862337Z                                  Write-Progress -Activity "Installing Tools" -Status $package.Name -PercentComplete 
2026-01-11T19:28:12.9862612Z                      $pct -CurrentOperation "$currentPkg of $totalPkgs"
2026-01-11T19:28:12.9863250Z                                  Write-Note "$($package.Name): $($package.Purpose)"
2026-01-11T19:28:12.9864691Z                                  $installed = Install-WingetPackage -PackageId $package.Id -PackageName $package.Name
2026-01-11T19:28:12.9864825Z                                  if (-not $installed) {
2026-01-11T19:28:12.9865538Z                                      Write-Warn "$($package.Name) failed to install. The script will continue, but 
2026-01-11T19:28:12.9866857Z                      launching may fail."
2026-01-11T19:28:12.9866967Z                                  }
2026-01-11T19:28:12.9869032Z                              }
2026-01-11T19:28:12.9869324Z                              Write-Progress -Activity "Installing Tools" -Completed
2026-01-11T19:28:12.9869465Z                          } else {
2026-01-11T19:28:12.9870830Z                              # The user did not approve installs. We still try to locate and launch
2026-01-11T19:28:12.9871046Z                              # any tools that are already installed.
2026-01-11T19:28:12.9872126Z                              $script:WingetAvailable = Test-WingetAvailable
2026-01-11T19:28:12.9872754Z                              if (-not $script:WingetAvailable) {
2026-01-11T19:28:12.9874071Z                                  Write-Warn "winget is not available, so install-location lookup via winget is 
2026-01-11T19:28:12.9874472Z                      disabled."
2026-01-11T19:28:12.9874906Z                              }
2026-01-11T19:28:12.9875776Z                          }
2026-01-11T19:28:12.9876215Z                      
2026-01-11T19:28:12.9877458Z                          Write-Section "Locate Executables"
2026-01-11T19:28:12.9877639Z                          foreach ($package in $packages) {
2026-01-11T19:28:12.9878455Z                              $path = Resolve-ExecutablePath -ExeNames $package.ExeNames `
2026-01-11T19:28:12.9878966Z                                  -DefaultCandidates $package.DefaultPaths `
2026-01-11T19:28:12.9880237Z                                  -RegistryNamePattern $package.RegistryPattern `
2026-01-11T19:28:12.9880435Z                                  -PackageId $package.Id
2026-01-11T19:28:12.9880747Z                      
2026-01-11T19:28:12.9881564Z                              if ($path) {
2026-01-11T19:28:12.9882459Z                                  Write-Ok "$($package.Name) executable found at: $path"
2026-01-11T19:28:12.9883145Z                                  $package["Path"] = $path
2026-01-11T19:28:12.9884824Z                              } else {
2026-01-11T19:28:12.9885305Z                                  Write-Warn "Could not locate $($package.Name) executable. Launch will be skipped."
2026-01-11T19:28:12.9885852Z                                  $package["Path"] = $null
2026-01-11T19:28:12.9887058Z                              }
2026-01-11T19:28:12.9887184Z                          }
2026-01-11T19:28:12.9888126Z                      
2026-01-11T19:28:12.9889097Z                          Write-Section "Configuration Checklist"
2026-01-11T19:28:12.9889891Z                          foreach ($package in $packages) {
2026-01-11T19:28:12.9890661Z                              Write-Host ""
2026-01-11T19:28:12.9891840Z                              Write-Host "$($package.Name) configuration:" -ForegroundColor Cyan
2026-01-11T19:28:12.9892068Z                              foreach ($step in $package.Configure) {
2026-01-11T19:28:12.9893309Z                                  Write-Host "  - $step" -ForegroundColor White
2026-01-11T19:28:12.9893423Z                              }
2026-01-11T19:28:12.9894538Z                          }
2026-01-11T19:28:12.9894638Z                      
2026-01-11T19:28:12.9895671Z                          Write-Section "Launch Tools"
2026-01-11T19:28:12.9896938Z                          foreach ($package in $packages) {
2026-01-11T19:28:12.9897405Z                              if (-not $package.Launch) {
2026-01-11T19:28:12.9898638Z                                  continue
2026-01-11T19:28:12.9899213Z                              }
2026-01-11T19:28:12.9900314Z                      
2026-01-11T19:28:12.9900984Z                              if ($package["Path"]) {
2026-01-11T19:28:12.9901915Z                                  Write-Note "Launching $($package.Name)..."
2026-01-11T19:28:12.9902911Z                                  try {
2026-01-11T19:28:12.9904157Z                                      $process = Start-Process -FilePath $package["Path"] -PassThru -ErrorAction Stop
2026-01-11T19:28:12.9904794Z                                      Start-Sleep -Milliseconds 300
2026-01-11T19:28:12.9905160Z                                      if ($process -and -not $process.HasExited) {
2026-01-11T19:28:12.9905458Z                                          Write-Ok "$($package.Name) launched (PID $($process.Id))."
2026-01-11T19:28:12.9905924Z                                      } else {
2026-01-11T19:28:12.9907508Z                                          Write-Warn "$($package.Name) launched but exited immediately. Try starting it 
2026-01-11T19:28:12.9907640Z                      manually:"
2026-01-11T19:28:12.9908806Z                                          Write-Warn "  $($package["Path"])"
2026-01-11T19:28:12.9909429Z                                      }
2026-01-11T19:28:12.9910441Z                                  } catch {
2026-01-11T19:28:12.9911276Z                                      Write-Warn "Failed to launch $($package.Name). Try starting it manually:"
2026-01-11T19:28:12.9911500Z                                      Write-Warn "  $($package["Path"])"
2026-01-11T19:28:12.9912701Z                                      Write-Warn "Error: $($_.Exception.Message)"
2026-01-11T19:28:12.9912817Z                                  }
2026-01-11T19:28:12.9913313Z                              } else {
2026-01-11T19:28:12.9914668Z                                  Write-Warn "Skipping launch for $($package.Name) (path not found)."
2026-01-11T19:28:12.9915022Z                              }
2026-01-11T19:28:12.9916194Z                          }
2026-01-11T19:28:12.9916305Z                      
2026-01-11T19:28:12.9917271Z                          Write-Section "Input Lag Evidence (Free Method)"
2026-01-11T19:28:12.9918972Z                          Write-Note "Use a 240fps phone video to measure click-to-photon latency:"
2026-01-11T19:28:12.9919844Z                          Write-Note "1) Fullscreen a click-response test (any simple local page or app)."
2026-01-11T19:28:12.9920078Z                          Write-Note "2) Record 10 clicks in slow motion."
2026-01-11T19:28:12.9920360Z                          Write-Note "3) Count frames between click and on-screen change."
2026-01-11T19:28:12.9920539Z                          Write-Note "At 240fps, 1 frame = 4.17ms. Average the 10 results."
2026-01-11T19:28:12.9921561Z                      
2026-01-11T19:28:12.9922290Z                          Write-Section "Run Protocol Summary"
2026-01-11T19:28:12.9923141Z                          Write-Note "Warm up once without capturing."
2026-01-11T19:28:12.9924383Z                          Write-Note "Capture 2 valid runs with CapFrameX (press F11 to start/stop)."
2026-01-11T19:28:12.9924987Z                          Write-Note "Apply your app changes."
2026-01-11T19:28:12.9926143Z                          Write-Note "Repeat the warmup + 2 runs."
2026-01-11T19:28:12.9926854Z                          Write-Note "Compare Avg FPS, 1% low, 0.1% low, and frametime graphs."
2026-01-11T19:28:12.9927675Z                      
2026-01-11T19:28:12.9928461Z                          Write-Ok "Benchmark stack is ready."
2026-01-11T19:28:12.9929605Z                          Write-Progress -Activity "Benchmark Setup" -Completed
2026-01-11T19:28:12.9929710Z                      
2026-01-11T19:28:12.9930834Z                          Show-RockTuneFinalChecklist
2026-01-11T19:28:12.9931692Z                      } catch {
2026-01-11T19:28:12.9932791Z                          Write-Fail "Script failed: $($_.Exception.Message)"
2026-01-11T19:28:12.9933104Z                      } finally {
2026-01-11T19:28:12.9934065Z                          if ($script:HadFailures) {
2026-01-11T19:28:12.9934621Z                              Write-Warn "One or more steps failed. Review the messages above."
2026-01-11T19:28:12.9935545Z                          }
2026-01-11T19:28:12.9936041Z                          Wait-ForUserExit
2026-01-11T19:28:12.9936450Z                      }
2026-01-11T19:28:12.9937572Z                      
2026-01-11T19:28:12.9938258Z [32;1mCleanBlock         : [0m
2026-01-11T19:28:12.9939303Z [32;1mDynamicParamBlock  : [0m
2026-01-11T19:28:12.9940257Z [32;1mScriptRequirements : [0mSystem.Management.Automation.Language.ScriptRequirements
2026-01-11T19:28:12.9943289Z [32;1mExtent             : [0m<#
2026-01-11T19:28:12.9944387Z                      .SYNOPSIS
2026-01-11T19:28:12.9945302Z                          One-click installer and launcher for a reproducible FPS + frametime benchmark stack.
2026-01-11T19:28:12.9946398Z                      .DESCRIPTION
2026-01-11T19:28:12.9947281Z                          This script installs and launches the minimum free tools required to produce
2026-01-11T19:28:12.9947783Z                          credible before/after FPS and frametime results:
2026-01-11T19:28:12.9948868Z                            - CapFrameX (frametime capture, 1%/0.1% lows)
2026-01-11T19:28:12.9949438Z                            - Unigine Superposition (repeatable GPU benchmark)
2026-01-11T19:28:12.9950512Z                            - LatencyMon (DPC/ISR latency diagnostics)
2026-01-11T19:28:12.9950983Z                      
2026-01-11T19:28:12.9951844Z                          The script is intentionally verbose and transparent. It explains:
2026-01-11T19:28:12.9953325Z                            - What each tool does
2026-01-11T19:28:12.9953411Z                            - Why it is included
2026-01-11T19:28:12.9954156Z                            - What configuration is required for repeatable runs
2026-01-11T19:28:12.9954372Z                            - How to launch the tools and capture results
2026-01-11T19:28:12.9955576Z                      
2026-01-11T19:28:12.9955992Z                          Configuration is done via explicit instructions because these tools do not
2026-01-11T19:28:12.9957356Z                          expose stable, documented config file formats for automation. This approach
2026-01-11T19:28:12.9957808Z                          avoids silently writing unknown settings and keeps the process reproducible.
2026-01-11T19:28:12.9958224Z                      
2026-01-11T19:28:12.9959530Z                          Run this script in an elevated PowerShell (Run as Administrator).
2026-01-11T19:28:12.9959919Z                      
2026-01-11T19:28:12.9960341Z                      .PARAMETER ResetConsent
2026-01-11T19:28:12.9961310Z                          Clears the saved install consent cache and re-prompts on next run.
2026-01-11T19:28:12.9961967Z                          Use this if you previously declined installs but now want to allow them.
2026-01-11T19:28:12.9962961Z                      
2026-01-11T19:28:12.9963807Z                      .PARAMETER AutoAccept
2026-01-11T19:28:12.9965059Z                          Automatically accepts install consent without prompting.
2026-01-11T19:28:12.9965677Z                          Useful for CI/CD pipelines, automated testing, or scripted deployments.
2026-01-11T19:28:12.9966854Z                          This bypasses both the install prompt and the "remember choice" prompt.
2026-01-11T19:28:12.9966975Z                      
2026-01-11T19:28:12.9967870Z                      .USAGE
2026-01-11T19:28:12.9968941Z                          1) Right-click this file and select "Run as administrator".
2026-01-11T19:28:12.9969955Z                          2) Let the script install tools via winget if missing.
2026-01-11T19:28:12.9970296Z                          3) Follow the configuration checklist printed for each tool.
2026-01-11T19:28:12.9971322Z                          4) Run the benchmark before/after your changes and export results.
2026-01-11T19:28:12.9971939Z                      
2026-01-11T19:28:12.9973137Z                          Hosted one-liner (downloads and runs this script):
2026-01-11T19:28:12.9973813Z                            irm https://rocktune.pedroferrari.com/benchmark.ps1 | iex
2026-01-11T19:28:12.9973923Z                      
2026-01-11T19:28:12.9975525Z                          You can inspect the source before running:
2026-01-11T19:28:12.9975718Z                            .\benchmark-setup.ps1
2026-01-11T19:28:12.9975947Z                            https://rocktune.pedroferrari.com/benchmark.ps1
2026-01-11T19:28:12.9976091Z                      
2026-01-11T19:28:12.9977460Z                          If double-clicking closes the window immediately, run:
2026-01-11T19:28:12.9977773Z                            powershell -ExecutionPolicy Bypass -File .\benchmark-setup.ps1
2026-01-11T19:28:12.9978208Z                      
2026-01-11T19:28:12.9979335Z                          Unattended/automated execution (skips all prompts):
2026-01-11T19:28:12.9979516Z                            .\benchmark-setup.ps1 -AutoAccept
2026-01-11T19:28:12.9980058Z                      
2026-01-11T19:28:12.9981068Z                          To clear the saved install consent and re-prompt:
2026-01-11T19:28:12.9981849Z                            .\benchmark-setup.ps1 -ResetConsent
2026-01-11T19:28:12.9982500Z                      
2026-01-11T19:28:12.9983423Z                      .NOTES
2026-01-11T19:28:12.9984304Z                          Requires Administrator because winget installation and app installs may
2026-01-11T19:28:12.9985061Z                          require elevation on some systems. Also uses the Microsoft Store fallback
2026-01-11T19:28:12.9985757Z                          flow if winget is missing.
2026-01-11T19:28:12.9985903Z                      
2026-01-11T19:28:12.9987174Z                          Documentation: https://rocktune.pedroferrari.com
2026-01-11T19:28:12.9987802Z                          Source: https://github.com/thepedroferrari/rocktune
2026-01-11T19:28:12.9988385Z                          Issues: https://github.com/thepedroferrari/rocktune/issues
2026-01-11T19:28:12.9988963Z                      #>
2026-01-11T19:28:12.9990005Z                      #Requires -RunAsAdministrator
2026-01-11T19:28:12.9990767Z                      
2026-01-11T19:28:12.9991596Z                      [CmdletBinding()]
2026-01-11T19:28:12.9992239Z                      param(
2026-01-11T19:28:12.9993341Z                          [switch]$ResetConsent,
2026-01-11T19:28:12.9993478Z                          [switch]$AutoAccept
2026-01-11T19:28:12.9994577Z                      )
2026-01-11T19:28:12.9994762Z                      
2026-01-11T19:28:12.9995997Z                      
2026-01-11T19:28:12.9996473Z                      # ----------------------------
2026-01-11T19:28:12.9997483Z                      # Global behavior and helpers
2026-01-11T19:28:12.9997625Z                      # ----------------------------
2026-01-11T19:28:12.9998799Z                      
2026-01-11T19:28:12.9999622Z                      $ErrorActionPreference = "Stop"
2026-01-11T19:28:13.0000451Z                      $script:HadFailures = $false
2026-01-11T19:28:13.0001117Z                      $script:WingetAvailable = $false
2026-01-11T19:28:13.0002237Z                      $script:ResetConsent = $ResetConsent
2026-01-11T19:28:13.0002968Z                      $script:ConsentRoot = Join-Path $env:LOCALAPPDATA "WindowsGamingSettings"
2026-01-11T19:28:13.0003660Z                      $script:ConsentFilePath = Join-Path $script:ConsentRoot "benchmark-consent.json"
2026-01-11T19:28:13.0004064Z                      
2026-01-11T19:28:13.0005008Z                      # Progress tracking
2026-01-11T19:28:13.0005156Z                      $script:SectionIndex = 0
2026-01-11T19:28:13.0006510Z                      $script:SectionTotal = 0
2026-01-11T19:28:13.0007314Z                      
2026-01-11T19:28:13.0008377Z                      function Get-SectionTotal {
2026-01-11T19:28:13.0008482Z                          <#
2026-01-11T19:28:13.0009688Z                          .SYNOPSIS
2026-01-11T19:28:13.0010550Z                              Counts the number of Write-Section calls in the main script.
2026-01-11T19:28:13.0010660Z                          #>
2026-01-11T19:28:13.0011413Z                          param(
2026-01-11T19:28:13.0013285Z                              [string]$ScriptPath = $PSCommandPath
2026-01-11T19:28:13.0013438Z                          )
2026-01-11T19:28:13.0013520Z                      
2026-01-11T19:28:13.0014077Z                          if (-not $ScriptPath) {
2026-01-11T19:28:13.0015823Z                              $ScriptPath = $MyInvocation.MyCommand.Path
2026-01-11T19:28:13.0015988Z                          }
2026-01-11T19:28:13.0016097Z                      
2026-01-11T19:28:13.0017498Z                          if (-not $ScriptPath -or -not (Test-Path $ScriptPath)) {
2026-01-11T19:28:13.0017664Z                              return 1
2026-01-11T19:28:13.0018870Z                          }
2026-01-11T19:28:13.0019009Z                      
2026-01-11T19:28:13.0020615Z                          $matches = Select-String -Path $ScriptPath -Pattern 'Write-Section\s+["\']' -AllMatches
2026-01-11T19:28:13.0020816Z                          return [math]::Max(1, $matches.Count)
2026-01-11T19:28:13.0020952Z                      }
2026-01-11T19:28:13.0021608Z                      
2026-01-11T19:28:13.0022477Z                      $script:SectionTotal = Get-SectionTotal
2026-01-11T19:28:13.0023249Z                      
2026-01-11T19:28:13.0023492Z                      function Write-Section {
2026-01-11T19:28:13.0024634Z                          <#
2026-01-11T19:28:13.0025731Z                          .SYNOPSIS
2026-01-11T19:28:13.0026912Z                              Writes a high-visibility section header to the console.
2026-01-11T19:28:13.0027226Z                          .DESCRIPTION
2026-01-11T19:28:13.0028397Z                              Used to separate major phases such as installs, configuration, and launch.
2026-01-11T19:28:13.0028541Z                          #>
2026-01-11T19:28:13.0029612Z                          param(
2026-01-11T19:28:13.0029773Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.0030654Z                              [string]$Title
2026-01-11T19:28:13.0031308Z                          )
2026-01-11T19:28:13.0032123Z                      
2026-01-11T19:28:13.0032963Z                          $script:SectionIndex++
2026-01-11T19:28:13.0034085Z                          $pct = [math]::Min(100, [math]::Round(($script:SectionIndex / $script:SectionTotal) * 100))
2026-01-11T19:28:13.0035125Z                          Write-Progress -Activity "Benchmark Setup" -Status $Title -PercentComplete $pct 
2026-01-11T19:28:13.0035561Z                      -CurrentOperation "Step $($script:SectionIndex) of $($script:SectionTotal)"
2026-01-11T19:28:13.0036637Z                      
2026-01-11T19:28:13.0036788Z                          Write-Host ""
2026-01-11T19:28:13.0037893Z                          Write-Host "=== $Title ===" -ForegroundColor Cyan
2026-01-11T19:28:13.0038000Z                      }
2026-01-11T19:28:13.0038346Z                      
2026-01-11T19:28:13.0039296Z                      function Write-Note {
2026-01-11T19:28:13.0040116Z                          <#
2026-01-11T19:28:13.0041337Z                          .SYNOPSIS
2026-01-11T19:28:13.0041652Z                              Writes informational messages in a consistent format.
2026-01-11T19:28:13.0042417Z                          .DESCRIPTION
2026-01-11T19:28:13.0043774Z                              These messages are non-fatal and describe what the script is doing.
2026-01-11T19:28:13.0044156Z                          #>
2026-01-11T19:28:13.0045658Z                          param(
2026-01-11T19:28:13.0046509Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.0047473Z                              [string]$Message
2026-01-11T19:28:13.0047583Z                          )
2026-01-11T19:28:13.0047835Z                      
2026-01-11T19:28:13.0049531Z                          Write-Host "[INFO] $Message" -ForegroundColor Gray
2026-01-11T19:28:13.0049642Z                      }
2026-01-11T19:28:13.0050558Z                      
2026-01-11T19:28:13.0051753Z                      function Write-Warn {
2026-01-11T19:28:13.0052358Z                          <#
2026-01-11T19:28:13.0052560Z                          .SYNOPSIS
2026-01-11T19:28:13.0053877Z                              Writes warnings that do not stop execution.
2026-01-11T19:28:13.0054335Z                          .DESCRIPTION
2026-01-11T19:28:13.0055590Z                              Warnings indicate reduced automation or missing optional data.
2026-01-11T19:28:13.0055719Z                          #>
2026-01-11T19:28:13.0056729Z                          param(
2026-01-11T19:28:13.0057591Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.0058545Z                              [string]$Message
2026-01-11T19:28:13.0059188Z                          )
2026-01-11T19:28:13.0060016Z                      
2026-01-11T19:28:13.0060959Z                          Write-Host "[WARN] $Message" -ForegroundColor Yellow
2026-01-11T19:28:13.0061846Z                      }
2026-01-11T19:28:13.0061949Z                      
2026-01-11T19:28:13.0063351Z                      function Write-Fail {
2026-01-11T19:28:13.0063681Z                          <#
2026-01-11T19:28:13.0065066Z                          .SYNOPSIS
2026-01-11T19:28:13.0065348Z                              Writes a failure message and marks the run as having errors.
2026-01-11T19:28:13.0065899Z                          .DESCRIPTION
2026-01-11T19:28:13.0067277Z                              The script will still continue to the exit prompt for transparency.
2026-01-11T19:28:13.0067433Z                          #>
2026-01-11T19:28:13.0068466Z                          param(
2026-01-11T19:28:13.0069260Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.0069949Z                              [string]$Message
2026-01-11T19:28:13.0070878Z                          )
2026-01-11T19:28:13.0070993Z                      
2026-01-11T19:28:13.0072406Z                          $script:HadFailures = $true
2026-01-11T19:28:13.0072961Z                          Write-Host "[FAIL] $Message" -ForegroundColor Red
2026-01-11T19:28:13.0073352Z                      }
2026-01-11T19:28:13.0074254Z                      
2026-01-11T19:28:13.0074997Z                      function Write-Ok {
2026-01-11T19:28:13.0076117Z                          <#
2026-01-11T19:28:13.0076263Z                          .SYNOPSIS
2026-01-11T19:28:13.0077586Z                              Writes a success message.
2026-01-11T19:28:13.0078651Z                          .DESCRIPTION
2026-01-11T19:28:13.0079714Z                              Used to confirm expected outcomes like successful installs.
2026-01-11T19:28:13.0080084Z                          #>
2026-01-11T19:28:13.0080989Z                          param(
2026-01-11T19:28:13.0081919Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.0082328Z                              [string]$Message
2026-01-11T19:28:13.0083224Z                          )
2026-01-11T19:28:13.0084524Z                      
2026-01-11T19:28:13.0084922Z                          Write-Host "[OK] $Message" -ForegroundColor Green
2026-01-11T19:28:13.0085935Z                      }
2026-01-11T19:28:13.0086549Z                      
2026-01-11T19:28:13.0086816Z                      function Wait-ForUserExit {
2026-01-11T19:28:13.0087607Z                          <#
2026-01-11T19:28:13.0087751Z                          .SYNOPSIS
2026-01-11T19:28:13.0088933Z                              Always waits for a user key press before exiting.
2026-01-11T19:28:13.0089354Z                          .DESCRIPTION
2026-01-11T19:28:13.0090379Z                              This keeps the console open for users who double-click the script
2026-01-11T19:28:13.0090566Z                              and would otherwise lose the output.
2026-01-11T19:28:13.0090829Z                          #>
2026-01-11T19:28:13.0091888Z                          # Always pause so the user can read output, even on failure.
2026-01-11T19:28:13.0092399Z                          Write-Host ""
2026-01-11T19:28:13.0093920Z                          Write-Host "Press any key to exit..." -ForegroundColor Cyan
2026-01-11T19:28:13.0094065Z                          try {
2026-01-11T19:28:13.0094313Z                              $null = [System.Console]::ReadKey($true)
2026-01-11T19:28:13.0095460Z                          } catch {
2026-01-11T19:28:13.0095852Z                              # Fallback for hosts that do not support ReadKey (e.g., some terminals).
2026-01-11T19:28:13.0096702Z                              Read-Host "Press Enter to exit"
2026-01-11T19:28:13.0097610Z                          }
2026-01-11T19:28:13.0097803Z                      }
2026-01-11T19:28:13.0098895Z                      
2026-01-11T19:28:13.0099494Z                      function Show-RockTuneFinalChecklist {
2026-01-11T19:28:13.0100248Z                          <#
2026-01-11T19:28:13.0101096Z                          .SYNOPSIS
2026-01-11T19:28:13.0102288Z                              Prints a no-guesswork, step-by-step checklist after tools launch.
2026-01-11T19:28:13.0102440Z                          .DESCRIPTION
2026-01-11T19:28:13.0104174Z                              This is intentionally explicit for first-time users who need to know
2026-01-11T19:28:13.0104568Z                              exactly what to click and in what order. The checklist is short and
2026-01-11T19:28:13.0105344Z                              ends with clear completion cues.
2026-01-11T19:28:13.0106352Z                          #>
2026-01-11T19:28:13.0107111Z                          Write-Section "ROCKTUNE Benchmark Steps"
2026-01-11T19:28:13.0108055Z                      
2026-01-11T19:28:13.0108324Z                          $consoleWidth = 0
2026-01-11T19:28:13.0109622Z                          try {
2026-01-11T19:28:13.0109869Z                              $consoleWidth = $Host.UI.RawUI.WindowSize.Width
2026-01-11T19:28:13.0110956Z                          } catch {
2026-01-11T19:28:13.0111124Z                              $consoleWidth = 0
2026-01-11T19:28:13.0111950Z                          }
2026-01-11T19:28:13.0112886Z                      
2026-01-11T19:28:13.0113691Z                          function Get-LeftPad {
2026-01-11T19:28:13.0114481Z                              param(
2026-01-11T19:28:13.0115476Z                                  [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.0115938Z                                  [int]$Width,
2026-01-11T19:28:13.0116782Z                      
2026-01-11T19:28:13.0117298Z                                  [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.0118279Z                                  [int]$MaxLineLength
2026-01-11T19:28:13.0118990Z                              )
2026-01-11T19:28:13.0119414Z                      
2026-01-11T19:28:13.0120408Z                              if ($Width -le 0 -or $MaxLineLength -le 0) {
2026-01-11T19:28:13.0121125Z                                  return ""
2026-01-11T19:28:13.0122330Z                              }
2026-01-11T19:28:13.0122692Z                      
2026-01-11T19:28:13.0124079Z                              $pad = [math]::Floor(($Width - $MaxLineLength) / 2)
2026-01-11T19:28:13.0124267Z                              if ($pad -lt 0) {
2026-01-11T19:28:13.0125110Z                                  $pad = 0
2026-01-11T19:28:13.0125612Z                              }
2026-01-11T19:28:13.0126646Z                      
2026-01-11T19:28:13.0127506Z                              return (" " * $pad)
2026-01-11T19:28:13.0128133Z                          }
2026-01-11T19:28:13.0128926Z                      
2026-01-11T19:28:13.0129847Z                          $bannerLines = @(
2026-01-11T19:28:13.0130937Z                              "  ____   ___   ____ _  __ _______ _   _ _   _ _____",
2026-01-11T19:28:13.0131097Z                              " |  _ \ / _ \ / ___| |/ /|_   _| | | | | \ | | ____|",
2026-01-11T19:28:13.0131866Z                              " | |_) | | | | |   | ' /   | | | | | | |  \| |  _|",
2026-01-11T19:28:13.0132305Z                              " |  _ <| |_| | |___| . \   | | | |_| | | |\  | |___",
2026-01-11T19:28:13.0133427Z                              " |_| \_\\___/ \____|_|\_\  |_|  \___/|_|_| \_|_____|"
2026-01-11T19:28:13.0133543Z                          )
2026-01-11T19:28:13.0134358Z                      
2026-01-11T19:28:13.0135761Z                          $bannerMax = ($bannerLines | Measure-Object -Property Length -Maximum).Maximum
2026-01-11T19:28:13.0136132Z                          $bannerPad = Get-LeftPad -Width $consoleWidth -MaxLineLength $bannerMax
2026-01-11T19:28:13.0136222Z                      
2026-01-11T19:28:13.0137019Z                          foreach ($line in $bannerLines) {
2026-01-11T19:28:13.0137958Z                              Write-Host ($bannerPad + $line) -ForegroundColor Cyan
2026-01-11T19:28:13.0138979Z                          }
2026-01-11T19:28:13.0139782Z                      
2026-01-11T19:28:13.0140892Z                          $useTwoColumns = $false
2026-01-11T19:28:13.0141035Z                          if ($consoleWidth -ge 120) {
2026-01-11T19:28:13.0141748Z                              $useTwoColumns = $true
2026-01-11T19:28:13.0142860Z                          }
2026-01-11T19:28:13.0142961Z                      
2026-01-11T19:28:13.0144644Z                          $sections = @(
2026-01-11T19:28:13.0144735Z                              @{
2026-01-11T19:28:13.0145895Z                                  Title = "FIRST STEPS"
2026-01-11T19:28:13.0146020Z                                  Lines = @(
2026-01-11T19:28:13.0146939Z                                      '[ ] Confirm the tools are open',
2026-01-11T19:28:13.0147806Z                                      '    - CapFrameX is running',
2026-01-11T19:28:13.0149224Z                                      '    - Unigine Superposition is open',
2026-01-11T19:28:13.0149483Z                                      '    - LatencyMon is open'
2026-01-11T19:28:13.0150094Z                                  )
2026-01-11T19:28:13.0151196Z                              },
2026-01-11T19:28:13.0152023Z                              @{
2026-01-11T19:28:13.0153250Z                                  Title = "CONFIGURE CAPFRAMEX (ONCE)"
2026-01-11T19:28:13.0153398Z                                  Lines = @(
2026-01-11T19:28:13.0154343Z                                      '[ ] Capture API: PresentMon',
2026-01-11T19:28:13.0155151Z                                      '[ ] Capture duration: 60s',
2026-01-11T19:28:13.0155999Z                                      '[ ] Start delay: 3s',
2026-01-11T19:28:13.0157032Z                                      '[ ] Hotkey: F11 (start/stop capture)'
2026-01-11T19:28:13.0157499Z                                  )
2026-01-11T19:28:13.0158334Z                              },
2026-01-11T19:28:13.0159134Z                              @{
2026-01-11T19:28:13.0160126Z                                  Title = "CONFIGURE SUPERPOSITION (ONCE)"
2026-01-11T19:28:13.0161206Z                                  Lines = @(
2026-01-11T19:28:13.0162022Z                                      '[ ] Preset: 1080p Medium',
2026-01-11T19:28:13.0162953Z                                      '[ ] Fullscreen: On',
2026-01-11T19:28:13.0164206Z                                      '[ ] VSync: Off'
2026-01-11T19:28:13.0164347Z                                  )
2026-01-11T19:28:13.0165324Z                              },
2026-01-11T19:28:13.0166151Z                              @{
2026-01-11T19:28:13.0167150Z                                  Title = "BEFORE CHANGES"
2026-01-11T19:28:13.0168065Z                                  Lines = @(
2026-01-11T19:28:13.0168256Z                                      '[ ] Warm-up run (no capture)',
2026-01-11T19:28:13.0169442Z                                      '    - Click RUN in Superposition',
2026-01-11T19:28:13.0170358Z                                      '    - Let the run finish',
2026-01-11T19:28:13.0171437Z                                      '[ ] Captured runs (before)',
2026-01-11T19:28:13.0171645Z                                      '    - Press F11 at start, F11 at end',
2026-01-11T19:28:13.0172532Z                                      '    - Do 2 valid runs; discard first if shader compilation occurs'
2026-01-11T19:28:13.0172871Z                                  )
2026-01-11T19:28:13.0173885Z                              },
2026-01-11T19:28:13.0174762Z                              @{
2026-01-11T19:28:13.0175580Z                                  Title = "LATENCYMON"
2026-01-11T19:28:13.0176375Z                                  Lines = @(
2026-01-11T19:28:13.0177372Z                                      '[ ] Click Start, run for ~5 minutes',
2026-01-11T19:28:13.0178226Z                                      '    - Screenshot Main tab',
2026-01-11T19:28:13.0179372Z                                      '    - Screenshot Drivers tab'
2026-01-11T19:28:13.0179823Z                                  )
2026-01-11T19:28:13.0180830Z                              },
2026-01-11T19:28:13.0181649Z                              @{
2026-01-11T19:28:13.0182139Z                                  Title = "APPLY ROCKTUNE CHANGES"
2026-01-11T19:28:13.0183276Z                                  Lines = @(
2026-01-11T19:28:13.0184502Z                                      '[ ] Run your optimization flow',
2026-01-11T19:28:13.0185080Z                                      '[ ] Reboot if requested'
2026-01-11T19:28:13.0185446Z                                  )
2026-01-11T19:28:13.0186413Z                              },
2026-01-11T19:28:13.0187230Z                              @{
2026-01-11T19:28:13.0187953Z                                  Title = "AFTER CHANGES"
2026-01-11T19:28:13.0189053Z                                  Lines = @(
2026-01-11T19:28:13.0189785Z                                      '[ ] Repeat the captured runs',
2026-01-11T19:28:13.0190339Z                                      '    - Same settings, same steps, same number of runs'
2026-01-11T19:28:13.0190796Z                                  )
2026-01-11T19:28:13.0191711Z                              },
2026-01-11T19:28:13.0191814Z                              @{
2026-01-11T19:28:13.0192767Z                                  Title = "EXPORT EVIDENCE"
2026-01-11T19:28:13.0193433Z                                  Lines = @(
2026-01-11T19:28:13.0194617Z                                      '[ ] CapFrameX -> Analysis -> Aggregate',
2026-01-11T19:28:13.0195087Z                                      '[ ] Export CSV + HTML summary'
2026-01-11T19:28:13.0195900Z                                  )
2026-01-11T19:28:13.0196846Z                              },
2026-01-11T19:28:13.0197114Z                              @{
2026-01-11T19:28:13.0198491Z                                  Title = "OPTIONAL INPUT LAG (FREE METHOD)"
2026-01-11T19:28:13.0198626Z                                  Lines = @(
2026-01-11T19:28:13.0199809Z                                      '[ ] Record 10 clicks at 240fps',
2026-01-11T19:28:13.0200614Z                                      '[ ] Count frames from click to pixel change',
2026-01-11T19:28:13.0200878Z                                      '[ ] 1 frame at 240fps = 4.17ms'
2026-01-11T19:28:13.0201446Z                                  )
2026-01-11T19:28:13.0202281Z                              }
2026-01-11T19:28:13.0202931Z                          )
2026-01-11T19:28:13.0203617Z                      
2026-01-11T19:28:13.0204593Z                          function Get-SectionLines {
2026-01-11T19:28:13.0204700Z                              param(
2026-01-11T19:28:13.0205031Z                                  [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.0205737Z                                  [hashtable]$Section
2026-01-11T19:28:13.0206365Z                              )
2026-01-11T19:28:13.0207376Z                      
2026-01-11T19:28:13.0207816Z                              $lines = @("== $($Section.Title) ==")
2026-01-11T19:28:13.0208126Z                              foreach ($line in $Section.Lines) {
2026-01-11T19:28:13.0208892Z                                  $lines += $line
2026-01-11T19:28:13.0209938Z                              }
2026-01-11T19:28:13.0210080Z                      
2026-01-11T19:28:13.0210204Z                              return $lines
2026-01-11T19:28:13.0210821Z                          }
2026-01-11T19:28:13.0211510Z                      
2026-01-11T19:28:13.0212224Z                          $lineItems = @()
2026-01-11T19:28:13.0212365Z                      
2026-01-11T19:28:13.0213040Z                          if ($useTwoColumns) {
2026-01-11T19:28:13.0213675Z                              $leftWidth = 58
2026-01-11T19:28:13.0213965Z                              for ($i = 0; $i -lt $sections.Count; $i += 2) {
2026-01-11T19:28:13.0214613Z                                  $left = Get-SectionLines -Section $sections[$i]
2026-01-11T19:28:13.0215990Z                                  $right = @()
2026-01-11T19:28:13.0216266Z                                  if ($i + 1 -lt $sections.Count) {
2026-01-11T19:28:13.0216811Z                                      $right = Get-SectionLines -Section $sections[$i + 1]
2026-01-11T19:28:13.0217155Z                                  }
2026-01-11T19:28:13.0217825Z                      
2026-01-11T19:28:13.0218085Z                                  $maxLines = [math]::Max($left.Count, $right.Count)
2026-01-11T19:28:13.0218960Z                                  for ($lineIndex = 0; $lineIndex -lt $maxLines; $lineIndex++) {
2026-01-11T19:28:13.0219106Z                                      $leftText = ""
2026-01-11T19:28:13.0219523Z                                      $rightText = ""
2026-01-11T19:28:13.0220134Z                                      if ($lineIndex -lt $left.Count) {
2026-01-11T19:28:13.0220728Z                                          $leftText = $left[$lineIndex]
2026-01-11T19:28:13.0221917Z                                      }
2026-01-11T19:28:13.0222674Z                                      if ($lineIndex -lt $right.Count) {
2026-01-11T19:28:13.0223008Z                                          $rightText = $right[$lineIndex]
2026-01-11T19:28:13.0223122Z                                      }
2026-01-11T19:28:13.0223644Z                      
2026-01-11T19:28:13.0224456Z                                      $lineItems += ($leftText.PadRight($leftWidth) + $rightText)
2026-01-11T19:28:13.0225571Z                                  }
2026-01-11T19:28:13.0225753Z                      
2026-01-11T19:28:13.0226352Z                                  $lineItems += ""
2026-01-11T19:28:13.0227387Z                              }
2026-01-11T19:28:13.0228878Z                          } else {
2026-01-11T19:28:13.0229374Z                              foreach ($section in $sections) {
2026-01-11T19:28:13.0230328Z                                  $lineItems += ""
2026-01-11T19:28:13.0230540Z                                  $lineItems += "== $($section.Title) =="
2026-01-11T19:28:13.0230789Z                                  foreach ($line in $section.Lines) {
2026-01-11T19:28:13.0231150Z                                      $lineItems += $line
2026-01-11T19:28:13.0231910Z                                  }
2026-01-11T19:28:13.0233363Z                              }
2026-01-11T19:28:13.0233530Z                          }
2026-01-11T19:28:13.0233989Z                      
2026-01-11T19:28:13.0234856Z                          if ($lineItems.Count -gt 0 -and $lineItems[0] -eq "") {
2026-01-11T19:28:13.0235417Z                              $lineItems = $lineItems[1..($lineItems.Count - 1)]
2026-01-11T19:28:13.0235869Z                          }
2026-01-11T19:28:13.0236585Z                      
2026-01-11T19:28:13.0238004Z                          $maxLineLength = ($lineItems | Measure-Object -Property Length -Maximum).Maximum
2026-01-11T19:28:13.0238959Z                          $checklistPad = Get-LeftPad -Width $consoleWidth -MaxLineLength $maxLineLength
2026-01-11T19:28:13.0239324Z                          foreach ($line in $lineItems) {
2026-01-11T19:28:13.0239659Z                              Write-Host ($checklistPad + $line) -ForegroundColor White
2026-01-11T19:28:13.0240108Z                          }
2026-01-11T19:28:13.0240818Z                      }
2026-01-11T19:28:13.0241638Z                      
2026-01-11T19:28:13.0241989Z                      function Prompt-YesNo {
2026-01-11T19:28:13.0243193Z                          <#
2026-01-11T19:28:13.0243428Z                          .SYNOPSIS
2026-01-11T19:28:13.0243910Z                              Prompts until a valid yes/no response is provided.
2026-01-11T19:28:13.0244826Z                          .DESCRIPTION
2026-01-11T19:28:13.0245953Z                              Accepts Y/Yes or N/No (case-insensitive). Returns $true for yes,
2026-01-11T19:28:13.0246262Z                              $false for no. This avoids accidental defaults on invalid input.
2026-01-11T19:28:13.0246479Z                          #>
2026-01-11T19:28:13.0248046Z                          param(
2026-01-11T19:28:13.0248880Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.0257385Z                              [string]$Message
2026-01-11T19:28:13.0257560Z                          )
2026-01-11T19:28:13.0257779Z                      
2026-01-11T19:28:13.0258092Z                          while ($true) {
2026-01-11T19:28:13.0258281Z                              $response = Read-Host $Message
2026-01-11T19:28:13.0258467Z                              if ($response -match '^(y|yes)$') {
2026-01-11T19:28:13.0258602Z                                  return $true
2026-01-11T19:28:13.0258710Z                              }
2026-01-11T19:28:13.0259174Z                              if ($response -match '^(n|no)$') {
2026-01-11T19:28:13.0259324Z                                  return $false
2026-01-11T19:28:13.0259438Z                              }
2026-01-11T19:28:13.0259537Z                      
2026-01-11T19:28:13.0259710Z                              Write-Warn "Please answer Y or N."
2026-01-11T19:28:13.0259827Z                          }
2026-01-11T19:28:13.0259908Z                      }
2026-01-11T19:28:13.0259990Z                      
2026-01-11T19:28:13.0260148Z                      function Get-ConsentCache {
2026-01-11T19:28:13.0260607Z                          <#
2026-01-11T19:28:13.0261143Z                          .SYNOPSIS
2026-01-11T19:28:13.0261903Z                              Reads the stored install consent, if present.
2026-01-11T19:28:13.0262412Z                          .DESCRIPTION
2026-01-11T19:28:13.0263406Z                              Returns $true or $false when a saved choice exists, otherwise $null.
2026-01-11T19:28:13.0263940Z                              The cache is stored under the current user profile in LocalAppData.
2026-01-11T19:28:13.0264294Z                          #>
2026-01-11T19:28:13.0265224Z                          if (-not (Test-Path $script:ConsentFilePath)) {
2026-01-11T19:28:13.0265639Z                              return $null
2026-01-11T19:28:13.0266098Z                          }
2026-01-11T19:28:13.0266647Z                      
2026-01-11T19:28:13.0267336Z                          try {
2026-01-11T19:28:13.0268437Z                              $data = Get-Content $script:ConsentFilePath -Raw | ConvertFrom-Json
2026-01-11T19:28:13.0268805Z                          } catch {
2026-01-11T19:28:13.0270027Z                              return $null
2026-01-11T19:28:13.0270143Z                          }
2026-01-11T19:28:13.0270636Z                      
2026-01-11T19:28:13.0271375Z                          if ($null -eq $data) {
2026-01-11T19:28:13.0271909Z                              return $null
2026-01-11T19:28:13.0272673Z                          }
2026-01-11T19:28:13.0272792Z                      
2026-01-11T19:28:13.0274038Z                          if ($data.PSObject.Properties.Name -contains "InstallConsent") {
2026-01-11T19:28:13.0274253Z                              return [bool]$data.InstallConsent
2026-01-11T19:28:13.0274357Z                          }
2026-01-11T19:28:13.0274975Z                      
2026-01-11T19:28:13.0275512Z                          return $null
2026-01-11T19:28:13.0276710Z                      }
2026-01-11T19:28:13.0276957Z                      
2026-01-11T19:28:13.0277484Z                      function Set-ConsentCache {
2026-01-11T19:28:13.0278208Z                          <#
2026-01-11T19:28:13.0278759Z                          .SYNOPSIS
2026-01-11T19:28:13.0279351Z                              Persists the install consent choice for future runs.
2026-01-11T19:28:13.0279863Z                          .DESCRIPTION
2026-01-11T19:28:13.0280682Z                              Stores a small JSON file with the user's choice and a timestamp.
2026-01-11T19:28:13.0281583Z                              Users can reset it with -ResetConsent or by deleting the file.
2026-01-11T19:28:13.0281697Z                          #>
2026-01-11T19:28:13.0282342Z                          param(
2026-01-11T19:28:13.0283210Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.0283364Z                              [bool]$InstallConsent
2026-01-11T19:28:13.0283710Z                          )
2026-01-11T19:28:13.0284503Z                      
2026-01-11T19:28:13.0285270Z                          if (-not (Test-Path $script:ConsentRoot)) {
2026-01-11T19:28:13.0285895Z                              New-Item -Path $script:ConsentRoot -ItemType Directory -Force | Out-Null
2026-01-11T19:28:13.0286340Z                          }
2026-01-11T19:28:13.0286868Z                      
2026-01-11T19:28:13.0287444Z                          $payload = @{
2026-01-11T19:28:13.0288453Z                              InstallConsent = $InstallConsent
2026-01-11T19:28:13.0289338Z                              UpdatedAtUtc = (Get-Date).ToUniversalTime().ToString("o")
2026-01-11T19:28:13.0289505Z                              Source = "benchmark-setup.ps1"
2026-01-11T19:28:13.0289695Z                          }
2026-01-11T19:28:13.0290578Z                      
2026-01-11T19:28:13.0291628Z                          $payload | ConvertTo-Json -Depth 3 | Set-Content -Path $script:ConsentFilePath -Encoding UTF8
2026-01-11T19:28:13.0291739Z                      }
2026-01-11T19:28:13.0292351Z                      
2026-01-11T19:28:13.0293285Z                      function Confirm-InstallConsent {
2026-01-11T19:28:13.0293576Z                          <#
2026-01-11T19:28:13.0294273Z                          .SYNOPSIS
2026-01-11T19:28:13.0295141Z                              Prompts the user for explicit consent before installing software.
2026-01-11T19:28:13.0295476Z                          .DESCRIPTION
2026-01-11T19:28:13.0296237Z                              This script uses winget to install tools. Some users want a hard
2026-01-11T19:28:13.0296723Z                              opt-in before any install activity starts. This function ensures
2026-01-11T19:28:13.0297562Z                              that no package installation occurs without a clear confirmation.
2026-01-11T19:28:13.0297688Z                          #>
2026-01-11T19:28:13.0297987Z                          param(
2026-01-11T19:28:13.0298792Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.0299468Z                              [string[]]$PackageNames
2026-01-11T19:28:13.0300533Z                          )
2026-01-11T19:28:13.0300730Z                      
2026-01-11T19:28:13.0301282Z                          Write-Section "Install Consent"
2026-01-11T19:28:13.0302377Z                          Write-Note "This script can install the following tools via winget:"
2026-01-11T19:28:13.0303151Z                          foreach ($name in $PackageNames) {
2026-01-11T19:28:13.0303586Z                              Write-Host "  - $name" -ForegroundColor White
2026-01-11T19:28:13.0303741Z                          }
2026-01-11T19:28:13.0304704Z                          Write-Note "No installations will occur without your consent."
2026-01-11T19:28:13.0305321Z                          Write-Note "Consent cache path: $script:ConsentFilePath"
2026-01-11T19:28:13.0306523Z                          Write-Note "Reset the cached choice with: .\\benchmark-setup.ps1 -ResetConsent"
2026-01-11T19:28:13.0306628Z                      
2026-01-11T19:28:13.0307439Z                          if ($script:ResetConsent -and (Test-Path $script:ConsentFilePath)) {
2026-01-11T19:28:13.0308377Z                              try {
2026-01-11T19:28:13.0308944Z                                  Remove-Item -Path $script:ConsentFilePath -Force
2026-01-11T19:28:13.0309551Z                                  Write-Ok "Consent cache cleared."
2026-01-11T19:28:13.0310117Z                              } catch {
2026-01-11T19:28:13.0311220Z                                  Write-Warn "Unable to remove consent cache. You may need to delete it manually."
2026-01-11T19:28:13.0311843Z                              }
2026-01-11T19:28:13.0312505Z                              $script:ResetConsent = $false
2026-01-11T19:28:13.0313237Z                          }
2026-01-11T19:28:13.0313337Z                      
2026-01-11T19:28:13.0314508Z                          # -------------------------------------------------------------------------
2026-01-11T19:28:13.0314757Z                          # AUTO-ACCEPT MODE
2026-01-11T19:28:13.0315723Z                          # -------------------------------------------------------------------------
2026-01-11T19:28:13.0316097Z                          # When -AutoAccept is specified, we skip all interactive prompts and
2026-01-11T19:28:13.0317213Z                          # automatically grant install consent. This is useful for:
2026-01-11T19:28:13.0317717Z                          #   - CI/CD pipelines where no human is present to answer prompts
2026-01-11T19:28:13.0317929Z                          #   - Automated testing environments
2026-01-11T19:28:13.0318362Z                          #   - Scripted deployments where you've already reviewed the tools
2026-01-11T19:28:13.0318780Z                          #
2026-01-11T19:28:13.0320098Z                          # The auto-accept does NOT save to the consent cache - it only affects
2026-01-11T19:28:13.0320693Z                          # the current execution. If you want to permanently allow installs without
2026-01-11T19:28:13.0320992Z                          # prompts, run once interactively and choose "Y" to remember.
2026-01-11T19:28:13.0321152Z                          #
2026-01-11T19:28:13.0321917Z                          # Usage: .\benchmark-setup.ps1 -AutoAccept
2026-01-11T19:28:13.0322559Z                          # -------------------------------------------------------------------------
2026-01-11T19:28:13.0322970Z                          if ($script:AutoAccept) {
2026-01-11T19:28:13.0324853Z                              Write-Ok "Auto-accept mode: installs are allowed."
2026-01-11T19:28:13.0325148Z                              return $true
2026-01-11T19:28:13.0325327Z                          }
2026-01-11T19:28:13.0325837Z                      
2026-01-11T19:28:13.0326675Z                          $cached = Get-ConsentCache
2026-01-11T19:28:13.0327561Z                          if ($null -ne $cached) {
2026-01-11T19:28:13.0328198Z                              if ($cached) {
2026-01-11T19:28:13.0329287Z                                  Write-Ok "Using saved consent: installs are allowed."
2026-01-11T19:28:13.0329665Z                              } else {
2026-01-11T19:28:13.0330572Z                                  Write-Warn "Using saved consent: installs are blocked."
2026-01-11T19:28:13.0330673Z                              }
2026-01-11T19:28:13.0331105Z                              return $cached
2026-01-11T19:28:13.0332275Z                          }
2026-01-11T19:28:13.0332413Z                      
2026-01-11T19:28:13.0333205Z                          $installConsent = Prompt-YesNo -Message "Install missing tools now? (Y/N)"
2026-01-11T19:28:13.0333608Z                      
2026-01-11T19:28:13.0334551Z                          $remember = Prompt-YesNo -Message "Remember this choice for next time? (Y/N)"
2026-01-11T19:28:13.0334719Z                          if ($remember) {
2026-01-11T19:28:13.0335240Z                              try {
2026-01-11T19:28:13.0336115Z                                  Set-ConsentCache -InstallConsent $installConsent
2026-01-11T19:28:13.0337329Z                                  Write-Ok "Consent saved."
2026-01-11T19:28:13.0337448Z                              } catch {
2026-01-11T19:28:13.0338490Z                                  Write-Warn "Unable to save consent cache. It will ask again next time."
2026-01-11T19:28:13.0338780Z                              }
2026-01-11T19:28:13.0339281Z                          }
2026-01-11T19:28:13.0340425Z                      
2026-01-11T19:28:13.0340678Z                          if ($installConsent) {
2026-01-11T19:28:13.0341605Z                              Write-Ok "Consent granted. Proceeding with installs when needed."
2026-01-11T19:28:13.0341967Z                          } else {
2026-01-11T19:28:13.0342414Z                              Write-Warn "Consent not granted. Skipping winget install and package installs."
2026-01-11T19:28:13.0342706Z                          }
2026-01-11T19:28:13.0343707Z                      
2026-01-11T19:28:13.0343877Z                          return $installConsent
2026-01-11T19:28:13.0344386Z                      }
2026-01-11T19:28:13.0345066Z                      
2026-01-11T19:28:13.0345817Z                      
2026-01-11T19:28:13.0346367Z                      # ----------------------------
2026-01-11T19:28:13.0347116Z                      # Winget detection and install
2026-01-11T19:28:13.0348228Z                      # ----------------------------
2026-01-11T19:28:13.0348349Z                      
2026-01-11T19:28:13.0348901Z                      function Test-WingetAvailable {
2026-01-11T19:28:13.0349751Z                          <#
2026-01-11T19:28:13.0350527Z                          .SYNOPSIS
2026-01-11T19:28:13.0351524Z                              Returns true if winget is callable.
2026-01-11T19:28:13.0351661Z                          .DESCRIPTION
2026-01-11T19:28:13.0352400Z                              Uses "winget --version" and checks the exit code. This avoids relying
2026-01-11T19:28:13.0352856Z                              on PATH heuristics and provides a simple availability check.
2026-01-11T19:28:13.0353323Z                          #>
2026-01-11T19:28:13.0353909Z                          try {
2026-01-11T19:28:13.0354654Z                              $null = winget --version 2>&1
2026-01-11T19:28:13.0355306Z                              return ($LASTEXITCODE -eq 0)
2026-01-11T19:28:13.0355776Z                          } catch {
2026-01-11T19:28:13.0357011Z                              return $false
2026-01-11T19:28:13.0357118Z                          }
2026-01-11T19:28:13.0357222Z                      }
2026-01-11T19:28:13.0357917Z                      
2026-01-11T19:28:13.0358875Z                      function Install-WingetIfMissing {
2026-01-11T19:28:13.0359707Z                          <#
2026-01-11T19:28:13.0360723Z                          .SYNOPSIS
2026-01-11T19:28:13.0361879Z                              Attempts to install winget if not already available.
2026-01-11T19:28:13.0362012Z                          .DESCRIPTION
2026-01-11T19:28:13.0362714Z                              The Microsoft-supported path is the App Installer package. This function:
2026-01-11T19:28:13.0363069Z                                1) Tries to open the Microsoft Store App Installer page.
2026-01-11T19:28:13.0364564Z                                2) Falls back to downloading the App Installer bundle from aka.ms.
2026-01-11T19:28:13.0364827Z                      
2026-01-11T19:28:13.0366137Z                              This mirrors the logic used in the main gaming-pc-setup script, but is
2026-01-11T19:28:13.0366750Z                              fully self-contained here for a standalone benchmark script.
2026-01-11T19:28:13.0367505Z                          #>
2026-01-11T19:28:13.0368424Z                          Write-Section "Winget Availability"
2026-01-11T19:28:13.0369094Z                          Write-Note "Checking if winget is available..."
2026-01-11T19:28:13.0369668Z                      
2026-01-11T19:28:13.0370722Z                          if (Test-WingetAvailable) {
2026-01-11T19:28:13.0371491Z                              $version = winget --version 2>&1
2026-01-11T19:28:13.0372298Z                              Write-Ok "winget is available ($version)."
2026-01-11T19:28:13.0373307Z                              return $true
2026-01-11T19:28:13.0374177Z                          }
2026-01-11T19:28:13.0374855Z                      
2026-01-11T19:28:13.0375857Z                          Write-Warn "winget is not available. Attempting installation."
2026-01-11T19:28:13.0376499Z                      
2026-01-11T19:28:13.0377770Z                          # Method 1: Microsoft Store App Installer page.
2026-01-11T19:28:13.0377930Z                          try {
2026-01-11T19:28:13.0379561Z                              $storeApp = Get-AppxPackage -Name "Microsoft.WindowsStore" -ErrorAction SilentlyContinue
2026-01-11T19:28:13.0379836Z                              if ($storeApp) {
2026-01-11T19:28:13.0380173Z                                  Write-Note "Opening Microsoft Store App Installer page."
2026-01-11T19:28:13.0381463Z                                  Start-Process "ms-windows-store://pdp/?ProductId=9NBLGGH4NNS1" -ErrorAction 
2026-01-11T19:28:13.0381626Z                      SilentlyContinue
2026-01-11T19:28:13.0382756Z                                  Write-Warn "Install 'App Installer' from the Store, then rerun this script."
2026-01-11T19:28:13.0383188Z                                  return $false
2026-01-11T19:28:13.0383994Z                              } else {
2026-01-11T19:28:13.0385348Z                                  Write-Warn "Microsoft Store not detected. Using direct download fallback."
2026-01-11T19:28:13.0385464Z                              }
2026-01-11T19:28:13.0385890Z                          } catch {
2026-01-11T19:28:13.0387056Z                              Write-Warn "Unable to open the Microsoft Store. Using direct download fallback."
2026-01-11T19:28:13.0387452Z                          }
2026-01-11T19:28:13.0388184Z                      
2026-01-11T19:28:13.0389297Z                          # Method 2: Direct download from Microsoft.
2026-01-11T19:28:13.0389404Z                          try {
2026-01-11T19:28:13.0390185Z                              $appInstallerUrl = "https://aka.ms/getwinget"
2026-01-11T19:28:13.0390953Z                              $downloadPath = Join-Path $env:TEMP "Microsoft.DesktopAppInstaller.msixbundle"
2026-01-11T19:28:13.0391163Z                      
2026-01-11T19:28:13.0392210Z                              Write-Note "Downloading App Installer bundle from $appInstallerUrl"
2026-01-11T19:28:13.0393495Z                              Invoke-WebRequest -Uri $appInstallerUrl -OutFile $downloadPath -UseBasicParsing 
2026-01-11T19:28:13.0393673Z                      -TimeoutSec 60 -ErrorAction Stop
2026-01-11T19:28:13.0393945Z                      
2026-01-11T19:28:13.0394663Z                              Write-Note "Installing App Installer bundle"
2026-01-11T19:28:13.0395275Z                              Add-AppxPackage -Path $downloadPath -ErrorAction Stop
2026-01-11T19:28:13.0395768Z                      
2026-01-11T19:28:13.0396934Z                              Remove-Item $downloadPath -ErrorAction SilentlyContinue
2026-01-11T19:28:13.0397261Z                      
2026-01-11T19:28:13.0398946Z                              Write-Ok "App Installer installed. Please restart PowerShell and rerun this script."
2026-01-11T19:28:13.0399123Z                              return $false
2026-01-11T19:28:13.0399241Z                          } catch {
2026-01-11T19:28:13.0399614Z                              Write-Fail "Failed to install App Installer. Install manually from 
2026-01-11T19:28:13.0400065Z                      https://aka.ms/getwinget"
2026-01-11T19:28:13.0400854Z                              return $false
2026-01-11T19:28:13.0401291Z                          }
2026-01-11T19:28:13.0402408Z                      }
2026-01-11T19:28:13.0402766Z                      
2026-01-11T19:28:13.0404574Z                      
2026-01-11T19:28:13.0404802Z                      # ----------------------------
2026-01-11T19:28:13.0405039Z                      # Package install and path resolution
2026-01-11T19:28:13.0405451Z                      # ----------------------------
2026-01-11T19:28:13.0406137Z                      
2026-01-11T19:28:13.0407021Z                      function Test-WingetPackageInstalled {
2026-01-11T19:28:13.0407647Z                          <#
2026-01-11T19:28:13.0408139Z                          .SYNOPSIS
2026-01-11T19:28:13.0408903Z                              Checks if a package is installed via winget list output.
2026-01-11T19:28:13.0409424Z                          .DESCRIPTION
2026-01-11T19:28:13.0410209Z                              Uses "winget list" and matches the package identifier in the output.
2026-01-11T19:28:13.0410688Z                              This works even when winget cannot reliably report install locations.
2026-01-11T19:28:13.0410878Z                          #>
2026-01-11T19:28:13.0411960Z                          param(
2026-01-11T19:28:13.0412773Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.0413499Z                              [string]$PackageId
2026-01-11T19:28:13.0413616Z                          )
2026-01-11T19:28:13.0414158Z                      
2026-01-11T19:28:13.0414651Z                          try {
2026-01-11T19:28:13.0415762Z                              $output = winget list --id $PackageId --source winget --accept-source-agreements 2>&1
2026-01-11T19:28:13.0416247Z                              if ($LASTEXITCODE -ne 0) {
2026-01-11T19:28:13.0417051Z                                  return $false
2026-01-11T19:28:13.0417311Z                              }
2026-01-11T19:28:13.0418265Z                      
2026-01-11T19:28:13.0418760Z                              return ($output -match [regex]::Escape($PackageId))
2026-01-11T19:28:13.0418874Z                          } catch {
2026-01-11T19:28:13.0419361Z                              return $false
2026-01-11T19:28:13.0420646Z                          }
2026-01-11T19:28:13.0421026Z                      }
2026-01-11T19:28:13.0421602Z                      
2026-01-11T19:28:13.0422403Z                      function Install-WingetPackage {
2026-01-11T19:28:13.0423075Z                          <#
2026-01-11T19:28:13.0423815Z                          .SYNOPSIS
2026-01-11T19:28:13.0424875Z                              Installs a package by winget ID, with verification.
2026-01-11T19:28:13.0425523Z                          .DESCRIPTION
2026-01-11T19:28:13.0427087Z                              Some winget installers return non-zero exit codes even when successful.
2026-01-11T19:28:13.0427448Z                              This function re-checks install state to avoid false negatives.
2026-01-11T19:28:13.0427992Z                          #>
2026-01-11T19:28:13.0428805Z                          param(
2026-01-11T19:28:13.0429816Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.0430744Z                              [string]$PackageId,
2026-01-11T19:28:13.0431816Z                      
2026-01-11T19:28:13.0433202Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.0433610Z                              [string]$PackageName
2026-01-11T19:28:13.0433760Z                          )
2026-01-11T19:28:13.0434933Z                      
2026-01-11T19:28:13.0435814Z                          if (Test-WingetPackageInstalled -PackageId $PackageId) {
2026-01-11T19:28:13.0436111Z                              Write-Ok "$PackageName already installed."
2026-01-11T19:28:13.0437203Z                              return $true
2026-01-11T19:28:13.0437324Z                          }
2026-01-11T19:28:13.0437775Z                      
2026-01-11T19:28:13.0438728Z                          Write-Note "Installing $PackageName via winget ($PackageId)."
2026-01-11T19:28:13.0440273Z                          $null = winget install --id $PackageId --source winget --accept-package-agreements 
2026-01-11T19:28:13.0440492Z                      --accept-source-agreements --silent 2>&1
2026-01-11T19:28:13.0440591Z                      
2026-01-11T19:28:13.0440778Z                          if ($LASTEXITCODE -eq 0) {
2026-01-11T19:28:13.0441544Z                              Write-Ok "$PackageName installed."
2026-01-11T19:28:13.0441951Z                              return $true
2026-01-11T19:28:13.0442662Z                          }
2026-01-11T19:28:13.0443836Z                      
2026-01-11T19:28:13.0444999Z                          # Some installs return a non-zero exit code even if the package is present.
2026-01-11T19:28:13.0445311Z                          if (Test-WingetPackageInstalled -PackageId $PackageId) {
2026-01-11T19:28:13.0445757Z                              Write-Ok "$PackageName already installed (post-install verification)."
2026-01-11T19:28:13.0446147Z                              return $true
2026-01-11T19:28:13.0447145Z                          }
2026-01-11T19:28:13.0447995Z                      
2026-01-11T19:28:13.0448845Z                          Write-Fail "Failed to install $PackageName (winget exit code $LASTEXITCODE)."
2026-01-11T19:28:13.0448984Z                          return $false
2026-01-11T19:28:13.0449372Z                      }
2026-01-11T19:28:13.0450047Z                      
2026-01-11T19:28:13.0450578Z                      function Get-RegistryInstallLocations {
2026-01-11T19:28:13.0451000Z                          <#
2026-01-11T19:28:13.0452162Z                          .SYNOPSIS
2026-01-11T19:28:13.0452473Z                              Finds install locations using registry uninstall entries.
2026-01-11T19:28:13.0452689Z                          .DESCRIPTION
2026-01-11T19:28:13.0453649Z                              This is a reliable fallback when installers register their paths.
2026-01-11T19:28:13.0454280Z                              It checks both 64-bit and 32-bit views to cover legacy installers.
2026-01-11T19:28:13.0454568Z                          #>
2026-01-11T19:28:13.0455582Z                          param(
2026-01-11T19:28:13.0456038Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.0456869Z                              [string]$DisplayNamePattern
2026-01-11T19:28:13.0457104Z                          )
2026-01-11T19:28:13.0457982Z                      
2026-01-11T19:28:13.0458444Z                          # Look for installer entries in HKLM and HKCU (both 64-bit and 32-bit views).
2026-01-11T19:28:13.0458607Z                          $registryPaths = @(
2026-01-11T19:28:13.0459646Z                              "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*",
2026-01-11T19:28:13.0460528Z                              "HKLM:\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall\*",
2026-01-11T19:28:13.0460828Z                              "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*"
2026-01-11T19:28:13.0461404Z                          )
2026-01-11T19:28:13.0462093Z                      
2026-01-11T19:28:13.0462246Z                          $locations = @()
2026-01-11T19:28:13.0463083Z                          foreach ($path in $registryPaths) {
2026-01-11T19:28:13.0463436Z                              try {
2026-01-11T19:28:13.0463869Z                                  $items = Get-ItemProperty -Path $path -ErrorAction SilentlyContinue |
2026-01-11T19:28:13.0464831Z                                      Where-Object { $_.DisplayName -like $DisplayNamePattern }
2026-01-11T19:28:13.0464938Z                      
2026-01-11T19:28:13.0465528Z                                  foreach ($item in $items) {
2026-01-11T19:28:13.0466182Z                                      if ($item.InstallLocation) {
2026-01-11T19:28:13.0467531Z                                          $locations += $item.InstallLocation
2026-01-11T19:28:13.0467800Z                                      } elseif ($item.DisplayIcon) {
2026-01-11T19:28:13.0469105Z                                          $locations += (Split-Path -Parent $item.DisplayIcon)
2026-01-11T19:28:13.0469229Z                                      }
2026-01-11T19:28:13.0469711Z                                  }
2026-01-11T19:28:13.0470337Z                              } catch {
2026-01-11T19:28:13.0471118Z                                  # Ignore registry access errors to keep the script robust.
2026-01-11T19:28:13.0472638Z                              }
2026-01-11T19:28:13.0472835Z                          }
2026-01-11T19:28:13.0473198Z                      
2026-01-11T19:28:13.0474727Z                          return $locations | Select-Object -Unique
2026-01-11T19:28:13.0474829Z                      }
2026-01-11T19:28:13.0475571Z                      
2026-01-11T19:28:13.0477133Z                      function Get-WingetInstalledLocation {
2026-01-11T19:28:13.0477240Z                          <#
2026-01-11T19:28:13.0478198Z                          .SYNOPSIS
2026-01-11T19:28:13.0479307Z                              Attempts to read the installed location from winget JSON output.
2026-01-11T19:28:13.0480010Z                          .DESCRIPTION
2026-01-11T19:28:13.0480916Z                              Newer winget versions can output JSON for "winget list".
2026-01-11T19:28:13.0481558Z                              When present, the JSON may include an install location field.
2026-01-11T19:28:13.0481974Z                              This is not guaranteed across versions, so this is best-effort only.
2026-01-11T19:28:13.0482208Z                          .OUTPUTS
2026-01-11T19:28:13.0483806Z                              [string] Install location path or $null if not available.
2026-01-11T19:28:13.0484022Z                          #>
2026-01-11T19:28:13.0485529Z                          param(
2026-01-11T19:28:13.0486212Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.0486967Z                              [string]$PackageId
2026-01-11T19:28:13.0487149Z                          )
2026-01-11T19:28:13.0487915Z                      
2026-01-11T19:28:13.0489008Z                          if (-not $script:WingetAvailable) {
2026-01-11T19:28:13.0489151Z                              return $null
2026-01-11T19:28:13.0489799Z                          }
2026-01-11T19:28:13.0490191Z                      
2026-01-11T19:28:13.0490900Z                          try {
2026-01-11T19:28:13.0491860Z                              $jsonText = winget list --id $PackageId --source winget --accept-source-agreements 
2026-01-11T19:28:13.0492523Z                      --output json 2>&1
2026-01-11T19:28:13.0492716Z                              if ($LASTEXITCODE -ne 0) {
2026-01-11T19:28:13.0493727Z                                  return $null
2026-01-11T19:28:13.0494392Z                              }
2026-01-11T19:28:13.0494756Z                      
2026-01-11T19:28:13.0495469Z                              $data = $jsonText | ConvertFrom-Json -ErrorAction Stop
2026-01-11T19:28:13.0495820Z                          } catch {
2026-01-11T19:28:13.0496305Z                              return $null
2026-01-11T19:28:13.0496646Z                          }
2026-01-11T19:28:13.0498273Z                      
2026-01-11T19:28:13.0498467Z                          $packages = @()
2026-01-11T19:28:13.0498727Z                          if ($data.Sources) {
2026-01-11T19:28:13.0499664Z                              foreach ($source in $data.Sources) {
2026-01-11T19:28:13.0500441Z                                  if ($source.Packages) {
2026-01-11T19:28:13.0501312Z                                      $packages += $source.Packages
2026-01-11T19:28:13.0502443Z                                  }
2026-01-11T19:28:13.0502542Z                              }
2026-01-11T19:28:13.0503121Z                          } elseif ($data.Packages) {
2026-01-11T19:28:13.0504051Z                              $packages += $data.Packages
2026-01-11T19:28:13.0504571Z                          }
2026-01-11T19:28:13.0505615Z                      
2026-01-11T19:28:13.0505846Z                          $match = $packages | Where-Object {
2026-01-11T19:28:13.0506944Z                              $_.PackageIdentifier -eq $PackageId -or $_.Id -eq $PackageId
2026-01-11T19:28:13.0507109Z                          } | Select-Object -First 1
2026-01-11T19:28:13.0507802Z                      
2026-01-11T19:28:13.0509313Z                          if (-not $match) {
2026-01-11T19:28:13.0509592Z                              return $null
2026-01-11T19:28:13.0510156Z                          }
2026-01-11T19:28:13.0510956Z                      
2026-01-11T19:28:13.0512700Z                          $locationProps = @("InstallLocation", "InstalledLocation", "Location", "InstallPath", 
2026-01-11T19:28:13.0512854Z                      "InstalledPath")
2026-01-11T19:28:13.0513226Z                          foreach ($prop in $locationProps) {
2026-01-11T19:28:13.0514261Z                              if ($match.PSObject.Properties.Name -contains $prop -and $match.$prop) {
2026-01-11T19:28:13.0514954Z                                  return $match.$prop
2026-01-11T19:28:13.0515812Z                              }
2026-01-11T19:28:13.0516532Z                          }
2026-01-11T19:28:13.0517342Z                      
2026-01-11T19:28:13.0517743Z                          return $null
2026-01-11T19:28:13.0519232Z                      }
2026-01-11T19:28:13.0519960Z                      
2026-01-11T19:28:13.0520815Z                      function Resolve-ExecutablePath {
2026-01-11T19:28:13.0521417Z                          <#
2026-01-11T19:28:13.0522069Z                          .SYNOPSIS
2026-01-11T19:28:13.0522951Z                              Resolves the full path to a tool executable.
2026-01-11T19:28:13.0523329Z                          .DESCRIPTION
2026-01-11T19:28:13.0524587Z                              Uses a multi-step strategy:
2026-01-11T19:28:13.0524875Z                                1) Known default paths (fast and deterministic)
2026-01-11T19:28:13.0525782Z                                2) Winget JSON install location (best effort)
2026-01-11T19:28:13.0526206Z                                3) Registry uninstall entries (best effort)
2026-01-11T19:28:13.0527336Z                                4) Limited folder scan under known vendor roots
2026-01-11T19:28:13.0527440Z                          #>
2026-01-11T19:28:13.0527979Z                          param(
2026-01-11T19:28:13.0528866Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.0529837Z                              [string[]]$ExeNames,
2026-01-11T19:28:13.0530671Z                      
2026-01-11T19:28:13.0531632Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.0532433Z                              [string[]]$DefaultCandidates,
2026-01-11T19:28:13.0533119Z                      
2026-01-11T19:28:13.0534043Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.0534951Z                              [string]$RegistryNamePattern,
2026-01-11T19:28:13.0535633Z                      
2026-01-11T19:28:13.0536538Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.0537652Z                              [string]$PackageId
2026-01-11T19:28:13.0538259Z                          )
2026-01-11T19:28:13.0539654Z                      
2026-01-11T19:28:13.0541168Z                          # Winget does not reliably expose install paths for all packages, so we use:
2026-01-11T19:28:13.0542994Z                          # 1) Known default paths (fast and predictable)
2026-01-11T19:28:13.0544505Z                          # 2) Winget JSON install location (best effort)
2026-01-11T19:28:13.0545801Z                          # 3) Registry uninstall entries (best effort)
2026-01-11T19:28:13.0547028Z                          # 4) Limited directory search under known vendor roots
2026-01-11T19:28:13.0548158Z                          #
2026-01-11T19:28:13.0549500Z                          # This keeps the script deterministic while still finding installs that
2026-01-11T19:28:13.0550595Z                          # do not use the defaults.
2026-01-11T19:28:13.0551666Z                      
2026-01-11T19:28:13.0553999Z                          # 1) Check known default paths first (fast and predictable).
2026-01-11T19:28:13.0555588Z                          foreach ($candidate in $DefaultCandidates) {
2026-01-11T19:28:13.0557875Z                              if (Test-Path $candidate) {
2026-01-11T19:28:13.0559922Z                                  return $candidate
2026-01-11T19:28:13.0562477Z                              }
2026-01-11T19:28:13.0565028Z                          }
2026-01-11T19:28:13.0566924Z                      
2026-01-11T19:28:13.0569010Z                          # 2) Check winget JSON install location (if supported by the local winget).
2026-01-11T19:28:13.0570411Z                          $wingetLocation = Get-WingetInstalledLocation -PackageId $PackageId
2026-01-11T19:28:13.0571855Z                          if ($wingetLocation -and (Test-Path $wingetLocation)) {
2026-01-11T19:28:13.0573541Z                              $wingetItem = Get-Item $wingetLocation -ErrorAction SilentlyContinue
2026-01-11T19:28:13.0575027Z                              if ($wingetItem -and -not $wingetItem.PSIsContainer) {
2026-01-11T19:28:13.0576108Z                                  return $wingetLocation
2026-01-11T19:28:13.0577119Z                              }
2026-01-11T19:28:13.0578134Z                      
2026-01-11T19:28:13.0579112Z                              foreach ($exeName in $ExeNames) {
2026-01-11T19:28:13.0580161Z                                  $wingetExe = Join-Path $wingetLocation $exeName
2026-01-11T19:28:13.0583979Z                                  if (Test-Path $wingetExe) {
2026-01-11T19:28:13.0585072Z                                      return $wingetExe
2026-01-11T19:28:13.0585869Z                                  }
2026-01-11T19:28:13.0586538Z                      
2026-01-11T19:28:13.0587590Z                                  $wingetBinExe = Join-Path (Join-Path $wingetLocation "bin") $exeName
2026-01-11T19:28:13.0588370Z                                  if (Test-Path $wingetBinExe) {
2026-01-11T19:28:13.0589034Z                                      return $wingetBinExe
2026-01-11T19:28:13.0589809Z                                  }
2026-01-11T19:28:13.0590427Z                              }
2026-01-11T19:28:13.0591254Z                          }
2026-01-11T19:28:13.0591910Z                      
2026-01-11T19:28:13.0592718Z                          # 3) Check install locations reported in the registry.
2026-01-11T19:28:13.0593457Z                          $registryLocations = Get-RegistryInstallLocations -DisplayNamePattern $RegistryNamePattern
2026-01-11T19:28:13.0593750Z                          foreach ($location in $registryLocations) {
2026-01-11T19:28:13.0594901Z                              foreach ($exeName in $ExeNames) {
2026-01-11T19:28:13.0595110Z                                  $exePath = Join-Path $location $exeName
2026-01-11T19:28:13.0595308Z                                  if (Test-Path $exePath) {
2026-01-11T19:28:13.0596620Z                                      return $exePath
2026-01-11T19:28:13.0596765Z                                  }
2026-01-11T19:28:13.0596866Z                      
2026-01-11T19:28:13.0597424Z                                  # Some installers put binaries in a subfolder like "bin".
2026-01-11T19:28:13.0598042Z                                  $binExePath = Join-Path (Join-Path $location "bin") $exeName
2026-01-11T19:28:13.0598738Z                                  if (Test-Path $binExePath) {
2026-01-11T19:28:13.0599134Z                                      return $binExePath
2026-01-11T19:28:13.0600231Z                                  }
2026-01-11T19:28:13.0600632Z                              }
2026-01-11T19:28:13.0601262Z                          }
2026-01-11T19:28:13.0601946Z                      
2026-01-11T19:28:13.0602271Z                          # 4) Last resort: search a specific root if it exists.
2026-01-11T19:28:13.0602918Z                          # This is intentionally limited to known vendor roots to avoid a full disk scan.
2026-01-11T19:28:13.0603842Z                          foreach ($location in $registryLocations) {
2026-01-11T19:28:13.0604344Z                              if (Test-Path $location) {
2026-01-11T19:28:13.0604799Z                                  try {
2026-01-11T19:28:13.0605518Z                                      foreach ($exeName in $ExeNames) {
2026-01-11T19:28:13.0607460Z                                          $found = Get-ChildItem -Path $location -Recurse -Filter $exeName -ErrorAction 
2026-01-11T19:28:13.0607627Z                      SilentlyContinue |
2026-01-11T19:28:13.0608210Z                                              Select-Object -First 1
2026-01-11T19:28:13.0608859Z                                          if ($found) {
2026-01-11T19:28:13.0610015Z                                              return $found.FullName
2026-01-11T19:28:13.0610134Z                                          }
2026-01-11T19:28:13.0610932Z                                      }
2026-01-11T19:28:13.0611306Z                                  } catch {
2026-01-11T19:28:13.0612090Z                                      # Ignore access errors.
2026-01-11T19:28:13.0612212Z                                  }
2026-01-11T19:28:13.0612674Z                              }
2026-01-11T19:28:13.0613434Z                          }
2026-01-11T19:28:13.0614070Z                      
2026-01-11T19:28:13.0614540Z                          return $null
2026-01-11T19:28:13.0614908Z                      }
2026-01-11T19:28:13.0615488Z                      
2026-01-11T19:28:13.0616279Z                      
2026-01-11T19:28:13.0617171Z                      # ----------------------------
2026-01-11T19:28:13.0617552Z                      # Benchmark stack definition
2026-01-11T19:28:13.0619267Z                      # ----------------------------
2026-01-11T19:28:13.0619391Z                      
2026-01-11T19:28:13.0619549Z                      Write-Section "Benchmark Stack"
2026-01-11T19:28:13.0620650Z                      Write-Note "This script installs a small, free toolchain for FPS and frametime testing."
2026-01-11T19:28:13.0621142Z                      Write-Note "It does not change system settings. It only installs tools and launches them."
2026-01-11T19:28:13.0621667Z                      Write-Note "These tools were chosen because they are repeatable and measurable:"
2026-01-11T19:28:13.0622847Z                      Write-Note "- CapFrameX: frametime capture and percentile lows (more honest than avg FPS alone)."
2026-01-11T19:28:13.0623250Z                      Write-Note "- Superposition: fixed GPU workload with repeatable scoring."
2026-01-11T19:28:13.0623958Z                      Write-Note "- LatencyMon: validates DPC/ISR latency to explain micro-stutter."
2026-01-11T19:28:13.0624374Z                      Write-Note "Windows 10 and 11 use the same default install paths for these tools."
2026-01-11T19:28:13.0625320Z                      Write-Note "The script targets 64-bit installs and still checks legacy locations for safety."
2026-01-11T19:28:13.0625441Z                      
2026-01-11T19:28:13.0625734Z                      $packages = @(
2026-01-11T19:28:13.0626918Z                          # Each package entry defines:
2026-01-11T19:28:13.0627473Z                          #   - Winget ID for installation
2026-01-11T19:28:13.0628500Z                          #   - Default executable paths for x64 installs
2026-01-11T19:28:13.0628769Z                          #   - Config checklist steps for repeatable results
2026-01-11T19:28:13.0629554Z                          #   - Whether to launch automatically when found
2026-01-11T19:28:13.0630188Z                          @{
2026-01-11T19:28:13.0631387Z                              Id = "CXWorld.CapFrameX"
2026-01-11T19:28:13.0632061Z                              Name = "CapFrameX"
2026-01-11T19:28:13.0632984Z                              Purpose = "Captures frametimes and computes avg FPS, 1% low, and 0.1% low."
2026-01-11T19:28:13.0633181Z                              ExeNames = @("CapFrameX.exe")
2026-01-11T19:28:13.0633330Z                              RegistryPattern = "*CapFrameX*"
2026-01-11T19:28:13.0634479Z                              DefaultPaths = @(
2026-01-11T19:28:13.0635212Z                                  "C:\Program Files\CapFrameX\CapFrameX.exe",
2026-01-11T19:28:13.0635962Z                                  "C:\Program Files (x86)\CapFrameX\CapFrameX.exe"
2026-01-11T19:28:13.0636858Z                              )
2026-01-11T19:28:13.0637689Z                              Configure = @(
2026-01-11T19:28:13.0638536Z                                  "Capture API: PresentMon",
2026-01-11T19:28:13.0639363Z                                  "Capture duration: 60s",
2026-01-11T19:28:13.0639858Z                                  "Start delay: 3s",
2026-01-11T19:28:13.0640871Z                                  "Hotkey: F11 (start/stop capture)",
2026-01-11T19:28:13.0641943Z                                  "Overlay optional; do not enable additional overlays for clean results"
2026-01-11T19:28:13.0642066Z                              )
2026-01-11T19:28:13.0643223Z                              Launch = $true
2026-01-11T19:28:13.0643330Z                          },
2026-01-11T19:28:13.0643815Z                          @{
2026-01-11T19:28:13.0645044Z                              Id = "Unigine.SuperpositionBenchmark"
2026-01-11T19:28:13.0645223Z                              Name = "Unigine Superposition"
2026-01-11T19:28:13.0646615Z                              Purpose = "Repeatable GPU benchmark for consistent before/after comparisons."
2026-01-11T19:28:13.0646823Z                              ExeNames = @("Superposition.exe")
2026-01-11T19:28:13.0647266Z                              RegistryPattern = "*Superposition*"
2026-01-11T19:28:13.0647632Z                              DefaultPaths = @(
2026-01-11T19:28:13.0648831Z                                  "C:\Program Files\Unigine\Superposition\Superposition.exe",
2026-01-11T19:28:13.0649115Z                                  "C:\Program Files\Unigine\Superposition\bin\Superposition.exe"
2026-01-11T19:28:13.0650314Z                              )
2026-01-11T19:28:13.0650450Z                              Configure = @(
2026-01-11T19:28:13.0651446Z                                  "Preset: 1080p Medium",
2026-01-11T19:28:13.0652460Z                                  "Fullscreen: On",
2026-01-11T19:28:13.0652591Z                                  "VSync: Off",
2026-01-11T19:28:13.0654180Z                                  "Run 3 passes; discard the first (shader compilation), average the rest"
2026-01-11T19:28:13.0654326Z                              )
2026-01-11T19:28:13.0655319Z                              Launch = $true
2026-01-11T19:28:13.0656169Z                          },
2026-01-11T19:28:13.0656852Z                          @{
2026-01-11T19:28:13.0658340Z                              Id = "Resplendence.LatencyMon"
2026-01-11T19:28:13.0658529Z                              Name = "LatencyMon"
2026-01-11T19:28:13.0659001Z                              Purpose = "Detects DPC/ISR latency spikes that can cause stutter or audio crackle."
2026-01-11T19:28:13.0659334Z                              ExeNames = @("LatencyMon.exe", "LatMon.exe")
2026-01-11T19:28:13.0660183Z                              RegistryPattern = "*LatencyMon*"
2026-01-11T19:28:13.0660976Z                              DefaultPaths = @(
2026-01-11T19:28:13.0662147Z                                  "C:\Program Files\LatencyMon\LatencyMon.exe",
2026-01-11T19:28:13.0662360Z                                  "C:\Program Files\LatencyMon\LatMon.exe",
2026-01-11T19:28:13.0663536Z                                  "C:\Program Files (x86)\LatencyMon\LatencyMon.exe",
2026-01-11T19:28:13.0664094Z                                  "C:\Program Files (x86)\LatencyMon\LatMon.exe",
2026-01-11T19:28:13.0665337Z                                  "C:\Program Files\Resplendence\LatencyMon\LatencyMon.exe",
2026-01-11T19:28:13.0665634Z                                  "C:\Program Files\Resplendence\LatencyMon\LatMon.exe",
2026-01-11T19:28:13.0666218Z                                  "C:\Program Files (x86)\Resplendence\LatencyMon\LatencyMon.exe",
2026-01-11T19:28:13.0667320Z                                  "C:\Program Files (x86)\Resplendence\LatencyMon\LatMon.exe"
2026-01-11T19:28:13.0667680Z                              )
2026-01-11T19:28:13.0668689Z                              Configure = @(
2026-01-11T19:28:13.0668920Z                                  "Run for 5 minutes while Superposition is running",
2026-01-11T19:28:13.0670028Z                                  "Record Main + Drivers tab screenshots for evidence"
2026-01-11T19:28:13.0670701Z                              )
2026-01-11T19:28:13.0671585Z                              Launch = $true
2026-01-11T19:28:13.0672440Z                          }
2026-01-11T19:28:13.0672552Z                      )
2026-01-11T19:28:13.0673663Z                      
2026-01-11T19:28:13.0673785Z                      
2026-01-11T19:28:13.0674797Z                      # ----------------------------
2026-01-11T19:28:13.0675782Z                      # Main flow
2026-01-11T19:28:13.0676640Z                      # ----------------------------
2026-01-11T19:28:13.0677428Z                      
2026-01-11T19:28:13.0677750Z                      try {
2026-01-11T19:28:13.0678143Z                          Write-Section "Pre-Checks"
2026-01-11T19:28:13.0678719Z                          Write-Note "Ensure the following for fair results:"
2026-01-11T19:28:13.0680118Z                          Write-Note "- Close browsers, launchers, and overlays (except CapFrameX)."
2026-01-11T19:28:13.0681074Z                          Write-Note "- Keep power plan and NVIDIA Control Panel settings identical before/after."
2026-01-11T19:28:13.0682072Z                          Write-Note "- Reboot before the before and after runs, if possible."
2026-01-11T19:28:13.0683012Z                          Write-Note "- If you double-clicked this script and it closes immediately, run:"
2026-01-11T19:28:13.0684029Z                          Write-Note "  powershell -ExecutionPolicy Bypass -File .\\benchmark-setup.ps1"
2026-01-11T19:28:13.0684751Z                      
2026-01-11T19:28:13.0685485Z                          $installConsent = Confirm-InstallConsent -PackageNames ($packages | ForEach-Object { $_.Name 
2026-01-11T19:28:13.0686324Z                      })
2026-01-11T19:28:13.0686605Z                      
2026-01-11T19:28:13.0686903Z                          if ($installConsent) {
2026-01-11T19:28:13.0687386Z                              if (-not (Install-WingetIfMissing)) {
2026-01-11T19:28:13.0687965Z                                  throw "winget is required to continue."
2026-01-11T19:28:13.0688451Z                              }
2026-01-11T19:28:13.0688759Z                      
2026-01-11T19:28:13.0689409Z                              $script:WingetAvailable = Test-WingetAvailable
2026-01-11T19:28:13.0689978Z                      
2026-01-11T19:28:13.0690344Z                              Write-Section "Install Required Tools"
2026-01-11T19:28:13.0690834Z                              $totalPkgs = $packages.Count
2026-01-11T19:28:13.0691286Z                              $currentPkg = 0
2026-01-11T19:28:13.0691723Z                              foreach ($package in $packages) {
2026-01-11T19:28:13.0692169Z                                  $currentPkg++
2026-01-11T19:28:13.0692718Z                                  $pct = [math]::Round(($currentPkg / $totalPkgs) * 100)
2026-01-11T19:28:13.0693664Z                                  Write-Progress -Activity "Installing Tools" -Status $package.Name -PercentComplete 
2026-01-11T19:28:13.0694554Z                      $pct -CurrentOperation "$currentPkg of $totalPkgs"
2026-01-11T19:28:13.0695227Z                                  Write-Note "$($package.Name): $($package.Purpose)"
2026-01-11T19:28:13.0696198Z                                  $installed = Install-WingetPackage -PackageId $package.Id -PackageName $package.Name
2026-01-11T19:28:13.0697436Z                                  if (-not $installed) {
2026-01-11T19:28:13.0698437Z                                      Write-Warn "$($package.Name) failed to install. The script will continue, but 
2026-01-11T19:28:13.0699198Z                      launching may fail."
2026-01-11T19:28:13.0699583Z                                  }
2026-01-11T19:28:13.0699922Z                              }
2026-01-11T19:28:13.0700426Z                              Write-Progress -Activity "Installing Tools" -Completed
2026-01-11T19:28:13.0700995Z                          } else {
2026-01-11T19:28:13.0701569Z                              # The user did not approve installs. We still try to locate and launch
2026-01-11T19:28:13.0702319Z                              # any tools that are already installed.
2026-01-11T19:28:13.0702929Z                              $script:WingetAvailable = Test-WingetAvailable
2026-01-11T19:28:13.0703533Z                              if (-not $script:WingetAvailable) {
2026-01-11T19:28:13.0704359Z                                  Write-Warn "winget is not available, so install-location lookup via winget is 
2026-01-11T19:28:13.0705123Z                      disabled."
2026-01-11T19:28:13.0705457Z                              }
2026-01-11T19:28:13.0705790Z                          }
2026-01-11T19:28:13.0706086Z                      
2026-01-11T19:28:13.0706427Z                          Write-Section "Locate Executables"
2026-01-11T19:28:13.0706936Z                          foreach ($package in $packages) {
2026-01-11T19:28:13.0707520Z                              $path = Resolve-ExecutablePath -ExeNames $package.ExeNames `
2026-01-11T19:28:13.0708238Z                                  -DefaultCandidates $package.DefaultPaths `
2026-01-11T19:28:13.0708910Z                                  -RegistryNamePattern $package.RegistryPattern `
2026-01-11T19:28:13.0709524Z                                  -PackageId $package.Id
2026-01-11T19:28:13.0709947Z                      
2026-01-11T19:28:13.0710241Z                              if ($path) {
2026-01-11T19:28:13.0710765Z                                  Write-Ok "$($package.Name) executable found at: $path"
2026-01-11T19:28:13.0711366Z                                  $package["Path"] = $path
2026-01-11T19:28:13.0711805Z                              } else {
2026-01-11T19:28:13.0712512Z                                  Write-Warn "Could not locate $($package.Name) executable. Launch will be skipped."
2026-01-11T19:28:13.0713296Z                                  $package["Path"] = $null
2026-01-11T19:28:13.0713725Z                              }
2026-01-11T19:28:13.0714026Z                          }
2026-01-11T19:28:13.0714319Z                      
2026-01-11T19:28:13.0714675Z                          Write-Section "Configuration Checklist"
2026-01-11T19:28:13.0715481Z                          foreach ($package in $packages) {
2026-01-11T19:28:13.0715949Z                              Write-Host ""
2026-01-11T19:28:13.0716693Z                              Write-Host "$($package.Name) configuration:" -ForegroundColor Cyan
2026-01-11T19:28:13.0717796Z                              foreach ($step in $package.Configure) {
2026-01-11T19:28:13.0718390Z                                  Write-Host "  - $step" -ForegroundColor White
2026-01-11T19:28:13.0718901Z                              }
2026-01-11T19:28:13.0719254Z                          }
2026-01-11T19:28:13.0720480Z                      
2026-01-11T19:28:13.0721182Z                          Write-Section "Launch Tools"
2026-01-11T19:28:13.0722293Z                          foreach ($package in $packages) {
2026-01-11T19:28:13.0723007Z                              if (-not $package.Launch) {
2026-01-11T19:28:13.0724257Z                                  continue
2026-01-11T19:28:13.0725149Z                              }
2026-01-11T19:28:13.0725523Z                      
2026-01-11T19:28:13.0726734Z                              if ($package["Path"]) {
2026-01-11T19:28:13.0727270Z                                  Write-Note "Launching $($package.Name)..."
2026-01-11T19:28:13.0727916Z                                  try {
2026-01-11T19:28:13.0728893Z                                      $process = Start-Process -FilePath $package["Path"] -PassThru -ErrorAction Stop
2026-01-11T19:28:13.0729693Z                                      Start-Sleep -Milliseconds 300
2026-01-11T19:28:13.0730198Z                                      if ($process -and -not $process.HasExited) {
2026-01-11T19:28:13.0730888Z                                          Write-Ok "$($package.Name) launched (PID $($process.Id))."
2026-01-11T19:28:13.0731484Z                                      } else {
2026-01-11T19:28:13.0732045Z                                          Write-Warn "$($package.Name) launched but exited immediately. Try starting it 
2026-01-11T19:28:13.0732601Z                      manually:"
2026-01-11T19:28:13.0733010Z                                          Write-Warn "  $($package["Path"])"
2026-01-11T19:28:13.0733494Z                                      }
2026-01-11T19:28:13.0733851Z                                  } catch {
2026-01-11T19:28:13.0734435Z                                      Write-Warn "Failed to launch $($package.Name). Try starting it manually:"
2026-01-11T19:28:13.0735190Z                                      Write-Warn "  $($package["Path"])"
2026-01-11T19:28:13.0735753Z                                      Write-Warn "Error: $($_.Exception.Message)"
2026-01-11T19:28:13.0736164Z                                  }
2026-01-11T19:28:13.0736512Z                              } else {
2026-01-11T19:28:13.0737103Z                                  Write-Warn "Skipping launch for $($package.Name) (path not found)."
2026-01-11T19:28:13.0738048Z                              }
2026-01-11T19:28:13.0738376Z                          }
2026-01-11T19:28:13.0738668Z                      
2026-01-11T19:28:13.0739114Z                          Write-Section "Input Lag Evidence (Free Method)"
2026-01-11T19:28:13.0739895Z                          Write-Note "Use a 240fps phone video to measure click-to-photon latency:"
2026-01-11T19:28:13.0740899Z                          Write-Note "1) Fullscreen a click-response test (any simple local page or app)."
2026-01-11T19:28:13.0741713Z                          Write-Note "2) Record 10 clicks in slow motion."
2026-01-11T19:28:13.0742382Z                          Write-Note "3) Count frames between click and on-screen change."
2026-01-11T19:28:13.0743115Z                          Write-Note "At 240fps, 1 frame = 4.17ms. Average the 10 results."
2026-01-11T19:28:13.0743698Z                      
2026-01-11T19:28:13.0744065Z                          Write-Section "Run Protocol Summary"
2026-01-11T19:28:13.0744897Z                          Write-Note "Warm up once without capturing."
2026-01-11T19:28:13.0745617Z                          Write-Note "Capture 2 valid runs with CapFrameX (press F11 to start/stop)."
2026-01-11T19:28:13.0746156Z                          Write-Note "Apply your app changes."
2026-01-11T19:28:13.0746665Z                          Write-Note "Repeat the warmup + 2 runs."
2026-01-11T19:28:13.0747336Z                          Write-Note "Compare Avg FPS, 1% low, 0.1% low, and frametime graphs."
2026-01-11T19:28:13.0747939Z                      
2026-01-11T19:28:13.0748278Z                          Write-Ok "Benchmark stack is ready."
2026-01-11T19:28:13.0748904Z                          Write-Progress -Activity "Benchmark Setup" -Completed
2026-01-11T19:28:13.0749461Z                      
2026-01-11T19:28:13.0749785Z                          Show-RockTuneFinalChecklist
2026-01-11T19:28:13.0750151Z                      } catch {
2026-01-11T19:28:13.0750466Z                          Write-Fail "Script failed: $($_.Exception.Message)"
2026-01-11T19:28:13.0750854Z                      } finally {
2026-01-11T19:28:13.0751201Z                          if ($script:HadFailures) {
2026-01-11T19:28:13.0751708Z                              Write-Warn "One or more steps failed. Review the messages above."
2026-01-11T19:28:13.0752490Z                          }
2026-01-11T19:28:13.0752827Z                          Wait-ForUserExit
2026-01-11T19:28:13.0753199Z                      }
2026-01-11T19:28:13.0753447Z                      
2026-01-11T19:28:13.0754043Z [32;1mParent             : [0m
2026-01-11T19:28:13.0754329Z 
2026-01-11T19:28:13.0979531Z [32;1mAttributes         : [0m{}
2026-01-11T19:28:13.0980120Z [32;1mUsingStatements    : [0m{}
2026-01-11T19:28:13.0980586Z [32;1mParamBlock         : [0m
2026-01-11T19:28:13.0981024Z [32;1mBeginBlock         : [0m
2026-01-11T19:28:13.0981446Z [32;1mProcessBlock       : [0m
2026-01-11T19:28:13.0991356Z [32;1mEndBlock           : [0m$script:WinBuild = [int](Get-CimInstance Win32_OperatingSystem).BuildNumber
2026-01-11T19:28:13.0992904Z                      $script:IsWin11 = $script:WinBuild -ge 22000
2026-01-11T19:28:13.0993530Z                      $script:IsWin11_24H2 = $script:WinBuild -ge 26100
2026-01-11T19:28:13.0994351Z                      $script:WinVersion = if ($script:IsWin11) { "Windows 11" } else { "Windows 10" }
2026-01-11T19:28:13.0995485Z                      
2026-01-11T19:28:13.0996078Z                      # IDs that only work on Windows 11
2026-01-11T19:28:13.0997925Z                      $script:Win11OnlyIds = @('18', '21', '22')  # Classic menu, End Task, Explorer cleanup
2026-01-11T19:28:13.0999378Z                      $script:Win11_24H2OnlyIds = @('86')  # Native NVMe
2026-01-11T19:28:13.1000141Z                      
2026-01-11T19:28:13.1001652Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.1002486Z                      # PARSE CONFIGURATION
2026-01-11T19:28:13.1003566Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.1004820Z                      # Configuration is passed via $env:RT environment variable as query string format
2026-01-11T19:28:13.1005749Z                      # Example: $env:RT='c=1&g=1&o=1,2,3&s=steam'; irm url | iex
2026-01-11T19:28:13.1006304Z                      
2026-01-11T19:28:13.1006634Z                      $configString = $env:RT
2026-01-11T19:28:13.1007059Z                      if (-not $configString) {
2026-01-11T19:28:13.1007693Z                          Write-Host ""
2026-01-11T19:28:13.1009000Z                          Write-Host "  ERROR: No configuration found." -ForegroundColor Red
2026-01-11T19:28:13.1009835Z                          Write-Host ""
2026-01-11T19:28:13.1010544Z                          Write-Host "  Usage:" -ForegroundColor Yellow
2026-01-11T19:28:13.1011196Z                          Write-Host '  $env:RT="c=1&g=1&o=1,2,3&s=steam"; irm 
2026-01-11T19:28:13.1012282Z                      https://rocktune.pedroferrari.com/run.ps1 | iex' -ForegroundColor Cyan
2026-01-11T19:28:13.1013447Z                          Write-Host ""
2026-01-11T19:28:13.1014702Z                          Write-Host "  Get your one-liner at: https://rocktune.pedroferrari.com" -ForegroundColor Gray
2026-01-11T19:28:13.1015870Z                          Write-Host ""
2026-01-11T19:28:13.1016258Z                          exit 1
2026-01-11T19:28:13.1016586Z                      }
2026-01-11T19:28:13.1016862Z                      
2026-01-11T19:28:13.1017241Z                      # Parse the config string as query parameters
2026-01-11T19:28:13.1018113Z                      try {
2026-01-11T19:28:13.1018717Z                          Add-Type -AssemblyName System.Web
2026-01-11T19:28:13.1019947Z                          $query = [System.Web.HttpUtility]::ParseQueryString($configString)
2026-01-11T19:28:13.1020613Z                      } catch {
2026-01-11T19:28:13.1021217Z                          Write-Host "ERROR: Invalid configuration format." -ForegroundColor Red
2026-01-11T19:28:13.1021897Z                          exit 1
2026-01-11T19:28:13.1022691Z                      }
2026-01-11T19:28:13.1023454Z                      
2026-01-11T19:28:13.1023983Z                      # Extract parameters
2026-01-11T19:28:13.1024609Z                      $cpuId = $query['c']
2026-01-11T19:28:13.1025405Z                      $gpuId = $query['g']
2026-01-11T19:28:13.1025835Z                      $dnsId = $query['d']
2026-01-11T19:28:13.1026468Z                      $peripheralIds = if ($query['p']) { $query['p'] -split ',' } else { @() }
2026-01-11T19:28:13.1027642Z                      $monitorIds = if ($query['m']) { $query['m'] -split ',' } else { @() }
2026-01-11T19:28:13.1028795Z                      $optIds = if ($query['o']) { $query['o'] -split ',' } else { @() }
2026-01-11T19:28:13.1029590Z                      $pkgKeys = if ($query['s']) { $query['s'] -split ',' } else { @() }
2026-01-11T19:28:13.1030182Z                      
2026-01-11T19:28:13.1030773Z                      $validCpuIds = @('1', '2', '3')
2026-01-11T19:28:13.1031645Z                      $validGpuIds = @('1', '2', '3')
2026-01-11T19:28:13.1032498Z                      $validDnsIds = @('1', '2', '3', '4', '5')
2026-01-11T19:28:13.1033143Z                      
2026-01-11T19:28:13.1033895Z                      if ($cpuId -and $cpuId -notin $validCpuIds) {
2026-01-11T19:28:13.1035187Z                          Write-Host "  WARNING: Invalid CPU ID '$cpuId' - defaulting to AMD" -ForegroundColor Yellow
2026-01-11T19:28:13.1036302Z                          $cpuId = '2'
2026-01-11T19:28:13.1036669Z                      }
2026-01-11T19:28:13.1037243Z                      if ($gpuId -and $gpuId -notin $validGpuIds) {
2026-01-11T19:28:13.1038321Z                          Write-Host "  WARNING: Invalid GPU ID '$gpuId' - defaulting to NVIDIA" -ForegroundColor Yellow
2026-01-11T19:28:13.1039509Z                          $gpuId = '1'
2026-01-11T19:28:13.1039867Z                      }
2026-01-11T19:28:13.1040208Z                      if ($dnsId -and $dnsId -notin $validDnsIds) {
2026-01-11T19:28:13.1040940Z                          Write-Host "  WARNING: Invalid DNS ID '$dnsId' - DNS optimization will be skipped" 
2026-01-11T19:28:13.1041605Z                      -ForegroundColor Yellow
2026-01-11T19:28:13.1041956Z                          $dnsId = $null
2026-01-11T19:28:13.1042247Z                      }
2026-01-11T19:28:13.1042499Z                      
2026-01-11T19:28:13.1042844Z                      $optIds = $optIds | Where-Object { $_ -match '^\d+$' }
2026-01-11T19:28:13.1043515Z                      $pkgKeys = $pkgKeys | Where-Object { $_ -match '^[a-zA-Z0-9._-]+$' }
2026-01-11T19:28:13.1044003Z                      
2026-01-11T19:28:13.1044369Z                      # Clear the env var after reading (security)
2026-01-11T19:28:13.1044807Z                      $env:RT = $null
2026-01-11T19:28:13.1045377Z                      
2026-01-11T19:28:13.1046063Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.1047020Z                      # ID MAPPINGS - MUST STAY IN SYNC with web/src/lib/share-registry.ts
2026-01-11T19:28:13.1047946Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.1048448Z                      #
2026-01-11T19:28:13.1048771Z                      # To find next available ID:
2026-01-11T19:28:13.1049219Z                      #   cd web && deno task share:audit
2026-01-11T19:28:13.1049591Z                      #
2026-01-11T19:28:13.1049888Z                      # When adding a new optimization:
2026-01-11T19:28:13.1050404Z                      # 1. Add to share-registry.ts with next sequential ID
2026-01-11T19:28:13.1050962Z                      # 2. Add entry to $OPT_DESCRIPTIONS below
2026-01-11T19:28:13.1051451Z                      # 3. Add entry to $OPT_FUNCTIONS below
2026-01-11T19:28:13.1051911Z                      # 4. Run: cd web && deno task share:audit (verify passes)
2026-01-11T19:28:13.1052359Z                      #
2026-01-11T19:28:13.1052970Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.1053462Z                      
2026-01-11T19:28:13.1053801Z                      $CPU_MAP = @{ '1'='amd_x3d'; '2'='amd'; '3'='intel' }
2026-01-11T19:28:13.1054294Z                      $GPU_MAP = @{ '1'='nvidia'; '2'='amd'; '3'='intel' }
2026-01-11T19:28:13.1054709Z                      $DNS_MAP = @{
2026-01-11T19:28:13.1055439Z                          '1' = @{ name='Cloudflare'; primary='1.1.1.1'; secondary='1.0.0.1' }
2026-01-11T19:28:13.1056134Z                          '2' = @{ name='Google'; primary='8.8.8.8'; secondary='8.8.4.4' }
2026-01-11T19:28:13.1056895Z                          '3' = @{ name='Quad9'; primary='9.9.9.9'; secondary='149.112.112.112' }
2026-01-11T19:28:13.1057640Z                          '4' = @{ name='OpenDNS'; primary='208.67.222.222'; secondary='208.67.220.220' }
2026-01-11T19:28:13.1058472Z                          '5' = @{ name='AdGuard'; primary='94.140.14.14'; secondary='94.140.15.15' }
2026-01-11T19:28:13.1059056Z                      }
2026-01-11T19:28:13.1059324Z                      
2026-01-11T19:28:13.1059905Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.1061108Z                      # PACKAGE MAPPINGS (from catalog.json)
2026-01-11T19:28:13.1061927Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.1062456Z                      
2026-01-11T19:28:13.1062728Z                      $PACKAGE_MAP = @{
2026-01-11T19:28:13.1063396Z                          'steam' = @{ id='Valve.Steam'; name='Steam' }
2026-01-11T19:28:13.1064888Z                          'epic' = @{ id='EpicGames.EpicGamesLauncher'; name='Epic Games' }
2026-01-11T19:28:13.1065532Z                          'gog' = @{ id='GOG.Galaxy'; name='GOG Galaxy' }
2026-01-11T19:28:13.1066818Z                          'battlenet' = @{ id='Blizzard.BattleNet'; name='Battle.net' }
2026-01-11T19:28:13.1067681Z                          'ea' = @{ id='ElectronicArts.EADesktop'; name='EA App' }
2026-01-11T19:28:13.1068577Z                          'ubisoft' = @{ id='Ubisoft.Connect'; name='Ubisoft Connect' }
2026-01-11T19:28:13.1069257Z                          'xbox' = @{ id='Microsoft.GamingApp'; name='Xbox' }
2026-01-11T19:28:13.1069968Z                          'riot' = @{ id='RiotGames.LeagueOfLegends.EUW'; name='Riot Client' }
2026-01-11T19:28:13.1070819Z                          'rockstar' = @{ id='Rockstar.RockstarGamesLauncher'; name='Rockstar' }
2026-01-11T19:28:13.1071977Z                          'itch' = @{ id='itch.itch'; name='itch.io' }
2026-01-11T19:28:13.1072599Z                          'amazon' = @{ id='Amazon.Games'; name='Amazon Games' }
2026-01-11T19:28:13.1073252Z                          'playnite' = @{ id='Playnite.Playnite'; name='Playnite' }
2026-01-11T19:28:13.1074115Z                          'heroic' = @{ id='HeroicGamesLauncher.HeroicGamesLauncher'; name='Heroic' }
2026-01-11T19:28:13.1075180Z                          'discord' = @{ id='Discord.Discord'; name='Discord' }
2026-01-11T19:28:13.1076753Z                          'teamspeak' = @{ id='TeamSpeakSystems.TeamSpeakClient'; name='TeamSpeak' }
2026-01-11T19:28:13.1077828Z                          'guilded' = @{ id='Guilded.Guilded'; name='Guilded' }
2026-01-11T19:28:13.1078635Z                          'parsec' = @{ id='Parsec.Parsec'; name='Parsec' }
2026-01-11T19:28:13.1079449Z                          'moonlight' = @{ id='MoonlightGameStreamingProject.Moonlight'; name='Moonlight' }
2026-01-11T19:28:13.1080284Z                          'obs' = @{ id='OBSProject.OBSStudio'; name='OBS Studio' }
2026-01-11T19:28:13.1080977Z                          'streamlabs' = @{ id='Streamlabs.Streamlabs'; name='Streamlabs' }
2026-01-11T19:28:13.1081650Z                          'twitchstudio' = @{ id='Twitch.TwitchStudio'; name='Twitch Studio' }
2026-01-11T19:28:13.1082369Z                          'voicemeeter' = @{ id='VB-Audio.Voicemeeter.Potato'; name='Voicemeeter' }
2026-01-11T19:28:13.1083061Z                          'nvidiabroadcast' = @{ id='Nvidia.Broadcast'; name='NVIDIA Broadcast' }
2026-01-11T19:28:13.1083807Z                          'medal' = @{ id='Medal.Medal'; name='Medal.tv' }
2026-01-11T19:28:13.1084348Z                          'elgato' = @{ id='Elgato.StreamDeck'; name='Stream Deck' }
2026-01-11T19:28:13.1084937Z                          'prism' = @{ id='PRISMLiveStudio.PRISMLiveStudio'; name='Prism Live' }
2026-01-11T19:28:13.1085689Z                          'sunshine' = @{ id='LizardByte.Sunshine'; name='Sunshine' }
2026-01-11T19:28:13.1086321Z                          'steamlink' = @{ id='Valve.SteamLink'; name='Steam Link' }
2026-01-11T19:28:13.1086944Z                          'hwinfo' = @{ id='REALiX.HWiNFO'; name='HWiNFO' }
2026-01-11T19:28:13.1087661Z                          'afterburner' = @{ id='Guru3D.Afterburner'; name='Afterburner' }
2026-01-11T19:28:13.1088335Z                          'cpuz' = @{ id='CPUID.CPU-Z'; name='CPU-Z' }
2026-01-11T19:28:13.1088908Z                          'gpuz' = @{ id='TechPowerUp.GPU-Z'; name='GPU-Z' }
2026-01-11T19:28:13.1089517Z                          'coretemp' = @{ id='ALCPU.CoreTemp'; name='Core Temp' }
2026-01-11T19:28:13.1090358Z                          'crystaldiskinfo' = @{ id='CrystalDewWorld.CrystalDiskInfo'; name='CrystalDiskInfo' }
2026-01-11T19:28:13.1091783Z                          'crystaldiskmark' = @{ id='CrystalDewWorld.CrystalDiskMark'; name='CrystalDiskMark' }
2026-01-11T19:28:13.1092721Z                          'fpsmonitor' = @{ id='FPSMonitor.FPSMonitor'; name='FPS Monitor' }
2026-01-11T19:28:13.1093919Z                          'openhardwaremonitor' = @{ id='OpenHardwareMonitor.OpenHardwareMonitor'; name='Open Hardware 
2026-01-11T19:28:13.1094904Z                      Monitor' }
2026-01-11T19:28:13.1095919Z                          'nvcleanstall' = @{ id='TechPowerUp.NVCleanstall'; name='NVCleanstall' }
2026-01-11T19:28:13.1097233Z                          'displaydriveruninstaller' = @{ id='Wagnardsoft.DisplayDriverUninstaller'; name='DDU' }
2026-01-11T19:28:13.1098254Z                          'processlasso' = @{ id='BitSum.ProcessLasso'; name='Process Lasso' }
2026-01-11T19:28:13.1098934Z                          'rtss' = @{ id='Guru3D.RTSS'; name='RTSS' }
2026-01-11T19:28:13.1099860Z                          'capframex' = @{ id='CXWorld.CapFrameX'; name='CapFrameX' }
2026-01-11T19:28:13.1100651Z                          'latencymon' = @{ id='Resplendence.LatencyMon'; name='LatencyMon' }
2026-01-11T19:28:13.1101425Z                          'fancontrol' = @{ id='Rem0o.FanControl'; name='FanControl' }
2026-01-11T19:28:13.1102697Z                          'librehardwaremonitor' = @{ id='LibreHardwareMonitor.LibreHardwareMonitor'; name='Libre 
2026-01-11T19:28:13.1103535Z                      Hardware Monitor' }
2026-01-11T19:28:13.1104247Z                          'brave' = @{ id='Brave.Brave'; name='Brave' }
2026-01-11T19:28:13.1104867Z                          'firefox' = @{ id='Mozilla.Firefox'; name='Firefox' }
2026-01-11T19:28:13.1105510Z                          'chrome' = @{ id='Google.Chrome'; name='Chrome' }
2026-01-11T19:28:13.1106110Z                          'edge' = @{ id='Microsoft.Edge'; name='Edge' }
2026-01-11T19:28:13.1106740Z                          'operagx' = @{ id='Opera.OperaGX'; name='Opera GX' }
2026-01-11T19:28:13.1107880Z                          'vivaldi' = @{ id='Vivaldi.Vivaldi'; name='Vivaldi' }
2026-01-11T19:28:13.1108580Z                          'librewolf' = @{ id='LibreWolf.LibreWolf'; name='LibreWolf' }
2026-01-11T19:28:13.1109794Z                          'torbrowser' = @{ id='TorProject.TorBrowser'; name='Tor Browser' }
2026-01-11T19:28:13.1110542Z                          'vlc' = @{ id='VideoLAN.VLC'; name='VLC' }
2026-01-11T19:28:13.1111156Z                          'spotify' = @{ id='Spotify.Spotify'; name='Spotify' }
2026-01-11T19:28:13.1112291Z                          'foobar2000' = @{ id='PeterPawlowski.foobar2000'; name='foobar2000' }
2026-01-11T19:28:13.1113076Z                          'mpchc' = @{ id='clsid2.mpc-hc'; name='MPC-HC' }
2026-01-11T19:28:13.1113655Z                          'plex' = @{ id='Plex.Plex'; name='Plex' }
2026-01-11T19:28:13.1114383Z                          'jellyfin' = @{ id='Jellyfin.JellyfinMediaPlayer'; name='Jellyfin' }
2026-01-11T19:28:13.1115191Z                          'audacity' = @{ id='Audacity.Audacity'; name='Audacity' }
2026-01-11T19:28:13.1116250Z                          'handbrake' = @{ id='HandBrake.HandBrake'; name='HandBrake' }
2026-01-11T19:28:13.1116975Z                          'stremio' = @{ id='Stremio.Stremio'; name='Stremio' }
2026-01-11T19:28:13.1117656Z                          'musicbee' = @{ id='MusicBee.MusicBee'; name='MusicBee' }
2026-01-11T19:28:13.1118257Z                          '7zip' = @{ id='7zip.7zip'; name='7-Zip' }
2026-01-11T19:28:13.1118837Z                          'sharex' = @{ id='ShareX.ShareX'; name='ShareX' }
2026-01-11T19:28:13.1119538Z                          'powertoys' = @{ id='Microsoft.PowerToys'; name='PowerToys' }
2026-01-11T19:28:13.1120343Z                          'everything' = @{ id='voidtools.Everything'; name='Everything' }
2026-01-11T19:28:13.1121194Z                          'qbittorrent' = @{ id='qBittorrent.qBittorrent'; name='qBittorrent' }
2026-01-11T19:28:13.1122020Z                          'bitwarden' = @{ id='Bitwarden.Bitwarden'; name='Bitwarden' }
2026-01-11T19:28:13.1122833Z                          'keepassxc' = @{ id='KeePassXCTeam.KeePassXC'; name='KeePassXC' }
2026-01-11T19:28:13.1123895Z                          'notepadplusplus' = @{ id='Notepad++.Notepad++'; name='Notepad++' }
2026-01-11T19:28:13.1124735Z                          'wiztree' = @{ id='AntibodySoftware.WizTree'; name='WizTree' }
2026-01-11T19:28:13.1125510Z                          'windirstat' = @{ id='WinDirStat.WinDirStat'; name='WinDirStat' }
2026-01-11T19:28:13.1126276Z                          'autohotkey' = @{ id='AutoHotkey.AutoHotkey'; name='AutoHotkey' }
2026-01-11T19:28:13.1126850Z                          'f.lux' = @{ id='flux.flux'; name='f.lux' }
2026-01-11T19:28:13.1127331Z                          'winrar' = @{ id='RARLab.WinRAR'; name='WinRAR' }
2026-01-11T19:28:13.1127926Z                          'peazip' = @{ id='Giorgiotani.Peazip'; name='PeaZip' }
2026-01-11T19:28:13.1128635Z                          'revo' = @{ id='RevoUninstaller.RevoUninstaller'; name='Revo Uninstaller' }
2026-01-11T19:28:13.1129873Z                          'bulk' = @{ id='TGRMNSoftware.BulkRenameUtility'; name='Bulk Rename' }
2026-01-11T19:28:13.1130712Z                          'imageglass' = @{ id='ImageGlass.ImageGlass'; name='ImageGlass' }
2026-01-11T19:28:13.1131791Z                          'flameshot' = @{ id='Flameshot.Flameshot'; name='Flameshot' }
2026-01-11T19:28:13.1132754Z                          'ditto' = @{ id='Ditto.Ditto'; name='Ditto' }
2026-01-11T19:28:13.1134009Z                          'eartrumpet' = @{ id='File-New-Project.EarTrumpet'; name='EarTrumpet' }
2026-01-11T19:28:13.1135452Z                          'bcuninstaller' = @{ id='Klocman.BulkCrapUninstaller'; name='Bulk Crap Uninstaller' }
2026-01-11T19:28:13.1136997Z                          'sysinternals_suite' = @{ id='Microsoft.Sysinternals.Suite'; name='Sysinternals Suite' }
2026-01-11T19:28:13.1137902Z                          'rainmeter' = @{ id='Rainmeter.Rainmeter'; name='Rainmeter' }
2026-01-11T19:28:13.1139962Z                          'lively' = @{ id='rocksdanister.LivelyWallpaper'; name='Lively Wallpaper' }
2026-01-11T19:28:13.1140803Z                          'logitechghub' = @{ id='Logitech.GHUB'; name='Logitech G HUB' }
2026-01-11T19:28:13.1141553Z                          'razersynapse' = @{ id='RazerInc.RazerInstaller'; name='Razer Synapse' }
2026-01-11T19:28:13.1142237Z                          'icue' = @{ id='Corsair.iCUE.5'; name='Corsair iCUE' }
2026-01-11T19:28:13.1142869Z                          'steelseriesgg' = @{ id='SteelSeries.GG'; name='SteelSeries GG' }
2026-01-11T19:28:13.1144447Z                          'armourycrate' = @{ id='ASUS.ArmouryCrate'; name='ASUS Armoury Crate' }
2026-01-11T19:28:13.1145606Z                          'nzxtcam' = @{ id='NZXT.CAM'; name='NZXT CAM' }
2026-01-11T19:28:13.1146956Z                          'signalrgb' = @{ id='WhirlwindFX.SignalRgb'; name='SignalRGB' }
2026-01-11T19:28:13.1148272Z                          'openrgb' = @{ id='OpenRGB.OpenRGB'; name='OpenRGB' }
2026-01-11T19:28:13.1149292Z                          'wooting' = @{ id='Wooting.Wootility'; name='Wootility' }
2026-01-11T19:28:13.1151548Z                          'delldisplaymanager' = @{ id='Dell.DisplayManager'; name='Dell Display Manager' }
2026-01-11T19:28:13.1153137Z                          'lgonscreencontrol' = @{ id='LG.OnScreenControl'; name='LG OnScreen Control' }
2026-01-11T19:28:13.1154806Z                          'hpdisplaycenter' = @{ id='HP.DisplayCenter'; name='HP Display Center' }
2026-01-11T19:28:13.1157064Z                          'vscode' = @{ id='Microsoft.VisualStudioCode'; name='VS Code' }
2026-01-11T19:28:13.1157896Z                          'git' = @{ id='Git.Git'; name='Git' }
2026-01-11T19:28:13.1159583Z                          'python' = @{ id='Python.Python.3.12'; name='Python' }
2026-01-11T19:28:13.1160315Z                          'nodejs' = @{ id='OpenJS.NodeJS.LTS'; name='Node.js' }
2026-01-11T19:28:13.1161564Z                          'wt' = @{ id='Microsoft.WindowsTerminal'; name='Terminal' }
2026-01-11T19:28:13.1162574Z                          'docker' = @{ id='Docker.DockerDesktop'; name='Docker' }
2026-01-11T19:28:13.1163473Z                          'postman' = @{ id='Postman.Postman'; name='Postman' }
2026-01-11T19:28:13.1164226Z                          'github' = @{ id='GitHub.GitHubDesktop'; name='GitHub Desktop' }
2026-01-11T19:28:13.1165024Z                          'sublime' = @{ id='SublimeHQ.SublimeText.4'; name='Sublime Text' }
2026-01-11T19:28:13.1166271Z                          'neovim' = @{ id='Neovim.Neovim'; name='Neovim' }
2026-01-11T19:28:13.1167826Z                          'wsl' = @{ id='Canonical.Ubuntu.2404'; name='Ubuntu (WSL)' }
2026-01-11T19:28:13.1168645Z                          'jetbrains' = @{ id='JetBrains.Toolbox'; name='JetBrains Toolbox' }
2026-01-11T19:28:13.1170336Z                          'powershell' = @{ id='Microsoft.PowerShell'; name='PowerShell' }
2026-01-11T19:28:13.1171944Z                          'gh' = @{ id='GitHub.cli'; name='GitHub CLI' }
2026-01-11T19:28:13.1173657Z                          'vcredist' = @{ id='Microsoft.VCRedist.2015+.x64'; name='VC++ Runtime' }
2026-01-11T19:28:13.1175383Z                          'vcredist_x86' = @{ id='Microsoft.VCRedist.2015+.x86'; name='VC++ Runtime (x86)' }
2026-01-11T19:28:13.1176462Z                          'dotnet' = @{ id='Microsoft.DotNet.DesktopRuntime.8'; name='.NET Runtime' }
2026-01-11T19:28:13.1178441Z                          'dotnet_runtime_8' = @{ id='Microsoft.DotNet.Runtime.8'; name='.NET Runtime 8' }
2026-01-11T19:28:13.1179759Z                          'dotnet_sdk_8' = @{ id='Microsoft.DotNet.SDK.8'; name='.NET SDK 8' }
2026-01-11T19:28:13.1180843Z                          'directx' = @{ id='Microsoft.DirectX'; name='DirectX' }
2026-01-11T19:28:13.1182094Z                          'java' = @{ id='Oracle.JavaRuntimeEnvironment'; name='Java' }
2026-01-11T19:28:13.1183312Z                          'webview2' = @{ id='Microsoft.EdgeWebView2Runtime'; name='WebView2' }
2026-01-11T19:28:13.1184060Z                          '3dmark' = @{ id='Futuremark.3DMark'; name='3DMark' }
2026-01-11T19:28:13.1184699Z                          'cinebench' = @{ id='Maxon.Cinebench'; name='Cinebench' }
2026-01-11T19:28:13.1185451Z                          'geekbench' = @{ id='Geekbench.Geekbench.6'; name='Geekbench' }
2026-01-11T19:28:13.1186164Z                          'furmark' = @{ id='Geeks3D.FurMark'; name='FurMark' }
2026-01-11T19:28:13.1186797Z                          'occt' = @{ id='OCBase.OCCT.Personal'; name='OCCT' }
2026-01-11T19:28:13.1187663Z                          'unigine_heaven' = @{ id='Unigine.HeavenBenchmark'; name='Unigine Heaven' }
2026-01-11T19:28:13.1188626Z                          'unigine_valley' = @{ id='Unigine.ValleyBenchmark'; name='Unigine Valley' }
2026-01-11T19:28:13.1189623Z                          'unigine_superposition' = @{ id='Unigine.SuperpositionBenchmark'; name='Unigine 
2026-01-11T19:28:13.1190329Z                      Superposition' }
2026-01-11T19:28:13.1190678Z                      }
2026-01-11T19:28:13.1190929Z                      
2026-01-11T19:28:13.1191760Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.1192350Z                      # HELPER FUNCTIONS
2026-01-11T19:28:13.1193081Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.1193634Z                      
2026-01-11T19:28:13.1193934Z                      $script:SuccessCount = 0
2026-01-11T19:28:13.1194745Z                      $script:FailCount = 0
2026-01-11T19:28:13.1195147Z                      $script:WarningCount = 0
2026-01-11T19:28:13.1195589Z                      $script:ScanResults = @()
2026-01-11T19:28:13.1195977Z                      
2026-01-11T19:28:13.1196312Z                      function Write-Banner {
2026-01-11T19:28:13.1196700Z                          Write-Host @'
2026-01-11T19:28:13.1197064Z                          ____             __   ______
2026-01-11T19:28:13.1197977Z                         / __ \____  _____/ /__/_  __/_  ______  ___
2026-01-11T19:28:13.1199391Z                        / /_/ / __ \/ ___/ //_/ / / / / / / __ \/ _ \
2026-01-11T19:28:13.1199932Z                       / _, _/ /_/ / /__/ ,<   / / / /_/ / / / /  __/
2026-01-11T19:28:13.1200425Z                      /_/ |_|\____/\___/_/|_| /_/  \__,_/_/ /_/\___/
2026-01-11T19:28:13.1200840Z                      
2026-01-11T19:28:13.1201166Z                              Windows Gaming Loadout Builder
2026-01-11T19:28:13.1201628Z                      '@ -ForegroundColor Magenta
2026-01-11T19:28:13.1202002Z                      }
2026-01-11T19:28:13.1202265Z                      
2026-01-11T19:28:13.1202879Z                      function Write-Step { param([string]$M) Write-Host "`n>> $M" -ForegroundColor Cyan }
2026-01-11T19:28:13.1203940Z                      function Write-OK { param([string]$M) $script:SuccessCount++; Write-Host "  [OK] $M" 
2026-01-11T19:28:13.1204701Z                      -ForegroundColor Green }
2026-01-11T19:28:13.1205157Z                      function Write-Fail { param([string]$M) $script:FailCount++; Write-Host "  [FAIL] $M" 
2026-01-11T19:28:13.1205568Z                      -ForegroundColor Red }
2026-01-11T19:28:13.1205970Z                      function Write-Warn { param([string]$M) $script:WarningCount++; Write-Host "  [!] $M" 
2026-01-11T19:28:13.1206593Z                      -ForegroundColor Yellow }
2026-01-11T19:28:13.1206820Z                      
2026-01-11T19:28:13.1207001Z                      function Set-Reg {
2026-01-11T19:28:13.1207494Z                          param([string]$Path, [string]$Name, $Value, [string]$Type = "DWORD", [switch]$PassThru)
2026-01-11T19:28:13.1208240Z                          $success = $false
2026-01-11T19:28:13.1208622Z                          try {
2026-01-11T19:28:13.1209179Z                              if (-not (Test-Path $Path)) { New-Item -Path $Path -Force | Out-Null }
2026-01-11T19:28:13.1210067Z                              $existing = Get-ItemProperty -Path $Path -Name $Name -EA SilentlyContinue
2026-01-11T19:28:13.1210805Z                              if ($null -eq $existing) {
2026-01-11T19:28:13.1213267Z                                  New-ItemProperty -Path $Path -Name $Name -Value $Value -PropertyType $Type -Force | 
2026-01-11T19:28:13.1214619Z                      Out-Null
2026-01-11T19:28:13.1215020Z                              } else {
2026-01-11T19:28:13.1215995Z                                  Set-ItemProperty -Path $Path -Name $Name -Value $Value -EA Stop
2026-01-11T19:28:13.1216974Z                              }
2026-01-11T19:28:13.1217330Z                              $success = $true
2026-01-11T19:28:13.1217776Z                          } catch { $success = $false }
2026-01-11T19:28:13.1218257Z                          if ($PassThru) { return $success }
2026-01-11T19:28:13.1218698Z                      }
2026-01-11T19:28:13.1218967Z                      
2026-01-11T19:28:13.1219257Z                      function Add-ScanResult {
2026-01-11T19:28:13.1219948Z                          param([string]$Name, [string]$Current, [string]$Target, [string]$Status = "CHANGE")
2026-01-11T19:28:13.1220712Z                          $script:ScanResults += [PSCustomObject]@{
2026-01-11T19:28:13.1221187Z                              Name = $Name
2026-01-11T19:28:13.1221565Z                              Current = $Current
2026-01-11T19:28:13.1221975Z                              Target = $Target
2026-01-11T19:28:13.1222358Z                              Status = $Status
2026-01-11T19:28:13.1222718Z                          }
2026-01-11T19:28:13.1222995Z                      }
2026-01-11T19:28:13.1223229Z                      
2026-01-11T19:28:13.1223550Z                      function Write-ScanResults {
2026-01-11T19:28:13.1224054Z                          if ($script:ScanResults.Count -eq 0) { return }
2026-01-11T19:28:13.1224510Z                      
2026-01-11T19:28:13.1224772Z                          $nameWidth = 36
2026-01-11T19:28:13.1225388Z                          $currentWidth = 14
2026-01-11T19:28:13.1225802Z                          $targetWidth = 18
2026-01-11T19:28:13.1226160Z                      
2026-01-11T19:28:13.1226421Z                          Write-Host ""
2026-01-11T19:28:13.1240399Z                          Write-Host "  ‚ïî$('‚ïê' * $nameWidth)‚ï§$('‚ïê' * $currentWidth)‚ï§$('‚ïê' * $targetWidth)‚ïó" 
2026-01-11T19:28:13.1241406Z                      -ForegroundColor White
2026-01-11T19:28:13.1243411Z                          Write-Host "  ‚ïë Setting$(' ' * ($nameWidth - 9))‚îÇ Current$(' ' * ($currentWidth - 9))‚îÇ 
2026-01-11T19:28:13.1245887Z                      Target$(' ' * ($targetWidth - 8))‚ïë" -ForegroundColor White
2026-01-11T19:28:13.1247491Z                          Write-Host "  ‚ï†$('‚ïê' * $nameWidth)‚ï™$('‚ïê' * $currentWidth)‚ï™$('‚ïê' * $targetWidth)‚ï£" 
2026-01-11T19:28:13.1248660Z                      -ForegroundColor White
2026-01-11T19:28:13.1249066Z                      
2026-01-11T19:28:13.1249442Z                          foreach ($result in $script:ScanResults) {
2026-01-11T19:28:13.1249916Z                              $name = $result.Name
2026-01-11T19:28:13.1251050Z                              if ($name.Length -gt ($nameWidth - 2)) { $name = $name.Substring(0, $nameWidth - 5) + 
2026-01-11T19:28:13.1251970Z                      "..." }
2026-01-11T19:28:13.1252395Z                              $name = " " + $name.PadRight($nameWidth - 2)
2026-01-11T19:28:13.1252849Z                      
2026-01-11T19:28:13.1253439Z                              $current = $result.Current
2026-01-11T19:28:13.1254299Z                              if ($current.Length -gt ($currentWidth - 2)) { $current = $current.Substring(0, 
2026-01-11T19:28:13.1255265Z                      $currentWidth - 5) + "..." }
2026-01-11T19:28:13.1255781Z                              $current = " " + $current.PadRight($currentWidth - 2)
2026-01-11T19:28:13.1256296Z                      
2026-01-11T19:28:13.1256595Z                              $target = $result.Target
2026-01-11T19:28:13.1257322Z                              if ($target.Length -gt ($targetWidth - 2)) { $target = $target.Substring(0, $targetWidth 
2026-01-11T19:28:13.1258027Z                      - 5) + "..." }
2026-01-11T19:28:13.1258641Z                              $target = " " + $target.PadRight($targetWidth - 2)
2026-01-11T19:28:13.1259346Z                      
2026-01-11T19:28:13.1271902Z                              $color = switch ($result.Status) {
2026-01-11T19:28:13.1272433Z                                  "OK"      { "Green" }
2026-01-11T19:28:13.1273069Z                                  "CHANGE"  { "Yellow" }
2026-01-11T19:28:13.1273963Z                                  "INFO"    { "Cyan" }
2026-01-11T19:28:13.1275095Z                                  "PENDING" { "Gray" }
2026-01-11T19:28:13.1275990Z                                  default   { "White" }
2026-01-11T19:28:13.1276794Z                              }
2026-01-11T19:28:13.1277113Z                      
2026-01-11T19:28:13.1278309Z                              Write-Host "  ‚ïë" -NoNewline -ForegroundColor White
2026-01-11T19:28:13.1279587Z                              Write-Host $name -NoNewline -ForegroundColor $color
2026-01-11T19:28:13.1281021Z                              Write-Host "‚îÇ" -NoNewline -ForegroundColor White
2026-01-11T19:28:13.1282135Z                              Write-Host $current -NoNewline -ForegroundColor $color
2026-01-11T19:28:13.1283765Z                              Write-Host "‚îÇ" -NoNewline -ForegroundColor White
2026-01-11T19:28:13.1285007Z                              Write-Host $target -NoNewline -ForegroundColor $color
2026-01-11T19:28:13.1286347Z                              Write-Host "‚ïë" -ForegroundColor White
2026-01-11T19:28:13.1287024Z                          }
2026-01-11T19:28:13.1287541Z                      
2026-01-11T19:28:13.1289150Z                          Write-Host "  ‚ïö$('‚ïê' * $nameWidth)‚ïß$('‚ïê' * $currentWidth)‚ïß$('‚ïê' * $targetWidth)‚ïù" 
2026-01-11T19:28:13.1290890Z                      -ForegroundColor White
2026-01-11T19:28:13.1291563Z                          Write-Host ""
2026-01-11T19:28:13.1292625Z                      
2026-01-11T19:28:13.1293462Z                          $changeCount = ($script:ScanResults | Where-Object { $_.Status -eq "CHANGE" }).Count
2026-01-11T19:28:13.1295325Z                          $okCount = ($script:ScanResults | Where-Object { $_.Status -eq "OK" }).Count
2026-01-11T19:28:13.1298437Z                          Write-Host "  Summary: $changeCount changes needed, $okCount already configured" 
2026-01-11T19:28:13.1300650Z                      -ForegroundColor Gray
2026-01-11T19:28:13.1301067Z                          Write-Host ""
2026-01-11T19:28:13.1302002Z                      }
2026-01-11T19:28:13.1302276Z                      
2026-01-11T19:28:13.1303601Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.1304872Z                      # OPTIMIZATION DESCRIPTIONS (for interactive mode)
2026-01-11T19:28:13.1306354Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.1307466Z                      
2026-01-11T19:28:13.1310584Z                      $OPT_DESCRIPTIONS = @{
2026-01-11T19:28:13.1311190Z                          # SAFE tier (1-45)
2026-01-11T19:28:13.1312465Z                          '1'  = @{ name='Page File'; tier='SAFE'; desc='Set fixed page file size based on RAM (4GB for 
2026-01-11T19:28:13.1314559Z                      32GB+, 8GB for 16GB)' }
2026-01-11T19:28:13.1315697Z                          '2'  = @{ name='Fast Startup'; tier='SAFE'; desc='Disable Fast Boot for cleaner shutdowns and 
2026-01-11T19:28:13.1317184Z                      driver resets' }
2026-01-11T19:28:13.1318091Z                          '3'  = @{ name='Timer Resolution'; tier='SAFE'; desc='Manual step: Requires timer-tool.ps1 
2026-01-11T19:28:13.1319796Z                      before gaming' }
2026-01-11T19:28:13.1320867Z                          '4'  = @{ name='Power Plan'; tier='SAFE'; desc='Enable High Performance power plan' }
2026-01-11T19:28:13.1322433Z                          '5'  = @{ name='USB Power'; tier='SAFE'; desc='Disable USB selective suspend (prevents device 
2026-01-11T19:28:13.1323974Z                      disconnects)' }
2026-01-11T19:28:13.1325311Z                          '6'  = @{ name='PCIe Power'; tier='SAFE'; desc='Disable PCIe power saving for GPU stability' }
2026-01-11T19:28:13.1327127Z                          '7'  = @{ name='DNS Provider'; tier='SAFE'; desc='Set DNS servers to selected provider' }
2026-01-11T19:28:13.1328970Z                          '8'  = @{ name='Nagle Algorithm'; tier='SAFE'; desc='Disable Nagle buffering for lower 
2026-01-11T19:28:13.1329853Z                      network latency' }
2026-01-11T19:28:13.1330702Z                          '9'  = @{ name='Audio Ducking'; tier='SAFE'; desc='Disable audio volume reduction during 
2026-01-11T19:28:13.1331087Z                      calls' }
2026-01-11T19:28:13.1331477Z                          '10' = @{ name='Game DVR'; tier='SAFE'; desc='Disable background game recording' }
2026-01-11T19:28:13.1332028Z                          '11' = @{ name='Background Apps'; tier='SAFE'; desc='Disable background app activity' }
2026-01-11T19:28:13.1333643Z                          '12' = @{ name='Edge Debloat'; tier='SAFE'; desc='Disable Edge shopping assistant and 
2026-01-11T19:28:13.1333767Z                      widgets' }
2026-01-11T19:28:13.1334073Z                          '13' = @{ name='Copilot'; tier='SAFE'; desc='Disable Windows Copilot' }
2026-01-11T19:28:13.1334489Z                          '14' = @{ name='Explorer Speed'; tier='SAFE'; desc='Optimize folder type detection for faster 
2026-01-11T19:28:13.1334600Z                      browsing' }
2026-01-11T19:28:13.1335074Z                          '15' = @{ name='Temp Purge'; tier='SAFE'; desc='Clear temporary folders' }
2026-01-11T19:28:13.1335641Z                          '16' = @{ name='Razer Block'; tier='SAFE'; desc='Stop and disable Razer background services' }
2026-01-11T19:28:13.1336034Z                          '17' = @{ name='Restore Point'; tier='SAFE'; desc='Create system restore point before 
2026-01-11T19:28:13.1336549Z                      changes' }
2026-01-11T19:28:13.1337061Z                          '18' = @{ name='Classic Menu'; tier='SAFE'; desc='Enable Windows 10 style context menu' }
2026-01-11T19:28:13.1337677Z                          '19' = @{ name='Storage Sense'; tier='SAFE'; desc='Disable automatic storage cleanup' }
2026-01-11T19:28:13.1338673Z                          '20' = @{ name='Visual Effects'; tier='SAFE'; desc='Set visual effects to performance mode' }
2026-01-11T19:28:13.1339043Z                          '21' = @{ name='End Task'; tier='SAFE'; desc='Enable End Task option in taskbar' }
2026-01-11T19:28:13.1339659Z                          '22' = @{ name='Explorer Cleanup'; tier='SAFE'; desc='Remove OneDrive and Gallery from 
2026-01-11T19:28:13.1339794Z                      Explorer' }
2026-01-11T19:28:13.1340772Z                          '23' = @{ name='Notifications'; tier='SAFE'; desc='Disable notification center and toasts' }
2026-01-11T19:28:13.1341369Z                          '24' = @{ name='PS7 Telemetry'; tier='SAFE'; desc='Disable PowerShell 7 telemetry' }
2026-01-11T19:28:13.1342412Z                          '25' = @{ name='Multiplane Overlay'; tier='SAFE'; desc='Disable DWM overlay for cleaner 
2026-01-11T19:28:13.1342919Z                      fullscreen' }
2026-01-11T19:28:13.1343755Z                          '26' = @{ name='Mouse Acceleration'; tier='SAFE'; desc='Disable mouse acceleration for raw 
2026-01-11T19:28:13.1343872Z                      input' }
2026-01-11T19:28:13.1344586Z                          '27' = @{ name='USB Suspend'; tier='SAFE'; desc='Disable USB selective suspend' }
2026-01-11T19:28:13.1345228Z                          '28' = @{ name='Keyboard Response'; tier='SAFE'; desc='Minimize keyboard delay and maximize 
2026-01-11T19:28:13.1345555Z                      repeat rate' }
2026-01-11T19:28:13.1346219Z                          '29' = @{ name='Game Mode'; tier='SAFE'; desc='Enable Windows Game Mode' }
2026-01-11T19:28:13.1346857Z                          '30' = @{ name='Min Processor'; tier='SAFE'; desc='Set minimum processor state to 5% (better 
2026-01-11T19:28:13.1347184Z                      thermals)' }
2026-01-11T19:28:13.1348253Z                          '31' = @{ name='Hibernation'; tier='SAFE'; desc='Disable hibernation (saves disk space)' }
2026-01-11T19:28:13.1349076Z                          '32' = @{ name='RSS'; tier='SAFE'; desc='Enable Receive Side Scaling for network' }
2026-01-11T19:28:13.1350419Z                          '33' = @{ name='Adapter Power'; tier='SAFE'; desc='Disable network adapter power saving' }
2026-01-11T19:28:13.1351163Z                          '34' = @{ name='Delivery Opt'; tier='SAFE'; desc='Disable P2P update delivery' }
2026-01-11T19:28:13.1353997Z                          '35' = @{ name='Error Reporting'; tier='SAFE'; desc='Disable Windows Error Reporting' }
2026-01-11T19:28:13.1355175Z                          '36' = @{ name='WiFi Sense'; tier='SAFE'; desc='Disable WiFi Sense auto-connect' }
2026-01-11T19:28:13.1355646Z                          '37' = @{ name='Spotlight'; tier='SAFE'; desc='Disable Windows Spotlight on lock screen' }
2026-01-11T19:28:13.1356474Z                          '38' = @{ name='Feedback'; tier='SAFE'; desc='Disable Windows feedback prompts' }
2026-01-11T19:28:13.1357142Z                          '39' = @{ name='Clipboard Sync'; tier='SAFE'; desc='Disable cloud clipboard sync' }
2026-01-11T19:28:13.1357793Z                          '40' = @{ name='Accessibility'; tier='SAFE'; desc='Disable Sticky Keys and other shortcuts' }
2026-01-11T19:28:13.1358403Z                          '41' = @{ name='Audio Comm'; tier='SAFE'; desc='Disable volume ducking during communications' 
2026-01-11T19:28:13.1359231Z                      }
2026-01-11T19:28:13.1359602Z                          '42' = @{ name='System Sounds'; tier='SAFE'; desc='Mute Windows system sounds' }
2026-01-11T19:28:13.1360251Z                          '43' = @{ name='Input Buffer'; tier='SAFE'; desc='Increase input buffer for high poll rate 
2026-01-11T19:28:13.1360551Z                      devices' }
2026-01-11T19:28:13.1361636Z                          '44' = @{ name='Filesystem'; tier='SAFE'; desc='Optimize NTFS settings (disable last access, 
2026-01-11T19:28:13.1361795Z                      8.3 names)' }
2026-01-11T19:28:13.1362639Z                          '45' = @{ name='DWM Perf'; tier='SAFE'; desc='Optimize Desktop Window Manager settings' }
2026-01-11T19:28:13.1362754Z                      
2026-01-11T19:28:13.1362896Z                          # CAUTION tier (50-72)
2026-01-11T19:28:13.1363543Z                          '50' = @{ name='MSI Mode'; tier='CAUTION'; desc='Enable Message Signaled Interrupts for GPU 
2026-01-11T19:28:13.1363675Z                      (lower DPC latency)' }
2026-01-11T19:28:13.1364680Z                          '51' = @{ name='HPET'; tier='CAUTION'; desc='Disable High Precision Event Timer (test 
2026-01-11T19:28:13.1365080Z                      before/after)' }
2026-01-11T19:28:13.1365514Z                          '52' = @{ name='Game Bar Overlay'; tier='CAUTION'; desc='Disable Game Bar overlays (keep core 
2026-01-11T19:28:13.1365922Z                      enabled)' }
2026-01-11T19:28:13.1366781Z                          '53' = @{ name='HAGS'; tier='CAUTION'; desc='Enable Hardware Accelerated GPU Scheduling' }
2026-01-11T19:28:13.1367397Z                          '54' = @{ name='FSO'; tier='CAUTION'; desc='Disable fullscreen optimizations globally' }
2026-01-11T19:28:13.1368231Z                          '55' = @{ name='Ultimate Perf'; tier='CAUTION'; desc='Enable Ultimate Performance power plan' 
2026-01-11T19:28:13.1368339Z                      }
2026-01-11T19:28:13.1369165Z                          '56' = @{ name='Services Trim'; tier='CAUTION'; desc='Set unnecessary services to manual 
2026-01-11T19:28:13.1369491Z                      startup' }
2026-01-11T19:28:13.1369887Z                          '57' = @{ name='Disk Cleanup'; tier='CAUTION'; desc='Run Windows disk cleanup utility' }
2026-01-11T19:28:13.1370633Z                          '58' = @{ name='WPBT'; tier='CAUTION'; desc='Disable WPBT (blocks OEM pre-installed 
2026-01-11T19:28:13.1370954Z                      software)' }
2026-01-11T19:28:13.1371397Z                          '59' = @{ name='QoS Gaming'; tier='CAUTION'; desc='Remove bandwidth reservations for gaming' }
2026-01-11T19:28:13.1372033Z                          '60' = @{ name='Network Throttle'; tier='CAUTION'; desc='Disable network throttling during 
2026-01-11T19:28:13.1372186Z                      multimedia' }
2026-01-11T19:28:13.1373021Z                          '61' = @{ name='GPU Affinity'; tier='CAUTION'; desc='Set GPU interrupt affinity to CPU 0' }
2026-01-11T19:28:13.1374320Z                          '62' = @{ name='Mitigations'; tier='CAUTION'; desc='Disable kernel shadow stacks (reduces 
2026-01-11T19:28:13.1374660Z                      security)' }
2026-01-11T19:28:13.1375310Z                          '63' = @{ name='MMCSS'; tier='CAUTION'; desc='Configure multimedia class scheduler for games' 
2026-01-11T19:28:13.1375420Z                      }
2026-01-11T19:28:13.1376002Z                          '64' = @{ name='Scheduler'; tier='CAUTION'; desc='Optimize thread scheduler for 
2026-01-11T19:28:13.1376127Z                      responsiveness' }
2026-01-11T19:28:13.1376812Z                          '65' = @{ name='Core Parking'; tier='CAUTION'; desc='Disable CPU core parking' }
2026-01-11T19:28:13.1377639Z                          '66' = @{ name='Timer Registry'; tier='CAUTION'; desc='Enable global timer resolution 
2026-01-11T19:28:13.1377757Z                      requests' }
2026-01-11T19:28:13.1378435Z                          '67' = @{ name='RSC'; tier='CAUTION'; desc='Disable Receive Segment Coalescing' }
2026-01-11T19:28:13.1378803Z                          '68' = @{ name='SysMain'; tier='CAUTION'; desc='Disable SysMain/Superfetch service' }
2026-01-11T19:28:13.1379456Z                          '69' = @{ name='Search'; tier='CAUTION'; desc='Set Windows Search to manual (stops indexing)' 
2026-01-11T19:28:13.1379550Z                      }
2026-01-11T19:28:13.1379957Z                          '70' = @{ name='Memory Gaming'; tier='CAUTION'; desc='Keep kernel in RAM (disable paging 
2026-01-11T19:28:13.1380060Z                      executive)' }
2026-01-11T19:28:13.1380424Z                          '71' = @{ name='Power Throttle'; tier='CAUTION'; desc='Disable CPU power throttling' }
2026-01-11T19:28:13.1380788Z                          '72' = @{ name='Priority Boost'; tier='CAUTION'; desc='Disable priority boost (consistent 
2026-01-11T19:28:13.1380894Z                      scheduling)' }
2026-01-11T19:28:13.1381795Z                      
2026-01-11T19:28:13.1381966Z                          # RISKY tier (80-89)
2026-01-11T19:28:13.1382357Z                          '80' = @{ name='Privacy T1'; tier='RISKY'; desc='Disable advertising ID and tailored 
2026-01-11T19:28:13.1382476Z                      experiences' }
2026-01-11T19:28:13.1382851Z                          '81' = @{ name='Privacy T2'; tier='RISKY'; desc='Minimize diagnostic telemetry' }
2026-01-11T19:28:13.1383298Z                          '82' = @{ name='Privacy T3'; tier='RISKY'; desc='Disable Xbox services (breaks Game Pass!)' }
2026-01-11T19:28:13.1383716Z                          '83' = @{ name='Bloatware'; tier='RISKY'; desc='Remove pre-installed bloatware apps' }
2026-01-11T19:28:13.1384055Z                          '84' = @{ name='IPv4 Prefer'; tier='RISKY'; desc='Prefer IPv4 over IPv6' }
2026-01-11T19:28:13.1384371Z                          '85' = @{ name='Teredo'; tier='RISKY'; desc='Disable Teredo tunneling' }
2026-01-11T19:28:13.1385142Z                          '86' = @{ name='Native NVMe'; tier='RISKY'; desc='Enable native NVMe stack (Win11 24H2+)' }
2026-01-11T19:28:13.1385602Z                          '87' = @{ name='SMT'; tier='RISKY'; desc='Disable SMT/Hyperthreading (physical cores only)' }
2026-01-11T19:28:13.1386028Z                          '88' = @{ name='Audio Exclusive'; tier='RISKY'; desc='Configure audio for exclusive mode 
2026-01-11T19:28:13.1386143Z                      apps' }
2026-01-11T19:28:13.1386572Z                          '89' = @{ name='TCP Optimizer'; tier='RISKY'; desc='Apply TCP optimizations for gaming' }
2026-01-11T19:28:13.1386671Z                      
2026-01-11T19:28:13.1386816Z                          # FR33THY Phase (104+)
2026-01-11T19:28:13.1387273Z                          '104' = @{ name='Background Polling'; tier='SAFE'; desc='Unlock full mouse polling rate in 
2026-01-11T19:28:13.1387401Z                      background windows' }
2026-01-11T19:28:13.1388036Z                          '105' = @{ name='AMD ULPS'; tier='CAUTION'; desc='Disable AMD Ultra Low Power State (prevents 
2026-01-11T19:28:13.1388185Z                      downclock stutters)' }
2026-01-11T19:28:13.1388604Z                          '106' = @{ name='NVIDIA P0 State'; tier='RISKY'; desc='Force GPU to max clocks (increases 
2026-01-11T19:28:13.1388740Z                      heat/power!)' }
2026-01-11T19:28:13.1389172Z                          '107' = @{ name='Network Binding Strip'; tier='RISKY'; desc='Remove IPv6/sharing bindings 
2026-01-11T19:28:13.1389323Z                      (breaks file sharing!)' }
2026-01-11T19:28:13.1389413Z                      }
2026-01-11T19:28:13.1389503Z                      
2026-01-11T19:28:13.1390110Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.1390380Z                      # OPTIMIZATION FUNCTIONS (by ID from share-registry.ts)
2026-01-11T19:28:13.1390689Z                      # NOTE: LUDICROUS tier IDs (100-103) are intentionally NOT included
2026-01-11T19:28:13.1396232Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.1396487Z                      
2026-01-11T19:28:13.1397210Z                      $OPT_FUNCTIONS = @{
2026-01-11T19:28:13.1398734Z                          # SAFE tier (1-45)
2026-01-11T19:28:13.1398879Z                          '1' = { # pagefile
2026-01-11T19:28:13.1399376Z                              $ram = [math]::Round((Get-CimInstance Win32_PhysicalMemory | Measure-Object Capacity 
2026-01-11T19:28:13.1399495Z                      -Sum).Sum/1GB)
2026-01-11T19:28:13.1399627Z                              if ($ram -ge 16) {
2026-01-11T19:28:13.1399828Z                                  $size = if ($ram -ge 32) { 4096 } else { 8192 }
2026-01-11T19:28:13.1400121Z                                  $cs = Get-WmiObject Win32_ComputerSystem -EnableAllPrivileges
2026-01-11T19:28:13.1400420Z                                  $cs.AutomaticManagedPagefile = $false; $cs.Put() | Out-Null
2026-01-11T19:28:13.1400783Z                                  $pf = Get-WmiObject -Query "Select * From Win32_PageFileSetting Where 
2026-01-11T19:28:13.1400978Z                      Name='C:\\pagefile.sys'" -EA SilentlyContinue
2026-01-11T19:28:13.1401165Z                                  if ($pf) {
2026-01-11T19:28:13.1402374Z                                      $pf.InitialSize = $size; $pf.MaximumSize = $size; $pf.Put() | Out-Null
2026-01-11T19:28:13.1403379Z                                      Write-OK "Page file set to ${size}MB fixed"
2026-01-11T19:28:13.1404826Z                                  } else { Write-Warn "Page file setting not found" }
2026-01-11T19:28:13.1405145Z                              }
2026-01-11T19:28:13.1405489Z                          }
2026-01-11T19:28:13.1405619Z                          '2' = { # fastboot
2026-01-11T19:28:13.1406004Z                              if (Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Power" 
2026-01-11T19:28:13.1406644Z                      "HiberbootEnabled" 0 -PassThru) { Write-OK "Fast startup disabled" }
2026-01-11T19:28:13.1406765Z                          }
2026-01-11T19:28:13.1406879Z                          '3' = { # timer
2026-01-11T19:28:13.1407209Z                              Write-Host ""
2026-01-11T19:28:13.1407972Z                              Write-Host "  [!] MANUAL STEP: Timer Resolution" -ForegroundColor Yellow
2026-01-11T19:28:13.1409044Z                              Write-Host "      Download and run timer-tool.ps1 before gaming" -ForegroundColor Yellow
2026-01-11T19:28:13.1409711Z                              Write-Host "      https://github.com/thepedroferrari/rocktune" -ForegroundColor Cyan
2026-01-11T19:28:13.1410318Z                              Write-Host ""
2026-01-11T19:28:13.1410430Z                          }
2026-01-11T19:28:13.1410569Z                          '4' = { # power_plan
2026-01-11T19:28:13.1411537Z                              powercfg /setactive 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c 2>&1 | Out-Null
2026-01-11T19:28:13.1411982Z                              if ($LASTEXITCODE -eq 0) { Write-OK "High Performance power plan enabled" } else { 
2026-01-11T19:28:13.1412229Z                      Write-Warn "High Performance plan not available" }
2026-01-11T19:28:13.1412329Z                          }
2026-01-11T19:28:13.1412459Z                          '5' = { # usb_power
2026-01-11T19:28:13.1412918Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Services\USB\DisableSelectiveSuspend" 
2026-01-11T19:28:13.1413074Z                      "DisableSelectiveSuspend" 1
2026-01-11T19:28:13.1413523Z                              Write-OK "USB selective suspend disabled"
2026-01-11T19:28:13.1413628Z                          }
2026-01-11T19:28:13.1413753Z                          '6' = { # pcie_power
2026-01-11T19:28:13.1414044Z                              powercfg /setacvalueindex scheme_current sub_pciexpress 
2026-01-11T19:28:13.1414328Z                      ee12f906-d166-476a-8f3a-af931b6e9d31 0 2>&1 | Out-Null
2026-01-11T19:28:13.1414935Z                              if ($LASTEXITCODE -eq 0) {
2026-01-11T19:28:13.1415325Z                                  powercfg /setactive scheme_current 2>&1 | Out-Null
2026-01-11T19:28:13.1416016Z                                  Write-OK "PCIe power saving disabled"
2026-01-11T19:28:13.1416464Z                              } else { Write-Warn "PCIe power setting not supported" }
2026-01-11T19:28:13.1416572Z                          }
2026-01-11T19:28:13.1416753Z                          '7' = { # dns - handled separately with dnsId
2026-01-11T19:28:13.1417467Z                              # This is a placeholder - actual DNS setting is done in main logic
2026-01-11T19:28:13.1417782Z                          }
2026-01-11T19:28:13.1417893Z                          '8' = { # nagle
2026-01-11T19:28:13.1418447Z                              $adapters = Get-NetAdapter | Where-Object {$_.Status -eq "Up"}
2026-01-11T19:28:13.1419008Z                              foreach ($adapter in $adapters) {
2026-01-11T19:28:13.1419121Z                                  $path = 
2026-01-11T19:28:13.1420220Z                      "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces\$($adapter.InterfaceGuid)"
2026-01-11T19:28:13.1420622Z                                  Set-Reg $path "TcpAckFrequency" 1
2026-01-11T19:28:13.1420973Z                                  Set-Reg $path "TCPNoDelay" 1
2026-01-11T19:28:13.1421087Z                              }
2026-01-11T19:28:13.1421258Z                              Write-OK "Nagle algorithm disabled"
2026-01-11T19:28:13.1421351Z                          }
2026-01-11T19:28:13.1421499Z                          '9' = { # audio_enhancements
2026-01-11T19:28:13.1422488Z                              Set-Reg "HKCU:\Software\Microsoft\Multimedia\Audio" "UserDuckingPreference" 3
2026-01-11T19:28:13.1422668Z                              Write-OK "Audio ducking disabled"
2026-01-11T19:28:13.1422772Z                          }
2026-01-11T19:28:13.1423110Z                          '10' = { # gamedvr
2026-01-11T19:28:13.1423743Z                              Set-Reg "HKCU:\System\GameConfigStore" "GameDVR_Enabled" 0
2026-01-11T19:28:13.1424519Z                              Set-Reg "HKLM:\SOFTWARE\Policies\Microsoft\Windows\GameDVR" "AllowGameDVR" 0
2026-01-11T19:28:13.1424689Z                              Write-OK "Game DVR disabled"
2026-01-11T19:28:13.1424782Z                          }
2026-01-11T19:28:13.1424918Z                          '11' = { # background_apps
2026-01-11T19:28:13.1426103Z                              Set-Reg "HKCU:\Software\Microsoft\Windows\CurrentVersion\BackgroundAccessApplications" 
2026-01-11T19:28:13.1426407Z                      "GlobalUserDisabled" 1
2026-01-11T19:28:13.1426607Z                              Write-OK "Background apps disabled"
2026-01-11T19:28:13.1426696Z                          }
2026-01-11T19:28:13.1427618Z                          '12' = { # edge_debloat
2026-01-11T19:28:13.1428448Z                              Set-Reg "HKLM:\SOFTWARE\Policies\Microsoft\Edge" "HideFirstRunExperience" 1
2026-01-11T19:28:13.1429278Z                              Set-Reg "HKLM:\SOFTWARE\Policies\Microsoft\Edge" "EdgeShoppingAssistantEnabled" 0
2026-01-11T19:28:13.1430147Z                              Set-Reg "HKLM:\SOFTWARE\Policies\Microsoft\Edge" "WebWidgetAllowed" 0
2026-01-11T19:28:13.1430677Z                              Write-OK "Edge debloated"
2026-01-11T19:28:13.1430801Z                          }
2026-01-11T19:28:13.1430928Z                          '13' = { # copilot_disable
2026-01-11T19:28:13.1431673Z                              Set-Reg "HKCU:\Software\Policies\Microsoft\Windows\WindowsCopilot" 
2026-01-11T19:28:13.1431862Z                      "TurnOffWindowsCopilot" 1
2026-01-11T19:28:13.1432020Z                              Write-OK "Copilot disabled"
2026-01-11T19:28:13.1432340Z                          }
2026-01-11T19:28:13.1432678Z                          '14' = { # explorer_speed
2026-01-11T19:28:13.1432914Z                              Set-Reg "HKCU:\Software\Classes\Local 
2026-01-11T19:28:13.1433973Z                      Settings\Software\Microsoft\Windows\Shell\Bags\AllFolders\Shell" "FolderType" "NotSpecified" 
2026-01-11T19:28:13.1434589Z                      "String"
2026-01-11T19:28:13.1434937Z                              Write-OK "Explorer speed optimized"
2026-01-11T19:28:13.1435223Z                          }
2026-01-11T19:28:13.1435369Z                          '15' = { # temp_purge
2026-01-11T19:28:13.1435540Z                              $itemsRemoved = 0
2026-01-11T19:28:13.1436343Z                              if ($env:TEMP -and (Test-Path $env:TEMP)) {
2026-01-11T19:28:13.1437386Z                                  $tempPath = [System.IO.Path]::GetFullPath($env:TEMP)
2026-01-11T19:28:13.1438269Z                                  if ($tempPath -like "*\Temp*" -or $tempPath -like "*\tmp*") {
2026-01-11T19:28:13.1439239Z                                      Get-ChildItem $tempPath -Force -EA SilentlyContinue | ForEach-Object {
2026-01-11T19:28:13.1440422Z                                          try { Remove-Item $_.FullName -Recurse -Force -EA Stop; $itemsRemoved++ } 
2026-01-11T19:28:13.1440566Z                      catch {}
2026-01-11T19:28:13.1441196Z                                      }
2026-01-11T19:28:13.1441823Z                                  }
2026-01-11T19:28:13.1442849Z                              }
2026-01-11T19:28:13.1443725Z                              $winTemp = Join-Path $env:WINDIR "Temp"
2026-01-11T19:28:13.1444646Z                              if (Test-Path $winTemp) {
2026-01-11T19:28:13.1445755Z                                  Get-ChildItem $winTemp -Force -EA SilentlyContinue | ForEach-Object {
2026-01-11T19:28:13.1447708Z                                      try { Remove-Item $_.FullName -Recurse -Force -EA Stop; $itemsRemoved++ } catch {}
2026-01-11T19:28:13.1448212Z                                  }
2026-01-11T19:28:13.1448328Z                              }
2026-01-11T19:28:13.1449602Z                              Write-OK "Temp folders purged ($itemsRemoved items)"
2026-01-11T19:28:13.1450198Z                          }
2026-01-11T19:28:13.1450455Z                          '16' = { # razer_block
2026-01-11T19:28:13.1451999Z                              Get-Service | Where-Object {$_.Name -like "Razer*"} | Stop-Service -Force -EA 
2026-01-11T19:28:13.1452404Z                      SilentlyContinue
2026-01-11T19:28:13.1453073Z                              Get-Service | Where-Object {$_.Name -like "Razer*"} | Set-Service -StartupType Disabled 
2026-01-11T19:28:13.1453221Z                      -EA SilentlyContinue
2026-01-11T19:28:13.1454038Z                              Write-OK "Razer services blocked"
2026-01-11T19:28:13.1454727Z                          }
2026-01-11T19:28:13.1455481Z                          '17' = { # restore_point
2026-01-11T19:28:13.1456258Z                              $recentRestorePoint = $null
2026-01-11T19:28:13.1456534Z                              # Check if System Protection is enabled first
2026-01-11T19:28:13.1456687Z                              $srEnabled = $false
2026-01-11T19:28:13.1457076Z                              try {
2026-01-11T19:28:13.1457574Z                                  $sr = Get-ItemProperty "HKLM:\SOFTWARE\Microsoft\Windows 
2026-01-11T19:28:13.1458020Z                      NT\CurrentVersion\SystemRestore" -Name "RPSessionInterval" -EA SilentlyContinue
2026-01-11T19:28:13.1458626Z                                  $srEnabled = ($null -ne $sr -and $sr.RPSessionInterval -ne 0)
2026-01-11T19:28:13.1458993Z                              } catch { }
2026-01-11T19:28:13.1459091Z                      
2026-01-11T19:28:13.1459220Z                              if (-not $srEnabled) {
2026-01-11T19:28:13.1460043Z                                  Write-Warn "System Restore disabled (enable in System Protection to create restore 
2026-01-11T19:28:13.1460599Z                      points)"
2026-01-11T19:28:13.1470473Z                              } else {
2026-01-11T19:28:13.1471803Z                                  try { $recentRestorePoint = Get-ComputerRestorePoint -EA Stop | Sort-Object 
2026-01-11T19:28:13.1472765Z                      CreationTime -Descending | Select-Object -First 1 } catch { $recentRestorePoint = $null }
2026-01-11T19:28:13.1473822Z                                  if ($recentRestorePoint -and $recentRestorePoint.CreationTime -gt 
2026-01-11T19:28:13.1474212Z                      (Get-Date).AddMinutes(-1440)) {
2026-01-11T19:28:13.1475034Z                                      Write-Warn "Restore point already created within last 24 hours (skipped)"
2026-01-11T19:28:13.1475748Z                                  } else {
2026-01-11T19:28:13.1477183Z                                      try {
2026-01-11T19:28:13.1477670Z                                          Checkpoint-Computer -Description "Before RockTune" -RestorePointType 
2026-01-11T19:28:13.1478579Z                      MODIFY_SETTINGS -EA Stop -WarningAction SilentlyContinue
2026-01-11T19:28:13.1478994Z                                          Write-OK "Restore point created"
2026-01-11T19:28:13.1479404Z                                      } catch {
2026-01-11T19:28:13.1480049Z                                          Write-Warn "Could not create restore point (System Restore may be disabled)"
2026-01-11T19:28:13.1480166Z                                      }
2026-01-11T19:28:13.1480259Z                                  }
2026-01-11T19:28:13.1480362Z                              }
2026-01-11T19:28:13.1480684Z                          }
2026-01-11T19:28:13.1481365Z                          '18' = { # classic_menu
2026-01-11T19:28:13.1481545Z                              if (-not $script:IsWin11) {
2026-01-11T19:28:13.1481925Z                                  Write-Warn "Classic context menu is a Windows 11 feature (Win10 already has it)"
2026-01-11T19:28:13.1482033Z                                  return
2026-01-11T19:28:13.1482135Z                              }
2026-01-11T19:28:13.1482355Z                              $clsid = "{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}"
2026-01-11T19:28:13.1483015Z                              $path = "HKCU:\Software\Classes\CLSID\$clsid\InprocServer32"
2026-01-11T19:28:13.1483602Z                              if (-not (Test-Path $path)) { New-Item -Path $path -Force | Out-Null }
2026-01-11T19:28:13.1484605Z                              Set-ItemProperty -Path $path -Name "(Default)" -Value ""
2026-01-11T19:28:13.1485077Z                              Write-OK "Classic context menu enabled"
2026-01-11T19:28:13.1485363Z                          }
2026-01-11T19:28:13.1485800Z                          '19' = { # storage_sense
2026-01-11T19:28:13.1485931Z                              Set-Reg 
2026-01-11T19:28:13.1487763Z                      "HKCU:\Software\Microsoft\Windows\CurrentVersion\StorageSense\Parameters\StoragePolicy" "01" 0
2026-01-11T19:28:13.1488577Z                              Write-OK "Storage Sense disabled"
2026-01-11T19:28:13.1488711Z                          }
2026-01-11T19:28:13.1488846Z                          '20' = { # display_perf
2026-01-11T19:28:13.1489711Z                              Set-Reg "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects" 
2026-01-11T19:28:13.1490097Z                      "VisualFXSetting" 2
2026-01-11T19:28:13.1490540Z                              Write-OK "Visual effects set to performance"
2026-01-11T19:28:13.1491055Z                          }
2026-01-11T19:28:13.1491196Z                          '21' = { # end_task
2026-01-11T19:28:13.1491355Z                              if (-not $script:IsWin11) {
2026-01-11T19:28:13.1491606Z                                  Write-Warn "End Task in taskbar is a Windows 11 feature"
2026-01-11T19:28:13.1492029Z                                  return
2026-01-11T19:28:13.1492164Z                              }
2026-01-11T19:28:13.1492981Z                              if (Set-Reg 
2026-01-11T19:28:13.1494495Z                      "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced\TaskbarDeveloperSettings" 
2026-01-11T19:28:13.1495893Z                      "TaskbarEndTask" 1 -PassThru) { Write-OK "End Task enabled in taskbar" }
2026-01-11T19:28:13.1496245Z                          }
2026-01-11T19:28:13.1496901Z                          '22' = { # explorer_cleanup
2026-01-11T19:28:13.1497084Z                              if (-not $script:IsWin11) {
2026-01-11T19:28:13.1497932Z                                  Write-Warn "Explorer Home/Gallery are Windows 11 features (Win10 doesn't have them)"
2026-01-11T19:28:13.1498342Z                                  return
2026-01-11T19:28:13.1498463Z                              }
2026-01-11T19:28:13.1499368Z                              Remove-Item "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Desktop\NameSpace\{f
2026-01-11T19:28:13.1500097Z                      874310e-b6b7-47dc-bc84-b9e6b38f5903}" -Force -EA SilentlyContinue
2026-01-11T19:28:13.1500812Z                              Remove-Item "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Desktop\NameSpace\{e
2026-01-11T19:28:13.1501574Z                      88865ea-0e1c-4e20-9aa6-edcd0212c87c}" -Force -EA SilentlyContinue
2026-01-11T19:28:13.1501763Z                              Write-OK "Explorer clutter removed"
2026-01-11T19:28:13.1501852Z                          }
2026-01-11T19:28:13.1501991Z                          '23' = { # notifications_off
2026-01-11T19:28:13.1502487Z                              Set-Reg "HKCU:\Software\Policies\Microsoft\Windows\Explorer" "DisableNotificationCenter" 1
2026-01-11T19:28:13.1502877Z                              Set-Reg "HKCU:\Software\Microsoft\Windows\CurrentVersion\PushNotifications" 
2026-01-11T19:28:13.1503000Z                      "ToastEnabled" 0
2026-01-11T19:28:13.1503172Z                              Write-OK "Notifications disabled"
2026-01-11T19:28:13.1503254Z                          }
2026-01-11T19:28:13.1503381Z                          '24' = { # ps7_telemetry
2026-01-11T19:28:13.1503869Z                              [Environment]::SetEnvironmentVariable("POWERSHELL_TELEMETRY_OPTOUT", "1", "Machine")
2026-01-11T19:28:13.1504022Z                              Write-OK "PS7 telemetry disabled"
2026-01-11T19:28:13.1504139Z                          }
2026-01-11T19:28:13.1504277Z                          '25' = { # multiplane_overlay
2026-01-11T19:28:13.1504585Z                              Set-Reg "HKLM:\SOFTWARE\Microsoft\Windows\Dwm" "OverlayTestMode" 5
2026-01-11T19:28:13.1504758Z                              Write-OK "Multiplane Overlay disabled"
2026-01-11T19:28:13.1504850Z                          }
2026-01-11T19:28:13.1504960Z                          '26' = { # mouse_accel
2026-01-11T19:28:13.1505583Z                              if (Set-Reg "HKCU:\Control Panel\Mouse" "MouseSpeed" 0 -PassThru) { Write-OK "Mouse 
2026-01-11T19:28:13.1505735Z                      acceleration disabled" }
2026-01-11T19:28:13.1505983Z                              Set-Reg "HKCU:\Control Panel\Mouse" "MouseThreshold1" 0
2026-01-11T19:28:13.1506219Z                              Set-Reg "HKCU:\Control Panel\Mouse" "MouseThreshold2" 0
2026-01-11T19:28:13.1506313Z                          }
2026-01-11T19:28:13.1506429Z                          '27' = { # usb_suspend
2026-01-11T19:28:13.1507341Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Services\USB\DisableSelectiveSuspend" 
2026-01-11T19:28:13.1507856Z                      "DisableSelectiveSuspend" 1
2026-01-11T19:28:13.1508616Z                              Write-OK "USB selective suspend disabled"
2026-01-11T19:28:13.1509353Z                          }
2026-01-11T19:28:13.1510516Z                          '28' = { # keyboard_response
2026-01-11T19:28:13.1511674Z                              if (Set-Reg "HKCU:\Control Panel\Keyboard" "KeyboardDelay" 0 -PassThru) { Write-OK 
2026-01-11T19:28:13.1511824Z                      "Keyboard delay minimized" }
2026-01-11T19:28:13.1513060Z                              Set-Reg "HKCU:\Control Panel\Keyboard" "KeyboardSpeed" 31
2026-01-11T19:28:13.1513157Z                          }
2026-01-11T19:28:13.1514016Z                          '29' = { # game_mode
2026-01-11T19:28:13.1514334Z                              Set-Reg "HKCU:\Software\Microsoft\GameBar" "AllowAutoGameMode" 1
2026-01-11T19:28:13.1515128Z                              Set-Reg "HKCU:\Software\Microsoft\GameBar" "AutoGameModeEnabled" 1
2026-01-11T19:28:13.1515309Z                              Write-OK "Game Mode enabled"
2026-01-11T19:28:13.1515673Z                          }
2026-01-11T19:28:13.1516233Z                          '30' = { # min_processor_state
2026-01-11T19:28:13.1517126Z                              powercfg /setacvalueindex scheme_current sub_processor PROCTHROTTLEMIN 5 2>&1 | Out-Null
2026-01-11T19:28:13.1517647Z                              if ($LASTEXITCODE -eq 0) {
2026-01-11T19:28:13.1518916Z                                  powercfg /setactive scheme_current 2>&1 | Out-Null
2026-01-11T19:28:13.1519127Z                                  Write-OK "Min processor state set to 5%"
2026-01-11T19:28:13.1519782Z                              } else { Write-Warn "Min processor state setting not supported" }
2026-01-11T19:28:13.1520357Z                          }
2026-01-11T19:28:13.1520976Z                          '31' = { # hibernation_disable
2026-01-11T19:28:13.1521658Z                              powercfg /hibernate off 2>&1 | Out-Null
2026-01-11T19:28:13.1523280Z                              if ($LASTEXITCODE -eq 0) { Write-OK "Hibernation disabled" } else { Write-Warn "Could not 
2026-01-11T19:28:13.1523439Z                      disable hibernation" }
2026-01-11T19:28:13.1523619Z                          }
2026-01-11T19:28:13.1524241Z                          '32' = { # rss_enable
2026-01-11T19:28:13.1525016Z                              Get-NetAdapter | Where-Object {$_.Status -eq "Up"} | ForEach-Object {
2026-01-11T19:28:13.1525643Z                                  Enable-NetAdapterRss -Name $_.Name -EA SilentlyContinue
2026-01-11T19:28:13.1526440Z                              }
2026-01-11T19:28:13.1527791Z                              Write-OK "RSS enabled on active adapters"
2026-01-11T19:28:13.1527900Z                          }
2026-01-11T19:28:13.1528498Z                          '33' = { # adapter_power
2026-01-11T19:28:13.1529861Z                              Get-NetAdapter | Where-Object {$_.Status -eq "Up"} | ForEach-Object {
2026-01-11T19:28:13.1530447Z                                  Set-NetAdapterPowerManagement -Name $_.Name -WakeOnMagicPacket Disabled 
2026-01-11T19:28:13.1530838Z                      -WakeOnPattern Disabled -EA SilentlyContinue
2026-01-11T19:28:13.1531881Z                              }
2026-01-11T19:28:13.1532586Z                              Write-OK "Network adapter power saving disabled"
2026-01-11T19:28:13.1532740Z                          }
2026-01-11T19:28:13.1533106Z                          '34' = { # delivery_opt
2026-01-11T19:28:13.1534148Z                              Set-Reg "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\DeliveryOptimization\Config" 
2026-01-11T19:28:13.1534576Z                      "DODownloadMode" 0
2026-01-11T19:28:13.1535165Z                              Write-OK "Delivery Optimization P2P disabled"
2026-01-11T19:28:13.1535279Z                          }
2026-01-11T19:28:13.1536167Z                          '35' = { # wer_disable
2026-01-11T19:28:13.1537520Z                              Set-Reg "HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting" "Disabled" 1
2026-01-11T19:28:13.1537760Z                              Stop-Service WerSvc -Force -EA SilentlyContinue
2026-01-11T19:28:13.1538064Z                              Set-Service WerSvc -StartupType Disabled -EA SilentlyContinue
2026-01-11T19:28:13.1538654Z                              Write-OK "Windows Error Reporting disabled"
2026-01-11T19:28:13.1538802Z                          }
2026-01-11T19:28:13.1539163Z                          '36' = { # wifi_sense
2026-01-11T19:28:13.1539470Z                              Set-Reg "HKLM:\SOFTWARE\Microsoft\WcmSvc\wifinetworkmanager\config" 
2026-01-11T19:28:13.1539676Z                      "AutoConnectAllowedOEM" 0
2026-01-11T19:28:13.1540784Z                              Write-OK "WiFi Sense disabled"
2026-01-11T19:28:13.1541623Z                          }
2026-01-11T19:28:13.1542307Z                          '37' = { # spotlight_disable
2026-01-11T19:28:13.1543630Z                              Set-Reg "HKCU:\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" 
2026-01-11T19:28:13.1543801Z                      "RotatingLockScreenEnabled" 0
2026-01-11T19:28:13.1545096Z                              Set-Reg "HKCU:\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" 
2026-01-11T19:28:13.1545262Z                      "RotatingLockScreenOverlayEnabled" 0
2026-01-11T19:28:13.1546224Z                              Write-OK "Windows Spotlight disabled"
2026-01-11T19:28:13.1546631Z                          }
2026-01-11T19:28:13.1547476Z                          '38' = { # feedback_disable
2026-01-11T19:28:13.1548513Z                              Set-Reg "HKCU:\Software\Microsoft\Siuf\Rules" "NumberOfSIUFInPeriod" 0
2026-01-11T19:28:13.1549528Z                              Write-OK "Windows Feedback prompts disabled"
2026-01-11T19:28:13.1549666Z                          }
2026-01-11T19:28:13.1550848Z                          '39' = { # clipboard_sync
2026-01-11T19:28:13.1551854Z                              Set-Reg "HKCU:\Software\Microsoft\Clipboard" "EnableClipboardHistory" 0
2026-01-11T19:28:13.1553184Z                              Write-OK "Cloud Clipboard sync disabled"
2026-01-11T19:28:13.1553482Z                          }
2026-01-11T19:28:13.1554522Z                          '40' = { # accessibility_shortcuts
2026-01-11T19:28:13.1554984Z                              Set-Reg "HKCU:\Control Panel\Accessibility\StickyKeys" "Flags" "506" "String"
2026-01-11T19:28:13.1556168Z                              Set-Reg "HKCU:\Control Panel\Accessibility\Keyboard Response" "Flags" "122" "String"
2026-01-11T19:28:13.1556574Z                              Set-Reg "HKCU:\Control Panel\Accessibility\ToggleKeys" "Flags" "58" "String"
2026-01-11T19:28:13.1556958Z                              Set-Reg "HKCU:\Control Panel\Accessibility\MouseKeys" "Flags" "58" "String"
2026-01-11T19:28:13.1558131Z                              Write-OK "Accessibility shortcuts disabled (no more Sticky Keys popup)"
2026-01-11T19:28:13.1558233Z                          }
2026-01-11T19:28:13.1558664Z                          '41' = { # audio_communications
2026-01-11T19:28:13.1560194Z                              Set-Reg "HKCU:\Software\Microsoft\Multimedia\Audio" "UserDuckingPreference" 3
2026-01-11T19:28:13.1560564Z                              Write-OK "Volume ducking disabled (full volume during calls)"
2026-01-11T19:28:13.1560803Z                          }
2026-01-11T19:28:13.1561204Z                          '42' = { # audio_system_sounds
2026-01-11T19:28:13.1562436Z                              Set-Reg "HKCU:\AppEvents\Schemes" "(Default)" ".None" "String"
2026-01-11T19:28:13.1562827Z                              Get-ChildItem "HKCU:\AppEvents\Schemes\Apps" -Recurse | Where-Object {$_.PSChildName -eq 
2026-01-11T19:28:13.1563561Z                      ".Current"} | ForEach-Object { Set-ItemProperty -Path $_.PSPath -Name "(Default)" -Value "" -EA 
2026-01-11T19:28:13.1563666Z                      SilentlyContinue }
2026-01-11T19:28:13.1564762Z                              Write-OK "Windows system sounds muted"
2026-01-11T19:28:13.1565616Z                          }
2026-01-11T19:28:13.1566338Z                          '43' = { # input_buffer
2026-01-11T19:28:13.1567478Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Services\mouclass\Parameters" 
2026-01-11T19:28:13.1568200Z                      "MouseDataQueueSize" 32
2026-01-11T19:28:13.1569013Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Services\kbdclass\Parameters" 
2026-01-11T19:28:13.1570153Z                      "KeyboardDataQueueSize" 32
2026-01-11T19:28:13.1570767Z                              Write-OK "Input buffer size increased (prevents drops at 8000Hz)"
2026-01-11T19:28:13.1571197Z                          }
2026-01-11T19:28:13.1572183Z                          '44' = { # filesystem_perf
2026-01-11T19:28:13.1572419Z                              fsutil behavior set disablelastaccess 1 >$null 2>&1
2026-01-11T19:28:13.1573609Z                              fsutil behavior set disable8dot3 1 >$null 2>&1
2026-01-11T19:28:13.1574271Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Control\FileSystem" "NtfsMemoryUsage" 2
2026-01-11T19:28:13.1574742Z                              Write-OK "Filesystem performance optimized"
2026-01-11T19:28:13.1574971Z                          }
2026-01-11T19:28:13.1576006Z                          '45' = { # dwm_perf
2026-01-11T19:28:13.1576369Z                              Set-Reg "HKCU:\Software\Microsoft\Windows\DWM" "AccentColorInactive" 1
2026-01-11T19:28:13.1577504Z                              Set-Reg "HKCU:\Software\Microsoft\Windows\DWM" "ColorPrevalence" 0
2026-01-11T19:28:13.1578218Z                              Set-Reg "HKCU:\Software\Microsoft\Windows\DWM" "EnableAeroPeek" 0
2026-01-11T19:28:13.1578429Z                              Write-OK "DWM performance optimized"
2026-01-11T19:28:13.1579378Z                          }
2026-01-11T19:28:13.1580585Z                      
2026-01-11T19:28:13.1580740Z                          # CAUTION tier (50-72)
2026-01-11T19:28:13.1581219Z                          '50' = { # msi_mode
2026-01-11T19:28:13.1582314Z                              $gpu = Get-PnpDevice -Class Display | Where-Object {$_.Status -eq "OK"} | Select-Object 
2026-01-11T19:28:13.1582453Z                      -First 1
2026-01-11T19:28:13.1583217Z                              if ($gpu) {
2026-01-11T19:28:13.1584427Z                                  $msiPath = "HKLM:\SYSTEM\CurrentControlSet\Enum\$($gpu.InstanceId)\Device 
2026-01-11T19:28:13.1584830Z                      Parameters\Interrupt Management\MessageSignaledInterruptProperties"
2026-01-11T19:28:13.1585673Z                                  if (Test-Path $msiPath) { Set-Reg $msiPath "MSISupported" 1; Write-OK "MSI mode 
2026-01-11T19:28:13.1585825Z                      enabled for GPU" }
2026-01-11T19:28:13.1586202Z                              }
2026-01-11T19:28:13.1586777Z                          }
2026-01-11T19:28:13.1587308Z                          '51' = { # hpet
2026-01-11T19:28:13.1587910Z                              bcdedit /set useplatformclock false 2>$null
2026-01-11T19:28:13.1588805Z                              bcdedit /set disabledynamictick yes 2>$null
2026-01-11T19:28:13.1589242Z                              Write-OK "HPET disabled (reboot required)"
2026-01-11T19:28:13.1589661Z                          }
2026-01-11T19:28:13.1590103Z                          '52' = { # game_bar
2026-01-11T19:28:13.1590969Z                              Set-Reg "HKCU:\Software\Microsoft\GameBar" "ShowStartupPanel" 0
2026-01-11T19:28:13.1591369Z                              Set-Reg "HKCU:\Software\Microsoft\GameBar" "GamePanelStartupTipIndex" 3
2026-01-11T19:28:13.1591719Z                              Write-OK "Game Bar overlays disabled"
2026-01-11T19:28:13.1592234Z                          }
2026-01-11T19:28:13.1593110Z                          '53' = { # hags
2026-01-11T19:28:13.1594922Z                              if (Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Control\GraphicsDrivers" "HwSchMode" 2 
2026-01-11T19:28:13.1595142Z                      -PassThru) { Write-OK "HAGS enabled" }
2026-01-11T19:28:13.1595255Z                          }
2026-01-11T19:28:13.1596397Z                          '54' = { # fso_disable
2026-01-11T19:28:13.1596822Z                              Set-Reg "HKCU:\System\GameConfigStore" "GameDVR_FSEBehaviorMode" 2
2026-01-11T19:28:13.1598010Z                              Set-Reg "HKCU:\System\GameConfigStore" "GameDVR_HonorUserFSEBehaviorMode" 1
2026-01-11T19:28:13.1599358Z                              Set-Reg "HKCU:\System\GameConfigStore" "GameDVR_FSEBehavior" 2
2026-01-11T19:28:13.1599557Z                              Write-OK "Fullscreen optimizations disabled"
2026-01-11T19:28:13.1600542Z                          }
2026-01-11T19:28:13.1600881Z                          '55' = { # ultimate_perf
2026-01-11T19:28:13.1602333Z                              powercfg /duplicatescheme e9a42b02-d5df-448d-aa00-03f14749eb61 >$null 2>&1
2026-01-11T19:28:13.1602548Z                              $planOutput = powercfg /list 2>&1
2026-01-11T19:28:13.1603716Z                              $plans = $planOutput | Select-String "Ultimate Performance"
2026-01-11T19:28:13.1603841Z                              if ($plans) {
2026-01-11T19:28:13.1604978Z                                  $guidMatch = [regex]::Match($plans.Line, "([A-Fa-f0-9-]{36})")
2026-01-11T19:28:13.1605155Z                                  if ($guidMatch.Success) {
2026-01-11T19:28:13.1605313Z                                      $guid = $guidMatch.Value
2026-01-11T19:28:13.1606251Z                                      powercfg /setactive $guid 2>&1 | Out-Null
2026-01-11T19:28:13.1607368Z                                      if ($LASTEXITCODE -eq 0) { Write-OK "Ultimate Performance enabled" } else { 
2026-01-11T19:28:13.1607623Z                      Write-Warn "Could not activate Ultimate Performance" }
2026-01-11T19:28:13.1608927Z                                  } else { Write-Warn "Could not parse Ultimate Performance GUID" }
2026-01-11T19:28:13.1609216Z                              } else { Write-Warn "Ultimate Performance plan not available" }
2026-01-11T19:28:13.1609988Z                          }
2026-01-11T19:28:13.1610914Z                          '56' = { # services_trim
2026-01-11T19:28:13.1611393Z                              $trimSvc = @("DiagTrack","dmwappushservice","lfsvc","RetailDemo","Fax","SharedAccess")
2026-01-11T19:28:13.1612513Z                              foreach ($s in $trimSvc) { Set-Service $s -StartupType Manual -EA SilentlyContinue; 
2026-01-11T19:28:13.1612763Z                      Stop-Service $s -Force -EA SilentlyContinue }
2026-01-11T19:28:13.1613577Z                              Write-OK "Services trimmed"
2026-01-11T19:28:13.1614136Z                          }
2026-01-11T19:28:13.1614341Z                          '57' = { # disk_cleanup
2026-01-11T19:28:13.1616406Z                              Start-Process "cleanmgr.exe" -ArgumentList "/sagerun:100" -Wait -WindowStyle Hidden
2026-01-11T19:28:13.1616623Z                              Write-OK "Disk cleanup complete"
2026-01-11T19:28:13.1617085Z                          }
2026-01-11T19:28:13.1617259Z                          '58' = { # wpbt_disable
2026-01-11T19:28:13.1617870Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager" "DisableWpbtExecution" 1
2026-01-11T19:28:13.1618337Z                              Write-OK "WPBT disabled (blocks OEM bloatware)"
2026-01-11T19:28:13.1619227Z                          }
2026-01-11T19:28:13.1620049Z                          '59' = { # qos_gaming
2026-01-11T19:28:13.1621291Z                              Set-Reg "HKLM:\SOFTWARE\Policies\Microsoft\Windows\Psched" "NonBestEffortLimit" 0
2026-01-11T19:28:13.1621480Z                              Write-OK "QoS gaming configured"
2026-01-11T19:28:13.1622504Z                          }
2026-01-11T19:28:13.1622750Z                          '60' = { # network_throttling
2026-01-11T19:28:13.1624154Z                              Set-Reg "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile" 
2026-01-11T19:28:13.1624408Z                      "NetworkThrottlingIndex" 0xffffffff
2026-01-11T19:28:13.1624826Z                              Write-OK "Network throttling disabled"
2026-01-11T19:28:13.1625532Z                          }
2026-01-11T19:28:13.1625688Z                          '61' = { # interrupt_affinity
2026-01-11T19:28:13.1626856Z                              $gpu = Get-PnpDevice -Class Display | Where-Object {$_.Status -eq "OK"} | Select-Object 
2026-01-11T19:28:13.1627003Z                      -First 1
2026-01-11T19:28:13.1627605Z                              if ($gpu) {
2026-01-11T19:28:13.1629412Z                                  $affPath = "HKLM:\SYSTEM\CurrentControlSet\Enum\$($gpu.InstanceId)\Device 
2026-01-11T19:28:13.1629786Z                      Parameters\Interrupt Management\Affinity Policy"
2026-01-11T19:28:13.1630194Z                                  if (-not (Test-Path $affPath)) { New-Item -Path $affPath -Force | Out-Null }
2026-01-11T19:28:13.1631926Z                                  Set-Reg $affPath "DevicePolicy" 3
2026-01-11T19:28:13.1632999Z                                  Set-Reg $affPath "AssignmentSetOverride" 1
2026-01-11T19:28:13.1634417Z                                  Write-OK "GPU interrupt affinity set to CPU 0"
2026-01-11T19:28:13.1634675Z                              }
2026-01-11T19:28:13.1637391Z                          }
2026-01-11T19:28:13.1638136Z                          '62' = { # process_mitigation
2026-01-11T19:28:13.1638696Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\kernel" 
2026-01-11T19:28:13.1639215Z                      "KernelShadowStacksForceDisabled" 1
2026-01-11T19:28:13.1639616Z                              Write-OK "Process mitigations disabled (security reduced)"
2026-01-11T19:28:13.1639945Z                          }
2026-01-11T19:28:13.1640652Z                          '63' = { # mmcss_gaming
2026-01-11T19:28:13.1641370Z                              $mmcss = "HKLM:\SOFTWARE\Microsoft\Windows 
2026-01-11T19:28:13.1642082Z                      NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games"
2026-01-11T19:28:13.1642528Z                              Set-Reg $mmcss "GPU Priority" 8
2026-01-11T19:28:13.1643076Z                              Set-Reg $mmcss "Priority" 6
2026-01-11T19:28:13.1643598Z                              Set-Reg $mmcss "Scheduling Category" "High" "String"
2026-01-11T19:28:13.1644117Z                              Set-Reg $mmcss "SFIO Priority" "High" "String"
2026-01-11T19:28:13.1644859Z                              Write-OK "MMCSS gaming priority configured"
2026-01-11T19:28:13.1645018Z                          }
2026-01-11T19:28:13.1645411Z                          '64' = { # scheduler_opt
2026-01-11T19:28:13.1646487Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Control\PriorityControl" 
2026-01-11T19:28:13.1646661Z                      "Win32PrioritySeparation" 26
2026-01-11T19:28:13.1647333Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Control\PriorityControl" "IRQ8Priority" 1
2026-01-11T19:28:13.1647857Z                              Write-OK "Scheduler optimized for gaming"
2026-01-11T19:28:13.1647976Z                          }
2026-01-11T19:28:13.1648462Z                          '65' = { # core_parking
2026-01-11T19:28:13.1649394Z                              powercfg /setacvalueindex scheme_current sub_processor CPMINCORES 100 2>&1 | Out-Null
2026-01-11T19:28:13.1649581Z                              if ($LASTEXITCODE -eq 0) {
2026-01-11T19:28:13.1650440Z                                  powercfg /setactive scheme_current 2>&1 | Out-Null
2026-01-11T19:28:13.1650646Z                                  Write-OK "Core parking disabled"
2026-01-11T19:28:13.1651690Z                              } else { Write-Warn "Core parking setting not supported" }
2026-01-11T19:28:13.1652191Z                          }
2026-01-11T19:28:13.1655147Z                          '66' = { # timer_registry
2026-01-11T19:28:13.1656135Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\kernel" 
2026-01-11T19:28:13.1656536Z                      "GlobalTimerResolutionRequests" 1
2026-01-11T19:28:13.1657276Z                              Set-Reg "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile" 
2026-01-11T19:28:13.1657762Z                      "SystemResponsiveness" 0
2026-01-11T19:28:13.1658294Z                              Write-OK "Timer resolution registry configured"
2026-01-11T19:28:13.1658578Z                          }
2026-01-11T19:28:13.1658718Z                          '67' = { # rsc_disable
2026-01-11T19:28:13.1659295Z                              Get-NetAdapter | Where-Object {$_.Status -eq "Up"} | ForEach-Object {
2026-01-11T19:28:13.1659593Z                                  Disable-NetAdapterRsc -Name $_.Name -EA SilentlyContinue
2026-01-11T19:28:13.1659694Z                              }
2026-01-11T19:28:13.1659893Z                              Write-OK "RSC disabled on active adapters"
2026-01-11T19:28:13.1659983Z                          }
2026-01-11T19:28:13.1660711Z                          '68' = { # sysmain_disable
2026-01-11T19:28:13.1661179Z                              Stop-Service SysMain -Force -EA SilentlyContinue
2026-01-11T19:28:13.1661777Z                              Set-Service SysMain -StartupType Disabled -EA SilentlyContinue
2026-01-11T19:28:13.1662095Z                              Write-OK "SysMain/Superfetch disabled"
2026-01-11T19:28:13.1662556Z                          }
2026-01-11T19:28:13.1663293Z                          '69' = { # services_search_off
2026-01-11T19:28:13.1663945Z                              Stop-Service WSearch -Force -EA SilentlyContinue
2026-01-11T19:28:13.1664503Z                              Set-Service WSearch -StartupType Manual -EA SilentlyContinue
2026-01-11T19:28:13.1664932Z                              Write-OK "Windows Search set to Manual (stops disk indexing)"
2026-01-11T19:28:13.1665323Z                          }
2026-01-11T19:28:13.1666045Z                          '70' = { # memory_gaming
2026-01-11T19:28:13.1666936Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management" 
2026-01-11T19:28:13.1667399Z                      "DisablePagingExecutive" 1
2026-01-11T19:28:13.1668360Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management" 
2026-01-11T19:28:13.1668676Z                      "LargeSystemCache" 0
2026-01-11T19:28:13.1669481Z                              Write-OK "Memory gaming mode enabled (kernel stays in RAM)"
2026-01-11T19:28:13.1669802Z                          }
2026-01-11T19:28:13.1670587Z                          '71' = { # power_throttle_off
2026-01-11T19:28:13.1671874Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Control\Power\PowerThrottling" 
2026-01-11T19:28:13.1672257Z                      "PowerThrottlingOff" 1
2026-01-11T19:28:13.1672799Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Power" 
2026-01-11T19:28:13.1673148Z                      "EcoQosPolicyDisabled" 1
2026-01-11T19:28:13.1673693Z                              Write-OK "Power throttling disabled"
2026-01-11T19:28:13.1674103Z                          }
2026-01-11T19:28:13.1674711Z                          '72' = { # priority_boost_off
2026-01-11T19:28:13.1675505Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Control\PriorityControl" "Win32PriorityBoost" 0
2026-01-11T19:28:13.1676513Z                              Write-OK "Priority boost disabled (consistent scheduling)"
2026-01-11T19:28:13.1676945Z                          }
2026-01-11T19:28:13.1678261Z                      
2026-01-11T19:28:13.1678776Z                          # RISKY tier (80-89)
2026-01-11T19:28:13.1679232Z                          '80' = { # privacy_tier1
2026-01-11T19:28:13.1680063Z                              Set-Reg "HKCU:\Software\Microsoft\Windows\CurrentVersion\AdvertisingInfo" "Enabled" 0
2026-01-11T19:28:13.1680617Z                              Set-Reg "HKCU:\Software\Microsoft\Windows\CurrentVersion\Privacy" 
2026-01-11T19:28:13.1681235Z                      "TailoredExperiencesWithDiagnosticDataEnabled" 0
2026-01-11T19:28:13.1682158Z                              Write-OK "Advertising ID and tailored experiences disabled"
2026-01-11T19:28:13.1682268Z                          }
2026-01-11T19:28:13.1682751Z                          '81' = { # privacy_tier2
2026-01-11T19:28:13.1683978Z                              Set-Reg "HKLM:\SOFTWARE\Policies\Microsoft\Windows\DataCollection" "AllowTelemetry" 0
2026-01-11T19:28:13.1685983Z                              Set-Reg "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" 
2026-01-11T19:28:13.1686129Z                      "Start_TrackProgs" 0
2026-01-11T19:28:13.1686402Z                              Write-OK "Telemetry minimized"
2026-01-11T19:28:13.1687259Z                          }
2026-01-11T19:28:13.1688238Z                          '82' = { # privacy_tier3
2026-01-11T19:28:13.1689459Z                              $xboxSvc = @("XblAuthManager","XblGameSave","XboxGipSvc","XboxNetApiSvc")
2026-01-11T19:28:13.1690971Z                              foreach ($s in $xboxSvc) { Stop-Service $s -Force -EA SilentlyContinue; Set-Service $s 
2026-01-11T19:28:13.1691560Z                      -StartupType Disabled -EA SilentlyContinue }
2026-01-11T19:28:13.1692424Z                              Write-OK "Xbox services disabled (Game Pass broken)"
2026-01-11T19:28:13.1693326Z                          }
2026-01-11T19:28:13.1694269Z                          '83' = { # bloatware
2026-01-11T19:28:13.1695754Z                              $bloatApps = @("Microsoft.BingNews", "Microsoft.GetHelp", "Microsoft.Getstarted", 
2026-01-11T19:28:13.1696743Z                      "Microsoft.MicrosoftSolitaireCollection", "Microsoft.People", "Microsoft.PowerAutomateDesktop", 
2026-01-11T19:28:13.1698077Z                      "Microsoft.Todos", "Microsoft.WindowsAlarms", "Microsoft.WindowsFeedbackHub", 
2026-01-11T19:28:13.1698762Z                      "Microsoft.WindowsMaps", "Microsoft.WindowsSoundRecorder", "Microsoft.YourPhone", 
2026-01-11T19:28:13.1700122Z                      "Microsoft.ZuneMusic", "Microsoft.ZuneVideo", "Clipchamp.Clipchamp", "Microsoft.549981C3F5F10")
2026-01-11T19:28:13.1700327Z                              foreach ($app in $bloatApps) {
2026-01-11T19:28:13.1701118Z                                  Get-AppxPackage -Name $app -AllUsers | Remove-AppxPackage -AllUsers -EA 
2026-01-11T19:28:13.1701283Z                      SilentlyContinue
2026-01-11T19:28:13.1701650Z                              }
2026-01-11T19:28:13.1702121Z                              Write-OK "Bloatware removed"
2026-01-11T19:28:13.1702219Z                          }
2026-01-11T19:28:13.1702524Z                          '84' = { # ipv4_prefer
2026-01-11T19:28:13.1703016Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters" "DisabledComponents" 
2026-01-11T19:28:13.1703128Z                      32
2026-01-11T19:28:13.1703607Z                              Write-OK "IPv4 preferred over IPv6"
2026-01-11T19:28:13.1703736Z                          }
2026-01-11T19:28:13.1703858Z                          '85' = { # teredo_disable
2026-01-11T19:28:13.1704122Z                              netsh interface teredo set state disabled 2>$null
2026-01-11T19:28:13.1704842Z                              Write-OK "Teredo disabled"
2026-01-11T19:28:13.1705412Z                          }
2026-01-11T19:28:13.1705798Z                          '86' = { # native_nvme
2026-01-11T19:28:13.1706775Z                              $build = [int](Get-CimInstance Win32_OperatingSystem).BuildNumber
2026-01-11T19:28:13.1707644Z                              if ($build -ge 26100) {
2026-01-11T19:28:13.1708759Z                                  $nvmePath = 
2026-01-11T19:28:13.1709513Z                      "HKLM:\SYSTEM\CurrentControlSet\Policies\Microsoft\FeatureManagement\Overrides"
2026-01-11T19:28:13.1711384Z                                  if (-not (Test-Path $nvmePath)) { New-Item -Path $nvmePath -Force | Out-Null }
2026-01-11T19:28:13.1711609Z                                  Set-Reg $nvmePath "1176759950" 1
2026-01-11T19:28:13.1712060Z                                  Write-OK "Native NVMe enabled (reboot required)"
2026-01-11T19:28:13.1712485Z                              } else { Write-Fail "Native NVMe requires Win11 24H2+" }
2026-01-11T19:28:13.1712595Z                          }
2026-01-11T19:28:13.1712717Z                          '87' = { # smt_disable
2026-01-11T19:28:13.1713560Z                              $cores = (Get-CimInstance Win32_Processor).NumberOfCores; bcdedit /set numproc $cores 
2026-01-11T19:28:13.1713679Z                      2>$null
2026-01-11T19:28:13.1713875Z                              Write-OK "SMT disabled (reboot required)"
2026-01-11T19:28:13.1714005Z                          }
2026-01-11T19:28:13.1714699Z                          '88' = { # audio_exclusive
2026-01-11T19:28:13.1715216Z                              Set-Reg "HKCU:\AppEvents\Schemes" "(Default)" ".None" "String"
2026-01-11T19:28:13.1715470Z                              Write-OK "System sounds disabled for exclusive mode"
2026-01-11T19:28:13.1715817Z                          }
2026-01-11T19:28:13.1717586Z                          '89' = { # tcp_optimizer
2026-01-11T19:28:13.1717955Z                              $adapters = Get-NetAdapter | Where-Object {$_.Status -eq "Up"}
2026-01-11T19:28:13.1718783Z                              foreach ($adapter in $adapters) {
2026-01-11T19:28:13.1719751Z                                  $path = 
2026-01-11T19:28:13.1721510Z                      "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces\$($adapter.InterfaceGuid)"
2026-01-11T19:28:13.1721948Z                                  Set-Reg $path "TcpAckFrequency" 1
2026-01-11T19:28:13.1722660Z                                  Set-Reg $path "TCPNoDelay" 1
2026-01-11T19:28:13.1722801Z                              }
2026-01-11T19:28:13.1723798Z                              Write-OK "TCP optimizer applied"
2026-01-11T19:28:13.1724638Z                          }
2026-01-11T19:28:13.1725224Z                      
2026-01-11T19:28:13.1726088Z                          # FR33THY Phase (104+)
2026-01-11T19:28:13.1727019Z                          '104' = { # background_polling
2026-01-11T19:28:13.1728404Z                              if (Set-Reg "HKCU:\Control Panel\Mouse" "RawMouseThrottleEnabled" 0 -PassThru) {
2026-01-11T19:28:13.1729381Z                                  Write-OK "Background mouse polling unlocked (full rate in background windows)"
2026-01-11T19:28:13.1729991Z                              }
2026-01-11T19:28:13.1730848Z                          }
2026-01-11T19:28:13.1732027Z                          '105' = { # amd_ulps_disable
2026-01-11T19:28:13.1732870Z                              $gpuPath = 
2026-01-11T19:28:13.1735089Z                      "HKLM:\SYSTEM\CurrentControlSet\Control\Class\{4d36e968-e325-11ce-bfc1-08002be10318}"
2026-01-11T19:28:13.1735620Z                              $foundAmd = $false
2026-01-11T19:28:13.1737010Z                              Get-ChildItem $gpuPath -EA SilentlyContinue | ForEach-Object {
2026-01-11T19:28:13.1737651Z                                  try {
2026-01-11T19:28:13.1738636Z                                      $desc = Get-ItemPropertyValue $_.PSPath "DriverDesc" -EA SilentlyContinue
2026-01-11T19:28:13.1739585Z                                      if ($desc -match "AMD|Radeon") {
2026-01-11T19:28:13.1740250Z                                          $foundAmd = $true
2026-01-11T19:28:13.1741363Z                                          Set-Reg $_.PSPath "EnableUlps" 0
2026-01-11T19:28:13.1742257Z                                          Set-Reg $_.PSPath "EnableUlps_NA" 0
2026-01-11T19:28:13.1743173Z                                      }
2026-01-11T19:28:13.1744065Z                                  } catch {}
2026-01-11T19:28:13.1745126Z                              }
2026-01-11T19:28:13.1746043Z                              if ($foundAmd) { Write-OK "AMD ULPS disabled (no more downclock stutters)" }
2026-01-11T19:28:13.1746833Z                              else { Write-Warn "No AMD GPU found, ULPS skip" }
2026-01-11T19:28:13.1747542Z                          }
2026-01-11T19:28:13.1748470Z                          '106' = { # nvidia_p0_state
2026-01-11T19:28:13.1749314Z                              $gpuPath = 
2026-01-11T19:28:13.1750387Z                      "HKLM:\SYSTEM\CurrentControlSet\Control\Class\{4d36e968-e325-11ce-bfc1-08002be10318}"
2026-01-11T19:28:13.1750893Z                              $foundNv = $false
2026-01-11T19:28:13.1752081Z                              Get-ChildItem $gpuPath -EA SilentlyContinue | ForEach-Object {
2026-01-11T19:28:13.1752723Z                                  try {
2026-01-11T19:28:13.1753824Z                                      $desc = Get-ItemPropertyValue $_.PSPath "DriverDesc" -EA SilentlyContinue
2026-01-11T19:28:13.1754387Z                                      if ($desc -match "NVIDIA|GeForce") {
2026-01-11T19:28:13.1755174Z                                          $foundNv = $true
2026-01-11T19:28:13.1756231Z                                          Set-Reg $_.PSPath "DisableDynamicPstate" 1
2026-01-11T19:28:13.1757202Z                                      }
2026-01-11T19:28:13.1757893Z                                  } catch {}
2026-01-11T19:28:13.1758607Z                              }
2026-01-11T19:28:13.1759712Z                              if ($foundNv) {
2026-01-11T19:28:13.1760601Z                                  Write-OK "NVIDIA P0 state forced (constant max clocks)"
2026-01-11T19:28:13.1761579Z                                  Write-Warn "GPU will run hotter - monitor temperatures!"
2026-01-11T19:28:13.1762331Z                              }
2026-01-11T19:28:13.1763407Z                              else { Write-Warn "No NVIDIA GPU found, P0 skip" }
2026-01-11T19:28:13.1764205Z                          }
2026-01-11T19:28:13.1765147Z                          '107' = { # network_binding_strip
2026-01-11T19:28:13.1766263Z                              Write-Warn "Stripping network bindings (breaks file/printer sharing!)"
2026-01-11T19:28:13.1767333Z                              $bindings = 
2026-01-11T19:28:13.1773401Z                      @("ms_lldp","ms_lltdio","ms_implat","ms_rspndr","ms_tcpip6","ms_server","ms_msclient","ms_pacer")
2026-01-11T19:28:13.1774570Z                              $adapters = Get-NetAdapter | Where-Object {$_.Status -eq "Up"}
2026-01-11T19:28:13.1775279Z                              $count = 0
2026-01-11T19:28:13.1777223Z                              foreach ($adapter in $adapters) {
2026-01-11T19:28:13.1781537Z                                  foreach ($binding in $bindings) {
2026-01-11T19:28:13.1781754Z                                      try {
2026-01-11T19:28:13.1782619Z                                          $current = Get-NetAdapterBinding -Name $adapter.Name -ComponentID $binding 
2026-01-11T19:28:13.1782837Z                      -EA Stop
2026-01-11T19:28:13.1783741Z                                          if ($current.Enabled) {
2026-01-11T19:28:13.1784602Z                                              Disable-NetAdapterBinding -Name $adapter.Name -ComponentID $binding -EA 
2026-01-11T19:28:13.1784909Z                      Stop
2026-01-11T19:28:13.1785609Z                                              $count++
2026-01-11T19:28:13.1786130Z                                          }
2026-01-11T19:28:13.1786678Z                                      } catch {}
2026-01-11T19:28:13.1787568Z                                  }
2026-01-11T19:28:13.1788297Z                              }
2026-01-11T19:28:13.1789163Z                              if ($count -gt 0) { Write-OK "Stripped $count network bindings (IPv4 only mode)" }
2026-01-11T19:28:13.1789533Z                              else { Write-Warn "No bindings modified (may already be stripped)" }
2026-01-11T19:28:13.1789937Z                          }
2026-01-11T19:28:13.1790429Z                      
2026-01-11T19:28:13.1791092Z                          # NOTE: LUDICROUS tier (100-103) intentionally NOT included for security
2026-01-11T19:28:13.1791390Z                          # IDs 100, 101, 102, 103 would disable critical security mitigations
2026-01-11T19:28:13.1791992Z                      }
2026-01-11T19:28:13.1793645Z                      
2026-01-11T19:28:13.1794431Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.1794550Z                      # MAIN EXECUTION
2026-01-11T19:28:13.1795462Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.1795589Z                      
2026-01-11T19:28:13.1796364Z                      Clear-Host
2026-01-11T19:28:13.1796844Z                      Write-Banner
2026-01-11T19:28:13.1797669Z                      Write-Host ""
2026-01-11T19:28:13.1797849Z                      
2026-01-11T19:28:13.1798384Z                      # Display configuration
2026-01-11T19:28:13.1799690Z                      $cpuName = if ($cpuId -and $CPU_MAP[$cpuId]) { $CPU_MAP[$cpuId].ToUpper() } else { "Not 
2026-01-11T19:28:13.1799825Z                      specified" }
2026-01-11T19:28:13.1800750Z                      $gpuName = if ($gpuId -and $GPU_MAP[$gpuId]) { $GPU_MAP[$gpuId].ToUpper() } else { "Not 
2026-01-11T19:28:13.1800969Z                      specified" }
2026-01-11T19:28:13.1801514Z                      
2026-01-11T19:28:13.1802201Z                      Write-Host "  Configuration:" -ForegroundColor White
2026-01-11T19:28:13.1803285Z                      Write-Host "    CPU: $cpuName" -ForegroundColor Gray
2026-01-11T19:28:13.1803582Z                      Write-Host "    GPU: $gpuName" -ForegroundColor Gray
2026-01-11T19:28:13.1803908Z                      Write-Host "    Optimizations: $($optIds.Count)" -ForegroundColor Gray
2026-01-11T19:28:13.1804234Z                      Write-Host "    Packages: $($pkgKeys.Count)" -ForegroundColor Gray
2026-01-11T19:28:13.1804820Z                      Write-Host ""
2026-01-11T19:28:13.1805472Z                      
2026-01-11T19:28:13.1806084Z                      # Show system info
2026-01-11T19:28:13.1806742Z                      $cpu = (Get-CimInstance Win32_Processor).Name
2026-01-11T19:28:13.1807579Z                      $gpu = (Get-CimInstance Win32_VideoController | Where-Object {$_.Status -eq "OK"} | Select-Object 
2026-01-11T19:28:13.1807810Z                      -First 1).Name
2026-01-11T19:28:13.1808962Z                      $ram = [math]::Round((Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property Capacity 
2026-01-11T19:28:13.1809332Z                      -Sum).Sum / 1GB)
2026-01-11T19:28:13.1809676Z                      Write-Host "  System:" -ForegroundColor White
2026-01-11T19:28:13.1810798Z                      Write-Host "    OS:  $script:WinVersion (Build $script:WinBuild)" -ForegroundColor $(if 
2026-01-11T19:28:13.1811008Z                      ($script:IsWin11) { "Gray" } else { "Yellow" })
2026-01-11T19:28:13.1811586Z                      Write-Host "    CPU: $cpu" -ForegroundColor Gray
2026-01-11T19:28:13.1812091Z                      Write-Host "    GPU: $gpu" -ForegroundColor Gray
2026-01-11T19:28:13.1813439Z                      Write-Host "    RAM: ${ram}GB" -ForegroundColor Gray
2026-01-11T19:28:13.1813764Z                      
2026-01-11T19:28:13.1814854Z                      # Win10 compatibility notice
2026-01-11T19:28:13.1815014Z                      if (-not $script:IsWin11) {
2026-01-11T19:28:13.1816357Z                          Write-Host ""
2026-01-11T19:28:13.1816966Z                          Write-Host "  ‚ö† Windows 10 detected - some Win11-only options will be skipped" 
2026-01-11T19:28:13.1817123Z                      -ForegroundColor Yellow
2026-01-11T19:28:13.1817522Z                      }
2026-01-11T19:28:13.1817624Z                      Write-Host ""
2026-01-11T19:28:13.1818168Z                      
2026-01-11T19:28:13.1819510Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.1819859Z                      # PRE-FLIGHT SCAN
2026-01-11T19:28:13.1821164Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.1821316Z                      
2026-01-11T19:28:13.1822321Z                      if ($optIds.Count -gt 0) {
2026-01-11T19:28:13.1823026Z                          Write-Host "  Scanning current system state..." -ForegroundColor Gray
2026-01-11T19:28:13.1823352Z                      
2026-01-11T19:28:13.1824420Z                          # Scan each selected optimization
2026-01-11T19:28:13.1824781Z                          foreach ($id in $optIds) {
2026-01-11T19:28:13.1824975Z                              $info = $OPT_DESCRIPTIONS[$id]
2026-01-11T19:28:13.1826172Z                              if (-not $info) { continue }
2026-01-11T19:28:13.1826507Z                      
2026-01-11T19:28:13.1827691Z                              $name = "[$($info.tier)] $($info.name)"
2026-01-11T19:28:13.1828299Z                              $current = "‚Äî"
2026-01-11T19:28:13.1828435Z                              $target = "Will apply"
2026-01-11T19:28:13.1830140Z                              $status = "PENDING"
2026-01-11T19:28:13.1830245Z                      
2026-01-11T19:28:13.1831021Z                              switch ($id) {
2026-01-11T19:28:13.1831744Z                                  '1' { # pagefile
2026-01-11T19:28:13.1832919Z                                      try {
2026-01-11T19:28:13.1833826Z                                          $cs = Get-WmiObject Win32_ComputerSystem
2026-01-11T19:28:13.1834120Z                                          if ($cs.AutomaticManagedPagefile) {
2026-01-11T19:28:13.1834290Z                                              $current = "Auto"
2026-01-11T19:28:13.1834643Z                                              $target = "Fixed size"
2026-01-11T19:28:13.1835337Z                                              $status = "CHANGE"
2026-01-11T19:28:13.1835971Z                                          } else {
2026-01-11T19:28:13.1836853Z                                              $current = "Fixed"
2026-01-11T19:28:13.1837589Z                                              $status = "OK"
2026-01-11T19:28:13.1838396Z                                          }
2026-01-11T19:28:13.1839095Z                                      } catch { }
2026-01-11T19:28:13.1839915Z                                  }
2026-01-11T19:28:13.1840713Z                                  '2' { # fastboot
2026-01-11T19:28:13.1840878Z                                      try {
2026-01-11T19:28:13.1842073Z                                          $val = Get-ItemProperty "HKLM:\SYSTEM\CurrentControlSet\Control\Session 
2026-01-11T19:28:13.1842640Z                      Manager\Power" -Name "HiberbootEnabled" -EA SilentlyContinue
2026-01-11T19:28:13.1843106Z                                          if ($val.HiberbootEnabled -eq 0) { $current = "OFF"; $status = "OK" }
2026-01-11T19:28:13.1844067Z                                          else { $current = "ON"; $target = "OFF"; $status = "CHANGE" }
2026-01-11T19:28:13.1844324Z                                      } catch { }
2026-01-11T19:28:13.1844863Z                                  }
2026-01-11T19:28:13.1845477Z                                  '10' { # gamedvr
2026-01-11T19:28:13.1846084Z                                      try {
2026-01-11T19:28:13.1846823Z                                          $val = Get-ItemProperty "HKCU:\System\GameConfigStore" -Name 
2026-01-11T19:28:13.1847124Z                      "GameDVR_Enabled" -EA SilentlyContinue
2026-01-11T19:28:13.1848643Z                                          if ($val.GameDVR_Enabled -eq 0) { $current = "OFF"; $status = "OK" }
2026-01-11T19:28:13.1848959Z                                          else { $current = "ON"; $target = "OFF"; $status = "CHANGE" }
2026-01-11T19:28:13.1849084Z                                      } catch { }
2026-01-11T19:28:13.1849481Z                                  }
2026-01-11T19:28:13.1850286Z                                  '11' { # background_apps
2026-01-11T19:28:13.1850403Z                                      try {
2026-01-11T19:28:13.1851122Z                                          $val = Get-ItemProperty 
2026-01-11T19:28:13.1851909Z                      "HKCU:\Software\Microsoft\Windows\CurrentVersion\BackgroundAccessApplications" -Name 
2026-01-11T19:28:13.1852120Z                      "GlobalUserDisabled" -EA SilentlyContinue
2026-01-11T19:28:13.1853207Z                                          if ($val.GlobalUserDisabled -eq 1) { $current = "OFF"; $status = "OK" }
2026-01-11T19:28:13.1854198Z                                          else { $current = "ON"; $target = "OFF"; $status = "CHANGE" }
2026-01-11T19:28:13.1855304Z                                      } catch { }
2026-01-11T19:28:13.1855653Z                                  }
2026-01-11T19:28:13.1856883Z                                  '13' { # copilot_disable
2026-01-11T19:28:13.1857973Z                                      try {
2026-01-11T19:28:13.1859375Z                                          $val = Get-ItemProperty 
2026-01-11T19:28:13.1860642Z                      "HKCU:\Software\Policies\Microsoft\Windows\WindowsCopilot" -Name "TurnOffWindowsCopilot" -EA 
2026-01-11T19:28:13.1860773Z                      SilentlyContinue
2026-01-11T19:28:13.1861966Z                                          if ($val.TurnOffWindowsCopilot -eq 1) { $current = "OFF"; $status = "OK" }
2026-01-11T19:28:13.1862549Z                                          else { $current = "ON"; $target = "OFF"; $status = "CHANGE" }
2026-01-11T19:28:13.1863009Z                                      } catch { }
2026-01-11T19:28:13.1863541Z                                  }
2026-01-11T19:28:13.1864538Z                                  '21' { # end_task
2026-01-11T19:28:13.1864658Z                                      try {
2026-01-11T19:28:13.1866075Z                                          $val = Get-ItemProperty 
2026-01-11T19:28:13.1866836Z                      "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced\TaskbarDeveloperSettings" 
2026-01-11T19:28:13.1867240Z                      -Name "TaskbarEndTask" -EA SilentlyContinue
2026-01-11T19:28:13.1868315Z                                          if ($val.TaskbarEndTask -eq 1) { $current = "ON"; $status = "OK" }
2026-01-11T19:28:13.1868607Z                                          else { $current = "OFF"; $target = "ON"; $status = "CHANGE" }
2026-01-11T19:28:13.1869584Z                                      } catch { }
2026-01-11T19:28:13.1870184Z                                  }
2026-01-11T19:28:13.1871467Z                                  '23' { # notifications_off
2026-01-11T19:28:13.1871824Z                                      try {
2026-01-11T19:28:13.1873091Z                                          $val = Get-ItemProperty "HKCU:\Software\Policies\Microsoft\Windows\Explorer" 
2026-01-11T19:28:13.1873383Z                      -Name "DisableNotificationCenter" -EA SilentlyContinue
2026-01-11T19:28:13.1874746Z                                          if ($val.DisableNotificationCenter -eq 1) { $current = "OFF"; $status = "OK" }
2026-01-11T19:28:13.1875053Z                                          else { $current = "ON"; $target = "OFF"; $status = "CHANGE" }
2026-01-11T19:28:13.1875183Z                                      } catch { }
2026-01-11T19:28:13.1875760Z                                  }
2026-01-11T19:28:13.1876854Z                                  '26' { # mouse_accel
2026-01-11T19:28:13.1877304Z                                      try {
2026-01-11T19:28:13.1878730Z                                          $val = Get-ItemProperty "HKCU:\Control Panel\Mouse" -Name "MouseSpeed" -EA 
2026-01-11T19:28:13.1878886Z                      SilentlyContinue
2026-01-11T19:28:13.1880234Z                                          if ($val.MouseSpeed -eq "0") { $current = "OFF"; $status = "OK" }
2026-01-11T19:28:13.1880508Z                                          else { $current = "ON"; $target = "OFF"; $status = "CHANGE" }
2026-01-11T19:28:13.1880637Z                                      } catch { }
2026-01-11T19:28:13.1881335Z                                  }
2026-01-11T19:28:13.1882068Z                                  '28' { # keyboard_response
2026-01-11T19:28:13.1882963Z                                      try {
2026-01-11T19:28:13.1884282Z                                          $val = Get-ItemProperty "HKCU:\Control Panel\Keyboard" -Name "KeyboardDelay" 
2026-01-11T19:28:13.1884419Z                      -EA SilentlyContinue
2026-01-11T19:28:13.1885581Z                                          if ($val.KeyboardDelay -eq "0") { $current = "0ms"; $status = "OK" }
2026-01-11T19:28:13.1885947Z                                          else { $current = "$($val.KeyboardDelay)"; $target = "0ms"; $status = 
2026-01-11T19:28:13.1886855Z                      "CHANGE" }
2026-01-11T19:28:13.1887504Z                                      } catch { }
2026-01-11T19:28:13.1888642Z                                  }
2026-01-11T19:28:13.1888809Z                                  '29' { # game_mode
2026-01-11T19:28:13.1889741Z                                      try {
2026-01-11T19:28:13.1890660Z                                          $val = Get-ItemProperty "HKCU:\Software\Microsoft\GameBar" -Name 
2026-01-11T19:28:13.1891684Z                      "AutoGameModeEnabled" -EA SilentlyContinue
2026-01-11T19:28:13.1892648Z                                          if ($val.AutoGameModeEnabled -eq 1) { $current = "ON"; $status = "OK" }
2026-01-11T19:28:13.1893046Z                                          else { $current = "OFF"; $target = "ON"; $status = "CHANGE" }
2026-01-11T19:28:13.1893337Z                                      } catch { }
2026-01-11T19:28:13.1894386Z                                  }
2026-01-11T19:28:13.1895108Z                                  '52' { # game_bar
2026-01-11T19:28:13.1896010Z                                      try {
2026-01-11T19:28:13.1897267Z                                          $val = Get-ItemProperty "HKCU:\Software\Microsoft\GameBar" -Name 
2026-01-11T19:28:13.1897651Z                      "ShowStartupPanel" -EA SilentlyContinue
2026-01-11T19:28:13.1899016Z                                          if ($val.ShowStartupPanel -eq 0) { $current = "OFF"; $status = "OK" }
2026-01-11T19:28:13.1899313Z                                          else { $current = "ON"; $target = "OFF"; $status = "CHANGE" }
2026-01-11T19:28:13.1900444Z                                      } catch { }
2026-01-11T19:28:13.1900557Z                                  }
2026-01-11T19:28:13.1901387Z                                  '53' { # hags
2026-01-11T19:28:13.1901752Z                                      try {
2026-01-11T19:28:13.1902881Z                                          $val = Get-ItemProperty 
2026-01-11T19:28:13.1905048Z                      "HKLM:\SYSTEM\CurrentControlSet\Control\GraphicsDrivers" -Name "HwSchMode" -EA SilentlyContinue
2026-01-11T19:28:13.1905573Z                                          if ($val.HwSchMode -eq 2) { $current = "ON"; $status = "OK" }
2026-01-11T19:28:13.1906102Z                                          else { $current = "OFF"; $target = "ON"; $status = "CHANGE" }
2026-01-11T19:28:13.1906258Z                                      } catch { }
2026-01-11T19:28:13.1907199Z                                  }
2026-01-11T19:28:13.1907459Z                                  '54' { # fso_disable
2026-01-11T19:28:13.1908247Z                                      try {
2026-01-11T19:28:13.1909291Z                                          $val = Get-ItemProperty "HKCU:\System\GameConfigStore" -Name 
2026-01-11T19:28:13.1909563Z                      "GameDVR_FSEBehaviorMode" -EA SilentlyContinue
2026-01-11T19:28:13.1910583Z                                          if ($val.GameDVR_FSEBehaviorMode -eq 2) { $current = "OFF"; $status = "OK" }
2026-01-11T19:28:13.1911002Z                                          else { $current = "ON"; $target = "OFF"; $status = "CHANGE" }
2026-01-11T19:28:13.1911169Z                                      } catch { }
2026-01-11T19:28:13.1912238Z                                  }
2026-01-11T19:28:13.1913289Z                                  '68' { # sysmain_disable
2026-01-11T19:28:13.1913673Z                                      try {
2026-01-11T19:28:13.1914602Z                                          $svc = Get-Service SysMain -EA SilentlyContinue
2026-01-11T19:28:13.1915349Z                                          if ($svc.StartType -eq 'Disabled') { $current = "OFF"; $status = "OK" }
2026-01-11T19:28:13.1915744Z                                          else { $current = "ON"; $target = "OFF"; $status = "CHANGE" }
2026-01-11T19:28:13.1915874Z                                      } catch { }
2026-01-11T19:28:13.1916648Z                                  }
2026-01-11T19:28:13.1917778Z                                  '69' { # services_search_off
2026-01-11T19:28:13.1917898Z                                      try {
2026-01-11T19:28:13.1919378Z                                          $svc = Get-Service WSearch -EA SilentlyContinue
2026-01-11T19:28:13.1920458Z                                          if ($svc.StartType -eq 'Manual' -or $svc.StartType -eq 'Disabled') { $current 
2026-01-11T19:28:13.1920779Z                      = "Manual"; $status = "OK" }
2026-01-11T19:28:13.1921342Z                                          else { $current = "Auto"; $target = "Manual"; $status = "CHANGE" }
2026-01-11T19:28:13.1921751Z                                      } catch { }
2026-01-11T19:28:13.1922172Z                                  }
2026-01-11T19:28:13.1922604Z                                  '80' { # privacy_tier1
2026-01-11T19:28:13.1923481Z                                      try {
2026-01-11T19:28:13.1924342Z                                          $val = Get-ItemProperty 
2026-01-11T19:28:13.1924856Z                      "HKCU:\Software\Microsoft\Windows\CurrentVersion\AdvertisingInfo" -Name "Enabled" -EA 
2026-01-11T19:28:13.1925246Z                      SilentlyContinue
2026-01-11T19:28:13.1926393Z                                          if ($val.Enabled -eq 0) { $current = "OFF"; $status = "OK" }
2026-01-11T19:28:13.1927052Z                                          else { $current = "ON"; $target = "OFF"; $status = "CHANGE" }
2026-01-11T19:28:13.1927197Z                                      } catch { }
2026-01-11T19:28:13.1928116Z                                  }
2026-01-11T19:28:13.1928331Z                                  '81' { # privacy_tier2
2026-01-11T19:28:13.1929326Z                                      try {
2026-01-11T19:28:13.1930524Z                                          $val = Get-ItemProperty 
2026-01-11T19:28:13.1931220Z                      "HKLM:\SOFTWARE\Policies\Microsoft\Windows\DataCollection" -Name "AllowTelemetry" -EA 
2026-01-11T19:28:13.1931358Z                      SilentlyContinue
2026-01-11T19:28:13.1931774Z                                          if ($val.AllowTelemetry -eq 0) { $current = "Minimal"; $status = "OK" }
2026-01-11T19:28:13.1933345Z                                          else { $current = "Full"; $target = "Minimal"; $status = "CHANGE" }
2026-01-11T19:28:13.1933513Z                                      } catch { }
2026-01-11T19:28:13.1933667Z                                  }
2026-01-11T19:28:13.1934842Z                                  '85' { # teredo_disable
2026-01-11T19:28:13.1934970Z                                      try {
2026-01-11T19:28:13.1935725Z                                          $teredo = netsh interface teredo show state 2>$null | Select-String "Type"
2026-01-11T19:28:13.1936902Z                                          if ($teredo -match "disabled") { $current = "OFF"; $status = "OK" }
2026-01-11T19:28:13.1937419Z                                          else { $current = "ON"; $target = "OFF"; $status = "CHANGE" }
2026-01-11T19:28:13.1938238Z                                      } catch { }
2026-01-11T19:28:13.1938342Z                                  }
2026-01-11T19:28:13.1939741Z                                  '104' { # background_polling
2026-01-11T19:28:13.1940272Z                                      try {
2026-01-11T19:28:13.1941355Z                                          $val = Get-ItemProperty "HKCU:\Control Panel\Mouse" -Name 
2026-01-11T19:28:13.1942026Z                      "RawMouseThrottleEnabled" -EA SilentlyContinue
2026-01-11T19:28:13.1943578Z                                          if ($val.RawMouseThrottleEnabled -eq 0) { $current = "Unlocked"; $status = 
2026-01-11T19:28:13.1943980Z                      "OK" }
2026-01-11T19:28:13.1944379Z                                          else { $current = "Throttled"; $target = "Unlocked"; $status = "CHANGE" }
2026-01-11T19:28:13.1944546Z                                      } catch { }
2026-01-11T19:28:13.1944770Z                                  }
2026-01-11T19:28:13.1945864Z                                  '105' { # amd_ulps_disable
2026-01-11T19:28:13.1946575Z                                      $current = "Check GPU"; $target = "Disabled"; $status = "PENDING"
2026-01-11T19:28:13.1947029Z                                  }
2026-01-11T19:28:13.1948033Z                                  '106' { # nvidia_p0_state
2026-01-11T19:28:13.1949593Z                                      $current = "Check GPU"; $target = "P0 Forced"; $status = "PENDING"
2026-01-11T19:28:13.1950046Z                                  }
2026-01-11T19:28:13.1950305Z                                  '107' { # network_binding_strip
2026-01-11T19:28:13.1951511Z                                      $current = "Multiple"; $target = "IPv4 Only"; $status = "PENDING"
2026-01-11T19:28:13.1951968Z                                  }
2026-01-11T19:28:13.1953027Z                                  '7' { # dns - special handling
2026-01-11T19:28:13.1953486Z                                      if ($dnsId -and $DNS_MAP[$dnsId]) {
2026-01-11T19:28:13.1954782Z                                          $dns = $DNS_MAP[$dnsId]
2026-01-11T19:28:13.1954965Z                                          $name = "[SAFE] DNS Provider"
2026-01-11T19:28:13.1955912Z                                          $target = $dns.name
2026-01-11T19:28:13.1956178Z                                          try {
2026-01-11T19:28:13.1958319Z                                              $adapter = Get-NetAdapter | Where-Object {$_.Status -eq "Up"} | 
2026-01-11T19:28:13.1958566Z                      Select-Object -First 1
2026-01-11T19:28:13.1959532Z                                              if ($adapter) {
2026-01-11T19:28:13.1961303Z                                                  $dnsServers = (Get-DnsClientServerAddress -InterfaceIndex 
2026-01-11T19:28:13.1961501Z                      $adapter.InterfaceIndex -AddressFamily IPv4).ServerAddresses
2026-01-11T19:28:13.1963039Z                                                  if ($dnsServers -contains $dns.primary) { $current = $dns.name; 
2026-01-11T19:28:13.1963184Z                      $status = "OK" }
2026-01-11T19:28:13.1963425Z                                                  else { $current = "Other"; $status = "CHANGE" }
2026-01-11T19:28:13.1964303Z                                              }
2026-01-11T19:28:13.1965129Z                                          } catch { }
2026-01-11T19:28:13.1965578Z                                      }
2026-01-11T19:28:13.1966536Z                                  }
2026-01-11T19:28:13.1966805Z                              }
2026-01-11T19:28:13.1968055Z                      
2026-01-11T19:28:13.1968275Z                              Add-ScanResult $name $current $target $status
2026-01-11T19:28:13.1969496Z                          }
2026-01-11T19:28:13.1969612Z                      
2026-01-11T19:28:13.1970294Z                          Write-ScanResults
2026-01-11T19:28:13.1971374Z                      }
2026-01-11T19:28:13.1996691Z                      
2026-01-11T19:28:13.1997424Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.1997609Z                      # INTERACTIVE APPROVAL MODE
2026-01-11T19:28:13.1998244Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.1998363Z                      
2026-01-11T19:28:13.1998503Z                      function Get-TierColor {
2026-01-11T19:28:13.1998645Z                          param([string]$Tier)
2026-01-11T19:28:13.1998754Z                          switch ($Tier) {
2026-01-11T19:28:13.1998883Z                              'SAFE'    { 'Green' }
2026-01-11T19:28:13.1999021Z                              'CAUTION' { 'Yellow' }
2026-01-11T19:28:13.1999132Z                              'RISKY'   { 'Red' }
2026-01-11T19:28:13.1999249Z                              default   { 'Gray' }
2026-01-11T19:28:13.1999336Z                          }
2026-01-11T19:28:13.1999412Z                      }
2026-01-11T19:28:13.1999494Z                      
2026-01-11T19:28:13.1999661Z                      function Show-OptimizationPrompt {
2026-01-11T19:28:13.1999868Z                          param([string]$Id, [int]$Current, [int]$Total)
2026-01-11T19:28:13.1999951Z                      
2026-01-11T19:28:13.2000099Z                          $info = $OPT_DESCRIPTIONS[$Id]
2026-01-11T19:28:13.2000208Z                          if (-not $info) {
2026-01-11T19:28:13.2000853Z                              $info = @{ name="Unknown ($Id)"; tier='UNKNOWN'; desc='No description available' }
2026-01-11T19:28:13.2000997Z                          }
2026-01-11T19:28:13.2001090Z                      
2026-01-11T19:28:13.2001332Z                          $tierColor = Get-TierColor $info.tier
2026-01-11T19:28:13.2001428Z                      
2026-01-11T19:28:13.2001546Z                          Write-Host ""
2026-01-11T19:28:13.2001865Z                          Write-Host "  [$Current/$Total] " -NoNewline -ForegroundColor DarkGray
2026-01-11T19:28:13.2002108Z                          Write-Host $info.name -NoNewline -ForegroundColor White
2026-01-11T19:28:13.2002331Z                          Write-Host " [" -NoNewline -ForegroundColor DarkGray
2026-01-11T19:28:13.2002608Z                          Write-Host $info.tier -NoNewline -ForegroundColor $tierColor
2026-01-11T19:28:13.2002804Z                          Write-Host "]" -ForegroundColor DarkGray
2026-01-11T19:28:13.2003025Z                          Write-Host "  $($info.desc)" -ForegroundColor Gray
2026-01-11T19:28:13.2003140Z                          Write-Host ""
2026-01-11T19:28:13.2003562Z                          Write-Host "  Apply? [Y]es / [N]o / [A]ll remaining / [Q]uit: " -NoNewline -ForegroundColor 
2026-01-11T19:28:13.2004046Z                      Cyan
2026-01-11T19:28:13.2004149Z                      }
2026-01-11T19:28:13.2004240Z                      
2026-01-11T19:28:13.2004373Z                      # Execute optimizations
2026-01-11T19:28:13.2004519Z                      if ($optIds.Count -gt 0) {
2026-01-11T19:28:13.2004648Z                          Write-Step "Upgrades"
2026-01-11T19:28:13.2004742Z                          Write-Host ""
2026-01-11T19:28:13.2005362Z                          Write-Host "  ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó" 
2026-01-11T19:28:13.2005507Z                      -ForegroundColor White
2026-01-11T19:28:13.2006121Z                          Write-Host "  ‚ïë  INTERACTIVE MODE - Review each optimization before applying   ‚ïë" 
2026-01-11T19:28:13.2006263Z                      -ForegroundColor White
2026-01-11T19:28:13.2006814Z                          Write-Host "  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù" 
2026-01-11T19:28:13.2006953Z                      -ForegroundColor White
2026-01-11T19:28:13.2007707Z                          Write-Host ""
2026-01-11T19:28:13.2008215Z                          Write-Host "  This loadout contains $($optIds.Count) optimization(s)." -ForegroundColor Gray
2026-01-11T19:28:13.2008597Z                          Write-Host "  You will be prompted to approve each one." -ForegroundColor Gray
2026-01-11T19:28:13.2008710Z                          Write-Host ""
2026-01-11T19:28:13.2008925Z                          Write-Host "  Tier legend:" -ForegroundColor White
2026-01-11T19:28:13.2009631Z                          Write-Host "    SAFE    - " -NoNewline; Write-Host "Low risk, recommended for everyone" 
2026-01-11T19:28:13.2009780Z                      -ForegroundColor Green
2026-01-11T19:28:13.2010219Z                          Write-Host "    CAUTION - " -NoNewline; Write-Host "May affect some features, test after" 
2026-01-11T19:28:13.2010360Z                      -ForegroundColor Yellow
2026-01-11T19:28:13.2010805Z                          Write-Host "    RISKY   - " -NoNewline; Write-Host "May break features, know what you're 
2026-01-11T19:28:13.2011009Z                      doing" -ForegroundColor Red
2026-01-11T19:28:13.2012091Z                          Write-Host ""
2026-01-11T19:28:13.2012638Z                      
2026-01-11T19:28:13.2013328Z                          $autoApprove = $false
2026-01-11T19:28:13.2014163Z                          $consecutiveYes = 0  # Track consecutive Y responses for smart auto-All
2026-01-11T19:28:13.2014806Z                          $approvedIds = @()
2026-01-11T19:28:13.2015962Z                          $skippedIds = @()
2026-01-11T19:28:13.2017430Z                          $quit = $false
2026-01-11T19:28:13.2018143Z                          $current = 0
2026-01-11T19:28:13.2019211Z                          $total = $optIds.Count
2026-01-11T19:28:13.2019963Z                      
2026-01-11T19:28:13.2021060Z                          # Handle DNS separately if specified
2026-01-11T19:28:13.2021353Z                          if ($dnsId -and $DNS_MAP[$dnsId] -and ($optIds -contains '7')) {
2026-01-11T19:28:13.2021495Z                              $current++
2026-01-11T19:28:13.2022682Z                              $dns = $DNS_MAP[$dnsId]
2026-01-11T19:28:13.2023223Z                              if (-not $autoApprove) {
2026-01-11T19:28:13.2024117Z                                  Write-Host ""
2026-01-11T19:28:13.2024466Z                                  Write-Host "  [$current/$total] " -NoNewline -ForegroundColor DarkGray
2026-01-11T19:28:13.2025464Z                                  Write-Host "DNS Provider" -NoNewline -ForegroundColor White
2026-01-11T19:28:13.2025745Z                                  Write-Host " [" -NoNewline -ForegroundColor DarkGray
2026-01-11T19:28:13.2026733Z                                  Write-Host "SAFE" -NoNewline -ForegroundColor Green
2026-01-11T19:28:13.2027187Z                                  Write-Host "]" -ForegroundColor DarkGray
2026-01-11T19:28:13.2028485Z                                  Write-Host "  Set DNS to $($dns.name) ($($dns.primary), $($dns.secondary))" 
2026-01-11T19:28:13.2028664Z                      -ForegroundColor Gray
2026-01-11T19:28:13.2029677Z                                  Write-Host ""
2026-01-11T19:28:13.2031266Z                                  Write-Host "  Apply? [Y]es / [N]o / [A]ll remaining / [Q]uit: " -NoNewline 
2026-01-11T19:28:13.2031440Z                      -ForegroundColor Cyan
2026-01-11T19:28:13.2031632Z                                  $response = Read-Host
2026-01-11T19:28:13.2032484Z                              } else {
2026-01-11T19:28:13.2032642Z                                  $response = 'y'
2026-01-11T19:28:13.2033431Z                              }
2026-01-11T19:28:13.2034449Z                      
2026-01-11T19:28:13.2035202Z                              switch ($response.ToLower()) {
2026-01-11T19:28:13.2035971Z                                  'a' { $autoApprove = $true; $response = 'y' }
2026-01-11T19:28:13.2036821Z                                  'q' { $quit = $true }
2026-01-11T19:28:13.2037385Z                                  'n' { $consecutiveYes = 0 }  # Reset on skip
2026-01-11T19:28:13.2038283Z                              }
2026-01-11T19:28:13.2039130Z                      
2026-01-11T19:28:13.2039743Z                              if (-not $quit -and $response.ToLower() -eq 'y') {
2026-01-11T19:28:13.2039967Z                                  $consecutiveYes++
2026-01-11T19:28:13.2041336Z                                  # Smart Auto-All: after 3 consecutive Y, auto-approve remaining
2026-01-11T19:28:13.2041597Z                                  if ($consecutiveYes -ge 3 -and -not $autoApprove) {
2026-01-11T19:28:13.2041810Z                                      $autoApprove = $true
2026-01-11T19:28:13.2042868Z                                      $remaining = $total - $current
2026-01-11T19:28:13.2043571Z                                      Write-Host ""
2026-01-11T19:28:13.2044958Z                                      Write-Host "  $([char]0x2192) Auto-applying remaining $remaining optimizations (3 
2026-01-11T19:28:13.2045182Z                      consecutive approvals)" -ForegroundColor Cyan
2026-01-11T19:28:13.2046334Z                                      Write-Host "  $([char]0x2192) Press Ctrl+C to abort if needed" -ForegroundColor 
2026-01-11T19:28:13.2046472Z                      DarkGray
2026-01-11T19:28:13.2047774Z                                      Write-Host ""
2026-01-11T19:28:13.2047917Z                                  }
2026-01-11T19:28:13.2049512Z                                  Get-NetAdapter | Where-Object {$_.Status -eq "Up"} | Set-DnsClientServerAddress 
2026-01-11T19:28:13.2049978Z                      -ServerAddresses $dns.primary,$dns.secondary
2026-01-11T19:28:13.2050160Z                                  Write-OK "DNS set to $($dns.name)"
2026-01-11T19:28:13.2050456Z                                  $approvedIds += '7'
2026-01-11T19:28:13.2050932Z                              } else {
2026-01-11T19:28:13.2051839Z                                  $skippedIds += '7'
2026-01-11T19:28:13.2052777Z                                  if (-not $quit) { Write-Host "  [SKIP] DNS" -ForegroundColor DarkGray }
2026-01-11T19:28:13.2052964Z                              }
2026-01-11T19:28:13.2054226Z                          }
2026-01-11T19:28:13.2054365Z                      
2026-01-11T19:28:13.2055075Z                          foreach ($id in $optIds) {
2026-01-11T19:28:13.2056270Z                              if ($quit) { break }
2026-01-11T19:28:13.2056536Z                              if ($id -eq '7') { continue } # Skip DNS, handled above
2026-01-11T19:28:13.2057520Z                      
2026-01-11T19:28:13.2058370Z                              $current++
2026-01-11T19:28:13.2058726Z                      
2026-01-11T19:28:13.2059934Z                              if (-not $OPT_FUNCTIONS.ContainsKey($id)) {
2026-01-11T19:28:13.2060164Z                                  Write-Warn "Unknown optimization ID: $id (skipped)"
2026-01-11T19:28:13.2061120Z                                  continue
2026-01-11T19:28:13.2062209Z                              }
2026-01-11T19:28:13.2062318Z                      
2026-01-11T19:28:13.2063196Z                              # Skip Win11-only features on Win10
2026-01-11T19:28:13.2063506Z                              if (-not $script:IsWin11 -and $id -in $script:Win11OnlyIds) {
2026-01-11T19:28:13.2064581Z                                  $info = $OPT_DESCRIPTIONS[$id]
2026-01-11T19:28:13.2065464Z                                  $name = if ($info) { $info.name } else { $id }
2026-01-11T19:28:13.2065862Z                                  Write-Host "  [SKIP] $name (requires Windows 11)" -ForegroundColor DarkGray
2026-01-11T19:28:13.2066046Z                                  $skippedIds += $id
2026-01-11T19:28:13.2066408Z                                  continue
2026-01-11T19:28:13.2067409Z                              }
2026-01-11T19:28:13.2067511Z                      
2026-01-11T19:28:13.2068790Z                              # Skip Win11 24H2+ features on older builds
2026-01-11T19:28:13.2069146Z                              if (-not $script:IsWin11_24H2 -and $id -in $script:Win11_24H2OnlyIds) {
2026-01-11T19:28:13.2069599Z                                  $info = $OPT_DESCRIPTIONS[$id]
2026-01-11T19:28:13.2070312Z                                  $name = if ($info) { $info.name } else { $id }
2026-01-11T19:28:13.2071682Z                                  Write-Host "  [SKIP] $name (requires Windows 11 24H2+)" -ForegroundColor DarkGray
2026-01-11T19:28:13.2071852Z                                  $skippedIds += $id
2026-01-11T19:28:13.2072844Z                                  continue
2026-01-11T19:28:13.2072979Z                              }
2026-01-11T19:28:13.2074053Z                      
2026-01-11T19:28:13.2075044Z                              if (-not $autoApprove) {
2026-01-11T19:28:13.2076488Z                                  Show-OptimizationPrompt -Id $id -Current $current -Total $total
2026-01-11T19:28:13.2076634Z                                  $response = Read-Host
2026-01-11T19:28:13.2077539Z                              } else {
2026-01-11T19:28:13.2078310Z                                  $response = 'y'
2026-01-11T19:28:13.2078417Z                              }
2026-01-11T19:28:13.2079613Z                      
2026-01-11T19:28:13.2079808Z                              switch ($response.ToLower()) {
2026-01-11T19:28:13.2080868Z                                  'a' { $autoApprove = $true; $response = 'y' }
2026-01-11T19:28:13.2081219Z                                  'q' { $quit = $true }
2026-01-11T19:28:13.2082511Z                                  'n' { $consecutiveYes = 0 }  # Reset on skip
2026-01-11T19:28:13.2082610Z                              }
2026-01-11T19:28:13.2083574Z                      
2026-01-11T19:28:13.2083833Z                              if (-not $quit -and $response.ToLower() -eq 'y') {
2026-01-11T19:28:13.2085029Z                                  $consecutiveYes++
2026-01-11T19:28:13.2085319Z                                  # Smart Auto-All: after 3 consecutive Y, auto-approve remaining
2026-01-11T19:28:13.2086487Z                                  if ($consecutiveYes -ge 3 -and -not $autoApprove) {
2026-01-11T19:28:13.2086673Z                                      $autoApprove = $true
2026-01-11T19:28:13.2087559Z                                      $remaining = $total - $current
2026-01-11T19:28:13.2088609Z                                      Write-Host ""
2026-01-11T19:28:13.2089024Z                                      Write-Host "  $([char]0x2192) Auto-applying remaining $remaining optimizations (3 
2026-01-11T19:28:13.2090611Z                      consecutive approvals)" -ForegroundColor Cyan
2026-01-11T19:28:13.2091192Z                                      Write-Host "  $([char]0x2192) Press Ctrl+C to abort if needed" -ForegroundColor 
2026-01-11T19:28:13.2091621Z                      DarkGray
2026-01-11T19:28:13.2092509Z                                      Write-Host ""
2026-01-11T19:28:13.2093257Z                                  }
2026-01-11T19:28:13.2094193Z                                  try {
2026-01-11T19:28:13.2094370Z                                      & $OPT_FUNCTIONS[$id]
2026-01-11T19:28:13.2095758Z                                      $approvedIds += $id
2026-01-11T19:28:13.2096218Z                                  } catch {
2026-01-11T19:28:13.2096871Z                                      Write-Fail "Optimization $id failed: $($_.Exception.Message)"
2026-01-11T19:28:13.2097707Z                                  }
2026-01-11T19:28:13.2097826Z                              } else {
2026-01-11T19:28:13.2099181Z                                  $skippedIds += $id
2026-01-11T19:28:13.2099635Z                                  if (-not $quit) {
2026-01-11T19:28:13.2100569Z                                      $info = $OPT_DESCRIPTIONS[$id]
2026-01-11T19:28:13.2101088Z                                      $name = if ($info) { $info.name } else { $id }
2026-01-11T19:28:13.2101586Z                                      Write-Host "  [SKIP] $name" -ForegroundColor DarkGray
2026-01-11T19:28:13.2102484Z                                  }
2026-01-11T19:28:13.2103320Z                              }
2026-01-11T19:28:13.2103426Z                          }
2026-01-11T19:28:13.2104543Z                      
2026-01-11T19:28:13.2105761Z                          # Show approval summary
2026-01-11T19:28:13.2106501Z                          Write-Host ""
2026-01-11T19:28:13.2107194Z                          Write-Host "  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ" -ForegroundColor DarkGray
2026-01-11T19:28:13.2108941Z                          Write-Host "  Applied: $($approvedIds.Count) | Skipped: $($skippedIds.Count)" 
2026-01-11T19:28:13.2109646Z                      -ForegroundColor Gray
2026-01-11T19:28:13.2111021Z                          if ($quit) { Write-Host "  (User quit early)" -ForegroundColor Yellow }
2026-01-11T19:28:13.2111165Z                      }
2026-01-11T19:28:13.2112270Z                      
2026-01-11T19:28:13.2112410Z                      # Install packages
2026-01-11T19:28:13.2114263Z                      if ($pkgKeys.Count -gt 0) {
2026-01-11T19:28:13.2114428Z                          Write-Step "Arsenal (winget)"
2026-01-11T19:28:13.2114550Z                          Write-Host ""
2026-01-11T19:28:13.2115875Z                          Write-Host "  ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó" 
2026-01-11T19:28:13.2116307Z                      -ForegroundColor White
2026-01-11T19:28:13.2116991Z                          Write-Host "  ‚ïë  PACKAGE INSTALLATION - Review each software before install    ‚ïë" 
2026-01-11T19:28:13.2117159Z                      -ForegroundColor White
2026-01-11T19:28:13.2118568Z                          Write-Host "  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù" 
2026-01-11T19:28:13.2118697Z                      -ForegroundColor White
2026-01-11T19:28:13.2119028Z                          Write-Host ""
2026-01-11T19:28:13.2120618Z                          Write-Host "  This loadout includes $($pkgKeys.Count) package(s) to install via winget." 
2026-01-11T19:28:13.2121141Z                      -ForegroundColor Gray
2026-01-11T19:28:13.2121864Z                          Write-Host ""
2026-01-11T19:28:13.2122560Z                      
2026-01-11T19:28:13.2122809Z                          $wingetPath = Get-Command winget -EA SilentlyContinue
2026-01-11T19:28:13.2123876Z                          if (-not $wingetPath) {
2026-01-11T19:28:13.2124694Z                              Write-Fail "winget not found. Install App Installer from Microsoft Store."
2026-01-11T19:28:13.2125043Z                          } else {
2026-01-11T19:28:13.2125837Z                              $pkgAutoApprove = $false
2026-01-11T19:28:13.2126505Z                              $pkgConsecutiveYes = 0  # Track consecutive Y responses for smart auto-All
2026-01-11T19:28:13.2128050Z                              $installedPkgs = @()
2026-01-11T19:28:13.2128181Z                              $skippedPkgs = @()
2026-01-11T19:28:13.2128311Z                              $pkgQuit = $false
2026-01-11T19:28:13.2128651Z                              $pkgCurrent = 0
2026-01-11T19:28:13.2129069Z                              $pkgTotal = $pkgKeys.Count
2026-01-11T19:28:13.2129406Z                      
2026-01-11T19:28:13.2130071Z                              foreach ($key in $pkgKeys) {
2026-01-11T19:28:13.2130576Z                                  if ($pkgQuit) { break }
2026-01-11T19:28:13.2131351Z                                  $pkgCurrent++
2026-01-11T19:28:13.2131669Z                      
2026-01-11T19:28:13.2132936Z                                  if (-not $PACKAGE_MAP.ContainsKey($key)) {
2026-01-11T19:28:13.2133279Z                                      Write-Warn "Unknown package: $key (skipped)"
2026-01-11T19:28:13.2134120Z                                      continue
2026-01-11T19:28:13.2134236Z                                  }
2026-01-11T19:28:13.2134325Z                      
2026-01-11T19:28:13.2135046Z                                  $pkg = $PACKAGE_MAP[$key]
2026-01-11T19:28:13.2135814Z                      
2026-01-11T19:28:13.2136002Z                                  if (-not $pkgAutoApprove) {
2026-01-11T19:28:13.2137148Z                                      Write-Host ""
2026-01-11T19:28:13.2137805Z                                      Write-Host "  [$pkgCurrent/$pkgTotal] " -NoNewline -ForegroundColor DarkGray
2026-01-11T19:28:13.2138118Z                                      Write-Host $pkg.name -NoNewline -ForegroundColor White
2026-01-11T19:28:13.2138387Z                                      Write-Host " [" -NoNewline -ForegroundColor DarkGray
2026-01-11T19:28:13.2138737Z                                      Write-Host "SOFTWARE" -NoNewline -ForegroundColor Cyan
2026-01-11T19:28:13.2139614Z                                      Write-Host "]" -ForegroundColor DarkGray
2026-01-11T19:28:13.2140475Z                                      Write-Host "  winget: $($pkg.id)" -ForegroundColor Gray
2026-01-11T19:28:13.2140662Z                                      Write-Host ""
2026-01-11T19:28:13.2142067Z                                      Write-Host "  Install? [Y]es / [N]o / [A]ll remaining / [Q]uit: " -NoNewline 
2026-01-11T19:28:13.2142357Z                      -ForegroundColor Cyan
2026-01-11T19:28:13.2143397Z                                      $pkgResponse = Read-Host
2026-01-11T19:28:13.2143532Z                                  } else {
2026-01-11T19:28:13.2144557Z                                      $pkgResponse = 'y'
2026-01-11T19:28:13.2144653Z                                  }
2026-01-11T19:28:13.2145132Z                      
2026-01-11T19:28:13.2146351Z                                  switch ($pkgResponse.ToLower()) {
2026-01-11T19:28:13.2146907Z                                      'a' { $pkgAutoApprove = $true; $pkgResponse = 'y' }
2026-01-11T19:28:13.2147228Z                                      'q' { $pkgQuit = $true }
2026-01-11T19:28:13.2147438Z                                      'n' { $pkgConsecutiveYes = 0 }  # Reset on skip
2026-01-11T19:28:13.2149216Z                                  }
2026-01-11T19:28:13.2149512Z                      
2026-01-11T19:28:13.2150437Z                                  if (-not $pkgQuit -and $pkgResponse.ToLower() -eq 'y') {
2026-01-11T19:28:13.2152011Z                                      $pkgConsecutiveYes++
2026-01-11T19:28:13.2153119Z                                      # Smart Auto-All: after 3 consecutive Y, auto-approve remaining
2026-01-11T19:28:13.2153715Z                                      if ($pkgConsecutiveYes -ge 3 -and -not $pkgAutoApprove) {
2026-01-11T19:28:13.2154446Z                                          $pkgAutoApprove = $true
2026-01-11T19:28:13.2154652Z                                          $remaining = $pkgTotal - $pkgCurrent
2026-01-11T19:28:13.2155248Z                                          Write-Host ""
2026-01-11T19:28:13.2156376Z                                          Write-Host "  $([char]0x2192) Auto-installing remaining $remaining packages 
2026-01-11T19:28:13.2156818Z                      (3 consecutive approvals)" -ForegroundColor Cyan
2026-01-11T19:28:13.2157689Z                                          Write-Host "  $([char]0x2192) Press Ctrl+C to abort if needed" 
2026-01-11T19:28:13.2158496Z                      -ForegroundColor DarkGray
2026-01-11T19:28:13.2159247Z                                          Write-Host ""
2026-01-11T19:28:13.2159854Z                                      }
2026-01-11T19:28:13.2160526Z                                      Write-Host "  Installing $($pkg.name)..." -NoNewline
2026-01-11T19:28:13.2161253Z                                      $installOutput = winget install --id "$($pkg.id)" --silent 
2026-01-11T19:28:13.2161777Z                      --accept-package-agreements --accept-source-agreements 2>&1
2026-01-11T19:28:13.2162350Z                                      if ($LASTEXITCODE -eq 0) { Write-OK ""; $installedPkgs += $key }
2026-01-11T19:28:13.2163420Z                                      elseif ($installOutput -match "No available upgrade found|No newer package 
2026-01-11T19:28:13.2164312Z                      versions are available|already installed") { Write-OK "Already installed"; $installedPkgs += $key 
2026-01-11T19:28:13.2164416Z                      }
2026-01-11T19:28:13.2165828Z                                      else { Write-Fail ""; $installOutput | ForEach-Object { Write-Host "    $_" 
2026-01-11T19:28:13.2166017Z                      -ForegroundColor DarkGray } }
2026-01-11T19:28:13.2166723Z                                  } else {
2026-01-11T19:28:13.2167728Z                                      $skippedPkgs += $key
2026-01-11T19:28:13.2168989Z                                      if (-not $pkgQuit) { Write-Host "  [SKIP] $($pkg.name)" -ForegroundColor DarkGray 
2026-01-11T19:28:13.2169907Z                      }
2026-01-11T19:28:13.2170629Z                                  }
2026-01-11T19:28:13.2171536Z                              }
2026-01-11T19:28:13.2172130Z                      
2026-01-11T19:28:13.2172847Z                              # Show package summary
2026-01-11T19:28:13.2173533Z                              Write-Host ""
2026-01-11T19:28:13.2175234Z                              Write-Host "  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ" -ForegroundColor DarkGray
2026-01-11T19:28:13.2175713Z                              Write-Host "  Installed: $($installedPkgs.Count) | Skipped: $($skippedPkgs.Count)" 
2026-01-11T19:28:13.2176561Z                      -ForegroundColor Gray
2026-01-11T19:28:13.2177543Z                              if ($pkgQuit) { Write-Host "  (User quit early)" -ForegroundColor Yellow }
2026-01-11T19:28:13.2177882Z                          }
2026-01-11T19:28:13.2179112Z                      }
2026-01-11T19:28:13.2179954Z                      
2026-01-11T19:28:13.2180559Z                      # Summary
2026-01-11T19:28:13.2181690Z                      Write-Step "Complete"
2026-01-11T19:28:13.2182443Z                      Write-Host ""
2026-01-11T19:28:13.2183630Z                      Write-Host "  ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó" -ForegroundColor White
2026-01-11T19:28:13.2184149Z                      Write-Host "  ‚ïë           LOADOUT SUMMARY              ‚ïë" -ForegroundColor White
2026-01-11T19:28:13.2184664Z                      Write-Host "  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù" -ForegroundColor White
2026-01-11T19:28:13.2184797Z                      Write-Host ""
2026-01-11T19:28:13.2186015Z                      Write-Host "  Applied:  $($script:SuccessCount) changes" -ForegroundColor Green
2026-01-11T19:28:13.2186918Z                      if ($script:WarningCount -gt 0) { Write-Host "  Warnings: $($script:WarningCount)" 
2026-01-11T19:28:13.2187114Z                      -ForegroundColor Yellow }
2026-01-11T19:28:13.2188557Z                      if ($script:FailCount -gt 0) { Write-Host "  Failed:   $($script:FailCount)" -ForegroundColor Red 
2026-01-11T19:28:13.2188696Z                      }
2026-01-11T19:28:13.2189729Z                      Write-Host ""
2026-01-11T19:28:13.2190868Z                      Write-Host "  Reboot recommended for all changes to take effect." -ForegroundColor Cyan
2026-01-11T19:28:13.2191025Z                      Write-Host ""
2026-01-11T19:28:13.2192284Z                      Write-Host "  Source: https://rocktune.pedroferrari.com" -ForegroundColor DarkGray
2026-01-11T19:28:13.2192439Z                      Write-Host ""
2026-01-11T19:28:13.2193493Z [32;1mCleanBlock         : [0m
2026-01-11T19:28:13.2194276Z [32;1mDynamicParamBlock  : [0m
2026-01-11T19:28:13.2195512Z [32;1mScriptRequirements : [0mSystem.Management.Automation.Language.ScriptRequirements
2026-01-11T19:28:13.2203770Z [32;1mExtent             : [0m#Requires -RunAsAdministrator
2026-01-11T19:28:13.2203970Z                      <#
2026-01-11T19:28:13.2204725Z                      .SYNOPSIS
2026-01-11T19:28:13.2205662Z                          RockTune Universal Loader - Execute shared loadouts via one-liner
2026-01-11T19:28:13.2206167Z                      
2026-01-11T19:28:13.2206923Z                      .DESCRIPTION
2026-01-11T19:28:13.2208645Z                          This script enables direct execution of RockTune loadouts from a URL.
2026-01-11T19:28:13.2209779Z                          Configuration is passed via query parameters, parsed at runtime.
2026-01-11T19:28:13.2210319Z                      
2026-01-11T19:28:13.2215431Z                          SECURITY: LUDICROUS tier optimizations (IDs 100-103) are NOT included.
2026-01-11T19:28:13.2215866Z                          Recipients must use the web UI to enable dangerous optimizations.
2026-01-11T19:28:13.2216929Z                      
2026-01-11T19:28:13.2217739Z                      .EXAMPLE
2026-01-11T19:28:13.2218787Z                          irm "https://rocktune.pedroferrari.com/run.ps1?c=1&g=1&o=1,2,10" | iex
2026-01-11T19:28:13.2219696Z                      
2026-01-11T19:28:13.2221877Z                      .EXAMPLE
2026-01-11T19:28:13.2224367Z                          irm "https://rocktune.pedroferrari.com/run.ps1?c=1&g=1&d=1&o=1,2,3,10,11&s=steam,discord" | 
2026-01-11T19:28:13.2225418Z                      iex
2026-01-11T19:28:13.2227655Z                      
2026-01-11T19:28:13.2228812Z                      .NOTES
2026-01-11T19:28:13.2230118Z                          Generated from RockTune web app: https://rocktune.pedroferrari.com
2026-01-11T19:28:13.2230671Z                          Source: https://github.com/thepedroferrari/rocktune
2026-01-11T19:28:13.2232612Z                      #>
2026-01-11T19:28:13.2232708Z                      
2026-01-11T19:28:13.2233288Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.2233426Z                      # OS DETECTION
2026-01-11T19:28:13.2234582Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.2234990Z                      
2026-01-11T19:28:13.2236081Z                      $script:WinBuild = [int](Get-CimInstance Win32_OperatingSystem).BuildNumber
2026-01-11T19:28:13.2236860Z                      $script:IsWin11 = $script:WinBuild -ge 22000
2026-01-11T19:28:13.2237824Z                      $script:IsWin11_24H2 = $script:WinBuild -ge 26100
2026-01-11T19:28:13.2239041Z                      $script:WinVersion = if ($script:IsWin11) { "Windows 11" } else { "Windows 10" }
2026-01-11T19:28:13.2239199Z                      
2026-01-11T19:28:13.2239969Z                      # IDs that only work on Windows 11
2026-01-11T19:28:13.2240950Z                      $script:Win11OnlyIds = @('18', '21', '22')  # Classic menu, End Task, Explorer cleanup
2026-01-11T19:28:13.2241753Z                      $script:Win11_24H2OnlyIds = @('86')  # Native NVMe
2026-01-11T19:28:13.2242444Z                      
2026-01-11T19:28:13.2243634Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.2244047Z                      # PARSE CONFIGURATION
2026-01-11T19:28:13.2245132Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.2245782Z                      # Configuration is passed via $env:RT environment variable as query string format
2026-01-11T19:28:13.2246483Z                      # Example: $env:RT='c=1&g=1&o=1,2,3&s=steam'; irm url | iex
2026-01-11T19:28:13.2247199Z                      
2026-01-11T19:28:13.2248092Z                      $configString = $env:RT
2026-01-11T19:28:13.2248928Z                      if (-not $configString) {
2026-01-11T19:28:13.2249635Z                          Write-Host ""
2026-01-11T19:28:13.2250776Z                          Write-Host "  ERROR: No configuration found." -ForegroundColor Red
2026-01-11T19:28:13.2251483Z                          Write-Host ""
2026-01-11T19:28:13.2252368Z                          Write-Host "  Usage:" -ForegroundColor Yellow
2026-01-11T19:28:13.2253390Z                          Write-Host '  $env:RT="c=1&g=1&o=1,2,3&s=steam"; irm 
2026-01-11T19:28:13.2254321Z                      https://rocktune.pedroferrari.com/run.ps1 | iex' -ForegroundColor Cyan
2026-01-11T19:28:13.2255310Z                          Write-Host ""
2026-01-11T19:28:13.2256619Z                          Write-Host "  Get your one-liner at: https://rocktune.pedroferrari.com" -ForegroundColor Gray
2026-01-11T19:28:13.2256803Z                          Write-Host ""
2026-01-11T19:28:13.2257633Z                          exit 1
2026-01-11T19:28:13.2258391Z                      }
2026-01-11T19:28:13.2259942Z                      
2026-01-11T19:28:13.2261330Z                      # Parse the config string as query parameters
2026-01-11T19:28:13.2262201Z                      try {
2026-01-11T19:28:13.2263170Z                          Add-Type -AssemblyName System.Web
2026-01-11T19:28:13.2264721Z                          $query = [System.Web.HttpUtility]::ParseQueryString($configString)
2026-01-11T19:28:13.2265874Z                      } catch {
2026-01-11T19:28:13.2266995Z                          Write-Host "ERROR: Invalid configuration format." -ForegroundColor Red
2026-01-11T19:28:13.2267715Z                          exit 1
2026-01-11T19:28:13.2267852Z                      }
2026-01-11T19:28:13.2268932Z                      
2026-01-11T19:28:13.2269081Z                      # Extract parameters
2026-01-11T19:28:13.2270056Z                      $cpuId = $query['c']
2026-01-11T19:28:13.2271701Z                      $gpuId = $query['g']
2026-01-11T19:28:13.2272890Z                      $dnsId = $query['d']
2026-01-11T19:28:13.2274172Z                      $peripheralIds = if ($query['p']) { $query['p'] -split ',' } else { @() }
2026-01-11T19:28:13.2274518Z                      $monitorIds = if ($query['m']) { $query['m'] -split ',' } else { @() }
2026-01-11T19:28:13.2274992Z                      $optIds = if ($query['o']) { $query['o'] -split ',' } else { @() }
2026-01-11T19:28:13.2276713Z                      $pkgKeys = if ($query['s']) { $query['s'] -split ',' } else { @() }
2026-01-11T19:28:13.2276826Z                      
2026-01-11T19:28:13.2276976Z                      $validCpuIds = @('1', '2', '3')
2026-01-11T19:28:13.2278408Z                      $validGpuIds = @('1', '2', '3')
2026-01-11T19:28:13.2278648Z                      $validDnsIds = @('1', '2', '3', '4', '5')
2026-01-11T19:28:13.2278742Z                      
2026-01-11T19:28:13.2279515Z                      if ($cpuId -and $cpuId -notin $validCpuIds) {
2026-01-11T19:28:13.2279997Z                          Write-Host "  WARNING: Invalid CPU ID '$cpuId' - defaulting to AMD" -ForegroundColor Yellow
2026-01-11T19:28:13.2280168Z                          $cpuId = '2'
2026-01-11T19:28:13.2280674Z                      }
2026-01-11T19:28:13.2281389Z                      if ($gpuId -and $gpuId -notin $validGpuIds) {
2026-01-11T19:28:13.2282505Z                          Write-Host "  WARNING: Invalid GPU ID '$gpuId' - defaulting to NVIDIA" -ForegroundColor Yellow
2026-01-11T19:28:13.2282754Z                          $gpuId = '1'
2026-01-11T19:28:13.2283542Z                      }
2026-01-11T19:28:13.2283761Z                      if ($dnsId -and $dnsId -notin $validDnsIds) {
2026-01-11T19:28:13.2285392Z                          Write-Host "  WARNING: Invalid DNS ID '$dnsId' - DNS optimization will be skipped" 
2026-01-11T19:28:13.2285598Z                      -ForegroundColor Yellow
2026-01-11T19:28:13.2286142Z                          $dnsId = $null
2026-01-11T19:28:13.2286713Z                      }
2026-01-11T19:28:13.2288046Z                      
2026-01-11T19:28:13.2288285Z                      $optIds = $optIds | Where-Object { $_ -match '^\d+$' }
2026-01-11T19:28:13.2289529Z                      $pkgKeys = $pkgKeys | Where-Object { $_ -match '^[a-zA-Z0-9._-]+$' }
2026-01-11T19:28:13.2289788Z                      
2026-01-11T19:28:13.2290772Z                      # Clear the env var after reading (security)
2026-01-11T19:28:13.2291119Z                      $env:RT = $null
2026-01-11T19:28:13.2292645Z                      
2026-01-11T19:28:13.2293863Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.2295267Z                      # ID MAPPINGS - MUST STAY IN SYNC with web/src/lib/share-registry.ts
2026-01-11T19:28:13.2295803Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.2296175Z                      #
2026-01-11T19:28:13.2296322Z                      # To find next available ID:
2026-01-11T19:28:13.2297616Z                      #   cd web && deno task share:audit
2026-01-11T19:28:13.2298229Z                      #
2026-01-11T19:28:13.2299263Z                      # When adding a new optimization:
2026-01-11T19:28:13.2300938Z                      # 1. Add to share-registry.ts with next sequential ID
2026-01-11T19:28:13.2301796Z                      # 2. Add entry to $OPT_DESCRIPTIONS below
2026-01-11T19:28:13.2303726Z                      # 3. Add entry to $OPT_FUNCTIONS below
2026-01-11T19:28:13.2304711Z                      # 4. Run: cd web && deno task share:audit (verify passes)
2026-01-11T19:28:13.2306037Z                      #
2026-01-11T19:28:13.2317901Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.2318042Z                      
2026-01-11T19:28:13.2318256Z                      $CPU_MAP = @{ '1'='amd_x3d'; '2'='amd'; '3'='intel' }
2026-01-11T19:28:13.2318475Z                      $GPU_MAP = @{ '1'='nvidia'; '2'='amd'; '3'='intel' }
2026-01-11T19:28:13.2318582Z                      $DNS_MAP = @{
2026-01-11T19:28:13.2318841Z                          '1' = @{ name='Cloudflare'; primary='1.1.1.1'; secondary='1.0.0.1' }
2026-01-11T19:28:13.2319096Z                          '2' = @{ name='Google'; primary='8.8.8.8'; secondary='8.8.4.4' }
2026-01-11T19:28:13.2319399Z                          '3' = @{ name='Quad9'; primary='9.9.9.9'; secondary='149.112.112.112' }
2026-01-11T19:28:13.2319738Z                          '4' = @{ name='OpenDNS'; primary='208.67.222.222'; secondary='208.67.220.220' }
2026-01-11T19:28:13.2320040Z                          '5' = @{ name='AdGuard'; primary='94.140.14.14'; secondary='94.140.15.15' }
2026-01-11T19:28:13.2320152Z                      }
2026-01-11T19:28:13.2320229Z                      
2026-01-11T19:28:13.2320731Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.2320920Z                      # PACKAGE MAPPINGS (from catalog.json)
2026-01-11T19:28:13.2321663Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.2321770Z                      
2026-01-11T19:28:13.2321899Z                      $PACKAGE_MAP = @{
2026-01-11T19:28:13.2322082Z                          'steam' = @{ id='Valve.Steam'; name='Steam' }
2026-01-11T19:28:13.2322372Z                          'epic' = @{ id='EpicGames.EpicGamesLauncher'; name='Epic Games' }
2026-01-11T19:28:13.2322580Z                          'gog' = @{ id='GOG.Galaxy'; name='GOG Galaxy' }
2026-01-11T19:28:13.2323141Z                          'battlenet' = @{ id='Blizzard.BattleNet'; name='Battle.net' }
2026-01-11T19:28:13.2323394Z                          'ea' = @{ id='ElectronicArts.EADesktop'; name='EA App' }
2026-01-11T19:28:13.2323659Z                          'ubisoft' = @{ id='Ubisoft.Connect'; name='Ubisoft Connect' }
2026-01-11T19:28:13.2323888Z                          'xbox' = @{ id='Microsoft.GamingApp'; name='Xbox' }
2026-01-11T19:28:13.2324183Z                          'riot' = @{ id='RiotGames.LeagueOfLegends.EUW'; name='Riot Client' }
2026-01-11T19:28:13.2324497Z                          'rockstar' = @{ id='Rockstar.RockstarGamesLauncher'; name='Rockstar' }
2026-01-11T19:28:13.2324689Z                          'itch' = @{ id='itch.itch'; name='itch.io' }
2026-01-11T19:28:13.2324914Z                          'amazon' = @{ id='Amazon.Games'; name='Amazon Games' }
2026-01-11T19:28:13.2325150Z                          'playnite' = @{ id='Playnite.Playnite'; name='Playnite' }
2026-01-11T19:28:13.2325539Z                          'heroic' = @{ id='HeroicGamesLauncher.HeroicGamesLauncher'; name='Heroic' }
2026-01-11T19:28:13.2325758Z                          'discord' = @{ id='Discord.Discord'; name='Discord' }
2026-01-11T19:28:13.2326114Z                          'teamspeak' = @{ id='TeamSpeakSystems.TeamSpeakClient'; name='TeamSpeak' }
2026-01-11T19:28:13.2326558Z                          'guilded' = @{ id='Guilded.Guilded'; name='Guilded' }
2026-01-11T19:28:13.2326776Z                          'parsec' = @{ id='Parsec.Parsec'; name='Parsec' }
2026-01-11T19:28:13.2327239Z                          'moonlight' = @{ id='MoonlightGameStreamingProject.Moonlight'; name='Moonlight' }
2026-01-11T19:28:13.2328742Z                          'obs' = @{ id='OBSProject.OBSStudio'; name='OBS Studio' }
2026-01-11T19:28:13.2329061Z                          'streamlabs' = @{ id='Streamlabs.Streamlabs'; name='Streamlabs' }
2026-01-11T19:28:13.2329499Z                          'twitchstudio' = @{ id='Twitch.TwitchStudio'; name='Twitch Studio' }
2026-01-11T19:28:13.2331141Z                          'voicemeeter' = @{ id='VB-Audio.Voicemeeter.Potato'; name='Voicemeeter' }
2026-01-11T19:28:13.2331712Z                          'nvidiabroadcast' = @{ id='Nvidia.Broadcast'; name='NVIDIA Broadcast' }
2026-01-11T19:28:13.2331960Z                          'medal' = @{ id='Medal.Medal'; name='Medal.tv' }
2026-01-11T19:28:13.2333312Z                          'elgato' = @{ id='Elgato.StreamDeck'; name='Stream Deck' }
2026-01-11T19:28:13.2334197Z                          'prism' = @{ id='PRISMLiveStudio.PRISMLiveStudio'; name='Prism Live' }
2026-01-11T19:28:13.2334739Z                          'sunshine' = @{ id='LizardByte.Sunshine'; name='Sunshine' }
2026-01-11T19:28:13.2335002Z                          'steamlink' = @{ id='Valve.SteamLink'; name='Steam Link' }
2026-01-11T19:28:13.2335213Z                          'hwinfo' = @{ id='REALiX.HWiNFO'; name='HWiNFO' }
2026-01-11T19:28:13.2335643Z                          'afterburner' = @{ id='Guru3D.Afterburner'; name='Afterburner' }
2026-01-11T19:28:13.2336392Z                          'cpuz' = @{ id='CPUID.CPU-Z'; name='CPU-Z' }
2026-01-11T19:28:13.2337190Z                          'gpuz' = @{ id='TechPowerUp.GPU-Z'; name='GPU-Z' }
2026-01-11T19:28:13.2337462Z                          'coretemp' = @{ id='ALCPU.CoreTemp'; name='Core Temp' }
2026-01-11T19:28:13.2337917Z                          'crystaldiskinfo' = @{ id='CrystalDewWorld.CrystalDiskInfo'; name='CrystalDiskInfo' }
2026-01-11T19:28:13.2339265Z                          'crystaldiskmark' = @{ id='CrystalDewWorld.CrystalDiskMark'; name='CrystalDiskMark' }
2026-01-11T19:28:13.2339597Z                          'fpsmonitor' = @{ id='FPSMonitor.FPSMonitor'; name='FPS Monitor' }
2026-01-11T19:28:13.2340125Z                          'openhardwaremonitor' = @{ id='OpenHardwareMonitor.OpenHardwareMonitor'; name='Open Hardware 
2026-01-11T19:28:13.2340240Z                      Monitor' }
2026-01-11T19:28:13.2340991Z                          'nvcleanstall' = @{ id='TechPowerUp.NVCleanstall'; name='NVCleanstall' }
2026-01-11T19:28:13.2341540Z                          'displaydriveruninstaller' = @{ id='Wagnardsoft.DisplayDriverUninstaller'; name='DDU' }
2026-01-11T19:28:13.2341958Z                          'processlasso' = @{ id='BitSum.ProcessLasso'; name='Process Lasso' }
2026-01-11T19:28:13.2342453Z                          'rtss' = @{ id='Guru3D.RTSS'; name='RTSS' }
2026-01-11T19:28:13.2343020Z                          'capframex' = @{ id='CXWorld.CapFrameX'; name='CapFrameX' }
2026-01-11T19:28:13.2344409Z                          'latencymon' = @{ id='Resplendence.LatencyMon'; name='LatencyMon' }
2026-01-11T19:28:13.2344716Z                          'fancontrol' = @{ id='Rem0o.FanControl'; name='FanControl' }
2026-01-11T19:28:13.2345849Z                          'librehardwaremonitor' = @{ id='LibreHardwareMonitor.LibreHardwareMonitor'; name='Libre 
2026-01-11T19:28:13.2345984Z                      Hardware Monitor' }
2026-01-11T19:28:13.2346634Z                          'brave' = @{ id='Brave.Brave'; name='Brave' }
2026-01-11T19:28:13.2347379Z                          'firefox' = @{ id='Mozilla.Firefox'; name='Firefox' }
2026-01-11T19:28:13.2347617Z                          'chrome' = @{ id='Google.Chrome'; name='Chrome' }
2026-01-11T19:28:13.2348036Z                          'edge' = @{ id='Microsoft.Edge'; name='Edge' }
2026-01-11T19:28:13.2348452Z                          'operagx' = @{ id='Opera.OperaGX'; name='Opera GX' }
2026-01-11T19:28:13.2348969Z                          'vivaldi' = @{ id='Vivaldi.Vivaldi'; name='Vivaldi' }
2026-01-11T19:28:13.2349416Z                          'librewolf' = @{ id='LibreWolf.LibreWolf'; name='LibreWolf' }
2026-01-11T19:28:13.2350292Z                          'torbrowser' = @{ id='TorProject.TorBrowser'; name='Tor Browser' }
2026-01-11T19:28:13.2350477Z                          'vlc' = @{ id='VideoLAN.VLC'; name='VLC' }
2026-01-11T19:28:13.2350901Z                          'spotify' = @{ id='Spotify.Spotify'; name='Spotify' }
2026-01-11T19:28:13.2352566Z                          'foobar2000' = @{ id='PeterPawlowski.foobar2000'; name='foobar2000' }
2026-01-11T19:28:13.2352798Z                          'mpchc' = @{ id='clsid2.mpc-hc'; name='MPC-HC' }
2026-01-11T19:28:13.2352988Z                          'plex' = @{ id='Plex.Plex'; name='Plex' }
2026-01-11T19:28:13.2353607Z                          'jellyfin' = @{ id='Jellyfin.JellyfinMediaPlayer'; name='Jellyfin' }
2026-01-11T19:28:13.2354035Z                          'audacity' = @{ id='Audacity.Audacity'; name='Audacity' }
2026-01-11T19:28:13.2355214Z                          'handbrake' = @{ id='HandBrake.HandBrake'; name='HandBrake' }
2026-01-11T19:28:13.2355495Z                          'stremio' = @{ id='Stremio.Stremio'; name='Stremio' }
2026-01-11T19:28:13.2356944Z                          'musicbee' = @{ id='MusicBee.MusicBee'; name='MusicBee' }
2026-01-11T19:28:13.2357209Z                          '7zip' = @{ id='7zip.7zip'; name='7-Zip' }
2026-01-11T19:28:13.2357424Z                          'sharex' = @{ id='ShareX.ShareX'; name='ShareX' }
2026-01-11T19:28:13.2358256Z                          'powertoys' = @{ id='Microsoft.PowerToys'; name='PowerToys' }
2026-01-11T19:28:13.2358752Z                          'everything' = @{ id='voidtools.Everything'; name='Everything' }
2026-01-11T19:28:13.2359559Z                          'qbittorrent' = @{ id='qBittorrent.qBittorrent'; name='qBittorrent' }
2026-01-11T19:28:13.2361088Z                          'bitwarden' = @{ id='Bitwarden.Bitwarden'; name='Bitwarden' }
2026-01-11T19:28:13.2361464Z                          'keepassxc' = @{ id='KeePassXCTeam.KeePassXC'; name='KeePassXC' }
2026-01-11T19:28:13.2361820Z                          'notepadplusplus' = @{ id='Notepad++.Notepad++'; name='Notepad++' }
2026-01-11T19:28:13.2363250Z                          'wiztree' = @{ id='AntibodySoftware.WizTree'; name='WizTree' }
2026-01-11T19:28:13.2363787Z                          'windirstat' = @{ id='WinDirStat.WinDirStat'; name='WinDirStat' }
2026-01-11T19:28:13.2364267Z                          'autohotkey' = @{ id='AutoHotkey.AutoHotkey'; name='AutoHotkey' }
2026-01-11T19:28:13.2364460Z                          'f.lux' = @{ id='flux.flux'; name='f.lux' }
2026-01-11T19:28:13.2364868Z                          'winrar' = @{ id='RARLab.WinRAR'; name='WinRAR' }
2026-01-11T19:28:13.2365300Z                          'peazip' = @{ id='Giorgiotani.Peazip'; name='PeaZip' }
2026-01-11T19:28:13.2365757Z                          'revo' = @{ id='RevoUninstaller.RevoUninstaller'; name='Revo Uninstaller' }
2026-01-11T19:28:13.2367141Z                          'bulk' = @{ id='TGRMNSoftware.BulkRenameUtility'; name='Bulk Rename' }
2026-01-11T19:28:13.2367478Z                          'imageglass' = @{ id='ImageGlass.ImageGlass'; name='ImageGlass' }
2026-01-11T19:28:13.2367806Z                          'flameshot' = @{ id='Flameshot.Flameshot'; name='Flameshot' }
2026-01-11T19:28:13.2369064Z                          'ditto' = @{ id='Ditto.Ditto'; name='Ditto' }
2026-01-11T19:28:13.2369824Z                          'eartrumpet' = @{ id='File-New-Project.EarTrumpet'; name='EarTrumpet' }
2026-01-11T19:28:13.2370546Z                          'bcuninstaller' = @{ id='Klocman.BulkCrapUninstaller'; name='Bulk Crap Uninstaller' }
2026-01-11T19:28:13.2371299Z                          'sysinternals_suite' = @{ id='Microsoft.Sysinternals.Suite'; name='Sysinternals Suite' }
2026-01-11T19:28:13.2371584Z                          'rainmeter' = @{ id='Rainmeter.Rainmeter'; name='Rainmeter' }
2026-01-11T19:28:13.2372872Z                          'lively' = @{ id='rocksdanister.LivelyWallpaper'; name='Lively Wallpaper' }
2026-01-11T19:28:13.2373191Z                          'logitechghub' = @{ id='Logitech.GHUB'; name='Logitech G HUB' }
2026-01-11T19:28:13.2373760Z                          'razersynapse' = @{ id='RazerInc.RazerInstaller'; name='Razer Synapse' }
2026-01-11T19:28:13.2374844Z                          'icue' = @{ id='Corsair.iCUE.5'; name='Corsair iCUE' }
2026-01-11T19:28:13.2375406Z                          'steelseriesgg' = @{ id='SteelSeries.GG'; name='SteelSeries GG' }
2026-01-11T19:28:13.2376570Z                          'armourycrate' = @{ id='ASUS.ArmouryCrate'; name='ASUS Armoury Crate' }
2026-01-11T19:28:13.2376799Z                          'nzxtcam' = @{ id='NZXT.CAM'; name='NZXT CAM' }
2026-01-11T19:28:13.2377384Z                          'signalrgb' = @{ id='WhirlwindFX.SignalRgb'; name='SignalRGB' }
2026-01-11T19:28:13.2377752Z                          'openrgb' = @{ id='OpenRGB.OpenRGB'; name='OpenRGB' }
2026-01-11T19:28:13.2378982Z                          'wooting' = @{ id='Wooting.Wootility'; name='Wootility' }
2026-01-11T19:28:13.2379586Z                          'delldisplaymanager' = @{ id='Dell.DisplayManager'; name='Dell Display Manager' }
2026-01-11T19:28:13.2380656Z                          'lgonscreencontrol' = @{ id='LG.OnScreenControl'; name='LG OnScreen Control' }
2026-01-11T19:28:13.2380910Z                          'hpdisplaycenter' = @{ id='HP.DisplayCenter'; name='HP Display Center' }
2026-01-11T19:28:13.2381384Z                          'vscode' = @{ id='Microsoft.VisualStudioCode'; name='VS Code' }
2026-01-11T19:28:13.2382238Z                          'git' = @{ id='Git.Git'; name='Git' }
2026-01-11T19:28:13.2382683Z                          'python' = @{ id='Python.Python.3.12'; name='Python' }
2026-01-11T19:28:13.2384060Z                          'nodejs' = @{ id='OpenJS.NodeJS.LTS'; name='Node.js' }
2026-01-11T19:28:13.2384261Z                          'wt' = @{ id='Microsoft.WindowsTerminal'; name='Terminal' }
2026-01-11T19:28:13.2385530Z                          'docker' = @{ id='Docker.DockerDesktop'; name='Docker' }
2026-01-11T19:28:13.2385770Z                          'postman' = @{ id='Postman.Postman'; name='Postman' }
2026-01-11T19:28:13.2386587Z                          'github' = @{ id='GitHub.GitHubDesktop'; name='GitHub Desktop' }
2026-01-11T19:28:13.2387717Z                          'sublime' = @{ id='SublimeHQ.SublimeText.4'; name='Sublime Text' }
2026-01-11T19:28:13.2388284Z                          'neovim' = @{ id='Neovim.Neovim'; name='Neovim' }
2026-01-11T19:28:13.2389463Z                          'wsl' = @{ id='Canonical.Ubuntu.2404'; name='Ubuntu (WSL)' }
2026-01-11T19:28:13.2389780Z                          'jetbrains' = @{ id='JetBrains.Toolbox'; name='JetBrains Toolbox' }
2026-01-11T19:28:13.2390308Z                          'powershell' = @{ id='Microsoft.PowerShell'; name='PowerShell' }
2026-01-11T19:28:13.2390968Z                          'gh' = @{ id='GitHub.cli'; name='GitHub CLI' }
2026-01-11T19:28:13.2392112Z                          'vcredist' = @{ id='Microsoft.VCRedist.2015+.x64'; name='VC++ Runtime' }
2026-01-11T19:28:13.2392684Z                          'vcredist_x86' = @{ id='Microsoft.VCRedist.2015+.x86'; name='VC++ Runtime (x86)' }
2026-01-11T19:28:13.2393370Z                          'dotnet' = @{ id='Microsoft.DotNet.DesktopRuntime.8'; name='.NET Runtime' }
2026-01-11T19:28:13.2393723Z                          'dotnet_runtime_8' = @{ id='Microsoft.DotNet.Runtime.8'; name='.NET Runtime 8' }
2026-01-11T19:28:13.2394416Z                          'dotnet_sdk_8' = @{ id='Microsoft.DotNet.SDK.8'; name='.NET SDK 8' }
2026-01-11T19:28:13.2394862Z                          'directx' = @{ id='Microsoft.DirectX'; name='DirectX' }
2026-01-11T19:28:13.2395098Z                          'java' = @{ id='Oracle.JavaRuntimeEnvironment'; name='Java' }
2026-01-11T19:28:13.2396295Z                          'webview2' = @{ id='Microsoft.EdgeWebView2Runtime'; name='WebView2' }
2026-01-11T19:28:13.2396552Z                          '3dmark' = @{ id='Futuremark.3DMark'; name='3DMark' }
2026-01-11T19:28:13.2397689Z                          'cinebench' = @{ id='Maxon.Cinebench'; name='Cinebench' }
2026-01-11T19:28:13.2397939Z                          'geekbench' = @{ id='Geekbench.Geekbench.6'; name='Geekbench' }
2026-01-11T19:28:13.2399014Z                          'furmark' = @{ id='Geeks3D.FurMark'; name='FurMark' }
2026-01-11T19:28:13.2399525Z                          'occt' = @{ id='OCBase.OCCT.Personal'; name='OCCT' }
2026-01-11T19:28:13.2400786Z                          'unigine_heaven' = @{ id='Unigine.HeavenBenchmark'; name='Unigine Heaven' }
2026-01-11T19:28:13.2401034Z                          'unigine_valley' = @{ id='Unigine.ValleyBenchmark'; name='Unigine Valley' }
2026-01-11T19:28:13.2402201Z                          'unigine_superposition' = @{ id='Unigine.SuperpositionBenchmark'; name='Unigine 
2026-01-11T19:28:13.2402359Z                      Superposition' }
2026-01-11T19:28:13.2402677Z                      }
2026-01-11T19:28:13.2403732Z                      
2026-01-11T19:28:13.2404392Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.2404899Z                      # HELPER FUNCTIONS
2026-01-11T19:28:13.2405322Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.2406259Z                      
2026-01-11T19:28:13.2407249Z                      $script:SuccessCount = 0
2026-01-11T19:28:13.2407410Z                      $script:FailCount = 0
2026-01-11T19:28:13.2408547Z                      $script:WarningCount = 0
2026-01-11T19:28:13.2408718Z                      $script:ScanResults = @()
2026-01-11T19:28:13.2408810Z                      
2026-01-11T19:28:13.2410469Z                      function Write-Banner {
2026-01-11T19:28:13.2410588Z                          Write-Host @'
2026-01-11T19:28:13.2412171Z                          ____             __   ______
2026-01-11T19:28:13.2412344Z                         / __ \____  _____/ /__/_  __/_  ______  ___
2026-01-11T19:28:13.2412994Z                        / /_/ / __ \/ ___/ //_/ / / / / / / __ \/ _ \
2026-01-11T19:28:13.2413627Z                       / _, _/ /_/ / /__/ ,<   / / / /_/ / / / /  __/
2026-01-11T19:28:13.2416088Z                      /_/ |_|\____/\___/_/|_| /_/  \__,_/_/ /_/\___/
2026-01-11T19:28:13.2417069Z                      
2026-01-11T19:28:13.2417878Z                              Windows Gaming Loadout Builder
2026-01-11T19:28:13.2424567Z                      '@ -ForegroundColor Magenta
2026-01-11T19:28:13.2426176Z                      }
2026-01-11T19:28:13.2426293Z                      
2026-01-11T19:28:13.2427502Z                      function Write-Step { param([string]$M) Write-Host "`n>> $M" -ForegroundColor Cyan }
2026-01-11T19:28:13.2427970Z                      function Write-OK { param([string]$M) $script:SuccessCount++; Write-Host "  [OK] $M" 
2026-01-11T19:28:13.2428404Z                      -ForegroundColor Green }
2026-01-11T19:28:13.2429684Z                      function Write-Fail { param([string]$M) $script:FailCount++; Write-Host "  [FAIL] $M" 
2026-01-11T19:28:13.2429899Z                      -ForegroundColor Red }
2026-01-11T19:28:13.2431755Z                      function Write-Warn { param([string]$M) $script:WarningCount++; Write-Host "  [!] $M" 
2026-01-11T19:28:13.2431935Z                      -ForegroundColor Yellow }
2026-01-11T19:28:13.2432751Z                      
2026-01-11T19:28:13.2433461Z                      function Set-Reg {
2026-01-11T19:28:13.2434716Z                          param([string]$Path, [string]$Name, $Value, [string]$Type = "DWORD", [switch]$PassThru)
2026-01-11T19:28:13.2434845Z                          $success = $false
2026-01-11T19:28:13.2434978Z                          try {
2026-01-11T19:28:13.2435992Z                              if (-not (Test-Path $Path)) { New-Item -Path $Path -Force | Out-Null }
2026-01-11T19:28:13.2436371Z                              $existing = Get-ItemProperty -Path $Path -Name $Name -EA SilentlyContinue
2026-01-11T19:28:13.2436530Z                              if ($null -eq $existing) {
2026-01-11T19:28:13.2437725Z                                  New-ItemProperty -Path $Path -Name $Name -Value $Value -PropertyType $Type -Force | 
2026-01-11T19:28:13.2438055Z                      Out-Null
2026-01-11T19:28:13.2438445Z                              } else {
2026-01-11T19:28:13.2439422Z                                  Set-ItemProperty -Path $Path -Name $Name -Value $Value -EA Stop
2026-01-11T19:28:13.2439539Z                              }
2026-01-11T19:28:13.2439718Z                              $success = $true
2026-01-11T19:28:13.2440646Z                          } catch { $success = $false }
2026-01-11T19:28:13.2441056Z                          if ($PassThru) { return $success }
2026-01-11T19:28:13.2441482Z                      }
2026-01-11T19:28:13.2442041Z                      
2026-01-11T19:28:13.2442452Z                      function Add-ScanResult {
2026-01-11T19:28:13.2443029Z                          param([string]$Name, [string]$Current, [string]$Target, [string]$Status = "CHANGE")
2026-01-11T19:28:13.2443205Z                          $script:ScanResults += [PSCustomObject]@{
2026-01-11T19:28:13.2443605Z                              Name = $Name
2026-01-11T19:28:13.2444622Z                              Current = $Current
2026-01-11T19:28:13.2445500Z                              Target = $Target
2026-01-11T19:28:13.2446848Z                              Status = $Status
2026-01-11T19:28:13.2447288Z                          }
2026-01-11T19:28:13.2448353Z                      }
2026-01-11T19:28:13.2448459Z                      
2026-01-11T19:28:13.2449737Z                      function Write-ScanResults {
2026-01-11T19:28:13.2449986Z                          if ($script:ScanResults.Count -eq 0) { return }
2026-01-11T19:28:13.2450993Z                      
2026-01-11T19:28:13.2451492Z                          $nameWidth = 36
2026-01-11T19:28:13.2452604Z                          $currentWidth = 14
2026-01-11T19:28:13.2452870Z                          $targetWidth = 18
2026-01-11T19:28:13.2453858Z                      
2026-01-11T19:28:13.2453980Z                          Write-Host ""
2026-01-11T19:28:13.2456348Z                          Write-Host "  ‚ïî$('‚ïê' * $nameWidth)‚ï§$('‚ïê' * $currentWidth)‚ï§$('‚ïê' * $targetWidth)‚ïó" 
2026-01-11T19:28:13.2456481Z                      -ForegroundColor White
2026-01-11T19:28:13.2458005Z                          Write-Host "  ‚ïë Setting$(' ' * ($nameWidth - 9))‚îÇ Current$(' ' * ($currentWidth - 9))‚îÇ 
2026-01-11T19:28:13.2458236Z                      Target$(' ' * ($targetWidth - 8))‚ïë" -ForegroundColor White
2026-01-11T19:28:13.2459756Z                          Write-Host "  ‚ï†$('‚ïê' * $nameWidth)‚ï™$('‚ïê' * $currentWidth)‚ï™$('‚ïê' * $targetWidth)‚ï£" 
2026-01-11T19:28:13.2459898Z                      -ForegroundColor White
2026-01-11T19:28:13.2460293Z                      
2026-01-11T19:28:13.2461229Z                          foreach ($result in $script:ScanResults) {
2026-01-11T19:28:13.2461350Z                              $name = $result.Name
2026-01-11T19:28:13.2462923Z                              if ($name.Length -gt ($nameWidth - 2)) { $name = $name.Substring(0, $nameWidth - 5) + 
2026-01-11T19:28:13.2463032Z                      "..." }
2026-01-11T19:28:13.2464041Z                              $name = " " + $name.PadRight($nameWidth - 2)
2026-01-11T19:28:13.2464147Z                      
2026-01-11T19:28:13.2465311Z                              $current = $result.Current
2026-01-11T19:28:13.2466872Z                              if ($current.Length -gt ($currentWidth - 2)) { $current = $current.Substring(0, 
2026-01-11T19:28:13.2466974Z                      $currentWidth - 5) + "..." }
2026-01-11T19:28:13.2467909Z                              $current = " " + $current.PadRight($currentWidth - 2)
2026-01-11T19:28:13.2468334Z                      
2026-01-11T19:28:13.2468951Z                              $target = $result.Target
2026-01-11T19:28:13.2470457Z                              if ($target.Length -gt ($targetWidth - 2)) { $target = $target.Substring(0, $targetWidth 
2026-01-11T19:28:13.2470545Z                      - 5) + "..." }
2026-01-11T19:28:13.2471627Z                              $target = " " + $target.PadRight($targetWidth - 2)
2026-01-11T19:28:13.2471986Z                      
2026-01-11T19:28:13.2472968Z                              $color = switch ($result.Status) {
2026-01-11T19:28:13.2473127Z                                  "OK"      { "Green" }
2026-01-11T19:28:13.2474117Z                                  "CHANGE"  { "Yellow" }
2026-01-11T19:28:13.2474272Z                                  "INFO"    { "Cyan" }
2026-01-11T19:28:13.2475415Z                                  "PENDING" { "Gray" }
2026-01-11T19:28:13.2475566Z                                  default   { "White" }
2026-01-11T19:28:13.2476751Z                              }
2026-01-11T19:28:13.2477758Z                      
2026-01-11T19:28:13.2478809Z                              Write-Host "  ‚ïë" -NoNewline -ForegroundColor White
2026-01-11T19:28:13.2479063Z                              Write-Host $name -NoNewline -ForegroundColor $color
2026-01-11T19:28:13.2479861Z                              Write-Host "‚îÇ" -NoNewline -ForegroundColor White
2026-01-11T19:28:13.2480913Z                              Write-Host $current -NoNewline -ForegroundColor $color
2026-01-11T19:28:13.2488213Z                              Write-Host "‚îÇ" -NoNewline -ForegroundColor White
2026-01-11T19:28:13.2489903Z                              Write-Host $target -NoNewline -ForegroundColor $color
2026-01-11T19:28:13.2491249Z                              Write-Host "‚ïë" -ForegroundColor White
2026-01-11T19:28:13.2493807Z                          }
2026-01-11T19:28:13.2495881Z                      
2026-01-11T19:28:13.2498012Z                          Write-Host "  ‚ïö$('‚ïê' * $nameWidth)‚ïß$('‚ïê' * $currentWidth)‚ïß$('‚ïê' * $targetWidth)‚ïù" 
2026-01-11T19:28:13.2500311Z                      -ForegroundColor White
2026-01-11T19:28:13.2501982Z                          Write-Host ""
2026-01-11T19:28:13.2504574Z                      
2026-01-11T19:28:13.2509158Z                          $changeCount = ($script:ScanResults | Where-Object { $_.Status -eq "CHANGE" }).Count
2026-01-11T19:28:13.2512278Z                          $okCount = ($script:ScanResults | Where-Object { $_.Status -eq "OK" }).Count
2026-01-11T19:28:13.2514804Z                          Write-Host "  Summary: $changeCount changes needed, $okCount already configured" 
2026-01-11T19:28:13.2517541Z                      -ForegroundColor Gray
2026-01-11T19:28:13.2518430Z                          Write-Host ""
2026-01-11T19:28:13.2519459Z                      }
2026-01-11T19:28:13.2520036Z                      
2026-01-11T19:28:13.2521373Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.2521617Z                      # OPTIMIZATION DESCRIPTIONS (for interactive mode)
2026-01-11T19:28:13.2523162Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.2523675Z                      
2026-01-11T19:28:13.2523885Z                      $OPT_DESCRIPTIONS = @{
2026-01-11T19:28:13.2524377Z                          # SAFE tier (1-45)
2026-01-11T19:28:13.2526701Z                          '1'  = @{ name='Page File'; tier='SAFE'; desc='Set fixed page file size based on RAM (4GB for 
2026-01-11T19:28:13.2527878Z                      32GB+, 8GB for 16GB)' }
2026-01-11T19:28:13.2543725Z                          '2'  = @{ name='Fast Startup'; tier='SAFE'; desc='Disable Fast Boot for cleaner shutdowns and 
2026-01-11T19:28:13.2545302Z                      driver resets' }
2026-01-11T19:28:13.2548110Z                          '3'  = @{ name='Timer Resolution'; tier='SAFE'; desc='Manual step: Requires timer-tool.ps1 
2026-01-11T19:28:13.2550482Z                      before gaming' }
2026-01-11T19:28:13.2553359Z                          '4'  = @{ name='Power Plan'; tier='SAFE'; desc='Enable High Performance power plan' }
2026-01-11T19:28:13.2556530Z                          '5'  = @{ name='USB Power'; tier='SAFE'; desc='Disable USB selective suspend (prevents device 
2026-01-11T19:28:13.2558347Z                      disconnects)' }
2026-01-11T19:28:13.2561015Z                          '6'  = @{ name='PCIe Power'; tier='SAFE'; desc='Disable PCIe power saving for GPU stability' }
2026-01-11T19:28:13.2562845Z                          '7'  = @{ name='DNS Provider'; tier='SAFE'; desc='Set DNS servers to selected provider' }
2026-01-11T19:28:13.2564006Z                          '8'  = @{ name='Nagle Algorithm'; tier='SAFE'; desc='Disable Nagle buffering for lower 
2026-01-11T19:28:13.2564187Z                      network latency' }
2026-01-11T19:28:13.2569993Z                          '9'  = @{ name='Audio Ducking'; tier='SAFE'; desc='Disable audio volume reduction during 
2026-01-11T19:28:13.2570313Z                      calls' }
2026-01-11T19:28:13.2571663Z                          '10' = @{ name='Game DVR'; tier='SAFE'; desc='Disable background game recording' }
2026-01-11T19:28:13.2572720Z                          '11' = @{ name='Background Apps'; tier='SAFE'; desc='Disable background app activity' }
2026-01-11T19:28:13.2573621Z                          '12' = @{ name='Edge Debloat'; tier='SAFE'; desc='Disable Edge shopping assistant and 
2026-01-11T19:28:13.2574412Z                      widgets' }
2026-01-11T19:28:13.2575935Z                          '13' = @{ name='Copilot'; tier='SAFE'; desc='Disable Windows Copilot' }
2026-01-11T19:28:13.2577399Z                          '14' = @{ name='Explorer Speed'; tier='SAFE'; desc='Optimize folder type detection for faster 
2026-01-11T19:28:13.2577568Z                      browsing' }
2026-01-11T19:28:13.2578286Z                          '15' = @{ name='Temp Purge'; tier='SAFE'; desc='Clear temporary folders' }
2026-01-11T19:28:13.2579687Z                          '16' = @{ name='Razer Block'; tier='SAFE'; desc='Stop and disable Razer background services' }
2026-01-11T19:28:13.2581071Z                          '17' = @{ name='Restore Point'; tier='SAFE'; desc='Create system restore point before 
2026-01-11T19:28:13.2581754Z                      changes' }
2026-01-11T19:28:13.2583694Z                          '18' = @{ name='Classic Menu'; tier='SAFE'; desc='Enable Windows 10 style context menu' }
2026-01-11T19:28:13.2584596Z                          '19' = @{ name='Storage Sense'; tier='SAFE'; desc='Disable automatic storage cleanup' }
2026-01-11T19:28:13.2585626Z                          '20' = @{ name='Visual Effects'; tier='SAFE'; desc='Set visual effects to performance mode' }
2026-01-11T19:28:13.2586261Z                          '21' = @{ name='End Task'; tier='SAFE'; desc='Enable End Task option in taskbar' }
2026-01-11T19:28:13.2587354Z                          '22' = @{ name='Explorer Cleanup'; tier='SAFE'; desc='Remove OneDrive and Gallery from 
2026-01-11T19:28:13.2587530Z                      Explorer' }
2026-01-11T19:28:13.2589638Z                          '23' = @{ name='Notifications'; tier='SAFE'; desc='Disable notification center and toasts' }
2026-01-11T19:28:13.2590236Z                          '24' = @{ name='PS7 Telemetry'; tier='SAFE'; desc='Disable PowerShell 7 telemetry' }
2026-01-11T19:28:13.2590910Z                          '25' = @{ name='Multiplane Overlay'; tier='SAFE'; desc='Disable DWM overlay for cleaner 
2026-01-11T19:28:13.2592011Z                      fullscreen' }
2026-01-11T19:28:13.2593571Z                          '26' = @{ name='Mouse Acceleration'; tier='SAFE'; desc='Disable mouse acceleration for raw 
2026-01-11T19:28:13.2593945Z                      input' }
2026-01-11T19:28:13.2595088Z                          '27' = @{ name='USB Suspend'; tier='SAFE'; desc='Disable USB selective suspend' }
2026-01-11T19:28:13.2597159Z                          '28' = @{ name='Keyboard Response'; tier='SAFE'; desc='Minimize keyboard delay and maximize 
2026-01-11T19:28:13.2598585Z                      repeat rate' }
2026-01-11T19:28:13.2601109Z                          '29' = @{ name='Game Mode'; tier='SAFE'; desc='Enable Windows Game Mode' }
2026-01-11T19:28:13.2604404Z                          '30' = @{ name='Min Processor'; tier='SAFE'; desc='Set minimum processor state to 5% (better 
2026-01-11T19:28:13.2605848Z                      thermals)' }
2026-01-11T19:28:13.2616770Z                          '31' = @{ name='Hibernation'; tier='SAFE'; desc='Disable hibernation (saves disk space)' }
2026-01-11T19:28:13.2622915Z                          '32' = @{ name='RSS'; tier='SAFE'; desc='Enable Receive Side Scaling for network' }
2026-01-11T19:28:13.2623708Z                          '33' = @{ name='Adapter Power'; tier='SAFE'; desc='Disable network adapter power saving' }
2026-01-11T19:28:13.2625961Z                          '34' = @{ name='Delivery Opt'; tier='SAFE'; desc='Disable P2P update delivery' }
2026-01-11T19:28:13.2628166Z                          '35' = @{ name='Error Reporting'; tier='SAFE'; desc='Disable Windows Error Reporting' }
2026-01-11T19:28:13.2629079Z                          '36' = @{ name='WiFi Sense'; tier='SAFE'; desc='Disable WiFi Sense auto-connect' }
2026-01-11T19:28:13.2631261Z                          '37' = @{ name='Spotlight'; tier='SAFE'; desc='Disable Windows Spotlight on lock screen' }
2026-01-11T19:28:13.2633639Z                          '38' = @{ name='Feedback'; tier='SAFE'; desc='Disable Windows feedback prompts' }
2026-01-11T19:28:13.2636021Z                          '39' = @{ name='Clipboard Sync'; tier='SAFE'; desc='Disable cloud clipboard sync' }
2026-01-11T19:28:13.2638316Z                          '40' = @{ name='Accessibility'; tier='SAFE'; desc='Disable Sticky Keys and other shortcuts' }
2026-01-11T19:28:13.2640683Z                          '41' = @{ name='Audio Comm'; tier='SAFE'; desc='Disable volume ducking during communications' 
2026-01-11T19:28:13.2642515Z                      }
2026-01-11T19:28:13.2646069Z                          '42' = @{ name='System Sounds'; tier='SAFE'; desc='Mute Windows system sounds' }
2026-01-11T19:28:13.2648660Z                          '43' = @{ name='Input Buffer'; tier='SAFE'; desc='Increase input buffer for high poll rate 
2026-01-11T19:28:13.2657560Z                      devices' }
2026-01-11T19:28:13.2660512Z                          '44' = @{ name='Filesystem'; tier='SAFE'; desc='Optimize NTFS settings (disable last access, 
2026-01-11T19:28:13.2663465Z                      8.3 names)' }
2026-01-11T19:28:13.2669912Z                          '45' = @{ name='DWM Perf'; tier='SAFE'; desc='Optimize Desktop Window Manager settings' }
2026-01-11T19:28:13.2678015Z                      
2026-01-11T19:28:13.2680031Z                          # CAUTION tier (50-72)
2026-01-11T19:28:13.2682122Z                          '50' = @{ name='MSI Mode'; tier='CAUTION'; desc='Enable Message Signaled Interrupts for GPU 
2026-01-11T19:28:13.2683619Z                      (lower DPC latency)' }
2026-01-11T19:28:13.2685535Z                          '51' = @{ name='HPET'; tier='CAUTION'; desc='Disable High Precision Event Timer (test 
2026-01-11T19:28:13.2688028Z                      before/after)' }
2026-01-11T19:28:13.2690535Z                          '52' = @{ name='Game Bar Overlay'; tier='CAUTION'; desc='Disable Game Bar overlays (keep core 
2026-01-11T19:28:13.2692709Z                      enabled)' }
2026-01-11T19:28:13.2695401Z                          '53' = @{ name='HAGS'; tier='CAUTION'; desc='Enable Hardware Accelerated GPU Scheduling' }
2026-01-11T19:28:13.2699148Z                          '54' = @{ name='FSO'; tier='CAUTION'; desc='Disable fullscreen optimizations globally' }
2026-01-11T19:28:13.2701393Z                          '55' = @{ name='Ultimate Perf'; tier='CAUTION'; desc='Enable Ultimate Performance power plan' 
2026-01-11T19:28:13.2703619Z                      }
2026-01-11T19:28:13.2706863Z                          '56' = @{ name='Services Trim'; tier='CAUTION'; desc='Set unnecessary services to manual 
2026-01-11T19:28:13.2709025Z                      startup' }
2026-01-11T19:28:13.2713571Z                          '57' = @{ name='Disk Cleanup'; tier='CAUTION'; desc='Run Windows disk cleanup utility' }
2026-01-11T19:28:13.2722688Z                          '58' = @{ name='WPBT'; tier='CAUTION'; desc='Disable WPBT (blocks OEM pre-installed 
2026-01-11T19:28:13.2723082Z                      software)' }
2026-01-11T19:28:13.2725410Z                          '59' = @{ name='QoS Gaming'; tier='CAUTION'; desc='Remove bandwidth reservations for gaming' }
2026-01-11T19:28:13.2727074Z                          '60' = @{ name='Network Throttle'; tier='CAUTION'; desc='Disable network throttling during 
2026-01-11T19:28:13.2728045Z                      multimedia' }
2026-01-11T19:28:13.2729555Z                          '61' = @{ name='GPU Affinity'; tier='CAUTION'; desc='Set GPU interrupt affinity to CPU 0' }
2026-01-11T19:28:13.2730829Z                          '62' = @{ name='Mitigations'; tier='CAUTION'; desc='Disable kernel shadow stacks (reduces 
2026-01-11T19:28:13.2731377Z                      security)' }
2026-01-11T19:28:13.2733003Z                          '63' = @{ name='MMCSS'; tier='CAUTION'; desc='Configure multimedia class scheduler for games' 
2026-01-11T19:28:13.2733129Z                      }
2026-01-11T19:28:13.2734536Z                          '64' = @{ name='Scheduler'; tier='CAUTION'; desc='Optimize thread scheduler for 
2026-01-11T19:28:13.2735033Z                      responsiveness' }
2026-01-11T19:28:13.2736415Z                          '65' = @{ name='Core Parking'; tier='CAUTION'; desc='Disable CPU core parking' }
2026-01-11T19:28:13.2737228Z                          '66' = @{ name='Timer Registry'; tier='CAUTION'; desc='Enable global timer resolution 
2026-01-11T19:28:13.2738044Z                      requests' }
2026-01-11T19:28:13.2739279Z                          '67' = @{ name='RSC'; tier='CAUTION'; desc='Disable Receive Segment Coalescing' }
2026-01-11T19:28:13.2740375Z                          '68' = @{ name='SysMain'; tier='CAUTION'; desc='Disable SysMain/Superfetch service' }
2026-01-11T19:28:13.2741554Z                          '69' = @{ name='Search'; tier='CAUTION'; desc='Set Windows Search to manual (stops indexing)' 
2026-01-11T19:28:13.2741723Z                      }
2026-01-11T19:28:13.2745788Z                          '70' = @{ name='Memory Gaming'; tier='CAUTION'; desc='Keep kernel in RAM (disable paging 
2026-01-11T19:28:13.2746501Z                      executive)' }
2026-01-11T19:28:13.2747884Z                          '71' = @{ name='Power Throttle'; tier='CAUTION'; desc='Disable CPU power throttling' }
2026-01-11T19:28:13.2749519Z                          '72' = @{ name='Priority Boost'; tier='CAUTION'; desc='Disable priority boost (consistent 
2026-01-11T19:28:13.2749707Z                      scheduling)' }
2026-01-11T19:28:13.2750786Z                      
2026-01-11T19:28:13.2751770Z                          # RISKY tier (80-89)
2026-01-11T19:28:13.2753302Z                          '80' = @{ name='Privacy T1'; tier='RISKY'; desc='Disable advertising ID and tailored 
2026-01-11T19:28:13.2753499Z                      experiences' }
2026-01-11T19:28:13.2754753Z                          '81' = @{ name='Privacy T2'; tier='RISKY'; desc='Minimize diagnostic telemetry' }
2026-01-11T19:28:13.2756148Z                          '82' = @{ name='Privacy T3'; tier='RISKY'; desc='Disable Xbox services (breaks Game Pass!)' }
2026-01-11T19:28:13.2757154Z                          '83' = @{ name='Bloatware'; tier='RISKY'; desc='Remove pre-installed bloatware apps' }
2026-01-11T19:28:13.2758392Z                          '84' = @{ name='IPv4 Prefer'; tier='RISKY'; desc='Prefer IPv4 over IPv6' }
2026-01-11T19:28:13.2759289Z                          '85' = @{ name='Teredo'; tier='RISKY'; desc='Disable Teredo tunneling' }
2026-01-11T19:28:13.2759713Z                          '86' = @{ name='Native NVMe'; tier='RISKY'; desc='Enable native NVMe stack (Win11 24H2+)' }
2026-01-11T19:28:13.2760146Z                          '87' = @{ name='SMT'; tier='RISKY'; desc='Disable SMT/Hyperthreading (physical cores only)' }
2026-01-11T19:28:13.2761827Z                          '88' = @{ name='Audio Exclusive'; tier='RISKY'; desc='Configure audio for exclusive mode 
2026-01-11T19:28:13.2761959Z                      apps' }
2026-01-11T19:28:13.2763099Z                          '89' = @{ name='TCP Optimizer'; tier='RISKY'; desc='Apply TCP optimizations for gaming' }
2026-01-11T19:28:13.2763220Z                      
2026-01-11T19:28:13.2763400Z                          # FR33THY Phase (104+)
2026-01-11T19:28:13.2765229Z                          '104' = @{ name='Background Polling'; tier='SAFE'; desc='Unlock full mouse polling rate in 
2026-01-11T19:28:13.2765383Z                      background windows' }
2026-01-11T19:28:13.2767083Z                          '105' = @{ name='AMD ULPS'; tier='CAUTION'; desc='Disable AMD Ultra Low Power State (prevents 
2026-01-11T19:28:13.2767280Z                      downclock stutters)' }
2026-01-11T19:28:13.2769190Z                          '106' = @{ name='NVIDIA P0 State'; tier='RISKY'; desc='Force GPU to max clocks (increases 
2026-01-11T19:28:13.2769357Z                      heat/power!)' }
2026-01-11T19:28:13.2771222Z                          '107' = @{ name='Network Binding Strip'; tier='RISKY'; desc='Remove IPv6/sharing bindings 
2026-01-11T19:28:13.2771373Z                      (breaks file sharing!)' }
2026-01-11T19:28:13.2771461Z                      }
2026-01-11T19:28:13.2772515Z                      
2026-01-11T19:28:13.2773572Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.2773849Z                      # OPTIMIZATION FUNCTIONS (by ID from share-registry.ts)
2026-01-11T19:28:13.2774134Z                      # NOTE: LUDICROUS tier IDs (100-103) are intentionally NOT included
2026-01-11T19:28:13.2775194Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.2775735Z                      
2026-01-11T19:28:13.2775958Z                      $OPT_FUNCTIONS = @{
2026-01-11T19:28:13.2776889Z                          # SAFE tier (1-45)
2026-01-11T19:28:13.2776998Z                          '1' = { # pagefile
2026-01-11T19:28:13.2779009Z                              $ram = [math]::Round((Get-CimInstance Win32_PhysicalMemory | Measure-Object Capacity 
2026-01-11T19:28:13.2779731Z                      -Sum).Sum/1GB)
2026-01-11T19:28:13.2779866Z                              if ($ram -ge 16) {
2026-01-11T19:28:13.2780263Z                                  $size = if ($ram -ge 32) { 4096 } else { 8192 }
2026-01-11T19:28:13.2781789Z                                  $cs = Get-WmiObject Win32_ComputerSystem -EnableAllPrivileges
2026-01-11T19:28:13.2782091Z                                  $cs.AutomaticManagedPagefile = $false; $cs.Put() | Out-Null
2026-01-11T19:28:13.2783215Z                                  $pf = Get-WmiObject -Query "Select * From Win32_PageFileSetting Where 
2026-01-11T19:28:13.2783865Z                      Name='C:\\pagefile.sys'" -EA SilentlyContinue
2026-01-11T19:28:13.2784017Z                                  if ($pf) {
2026-01-11T19:28:13.2784397Z                                      $pf.InitialSize = $size; $pf.MaximumSize = $size; $pf.Put() | Out-Null
2026-01-11T19:28:13.2784627Z                                      Write-OK "Page file set to ${size}MB fixed"
2026-01-11T19:28:13.2785966Z                                  } else { Write-Warn "Page file setting not found" }
2026-01-11T19:28:13.2786076Z                              }
2026-01-11T19:28:13.2786854Z                          }
2026-01-11T19:28:13.2787769Z                          '2' = { # fastboot
2026-01-11T19:28:13.2789670Z                              if (Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Power" 
2026-01-11T19:28:13.2790121Z                      "HiberbootEnabled" 0 -PassThru) { Write-OK "Fast startup disabled" }
2026-01-11T19:28:13.2790927Z                          }
2026-01-11T19:28:13.2792123Z                          '3' = { # timer
2026-01-11T19:28:13.2793495Z                              Write-Host ""
2026-01-11T19:28:13.2794901Z                              Write-Host "  [!] MANUAL STEP: Timer Resolution" -ForegroundColor Yellow
2026-01-11T19:28:13.2795846Z                              Write-Host "      Download and run timer-tool.ps1 before gaming" -ForegroundColor Yellow
2026-01-11T19:28:13.2797023Z                              Write-Host "      https://github.com/thepedroferrari/rocktune" -ForegroundColor Cyan
2026-01-11T19:28:13.2797158Z                              Write-Host ""
2026-01-11T19:28:13.2797939Z                          }
2026-01-11T19:28:13.2798573Z                          '4' = { # power_plan
2026-01-11T19:28:13.2799720Z                              powercfg /setactive 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c 2>&1 | Out-Null
2026-01-11T19:28:13.2800636Z                              if ($LASTEXITCODE -eq 0) { Write-OK "High Performance power plan enabled" } else { 
2026-01-11T19:28:13.2801552Z                      Write-Warn "High Performance plan not available" }
2026-01-11T19:28:13.2801889Z                          }
2026-01-11T19:28:13.2802770Z                          '5' = { # usb_power
2026-01-11T19:28:13.2804427Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Services\USB\DisableSelectiveSuspend" 
2026-01-11T19:28:13.2804610Z                      "DisableSelectiveSuspend" 1
2026-01-11T19:28:13.2805357Z                              Write-OK "USB selective suspend disabled"
2026-01-11T19:28:13.2806093Z                          }
2026-01-11T19:28:13.2807600Z                          '6' = { # pcie_power
2026-01-11T19:28:13.2809274Z                              powercfg /setacvalueindex scheme_current sub_pciexpress 
2026-01-11T19:28:13.2809748Z                      ee12f906-d166-476a-8f3a-af931b6e9d31 0 2>&1 | Out-Null
2026-01-11T19:28:13.2810552Z                              if ($LASTEXITCODE -eq 0) {
2026-01-11T19:28:13.2811377Z                                  powercfg /setactive scheme_current 2>&1 | Out-Null
2026-01-11T19:28:13.2812049Z                                  Write-OK "PCIe power saving disabled"
2026-01-11T19:28:13.2812873Z                              } else { Write-Warn "PCIe power setting not supported" }
2026-01-11T19:28:13.2813857Z                          }
2026-01-11T19:28:13.2815074Z                          '7' = { # dns - handled separately with dnsId
2026-01-11T19:28:13.2816350Z                              # This is a placeholder - actual DNS setting is done in main logic
2026-01-11T19:28:13.2817238Z                          }
2026-01-11T19:28:13.2818136Z                          '8' = { # nagle
2026-01-11T19:28:13.2819228Z                              $adapters = Get-NetAdapter | Where-Object {$_.Status -eq "Up"}
2026-01-11T19:28:13.2819963Z                              foreach ($adapter in $adapters) {
2026-01-11T19:28:13.2820686Z                                  $path = 
2026-01-11T19:28:13.2821825Z                      "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces\$($adapter.InterfaceGuid)"
2026-01-11T19:28:13.2822428Z                                  Set-Reg $path "TcpAckFrequency" 1
2026-01-11T19:28:13.2823191Z                                  Set-Reg $path "TCPNoDelay" 1
2026-01-11T19:28:13.2824238Z                              }
2026-01-11T19:28:13.2824919Z                              Write-OK "Nagle algorithm disabled"
2026-01-11T19:28:13.2825642Z                          }
2026-01-11T19:28:13.2826508Z                          '9' = { # audio_enhancements
2026-01-11T19:28:13.2827622Z                              Set-Reg "HKCU:\Software\Microsoft\Multimedia\Audio" "UserDuckingPreference" 3
2026-01-11T19:28:13.2828561Z                              Write-OK "Audio ducking disabled"
2026-01-11T19:28:13.2829657Z                          }
2026-01-11T19:28:13.2830989Z                          '10' = { # gamedvr
2026-01-11T19:28:13.2832162Z                              Set-Reg "HKCU:\System\GameConfigStore" "GameDVR_Enabled" 0
2026-01-11T19:28:13.2833139Z                              Set-Reg "HKLM:\SOFTWARE\Policies\Microsoft\Windows\GameDVR" "AllowGameDVR" 0
2026-01-11T19:28:13.2833760Z                              Write-OK "Game DVR disabled"
2026-01-11T19:28:13.2834909Z                          }
2026-01-11T19:28:13.2835996Z                          '11' = { # background_apps
2026-01-11T19:28:13.2837020Z                              Set-Reg "HKCU:\Software\Microsoft\Windows\CurrentVersion\BackgroundAccessApplications" 
2026-01-11T19:28:13.2837191Z                      "GlobalUserDisabled" 1
2026-01-11T19:28:13.2837354Z                              Write-OK "Background apps disabled"
2026-01-11T19:28:13.2837653Z                          }
2026-01-11T19:28:13.2838598Z                          '12' = { # edge_debloat
2026-01-11T19:28:13.2839180Z                              Set-Reg "HKLM:\SOFTWARE\Policies\Microsoft\Edge" "HideFirstRunExperience" 1
2026-01-11T19:28:13.2839928Z                              Set-Reg "HKLM:\SOFTWARE\Policies\Microsoft\Edge" "EdgeShoppingAssistantEnabled" 0
2026-01-11T19:28:13.2840288Z                              Set-Reg "HKLM:\SOFTWARE\Policies\Microsoft\Edge" "WebWidgetAllowed" 0
2026-01-11T19:28:13.2840441Z                              Write-OK "Edge debloated"
2026-01-11T19:28:13.2840742Z                          }
2026-01-11T19:28:13.2841346Z                          '13' = { # copilot_disable
2026-01-11T19:28:13.2842220Z                              Set-Reg "HKCU:\Software\Policies\Microsoft\Windows\WindowsCopilot" 
2026-01-11T19:28:13.2842374Z                      "TurnOffWindowsCopilot" 1
2026-01-11T19:28:13.2842621Z                              Write-OK "Copilot disabled"
2026-01-11T19:28:13.2843407Z                          }
2026-01-11T19:28:13.2844267Z                          '14' = { # explorer_speed
2026-01-11T19:28:13.2845734Z                              Set-Reg "HKCU:\Software\Classes\Local 
2026-01-11T19:28:13.2846267Z                      Settings\Software\Microsoft\Windows\Shell\Bags\AllFolders\Shell" "FolderType" "NotSpecified" 
2026-01-11T19:28:13.2846375Z                      "String"
2026-01-11T19:28:13.2847372Z                              Write-OK "Explorer speed optimized"
2026-01-11T19:28:13.2847707Z                          }
2026-01-11T19:28:13.2847982Z                          '15' = { # temp_purge
2026-01-11T19:28:13.2848543Z                              $itemsRemoved = 0
2026-01-11T19:28:13.2849443Z                              if ($env:TEMP -and (Test-Path $env:TEMP)) {
2026-01-11T19:28:13.2849720Z                                  $tempPath = [System.IO.Path]::GetFullPath($env:TEMP)
2026-01-11T19:28:13.2850013Z                                  if ($tempPath -like "*\Temp*" -or $tempPath -like "*\tmp*") {
2026-01-11T19:28:13.2850588Z                                      Get-ChildItem $tempPath -Force -EA SilentlyContinue | ForEach-Object {
2026-01-11T19:28:13.2851154Z                                          try { Remove-Item $_.FullName -Recurse -Force -EA Stop; $itemsRemoved++ } 
2026-01-11T19:28:13.2851452Z                      catch {}
2026-01-11T19:28:13.2852101Z                                      }
2026-01-11T19:28:13.2852235Z                                  }
2026-01-11T19:28:13.2853162Z                              }
2026-01-11T19:28:13.2853407Z                              $winTemp = Join-Path $env:WINDIR "Temp"
2026-01-11T19:28:13.2853827Z                              if (Test-Path $winTemp) {
2026-01-11T19:28:13.2854937Z                                  Get-ChildItem $winTemp -Force -EA SilentlyContinue | ForEach-Object {
2026-01-11T19:28:13.2855610Z                                      try { Remove-Item $_.FullName -Recurse -Force -EA Stop; $itemsRemoved++ } catch {}
2026-01-11T19:28:13.2855729Z                                  }
2026-01-11T19:28:13.2855814Z                              }
2026-01-11T19:28:13.2856084Z                              Write-OK "Temp folders purged ($itemsRemoved items)"
2026-01-11T19:28:13.2856355Z                          }
2026-01-11T19:28:13.2857022Z                          '16' = { # razer_block
2026-01-11T19:28:13.2858077Z                              Get-Service | Where-Object {$_.Name -like "Razer*"} | Stop-Service -Force -EA 
2026-01-11T19:28:13.2858681Z                      SilentlyContinue
2026-01-11T19:28:13.2859783Z                              Get-Service | Where-Object {$_.Name -like "Razer*"} | Set-Service -StartupType Disabled 
2026-01-11T19:28:13.2860189Z                      -EA SilentlyContinue
2026-01-11T19:28:13.2860974Z                              Write-OK "Razer services blocked"
2026-01-11T19:28:13.2861494Z                          }
2026-01-11T19:28:13.2862302Z                          '17' = { # restore_point
2026-01-11T19:28:13.2862547Z                              $recentRestorePoint = $null
2026-01-11T19:28:13.2862762Z                              # Check if System Protection is enabled first
2026-01-11T19:28:13.2863676Z                              $srEnabled = $false
2026-01-11T19:28:13.2864395Z                              try {
2026-01-11T19:28:13.2864689Z                                  $sr = Get-ItemProperty "HKLM:\SOFTWARE\Microsoft\Windows 
2026-01-11T19:28:13.2865532Z                      NT\CurrentVersion\SystemRestore" -Name "RPSessionInterval" -EA SilentlyContinue
2026-01-11T19:28:13.2866016Z                                  $srEnabled = ($null -ne $sr -and $sr.RPSessionInterval -ne 0)
2026-01-11T19:28:13.2866126Z                              } catch { }
2026-01-11T19:28:13.2866228Z                      
2026-01-11T19:28:13.2866472Z                              if (-not $srEnabled) {
2026-01-11T19:28:13.2867498Z                                  Write-Warn "System Restore disabled (enable in System Protection to create restore 
2026-01-11T19:28:13.2867615Z                      points)"
2026-01-11T19:28:13.2867737Z                              } else {
2026-01-11T19:28:13.2869657Z                                  try { $recentRestorePoint = Get-ComputerRestorePoint -EA Stop | Sort-Object 
2026-01-11T19:28:13.2870174Z                      CreationTime -Descending | Select-Object -First 1 } catch { $recentRestorePoint = $null }
2026-01-11T19:28:13.2871586Z                                  if ($recentRestorePoint -and $recentRestorePoint.CreationTime -gt 
2026-01-11T19:28:13.2871736Z                      (Get-Date).AddMinutes(-1440)) {
2026-01-11T19:28:13.2872145Z                                      Write-Warn "Restore point already created within last 24 hours (skipped)"
2026-01-11T19:28:13.2872251Z                                  } else {
2026-01-11T19:28:13.2872358Z                                      try {
2026-01-11T19:28:13.2873531Z                                          Checkpoint-Computer -Description "Before RockTune" -RestorePointType 
2026-01-11T19:28:13.2873818Z                      MODIFY_SETTINGS -EA Stop -WarningAction SilentlyContinue
2026-01-11T19:28:13.2874048Z                                          Write-OK "Restore point created"
2026-01-11T19:28:13.2874400Z                                      } catch {
2026-01-11T19:28:13.2875131Z                                          Write-Warn "Could not create restore point (System Restore may be disabled)"
2026-01-11T19:28:13.2875469Z                                      }
2026-01-11T19:28:13.2876121Z                                  }
2026-01-11T19:28:13.2876772Z                              }
2026-01-11T19:28:13.2877510Z                          }
2026-01-11T19:28:13.2877679Z                          '18' = { # classic_menu
2026-01-11T19:28:13.2878107Z                              if (-not $script:IsWin11) {
2026-01-11T19:28:13.2878776Z                                  Write-Warn "Classic context menu is a Windows 11 feature (Win10 already has it)"
2026-01-11T19:28:13.2878896Z                                  return
2026-01-11T19:28:13.2878995Z                              }
2026-01-11T19:28:13.2879233Z                              $clsid = "{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}"
2026-01-11T19:28:13.2879992Z                              $path = "HKCU:\Software\Classes\CLSID\$clsid\InprocServer32"
2026-01-11T19:28:13.2880438Z                              if (-not (Test-Path $path)) { New-Item -Path $path -Force | Out-Null }
2026-01-11T19:28:13.2880811Z                              Set-ItemProperty -Path $path -Name "(Default)" -Value ""
2026-01-11T19:28:13.2881112Z                              Write-OK "Classic context menu enabled"
2026-01-11T19:28:13.2881401Z                          }
2026-01-11T19:28:13.2882218Z                          '19' = { # storage_sense
2026-01-11T19:28:13.2882920Z                              Set-Reg 
2026-01-11T19:28:13.2884669Z                      "HKCU:\Software\Microsoft\Windows\CurrentVersion\StorageSense\Parameters\StoragePolicy" "01" 0
2026-01-11T19:28:13.2884860Z                              Write-OK "Storage Sense disabled"
2026-01-11T19:28:13.2884955Z                          }
2026-01-11T19:28:13.2885301Z                          '20' = { # display_perf
2026-01-11T19:28:13.2885974Z                              Set-Reg "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects" 
2026-01-11T19:28:13.2886115Z                      "VisualFXSetting" 2
2026-01-11T19:28:13.2886324Z                              Write-OK "Visual effects set to performance"
2026-01-11T19:28:13.2886550Z                          }
2026-01-11T19:28:13.2886781Z                          '21' = { # end_task
2026-01-11T19:28:13.2887312Z                              if (-not $script:IsWin11) {
2026-01-11T19:28:13.2888019Z                                  Write-Warn "End Task in taskbar is a Windows 11 feature"
2026-01-11T19:28:13.2888497Z                                  return
2026-01-11T19:28:13.2889130Z                              }
2026-01-11T19:28:13.2890370Z                              if (Set-Reg 
2026-01-11T19:28:13.2891990Z                      "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced\TaskbarDeveloperSettings" 
2026-01-11T19:28:13.2892697Z                      "TaskbarEndTask" 1 -PassThru) { Write-OK "End Task enabled in taskbar" }
2026-01-11T19:28:13.2892804Z                          }
2026-01-11T19:28:13.2893179Z                          '22' = { # explorer_cleanup
2026-01-11T19:28:13.2893329Z                              if (-not $script:IsWin11) {
2026-01-11T19:28:13.2894038Z                                  Write-Warn "Explorer Home/Gallery are Windows 11 features (Win10 doesn't have them)"
2026-01-11T19:28:13.2894258Z                                  return
2026-01-11T19:28:13.2894930Z                              }
2026-01-11T19:28:13.2896496Z                              Remove-Item "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Desktop\NameSpace\{f
2026-01-11T19:28:13.2897259Z                      874310e-b6b7-47dc-bc84-b9e6b38f5903}" -Force -EA SilentlyContinue
2026-01-11T19:28:13.2898145Z                              Remove-Item "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Desktop\NameSpace\{e
2026-01-11T19:28:13.2898492Z                      88865ea-0e1c-4e20-9aa6-edcd0212c87c}" -Force -EA SilentlyContinue
2026-01-11T19:28:13.2898681Z                              Write-OK "Explorer clutter removed"
2026-01-11T19:28:13.2898775Z                          }
2026-01-11T19:28:13.2898912Z                          '23' = { # notifications_off
2026-01-11T19:28:13.2899435Z                              Set-Reg "HKCU:\Software\Policies\Microsoft\Windows\Explorer" "DisableNotificationCenter" 1
2026-01-11T19:28:13.2899836Z                              Set-Reg "HKCU:\Software\Microsoft\Windows\CurrentVersion\PushNotifications" 
2026-01-11T19:28:13.2899983Z                      "ToastEnabled" 0
2026-01-11T19:28:13.2900450Z                              Write-OK "Notifications disabled"
2026-01-11T19:28:13.2901931Z                          }
2026-01-11T19:28:13.2902401Z                          '24' = { # ps7_telemetry
2026-01-11T19:28:13.2902993Z                              [Environment]::SetEnvironmentVariable("POWERSHELL_TELEMETRY_OPTOUT", "1", "Machine")
2026-01-11T19:28:13.2903159Z                              Write-OK "PS7 telemetry disabled"
2026-01-11T19:28:13.2903276Z                          }
2026-01-11T19:28:13.2903433Z                          '25' = { # multiplane_overlay
2026-01-11T19:28:13.2904388Z                              Set-Reg "HKLM:\SOFTWARE\Microsoft\Windows\Dwm" "OverlayTestMode" 5
2026-01-11T19:28:13.2904931Z                              Write-OK "Multiplane Overlay disabled"
2026-01-11T19:28:13.2905591Z                          }
2026-01-11T19:28:13.2906356Z                          '26' = { # mouse_accel
2026-01-11T19:28:13.2907505Z                              if (Set-Reg "HKCU:\Control Panel\Mouse" "MouseSpeed" 0 -PassThru) { Write-OK "Mouse 
2026-01-11T19:28:13.2907765Z                      acceleration disabled" }
2026-01-11T19:28:13.2909174Z                              Set-Reg "HKCU:\Control Panel\Mouse" "MouseThreshold1" 0
2026-01-11T19:28:13.2909463Z                              Set-Reg "HKCU:\Control Panel\Mouse" "MouseThreshold2" 0
2026-01-11T19:28:13.2909565Z                          }
2026-01-11T19:28:13.2909716Z                          '27' = { # usb_suspend
2026-01-11T19:28:13.2910555Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Services\USB\DisableSelectiveSuspend" 
2026-01-11T19:28:13.2910885Z                      "DisableSelectiveSuspend" 1
2026-01-11T19:28:13.2911081Z                              Write-OK "USB selective suspend disabled"
2026-01-11T19:28:13.2911636Z                          }
2026-01-11T19:28:13.2911831Z                          '28' = { # keyboard_response
2026-01-11T19:28:13.2912984Z                              if (Set-Reg "HKCU:\Control Panel\Keyboard" "KeyboardDelay" 0 -PassThru) { Write-OK 
2026-01-11T19:28:13.2913147Z                      "Keyboard delay minimized" }
2026-01-11T19:28:13.2913424Z                              Set-Reg "HKCU:\Control Panel\Keyboard" "KeyboardSpeed" 31
2026-01-11T19:28:13.2913673Z                          }
2026-01-11T19:28:13.2914647Z                          '29' = { # game_mode
2026-01-11T19:28:13.2915174Z                              Set-Reg "HKCU:\Software\Microsoft\GameBar" "AllowAutoGameMode" 1
2026-01-11T19:28:13.2915507Z                              Set-Reg "HKCU:\Software\Microsoft\GameBar" "AutoGameModeEnabled" 1
2026-01-11T19:28:13.2915662Z                              Write-OK "Game Mode enabled"
2026-01-11T19:28:13.2915972Z                          }
2026-01-11T19:28:13.2916942Z                          '30' = { # min_processor_state
2026-01-11T19:28:13.2917450Z                              powercfg /setacvalueindex scheme_current sub_processor PROCTHROTTLEMIN 5 2>&1 | Out-Null
2026-01-11T19:28:13.2917626Z                              if ($LASTEXITCODE -eq 0) {
2026-01-11T19:28:13.2918317Z                                  powercfg /setactive scheme_current 2>&1 | Out-Null
2026-01-11T19:28:13.2918932Z                                  Write-OK "Min processor state set to 5%"
2026-01-11T19:28:13.2919375Z                              } else { Write-Warn "Min processor state setting not supported" }
2026-01-11T19:28:13.2919578Z                          }
2026-01-11T19:28:13.2920021Z                          '31' = { # hibernation_disable
2026-01-11T19:28:13.2920616Z                              powercfg /hibernate off 2>&1 | Out-Null
2026-01-11T19:28:13.2923145Z                              if ($LASTEXITCODE -eq 0) { Write-OK "Hibernation disabled" } else { Write-Warn "Could not 
2026-01-11T19:28:13.2923310Z                      disable hibernation" }
2026-01-11T19:28:13.2923403Z                          }
2026-01-11T19:28:13.2923519Z                          '32' = { # rss_enable
2026-01-11T19:28:13.2923886Z                              Get-NetAdapter | Where-Object {$_.Status -eq "Up"} | ForEach-Object {
2026-01-11T19:28:13.2924177Z                                  Enable-NetAdapterRss -Name $_.Name -EA SilentlyContinue
2026-01-11T19:28:13.2924432Z                              }
2026-01-11T19:28:13.2925062Z                              Write-OK "RSS enabled on active adapters"
2026-01-11T19:28:13.2925655Z                          }
2026-01-11T19:28:13.2926012Z                          '33' = { # adapter_power
2026-01-11T19:28:13.2926647Z                              Get-NetAdapter | Where-Object {$_.Status -eq "Up"} | ForEach-Object {
2026-01-11T19:28:13.2927822Z                                  Set-NetAdapterPowerManagement -Name $_.Name -WakeOnMagicPacket Disabled 
2026-01-11T19:28:13.2928057Z                      -WakeOnPattern Disabled -EA SilentlyContinue
2026-01-11T19:28:13.2928641Z                              }
2026-01-11T19:28:13.2929056Z                              Write-OK "Network adapter power saving disabled"
2026-01-11T19:28:13.2929316Z                          }
2026-01-11T19:28:13.2929925Z                          '34' = { # delivery_opt
2026-01-11T19:28:13.2931382Z                              Set-Reg "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\DeliveryOptimization\Config" 
2026-01-11T19:28:13.2931533Z                      "DODownloadMode" 0
2026-01-11T19:28:13.2931768Z                              Write-OK "Delivery Optimization P2P disabled"
2026-01-11T19:28:13.2931919Z                          }
2026-01-11T19:28:13.2932807Z                          '35' = { # wer_disable
2026-01-11T19:28:13.2933409Z                              Set-Reg "HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting" "Disabled" 1
2026-01-11T19:28:13.2933683Z                              Stop-Service WerSvc -Force -EA SilentlyContinue
2026-01-11T19:28:13.2934231Z                              Set-Service WerSvc -StartupType Disabled -EA SilentlyContinue
2026-01-11T19:28:13.2934539Z                              Write-OK "Windows Error Reporting disabled"
2026-01-11T19:28:13.2934812Z                          }
2026-01-11T19:28:13.2935218Z                          '36' = { # wifi_sense
2026-01-11T19:28:13.2936389Z                              Set-Reg "HKLM:\SOFTWARE\Microsoft\WcmSvc\wifinetworkmanager\config" 
2026-01-11T19:28:13.2936545Z                      "AutoConnectAllowedOEM" 0
2026-01-11T19:28:13.2936908Z                              Write-OK "WiFi Sense disabled"
2026-01-11T19:28:13.2937156Z                          }
2026-01-11T19:28:13.2937751Z                          '37' = { # spotlight_disable
2026-01-11T19:28:13.2938594Z                              Set-Reg "HKCU:\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" 
2026-01-11T19:28:13.2938924Z                      "RotatingLockScreenEnabled" 0
2026-01-11T19:28:13.2939906Z                              Set-Reg "HKCU:\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" 
2026-01-11T19:28:13.2940097Z                      "RotatingLockScreenOverlayEnabled" 0
2026-01-11T19:28:13.2940681Z                              Write-OK "Windows Spotlight disabled"
2026-01-11T19:28:13.2940829Z                          }
2026-01-11T19:28:13.2941381Z                          '38' = { # feedback_disable
2026-01-11T19:28:13.2942207Z                              Set-Reg "HKCU:\Software\Microsoft\Siuf\Rules" "NumberOfSIUFInPeriod" 0
2026-01-11T19:28:13.2943149Z                              Write-OK "Windows Feedback prompts disabled"
2026-01-11T19:28:13.2943249Z                          }
2026-01-11T19:28:13.2943652Z                          '39' = { # clipboard_sync
2026-01-11T19:28:13.2944745Z                              Set-Reg "HKCU:\Software\Microsoft\Clipboard" "EnableClipboardHistory" 0
2026-01-11T19:28:13.2944988Z                              Write-OK "Cloud Clipboard sync disabled"
2026-01-11T19:28:13.2945226Z                          }
2026-01-11T19:28:13.2945449Z                          '40' = { # accessibility_shortcuts
2026-01-11T19:28:13.2946858Z                              Set-Reg "HKCU:\Control Panel\Accessibility\StickyKeys" "Flags" "506" "String"
2026-01-11T19:28:13.2947592Z                              Set-Reg "HKCU:\Control Panel\Accessibility\Keyboard Response" "Flags" "122" "String"
2026-01-11T19:28:13.2948104Z                              Set-Reg "HKCU:\Control Panel\Accessibility\ToggleKeys" "Flags" "58" "String"
2026-01-11T19:28:13.2949198Z                              Set-Reg "HKCU:\Control Panel\Accessibility\MouseKeys" "Flags" "58" "String"
2026-01-11T19:28:13.2949587Z                              Write-OK "Accessibility shortcuts disabled (no more Sticky Keys popup)"
2026-01-11T19:28:13.2949705Z                          }
2026-01-11T19:28:13.2949845Z                          '41' = { # audio_communications
2026-01-11T19:28:13.2950267Z                              Set-Reg "HKCU:\Software\Microsoft\Multimedia\Audio" "UserDuckingPreference" 3
2026-01-11T19:28:13.2951089Z                              Write-OK "Volume ducking disabled (full volume during calls)"
2026-01-11T19:28:13.2951210Z                          }
2026-01-11T19:28:13.2951562Z                          '42' = { # audio_system_sounds
2026-01-11T19:28:13.2951878Z                              Set-Reg "HKCU:\AppEvents\Schemes" "(Default)" ".None" "String"
2026-01-11T19:28:13.2952383Z                              Get-ChildItem "HKCU:\AppEvents\Schemes\Apps" -Recurse | Where-Object {$_.PSChildName -eq 
2026-01-11T19:28:13.2952903Z                      ".Current"} | ForEach-Object { Set-ItemProperty -Path $_.PSPath -Name "(Default)" -Value "" -EA 
2026-01-11T19:28:13.2953074Z                      SilentlyContinue }
2026-01-11T19:28:13.2953961Z                              Write-OK "Windows system sounds muted"
2026-01-11T19:28:13.2954488Z                          }
2026-01-11T19:28:13.2955245Z                          '43' = { # input_buffer
2026-01-11T19:28:13.2956417Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Services\mouclass\Parameters" 
2026-01-11T19:28:13.2956576Z                      "MouseDataQueueSize" 32
2026-01-11T19:28:13.2957720Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Services\kbdclass\Parameters" 
2026-01-11T19:28:13.2957871Z                      "KeyboardDataQueueSize" 32
2026-01-11T19:28:13.2958640Z                              Write-OK "Input buffer size increased (prevents drops at 8000Hz)"
2026-01-11T19:28:13.2959099Z                          }
2026-01-11T19:28:13.2959840Z                          '44' = { # filesystem_perf
2026-01-11T19:28:13.2960633Z                              fsutil behavior set disablelastaccess 1 >$null 2>&1
2026-01-11T19:28:13.2961319Z                              fsutil behavior set disable8dot3 1 >$null 2>&1
2026-01-11T19:28:13.2962965Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Control\FileSystem" "NtfsMemoryUsage" 2
2026-01-11T19:28:13.2963212Z                              Write-OK "Filesystem performance optimized"
2026-01-11T19:28:13.2963526Z                          }
2026-01-11T19:28:13.2964118Z                          '45' = { # dwm_perf
2026-01-11T19:28:13.2965101Z                              Set-Reg "HKCU:\Software\Microsoft\Windows\DWM" "AccentColorInactive" 1
2026-01-11T19:28:13.2965684Z                              Set-Reg "HKCU:\Software\Microsoft\Windows\DWM" "ColorPrevalence" 0
2026-01-11T19:28:13.2966283Z                              Set-Reg "HKCU:\Software\Microsoft\Windows\DWM" "EnableAeroPeek" 0
2026-01-11T19:28:13.2966725Z                              Write-OK "DWM performance optimized"
2026-01-11T19:28:13.2967298Z                          }
2026-01-11T19:28:13.2967928Z                      
2026-01-11T19:28:13.2968660Z                          # CAUTION tier (50-72)
2026-01-11T19:28:13.2969311Z                          '50' = { # msi_mode
2026-01-11T19:28:13.2970881Z                              $gpu = Get-PnpDevice -Class Display | Where-Object {$_.Status -eq "OK"} | Select-Object 
2026-01-11T19:28:13.2970997Z                      -First 1
2026-01-11T19:28:13.2971565Z                              if ($gpu) {
2026-01-11T19:28:13.2973017Z                                  $msiPath = "HKLM:\SYSTEM\CurrentControlSet\Enum\$($gpu.InstanceId)\Device 
2026-01-11T19:28:13.2973423Z                      Parameters\Interrupt Management\MessageSignaledInterruptProperties"
2026-01-11T19:28:13.2974492Z                                  if (Test-Path $msiPath) { Set-Reg $msiPath "MSISupported" 1; Write-OK "MSI mode 
2026-01-11T19:28:13.2974641Z                      enabled for GPU" }
2026-01-11T19:28:13.2975240Z                              }
2026-01-11T19:28:13.2975888Z                          }
2026-01-11T19:28:13.2976525Z                          '51' = { # hpet
2026-01-11T19:28:13.2977252Z                              bcdedit /set useplatformclock false 2>$null
2026-01-11T19:28:13.2977960Z                              bcdedit /set disabledynamictick yes 2>$null
2026-01-11T19:28:13.2978659Z                              Write-OK "HPET disabled (reboot required)"
2026-01-11T19:28:13.2979240Z                          }
2026-01-11T19:28:13.2980137Z                          '52' = { # game_bar
2026-01-11T19:28:13.2980861Z                              Set-Reg "HKCU:\Software\Microsoft\GameBar" "ShowStartupPanel" 0
2026-01-11T19:28:13.2981395Z                              Set-Reg "HKCU:\Software\Microsoft\GameBar" "GamePanelStartupTipIndex" 3
2026-01-11T19:28:13.2981678Z                              Write-OK "Game Bar overlays disabled"
2026-01-11T19:28:13.2982805Z                          }
2026-01-11T19:28:13.2983196Z                          '53' = { # hags
2026-01-11T19:28:13.2984702Z                              if (Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Control\GraphicsDrivers" "HwSchMode" 2 
2026-01-11T19:28:13.2984891Z                      -PassThru) { Write-OK "HAGS enabled" }
2026-01-11T19:28:13.2984985Z                          }
2026-01-11T19:28:13.2985249Z                          '54' = { # fso_disable
2026-01-11T19:28:13.2986186Z                              Set-Reg "HKCU:\System\GameConfigStore" "GameDVR_FSEBehaviorMode" 2
2026-01-11T19:28:13.2986604Z                              Set-Reg "HKCU:\System\GameConfigStore" "GameDVR_HonorUserFSEBehaviorMode" 1
2026-01-11T19:28:13.2986925Z                              Set-Reg "HKCU:\System\GameConfigStore" "GameDVR_FSEBehavior" 2
2026-01-11T19:28:13.2987400Z                              Write-OK "Fullscreen optimizations disabled"
2026-01-11T19:28:13.2987707Z                          }
2026-01-11T19:28:13.2989076Z                          '55' = { # ultimate_perf
2026-01-11T19:28:13.2989512Z                              powercfg /duplicatescheme e9a42b02-d5df-448d-aa00-03f14749eb61 >$null 2>&1
2026-01-11T19:28:13.2989758Z                              $planOutput = powercfg /list 2>&1
2026-01-11T19:28:13.2990748Z                              $plans = $planOutput | Select-String "Ultimate Performance"
2026-01-11T19:28:13.2990906Z                              if ($plans) {
2026-01-11T19:28:13.2991923Z                                  $guidMatch = [regex]::Match($plans.Line, "([A-Fa-f0-9-]{36})")
2026-01-11T19:28:13.2992491Z                                  if ($guidMatch.Success) {
2026-01-11T19:28:13.2992653Z                                      $guid = $guidMatch.Value
2026-01-11T19:28:13.2993246Z                                      powercfg /setactive $guid 2>&1 | Out-Null
2026-01-11T19:28:13.2993679Z                                      if ($LASTEXITCODE -eq 0) { Write-OK "Ultimate Performance enabled" } else { 
2026-01-11T19:28:13.2993924Z                      Write-Warn "Could not activate Ultimate Performance" }
2026-01-11T19:28:13.2994442Z                                  } else { Write-Warn "Could not parse Ultimate Performance GUID" }
2026-01-11T19:28:13.2994799Z                              } else { Write-Warn "Ultimate Performance plan not available" }
2026-01-11T19:28:13.2994982Z                          }
2026-01-11T19:28:13.2995403Z                          '56' = { # services_trim
2026-01-11T19:28:13.2996109Z                              $trimSvc = @("DiagTrack","dmwappushservice","lfsvc","RetailDemo","Fax","SharedAccess")
2026-01-11T19:28:13.2997268Z                              foreach ($s in $trimSvc) { Set-Service $s -StartupType Manual -EA SilentlyContinue; 
2026-01-11T19:28:13.2997828Z                      Stop-Service $s -Force -EA SilentlyContinue }
2026-01-11T19:28:13.2997984Z                              Write-OK "Services trimmed"
2026-01-11T19:28:13.2998076Z                          }
2026-01-11T19:28:13.2998875Z                          '57' = { # disk_cleanup
2026-01-11T19:28:13.2999310Z                              Start-Process "cleanmgr.exe" -ArgumentList "/sagerun:100" -Wait -WindowStyle Hidden
2026-01-11T19:28:13.2999853Z                              Write-OK "Disk cleanup complete"
2026-01-11T19:28:13.2999981Z                          }
2026-01-11T19:28:13.3000119Z                          '58' = { # wpbt_disable
2026-01-11T19:28:13.3001012Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager" "DisableWpbtExecution" 1
2026-01-11T19:28:13.3001901Z                              Write-OK "WPBT disabled (blocks OEM bloatware)"
2026-01-11T19:28:13.3002350Z                          }
2026-01-11T19:28:13.3003298Z                          '59' = { # qos_gaming
2026-01-11T19:28:13.3004816Z                              Set-Reg "HKLM:\SOFTWARE\Policies\Microsoft\Windows\Psched" "NonBestEffortLimit" 0
2026-01-11T19:28:13.3005008Z                              Write-OK "QoS gaming configured"
2026-01-11T19:28:13.3005604Z                          }
2026-01-11T19:28:13.3006197Z                          '60' = { # network_throttling
2026-01-11T19:28:13.3007339Z                              Set-Reg "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile" 
2026-01-11T19:28:13.3007813Z                      "NetworkThrottlingIndex" 0xffffffff
2026-01-11T19:28:13.3008643Z                              Write-OK "Network throttling disabled"
2026-01-11T19:28:13.3009127Z                          }
2026-01-11T19:28:13.3009912Z                          '61' = { # interrupt_affinity
2026-01-11T19:28:13.3010889Z                              $gpu = Get-PnpDevice -Class Display | Where-Object {$_.Status -eq "OK"} | Select-Object 
2026-01-11T19:28:13.3011236Z                      -First 1
2026-01-11T19:28:13.3011977Z                              if ($gpu) {
2026-01-11T19:28:13.3012992Z                                  $affPath = "HKLM:\SYSTEM\CurrentControlSet\Enum\$($gpu.InstanceId)\Device 
2026-01-11T19:28:13.3013428Z                      Parameters\Interrupt Management\Affinity Policy"
2026-01-11T19:28:13.3014382Z                                  if (-not (Test-Path $affPath)) { New-Item -Path $affPath -Force | Out-Null }
2026-01-11T19:28:13.3014822Z                                  Set-Reg $affPath "DevicePolicy" 3
2026-01-11T19:28:13.3015496Z                                  Set-Reg $affPath "AssignmentSetOverride" 1
2026-01-11T19:28:13.3016155Z                                  Write-OK "GPU interrupt affinity set to CPU 0"
2026-01-11T19:28:13.3016828Z                              }
2026-01-11T19:28:13.3017365Z                          }
2026-01-11T19:28:13.3018084Z                          '62' = { # process_mitigation
2026-01-11T19:28:13.3019024Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\kernel" 
2026-01-11T19:28:13.3019368Z                      "KernelShadowStacksForceDisabled" 1
2026-01-11T19:28:13.3020196Z                              Write-OK "Process mitigations disabled (security reduced)"
2026-01-11T19:28:13.3020601Z                          }
2026-01-11T19:28:13.3021230Z                          '63' = { # mmcss_gaming
2026-01-11T19:28:13.3022098Z                              $mmcss = "HKLM:\SOFTWARE\Microsoft\Windows 
2026-01-11T19:28:13.3022663Z                      NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games"
2026-01-11T19:28:13.3023614Z                              Set-Reg $mmcss "GPU Priority" 8
2026-01-11T19:28:13.3023812Z                              Set-Reg $mmcss "Priority" 6
2026-01-11T19:28:13.3024715Z                              Set-Reg $mmcss "Scheduling Category" "High" "String"
2026-01-11T19:28:13.3025223Z                              Set-Reg $mmcss "SFIO Priority" "High" "String"
2026-01-11T19:28:13.3025861Z                              Write-OK "MMCSS gaming priority configured"
2026-01-11T19:28:13.3026315Z                          }
2026-01-11T19:28:13.3026970Z                          '64' = { # scheduler_opt
2026-01-11T19:28:13.3027835Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Control\PriorityControl" 
2026-01-11T19:28:13.3028399Z                      "Win32PrioritySeparation" 26
2026-01-11T19:28:13.3029513Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Control\PriorityControl" "IRQ8Priority" 1
2026-01-11T19:28:13.3029729Z                              Write-OK "Scheduler optimized for gaming"
2026-01-11T19:28:13.3030384Z                          }
2026-01-11T19:28:13.3030934Z                          '65' = { # core_parking
2026-01-11T19:28:13.3032225Z                              powercfg /setacvalueindex scheme_current sub_processor CPMINCORES 100 2>&1 | Out-Null
2026-01-11T19:28:13.3032414Z                              if ($LASTEXITCODE -eq 0) {
2026-01-11T19:28:13.3033105Z                                  powercfg /setactive scheme_current 2>&1 | Out-Null
2026-01-11T19:28:13.3033648Z                                  Write-OK "Core parking disabled"
2026-01-11T19:28:13.3034323Z                              } else { Write-Warn "Core parking setting not supported" }
2026-01-11T19:28:13.3034754Z                          }
2026-01-11T19:28:13.3035629Z                          '66' = { # timer_registry
2026-01-11T19:28:13.3036437Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\kernel" 
2026-01-11T19:28:13.3037031Z                      "GlobalTimerResolutionRequests" 1
2026-01-11T19:28:13.3037957Z                              Set-Reg "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile" 
2026-01-11T19:28:13.3038299Z                      "SystemResponsiveness" 0
2026-01-11T19:28:13.3039066Z                              Write-OK "Timer resolution registry configured"
2026-01-11T19:28:13.3039768Z                          }
2026-01-11T19:28:13.3040387Z                          '67' = { # rsc_disable
2026-01-11T19:28:13.3041320Z                              Get-NetAdapter | Where-Object {$_.Status -eq "Up"} | ForEach-Object {
2026-01-11T19:28:13.3042073Z                                  Disable-NetAdapterRsc -Name $_.Name -EA SilentlyContinue
2026-01-11T19:28:13.3042501Z                              }
2026-01-11T19:28:13.3043326Z                              Write-OK "RSC disabled on active adapters"
2026-01-11T19:28:13.3044240Z                          }
2026-01-11T19:28:13.3045171Z                          '68' = { # sysmain_disable
2026-01-11T19:28:13.3045807Z                              Stop-Service SysMain -Force -EA SilentlyContinue
2026-01-11T19:28:13.3046895Z                              Set-Service SysMain -StartupType Disabled -EA SilentlyContinue
2026-01-11T19:28:13.3047107Z                              Write-OK "SysMain/Superfetch disabled"
2026-01-11T19:28:13.3047735Z                          }
2026-01-11T19:28:13.3048529Z                          '69' = { # services_search_off
2026-01-11T19:28:13.3049182Z                              Stop-Service WSearch -Force -EA SilentlyContinue
2026-01-11T19:28:13.3050312Z                              Set-Service WSearch -StartupType Manual -EA SilentlyContinue
2026-01-11T19:28:13.3050659Z                              Write-OK "Windows Search set to Manual (stops disk indexing)"
2026-01-11T19:28:13.3051248Z                          }
2026-01-11T19:28:13.3051851Z                          '70' = { # memory_gaming
2026-01-11T19:28:13.3052965Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management" 
2026-01-11T19:28:13.3053381Z                      "DisablePagingExecutive" 1
2026-01-11T19:28:13.3054473Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management" 
2026-01-11T19:28:13.3054825Z                      "LargeSystemCache" 0
2026-01-11T19:28:13.3055946Z                              Write-OK "Memory gaming mode enabled (kernel stays in RAM)"
2026-01-11T19:28:13.3056108Z                          }
2026-01-11T19:28:13.3056904Z                          '71' = { # power_throttle_off
2026-01-11T19:28:13.3058323Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Control\Power\PowerThrottling" 
2026-01-11T19:28:13.3058494Z                      "PowerThrottlingOff" 1
2026-01-11T19:28:13.3059375Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Power" 
2026-01-11T19:28:13.3060095Z                      "EcoQosPolicyDisabled" 1
2026-01-11T19:28:13.3061457Z                              Write-OK "Power throttling disabled"
2026-01-11T19:28:13.3061587Z                          }
2026-01-11T19:28:13.3062027Z                          '72' = { # priority_boost_off
2026-01-11T19:28:13.3063601Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Control\PriorityControl" "Win32PriorityBoost" 0
2026-01-11T19:28:13.3064214Z                              Write-OK "Priority boost disabled (consistent scheduling)"
2026-01-11T19:28:13.3064858Z                          }
2026-01-11T19:28:13.3065466Z                      
2026-01-11T19:28:13.3066195Z                          # RISKY tier (80-89)
2026-01-11T19:28:13.3067175Z                          '80' = { # privacy_tier1
2026-01-11T19:28:13.3067803Z                              Set-Reg "HKCU:\Software\Microsoft\Windows\CurrentVersion\AdvertisingInfo" "Enabled" 0
2026-01-11T19:28:13.3068658Z                              Set-Reg "HKCU:\Software\Microsoft\Windows\CurrentVersion\Privacy" 
2026-01-11T19:28:13.3068926Z                      "TailoredExperiencesWithDiagnosticDataEnabled" 0
2026-01-11T19:28:13.3069205Z                              Write-OK "Advertising ID and tailored experiences disabled"
2026-01-11T19:28:13.3069527Z                          }
2026-01-11T19:28:13.3069646Z                          '81' = { # privacy_tier2
2026-01-11T19:28:13.3070098Z                              Set-Reg "HKLM:\SOFTWARE\Policies\Microsoft\Windows\DataCollection" "AllowTelemetry" 0
2026-01-11T19:28:13.3070511Z                              Set-Reg "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" 
2026-01-11T19:28:13.3070765Z                      "Start_TrackProgs" 0
2026-01-11T19:28:13.3071238Z                              Write-OK "Telemetry minimized"
2026-01-11T19:28:13.3072177Z                          }
2026-01-11T19:28:13.3072350Z                          '82' = { # privacy_tier3
2026-01-11T19:28:13.3073135Z                              $xboxSvc = @("XblAuthManager","XblGameSave","XboxGipSvc","XboxNetApiSvc")
2026-01-11T19:28:13.3074595Z                              foreach ($s in $xboxSvc) { Stop-Service $s -Force -EA SilentlyContinue; Set-Service $s 
2026-01-11T19:28:13.3074829Z                      -StartupType Disabled -EA SilentlyContinue }
2026-01-11T19:28:13.3075099Z                              Write-OK "Xbox services disabled (Game Pass broken)"
2026-01-11T19:28:13.3075637Z                          }
2026-01-11T19:28:13.3076678Z                          '83' = { # bloatware
2026-01-11T19:28:13.3078019Z                              $bloatApps = @("Microsoft.BingNews", "Microsoft.GetHelp", "Microsoft.Getstarted", 
2026-01-11T19:28:13.3079192Z                      "Microsoft.MicrosoftSolitaireCollection", "Microsoft.People", "Microsoft.PowerAutomateDesktop", 
2026-01-11T19:28:13.3080000Z                      "Microsoft.Todos", "Microsoft.WindowsAlarms", "Microsoft.WindowsFeedbackHub", 
2026-01-11T19:28:13.3081549Z                      "Microsoft.WindowsMaps", "Microsoft.WindowsSoundRecorder", "Microsoft.YourPhone", 
2026-01-11T19:28:13.3082519Z                      "Microsoft.ZuneMusic", "Microsoft.ZuneVideo", "Clipchamp.Clipchamp", "Microsoft.549981C3F5F10")
2026-01-11T19:28:13.3082717Z                              foreach ($app in $bloatApps) {
2026-01-11T19:28:13.3083293Z                                  Get-AppxPackage -Name $app -AllUsers | Remove-AppxPackage -AllUsers -EA 
2026-01-11T19:28:13.3084126Z                      SilentlyContinue
2026-01-11T19:28:13.3084744Z                              }
2026-01-11T19:28:13.3085182Z                              Write-OK "Bloatware removed"
2026-01-11T19:28:13.3085820Z                          }
2026-01-11T19:28:13.3086505Z                          '84' = { # ipv4_prefer
2026-01-11T19:28:13.3087569Z                              Set-Reg "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters" "DisabledComponents" 
2026-01-11T19:28:13.3087671Z                      32
2026-01-11T19:28:13.3088960Z                              Write-OK "IPv4 preferred over IPv6"
2026-01-11T19:28:13.3089092Z                          }
2026-01-11T19:28:13.3089601Z                          '85' = { # teredo_disable
2026-01-11T19:28:13.3090448Z                              netsh interface teredo set state disabled 2>$null
2026-01-11T19:28:13.3090666Z                              Write-OK "Teredo disabled"
2026-01-11T19:28:13.3091756Z                          }
2026-01-11T19:28:13.3093279Z                          '86' = { # native_nvme
2026-01-11T19:28:13.3093706Z                              $build = [int](Get-CimInstance Win32_OperatingSystem).BuildNumber
2026-01-11T19:28:13.3094659Z                              if ($build -ge 26100) {
2026-01-11T19:28:13.3094988Z                                  $nvmePath = 
2026-01-11T19:28:13.3096124Z                      "HKLM:\SYSTEM\CurrentControlSet\Policies\Microsoft\FeatureManagement\Overrides"
2026-01-11T19:28:13.3097644Z                                  if (-not (Test-Path $nvmePath)) { New-Item -Path $nvmePath -Force | Out-Null }
2026-01-11T19:28:13.3098131Z                                  Set-Reg $nvmePath "1176759950" 1
2026-01-11T19:28:13.3098938Z                                  Write-OK "Native NVMe enabled (reboot required)"
2026-01-11T19:28:13.3100111Z                              } else { Write-Fail "Native NVMe requires Win11 24H2+" }
2026-01-11T19:28:13.3100220Z                          }
2026-01-11T19:28:13.3101618Z                          '87' = { # smt_disable
2026-01-11T19:28:13.3102909Z                              $cores = (Get-CimInstance Win32_Processor).NumberOfCores; bcdedit /set numproc $cores 
2026-01-11T19:28:13.3103079Z                      2>$null
2026-01-11T19:28:13.3104171Z                              Write-OK "SMT disabled (reboot required)"
2026-01-11T19:28:13.3104522Z                          }
2026-01-11T19:28:13.3105353Z                          '88' = { # audio_exclusive
2026-01-11T19:28:13.3106668Z                              Set-Reg "HKCU:\AppEvents\Schemes" "(Default)" ".None" "String"
2026-01-11T19:28:13.3106929Z                              Write-OK "System sounds disabled for exclusive mode"
2026-01-11T19:28:13.3107312Z                          }
2026-01-11T19:28:13.3108385Z                          '89' = { # tcp_optimizer
2026-01-11T19:28:13.3109399Z                              $adapters = Get-NetAdapter | Where-Object {$_.Status -eq "Up"}
2026-01-11T19:28:13.3109907Z                              foreach ($adapter in $adapters) {
2026-01-11T19:28:13.3110369Z                                  $path = 
2026-01-11T19:28:13.3111327Z                      "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces\$($adapter.InterfaceGuid)"
2026-01-11T19:28:13.3111496Z                                  Set-Reg $path "TcpAckFrequency" 1
2026-01-11T19:28:13.3111671Z                                  Set-Reg $path "TCPNoDelay" 1
2026-01-11T19:28:13.3112740Z                              }
2026-01-11T19:28:13.3113554Z                              Write-OK "TCP optimizer applied"
2026-01-11T19:28:13.3114248Z                          }
2026-01-11T19:28:13.3115011Z                      
2026-01-11T19:28:13.3115997Z                          # FR33THY Phase (104+)
2026-01-11T19:28:13.3116478Z                          '104' = { # background_polling
2026-01-11T19:28:13.3117727Z                              if (Set-Reg "HKCU:\Control Panel\Mouse" "RawMouseThrottleEnabled" 0 -PassThru) {
2026-01-11T19:28:13.3118058Z                                  Write-OK "Background mouse polling unlocked (full rate in background windows)"
2026-01-11T19:28:13.3118368Z                              }
2026-01-11T19:28:13.3118785Z                          }
2026-01-11T19:28:13.3119391Z                          '105' = { # amd_ulps_disable
2026-01-11T19:28:13.3120249Z                              $gpuPath = 
2026-01-11T19:28:13.3120817Z                      "HKLM:\SYSTEM\CurrentControlSet\Control\Class\{4d36e968-e325-11ce-bfc1-08002be10318}"
2026-01-11T19:28:13.3121491Z                              $foundAmd = $false
2026-01-11T19:28:13.3123093Z                              Get-ChildItem $gpuPath -EA SilentlyContinue | ForEach-Object {
2026-01-11T19:28:13.3123200Z                                  try {
2026-01-11T19:28:13.3124518Z                                      $desc = Get-ItemPropertyValue $_.PSPath "DriverDesc" -EA SilentlyContinue
2026-01-11T19:28:13.3124738Z                                      if ($desc -match "AMD|Radeon") {
2026-01-11T19:28:13.3125181Z                                          $foundAmd = $true
2026-01-11T19:28:13.3126211Z                                          Set-Reg $_.PSPath "EnableUlps" 0
2026-01-11T19:28:13.3126429Z                                          Set-Reg $_.PSPath "EnableUlps_NA" 0
2026-01-11T19:28:13.3127389Z                                      }
2026-01-11T19:28:13.3127519Z                                  } catch {}
2026-01-11T19:28:13.3128828Z                              }
2026-01-11T19:28:13.3129165Z                              if ($foundAmd) { Write-OK "AMD ULPS disabled (no more downclock stutters)" }
2026-01-11T19:28:13.3130191Z                              else { Write-Warn "No AMD GPU found, ULPS skip" }
2026-01-11T19:28:13.3130584Z                          }
2026-01-11T19:28:13.3131442Z                          '106' = { # nvidia_p0_state
2026-01-11T19:28:13.3132638Z                              $gpuPath = 
2026-01-11T19:28:13.3133118Z                      "HKLM:\SYSTEM\CurrentControlSet\Control\Class\{4d36e968-e325-11ce-bfc1-08002be10318}"
2026-01-11T19:28:13.3133281Z                              $foundNv = $false
2026-01-11T19:28:13.3134415Z                              Get-ChildItem $gpuPath -EA SilentlyContinue | ForEach-Object {
2026-01-11T19:28:13.3134511Z                                  try {
2026-01-11T19:28:13.3136019Z                                      $desc = Get-ItemPropertyValue $_.PSPath "DriverDesc" -EA SilentlyContinue
2026-01-11T19:28:13.3136224Z                                      if ($desc -match "NVIDIA|GeForce") {
2026-01-11T19:28:13.3136392Z                                          $foundNv = $true
2026-01-11T19:28:13.3137081Z                                          Set-Reg $_.PSPath "DisableDynamicPstate" 1
2026-01-11T19:28:13.3137784Z                                      }
2026-01-11T19:28:13.3137916Z                                  } catch {}
2026-01-11T19:28:13.3138674Z                              }
2026-01-11T19:28:13.3138806Z                              if ($foundNv) {
2026-01-11T19:28:13.3139993Z                                  Write-OK "NVIDIA P0 state forced (constant max clocks)"
2026-01-11T19:28:13.3140674Z                                  Write-Warn "GPU will run hotter - monitor temperatures!"
2026-01-11T19:28:13.3140781Z                              }
2026-01-11T19:28:13.3141937Z                              else { Write-Warn "No NVIDIA GPU found, P0 skip" }
2026-01-11T19:28:13.3142303Z                          }
2026-01-11T19:28:13.3143454Z                          '107' = { # network_binding_strip
2026-01-11T19:28:13.3143943Z                              Write-Warn "Stripping network bindings (breaks file/printer sharing!)"
2026-01-11T19:28:13.3144604Z                              $bindings = 
2026-01-11T19:28:13.3145747Z                      @("ms_lldp","ms_lltdio","ms_implat","ms_rspndr","ms_tcpip6","ms_server","ms_msclient","ms_pacer")
2026-01-11T19:28:13.3146086Z                              $adapters = Get-NetAdapter | Where-Object {$_.Status -eq "Up"}
2026-01-11T19:28:13.3146301Z                              $count = 0
2026-01-11T19:28:13.3147053Z                              foreach ($adapter in $adapters) {
2026-01-11T19:28:13.3147680Z                                  foreach ($binding in $bindings) {
2026-01-11T19:28:13.3147938Z                                      try {
2026-01-11T19:28:13.3150005Z                                          $current = Get-NetAdapterBinding -Name $adapter.Name -ComponentID $binding 
2026-01-11T19:28:13.3150140Z                      -EA Stop
2026-01-11T19:28:13.3150425Z                                          if ($current.Enabled) {
2026-01-11T19:28:13.3151563Z                                              Disable-NetAdapterBinding -Name $adapter.Name -ComponentID $binding -EA 
2026-01-11T19:28:13.3151693Z                      Stop
2026-01-11T19:28:13.3152819Z                                              $count++
2026-01-11T19:28:13.3152974Z                                          }
2026-01-11T19:28:13.3153704Z                                      } catch {}
2026-01-11T19:28:13.3153844Z                                  }
2026-01-11T19:28:13.3154406Z                              }
2026-01-11T19:28:13.3155026Z                              if ($count -gt 0) { Write-OK "Stripped $count network bindings (IPv4 only mode)" }
2026-01-11T19:28:13.3155393Z                              else { Write-Warn "No bindings modified (may already be stripped)" }
2026-01-11T19:28:13.3155741Z                          }
2026-01-11T19:28:13.3156123Z                      
2026-01-11T19:28:13.3157298Z                          # NOTE: LUDICROUS tier (100-103) intentionally NOT included for security
2026-01-11T19:28:13.3157988Z                          # IDs 100, 101, 102, 103 would disable critical security mitigations
2026-01-11T19:28:13.3158133Z                      }
2026-01-11T19:28:13.3158467Z                      
2026-01-11T19:28:13.3159773Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.3159896Z                      # MAIN EXECUTION
2026-01-11T19:28:13.3160351Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.3160544Z                      
2026-01-11T19:28:13.3161067Z                      Clear-Host
2026-01-11T19:28:13.3161331Z                      Write-Banner
2026-01-11T19:28:13.3162400Z                      Write-Host ""
2026-01-11T19:28:13.3163400Z                      
2026-01-11T19:28:13.3163645Z                      # Display configuration
2026-01-11T19:28:13.3164587Z                      $cpuName = if ($cpuId -and $CPU_MAP[$cpuId]) { $CPU_MAP[$cpuId].ToUpper() } else { "Not 
2026-01-11T19:28:13.3164732Z                      specified" }
2026-01-11T19:28:13.3166159Z                      $gpuName = if ($gpuId -and $GPU_MAP[$gpuId]) { $GPU_MAP[$gpuId].ToUpper() } else { "Not 
2026-01-11T19:28:13.3166297Z                      specified" }
2026-01-11T19:28:13.3166742Z                      
2026-01-11T19:28:13.3167032Z                      Write-Host "  Configuration:" -ForegroundColor White
2026-01-11T19:28:13.3167317Z                      Write-Host "    CPU: $cpuName" -ForegroundColor Gray
2026-01-11T19:28:13.3168185Z                      Write-Host "    GPU: $gpuName" -ForegroundColor Gray
2026-01-11T19:28:13.3168526Z                      Write-Host "    Optimizations: $($optIds.Count)" -ForegroundColor Gray
2026-01-11T19:28:13.3168907Z                      Write-Host "    Packages: $($pkgKeys.Count)" -ForegroundColor Gray
2026-01-11T19:28:13.3169168Z                      Write-Host ""
2026-01-11T19:28:13.3169841Z                      
2026-01-11T19:28:13.3170032Z                      # Show system info
2026-01-11T19:28:13.3170930Z                      $cpu = (Get-CimInstance Win32_Processor).Name
2026-01-11T19:28:13.3172233Z                      $gpu = (Get-CimInstance Win32_VideoController | Where-Object {$_.Status -eq "OK"} | Select-Object 
2026-01-11T19:28:13.3172728Z                      -First 1).Name
2026-01-11T19:28:13.3173774Z                      $ram = [math]::Round((Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property Capacity 
2026-01-11T19:28:13.3173909Z                      -Sum).Sum / 1GB)
2026-01-11T19:28:13.3174146Z                      Write-Host "  System:" -ForegroundColor White
2026-01-11T19:28:13.3175788Z                      Write-Host "    OS:  $script:WinVersion (Build $script:WinBuild)" -ForegroundColor $(if 
2026-01-11T19:28:13.3176050Z                      ($script:IsWin11) { "Gray" } else { "Yellow" })
2026-01-11T19:28:13.3176258Z                      Write-Host "    CPU: $cpu" -ForegroundColor Gray
2026-01-11T19:28:13.3176737Z                      Write-Host "    GPU: $gpu" -ForegroundColor Gray
2026-01-11T19:28:13.3177142Z                      Write-Host "    RAM: ${ram}GB" -ForegroundColor Gray
2026-01-11T19:28:13.3177470Z                      
2026-01-11T19:28:13.3178164Z                      # Win10 compatibility notice
2026-01-11T19:28:13.3178294Z                      if (-not $script:IsWin11) {
2026-01-11T19:28:13.3179306Z                          Write-Host ""
2026-01-11T19:28:13.3180545Z                          Write-Host "  ‚ö† Windows 10 detected - some Win11-only options will be skipped" 
2026-01-11T19:28:13.3180683Z                      -ForegroundColor Yellow
2026-01-11T19:28:13.3181800Z                      }
2026-01-11T19:28:13.3182418Z                      Write-Host ""
2026-01-11T19:28:13.3183614Z                      
2026-01-11T19:28:13.3184196Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.3184642Z                      # PRE-FLIGHT SCAN
2026-01-11T19:28:13.3186263Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.3186331Z                      
2026-01-11T19:28:13.3187656Z                      if ($optIds.Count -gt 0) {
2026-01-11T19:28:13.3187994Z                          Write-Host "  Scanning current system state..." -ForegroundColor Gray
2026-01-11T19:28:13.3188202Z                      
2026-01-11T19:28:13.3188778Z                          # Scan each selected optimization
2026-01-11T19:28:13.3190452Z                          foreach ($id in $optIds) {
2026-01-11T19:28:13.3190651Z                              $info = $OPT_DESCRIPTIONS[$id]
2026-01-11T19:28:13.3190820Z                              if (-not $info) { continue }
2026-01-11T19:28:13.3191374Z                      
2026-01-11T19:28:13.3191843Z                              $name = "[$($info.tier)] $($info.name)"
2026-01-11T19:28:13.3192418Z                              $current = "‚Äî"
2026-01-11T19:28:13.3193484Z                              $target = "Will apply"
2026-01-11T19:28:13.3193635Z                              $status = "PENDING"
2026-01-11T19:28:13.3193952Z                      
2026-01-11T19:28:13.3194882Z                              switch ($id) {
2026-01-11T19:28:13.3195672Z                                  '1' { # pagefile
2026-01-11T19:28:13.3195802Z                                      try {
2026-01-11T19:28:13.3196485Z                                          $cs = Get-WmiObject Win32_ComputerSystem
2026-01-11T19:28:13.3197782Z                                          if ($cs.AutomaticManagedPagefile) {
2026-01-11T19:28:13.3198296Z                                              $current = "Auto"
2026-01-11T19:28:13.3198497Z                                              $target = "Fixed size"
2026-01-11T19:28:13.3198821Z                                              $status = "CHANGE"
2026-01-11T19:28:13.3199271Z                                          } else {
2026-01-11T19:28:13.3200661Z                                              $current = "Fixed"
2026-01-11T19:28:13.3200816Z                                              $status = "OK"
2026-01-11T19:28:13.3201550Z                                          }
2026-01-11T19:28:13.3201709Z                                      } catch { }
2026-01-11T19:28:13.3203241Z                                  }
2026-01-11T19:28:13.3203367Z                                  '2' { # fastboot
2026-01-11T19:28:13.3204177Z                                      try {
2026-01-11T19:28:13.3205577Z                                          $val = Get-ItemProperty "HKLM:\SYSTEM\CurrentControlSet\Control\Session 
2026-01-11T19:28:13.3205904Z                      Manager\Power" -Name "HiberbootEnabled" -EA SilentlyContinue
2026-01-11T19:28:13.3206313Z                                          if ($val.HiberbootEnabled -eq 0) { $current = "OFF"; $status = "OK" }
2026-01-11T19:28:13.3207104Z                                          else { $current = "ON"; $target = "OFF"; $status = "CHANGE" }
2026-01-11T19:28:13.3207250Z                                      } catch { }
2026-01-11T19:28:13.3208621Z                                  }
2026-01-11T19:28:13.3208833Z                                  '10' { # gamedvr
2026-01-11T19:28:13.3208946Z                                      try {
2026-01-11T19:28:13.3210593Z                                          $val = Get-ItemProperty "HKCU:\System\GameConfigStore" -Name 
2026-01-11T19:28:13.3210767Z                      "GameDVR_Enabled" -EA SilentlyContinue
2026-01-11T19:28:13.3211103Z                                          if ($val.GameDVR_Enabled -eq 0) { $current = "OFF"; $status = "OK" }
2026-01-11T19:28:13.3211598Z                                          else { $current = "ON"; $target = "OFF"; $status = "CHANGE" }
2026-01-11T19:28:13.3211829Z                                      } catch { }
2026-01-11T19:28:13.3212473Z                                  }
2026-01-11T19:28:13.3212640Z                                  '11' { # background_apps
2026-01-11T19:28:13.3213819Z                                      try {
2026-01-11T19:28:13.3214612Z                                          $val = Get-ItemProperty 
2026-01-11T19:28:13.3215084Z                      "HKCU:\Software\Microsoft\Windows\CurrentVersion\BackgroundAccessApplications" -Name 
2026-01-11T19:28:13.3215290Z                      "GlobalUserDisabled" -EA SilentlyContinue
2026-01-11T19:28:13.3215788Z                                          if ($val.GlobalUserDisabled -eq 1) { $current = "OFF"; $status = "OK" }
2026-01-11T19:28:13.3216579Z                                          else { $current = "ON"; $target = "OFF"; $status = "CHANGE" }
2026-01-11T19:28:13.3216777Z                                      } catch { }
2026-01-11T19:28:13.3217508Z                                  }
2026-01-11T19:28:13.3218421Z                                  '13' { # copilot_disable
2026-01-11T19:28:13.3218745Z                                      try {
2026-01-11T19:28:13.3220404Z                                          $val = Get-ItemProperty 
2026-01-11T19:28:13.3221638Z                      "HKCU:\Software\Policies\Microsoft\Windows\WindowsCopilot" -Name "TurnOffWindowsCopilot" -EA 
2026-01-11T19:28:13.3222577Z                      SilentlyContinue
2026-01-11T19:28:13.3223472Z                                          if ($val.TurnOffWindowsCopilot -eq 1) { $current = "OFF"; $status = "OK" }
2026-01-11T19:28:13.3224341Z                                          else { $current = "ON"; $target = "OFF"; $status = "CHANGE" }
2026-01-11T19:28:13.3225229Z                                      } catch { }
2026-01-11T19:28:13.3227122Z                                  }
2026-01-11T19:28:13.3227590Z                                  '21' { # end_task
2026-01-11T19:28:13.3228025Z                                      try {
2026-01-11T19:28:13.3228677Z                                          $val = Get-ItemProperty 
2026-01-11T19:28:13.3229611Z                      "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced\TaskbarDeveloperSettings" 
2026-01-11T19:28:13.3230572Z                      -Name "TaskbarEndTask" -EA SilentlyContinue
2026-01-11T19:28:13.3231369Z                                          if ($val.TaskbarEndTask -eq 1) { $current = "ON"; $status = "OK" }
2026-01-11T19:28:13.3232519Z                                          else { $current = "OFF"; $target = "ON"; $status = "CHANGE" }
2026-01-11T19:28:13.3233268Z                                      } catch { }
2026-01-11T19:28:13.3234316Z                                  }
2026-01-11T19:28:13.3235040Z                                  '23' { # notifications_off
2026-01-11T19:28:13.3235512Z                                      try {
2026-01-11T19:28:13.3236204Z                                          $val = Get-ItemProperty "HKCU:\Software\Policies\Microsoft\Windows\Explorer" 
2026-01-11T19:28:13.3237352Z                      -Name "DisableNotificationCenter" -EA SilentlyContinue
2026-01-11T19:28:13.3238345Z                                          if ($val.DisableNotificationCenter -eq 1) { $current = "OFF"; $status = "OK" }
2026-01-11T19:28:13.3239297Z                                          else { $current = "ON"; $target = "OFF"; $status = "CHANGE" }
2026-01-11T19:28:13.3239950Z                                      } catch { }
2026-01-11T19:28:13.3240809Z                                  }
2026-01-11T19:28:13.3241760Z                                  '26' { # mouse_accel
2026-01-11T19:28:13.3242899Z                                      try {
2026-01-11T19:28:13.3243951Z                                          $val = Get-ItemProperty "HKCU:\Control Panel\Mouse" -Name "MouseSpeed" -EA 
2026-01-11T19:28:13.3244776Z                      SilentlyContinue
2026-01-11T19:28:13.3245869Z                                          if ($val.MouseSpeed -eq "0") { $current = "OFF"; $status = "OK" }
2026-01-11T19:28:13.3247143Z                                          else { $current = "ON"; $target = "OFF"; $status = "CHANGE" }
2026-01-11T19:28:13.3248146Z                                      } catch { }
2026-01-11T19:28:13.3248557Z                                  }
2026-01-11T19:28:13.3249370Z                                  '28' { # keyboard_response
2026-01-11T19:28:13.3249807Z                                      try {
2026-01-11T19:28:13.3250804Z                                          $val = Get-ItemProperty "HKCU:\Control Panel\Keyboard" -Name "KeyboardDelay" 
2026-01-11T19:28:13.3251784Z                      -EA SilentlyContinue
2026-01-11T19:28:13.3252689Z                                          if ($val.KeyboardDelay -eq "0") { $current = "0ms"; $status = "OK" }
2026-01-11T19:28:13.3253598Z                                          else { $current = "$($val.KeyboardDelay)"; $target = "0ms"; $status = 
2026-01-11T19:28:13.3254232Z                      "CHANGE" }
2026-01-11T19:28:13.3254579Z                                      } catch { }
2026-01-11T19:28:13.3255149Z                                  }
2026-01-11T19:28:13.3255510Z                                  '29' { # game_mode
2026-01-11T19:28:13.3255905Z                                      try {
2026-01-11T19:28:13.3256502Z                                          $val = Get-ItemProperty "HKCU:\Software\Microsoft\GameBar" -Name 
2026-01-11T19:28:13.3257488Z                      "AutoGameModeEnabled" -EA SilentlyContinue
2026-01-11T19:28:13.3258234Z                                          if ($val.AutoGameModeEnabled -eq 1) { $current = "ON"; $status = "OK" }
2026-01-11T19:28:13.3259042Z                                          else { $current = "OFF"; $target = "ON"; $status = "CHANGE" }
2026-01-11T19:28:13.3260336Z                                      } catch { }
2026-01-11T19:28:13.3260710Z                                  }
2026-01-11T19:28:13.3261069Z                                  '52' { # game_bar
2026-01-11T19:28:13.3261456Z                                      try {
2026-01-11T19:28:13.3262223Z                                          $val = Get-ItemProperty "HKCU:\Software\Microsoft\GameBar" -Name 
2026-01-11T19:28:13.3263447Z                      "ShowStartupPanel" -EA SilentlyContinue
2026-01-11T19:28:13.3264256Z                                          if ($val.ShowStartupPanel -eq 0) { $current = "OFF"; $status = "OK" }
2026-01-11T19:28:13.3265168Z                                          else { $current = "ON"; $target = "OFF"; $status = "CHANGE" }
2026-01-11T19:28:13.3265792Z                                      } catch { }
2026-01-11T19:28:13.3266201Z                                  }
2026-01-11T19:28:13.3266576Z                                  '53' { # hags
2026-01-11T19:28:13.3267013Z                                      try {
2026-01-11T19:28:13.3267524Z                                          $val = Get-ItemProperty 
2026-01-11T19:28:13.3268420Z                      "HKLM:\SYSTEM\CurrentControlSet\Control\GraphicsDrivers" -Name "HwSchMode" -EA SilentlyContinue
2026-01-11T19:28:13.3269769Z                                          if ($val.HwSchMode -eq 2) { $current = "ON"; $status = "OK" }
2026-01-11T19:28:13.3270527Z                                          else { $current = "OFF"; $target = "ON"; $status = "CHANGE" }
2026-01-11T19:28:13.3271163Z                                      } catch { }
2026-01-11T19:28:13.3271586Z                                  }
2026-01-11T19:28:13.3271976Z                                  '54' { # fso_disable
2026-01-11T19:28:13.3272354Z                                      try {
2026-01-11T19:28:13.3272765Z                                          $val = Get-ItemProperty "HKCU:\System\GameConfigStore" -Name 
2026-01-11T19:28:13.3273472Z                      "GameDVR_FSEBehaviorMode" -EA SilentlyContinue
2026-01-11T19:28:13.3274171Z                                          if ($val.GameDVR_FSEBehaviorMode -eq 2) { $current = "OFF"; $status = "OK" }
2026-01-11T19:28:13.3274834Z                                          else { $current = "ON"; $target = "OFF"; $status = "CHANGE" }
2026-01-11T19:28:13.3275353Z                                      } catch { }
2026-01-11T19:28:13.3275679Z                                  }
2026-01-11T19:28:13.3276035Z                                  '68' { # sysmain_disable
2026-01-11T19:28:13.3276331Z                                      try {
2026-01-11T19:28:13.3276773Z                                          $svc = Get-Service SysMain -EA SilentlyContinue
2026-01-11T19:28:13.3277424Z                                          if ($svc.StartType -eq 'Disabled') { $current = "OFF"; $status = "OK" }
2026-01-11T19:28:13.3278066Z                                          else { $current = "ON"; $target = "OFF"; $status = "CHANGE" }
2026-01-11T19:28:13.3278517Z                                      } catch { }
2026-01-11T19:28:13.3278739Z                                  }
2026-01-11T19:28:13.3279083Z                                  '69' { # services_search_off
2026-01-11T19:28:13.3279496Z                                      try {
2026-01-11T19:28:13.3279874Z                                          $svc = Get-Service WSearch -EA SilentlyContinue
2026-01-11T19:28:13.3280728Z                                          if ($svc.StartType -eq 'Manual' -or $svc.StartType -eq 'Disabled') { $current 
2026-01-11T19:28:13.3281394Z                      = "Manual"; $status = "OK" }
2026-01-11T19:28:13.3281829Z                                          else { $current = "Auto"; $target = "Manual"; $status = "CHANGE" }
2026-01-11T19:28:13.3282345Z                                      } catch { }
2026-01-11T19:28:13.3282696Z                                  }
2026-01-11T19:28:13.3283243Z                                  '80' { # privacy_tier1
2026-01-11T19:28:13.3283496Z                                      try {
2026-01-11T19:28:13.3283897Z                                          $val = Get-ItemProperty 
2026-01-11T19:28:13.3284801Z                      "HKCU:\Software\Microsoft\Windows\CurrentVersion\AdvertisingInfo" -Name "Enabled" -EA 
2026-01-11T19:28:13.3285340Z                      SilentlyContinue
2026-01-11T19:28:13.3286622Z                                          if ($val.Enabled -eq 0) { $current = "OFF"; $status = "OK" }
2026-01-11T19:28:13.3287350Z                                          else { $current = "ON"; $target = "OFF"; $status = "CHANGE" }
2026-01-11T19:28:13.3287851Z                                      } catch { }
2026-01-11T19:28:13.3288188Z                                  }
2026-01-11T19:28:13.3288504Z                                  '81' { # privacy_tier2
2026-01-11T19:28:13.3289359Z                                      try {
2026-01-11T19:28:13.3289920Z                                          $val = Get-ItemProperty 
2026-01-11T19:28:13.3291370Z                      "HKLM:\SOFTWARE\Policies\Microsoft\Windows\DataCollection" -Name "AllowTelemetry" -EA 
2026-01-11T19:28:13.3293710Z                      SilentlyContinue
2026-01-11T19:28:13.3294255Z                                          if ($val.AllowTelemetry -eq 0) { $current = "Minimal"; $status = "OK" }
2026-01-11T19:28:13.3295017Z                                          else { $current = "Full"; $target = "Minimal"; $status = "CHANGE" }
2026-01-11T19:28:13.3295712Z                                      } catch { }
2026-01-11T19:28:13.3296118Z                                  }
2026-01-11T19:28:13.3296497Z                                  '85' { # teredo_disable
2026-01-11T19:28:13.3296929Z                                      try {
2026-01-11T19:28:13.3297611Z                                          $teredo = netsh interface teredo show state 2>$null | Select-String "Type"
2026-01-11T19:28:13.3298580Z                                          if ($teredo -match "disabled") { $current = "OFF"; $status = "OK" }
2026-01-11T19:28:13.3299434Z                                          else { $current = "ON"; $target = "OFF"; $status = "CHANGE" }
2026-01-11T19:28:13.3300082Z                                      } catch { }
2026-01-11T19:28:13.3300517Z                                  }
2026-01-11T19:28:13.3301262Z                                  '104' { # background_polling
2026-01-11T19:28:13.3301673Z                                      try {
2026-01-11T19:28:13.3302211Z                                          $val = Get-ItemProperty "HKCU:\Control Panel\Mouse" -Name 
2026-01-11T19:28:13.3302886Z                      "RawMouseThrottleEnabled" -EA SilentlyContinue
2026-01-11T19:28:13.3303702Z                                          if ($val.RawMouseThrottleEnabled -eq 0) { $current = "Unlocked"; $status = 
2026-01-11T19:28:13.3304427Z                      "OK" }
2026-01-11T19:28:13.3305002Z                                          else { $current = "Throttled"; $target = "Unlocked"; $status = "CHANGE" }
2026-01-11T19:28:13.3305640Z                                      } catch { }
2026-01-11T19:28:13.3306020Z                                  }
2026-01-11T19:28:13.3306378Z                                  '105' { # amd_ulps_disable
2026-01-11T19:28:13.3306993Z                                      $current = "Check GPU"; $target = "Disabled"; $status = "PENDING"
2026-01-11T19:28:13.3307586Z                                  }
2026-01-11T19:28:13.3307956Z                                  '106' { # nvidia_p0_state
2026-01-11T19:28:13.3308589Z                                      $current = "Check GPU"; $target = "P0 Forced"; $status = "PENDING"
2026-01-11T19:28:13.3309292Z                                  }
2026-01-11T19:28:13.3309681Z                                  '107' { # network_binding_strip
2026-01-11T19:28:13.3310585Z                                      $current = "Multiple"; $target = "IPv4 Only"; $status = "PENDING"
2026-01-11T19:28:13.3311199Z                                  }
2026-01-11T19:28:13.3311602Z                                  '7' { # dns - special handling
2026-01-11T19:28:13.3312132Z                                      if ($dnsId -and $DNS_MAP[$dnsId]) {
2026-01-11T19:28:13.3312637Z                                          $dns = $DNS_MAP[$dnsId]
2026-01-11T19:28:13.3313147Z                                          $name = "[SAFE] DNS Provider"
2026-01-11T19:28:13.3313637Z                                          $target = $dns.name
2026-01-11T19:28:13.3314068Z                                          try {
2026-01-11T19:28:13.3314695Z                                              $adapter = Get-NetAdapter | Where-Object {$_.Status -eq "Up"} | 
2026-01-11T19:28:13.3315363Z                      Select-Object -First 1
2026-01-11T19:28:13.3315792Z                                              if ($adapter) {
2026-01-11T19:28:13.3316455Z                                                  $dnsServers = (Get-DnsClientServerAddress -InterfaceIndex 
2026-01-11T19:28:13.3317341Z                      $adapter.InterfaceIndex -AddressFamily IPv4).ServerAddresses
2026-01-11T19:28:13.3318453Z                                                  if ($dnsServers -contains $dns.primary) { $current = $dns.name; 
2026-01-11T19:28:13.3319163Z                      $status = "OK" }
2026-01-11T19:28:13.3319686Z                                                  else { $current = "Other"; $status = "CHANGE" }
2026-01-11T19:28:13.3320243Z                                              }
2026-01-11T19:28:13.3320655Z                                          } catch { }
2026-01-11T19:28:13.3321469Z                                      }
2026-01-11T19:28:13.3321825Z                                  }
2026-01-11T19:28:13.3322154Z                              }
2026-01-11T19:28:13.3322473Z                      
2026-01-11T19:28:13.3322856Z                              Add-ScanResult $name $current $target $status
2026-01-11T19:28:13.3323359Z                          }
2026-01-11T19:28:13.3323656Z                      
2026-01-11T19:28:13.3323949Z                          Write-ScanResults
2026-01-11T19:28:13.3324333Z                      }
2026-01-11T19:28:13.3324593Z                      
2026-01-11T19:28:13.3325433Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.3326047Z                      # INTERACTIVE APPROVAL MODE
2026-01-11T19:28:13.3326830Z                      # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-11T19:28:13.3327383Z                      
2026-01-11T19:28:13.3327699Z                      function Get-TierColor {
2026-01-11T19:28:13.3328136Z                          param([string]$Tier)
2026-01-11T19:28:13.3328535Z                          switch ($Tier) {
2026-01-11T19:28:13.3328925Z                              'SAFE'    { 'Green' }
2026-01-11T19:28:13.3329369Z                              'CAUTION' { 'Yellow' }
2026-01-11T19:28:13.3329812Z                              'RISKY'   { 'Red' }
2026-01-11T19:28:13.3330234Z                              default   { 'Gray' }
2026-01-11T19:28:13.3330669Z                          }
2026-01-11T19:28:13.3330978Z                      }
2026-01-11T19:28:13.3331253Z                      
2026-01-11T19:28:13.3331615Z                      function Show-OptimizationPrompt {
2026-01-11T19:28:13.3332162Z                          param([string]$Id, [int]$Current, [int]$Total)
2026-01-11T19:28:13.3332676Z                      
2026-01-11T19:28:13.3333007Z                          $info = $OPT_DESCRIPTIONS[$Id]
2026-01-11T19:28:13.3333458Z                          if (-not $info) {
2026-01-11T19:28:13.3334140Z                              $info = @{ name="Unknown ($Id)"; tier='UNKNOWN'; desc='No description available' }
2026-01-11T19:28:13.3334824Z                          }
2026-01-11T19:28:13.3335131Z                      
2026-01-11T19:28:13.3336756Z                          $tierColor = Get-TierColor $info.tier
2026-01-11T19:28:13.3337287Z                      
2026-01-11T19:28:13.3337599Z                          Write-Host ""
2026-01-11T19:28:13.3338227Z                          Write-Host "  [$Current/$Total] " -NoNewline -ForegroundColor DarkGray
2026-01-11T19:28:13.3339021Z                          Write-Host $info.name -NoNewline -ForegroundColor White
2026-01-11T19:28:13.3339735Z                          Write-Host " [" -NoNewline -ForegroundColor DarkGray
2026-01-11T19:28:13.3340534Z                          Write-Host $info.tier -NoNewline -ForegroundColor $tierColor
2026-01-11T19:28:13.3353096Z                          Write-Host "]" -ForegroundColor DarkGray
2026-01-11T19:28:13.3353743Z                          Write-Host "  $($info.desc)" -ForegroundColor Gray
2026-01-11T19:28:13.3354315Z                          Write-Host ""
2026-01-11T19:28:13.3355037Z                          Write-Host "  Apply? [Y]es / [N]o / [A]ll remaining / [Q]uit: " -NoNewline -ForegroundColor 
2026-01-11T19:28:13.3355789Z                      Cyan
2026-01-11T19:28:13.3356079Z                      }
2026-01-11T19:28:13.3356613Z                      
2026-01-11T19:28:13.3356942Z                      # Execute optimizations
2026-01-11T19:28:13.3357382Z                      if ($optIds.Count -gt 0) {
2026-01-11T19:28:13.3357828Z                          Write-Step "Upgrades"
2026-01-11T19:28:13.3358246Z                          Write-Host ""
2026-01-11T19:28:13.3359136Z                          Write-Host "  ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó" 
2026-01-11T19:28:13.3359835Z                      -ForegroundColor White
2026-01-11T19:28:13.3360740Z                          Write-Host "  ‚ïë  INTERACTIVE MODE - Review each optimization before applying   ‚ïë" 
2026-01-11T19:28:13.3361962Z                      -ForegroundColor White
2026-01-11T19:28:13.3362837Z                          Write-Host "  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù" 
2026-01-11T19:28:13.3363545Z                      -ForegroundColor White
2026-01-11T19:28:13.3363976Z                          Write-Host ""
2026-01-11T19:28:13.3364791Z                          Write-Host "  This loadout contains $($optIds.Count) optimization(s)." -ForegroundColor Gray
2026-01-11T19:28:13.3365896Z                          Write-Host "  You will be prompted to approve each one." -ForegroundColor Gray
2026-01-11T19:28:13.3366611Z                          Write-Host ""
2026-01-11T19:28:13.3367113Z                          Write-Host "  Tier legend:" -ForegroundColor White
2026-01-11T19:28:13.3367971Z                          Write-Host "    SAFE    - " -NoNewline; Write-Host "Low risk, recommended for everyone" 
2026-01-11T19:28:13.3368750Z                      -ForegroundColor Green
2026-01-11T19:28:13.3369512Z                          Write-Host "    CAUTION - " -NoNewline; Write-Host "May affect some features, test after" 
2026-01-11T19:28:13.3370348Z                      -ForegroundColor Yellow
2026-01-11T19:28:13.3371114Z                          Write-Host "    RISKY   - " -NoNewline; Write-Host "May break features, know what you're 
2026-01-11T19:28:13.3371939Z                      doing" -ForegroundColor Red
2026-01-11T19:28:13.3372381Z                          Write-Host ""
2026-01-11T19:28:13.3372747Z                      
2026-01-11T19:28:13.3373072Z                          $autoApprove = $false
2026-01-11T19:28:13.3373737Z                          $consecutiveYes = 0  # Track consecutive Y responses for smart auto-All
2026-01-11T19:28:13.3374425Z                          $approvedIds = @()
2026-01-11T19:28:13.3374844Z                          $skippedIds = @()
2026-01-11T19:28:13.3375233Z                          $quit = $false
2026-01-11T19:28:13.3375614Z                          $current = 0
2026-01-11T19:28:13.3376008Z                          $total = $optIds.Count
2026-01-11T19:28:13.3376675Z                      
2026-01-11T19:28:13.3377044Z                          # Handle DNS separately if specified
2026-01-11T19:28:13.3377704Z                          if ($dnsId -and $DNS_MAP[$dnsId] -and ($optIds -contains '7')) {
2026-01-11T19:28:13.3378308Z                              $current++
2026-01-11T19:28:13.3378727Z                              $dns = $DNS_MAP[$dnsId]
2026-01-11T19:28:13.3379717Z                              if (-not $autoApprove) {
2026-01-11T19:28:13.3380169Z                                  Write-Host ""
2026-01-11T19:28:13.3380827Z                                  Write-Host "  [$current/$total] " -NoNewline -ForegroundColor DarkGray
2026-01-11T19:28:13.3381684Z                                  Write-Host "DNS Provider" -NoNewline -ForegroundColor White
2026-01-11T19:28:13.3382458Z                                  Write-Host " [" -NoNewline -ForegroundColor DarkGray
2026-01-11T19:28:13.3383163Z                                  Write-Host "SAFE" -NoNewline -ForegroundColor Green
2026-01-11T19:28:13.3383759Z                                  Write-Host "]" -ForegroundColor DarkGray
2026-01-11T19:28:13.3384388Z                                  Write-Host "  Set DNS to $($dns.name) ($($dns.primary), $($dns.secondary))" 
2026-01-11T19:28:13.3385026Z                      -ForegroundColor Gray
2026-01-11T19:28:13.3385271Z                                  Write-Host ""
2026-01-11T19:28:13.3385629Z                                  Write-Host "  Apply? [Y]es / [N]o / [A]ll remaining / [Q]uit: " -NoNewline 
2026-01-11T19:28:13.3386030Z                      -ForegroundColor Cyan
2026-01-11T19:28:13.3386418Z                                  $response = Read-Host
2026-01-11T19:28:13.3386747Z                              } else {
2026-01-11T19:28:13.3387124Z                                  $response = 'y'
2026-01-11T19:28:13.3387389Z                              }
2026-01-11T19:28:13.3387629Z                      
2026-01-11T19:28:13.3387930Z                              switch ($response.ToLower()) {
2026-01-11T19:28:13.3388325Z                                  'a' { $autoApprove = $true; $response = 'y' }
2026-01-11T19:28:13.3388759Z                                  'q' { $quit = $true }
2026-01-11T19:28:13.3389186Z                                  'n' { $consecutiveYes = 0 }  # Reset on skip
2026-01-11T19:28:13.3389673Z                              }
2026-01-11T19:28:13.3389973Z                      
2026-01-11T19:28:13.3390355Z                              if (-not $quit -and $response.ToLower() -eq 'y') {
2026-01-11T19:28:13.3390908Z                                  $consecutiveYes++
2026-01-11T19:28:13.3391496Z                                  # Smart Auto-All: after 3 consecutive Y, auto-approve remaining
2026-01-11T19:28:13.3392230Z                                  if ($consecutiveYes -ge 3 -and -not $autoApprove) {
2026-01-11T19:28:13.3392806Z                                      $autoApprove = $true
2026-01-11T19:28:13.3393306Z                                      $remaining = $total - $current
2026-01-11T19:28:13.3393802Z                                      Write-Host ""
2026-01-11T19:28:13.3394304Z                                      Write-Host "  $([char]0x2192) Auto-applying remaining $remaining optimizations (3 
2026-01-11T19:28:13.3395039Z                      consecutive approvals)" -ForegroundColor Cyan
2026-01-11T19:28:13.3395731Z                                      Write-Host "  $([char]0x2192) Press Ctrl+C to abort if needed" -ForegroundColor 
2026-01-11T19:28:13.3396281Z                      DarkGray
2026-01-11T19:28:13.3396549Z                                      Write-Host ""
2026-01-11T19:28:13.3396860Z                                  }
2026-01-11T19:28:13.3397474Z                                  Get-NetAdapter | Where-Object {$_.Status -eq "Up"} | Set-DnsClientServerAddress 
2026-01-11T19:28:13.3398200Z                      -ServerAddresses $dns.primary,$dns.secondary
2026-01-11T19:28:13.3398929Z                                  Write-OK "DNS set to $($dns.name)"
2026-01-11T19:28:13.3399233Z                                  $approvedIds += '7'
2026-01-11T19:28:13.3399864Z                              } else {
2026-01-11T19:28:13.3400226Z                                  $skippedIds += '7'
2026-01-11T19:28:13.3400677Z                                  if (-not $quit) { Write-Host "  [SKIP] DNS" -ForegroundColor DarkGray }
2026-01-11T19:28:13.3401240Z                              }
2026-01-11T19:28:13.3401530Z                          }
2026-01-11T19:28:13.3401778Z                      
2026-01-11T19:28:13.3402060Z                          foreach ($id in $optIds) {
2026-01-11T19:28:13.3402430Z                              if ($quit) { break }
2026-01-11T19:28:13.3402883Z                              if ($id -eq '7') { continue } # Skip DNS, handled above
2026-01-11T19:28:13.3403331Z                      
2026-01-11T19:28:13.3403578Z                              $current++
2026-01-11T19:28:13.3403892Z                      
2026-01-11T19:28:13.3404224Z                              if (-not $OPT_FUNCTIONS.ContainsKey($id)) {
2026-01-11T19:28:13.3404777Z                                  Write-Warn "Unknown optimization ID: $id (skipped)"
2026-01-11T19:28:13.3405528Z                                  continue
2026-01-11T19:28:13.3405801Z                              }
2026-01-11T19:28:13.3406063Z                      
2026-01-11T19:28:13.3406312Z                              # Skip Win11-only features on Win10
2026-01-11T19:28:13.3406699Z                              if (-not $script:IsWin11 -and $id -in $script:Win11OnlyIds) {
2026-01-11T19:28:13.3407277Z                                  $info = $OPT_DESCRIPTIONS[$id]
2026-01-11T19:28:13.3407711Z                                  $name = if ($info) { $info.name } else { $id }
2026-01-11T19:28:13.3408215Z                                  Write-Host "  [SKIP] $name (requires Windows 11)" -ForegroundColor DarkGray
2026-01-11T19:28:13.3408850Z                                  $skippedIds += $id
2026-01-11T19:28:13.3409183Z                                  continue
2026-01-11T19:28:13.3409486Z                              }
2026-01-11T19:28:13.3409760Z                      
2026-01-11T19:28:13.3410035Z                              # Skip Win11 24H2+ features on older builds
2026-01-11T19:28:13.3410661Z                              if (-not $script:IsWin11_24H2 -and $id -in $script:Win11_24H2OnlyIds) {
2026-01-11T19:28:13.3411128Z                                  $info = $OPT_DESCRIPTIONS[$id]
2026-01-11T19:28:13.3411615Z                                  $name = if ($info) { $info.name } else { $id }
2026-01-11T19:28:13.3412209Z                                  Write-Host "  [SKIP] $name (requires Windows 11 24H2+)" -ForegroundColor DarkGray
2026-01-11T19:28:13.3412743Z                                  $skippedIds += $id
2026-01-11T19:28:13.3413095Z                                  continue
2026-01-11T19:28:13.3413424Z                              }
2026-01-11T19:28:13.3413640Z                      
2026-01-11T19:28:13.3413894Z                              if (-not $autoApprove) {
2026-01-11T19:28:13.3414475Z                                  Show-OptimizationPrompt -Id $id -Current $current -Total $total
2026-01-11T19:28:13.3415041Z                                  $response = Read-Host
2026-01-11T19:28:13.3415415Z                              } else {
2026-01-11T19:28:13.3415757Z                                  $response = 'y'
2026-01-11T19:28:13.3415986Z                              }
2026-01-11T19:28:13.3416268Z                      
2026-01-11T19:28:13.3416575Z                              switch ($response.ToLower()) {
2026-01-11T19:28:13.3417035Z                                  'a' { $autoApprove = $true; $response = 'y' }
2026-01-11T19:28:13.3417551Z                                  'q' { $quit = $true }
2026-01-11T19:28:13.3417989Z                                  'n' { $consecutiveYes = 0 }  # Reset on skip
2026-01-11T19:28:13.3418553Z                              }
2026-01-11T19:28:13.3418748Z                      
2026-01-11T19:28:13.3419162Z                              if (-not $quit -and $response.ToLower() -eq 'y') {
2026-01-11T19:28:13.3419823Z                                  $consecutiveYes++
2026-01-11T19:28:13.3420398Z                                  # Smart Auto-All: after 3 consecutive Y, auto-approve remaining
2026-01-11T19:28:13.3421043Z                                  if ($consecutiveYes -ge 3 -and -not $autoApprove) {
2026-01-11T19:28:13.3421556Z                                      $autoApprove = $true
2026-01-11T19:28:13.3421933Z                                      $remaining = $total - $current
2026-01-11T19:28:13.3422282Z                                      Write-Host ""
2026-01-11T19:28:13.3422788Z                                      Write-Host "  $([char]0x2192) Auto-applying remaining $remaining optimizations (3 
2026-01-11T19:28:13.3423447Z                      consecutive approvals)" -ForegroundColor Cyan
2026-01-11T19:28:13.3424113Z                                      Write-Host "  $([char]0x2192) Press Ctrl+C to abort if needed" -ForegroundColor 
2026-01-11T19:28:13.3424725Z                      DarkGray
2026-01-11T19:28:13.3425242Z                                      Write-Host ""
2026-01-11T19:28:13.3425596Z                                  }
2026-01-11T19:28:13.3425795Z                                  try {
2026-01-11T19:28:13.3426177Z                                      & $OPT_FUNCTIONS[$id]
2026-01-11T19:28:13.3426602Z                                      $approvedIds += $id
2026-01-11T19:28:13.3427010Z                                  } catch {
2026-01-11T19:28:13.3427410Z                                      Write-Fail "Optimization $id failed: $($_.Exception.Message)"
2026-01-11T19:28:13.3427747Z                                  }
2026-01-11T19:28:13.3428108Z                              } else {
2026-01-11T19:28:13.3428417Z                                  $skippedIds += $id
2026-01-11T19:28:13.3428752Z                                  if (-not $quit) {
2026-01-11T19:28:13.3429126Z                                      $info = $OPT_DESCRIPTIONS[$id]
2026-01-11T19:28:13.3429440Z                                      $name = if ($info) { $info.name } else { $id }
2026-01-11T19:28:13.3429905Z                                      Write-Host "  [SKIP] $name" -ForegroundColor DarkGray
2026-01-11T19:28:13.3430370Z                                  }
2026-01-11T19:28:13.3430669Z                              }
2026-01-11T19:28:13.3430853Z                          }
2026-01-11T19:28:13.3431019Z                      
2026-01-11T19:28:13.3431221Z                          # Show approval summary
2026-01-11T19:28:13.3431629Z                          Write-Host ""
2026-01-11T19:28:13.3432384Z                          Write-Host "  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ" -ForegroundColor DarkGray
2026-01-11T19:28:13.3433112Z                          Write-Host "  Applied: $($approvedIds.Count) | Skipped: $($skippedIds.Count)" 
2026-01-11T19:28:13.3433563Z                      -ForegroundColor Gray
2026-01-11T19:28:13.3434079Z                          if ($quit) { Write-Host "  (User quit early)" -ForegroundColor Yellow }
2026-01-11T19:28:13.3434632Z                      }
2026-01-11T19:28:13.3434865Z                      
2026-01-11T19:28:13.3435140Z                      # Install packages
2026-01-11T19:28:13.3435508Z                      if ($pkgKeys.Count -gt 0) {
2026-01-11T19:28:13.3435825Z                          Write-Step "Arsenal (winget)"
2026-01-11T19:28:13.3436199Z                          Write-Host ""
2026-01-11T19:28:13.3436777Z                          Write-Host "  ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó" 
2026-01-11T19:28:13.3437289Z                      -ForegroundColor White
2026-01-11T19:28:13.3437943Z                          Write-Host "  ‚ïë  PACKAGE INSTALLATION - Review each software before install    ‚ïë" 
2026-01-11T19:28:13.3438863Z                      -ForegroundColor White
2026-01-11T19:28:13.3439638Z                          Write-Host "  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù" 
2026-01-11T19:28:13.3440513Z                      -ForegroundColor White
2026-01-11T19:28:13.3441062Z                          Write-Host ""
2026-01-11T19:28:13.3441640Z                          Write-Host "  This loadout includes $($pkgKeys.Count) package(s) to install via winget." 
2026-01-11T19:28:13.3442337Z                      -ForegroundColor Gray
2026-01-11T19:28:13.3442672Z                          Write-Host ""
2026-01-11T19:28:13.3442987Z                      
2026-01-11T19:28:13.3443346Z                          $wingetPath = Get-Command winget -EA SilentlyContinue
2026-01-11T19:28:13.3443816Z                          if (-not $wingetPath) {
2026-01-11T19:28:13.3444339Z                              Write-Fail "winget not found. Install App Installer from Microsoft Store."
2026-01-11T19:28:13.3444937Z                          } else {
2026-01-11T19:28:13.3445280Z                              $pkgAutoApprove = $false
2026-01-11T19:28:13.3445853Z                              $pkgConsecutiveYes = 0  # Track consecutive Y responses for smart auto-All
2026-01-11T19:28:13.3446423Z                              $installedPkgs = @()
2026-01-11T19:28:13.3446677Z                              $skippedPkgs = @()
2026-01-11T19:28:13.3447072Z                              $pkgQuit = $false
2026-01-11T19:28:13.3447345Z                              $pkgCurrent = 0
2026-01-11T19:28:13.3447732Z                              $pkgTotal = $pkgKeys.Count
2026-01-11T19:28:13.3448018Z                      
2026-01-11T19:28:13.3448310Z                              foreach ($key in $pkgKeys) {
2026-01-11T19:28:13.3448730Z                                  if ($pkgQuit) { break }
2026-01-11T19:28:13.3449094Z                                  $pkgCurrent++
2026-01-11T19:28:13.3449446Z                      
2026-01-11T19:28:13.3449772Z                                  if (-not $PACKAGE_MAP.ContainsKey($key)) {
2026-01-11T19:28:13.3450233Z                                      Write-Warn "Unknown package: $key (skipped)"
2026-01-11T19:28:13.3450621Z                                      continue
2026-01-11T19:28:13.3450976Z                                  }
2026-01-11T19:28:13.3451217Z                      
2026-01-11T19:28:13.3451471Z                                  $pkg = $PACKAGE_MAP[$key]
2026-01-11T19:28:13.3451821Z                      
2026-01-11T19:28:13.3452071Z                                  if (-not $pkgAutoApprove) {
2026-01-11T19:28:13.3452465Z                                      Write-Host ""
2026-01-11T19:28:13.3453109Z                                      Write-Host "  [$pkgCurrent/$pkgTotal] " -NoNewline -ForegroundColor DarkGray
2026-01-11T19:28:13.3453727Z                                      Write-Host $pkg.name -NoNewline -ForegroundColor White
2026-01-11T19:28:13.3454560Z                                      Write-Host " [" -NoNewline -ForegroundColor DarkGray
2026-01-11T19:28:13.3455253Z                                      Write-Host "SOFTWARE" -NoNewline -ForegroundColor Cyan
2026-01-11T19:28:13.3455751Z                                      Write-Host "]" -ForegroundColor DarkGray
2026-01-11T19:28:13.3456263Z                                      Write-Host "  winget: $($pkg.id)" -ForegroundColor Gray
2026-01-11T19:28:13.3456737Z                                      Write-Host ""
2026-01-11T19:28:13.3457238Z                                      Write-Host "  Install? [Y]es / [N]o / [A]ll remaining / [Q]uit: " -NoNewline 
2026-01-11T19:28:13.3457856Z                      -ForegroundColor Cyan
2026-01-11T19:28:13.3458252Z                                      $pkgResponse = Read-Host
2026-01-11T19:28:13.3458652Z                                  } else {
2026-01-11T19:28:13.3460041Z                                      $pkgResponse = 'y'
2026-01-11T19:28:13.3460382Z                                  }
2026-01-11T19:28:13.3461862Z                      
2026-01-11T19:28:13.3462503Z                                  switch ($pkgResponse.ToLower()) {
2026-01-11T19:28:13.3463023Z                                      'a' { $pkgAutoApprove = $true; $pkgResponse = 'y' }
2026-01-11T19:28:13.3463760Z                                      'q' { $pkgQuit = $true }
2026-01-11T19:28:13.3464270Z                                      'n' { $pkgConsecutiveYes = 0 }  # Reset on skip
2026-01-11T19:28:13.3464905Z                                  }
2026-01-11T19:28:13.3465250Z                      
2026-01-11T19:28:13.3466493Z                                  if (-not $pkgQuit -and $pkgResponse.ToLower() -eq 'y') {
2026-01-11T19:28:13.3467138Z                                      $pkgConsecutiveYes++
2026-01-11T19:28:13.3467713Z                                      # Smart Auto-All: after 3 consecutive Y, auto-approve remaining
2026-01-11T19:28:13.3468384Z                                      if ($pkgConsecutiveYes -ge 3 -and -not $pkgAutoApprove) {
2026-01-11T19:28:13.3468761Z                                          $pkgAutoApprove = $true
2026-01-11T19:28:13.3469187Z                                          $remaining = $pkgTotal - $pkgCurrent
2026-01-11T19:28:13.3469670Z                                          Write-Host ""
2026-01-11T19:28:13.3471278Z                                          Write-Host "  $([char]0x2192) Auto-installing remaining $remaining packages 
2026-01-11T19:28:13.3472048Z                      (3 consecutive approvals)" -ForegroundColor Cyan
2026-01-11T19:28:13.3472652Z                                          Write-Host "  $([char]0x2192) Press Ctrl+C to abort if needed" 
2026-01-11T19:28:13.3473151Z                      -ForegroundColor DarkGray
2026-01-11T19:28:13.3473549Z                                          Write-Host ""
2026-01-11T19:28:13.3474205Z                                      }
2026-01-11T19:28:13.3474996Z                                      Write-Host "  Installing $($pkg.name)..." -NoNewline
2026-01-11T19:28:13.3475915Z                                      $installOutput = winget install --id "$($pkg.id)" --silent 
2026-01-11T19:28:13.3476580Z                      --accept-package-agreements --accept-source-agreements 2>&1
2026-01-11T19:28:13.3477092Z                                      if ($LASTEXITCODE -eq 0) { Write-OK ""; $installedPkgs += $key }
2026-01-11T19:28:13.3477888Z                                      elseif ($installOutput -match "No available upgrade found|No newer package 
2026-01-11T19:28:13.3478782Z                      versions are available|already installed") { Write-OK "Already installed"; $installedPkgs += $key 
2026-01-11T19:28:13.3479431Z                      }
2026-01-11T19:28:13.3481327Z                                      else { Write-Fail ""; $installOutput | ForEach-Object { Write-Host "    $_" 
2026-01-11T19:28:13.3482127Z                      -ForegroundColor DarkGray } }
2026-01-11T19:28:13.3482586Z                                  } else {
2026-01-11T19:28:13.3483274Z                                      $skippedPkgs += $key
2026-01-11T19:28:13.3484033Z                                      if (-not $pkgQuit) { Write-Host "  [SKIP] $($pkg.name)" -ForegroundColor DarkGray 
2026-01-11T19:28:13.3484776Z                      }
2026-01-11T19:28:13.3485064Z                                  }
2026-01-11T19:28:13.3485403Z                              }
2026-01-11T19:28:13.3485700Z                      
2026-01-11T19:28:13.3485892Z                              # Show package summary
2026-01-11T19:28:13.3486497Z                              Write-Host ""
2026-01-11T19:28:13.3488150Z                              Write-Host "  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ" -ForegroundColor DarkGray
2026-01-11T19:28:13.3489330Z                              Write-Host "  Installed: $($installedPkgs.Count) | Skipped: $($skippedPkgs.Count)" 
2026-01-11T19:28:13.3490087Z                      -ForegroundColor Gray
2026-01-11T19:28:13.3490723Z                              if ($pkgQuit) { Write-Host "  (User quit early)" -ForegroundColor Yellow }
2026-01-11T19:28:13.3491355Z                          }
2026-01-11T19:28:13.3491680Z                      }
2026-01-11T19:28:13.3492216Z                      
2026-01-11T19:28:13.3492682Z                      # Summary
2026-01-11T19:28:13.3493274Z                      Write-Step "Complete"
2026-01-11T19:28:13.3494696Z                      Write-Host ""
2026-01-11T19:28:13.3495546Z                      Write-Host "  ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó" -ForegroundColor White
2026-01-11T19:28:13.3496592Z                      Write-Host "  ‚ïë           LOADOUT SUMMARY              ‚ïë" -ForegroundColor White
2026-01-11T19:28:13.3497556Z                      Write-Host "  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù" -ForegroundColor White
2026-01-11T19:28:13.3498089Z                      Write-Host ""
2026-01-11T19:28:13.3498578Z                      Write-Host "  Applied:  $($script:SuccessCount) changes" -ForegroundColor Green
2026-01-11T19:28:13.3499389Z                      if ($script:WarningCount -gt 0) { Write-Host "  Warnings: $($script:WarningCount)" 
2026-01-11T19:28:13.3500062Z                      -ForegroundColor Yellow }
2026-01-11T19:28:13.3500687Z                      if ($script:FailCount -gt 0) { Write-Host "  Failed:   $($script:FailCount)" -ForegroundColor Red 
2026-01-11T19:28:13.3501639Z                      }
2026-01-11T19:28:13.3501999Z                      Write-Host ""
2026-01-11T19:28:13.3502770Z                      Write-Host "  Reboot recommended for all changes to take effect." -ForegroundColor Cyan
2026-01-11T19:28:13.3503530Z                      Write-Host ""
2026-01-11T19:28:13.3504095Z                      Write-Host "  Source: https://rocktune.pedroferrari.com" -ForegroundColor DarkGray
2026-01-11T19:28:13.3504673Z                      Write-Host ""
2026-01-11T19:28:13.3504870Z                      
2026-01-11T19:28:13.3505347Z [32;1mParent             : [0m
2026-01-11T19:28:13.3506057Z 
2026-01-11T19:28:13.3612542Z [32;1mAttributes         : [0m{}
2026-01-11T19:28:13.3613031Z [32;1mUsingStatements    : [0m{}
2026-01-11T19:28:13.3613489Z [32;1mParamBlock         : [0m
2026-01-11T19:28:13.3614331Z [32;1mBeginBlock         : [0m
2026-01-11T19:28:13.3614699Z [32;1mProcessBlock       : [0m
2026-01-11T19:28:13.3616974Z [32;1mEndBlock           : [0m$script:ConfigDir = Join-Path $PSScriptRoot "..\..\config"
2026-01-11T19:28:13.3618124Z                      $script:DataDir = Join-Path $PSScriptRoot "..\..\data"
2026-01-11T19:28:13.3618722Z                      $script:DefaultsPath = Join-Path $script:ConfigDir "defaults.json"
2026-01-11T19:28:13.3619247Z                      $script:UserConfigPath = Join-Path $script:ConfigDir "user-config.json"
2026-01-11T19:28:13.3620115Z                      $script:ProfilesDir = Join-Path $script:ConfigDir "profiles"
2026-01-11T19:28:13.3620551Z                      
2026-01-11T19:28:13.3621122Z                      
2026-01-11T19:28:13.3621458Z                      function Get-DefaultConfig {
2026-01-11T19:28:13.3621863Z                          <#
2026-01-11T19:28:13.3622113Z                          .SYNOPSIS
2026-01-11T19:28:13.3622822Z                              Returns the default configuration.
2026-01-11T19:28:13.3623575Z                          .DESCRIPTION
2026-01-11T19:28:13.3624519Z                              Attempts to load defaults.json from the config directory. Falls back to
2026-01-11T19:28:13.3625384Z                              embedded defaults when the file is missing or invalid.
2026-01-11T19:28:13.3625936Z                          .OUTPUTS
2026-01-11T19:28:13.3626368Z                              [hashtable] Default configuration.
2026-01-11T19:28:13.3626827Z                          #>
2026-01-11T19:28:13.3627138Z                      
2026-01-11T19:28:13.3627461Z                          [CmdletBinding()]
2026-01-11T19:28:13.3628868Z                          param()
2026-01-11T19:28:13.3629194Z                      
2026-01-11T19:28:13.3630343Z                          if (Test-Path $script:DefaultsPath) {
2026-01-11T19:28:13.3630826Z                              try {
2026-01-11T19:28:13.3631610Z                                  $json = Get-Content $script:DefaultsPath -Raw | ConvertFrom-Json
2026-01-11T19:28:13.3632258Z                                  return Convert-PSObjectToHashtable $json
2026-01-11T19:28:13.3632745Z                              } catch {
2026-01-11T19:28:13.3633325Z                                  Write-Warning "Failed to load defaults.json: $_. Using hardcoded defaults."
2026-01-11T19:28:13.3633908Z                              }
2026-01-11T19:28:13.3633987Z                          }
2026-01-11T19:28:13.3635190Z                      
2026-01-11T19:28:13.3636114Z                          return @{
2026-01-11T19:28:13.3636892Z                              version = "2.0"
2026-01-11T19:28:13.3637348Z                              performance = @{
2026-01-11T19:28:13.3638787Z                                  hpet_disable = $true
2026-01-11T19:28:13.3639176Z                                  msi_mode = $true
2026-01-11T19:28:13.3639918Z                                  timer_resolution = $true
2026-01-11T19:28:13.3641022Z                                  core_parking_disable = $true
2026-01-11T19:28:13.3641483Z                                  c_states_disable = $false
2026-01-11T19:28:13.3642543Z                                  memory_compression_disable = $true
2026-01-11T19:28:13.3643041Z                                  gpu_scheduling = $false
2026-01-11T19:28:13.3644121Z                                  audio_optimization = $true
2026-01-11T19:28:13.3644566Z                                  game_bar_disable = $true
2026-01-11T19:28:13.3645383Z                                  fast_startup_disable = $true
2026-01-11T19:28:13.3645868Z                              }
2026-01-11T19:28:13.3646814Z                              power = @{
2026-01-11T19:28:13.3647303Z                                  high_performance_plan = $true
2026-01-11T19:28:13.3647819Z                                  pcie_link_state_disable = $true
2026-01-11T19:28:13.3648243Z                                  usb_selective_suspend_disable = $true
2026-01-11T19:28:13.3649291Z                                  processor_idle_disable = $true
2026-01-11T19:28:13.3649408Z                              }
2026-01-11T19:28:13.3650653Z                              privacy = @{
2026-01-11T19:28:13.3650845Z                                  telemetry_services_disable = $true
2026-01-11T19:28:13.3652051Z                                  location_tracking_disable = $true
2026-01-11T19:28:13.3652373Z                                  camera_access_disable = $true
2026-01-11T19:28:13.3653521Z                                  biometrics_disable = $true
2026-01-11T19:28:13.3653780Z                                  cloud_sync_disable = $false
2026-01-11T19:28:13.3654835Z                                  hosts_file_blocking = $true
2026-01-11T19:28:13.3655228Z                              }
2026-01-11T19:28:13.3656150Z                              software = @{
2026-01-11T19:28:13.3656877Z                                  steam = $true
2026-01-11T19:28:13.3658223Z                                  discord = $true
2026-01-11T19:28:13.3658352Z                                  vlc = $false
2026-01-11T19:28:13.3659745Z                                  brave = $false
2026-01-11T19:28:13.3660760Z                                  spotify = $false
2026-01-11T19:28:13.3661752Z                                  qbittorrent = $false
2026-01-11T19:28:13.3662537Z                                  python = $false
2026-01-11T19:28:13.3663434Z                                  zed = $false
2026-01-11T19:28:13.3663574Z                                  hue_sync = $false
2026-01-11T19:28:13.3664926Z                                  logitech_ghub = $false
2026-01-11T19:28:13.3665719Z                              }
2026-01-11T19:28:13.3666175Z                              network = @{
2026-01-11T19:28:13.3667051Z                                  tcp_optimization = $true
2026-01-11T19:28:13.3667519Z                                  dns_provider = "cloudflare"
2026-01-11T19:28:13.3668596Z                                  dns_custom_ipv4 = ""
2026-01-11T19:28:13.3669193Z                                  qos_enable = $true
2026-01-11T19:28:13.3670181Z                              }
2026-01-11T19:28:13.3670913Z                              games = @{
2026-01-11T19:28:13.3671852Z                                  steam_paths = @("C:\Program Files (x86)\Steam\steamapps\common")
2026-01-11T19:28:13.3672300Z                                  auto_detect = $true
2026-01-11T19:28:13.3672675Z                                  process_priority = $true
2026-01-11T19:28:13.3673975Z                                  autoexec_generation = $true
2026-01-11T19:28:13.3674100Z                              }
2026-01-11T19:28:13.3674984Z                          }
2026-01-11T19:28:13.3675096Z                      }
2026-01-11T19:28:13.3676231Z                      
2026-01-11T19:28:13.3676394Z                      function Get-UserConfig {
2026-01-11T19:28:13.3677486Z                          <#
2026-01-11T19:28:13.3677602Z                          .SYNOPSIS
2026-01-11T19:28:13.3679249Z                              Loads the user configuration file when present.
2026-01-11T19:28:13.3679397Z                          .DESCRIPTION
2026-01-11T19:28:13.3680201Z                              Reads user-config.json and converts it to a hashtable. Falls back to
2026-01-11T19:28:13.3681202Z                              Get-DefaultConfig if the file does not exist or is invalid.
2026-01-11T19:28:13.3681580Z                          .OUTPUTS
2026-01-11T19:28:13.3682693Z                              [hashtable] User configuration merged from disk or defaults.
2026-01-11T19:28:13.3682825Z                          #>
2026-01-11T19:28:13.3684034Z                      
2026-01-11T19:28:13.3684296Z                          [CmdletBinding()]
2026-01-11T19:28:13.3685764Z                          param()
2026-01-11T19:28:13.3685953Z                      
2026-01-11T19:28:13.3687013Z                          if (Test-Path $script:UserConfigPath) {
2026-01-11T19:28:13.3687136Z                              try {
2026-01-11T19:28:13.3688458Z                                  $json = Get-Content $script:UserConfigPath -Raw | ConvertFrom-Json
2026-01-11T19:28:13.3688649Z                                  return Convert-PSObjectToHashtable $json
2026-01-11T19:28:13.3689625Z                              } catch {
2026-01-11T19:28:13.3690690Z                                  Write-Warning "Failed to load user-config.json: $_. Using defaults."
2026-01-11T19:28:13.3690825Z                              }
2026-01-11T19:28:13.3691747Z                          }
2026-01-11T19:28:13.3693132Z                      
2026-01-11T19:28:13.3693568Z                          return Get-DefaultConfig
2026-01-11T19:28:13.3693680Z                      }
2026-01-11T19:28:13.3693763Z                      
2026-01-11T19:28:13.3693903Z                      function Save-UserConfig {
2026-01-11T19:28:13.3694258Z                          <#
2026-01-11T19:28:13.3695162Z                          .SYNOPSIS
2026-01-11T19:28:13.3695374Z                              Persists a configuration to disk.
2026-01-11T19:28:13.3696311Z                          .DESCRIPTION
2026-01-11T19:28:13.3698058Z                              Creates the config directory if needed, backs up any existing
2026-01-11T19:28:13.3699101Z                              user-config.json, and writes the new configuration in JSON format.
2026-01-11T19:28:13.3699275Z                          .PARAMETER Config
2026-01-11T19:28:13.3700094Z                              Hashtable of configuration settings to save.
2026-01-11T19:28:13.3700676Z                          .OUTPUTS
2026-01-11T19:28:13.3702105Z                              [bool] True on success, false on failure.
2026-01-11T19:28:13.3702214Z                          #>
2026-01-11T19:28:13.3702649Z                      
2026-01-11T19:28:13.3703036Z                          [CmdletBinding()]
2026-01-11T19:28:13.3703410Z                          param(
2026-01-11T19:28:13.3704131Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.3704434Z                              [hashtable]$Config
2026-01-11T19:28:13.3704868Z                          )
2026-01-11T19:28:13.3705278Z                      
2026-01-11T19:28:13.3705950Z                          try {
2026-01-11T19:28:13.3706669Z                              if (-not (Test-Path $script:ConfigDir)) {
2026-01-11T19:28:13.3707437Z                                  New-Item -ItemType Directory -Path $script:ConfigDir -Force | Out-Null
2026-01-11T19:28:13.3707530Z                              }
2026-01-11T19:28:13.3708047Z                      
2026-01-11T19:28:13.3708529Z                              if (Test-Path $script:UserConfigPath) {
2026-01-11T19:28:13.3708959Z                                  $backupPath = "$script:UserConfigPath.backup"
2026-01-11T19:28:13.3709983Z                                  Copy-Item $script:UserConfigPath $backupPath -Force
2026-01-11T19:28:13.3710660Z                              }
2026-01-11T19:28:13.3711467Z                      
2026-01-11T19:28:13.3712346Z                              $json = $Config | ConvertTo-Json -Depth 10
2026-01-11T19:28:13.3713613Z                              Set-Content -Path $script:UserConfigPath -Value $json -Force
2026-01-11T19:28:13.3713746Z                      
2026-01-11T19:28:13.3714485Z                              Write-Verbose "Configuration saved to: $script:UserConfigPath"
2026-01-11T19:28:13.3714924Z                              return $true
2026-01-11T19:28:13.3716062Z                      
2026-01-11T19:28:13.3716205Z                          } catch {
2026-01-11T19:28:13.3717611Z                              Write-Error "Failed to save configuration: $_"
2026-01-11T19:28:13.3718230Z                              return $false
2026-01-11T19:28:13.3719147Z                          }
2026-01-11T19:28:13.3720106Z                      }
2026-01-11T19:28:13.3720192Z                      
2026-01-11T19:28:13.3721602Z                      function Get-Profile {
2026-01-11T19:28:13.3722537Z                          <#
2026-01-11T19:28:13.3723204Z                          .SYNOPSIS
2026-01-11T19:28:13.3724521Z                              Loads a named profile from the profiles directory.
2026-01-11T19:28:13.3725048Z                          .DESCRIPTION
2026-01-11T19:28:13.3725436Z                              Reads a profile JSON file and converts it to a hashtable. Falls back to
2026-01-11T19:28:13.3726029Z                              defaults when the profile is missing or invalid.
2026-01-11T19:28:13.3726740Z                          .PARAMETER ProfileName
2026-01-11T19:28:13.3727306Z                              Profile identifier. Valid values: competitive, balanced, privacy-focused.
2026-01-11T19:28:13.3728207Z                          .OUTPUTS
2026-01-11T19:28:13.3729092Z                              [hashtable] Profile configuration.
2026-01-11T19:28:13.3729428Z                          #>
2026-01-11T19:28:13.3730538Z                      
2026-01-11T19:28:13.3730676Z                          [CmdletBinding()]
2026-01-11T19:28:13.3731817Z                          param(
2026-01-11T19:28:13.3731991Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.3733431Z                              [ValidateSet('competitive', 'balanced', 'privacy-focused')]
2026-01-11T19:28:13.3733586Z                              [string]$ProfileName
2026-01-11T19:28:13.3733888Z                          )
2026-01-11T19:28:13.3734881Z                      
2026-01-11T19:28:13.3736107Z                          $profilePath = Join-Path $script:ProfilesDir "$ProfileName.json"
2026-01-11T19:28:13.3736237Z                      
2026-01-11T19:28:13.3737653Z                          if (Test-Path $profilePath) {
2026-01-11T19:28:13.3738057Z                              try {
2026-01-11T19:28:13.3739565Z                                  $json = Get-Content $profilePath -Raw | ConvertFrom-Json
2026-01-11T19:28:13.3739783Z                                  return Convert-PSObjectToHashtable $json
2026-01-11T19:28:13.3739898Z                              } catch {
2026-01-11T19:28:13.3741547Z                                  Write-Warning "Failed to load profile '$ProfileName': $_. Using defaults."
2026-01-11T19:28:13.3741660Z                              }
2026-01-11T19:28:13.3742619Z                          } else {
2026-01-11T19:28:13.3742940Z                              Write-Warning "Profile not found: $profilePath. Using defaults."
2026-01-11T19:28:13.3743076Z                          }
2026-01-11T19:28:13.3744370Z                      
2026-01-11T19:28:13.3744570Z                          return Get-DefaultConfig
2026-01-11T19:28:13.3745733Z                      }
2026-01-11T19:28:13.3746513Z                      
2026-01-11T19:28:13.3747386Z                      function Get-AvailableProfiles {
2026-01-11T19:28:13.3748367Z                          <#
2026-01-11T19:28:13.3749146Z                          .SYNOPSIS
2026-01-11T19:28:13.3750424Z                              Lists available profile names.
2026-01-11T19:28:13.3750688Z                          .DESCRIPTION
2026-01-11T19:28:13.3751910Z                              Reads profile JSON filenames from the profiles directory. Returns a
2026-01-11T19:28:13.3752149Z                              default list if the directory does not exist.
2026-01-11T19:28:13.3752352Z                          .OUTPUTS
2026-01-11T19:28:13.3753359Z                              [string[]] Profile name list.
2026-01-11T19:28:13.3753458Z                          #>
2026-01-11T19:28:13.3753864Z                      
2026-01-11T19:28:13.3754655Z                          if (Test-Path $script:ProfilesDir) {
2026-01-11T19:28:13.3755782Z                              $profiles = Get-ChildItem -Path $script:ProfilesDir -Filter "*.json" |
2026-01-11T19:28:13.3756055Z                                          Select-Object -ExpandProperty BaseName
2026-01-11T19:28:13.3756393Z                              return $profiles
2026-01-11T19:28:13.3757760Z                          }
2026-01-11T19:28:13.3758512Z                      
2026-01-11T19:28:13.3759606Z                          return @('competitive', 'balanced', 'privacy-focused')
2026-01-11T19:28:13.3759710Z                      }
2026-01-11T19:28:13.3760931Z                      
2026-01-11T19:28:13.3761078Z                      function Merge-Config {
2026-01-11T19:28:13.3762047Z                          <#
2026-01-11T19:28:13.3763126Z                          .SYNOPSIS
2026-01-11T19:28:13.3763632Z                              Deep-merges two configuration hashtables.
2026-01-11T19:28:13.3763795Z                          .DESCRIPTION
2026-01-11T19:28:13.3765216Z                              Recursively merges the override hashtable into the base hashtable,
2026-01-11T19:28:13.3765349Z                              returning a new hashtable instance.
2026-01-11T19:28:13.3766008Z                          .PARAMETER Base
2026-01-11T19:28:13.3767181Z                              Base configuration hashtable.
2026-01-11T19:28:13.3767306Z                          .PARAMETER Override
2026-01-11T19:28:13.3768379Z                              Overrides that take precedence over base values.
2026-01-11T19:28:13.3768852Z                          .OUTPUTS
2026-01-11T19:28:13.3769350Z                              [hashtable] Merged configuration.
2026-01-11T19:28:13.3769662Z                          #>
2026-01-11T19:28:13.3770093Z                      
2026-01-11T19:28:13.3770491Z                          [CmdletBinding()]
2026-01-11T19:28:13.3770909Z                          param(
2026-01-11T19:28:13.3771342Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.3771732Z                              [hashtable]$Base,
2026-01-11T19:28:13.3772085Z                      
2026-01-11T19:28:13.3773034Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.3773495Z                              [hashtable]$Override
2026-01-11T19:28:13.3774408Z                          )
2026-01-11T19:28:13.3775188Z                      
2026-01-11T19:28:13.3776374Z                          $merged = $Base.Clone()
2026-01-11T19:28:13.3776493Z                      
2026-01-11T19:28:13.3777229Z                          foreach ($key in $Override.Keys) {
2026-01-11T19:28:13.3778221Z                              if ($merged.ContainsKey($key)) {
2026-01-11T19:28:13.3778614Z                                  if ($merged[$key] -is [hashtable] -and $Override[$key] -is [hashtable]) {
2026-01-11T19:28:13.3779310Z                                      $merged[$key] = Merge-Config -Base $merged[$key] -Override $Override[$key]
2026-01-11T19:28:13.3779667Z                                  } else {
2026-01-11T19:28:13.3780531Z                                      $merged[$key] = $Override[$key]
2026-01-11T19:28:13.3781195Z                                  }
2026-01-11T19:28:13.3782105Z                              } else {
2026-01-11T19:28:13.3783001Z                                  $merged[$key] = $Override[$key]
2026-01-11T19:28:13.3783121Z                              }
2026-01-11T19:28:13.3784434Z                          }
2026-01-11T19:28:13.3784537Z                      
2026-01-11T19:28:13.3785619Z                          return $merged
2026-01-11T19:28:13.3785721Z                      }
2026-01-11T19:28:13.3787013Z                      
2026-01-11T19:28:13.3787205Z                      function Test-ConfigValid {
2026-01-11T19:28:13.3788182Z                          <#
2026-01-11T19:28:13.3789174Z                          .SYNOPSIS
2026-01-11T19:28:13.3789378Z                              Validates configuration structure.
2026-01-11T19:28:13.3790144Z                          .DESCRIPTION
2026-01-11T19:28:13.3790987Z                              Ensures required top-level keys exist in the configuration.
2026-01-11T19:28:13.3791136Z                          .PARAMETER Config
2026-01-11T19:28:13.3791902Z                              Configuration to validate.
2026-01-11T19:28:13.3792643Z                          .OUTPUTS
2026-01-11T19:28:13.3793599Z                              [bool] True when required keys are present.
2026-01-11T19:28:13.3794535Z                          #>
2026-01-11T19:28:13.3794636Z                      
2026-01-11T19:28:13.3795878Z                          [CmdletBinding()]
2026-01-11T19:28:13.3796218Z                          param(
2026-01-11T19:28:13.3797501Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.3797993Z                              [hashtable]$Config
2026-01-11T19:28:13.3799004Z                          )
2026-01-11T19:28:13.3799129Z                      
2026-01-11T19:28:13.3800440Z                          $requiredKeys = @('performance', 'power', 'privacy', 'software', 'network', 'games')
2026-01-11T19:28:13.3800579Z                      
2026-01-11T19:28:13.3801949Z                          foreach ($key in $requiredKeys) {
2026-01-11T19:28:13.3802183Z                              if (-not $Config.ContainsKey($key)) {
2026-01-11T19:28:13.3803280Z                                  Write-Warning "Configuration missing required key: $key"
2026-01-11T19:28:13.3804141Z                                  return $false
2026-01-11T19:28:13.3804726Z                              }
2026-01-11T19:28:13.3805689Z                          }
2026-01-11T19:28:13.3805774Z                      
2026-01-11T19:28:13.3806800Z                          return $true
2026-01-11T19:28:13.3807266Z                      }
2026-01-11T19:28:13.3807653Z                      
2026-01-11T19:28:13.3808735Z                      
2026-01-11T19:28:13.3808977Z                      function Convert-PSObjectToHashtable {
2026-01-11T19:28:13.3810128Z                          <#
2026-01-11T19:28:13.3810752Z                          .SYNOPSIS
2026-01-11T19:28:13.3811869Z                              Converts PSCustomObject graphs into hashtables.
2026-01-11T19:28:13.3812294Z                          .DESCRIPTION
2026-01-11T19:28:13.3813479Z                              Recursively converts PSCustomObject and collections so that downstream
2026-01-11T19:28:13.3813797Z                              code can treat config data as hashtables rather than PSObjects.
2026-01-11T19:28:13.3813974Z                          .PARAMETER InputObject
2026-01-11T19:28:13.3814908Z                              Object or collection to convert.
2026-01-11T19:28:13.3815301Z                          .OUTPUTS
2026-01-11T19:28:13.3816423Z                              [object] A hashtable, array, or scalar equivalent of the input.
2026-01-11T19:28:13.3816530Z                          #>
2026-01-11T19:28:13.3816950Z                      
2026-01-11T19:28:13.3817393Z                          param($InputObject)
2026-01-11T19:28:13.3818341Z                      
2026-01-11T19:28:13.3819405Z                          if ($null -eq $InputObject) { return $null }
2026-01-11T19:28:13.3819747Z                      
2026-01-11T19:28:13.3821126Z                          if ($InputObject -is [System.Collections.IEnumerable] -and $InputObject -isnot [string]) {
2026-01-11T19:28:13.3821465Z                              $collection = @(
2026-01-11T19:28:13.3822862Z                                  foreach ($object in $InputObject) {
2026-01-11T19:28:13.3823103Z                                      Convert-PSObjectToHashtable $object
2026-01-11T19:28:13.3823241Z                                  }
2026-01-11T19:28:13.3823880Z                              )
2026-01-11T19:28:13.3824960Z                              return $collection
2026-01-11T19:28:13.3825799Z                          }
2026-01-11T19:28:13.3827057Z                          elseif ($InputObject -is [PSCustomObject]) {
2026-01-11T19:28:13.3827296Z                              $hash = @{}
2026-01-11T19:28:13.3827898Z                              foreach ($property in $InputObject.PSObject.Properties) {
2026-01-11T19:28:13.3828490Z                                  $hash[$property.Name] = Convert-PSObjectToHashtable $property.Value
2026-01-11T19:28:13.3828615Z                              }
2026-01-11T19:28:13.3829720Z                              return $hash
2026-01-11T19:28:13.3829851Z                          }
2026-01-11T19:28:13.3831289Z                          else {
2026-01-11T19:28:13.3831446Z                              return $InputObject
2026-01-11T19:28:13.3832373Z                          }
2026-01-11T19:28:13.3832480Z                      }
2026-01-11T19:28:13.3833766Z                      
2026-01-11T19:28:13.3834114Z                      
2026-01-11T19:28:13.3834706Z                      Export-ModuleMember -Function @(
2026-01-11T19:28:13.3835598Z                          'Get-DefaultConfig',
2026-01-11T19:28:13.3836054Z                          'Get-UserConfig',
2026-01-11T19:28:13.3836904Z                          'Save-UserConfig',
2026-01-11T19:28:13.3838071Z                          'Get-Profile',
2026-01-11T19:28:13.3838233Z                          'Get-AvailableProfiles',
2026-01-11T19:28:13.3838341Z                          'Merge-Config',
2026-01-11T19:28:13.3839728Z                          'Test-ConfigValid'
2026-01-11T19:28:13.3839839Z                      )
2026-01-11T19:28:13.3841266Z [32;1mCleanBlock         : [0m
2026-01-11T19:28:13.3841453Z [32;1mDynamicParamBlock  : [0m
2026-01-11T19:28:13.3841716Z [32;1mScriptRequirements : [0m
2026-01-11T19:28:13.3843835Z [32;1mExtent             : [0m
2026-01-11T19:28:13.3843941Z                      <#
2026-01-11T19:28:13.3845035Z                      .SYNOPSIS
2026-01-11T19:28:13.3845318Z                          Configuration loading, merging, and persistence helpers.
2026-01-11T19:28:13.3846006Z                      .DESCRIPTION
2026-01-11T19:28:13.3847046Z                          Loads defaults, user configuration, and profiles from JSON files under
2026-01-11T19:28:13.3847610Z                          the config directory. Includes helpers to merge and validate configurations.
2026-01-11T19:28:13.3848552Z                      .NOTES
2026-01-11T19:28:13.3849533Z                          The config directory is resolved relative to the module root.
2026-01-11T19:28:13.3849845Z                      #>
2026-01-11T19:28:13.3850799Z                      
2026-01-11T19:28:13.3852057Z                      # Module paths for configuration storage.
2026-01-11T19:28:13.3852541Z                      $script:ConfigDir = Join-Path $PSScriptRoot "..\..\config"
2026-01-11T19:28:13.3853525Z                      $script:DataDir = Join-Path $PSScriptRoot "..\..\data"
2026-01-11T19:28:13.3854292Z                      $script:DefaultsPath = Join-Path $script:ConfigDir "defaults.json"
2026-01-11T19:28:13.3854897Z                      $script:UserConfigPath = Join-Path $script:ConfigDir "user-config.json"
2026-01-11T19:28:13.3855205Z                      $script:ProfilesDir = Join-Path $script:ConfigDir "profiles"
2026-01-11T19:28:13.3856302Z                      
2026-01-11T19:28:13.3857141Z                      
2026-01-11T19:28:13.3858149Z                      function Get-DefaultConfig {
2026-01-11T19:28:13.3859188Z                          <#
2026-01-11T19:28:13.3859311Z                          .SYNOPSIS
2026-01-11T19:28:13.3860525Z                              Returns the default configuration.
2026-01-11T19:28:13.3860650Z                          .DESCRIPTION
2026-01-11T19:28:13.3861996Z                              Attempts to load defaults.json from the config directory. Falls back to
2026-01-11T19:28:13.3862227Z                              embedded defaults when the file is missing or invalid.
2026-01-11T19:28:13.3863151Z                          .OUTPUTS
2026-01-11T19:28:13.3864025Z                              [hashtable] Default configuration.
2026-01-11T19:28:13.3864474Z                          #>
2026-01-11T19:28:13.3865237Z                      
2026-01-11T19:28:13.3865774Z                          [CmdletBinding()]
2026-01-11T19:28:13.3866518Z                          param()
2026-01-11T19:28:13.3866702Z                      
2026-01-11T19:28:13.3867914Z                          if (Test-Path $script:DefaultsPath) {
2026-01-11T19:28:13.3868762Z                              try {
2026-01-11T19:28:13.3869899Z                                  $json = Get-Content $script:DefaultsPath -Raw | ConvertFrom-Json
2026-01-11T19:28:13.3870450Z                                  return Convert-PSObjectToHashtable $json
2026-01-11T19:28:13.3870783Z                              } catch {
2026-01-11T19:28:13.3872345Z                                  Write-Warning "Failed to load defaults.json: $_. Using hardcoded defaults."
2026-01-11T19:28:13.3872438Z                              }
2026-01-11T19:28:13.3873285Z                          }
2026-01-11T19:28:13.3874094Z                      
2026-01-11T19:28:13.3874750Z                          return @{
2026-01-11T19:28:13.3875805Z                              version = "2.0"
2026-01-11T19:28:13.3875953Z                              performance = @{
2026-01-11T19:28:13.3877217Z                                  hpet_disable = $true
2026-01-11T19:28:13.3877659Z                                  msi_mode = $true
2026-01-11T19:28:13.3878910Z                                  timer_resolution = $true
2026-01-11T19:28:13.3879082Z                                  core_parking_disable = $true
2026-01-11T19:28:13.3879853Z                                  c_states_disable = $false
2026-01-11T19:28:13.3881141Z                                  memory_compression_disable = $true
2026-01-11T19:28:13.3881338Z                                  gpu_scheduling = $false
2026-01-11T19:28:13.3882525Z                                  audio_optimization = $true
2026-01-11T19:28:13.3883910Z                                  game_bar_disable = $true
2026-01-11T19:28:13.3884097Z                                  fast_startup_disable = $true
2026-01-11T19:28:13.3884191Z                              }
2026-01-11T19:28:13.3884649Z                              power = @{
2026-01-11T19:28:13.3885637Z                                  high_performance_plan = $true
2026-01-11T19:28:13.3886188Z                                  pcie_link_state_disable = $true
2026-01-11T19:28:13.3887218Z                                  usb_selective_suspend_disable = $true
2026-01-11T19:28:13.3887401Z                                  processor_idle_disable = $true
2026-01-11T19:28:13.3888321Z                              }
2026-01-11T19:28:13.3888455Z                              privacy = @{
2026-01-11T19:28:13.3889546Z                                  telemetry_services_disable = $true
2026-01-11T19:28:13.3890433Z                                  location_tracking_disable = $true
2026-01-11T19:28:13.3891017Z                                  camera_access_disable = $true
2026-01-11T19:28:13.3891958Z                                  biometrics_disable = $true
2026-01-11T19:28:13.3892974Z                                  cloud_sync_disable = $false
2026-01-11T19:28:13.3893182Z                                  hosts_file_blocking = $true
2026-01-11T19:28:13.3894401Z                              }
2026-01-11T19:28:13.3894587Z                              software = @{
2026-01-11T19:28:13.3895727Z                                  steam = $true
2026-01-11T19:28:13.3896390Z                                  discord = $true
2026-01-11T19:28:13.3897439Z                                  vlc = $false
2026-01-11T19:28:13.3897659Z                                  brave = $false
2026-01-11T19:28:13.3898757Z                                  spotify = $false
2026-01-11T19:28:13.3899643Z                                  qbittorrent = $false
2026-01-11T19:28:13.3900477Z                                  python = $false
2026-01-11T19:28:13.3900670Z                                  zed = $false
2026-01-11T19:28:13.3902056Z                                  hue_sync = $false
2026-01-11T19:28:13.3902244Z                                  logitech_ghub = $false
2026-01-11T19:28:13.3902821Z                              }
2026-01-11T19:28:13.3903783Z                              network = @{
2026-01-11T19:28:13.3904929Z                                  tcp_optimization = $true
2026-01-11T19:28:13.3905132Z                                  dns_provider = "cloudflare"
2026-01-11T19:28:13.3906181Z                                  dns_custom_ipv4 = ""
2026-01-11T19:28:13.3906693Z                                  qos_enable = $true
2026-01-11T19:28:13.3907027Z                              }
2026-01-11T19:28:13.3908510Z                              games = @{
2026-01-11T19:28:13.3908857Z                                  steam_paths = @("C:\Program Files (x86)\Steam\steamapps\common")
2026-01-11T19:28:13.3909335Z                                  auto_detect = $true
2026-01-11T19:28:13.3910375Z                                  process_priority = $true
2026-01-11T19:28:13.3910543Z                                  autoexec_generation = $true
2026-01-11T19:28:13.3911388Z                              }
2026-01-11T19:28:13.3912242Z                          }
2026-01-11T19:28:13.3913237Z                      }
2026-01-11T19:28:13.3913736Z                      
2026-01-11T19:28:13.3914738Z                      function Get-UserConfig {
2026-01-11T19:28:13.3916025Z                          <#
2026-01-11T19:28:13.3916193Z                          .SYNOPSIS
2026-01-11T19:28:13.3918082Z                              Loads the user configuration file when present.
2026-01-11T19:28:13.3918519Z                          .DESCRIPTION
2026-01-11T19:28:13.3919660Z                              Reads user-config.json and converts it to a hashtable. Falls back to
2026-01-11T19:28:13.3919980Z                              Get-DefaultConfig if the file does not exist or is invalid.
2026-01-11T19:28:13.3920428Z                          .OUTPUTS
2026-01-11T19:28:13.3921658Z                              [hashtable] User configuration merged from disk or defaults.
2026-01-11T19:28:13.3922037Z                          #>
2026-01-11T19:28:13.3922769Z                      
2026-01-11T19:28:13.3923711Z                          [CmdletBinding()]
2026-01-11T19:28:13.3924063Z                          param()
2026-01-11T19:28:13.3925381Z                      
2026-01-11T19:28:13.3925613Z                          if (Test-Path $script:UserConfigPath) {
2026-01-11T19:28:13.3926352Z                              try {
2026-01-11T19:28:13.3927025Z                                  $json = Get-Content $script:UserConfigPath -Raw | ConvertFrom-Json
2026-01-11T19:28:13.3927556Z                                  return Convert-PSObjectToHashtable $json
2026-01-11T19:28:13.3928712Z                              } catch {
2026-01-11T19:28:13.3929393Z                                  Write-Warning "Failed to load user-config.json: $_. Using defaults."
2026-01-11T19:28:13.3930153Z                              }
2026-01-11T19:28:13.3930981Z                          }
2026-01-11T19:28:13.3931083Z                      
2026-01-11T19:28:13.3932294Z                          return Get-DefaultConfig
2026-01-11T19:28:13.3932397Z                      }
2026-01-11T19:28:13.3933672Z                      
2026-01-11T19:28:13.3933868Z                      function Save-UserConfig {
2026-01-11T19:28:13.3934763Z                          <#
2026-01-11T19:28:13.3935461Z                          .SYNOPSIS
2026-01-11T19:28:13.3936883Z                              Persists a configuration to disk.
2026-01-11T19:28:13.3937010Z                          .DESCRIPTION
2026-01-11T19:28:13.3938154Z                              Creates the config directory if needed, backs up any existing
2026-01-11T19:28:13.3938477Z                              user-config.json, and writes the new configuration in JSON format.
2026-01-11T19:28:13.3939480Z                          .PARAMETER Config
2026-01-11T19:28:13.3940500Z                              Hashtable of configuration settings to save.
2026-01-11T19:28:13.3940624Z                          .OUTPUTS
2026-01-11T19:28:13.3941456Z                              [bool] True on success, false on failure.
2026-01-11T19:28:13.3942132Z                          #>
2026-01-11T19:28:13.3943030Z                      
2026-01-11T19:28:13.3943748Z                          [CmdletBinding()]
2026-01-11T19:28:13.3944750Z                          param(
2026-01-11T19:28:13.3944940Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.3945967Z                              [hashtable]$Config
2026-01-11T19:28:13.3947061Z                          )
2026-01-11T19:28:13.3947212Z                      
2026-01-11T19:28:13.3947672Z                          try {
2026-01-11T19:28:13.3948685Z                              if (-not (Test-Path $script:ConfigDir)) {
2026-01-11T19:28:13.3949406Z                                  New-Item -ItemType Directory -Path $script:ConfigDir -Force | Out-Null
2026-01-11T19:28:13.3949826Z                              }
2026-01-11T19:28:13.3950227Z                      
2026-01-11T19:28:13.3950738Z                              if (Test-Path $script:UserConfigPath) {
2026-01-11T19:28:13.3951823Z                                  $backupPath = "$script:UserConfigPath.backup"
2026-01-11T19:28:13.3952086Z                                  Copy-Item $script:UserConfigPath $backupPath -Force
2026-01-11T19:28:13.3953034Z                              }
2026-01-11T19:28:13.3953340Z                      
2026-01-11T19:28:13.3954588Z                              $json = $Config | ConvertTo-Json -Depth 10
2026-01-11T19:28:13.3955134Z                              Set-Content -Path $script:UserConfigPath -Value $json -Force
2026-01-11T19:28:13.3955445Z                      
2026-01-11T19:28:13.3956726Z                              Write-Verbose "Configuration saved to: $script:UserConfigPath"
2026-01-11T19:28:13.3957142Z                              return $true
2026-01-11T19:28:13.3957240Z                      
2026-01-11T19:28:13.3958161Z                          } catch {
2026-01-11T19:28:13.3959456Z                              Write-Error "Failed to save configuration: $_"
2026-01-11T19:28:13.3959841Z                              return $false
2026-01-11T19:28:13.3960926Z                          }
2026-01-11T19:28:13.3961681Z                      }
2026-01-11T19:28:13.3962116Z                      
2026-01-11T19:28:13.3963055Z                      function Get-Profile {
2026-01-11T19:28:13.3963183Z                          <#
2026-01-11T19:28:13.3964355Z                          .SYNOPSIS
2026-01-11T19:28:13.3964689Z                              Loads a named profile from the profiles directory.
2026-01-11T19:28:13.3965600Z                          .DESCRIPTION
2026-01-11T19:28:13.3965980Z                              Reads a profile JSON file and converts it to a hashtable. Falls back to
2026-01-11T19:28:13.3967382Z                              defaults when the profile is missing or invalid.
2026-01-11T19:28:13.3967532Z                          .PARAMETER ProfileName
2026-01-11T19:28:13.3968317Z                              Profile identifier. Valid values: competitive, balanced, privacy-focused.
2026-01-11T19:28:13.3968781Z                          .OUTPUTS
2026-01-11T19:28:13.3969317Z                              [hashtable] Profile configuration.
2026-01-11T19:28:13.3970473Z                          #>
2026-01-11T19:28:13.3970588Z                      
2026-01-11T19:28:13.3971669Z                          [CmdletBinding()]
2026-01-11T19:28:13.3971788Z                          param(
2026-01-11T19:28:13.3973196Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.3973519Z                              [ValidateSet('competitive', 'balanced', 'privacy-focused')]
2026-01-11T19:28:13.3974006Z                              [string]$ProfileName
2026-01-11T19:28:13.3974338Z                          )
2026-01-11T19:28:13.3975470Z                      
2026-01-11T19:28:13.3975813Z                          $profilePath = Join-Path $script:ProfilesDir "$ProfileName.json"
2026-01-11T19:28:13.3976180Z                      
2026-01-11T19:28:13.3977371Z                          if (Test-Path $profilePath) {
2026-01-11T19:28:13.3977850Z                              try {
2026-01-11T19:28:13.3979341Z                                  $json = Get-Content $profilePath -Raw | ConvertFrom-Json
2026-01-11T19:28:13.3979547Z                                  return Convert-PSObjectToHashtable $json
2026-01-11T19:28:13.3980401Z                              } catch {
2026-01-11T19:28:13.3981070Z                                  Write-Warning "Failed to load profile '$ProfileName': $_. Using defaults."
2026-01-11T19:28:13.3981908Z                              }
2026-01-11T19:28:13.3982541Z                          } else {
2026-01-11T19:28:13.3983715Z                              Write-Warning "Profile not found: $profilePath. Using defaults."
2026-01-11T19:28:13.3983902Z                          }
2026-01-11T19:28:13.3984923Z                      
2026-01-11T19:28:13.3985095Z                          return Get-DefaultConfig
2026-01-11T19:28:13.3985823Z                      }
2026-01-11T19:28:13.3986598Z                      
2026-01-11T19:28:13.3987585Z                      function Get-AvailableProfiles {
2026-01-11T19:28:13.3988372Z                          <#
2026-01-11T19:28:13.3988490Z                          .SYNOPSIS
2026-01-11T19:28:13.3989648Z                              Lists available profile names.
2026-01-11T19:28:13.3990305Z                          .DESCRIPTION
2026-01-11T19:28:13.3991538Z                              Reads profile JSON filenames from the profiles directory. Returns a
2026-01-11T19:28:13.3991730Z                              default list if the directory does not exist.
2026-01-11T19:28:13.3992070Z                          .OUTPUTS
2026-01-11T19:28:13.3993137Z                              [string[]] Profile name list.
2026-01-11T19:28:13.3993250Z                          #>
2026-01-11T19:28:13.3994046Z                      
2026-01-11T19:28:13.3994947Z                          if (Test-Path $script:ProfilesDir) {
2026-01-11T19:28:13.3996306Z                              $profiles = Get-ChildItem -Path $script:ProfilesDir -Filter "*.json" |
2026-01-11T19:28:13.3997179Z                                          Select-Object -ExpandProperty BaseName
2026-01-11T19:28:13.3997293Z                              return $profiles
2026-01-11T19:28:13.3998237Z                          }
2026-01-11T19:28:13.3998906Z                      
2026-01-11T19:28:13.3999912Z                          return @('competitive', 'balanced', 'privacy-focused')
2026-01-11T19:28:13.4000648Z                      }
2026-01-11T19:28:13.4001084Z                      
2026-01-11T19:28:13.4002253Z                      function Merge-Config {
2026-01-11T19:28:13.4002355Z                          <#
2026-01-11T19:28:13.4003167Z                          .SYNOPSIS
2026-01-11T19:28:13.4003924Z                              Deep-merges two configuration hashtables.
2026-01-11T19:28:13.4004524Z                          .DESCRIPTION
2026-01-11T19:28:13.4005883Z                              Recursively merges the override hashtable into the base hashtable,
2026-01-11T19:28:13.4006088Z                              returning a new hashtable instance.
2026-01-11T19:28:13.4006970Z                          .PARAMETER Base
2026-01-11T19:28:13.4007175Z                              Base configuration hashtable.
2026-01-11T19:28:13.4007912Z                          .PARAMETER Override
2026-01-11T19:28:13.4009067Z                              Overrides that take precedence over base values.
2026-01-11T19:28:13.4009780Z                          .OUTPUTS
2026-01-11T19:28:13.4010038Z                              [hashtable] Merged configuration.
2026-01-11T19:28:13.4010792Z                          #>
2026-01-11T19:28:13.4011728Z                      
2026-01-11T19:28:13.4011914Z                          [CmdletBinding()]
2026-01-11T19:28:13.4013024Z                          param(
2026-01-11T19:28:13.4013788Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.4015195Z                              [hashtable]$Base,
2026-01-11T19:28:13.4015307Z                      
2026-01-11T19:28:13.4016300Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.4016587Z                              [hashtable]$Override
2026-01-11T19:28:13.4017384Z                          )
2026-01-11T19:28:13.4017848Z                      
2026-01-11T19:28:13.4019255Z                          $merged = $Base.Clone()
2026-01-11T19:28:13.4019414Z                      
2026-01-11T19:28:13.4020579Z                          foreach ($key in $Override.Keys) {
2026-01-11T19:28:13.4020776Z                              if ($merged.ContainsKey($key)) {
2026-01-11T19:28:13.4021877Z                                  if ($merged[$key] -is [hashtable] -and $Override[$key] -is [hashtable]) {
2026-01-11T19:28:13.4022112Z                                      $merged[$key] = Merge-Config -Base $merged[$key] -Override $Override[$key]
2026-01-11T19:28:13.4022964Z                                  } else {
2026-01-11T19:28:13.4023776Z                                      $merged[$key] = $Override[$key]
2026-01-11T19:28:13.4024135Z                                  }
2026-01-11T19:28:13.4025076Z                              } else {
2026-01-11T19:28:13.4025292Z                                  $merged[$key] = $Override[$key]
2026-01-11T19:28:13.4026386Z                              }
2026-01-11T19:28:13.4026496Z                          }
2026-01-11T19:28:13.4027439Z                      
2026-01-11T19:28:13.4028131Z                          return $merged
2026-01-11T19:28:13.4028951Z                      }
2026-01-11T19:28:13.4029856Z                      
2026-01-11T19:28:13.4030750Z                      function Test-ConfigValid {
2026-01-11T19:28:13.4031369Z                          <#
2026-01-11T19:28:13.4032139Z                          .SYNOPSIS
2026-01-11T19:28:13.4033096Z                              Validates configuration structure.
2026-01-11T19:28:13.4033257Z                          .DESCRIPTION
2026-01-11T19:28:13.4035163Z                              Ensures required top-level keys exist in the configuration.
2026-01-11T19:28:13.4035304Z                          .PARAMETER Config
2026-01-11T19:28:13.4035495Z                              Configuration to validate.
2026-01-11T19:28:13.4036330Z                          .OUTPUTS
2026-01-11T19:28:13.4036569Z                              [bool] True when required keys are present.
2026-01-11T19:28:13.4037685Z                          #>
2026-01-11T19:28:13.4037788Z                      
2026-01-11T19:28:13.4038932Z                          [CmdletBinding()]
2026-01-11T19:28:13.4039331Z                          param(
2026-01-11T19:28:13.4040237Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.4040381Z                              [hashtable]$Config
2026-01-11T19:28:13.4041623Z                          )
2026-01-11T19:28:13.4041726Z                      
2026-01-11T19:28:13.4043033Z                          $requiredKeys = @('performance', 'power', 'privacy', 'software', 'network', 'games')
2026-01-11T19:28:13.4043153Z                      
2026-01-11T19:28:13.4044236Z                          foreach ($key in $requiredKeys) {
2026-01-11T19:28:13.4044423Z                              if (-not $Config.ContainsKey($key)) {
2026-01-11T19:28:13.4045271Z                                  Write-Warning "Configuration missing required key: $key"
2026-01-11T19:28:13.4045748Z                                  return $false
2026-01-11T19:28:13.4046797Z                              }
2026-01-11T19:28:13.4046919Z                          }
2026-01-11T19:28:13.4048108Z                      
2026-01-11T19:28:13.4048237Z                          return $true
2026-01-11T19:28:13.4049428Z                      }
2026-01-11T19:28:13.4049552Z                      
2026-01-11T19:28:13.4050350Z                      
2026-01-11T19:28:13.4050604Z                      function Convert-PSObjectToHashtable {
2026-01-11T19:28:13.4051680Z                          <#
2026-01-11T19:28:13.4052332Z                          .SYNOPSIS
2026-01-11T19:28:13.4053255Z                              Converts PSCustomObject graphs into hashtables.
2026-01-11T19:28:13.4053959Z                          .DESCRIPTION
2026-01-11T19:28:13.4055347Z                              Recursively converts PSCustomObject and collections so that downstream
2026-01-11T19:28:13.4055682Z                              code can treat config data as hashtables rather than PSObjects.
2026-01-11T19:28:13.4056945Z                          .PARAMETER InputObject
2026-01-11T19:28:13.4057135Z                              Object or collection to convert.
2026-01-11T19:28:13.4058218Z                          .OUTPUTS
2026-01-11T19:28:13.4059176Z                              [object] A hashtable, array, or scalar equivalent of the input.
2026-01-11T19:28:13.4059973Z                          #>
2026-01-11T19:28:13.4060078Z                      
2026-01-11T19:28:13.4061750Z                          param($InputObject)
2026-01-11T19:28:13.4061859Z                      
2026-01-11T19:28:13.4062331Z                          if ($null -eq $InputObject) { return $null }
2026-01-11T19:28:13.4062716Z                      
2026-01-11T19:28:13.4064858Z                          if ($InputObject -is [System.Collections.IEnumerable] -and $InputObject -isnot [string]) {
2026-01-11T19:28:13.4065058Z                              $collection = @(
2026-01-11T19:28:13.4065246Z                                  foreach ($object in $InputObject) {
2026-01-11T19:28:13.4065734Z                                      Convert-PSObjectToHashtable $object
2026-01-11T19:28:13.4065979Z                                  }
2026-01-11T19:28:13.4066706Z                              )
2026-01-11T19:28:13.4067366Z                              return $collection
2026-01-11T19:28:13.4067976Z                          }
2026-01-11T19:28:13.4069365Z                          elseif ($InputObject -is [PSCustomObject]) {
2026-01-11T19:28:13.4069483Z                              $hash = @{}
2026-01-11T19:28:13.4070035Z                              foreach ($property in $InputObject.PSObject.Properties) {
2026-01-11T19:28:13.4071004Z                                  $hash[$property.Name] = Convert-PSObjectToHashtable $property.Value
2026-01-11T19:28:13.4071113Z                              }
2026-01-11T19:28:13.4071989Z                              return $hash
2026-01-11T19:28:13.4072913Z                          }
2026-01-11T19:28:13.4073040Z                          else {
2026-01-11T19:28:13.4074202Z                              return $InputObject
2026-01-11T19:28:13.4074311Z                          }
2026-01-11T19:28:13.4076176Z                      }
2026-01-11T19:28:13.4076791Z                      
2026-01-11T19:28:13.4076882Z                      
2026-01-11T19:28:13.4077305Z                      Export-ModuleMember -Function @(
2026-01-11T19:28:13.4078023Z                          'Get-DefaultConfig',
2026-01-11T19:28:13.4078675Z                          'Get-UserConfig',
2026-01-11T19:28:13.4079206Z                          'Save-UserConfig',
2026-01-11T19:28:13.4079984Z                          'Get-Profile',
2026-01-11T19:28:13.4080676Z                          'Get-AvailableProfiles',
2026-01-11T19:28:13.4081000Z                          'Merge-Config',
2026-01-11T19:28:13.4081982Z                          'Test-ConfigValid'
2026-01-11T19:28:13.4082650Z                      )
2026-01-11T19:28:13.4083699Z                      
2026-01-11T19:28:13.4086152Z [32;1mParent             : [0m
2026-01-11T19:28:13.4086176Z 
2026-01-11T19:28:13.4106772Z [32;1mAttributes         : [0m{}
2026-01-11T19:28:13.4107025Z [32;1mUsingStatements    : [0m{}
2026-01-11T19:28:13.4108361Z [32;1mParamBlock         : [0m
2026-01-11T19:28:13.4110062Z [32;1mBeginBlock         : [0m
2026-01-11T19:28:13.4110935Z [32;1mProcessBlock       : [0m
2026-01-11T19:28:13.4112962Z [32;1mEndBlock           : [0m$script:LogPath = ".\gaming-pc-setup.log"
2026-01-11T19:28:13.4113142Z                      $script:StartTime = Get-Date
2026-01-11T19:28:13.4113309Z                      
2026-01-11T19:28:13.4114394Z                      
2026-01-11T19:28:13.4114633Z                      function Initialize-Logger {
2026-01-11T19:28:13.4115873Z                          <#
2026-01-11T19:28:13.4116015Z                          .SYNOPSIS
2026-01-11T19:28:13.4116210Z                              Initializes logging for the current run.
2026-01-11T19:28:13.4116368Z                          .DESCRIPTION
2026-01-11T19:28:13.4117523Z                              Sets the log path, records the start time, creates the log directory if
2026-01-11T19:28:13.4117922Z                              missing, optionally clears any existing log, and writes a header block.
2026-01-11T19:28:13.4118168Z                          .PARAMETER LogPath
2026-01-11T19:28:13.4118774Z                              Destination log file path. Defaults to ./gaming-pc-setup.log.
2026-01-11T19:28:13.4119084Z                          .PARAMETER ClearExisting
2026-01-11T19:28:13.4120048Z                              When true, removes the existing log file before writing new entries.
2026-01-11T19:28:13.4120164Z                          .OUTPUTS
2026-01-11T19:28:13.4120320Z                              None.
2026-01-11T19:28:13.4121046Z                          #>
2026-01-11T19:28:13.4121577Z                      
2026-01-11T19:28:13.4122397Z                          [CmdletBinding()]
2026-01-11T19:28:13.4123123Z                          param(
2026-01-11T19:28:13.4123333Z                              [string]$LogPath = ".\gaming-pc-setup.log",
2026-01-11T19:28:13.4123508Z                              [bool]$ClearExisting = $false
2026-01-11T19:28:13.4123796Z                          )
2026-01-11T19:28:13.4124153Z                      
2026-01-11T19:28:13.4125155Z                          $script:LogPath = $LogPath
2026-01-11T19:28:13.4125305Z                          $script:StartTime = Get-Date
2026-01-11T19:28:13.4125796Z                      
2026-01-11T19:28:13.4126588Z                          $logDir = Split-Path $LogPath -Parent
2026-01-11T19:28:13.4127107Z                          if ($logDir -and -not (Test-Path $logDir)) {
2026-01-11T19:28:13.4127539Z                              New-Item -ItemType Directory -Path $logDir -Force | Out-Null
2026-01-11T19:28:13.4127724Z                          }
2026-01-11T19:28:13.4128769Z                      
2026-01-11T19:28:13.4129233Z                          if ($ClearExisting -and (Test-Path $LogPath)) {
2026-01-11T19:28:13.4129519Z                              Remove-Item $LogPath -Force
2026-01-11T19:28:13.4129816Z                          }
2026-01-11T19:28:13.4130627Z                      
2026-01-11T19:28:13.4131115Z                          Write-Log "=== Gaming PC Setup - Log Started ===" "INFO"
2026-01-11T19:28:13.4131682Z                          Write-Log "Start Time: $(Get-Date -Format 'yyyy-MM-dd HH:mm:ss')" "INFO"
2026-01-11T19:28:13.4132050Z                          Write-Log "PowerShell Version: $($PSVersionTable.PSVersion)" "INFO"
2026-01-11T19:28:13.4132530Z                          Write-Log "Operating System: $([System.Environment]::OSVersion.VersionString)" "INFO"
2026-01-11T19:28:13.4132703Z                          Write-Log "Log Path: $LogPath" "INFO"
2026-01-11T19:28:13.4133800Z                      }
2026-01-11T19:28:13.4133955Z                      
2026-01-11T19:28:13.4134701Z                      function Write-Log {
2026-01-11T19:28:13.4135340Z                          <#
2026-01-11T19:28:13.4136527Z                          .SYNOPSIS
2026-01-11T19:28:13.4136768Z                              Writes a log line to file and console.
2026-01-11T19:28:13.4137677Z                          .DESCRIPTION
2026-01-11T19:28:13.4138565Z                              Prepends a timestamp and severity level, appends to the log file, and
2026-01-11T19:28:13.4139150Z                              writes to the console with a severity-based color.
2026-01-11T19:28:13.4139300Z                          .PARAMETER Message
2026-01-11T19:28:13.4139581Z                              Message text to record.
2026-01-11T19:28:13.4140031Z                          .PARAMETER Level
2026-01-11T19:28:13.4140820Z                              Severity label. Accepted values: INFO, SUCCESS, ERROR, WARNING.
2026-01-11T19:28:13.4141544Z                          .OUTPUTS
2026-01-11T19:28:13.4141920Z                              None.
2026-01-11T19:28:13.4143097Z                          #>
2026-01-11T19:28:13.4143205Z                      
2026-01-11T19:28:13.4144169Z                          [CmdletBinding()]
2026-01-11T19:28:13.4145291Z                          param(
2026-01-11T19:28:13.4145516Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.4146565Z                              [string]$Message,
2026-01-11T19:28:13.4146966Z                      
2026-01-11T19:28:13.4147797Z                              [Parameter(Mandatory=$false)]
2026-01-11T19:28:13.4148440Z                              [ValidateSet('INFO', 'SUCCESS', 'ERROR', 'WARNING')]
2026-01-11T19:28:13.4149388Z                              [string]$Level = "INFO"
2026-01-11T19:28:13.4149508Z                          )
2026-01-11T19:28:13.4150607Z                      
2026-01-11T19:28:13.4151581Z                          $timestamp = Get-Date -Format "yyyy-MM-dd HH:mm:ss"
2026-01-11T19:28:13.4152126Z                          $logMessage = "[$timestamp] [$Level] $Message"
2026-01-11T19:28:13.4152744Z                      
2026-01-11T19:28:13.4153547Z                          try {
2026-01-11T19:28:13.4154629Z                              Add-Content -Path $script:LogPath -Value $logMessage -ErrorAction Stop
2026-01-11T19:28:13.4154999Z                          } catch {
2026-01-11T19:28:13.4156717Z                              Write-Verbose "Unable to write to log file: $_"
2026-01-11T19:28:13.4157419Z                          }
2026-01-11T19:28:13.4158325Z                      
2026-01-11T19:28:13.4159189Z                          $color = switch ($Level) {
2026-01-11T19:28:13.4159993Z                              'SUCCESS' { 'Green' }
2026-01-11T19:28:13.4160401Z                              'ERROR' { 'Red' }
2026-01-11T19:28:13.4161447Z                              'WARNING' { 'Yellow' }
2026-01-11T19:28:13.4161600Z                              default { 'White' }
2026-01-11T19:28:13.4162659Z                          }
2026-01-11T19:28:13.4163481Z                      
2026-01-11T19:28:13.4164256Z                          Write-Host $logMessage -ForegroundColor $color
2026-01-11T19:28:13.4165361Z                      }
2026-01-11T19:28:13.4165469Z                      
2026-01-11T19:28:13.4166662Z                      function Write-LogSection {
2026-01-11T19:28:13.4166771Z                          <#
2026-01-11T19:28:13.4167831Z                          .SYNOPSIS
2026-01-11T19:28:13.4168082Z                              Writes a banner-style section header to the log.
2026-01-11T19:28:13.4169307Z                          .PARAMETER SectionName
2026-01-11T19:28:13.4169501Z                              Human-friendly section name to render.
2026-01-11T19:28:13.4170341Z                          .OUTPUTS
2026-01-11T19:28:13.4171186Z                              None.
2026-01-11T19:28:13.4172279Z                          #>
2026-01-11T19:28:13.4172454Z                      
2026-01-11T19:28:13.4173762Z                          [CmdletBinding()]
2026-01-11T19:28:13.4174827Z                          param(
2026-01-11T19:28:13.4175711Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.4176479Z                              [string]$SectionName
2026-01-11T19:28:13.4177210Z                          )
2026-01-11T19:28:13.4177983Z                      
2026-01-11T19:28:13.4179064Z                          Write-Log "============================================================" "INFO"
2026-01-11T19:28:13.4179529Z                          Write-Log "=== $SectionName ===" "INFO"
2026-01-11T19:28:13.4180114Z                          Write-Log "============================================================" "INFO"
2026-01-11T19:28:13.4180327Z                      }
2026-01-11T19:28:13.4181546Z                      
2026-01-11T19:28:13.4181719Z                      function Get-LogSummary {
2026-01-11T19:28:13.4182556Z                          <#
2026-01-11T19:28:13.4183286Z                          .SYNOPSIS
2026-01-11T19:28:13.4183505Z                              Summarizes log output for reporting.
2026-01-11T19:28:13.4184680Z                          .DESCRIPTION
2026-01-11T19:28:13.4185070Z                              Counts success/error/warning lines and returns a summary hashtable with
2026-01-11T19:28:13.4186201Z                              duration and log metadata. Returns zero counts if the log file is missing.
2026-01-11T19:28:13.4186514Z                          .OUTPUTS
2026-01-11T19:28:13.4187718Z                              [hashtable] Summary information including counts and duration.
2026-01-11T19:28:13.4188020Z                          #>
2026-01-11T19:28:13.4188758Z                      
2026-01-11T19:28:13.4189692Z                          [CmdletBinding()]
2026-01-11T19:28:13.4190507Z                          param()
2026-01-11T19:28:13.4191463Z                      
2026-01-11T19:28:13.4191657Z                          $duration = (Get-Date) - $script:StartTime
2026-01-11T19:28:13.4192978Z                      
2026-01-11T19:28:13.4193853Z                          if (-not (Test-Path $script:LogPath)) {
2026-01-11T19:28:13.4194087Z                              return @{
2026-01-11T19:28:13.4195308Z                                  Duration = $duration
2026-01-11T19:28:13.4195448Z                                  ErrorCount = 0
2026-01-11T19:28:13.4196969Z                                  SuccessCount = 0
2026-01-11T19:28:13.4197153Z                                  WarningCount = 0
2026-01-11T19:28:13.4198031Z                                  InfoCount = 0
2026-01-11T19:28:13.4198967Z                                  TotalLines = 0
2026-01-11T19:28:13.4199602Z                                  Error = 0
2026-01-11T19:28:13.4200706Z                                  Success = 0
2026-01-11T19:28:13.4200837Z                                  Warning = 0
2026-01-11T19:28:13.4201842Z                                  Info = 0
2026-01-11T19:28:13.4201979Z                              }
2026-01-11T19:28:13.4203313Z                          }
2026-01-11T19:28:13.4203421Z                      
2026-01-11T19:28:13.4204498Z                          $logContent = Get-Content $script:LogPath
2026-01-11T19:28:13.4204913Z                      
2026-01-11T19:28:13.4206005Z                          $errorCount = ($logContent | Select-String '\[ERROR\]').Count
2026-01-11T19:28:13.4206364Z                          $successCount = ($logContent | Select-String '\[SUCCESS\]').Count
2026-01-11T19:28:13.4206828Z                          $warningCount = ($logContent | Select-String '\[WARNING\]').Count
2026-01-11T19:28:13.4207396Z                          $infoCount = ($logContent | Select-String '\[INFO\]').Count
2026-01-11T19:28:13.4207694Z                      
2026-01-11T19:28:13.4208084Z                          return @{
2026-01-11T19:28:13.4208920Z                              Duration = $duration
2026-01-11T19:28:13.4209707Z                              ErrorCount = $errorCount
2026-01-11T19:28:13.4210137Z                              SuccessCount = $successCount
2026-01-11T19:28:13.4210910Z                              WarningCount = $warningCount
2026-01-11T19:28:13.4211391Z                              InfoCount = $infoCount
2026-01-11T19:28:13.4212133Z                              TotalLines = $logContent.Count
2026-01-11T19:28:13.4213401Z                              LogPath = $script:LogPath
2026-01-11T19:28:13.4213530Z                              Error = $errorCount
2026-01-11T19:28:13.4215085Z                              Success = $successCount
2026-01-11T19:28:13.4216100Z                              Warning = $warningCount
2026-01-11T19:28:13.4216252Z                              Info = $infoCount
2026-01-11T19:28:13.4217701Z                          }
2026-01-11T19:28:13.4217810Z                      }
2026-01-11T19:28:13.4218821Z                      
2026-01-11T19:28:13.4219682Z                      
2026-01-11T19:28:13.4220537Z                      Export-ModuleMember -Function @(
2026-01-11T19:28:13.4220916Z                          'Initialize-Logger',
2026-01-11T19:28:13.4221800Z                          'Write-Log',
2026-01-11T19:28:13.4222090Z                          'Write-LogSection',
2026-01-11T19:28:13.4223250Z                          'Get-LogSummary'
2026-01-11T19:28:13.4223603Z                      )
2026-01-11T19:28:13.4224885Z [32;1mCleanBlock         : [0m
2026-01-11T19:28:13.4225330Z [32;1mDynamicParamBlock  : [0m
2026-01-11T19:28:13.4225914Z [32;1mScriptRequirements : [0m
2026-01-11T19:28:13.4227609Z [32;1mExtent             : [0m
2026-01-11T19:28:13.4227718Z                      <#
2026-01-11T19:28:13.4228803Z                      .SYNOPSIS
2026-01-11T19:28:13.4229069Z                          Logging utilities for the Gaming PC Setup scripts.
2026-01-11T19:28:13.4230068Z                      .DESCRIPTION
2026-01-11T19:28:13.4231158Z                          Provides a small logging surface that writes to a shared log file and the
2026-01-11T19:28:13.4231805Z                          console, with severity coloring and a summary helper. Uses module-scoped
2026-01-11T19:28:13.4232054Z                          variables to store log path and start time.
2026-01-11T19:28:13.4232976Z                      .NOTES
2026-01-11T19:28:13.4234412Z                          Import this module before any other module that calls Write-Log.
2026-01-11T19:28:13.4234535Z                      #>
2026-01-11T19:28:13.4234918Z                      
2026-01-11T19:28:13.4236079Z                      # Module-scoped state for log file path and runtime duration tracking.
2026-01-11T19:28:13.4236548Z                      $script:LogPath = ".\gaming-pc-setup.log"
2026-01-11T19:28:13.4237708Z                      $script:StartTime = Get-Date
2026-01-11T19:28:13.4237814Z                      
2026-01-11T19:28:13.4238768Z                      
2026-01-11T19:28:13.4238943Z                      function Initialize-Logger {
2026-01-11T19:28:13.4240154Z                          <#
2026-01-11T19:28:13.4240274Z                          .SYNOPSIS
2026-01-11T19:28:13.4241540Z                              Initializes logging for the current run.
2026-01-11T19:28:13.4241669Z                          .DESCRIPTION
2026-01-11T19:28:13.4242945Z                              Sets the log path, records the start time, creates the log directory if
2026-01-11T19:28:13.4243245Z                              missing, optionally clears any existing log, and writes a header block.
2026-01-11T19:28:13.4244370Z                          .PARAMETER LogPath
2026-01-11T19:28:13.4244720Z                              Destination log file path. Defaults to ./gaming-pc-setup.log.
2026-01-11T19:28:13.4245155Z                          .PARAMETER ClearExisting
2026-01-11T19:28:13.4245886Z                              When true, removes the existing log file before writing new entries.
2026-01-11T19:28:13.4246755Z                          .OUTPUTS
2026-01-11T19:28:13.4246879Z                              None.
2026-01-11T19:28:13.4247710Z                          #>
2026-01-11T19:28:13.4248525Z                      
2026-01-11T19:28:13.4249429Z                          [CmdletBinding()]
2026-01-11T19:28:13.4250194Z                          param(
2026-01-11T19:28:13.4251210Z                              [string]$LogPath = ".\gaming-pc-setup.log",
2026-01-11T19:28:13.4251675Z                              [bool]$ClearExisting = $false
2026-01-11T19:28:13.4252473Z                          )
2026-01-11T19:28:13.4252589Z                      
2026-01-11T19:28:13.4253979Z                          $script:LogPath = $LogPath
2026-01-11T19:28:13.4254115Z                          $script:StartTime = Get-Date
2026-01-11T19:28:13.4255417Z                      
2026-01-11T19:28:13.4255652Z                          $logDir = Split-Path $LogPath -Parent
2026-01-11T19:28:13.4256308Z                          if ($logDir -and -not (Test-Path $logDir)) {
2026-01-11T19:28:13.4256588Z                              New-Item -ItemType Directory -Path $logDir -Force | Out-Null
2026-01-11T19:28:13.4257619Z                          }
2026-01-11T19:28:13.4258109Z                      
2026-01-11T19:28:13.4259057Z                          if ($ClearExisting -and (Test-Path $LogPath)) {
2026-01-11T19:28:13.4259454Z                              Remove-Item $LogPath -Force
2026-01-11T19:28:13.4260780Z                          }
2026-01-11T19:28:13.4260900Z                      
2026-01-11T19:28:13.4262115Z                          Write-Log "=== Gaming PC Setup - Log Started ===" "INFO"
2026-01-11T19:28:13.4262448Z                          Write-Log "Start Time: $(Get-Date -Format 'yyyy-MM-dd HH:mm:ss')" "INFO"
2026-01-11T19:28:13.4263771Z                          Write-Log "PowerShell Version: $($PSVersionTable.PSVersion)" "INFO"
2026-01-11T19:28:13.4264294Z                          Write-Log "Operating System: $([System.Environment]::OSVersion.VersionString)" "INFO"
2026-01-11T19:28:13.4264857Z                          Write-Log "Log Path: $LogPath" "INFO"
2026-01-11T19:28:13.4264992Z                      }
2026-01-11T19:28:13.4266033Z                      
2026-01-11T19:28:13.4266175Z                      function Write-Log {
2026-01-11T19:28:13.4267308Z                          <#
2026-01-11T19:28:13.4267432Z                          .SYNOPSIS
2026-01-11T19:28:13.4268678Z                              Writes a log line to file and console.
2026-01-11T19:28:13.4268803Z                          .DESCRIPTION
2026-01-11T19:28:13.4270213Z                              Prepends a timestamp and severity level, appends to the log file, and
2026-01-11T19:28:13.4270395Z                              writes to the console with a severity-based color.
2026-01-11T19:28:13.4271366Z                          .PARAMETER Message
2026-01-11T19:28:13.4271869Z                              Message text to record.
2026-01-11T19:28:13.4272865Z                          .PARAMETER Level
2026-01-11T19:28:13.4273203Z                              Severity label. Accepted values: INFO, SUCCESS, ERROR, WARNING.
2026-01-11T19:28:13.4274013Z                          .OUTPUTS
2026-01-11T19:28:13.4283670Z                              None.
2026-01-11T19:28:13.4283840Z                          #>
2026-01-11T19:28:13.4283930Z                      
2026-01-11T19:28:13.4284063Z                          [CmdletBinding()]
2026-01-11T19:28:13.4284158Z                          param(
2026-01-11T19:28:13.4284314Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.4284443Z                              [string]$Message,
2026-01-11T19:28:13.4284534Z                      
2026-01-11T19:28:13.4284690Z                              [Parameter(Mandatory=$false)]
2026-01-11T19:28:13.4284900Z                              [ValidateSet('INFO', 'SUCCESS', 'ERROR', 'WARNING')]
2026-01-11T19:28:13.4285036Z                              [string]$Level = "INFO"
2026-01-11T19:28:13.4285122Z                          )
2026-01-11T19:28:13.4285182Z                      
2026-01-11T19:28:13.4285432Z                          $timestamp = Get-Date -Format "yyyy-MM-dd HH:mm:ss"
2026-01-11T19:28:13.4285615Z                          $logMessage = "[$timestamp] [$Level] $Message"
2026-01-11T19:28:13.4285691Z                      
2026-01-11T19:28:13.4285766Z                          try {
2026-01-11T19:28:13.4286071Z                              Add-Content -Path $script:LogPath -Value $logMessage -ErrorAction Stop
2026-01-11T19:28:13.4286158Z                          } catch {
2026-01-11T19:28:13.4286358Z                              Write-Verbose "Unable to write to log file: $_"
2026-01-11T19:28:13.4286484Z                          }
2026-01-11T19:28:13.4287676Z                      
2026-01-11T19:28:13.4288242Z                          $color = switch ($Level) {
2026-01-11T19:28:13.4288389Z                              'SUCCESS' { 'Green' }
2026-01-11T19:28:13.4289456Z                              'ERROR' { 'Red' }
2026-01-11T19:28:13.4290349Z                              'WARNING' { 'Yellow' }
2026-01-11T19:28:13.4291140Z                              default { 'White' }
2026-01-11T19:28:13.4291532Z                          }
2026-01-11T19:28:13.4292540Z                      
2026-01-11T19:28:13.4293077Z                          Write-Host $logMessage -ForegroundColor $color
2026-01-11T19:28:13.4293838Z                      }
2026-01-11T19:28:13.4294074Z                      
2026-01-11T19:28:13.4295536Z                      function Write-LogSection {
2026-01-11T19:28:13.4295982Z                          <#
2026-01-11T19:28:13.4296922Z                          .SYNOPSIS
2026-01-11T19:28:13.4297562Z                              Writes a banner-style section header to the log.
2026-01-11T19:28:13.4298483Z                          .PARAMETER SectionName
2026-01-11T19:28:13.4299449Z                              Human-friendly section name to render.
2026-01-11T19:28:13.4300153Z                          .OUTPUTS
2026-01-11T19:28:13.4301147Z                              None.
2026-01-11T19:28:13.4302032Z                          #>
2026-01-11T19:28:13.4302147Z                      
2026-01-11T19:28:13.4303384Z                          [CmdletBinding()]
2026-01-11T19:28:13.4303503Z                          param(
2026-01-11T19:28:13.4304695Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.4304849Z                              [string]$SectionName
2026-01-11T19:28:13.4305939Z                          )
2026-01-11T19:28:13.4306378Z                      
2026-01-11T19:28:13.4307524Z                          Write-Log "============================================================" "INFO"
2026-01-11T19:28:13.4307935Z                          Write-Log "=== $SectionName ===" "INFO"
2026-01-11T19:28:13.4308540Z                          Write-Log "============================================================" "INFO"
2026-01-11T19:28:13.4308870Z                      }
2026-01-11T19:28:13.4309933Z                      
2026-01-11T19:28:13.4310100Z                      function Get-LogSummary {
2026-01-11T19:28:13.4311261Z                          <#
2026-01-11T19:28:13.4311995Z                          .SYNOPSIS
2026-01-11T19:28:13.4312869Z                              Summarizes log output for reporting.
2026-01-11T19:28:13.4313609Z                          .DESCRIPTION
2026-01-11T19:28:13.4314476Z                              Counts success/error/warning lines and returns a summary hashtable with
2026-01-11T19:28:13.4315586Z                              duration and log metadata. Returns zero counts if the log file is missing.
2026-01-11T19:28:13.4315693Z                          .OUTPUTS
2026-01-11T19:28:13.4316845Z                              [hashtable] Summary information including counts and duration.
2026-01-11T19:28:13.4317219Z                          #>
2026-01-11T19:28:13.4317831Z                      
2026-01-11T19:28:13.4318942Z                          [CmdletBinding()]
2026-01-11T19:28:13.4319206Z                          param()
2026-01-11T19:28:13.4320415Z                      
2026-01-11T19:28:13.4320656Z                          $duration = (Get-Date) - $script:StartTime
2026-01-11T19:28:13.4321489Z                      
2026-01-11T19:28:13.4322034Z                          if (-not (Test-Path $script:LogPath)) {
2026-01-11T19:28:13.4322337Z                              return @{
2026-01-11T19:28:13.4323578Z                                  Duration = $duration
2026-01-11T19:28:13.4323718Z                                  ErrorCount = 0
2026-01-11T19:28:13.4324741Z                                  SuccessCount = 0
2026-01-11T19:28:13.4324881Z                                  WarningCount = 0
2026-01-11T19:28:13.4326440Z                                  InfoCount = 0
2026-01-11T19:28:13.4326610Z                                  TotalLines = 0
2026-01-11T19:28:13.4327041Z                                  Error = 0
2026-01-11T19:28:13.4327540Z                                  Success = 0
2026-01-11T19:28:13.4328820Z                                  Warning = 0
2026-01-11T19:28:13.4328940Z                                  Info = 0
2026-01-11T19:28:13.4329937Z                              }
2026-01-11T19:28:13.4330275Z                          }
2026-01-11T19:28:13.4331207Z                      
2026-01-11T19:28:13.4332892Z                          $logContent = Get-Content $script:LogPath
2026-01-11T19:28:13.4333003Z                      
2026-01-11T19:28:13.4333774Z                          $errorCount = ($logContent | Select-String '\[ERROR\]').Count
2026-01-11T19:28:13.4334064Z                          $successCount = ($logContent | Select-String '\[SUCCESS\]').Count
2026-01-11T19:28:13.4334561Z                          $warningCount = ($logContent | Select-String '\[WARNING\]').Count
2026-01-11T19:28:13.4335081Z                          $infoCount = ($logContent | Select-String '\[INFO\]').Count
2026-01-11T19:28:13.4335746Z                      
2026-01-11T19:28:13.4336780Z                          return @{
2026-01-11T19:28:13.4337351Z                              Duration = $duration
2026-01-11T19:28:13.4338402Z                              ErrorCount = $errorCount
2026-01-11T19:28:13.4339226Z                              SuccessCount = $successCount
2026-01-11T19:28:13.4340181Z                              WarningCount = $warningCount
2026-01-11T19:28:13.4340713Z                              InfoCount = $infoCount
2026-01-11T19:28:13.4341723Z                              TotalLines = $logContent.Count
2026-01-11T19:28:13.4342178Z                              LogPath = $script:LogPath
2026-01-11T19:28:13.4343139Z                              Error = $errorCount
2026-01-11T19:28:13.4343281Z                              Success = $successCount
2026-01-11T19:28:13.4344727Z                              Warning = $warningCount
2026-01-11T19:28:13.4345209Z                              Info = $infoCount
2026-01-11T19:28:13.4346011Z                          }
2026-01-11T19:28:13.4346836Z                      }
2026-01-11T19:28:13.4347980Z                      
2026-01-11T19:28:13.4348100Z                      
2026-01-11T19:28:13.4349106Z                      Export-ModuleMember -Function @(
2026-01-11T19:28:13.4349280Z                          'Initialize-Logger',
2026-01-11T19:28:13.4350434Z                          'Write-Log',
2026-01-11T19:28:13.4350577Z                          'Write-LogSection',
2026-01-11T19:28:13.4351643Z                          'Get-LogSummary'
2026-01-11T19:28:13.4352007Z                      )
2026-01-11T19:28:13.4353373Z                      
2026-01-11T19:28:13.4353779Z [32;1mParent             : [0m
2026-01-11T19:28:13.4353814Z 
2026-01-11T19:28:13.4386662Z [32;1mAttributes         : [0m{}
2026-01-11T19:28:13.4386843Z [32;1mUsingStatements    : [0m{}
2026-01-11T19:28:13.4387250Z [32;1mParamBlock         : [0m
2026-01-11T19:28:13.4388386Z [32;1mBeginBlock         : [0m
2026-01-11T19:28:13.4388722Z [32;1mProcessBlock       : [0m
2026-01-11T19:28:13.4391425Z [32;1mEndBlock           : [0mfunction Show-Menu {
2026-01-11T19:28:13.4391532Z                          <#
2026-01-11T19:28:13.4392487Z                          .SYNOPSIS
2026-01-11T19:28:13.4393103Z                              Renders an interactive checkbox-style menu.
2026-01-11T19:28:13.4394359Z                          .DESCRIPTION
2026-01-11T19:28:13.4395098Z                              Displays options with selection markers and optional descriptions. Users
2026-01-11T19:28:13.4395743Z                              can toggle items by number, select all/none/recommended, and press Enter
2026-01-11T19:28:13.4396274Z                              to accept the current selection.
2026-01-11T19:28:13.4396410Z                      
2026-01-11T19:28:13.4397496Z                              AUTOMATION MODE
2026-01-11T19:28:13.4397628Z                              ===============
2026-01-11T19:28:13.4399092Z                              When the environment variable ROCKTUNE_MENU_MODE is set, this function
2026-01-11T19:28:13.4399527Z                              bypasses the interactive loop and applies the specified selection mode:
2026-01-11T19:28:13.4399913Z                      
2026-01-11T19:28:13.4401041Z                              - "all"         : Selects ALL non-disabled items (equivalent to pressing 'A')
2026-01-11T19:28:13.4402151Z                              - "none"        : Deselects ALL items (equivalent to pressing 'N')
2026-01-11T19:28:13.4402492Z                              - "recommended" : Selects items marked with [*] icon (equivalent to pressing 'R')
2026-01-11T19:28:13.4403077Z                              - "default"     : Keeps the initial selection state (equivalent to pressing Enter)
2026-01-11T19:28:13.4403232Z                      
2026-01-11T19:28:13.4404203Z                              This is useful for:
2026-01-11T19:28:13.4404809Z                              - CI/CD pipelines where no human is present to interact
2026-01-11T19:28:13.4405346Z                              - Automated testing that needs deterministic behavior
2026-01-11T19:28:13.4406434Z                              - Scripted deployments with pre-determined configurations
2026-01-11T19:28:13.4406721Z                              - Remote execution where interactive prompts would hang
2026-01-11T19:28:13.4406862Z                      
2026-01-11T19:28:13.4407882Z                              Example:
2026-01-11T19:28:13.4408067Z                                  $env:ROCKTUNE_MENU_MODE = "all"
2026-01-11T19:28:13.4409211Z                                  $selected = Show-Menu -Title "Options" -Options $opts
2026-01-11T19:28:13.4409746Z                                  # Returns all non-disabled indices without prompting
2026-01-11T19:28:13.4410020Z                      
2026-01-11T19:28:13.4410807Z                          .PARAMETER Title
2026-01-11T19:28:13.4411622Z                              Menu title displayed at the top.
2026-01-11T19:28:13.4412901Z                          .PARAMETER Options
2026-01-11T19:28:13.4413215Z                              Array of hashtables with keys: Label, Selected, Description, Icon, Disabled.
2026-01-11T19:28:13.4413684Z                          .PARAMETER Legend
2026-01-11T19:28:13.4414794Z                              Optional legend text shown under the list.
2026-01-11T19:28:13.4415275Z                          .PARAMETER AllowMultiple
2026-01-11T19:28:13.4415673Z                              Indicates whether multi-select is allowed (kept for future extensibility).
2026-01-11T19:28:13.4416579Z                          .OUTPUTS
2026-01-11T19:28:13.4417511Z                              [int[]] Indices of selected items.
2026-01-11T19:28:13.4417648Z                          #>
2026-01-11T19:28:13.4419040Z                      
2026-01-11T19:28:13.4419533Z                          [CmdletBinding()]
2026-01-11T19:28:13.4420482Z                          param(
2026-01-11T19:28:13.4421162Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.4422206Z                              [string]$Title,
2026-01-11T19:28:13.4422311Z                      
2026-01-11T19:28:13.4423590Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.4424070Z                              [array]$Options,
2026-01-11T19:28:13.4424493Z                      
2026-01-11T19:28:13.4424884Z                              [string]$Legend = "",
2026-01-11T19:28:13.4426156Z                      
2026-01-11T19:28:13.4426333Z                              [bool]$AllowMultiple = $true
2026-01-11T19:28:13.4427157Z                          )
2026-01-11T19:28:13.4428003Z                      
2026-01-11T19:28:13.4428453Z                          $selectedIndices = @()
2026-01-11T19:28:13.4429150Z                      
2026-01-11T19:28:13.4430289Z                          # -------------------------------------------------------------------------
2026-01-11T19:28:13.4430466Z                          # AUTOMATION MODE CHECK
2026-01-11T19:28:13.4431569Z                          # -------------------------------------------------------------------------
2026-01-11T19:28:13.4432165Z                          # Check if the ROCKTUNE_MENU_MODE environment variable is set. If so, we
2026-01-11T19:28:13.4432671Z                          # bypass the interactive do/while loop entirely and apply the selection
2026-01-11T19:28:13.4434210Z                          # mode directly. This enables fully unattended script execution.
2026-01-11T19:28:13.4434333Z                          #
2026-01-11T19:28:13.4434507Z                          # Why check before the loop?
2026-01-11T19:28:13.4435600Z                          # - Avoids any Clear-Host or Write-Host that would clutter CI logs
2026-01-11T19:28:13.4436413Z                          # - Returns immediately for faster automated execution
2026-01-11T19:28:13.4436981Z                          # - Deterministic behavior - no timing or race condition concerns
2026-01-11T19:28:13.4437753Z                          #
2026-01-11T19:28:13.4438998Z                          # The env var is read fresh each time Show-Menu is called, so you can
2026-01-11T19:28:13.4439698Z                          # potentially change it between menus in a complex orchestration scenario
2026-01-11T19:28:13.4440261Z                          # (though this is uncommon - typically set once at the start).
2026-01-11T19:28:13.4440785Z                          # -------------------------------------------------------------------------
2026-01-11T19:28:13.4441926Z                          $menuMode = $env:ROCKTUNE_MENU_MODE
2026-01-11T19:28:13.4442064Z                          if ($menuMode) {
2026-01-11T19:28:13.4443319Z                              # Normalize to lowercase for case-insensitive comparison
2026-01-11T19:28:13.4443493Z                              $menuMode = $menuMode.ToLower()
2026-01-11T19:28:13.4443850Z                      
2026-01-11T19:28:13.4444854Z                              switch ($menuMode) {
2026-01-11T19:28:13.4445293Z                                  'all' {
2026-01-11T19:28:13.4446165Z                                      # Select ALL non-disabled items
2026-01-11T19:28:13.4446924Z                                      # This mirrors pressing 'A' in the interactive menu
2026-01-11T19:28:13.4447110Z                                      for ($i = 0; $i -lt $Options.Count; $i++) {
2026-01-11T19:28:13.4448141Z                                          if (-not $Options[$i].Disabled) {
2026-01-11T19:28:13.4448720Z                                              $Options[$i].Selected = $true
2026-01-11T19:28:13.4449560Z                                          }
2026-01-11T19:28:13.4450101Z                                      }
2026-01-11T19:28:13.4451597Z                                      Write-Host "[AUTO] Menu '$Title': Selected ALL items (ROCKTUNE_MENU_MODE=all)" 
2026-01-11T19:28:13.4451733Z                      -ForegroundColor Cyan
2026-01-11T19:28:13.4452143Z                                  }
2026-01-11T19:28:13.4453492Z                                  'none' {
2026-01-11T19:28:13.4453674Z                                      # Deselect ALL items
2026-01-11T19:28:13.4454865Z                                      # This mirrors pressing 'N' in the interactive menu
2026-01-11T19:28:13.4455111Z                                      for ($i = 0; $i -lt $Options.Count; $i++) {
2026-01-11T19:28:13.4456309Z                                          $Options[$i].Selected = $false
2026-01-11T19:28:13.4456803Z                                      }
2026-01-11T19:28:13.4458187Z                                      Write-Host "[AUTO] Menu '$Title': Selected NONE (ROCKTUNE_MENU_MODE=none)" 
2026-01-11T19:28:13.4458297Z                      -ForegroundColor Cyan
2026-01-11T19:28:13.4458738Z                                  }
2026-01-11T19:28:13.4459958Z                                  'recommended' {
2026-01-11T19:28:13.4460275Z                                      # Select only items marked as recommended (icon = "[*]")
2026-01-11T19:28:13.4461373Z                                      # This mirrors pressing 'R' in the interactive menu
2026-01-11T19:28:13.4461861Z                                      for ($i = 0; $i -lt $Options.Count; $i++) {
2026-01-11T19:28:13.4462908Z                                          $Options[$i].Selected = ($Options[$i].Icon -eq "[*]")
2026-01-11T19:28:13.4463388Z                                      }
2026-01-11T19:28:13.4464397Z                                      Write-Host "[AUTO] Menu '$Title': Selected RECOMMENDED items 
2026-01-11T19:28:13.4464698Z                      (ROCKTUNE_MENU_MODE=recommended)" -ForegroundColor Cyan
2026-01-11T19:28:13.4465012Z                                  }
2026-01-11T19:28:13.4466221Z                                  'default' {
2026-01-11T19:28:13.4466475Z                                      # Keep initial selection state - just proceed
2026-01-11T19:28:13.4467741Z                                      # This mirrors pressing Enter immediately in the interactive menu
2026-01-11T19:28:13.4468301Z                                      Write-Host "[AUTO] Menu '$Title': Using DEFAULT selections 
2026-01-11T19:28:13.4469373Z                      (ROCKTUNE_MENU_MODE=default)" -ForegroundColor Cyan
2026-01-11T19:28:13.4470262Z                                  }
2026-01-11T19:28:13.4470489Z                                  default {
2026-01-11T19:28:13.4471774Z                                      # Unrecognized mode - warn and fall through to interactive
2026-01-11T19:28:13.4472217Z                                      Write-Host "[WARN] Unknown ROCKTUNE_MENU_MODE='$menuMode'. Valid: all, none, 
2026-01-11T19:28:13.4472473Z                      recommended, default" -ForegroundColor Yellow
2026-01-11T19:28:13.4473286Z                                      Write-Host "[WARN] Falling back to interactive mode." -ForegroundColor Yellow
2026-01-11T19:28:13.4474612Z                                      $menuMode = $null  # Clear so we enter the interactive loop
2026-01-11T19:28:13.4474728Z                                  }
2026-01-11T19:28:13.4475951Z                              }
2026-01-11T19:28:13.4476080Z                      
2026-01-11T19:28:13.4476889Z                              # If we successfully processed an automation mode, return immediately
2026-01-11T19:28:13.4477868Z                              if ($menuMode) {
2026-01-11T19:28:13.4478038Z                                  $selectedIndices = @()
2026-01-11T19:28:13.4478937Z                                  for ($i = 0; $i -lt $Options.Count; $i++) {
2026-01-11T19:28:13.4479739Z                                      if ($Options[$i].Selected) {
2026-01-11T19:28:13.4480526Z                                          $selectedIndices += $i
2026-01-11T19:28:13.4481412Z                                      }
2026-01-11T19:28:13.4481978Z                                  }
2026-01-11T19:28:13.4482165Z                                  return $selectedIndices
2026-01-11T19:28:13.4483246Z                              }
2026-01-11T19:28:13.4483547Z                          }
2026-01-11T19:28:13.4484725Z                      
2026-01-11T19:28:13.4485690Z                          # -------------------------------------------------------------------------
2026-01-11T19:28:13.4486171Z                          # INTERACTIVE MODE
2026-01-11T19:28:13.4487222Z                          # -------------------------------------------------------------------------
2026-01-11T19:28:13.4487467Z                          # If ROCKTUNE_MENU_MODE is not set (or was invalid), we fall through to
2026-01-11T19:28:13.4488798Z                          # the standard interactive menu loop. This is the default behavior.
2026-01-11T19:28:13.4489105Z                          # -------------------------------------------------------------------------
2026-01-11T19:28:13.4489248Z                      
2026-01-11T19:28:13.4490038Z                          do {
2026-01-11T19:28:13.4490178Z                              Clear-Host
2026-01-11T19:28:13.4491712Z                      
2026-01-11T19:28:13.4493286Z                              Write-Host "??????????????????????????????????????????????????????????????????????????????
2026-01-11T19:28:13.4493590Z                      ??????????????????????????????????????????????????????????????????????????????????????????????????
2026-01-11T19:28:13.4493840Z                      ?????????????" -ForegroundColor Cyan
2026-01-11T19:28:13.4495074Z                              Write-Host "    $Title" -ForegroundColor Cyan
2026-01-11T19:28:13.4496138Z                              Write-Host "??????????????????????????????????????????????????????????????????????????????
2026-01-11T19:28:13.4496443Z                      ??????????????????????????????????????????????????????????????????????????????????????????????????
2026-01-11T19:28:13.4497839Z                      ?????????????" -ForegroundColor Cyan
2026-01-11T19:28:13.4497931Z                              Write-Host ""
2026-01-11T19:28:13.4498056Z                      
2026-01-11T19:28:13.4498278Z                              for ($i = 0; $i -lt $Options.Count; $i++) {
2026-01-11T19:28:13.4498722Z                                  $option = $Options[$i]
2026-01-11T19:28:13.4499840Z                                  $index = $i + 1
2026-01-11T19:28:13.4500077Z                      
2026-01-11T19:28:13.4501022Z                                  $checkbox = if ($option.Selected) { "X" } else { " " }
2026-01-11T19:28:13.4502143Z                      
2026-01-11T19:28:13.4502461Z                                  $icon = if ($option.Icon) { " $($option.Icon)" } else { "" }
2026-01-11T19:28:13.4503183Z                      
2026-01-11T19:28:13.4503965Z                                  $color = "White"
2026-01-11T19:28:13.4504905Z                                  if ($option.Disabled) {
2026-01-11T19:28:13.4505704Z                                      $color = "DarkGray"
2026-01-11T19:28:13.4506163Z                                  } elseif ($option.Icon -eq "[*]") {
2026-01-11T19:28:13.4506678Z                                      $color = "Green"
2026-01-11T19:28:13.4507570Z                                  } elseif ($option.Icon -eq "[!]") {
2026-01-11T19:28:13.4507741Z                                      $color = "Yellow"
2026-01-11T19:28:13.4508922Z                                  } elseif ($option.Icon -eq "[i]") {
2026-01-11T19:28:13.4509067Z                                      $color = "Cyan"
2026-01-11T19:28:13.4510095Z                                  }
2026-01-11T19:28:13.4510202Z                      
2026-01-11T19:28:13.4511690Z                                  $line = " [$checkbox] $index. $($option.Label)$icon"
2026-01-11T19:28:13.4511936Z                                  Write-Host $line -ForegroundColor $color
2026-01-11T19:28:13.4512425Z                      
2026-01-11T19:28:13.4513442Z                                  if ($option.Description) {
2026-01-11T19:28:13.4513803Z                                      Write-Host "      $($option.Description)" -ForegroundColor DarkGray
2026-01-11T19:28:13.4514040Z                                  }
2026-01-11T19:28:13.4514946Z                              }
2026-01-11T19:28:13.4516109Z                      
2026-01-11T19:28:13.4516245Z                              if ($Legend) {
2026-01-11T19:28:13.4517148Z                                  Write-Host ""
2026-01-11T19:28:13.4518062Z                                  Write-Host "Legend: $Legend" -ForegroundColor DarkGray
2026-01-11T19:28:13.4518526Z                              }
2026-01-11T19:28:13.4519348Z                      
2026-01-11T19:28:13.4520343Z                              Write-Host ""
2026-01-11T19:28:13.4521507Z                              Write-Host "Toggle with numbers, 'A' for all, 'N' for none, 'R' for recommended, Enter to 
2026-01-11T19:28:13.4521732Z                      continue" -ForegroundColor Yellow
2026-01-11T19:28:13.4522882Z                      
2026-01-11T19:28:13.4523073Z                              $choice = Read-Host "Your choice"
2026-01-11T19:28:13.4524065Z                      
2026-01-11T19:28:13.4524884Z                              if ($choice -match '^\d+$') {
2026-01-11T19:28:13.4525891Z                                  $idx = [int]$choice - 1
2026-01-11T19:28:13.4526288Z                                  if ($idx -ge 0 -and $idx -lt $Options.Count -and -not $Options[$idx].Disabled) {
2026-01-11T19:28:13.4526690Z                                      $Options[$idx].Selected = -not $Options[$idx].Selected
2026-01-11T19:28:13.4526905Z                                  }
2026-01-11T19:28:13.4527997Z                              }
2026-01-11T19:28:13.4528220Z                              elseif ($choice -eq 'A' -or $choice -eq 'a') {
2026-01-11T19:28:13.4528957Z                                  for ($i = 0; $i -lt $Options.Count; $i++) {
2026-01-11T19:28:13.4529371Z                                      if (-not $Options[$i].Disabled) {
2026-01-11T19:28:13.4529668Z                                          $Options[$i].Selected = $true
2026-01-11T19:28:13.4529962Z                                      }
2026-01-11T19:28:13.4530956Z                                  }
2026-01-11T19:28:13.4531123Z                              }
2026-01-11T19:28:13.4532786Z                              elseif ($choice -eq 'N' -or $choice -eq 'n') {
2026-01-11T19:28:13.4533001Z                                  for ($i = 0; $i -lt $Options.Count; $i++) {
2026-01-11T19:28:13.4533394Z                                      $Options[$i].Selected = $false
2026-01-11T19:28:13.4534191Z                                  }
2026-01-11T19:28:13.4534302Z                              }
2026-01-11T19:28:13.4535624Z                              elseif ($choice -eq 'R' -or $choice -eq 'r') {
2026-01-11T19:28:13.4536085Z                                  for ($i = 0; $i -lt $Options.Count; $i++) {
2026-01-11T19:28:13.4537425Z                                      $Options[$i].Selected = ($Options[$i].Icon -eq "[*]")
2026-01-11T19:28:13.4537546Z                                  }
2026-01-11T19:28:13.4538159Z                              }
2026-01-11T19:28:13.4538570Z                              elseif ($choice -eq '') {
2026-01-11T19:28:13.4539681Z                                  break
2026-01-11T19:28:13.4539791Z                              }
2026-01-11T19:28:13.4540727Z                      
2026-01-11T19:28:13.4541526Z                          } while ($true)
2026-01-11T19:28:13.4541712Z                      
2026-01-11T19:28:13.4542933Z                          $selectedIndices = @()
2026-01-11T19:28:13.4543490Z                          for ($i = 0; $i -lt $Options.Count; $i++) {
2026-01-11T19:28:13.4543636Z                              if ($Options[$i].Selected) {
2026-01-11T19:28:13.4545245Z                                  $selectedIndices += $i
2026-01-11T19:28:13.4545564Z                              }
2026-01-11T19:28:13.4545870Z                          }
2026-01-11T19:28:13.4546332Z                      
2026-01-11T19:28:13.4547280Z                          return $selectedIndices
2026-01-11T19:28:13.4548392Z                      }
2026-01-11T19:28:13.4548496Z                      
2026-01-11T19:28:13.4549543Z                      function Show-CategoryMenu {
2026-01-11T19:28:13.4549662Z                          <#
2026-01-11T19:28:13.4550923Z                          .SYNOPSIS
2026-01-11T19:28:13.4551345Z                              Presents a category selection menu.
2026-01-11T19:28:13.4551804Z                          .DESCRIPTION
2026-01-11T19:28:13.4554644Z                              Converts category metadata into menu options and returns the selected
2026-01-11T19:28:13.4554919Z                              category keys in the original hash order.
2026-01-11T19:28:13.4555058Z                          .PARAMETER Categories
2026-01-11T19:28:13.4555406Z                              Hashtable of category definitions with Icon/ItemCount/Recommended metadata.
2026-01-11T19:28:13.4555563Z                          .OUTPUTS
2026-01-11T19:28:13.4556667Z                              [string[]] Selected category keys.
2026-01-11T19:28:13.4556819Z                          #>
2026-01-11T19:28:13.4557976Z                      
2026-01-11T19:28:13.4558767Z                          [CmdletBinding()]
2026-01-11T19:28:13.4559575Z                          param(
2026-01-11T19:28:13.4559749Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.4560958Z                              [hashtable]$Categories
2026-01-11T19:28:13.4561072Z                          )
2026-01-11T19:28:13.4562246Z                      
2026-01-11T19:28:13.4562379Z                          $options = @()
2026-01-11T19:28:13.4563795Z                          $index = 0
2026-01-11T19:28:13.4564204Z                          foreach ($key in $Categories.Keys) {
2026-01-11T19:28:13.4565326Z                              $cat = $Categories[$key]
2026-01-11T19:28:13.4566085Z                              $options += @{
2026-01-11T19:28:13.4566543Z                                  Label = "$($cat.Icon) $key"
2026-01-11T19:28:13.4567460Z                                  Selected = $true
2026-01-11T19:28:13.4568197Z                                  Description = "$($cat.ItemCount) items ($($cat.Recommended) recommended)"
2026-01-11T19:28:13.4568335Z                                  Icon = ""
2026-01-11T19:28:13.4569378Z                              }
2026-01-11T19:28:13.4569854Z                              $index++
2026-01-11T19:28:13.4570478Z                          }
2026-01-11T19:28:13.4571453Z                      
2026-01-11T19:28:13.4572357Z                          $selectedIndices = Show-Menu -Title "SELECT CATEGORIES" -Options $options -AllowMultiple $true
2026-01-11T19:28:13.4572741Z                      
2026-01-11T19:28:13.4573806Z                          $categoryKeys = @($Categories.Keys)
2026-01-11T19:28:13.4574261Z                          $selectedCategories = @()
2026-01-11T19:28:13.4574643Z                          foreach ($idx in $selectedIndices) {
2026-01-11T19:28:13.4575702Z                              $selectedCategories += $categoryKeys[$idx]
2026-01-11T19:28:13.4576082Z                          }
2026-01-11T19:28:13.4576961Z                      
2026-01-11T19:28:13.4577462Z                          return $selectedCategories
2026-01-11T19:28:13.4578278Z                      }
2026-01-11T19:28:13.4579092Z                      
2026-01-11T19:28:13.4579397Z                      function Get-UserChoice {
2026-01-11T19:28:13.4579970Z                          <#
2026-01-11T19:28:13.4581054Z                          .SYNOPSIS
2026-01-11T19:28:13.4581256Z                              Prompts for a single validated choice.
2026-01-11T19:28:13.4581995Z                          .DESCRIPTION
2026-01-11T19:28:13.4583268Z                              Loops until the user enters one of the allowed choices, optionally
2026-01-11T19:28:13.4583432Z                              accepting a default when Enter is pressed.
2026-01-11T19:28:13.4584457Z                          .PARAMETER Prompt
2026-01-11T19:28:13.4584997Z                              Prompt text shown to the user.
2026-01-11T19:28:13.4585697Z                          .PARAMETER ValidChoices
2026-01-11T19:28:13.4586674Z                              Array of allowed choices (strings).
2026-01-11T19:28:13.4587039Z                          .PARAMETER DefaultChoice
2026-01-11T19:28:13.4588128Z                              Optional default choice when user presses Enter.
2026-01-11T19:28:13.4588700Z                          .OUTPUTS
2026-01-11T19:28:13.4588964Z                              [string] Selected choice.
2026-01-11T19:28:13.4589978Z                          #>
2026-01-11T19:28:13.4590613Z                      
2026-01-11T19:28:13.4591718Z                          [CmdletBinding()]
2026-01-11T19:28:13.4592797Z                          param(
2026-01-11T19:28:13.4592962Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.4593742Z                              [string]$Prompt,
2026-01-11T19:28:13.4593851Z                      
2026-01-11T19:28:13.4594671Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.4595053Z                              [array]$ValidChoices,
2026-01-11T19:28:13.4596060Z                      
2026-01-11T19:28:13.4597149Z                              [string]$DefaultChoice = ""
2026-01-11T19:28:13.4598393Z                          )
2026-01-11T19:28:13.4598493Z                      
2026-01-11T19:28:13.4599191Z                          do {
2026-01-11T19:28:13.4599680Z                              $validString = $ValidChoices -join '/'
2026-01-11T19:28:13.4600440Z                              if ($DefaultChoice) {
2026-01-11T19:28:13.4602018Z                                  $fullPrompt = "$Prompt [$validString, default=$DefaultChoice]"
2026-01-11T19:28:13.4602148Z                              } else {
2026-01-11T19:28:13.4602552Z                                  $fullPrompt = "$Prompt [$validString]"
2026-01-11T19:28:13.4603311Z                              }
2026-01-11T19:28:13.4603478Z                      
2026-01-11T19:28:13.4604114Z                              $choice = Read-Host $fullPrompt
2026-01-11T19:28:13.4604471Z                      
2026-01-11T19:28:13.4606608Z                              if ($choice -eq '' -and $DefaultChoice) {
2026-01-11T19:28:13.4606825Z                                  $choice = $DefaultChoice
2026-01-11T19:28:13.4607815Z                              }
2026-01-11T19:28:13.4607924Z                      
2026-01-11T19:28:13.4608857Z                              if ($ValidChoices -contains $choice) {
2026-01-11T19:28:13.4609000Z                                  return $choice
2026-01-11T19:28:13.4610125Z                              }
2026-01-11T19:28:13.4610226Z                      
2026-01-11T19:28:13.4611840Z                              Write-Host "Invalid choice. Please select from: $validString" -ForegroundColor Red
2026-01-11T19:28:13.4611981Z                      
2026-01-11T19:28:13.4613202Z                          } while ($true)
2026-01-11T19:28:13.4613289Z                      }
2026-01-11T19:28:13.4614446Z                      
2026-01-11T19:28:13.4614601Z                      function Show-Summary {
2026-01-11T19:28:13.4615904Z                          <#
2026-01-11T19:28:13.4616022Z                          .SYNOPSIS
2026-01-11T19:28:13.4617123Z                              Displays a configuration summary.
2026-01-11T19:28:13.4617256Z                          .DESCRIPTION
2026-01-11T19:28:13.4618534Z                              Prints a categorized view of the selected configuration with simple
2026-01-11T19:28:13.4618758Z                              YES/NO mapping for boolean values.
2026-01-11T19:28:13.4619516Z                          .PARAMETER Title
2026-01-11T19:28:13.4620301Z                              Summary header text.
2026-01-11T19:28:13.4621176Z                          .PARAMETER Config
2026-01-11T19:28:13.4622003Z                              Hashtable of configuration values to display.
2026-01-11T19:28:13.4622670Z                          .OUTPUTS
2026-01-11T19:28:13.4623660Z                              None.
2026-01-11T19:28:13.4625241Z                          #>
2026-01-11T19:28:13.4625416Z                      
2026-01-11T19:28:13.4626316Z                          [CmdletBinding()]
2026-01-11T19:28:13.4626421Z                          param(
2026-01-11T19:28:13.4627679Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.4628654Z                              [string]$Title,
2026-01-11T19:28:13.4629259Z                      
2026-01-11T19:28:13.4630063Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.4630725Z                              [hashtable]$Config
2026-01-11T19:28:13.4631430Z                          )
2026-01-11T19:28:13.4632405Z                      
2026-01-11T19:28:13.4633077Z                          Clear-Host
2026-01-11T19:28:13.4635121Z                          Write-Host "??????????????????????????????????????????????????????????????????????????????????
2026-01-11T19:28:13.4635736Z                      ??????????????????????????????????????????????????????????????????????????????????????????????????
2026-01-11T19:28:13.4636462Z                      ?????????" -ForegroundColor Cyan
2026-01-11T19:28:13.4637603Z                          Write-Host "    $Title" -ForegroundColor Cyan
2026-01-11T19:28:13.4639158Z                          Write-Host "??????????????????????????????????????????????????????????????????????????????????
2026-01-11T19:28:13.4639673Z                      ??????????????????????????????????????????????????????????????????????????????????????????????????
2026-01-11T19:28:13.4640047Z                      ?????????" -ForegroundColor Cyan
2026-01-11T19:28:13.4640355Z                          Write-Host ""
2026-01-11T19:28:13.4641216Z                      
2026-01-11T19:28:13.4641678Z                          foreach ($category in $Config.Keys | Sort-Object) {
2026-01-11T19:28:13.4642134Z                              Write-Host "${category}:" -ForegroundColor Yellow
2026-01-11T19:28:13.4642496Z                              $items = $Config[$category]
2026-01-11T19:28:13.4643117Z                      
2026-01-11T19:28:13.4643646Z                              if ($items -is [hashtable]) {
2026-01-11T19:28:13.4644124Z                                  foreach ($key in $items.Keys | Sort-Object) {
2026-01-11T19:28:13.4645155Z                                      $value = $items[$key]
2026-01-11T19:28:13.4646462Z                                      $status = if ($value -eq $true) { "YES" } elseif ($value -eq $false) { "NO" } 
2026-01-11T19:28:13.4646618Z                      else { $value }
2026-01-11T19:28:13.4647162Z                                      Write-Host "  $key : $status" -ForegroundColor White
2026-01-11T19:28:13.4647502Z                                  }
2026-01-11T19:28:13.4648393Z                              } elseif ($items -is [array]) {
2026-01-11T19:28:13.4649107Z                                  foreach ($item in $items) {
2026-01-11T19:28:13.4650706Z                                      Write-Host "  - $item" -ForegroundColor White
2026-01-11T19:28:13.4652095Z                                  }
2026-01-11T19:28:13.4652823Z                              } else {
2026-01-11T19:28:13.4653836Z                                  Write-Host "  $items" -ForegroundColor White
2026-01-11T19:28:13.4654176Z                              }
2026-01-11T19:28:13.4655130Z                      
2026-01-11T19:28:13.4655627Z                              Write-Host ""
2026-01-11T19:28:13.4656268Z                          }
2026-01-11T19:28:13.4656393Z                      
2026-01-11T19:28:13.4658378Z                          Write-Host "??????????????????????????????????????????????????????????????????????????????????
2026-01-11T19:28:13.4658571Z                      ??????????????????????????????????????????????????????????????????????????????????????????????????
2026-01-11T19:28:13.4659786Z                      ?????????" -ForegroundColor Cyan
2026-01-11T19:28:13.4659923Z                      }
2026-01-11T19:28:13.4660715Z                      
2026-01-11T19:28:13.4661583Z                      function Show-Welcome {
2026-01-11T19:28:13.4662486Z                          <#
2026-01-11T19:28:13.4663353Z                          .SYNOPSIS
2026-01-11T19:28:13.4663785Z                              Shows the interactive setup welcome screen.
2026-01-11T19:28:13.4664815Z                          .DESCRIPTION
2026-01-11T19:28:13.4665529Z                              Prints a banner and optional system information for user context.
2026-01-11T19:28:13.4665905Z                          .PARAMETER SystemInfo
2026-01-11T19:28:13.4666520Z                              Hashtable of system key/value pairs to display.
2026-01-11T19:28:13.4667598Z                          .OUTPUTS
2026-01-11T19:28:13.4667726Z                              None.
2026-01-11T19:28:13.4668564Z                          #>
2026-01-11T19:28:13.4668975Z                      
2026-01-11T19:28:13.4670123Z                          [CmdletBinding()]
2026-01-11T19:28:13.4670563Z                          param(
2026-01-11T19:28:13.4671288Z                              [hashtable]$SystemInfo = @{}
2026-01-11T19:28:13.4672350Z                          )
2026-01-11T19:28:13.4672761Z                      
2026-01-11T19:28:13.4673508Z                          Clear-Host
2026-01-11T19:28:13.4674260Z                          Write-Host ""
2026-01-11T19:28:13.4675777Z                          Write-Host "??\u0022??????????????????????????????????????????????????????????????????????????
2026-01-11T19:28:13.4676296Z                      ??????????????????????????????????????????????????????????????????????????????????????????????????
2026-01-11T19:28:13.4676867Z                      ?????????????????????????????????????????????????????????????????" -ForegroundColor Cyan
2026-01-11T19:28:13.4678240Z                          Write-Host "???                                                                              
2026-01-11T19:28:13.4678829Z                      ???" -ForegroundColor Cyan
2026-01-11T19:28:13.4680190Z                          Write-Host "???              GAMING PC SETUP - INTERACTIVE CONFIGURATION                     
2026-01-11T19:28:13.4680342Z                      ???" -ForegroundColor Cyan
2026-01-11T19:28:13.4681977Z                          Write-Host "???                                                                              
2026-01-11T19:28:13.4682157Z                      ???" -ForegroundColor Cyan
2026-01-11T19:28:13.4683587Z                          Write-Host "??????????????????????????????????????????????????????????????????????????????????
2026-01-11T19:28:13.4683838Z                      ??????????????????????????????????????????????????????????????????????????????????????????????????
2026-01-11T19:28:13.4684409Z                      ????????????????????????????????????????????????????????????" -ForegroundColor Cyan
2026-01-11T19:28:13.4685454Z                          Write-Host ""
2026-01-11T19:28:13.4686557Z                          Write-Host "Welcome! This wizard will optimize your Windows system for gaming." 
2026-01-11T19:28:13.4686672Z                      -ForegroundColor White
2026-01-11T19:28:13.4687708Z                          Write-Host ""
2026-01-11T19:28:13.4688483Z                      
2026-01-11T19:28:13.4689324Z                          if ($SystemInfo.Count -gt 0) {
2026-01-11T19:28:13.4689612Z                              Write-Host "System Information:" -ForegroundColor Yellow
2026-01-11T19:28:13.4690984Z                              foreach ($key in $SystemInfo.Keys) {
2026-01-11T19:28:13.4691921Z                                  Write-Host "  $key : $($SystemInfo[$key])" -ForegroundColor White
2026-01-11T19:28:13.4692403Z                              }
2026-01-11T19:28:13.4693425Z                              Write-Host ""
2026-01-11T19:28:13.4694214Z                          }
2026-01-11T19:28:13.4695340Z                      }
2026-01-11T19:28:13.4695470Z                      
2026-01-11T19:28:13.4696679Z                      function Show-SetupModeSelection {
2026-01-11T19:28:13.4697091Z                          <#
2026-01-11T19:28:13.4697902Z                          .SYNOPSIS
2026-01-11T19:28:13.4699082Z                              Presents the setup mode selection menu.
2026-01-11T19:28:13.4699259Z                          .DESCRIPTION
2026-01-11T19:28:13.4700247Z                              Lets the user choose between express, custom, or profile-based setup,
2026-01-11T19:28:13.4700484Z                              or exit the wizard.
2026-01-11T19:28:13.4701396Z                      
2026-01-11T19:28:13.4702480Z                              AUTOMATION MODE
2026-01-11T19:28:13.4702602Z                              ===============
2026-01-11T19:28:13.4704018Z                              When the environment variable ROCKTUNE_SETUP_MODE is set, this function
2026-01-11T19:28:13.4704392Z                              bypasses the interactive menu and returns the specified mode directly:
2026-01-11T19:28:13.4704527Z                      
2026-01-11T19:28:13.4705155Z                              - "express"  : Express Setup - uses proven defaults, best for most users
2026-01-11T19:28:13.4706054Z                              - "custom"   : Custom Setup - select each optimization individually
2026-01-11T19:28:13.4706889Z                              - "profile"  : Load Profile - use pre-made competitive/balanced/privacy configurations
2026-01-11T19:28:13.4707381Z                              - "exit"     : Exit the wizard without making changes
2026-01-11T19:28:13.4707673Z                      
2026-01-11T19:28:13.4708680Z                              This is useful for:
2026-01-11T19:28:13.4708994Z                              - CI/CD pipelines that need deterministic, non-interactive execution
2026-01-11T19:28:13.4710059Z                              - Automated testing of specific setup modes
2026-01-11T19:28:13.4710734Z                              - Scripted deployments with pre-determined configurations
2026-01-11T19:28:13.4711935Z                              - Remote execution where interactive prompts would block
2026-01-11T19:28:13.4712257Z                      
2026-01-11T19:28:13.4713144Z                              Example:
2026-01-11T19:28:13.4714263Z                                  $env:ROCKTUNE_SETUP_MODE = "express"
2026-01-11T19:28:13.4714785Z                                  $mode = Show-SetupModeSelection
2026-01-11T19:28:13.4715343Z                                  # Returns "express" without prompting
2026-01-11T19:28:13.4715823Z                      
2026-01-11T19:28:13.4716967Z                              Note: For full automation, combine with ROCKTUNE_MENU_MODE and the
2026-01-11T19:28:13.4717495Z                              -SkipConfirmation parameter on the main script:
2026-01-11T19:28:13.4717856Z                      
2026-01-11T19:28:13.4718816Z                                  $env:ROCKTUNE_SETUP_MODE = "express"
2026-01-11T19:28:13.4719037Z                                  $env:ROCKTUNE_MENU_MODE = "recommended"
2026-01-11T19:28:13.4720346Z                                  .\gaming-pc-setup.ps1 -SkipConfirmation
2026-01-11T19:28:13.4720445Z                      
2026-01-11T19:28:13.4721599Z                          .OUTPUTS
2026-01-11T19:28:13.4722155Z                              [string] One of: express, custom, profile, exit.
2026-01-11T19:28:13.4723171Z                          #>
2026-01-11T19:28:13.4723293Z                      
2026-01-11T19:28:13.4724533Z                          # -------------------------------------------------------------------------
2026-01-11T19:28:13.4724687Z                          # AUTOMATION MODE CHECK
2026-01-11T19:28:13.4725971Z                          # -------------------------------------------------------------------------
2026-01-11T19:28:13.4726251Z                          # Check if ROCKTUNE_SETUP_MODE environment variable is set. If so, we
2026-01-11T19:28:13.4727409Z                          # return the specified mode directly without displaying the menu or
2026-01-11T19:28:13.4727738Z                          # prompting for input.
2026-01-11T19:28:13.4728655Z                          #
2026-01-11T19:28:13.4729542Z                          # Why check first?
2026-01-11T19:28:13.4730103Z                          # - Avoids Clear-Host which would disrupt CI/CD log output
2026-01-11T19:28:13.4730477Z                          # - Returns immediately for faster automated execution
2026-01-11T19:28:13.4731981Z                          # - Provides clear feedback about what mode was auto-selected
2026-01-11T19:28:13.4732131Z                          #
2026-01-11T19:28:13.4733327Z                          # Valid modes match the return values of the interactive menu:
2026-01-11T19:28:13.4733836Z                          # - express  : Maps to menu choice "1" (Express Setup)
2026-01-11T19:28:13.4734814Z                          # - custom   : Maps to menu choice "2" (Custom Setup)
2026-01-11T19:28:13.4735294Z                          # - profile  : Maps to menu choice "3" (Load Profile)
2026-01-11T19:28:13.4736505Z                          # - exit     : Maps to menu choice "4" (Exit)
2026-01-11T19:28:13.4736604Z                          #
2026-01-11T19:28:13.4738333Z                          # Invalid values trigger a warning and fall through to interactive mode.
2026-01-11T19:28:13.4739044Z                          # This is intentional - we don't want automation to silently fail.
2026-01-11T19:28:13.4739608Z                          # -------------------------------------------------------------------------
2026-01-11T19:28:13.4740707Z                          $setupMode = $env:ROCKTUNE_SETUP_MODE
2026-01-11T19:28:13.4740877Z                          if ($setupMode) {
2026-01-11T19:28:13.4742156Z                              # Normalize to lowercase for case-insensitive comparison
2026-01-11T19:28:13.4742341Z                              $setupMode = $setupMode.ToLower()
2026-01-11T19:28:13.4743383Z                      
2026-01-11T19:28:13.4743634Z                              $validModes = @('express', 'custom', 'profile', 'exit')
2026-01-11T19:28:13.4744389Z                              if ($validModes -contains $setupMode) {
2026-01-11T19:28:13.4745265Z                                  # Log the auto-selection for transparency in CI logs
2026-01-11T19:28:13.4746435Z                                  Write-Host "[AUTO] Setup mode: $setupMode (ROCKTUNE_SETUP_MODE env var)" 
2026-01-11T19:28:13.4746537Z                      -ForegroundColor Cyan
2026-01-11T19:28:13.4747509Z                                  return $setupMode
2026-01-11T19:28:13.4748259Z                              } else {
2026-01-11T19:28:13.4749254Z                                  # Invalid mode specified - warn and fall through to interactive
2026-01-11T19:28:13.4749602Z                                  Write-Host "[WARN] Unknown ROCKTUNE_SETUP_MODE='$setupMode'. Valid: express, custom, 
2026-01-11T19:28:13.4750443Z                      profile, exit" -ForegroundColor Yellow
2026-01-11T19:28:13.4750918Z                                  Write-Host "[WARN] Falling back to interactive mode." -ForegroundColor Yellow
2026-01-11T19:28:13.4752184Z                              }
2026-01-11T19:28:13.4752303Z                          }
2026-01-11T19:28:13.4753438Z                      
2026-01-11T19:28:13.4754089Z                          # -------------------------------------------------------------------------
2026-01-11T19:28:13.4755083Z                          # INTERACTIVE MODE
2026-01-11T19:28:13.4755788Z                          # -------------------------------------------------------------------------
2026-01-11T19:28:13.4756931Z                          # If ROCKTUNE_SETUP_MODE is not set (or was invalid), display the menu
2026-01-11T19:28:13.4757129Z                          # and prompt for user input as normal.
2026-01-11T19:28:13.4757755Z                          # -------------------------------------------------------------------------
2026-01-11T19:28:13.4758139Z                      
2026-01-11T19:28:13.4759080Z                          Clear-Host
2026-01-11T19:28:13.4760569Z                          Write-Host "??????????????????????????????????????????????????????????????????????????????????
2026-01-11T19:28:13.4760743Z                      ??????????????????????????????????????????????????????????????????????????????????????????????????
2026-01-11T19:28:13.4761242Z                      ?????????" -ForegroundColor Cyan
2026-01-11T19:28:13.4762247Z                          Write-Host "    SETUP MODE SELECTION" -ForegroundColor Cyan
2026-01-11T19:28:13.4763321Z                          Write-Host "??????????????????????????????????????????????????????????????????????????????????
2026-01-11T19:28:13.4763517Z                      ??????????????????????????????????????????????????????????????????????????????????????????????????
2026-01-11T19:28:13.4764665Z                      ?????????" -ForegroundColor Cyan
2026-01-11T19:28:13.4765016Z                          Write-Host ""
2026-01-11T19:28:13.4766026Z                          Write-Host "Choose your setup mode:" -ForegroundColor Yellow
2026-01-11T19:28:13.4766167Z                          Write-Host ""
2026-01-11T19:28:13.4767561Z                          Write-Host "  1) Express Setup (Recommended)" -ForegroundColor Green
2026-01-11T19:28:13.4767836Z                          Write-Host "     - Uses proven defaults" -ForegroundColor DarkGray
2026-01-11T19:28:13.4769162Z                          Write-Host "     - ~5 minutes setup time" -ForegroundColor DarkGray
2026-01-11T19:28:13.4769473Z                          Write-Host "     - Best for most users" -ForegroundColor DarkGray
2026-01-11T19:28:13.4770572Z                          Write-Host ""
2026-01-11T19:28:13.4771945Z                          Write-Host "  2) Custom Setup (Advanced)" -ForegroundColor Yellow
2026-01-11T19:28:13.4772362Z                          Write-Host "     - Select each optimization individually" -ForegroundColor DarkGray
2026-01-11T19:28:13.4773383Z                          Write-Host "     - ~15 minutes setup time" -ForegroundColor DarkGray
2026-01-11T19:28:13.4774100Z                          Write-Host "     - Full control over every setting" -ForegroundColor DarkGray
2026-01-11T19:28:13.4775132Z                          Write-Host ""
2026-01-11T19:28:13.4775643Z                          Write-Host "  3) Load Profile" -ForegroundColor Cyan
2026-01-11T19:28:13.4776273Z                          Write-Host "     - Pre-made configurations" -ForegroundColor DarkGray
2026-01-11T19:28:13.4777420Z                          Write-Host "     - Competitive / Balanced / Privacy-Focused" -ForegroundColor DarkGray
2026-01-11T19:28:13.4777547Z                          Write-Host ""
2026-01-11T19:28:13.4777748Z                          Write-Host "  4) Exit" -ForegroundColor Red
2026-01-11T19:28:13.4778657Z                          Write-Host ""
2026-01-11T19:28:13.4779507Z                      
2026-01-11T19:28:13.4780760Z                          $choice = Get-UserChoice -Prompt "Your choice" -ValidChoices @('1', '2', '3', '4') 
2026-01-11T19:28:13.4780856Z                      -DefaultChoice '1'
2026-01-11T19:28:13.4781731Z                      
2026-01-11T19:28:13.4782778Z                          switch ($choice) {
2026-01-11T19:28:13.4782944Z                              '1' { return "express" }
2026-01-11T19:28:13.4784071Z                              '2' { return "custom" }
2026-01-11T19:28:13.4784216Z                              '3' { return "profile" }
2026-01-11T19:28:13.4785159Z                              '4' { return "exit" }
2026-01-11T19:28:13.4785614Z                          }
2026-01-11T19:28:13.4786375Z                      }
2026-01-11T19:28:13.4787442Z                      
2026-01-11T19:28:13.4787544Z                      
2026-01-11T19:28:13.4788435Z                      Export-ModuleMember -Function @(
2026-01-11T19:28:13.4789302Z                          'Show-Menu',
2026-01-11T19:28:13.4790167Z                          'Show-CategoryMenu',
2026-01-11T19:28:13.4790326Z                          'Get-UserChoice',
2026-01-11T19:28:13.4792130Z                          'Show-Summary',
2026-01-11T19:28:13.4792507Z                          'Show-Welcome',
2026-01-11T19:28:13.4793664Z                          'Show-SetupModeSelection'
2026-01-11T19:28:13.4793765Z                      )
2026-01-11T19:28:13.4794803Z [32;1mCleanBlock         : [0m
2026-01-11T19:28:13.4795289Z [32;1mDynamicParamBlock  : [0m
2026-01-11T19:28:13.4796581Z [32;1mScriptRequirements : [0m
2026-01-11T19:28:13.4798873Z [32;1mExtent             : [0m
2026-01-11T19:28:13.4799359Z                      <#
2026-01-11T19:28:13.4800508Z                      .SYNOPSIS
2026-01-11T19:28:13.4800665Z                          Interactive console menu utilities.
2026-01-11T19:28:13.4801573Z                      .DESCRIPTION
2026-01-11T19:28:13.4802219Z                          Provides interactive, text-based selection menus for choosing categories,
2026-01-11T19:28:13.4802603Z                          toggling options, and printing a configuration summary.
2026-01-11T19:28:13.4803531Z                      
2026-01-11T19:28:13.4803681Z                          AUTOMATION SUPPORT
2026-01-11T19:28:13.4804895Z                          ==================
2026-01-11T19:28:13.4805309Z                          These menu functions support unattended/automated execution through environment
2026-01-11T19:28:13.4806246Z                          variables. This allows the scripts to be used in CI/CD pipelines, automated
2026-01-11T19:28:13.4807618Z                          testing, or scripted deployments without human interaction.
2026-01-11T19:28:13.4807719Z                      
2026-01-11T19:28:13.4809498Z                          Environment Variables:
2026-01-11T19:28:13.4809810Z                          ----------------------
2026-01-11T19:28:13.4810109Z                          ROCKTUNE_MENU_MODE
2026-01-11T19:28:13.4811172Z                              Controls menu behavior in Show-Menu:
2026-01-11T19:28:13.4811876Z                              - "all"         : Auto-select ALL items and continue (like pressing 'A' then Enter)
2026-01-11T19:28:13.4812242Z                              - "none"        : Auto-select NONE and continue (like pressing 'N' then Enter)
2026-01-11T19:28:13.4812854Z                              - "recommended" : Auto-select RECOMMENDED items and continue (like pressing 'R' then 
2026-01-11T19:28:13.4812955Z                      Enter)
2026-01-11T19:28:13.4814130Z                              - "default"     : Accept current selections and continue (like pressing Enter)
2026-01-11T19:28:13.4814493Z                              If not set, menu is interactive as usual.
2026-01-11T19:28:13.4814612Z                      
2026-01-11T19:28:13.4815453Z                          ROCKTUNE_SETUP_MODE
2026-01-11T19:28:13.4815826Z                              Pre-selects the setup mode in Show-SetupModeSelection:
2026-01-11T19:28:13.4816053Z                              - "express"  : Express Setup (recommended defaults)
2026-01-11T19:28:13.4816337Z                              - "custom"   : Custom Setup (advanced, select each option)
2026-01-11T19:28:13.4820920Z                              - "profile"  : Load Profile (pre-made configurations)
2026-01-11T19:28:13.4821656Z                              - "exit"     : Exit the wizard
2026-01-11T19:28:13.4823099Z                              If not set, user is prompted interactively.
2026-01-11T19:28:13.4823207Z                      
2026-01-11T19:28:13.4824309Z                          Usage Examples:
2026-01-11T19:28:13.4825204Z                          ---------------
2026-01-11T19:28:13.4825530Z                          # Run with all optimizations selected (non-interactive)
2026-01-11T19:28:13.4826396Z                          $env:ROCKTUNE_MENU_MODE = "all"
2026-01-11T19:28:13.4826933Z                          $env:ROCKTUNE_SETUP_MODE = "express"
2026-01-11T19:28:13.4827289Z                          .\gaming-pc-setup.ps1
2026-01-11T19:28:13.4828647Z                      
2026-01-11T19:28:13.4829195Z                          # Run with only recommended optimizations
2026-01-11T19:28:13.4829765Z                          $env:ROCKTUNE_MENU_MODE = "recommended"
2026-01-11T19:28:13.4830818Z                          .\gaming-pc-setup.ps1
2026-01-11T19:28:13.4831481Z                      
2026-01-11T19:28:13.4831669Z                          # CI/CD pipeline example (bash)
2026-01-11T19:28:13.4833078Z                          ROCKTUNE_MENU_MODE=all ROCKTUNE_SETUP_MODE=express pwsh -File gaming-pc-setup.ps1
2026-01-11T19:28:13.4833155Z                      
2026-01-11T19:28:13.4833982Z                          Why Environment Variables?
2026-01-11T19:28:13.4835241Z                          --------------------------
2026-01-11T19:28:13.4835626Z                          Environment variables were chosen over command-line parameters because:
2026-01-11T19:28:13.4836857Z                          1. The menu module is imported by multiple scripts - env vars work universally
2026-01-11T19:28:13.4837231Z                          2. They can be set by parent processes, CI/CD systems, or wrapper scripts
2026-01-11T19:28:13.4837611Z                          3. They don't pollute the parameter space of consuming scripts
2026-01-11T19:28:13.4838466Z                          4. They're the standard approach for configuration in containerized environments
2026-01-11T19:28:13.4838819Z                      
2026-01-11T19:28:13.4840144Z                          See also:
2026-01-11T19:28:13.4840567Z                          - gaming-pc-setup.ps1 -SkipConfirmation (skip final confirmation prompt)
2026-01-11T19:28:13.4841628Z                          - benchmark-setup.ps1 -AutoAccept (skip install consent prompt)
2026-01-11T19:28:13.4842198Z                          - extreme-privacy.ps1 -SkipConfirmations (skip all confirmation prompts)
2026-01-11T19:28:13.4842919Z                      
2026-01-11T19:28:13.4843564Z                      .NOTES
2026-01-11T19:28:13.4844675Z                          Designed for PowerShell console UX; uses Clear-Host and Read-Host.
2026-01-11T19:28:13.4845494Z                          Supports automation via ROCKTUNE_MENU_MODE and ROCKTUNE_SETUP_MODE env vars.
2026-01-11T19:28:13.4845835Z                      #>
2026-01-11T19:28:13.4846614Z                      
2026-01-11T19:28:13.4847443Z                      function Show-Menu {
2026-01-11T19:28:13.4848413Z                          <#
2026-01-11T19:28:13.4849547Z                          .SYNOPSIS
2026-01-11T19:28:13.4849794Z                              Renders an interactive checkbox-style menu.
2026-01-11T19:28:13.4849916Z                          .DESCRIPTION
2026-01-11T19:28:13.4851361Z                              Displays options with selection markers and optional descriptions. Users
2026-01-11T19:28:13.4851726Z                              can toggle items by number, select all/none/recommended, and press Enter
2026-01-11T19:28:13.4851947Z                              to accept the current selection.
2026-01-11T19:28:13.4852785Z                      
2026-01-11T19:28:13.4852926Z                              AUTOMATION MODE
2026-01-11T19:28:13.4853975Z                              ===============
2026-01-11T19:28:13.4855369Z                              When the environment variable ROCKTUNE_MENU_MODE is set, this function
2026-01-11T19:28:13.4855737Z                              bypasses the interactive loop and applies the specified selection mode:
2026-01-11T19:28:13.4855804Z                      
2026-01-11T19:28:13.4857051Z                              - "all"         : Selects ALL non-disabled items (equivalent to pressing 'A')
2026-01-11T19:28:13.4857359Z                              - "none"        : Deselects ALL items (equivalent to pressing 'N')
2026-01-11T19:28:13.4858573Z                              - "recommended" : Selects items marked with [*] icon (equivalent to pressing 'R')
2026-01-11T19:28:13.4859075Z                              - "default"     : Keeps the initial selection state (equivalent to pressing Enter)
2026-01-11T19:28:13.4859496Z                      
2026-01-11T19:28:13.4859721Z                              This is useful for:
2026-01-11T19:28:13.4861016Z                              - CI/CD pipelines where no human is present to interact
2026-01-11T19:28:13.4861238Z                              - Automated testing that needs deterministic behavior
2026-01-11T19:28:13.4862366Z                              - Scripted deployments with pre-determined configurations
2026-01-11T19:28:13.4862845Z                              - Remote execution where interactive prompts would hang
2026-01-11T19:28:13.4863147Z                      
2026-01-11T19:28:13.4863916Z                              Example:
2026-01-11T19:28:13.4864441Z                                  $env:ROCKTUNE_MENU_MODE = "all"
2026-01-11T19:28:13.4865715Z                                  $selected = Show-Menu -Title "Options" -Options $opts
2026-01-11T19:28:13.4865974Z                                  # Returns all non-disabled indices without prompting
2026-01-11T19:28:13.4866516Z                      
2026-01-11T19:28:13.4867005Z                          .PARAMETER Title
2026-01-11T19:28:13.4868028Z                              Menu title displayed at the top.
2026-01-11T19:28:13.4868364Z                          .PARAMETER Options
2026-01-11T19:28:13.4869720Z                              Array of hashtables with keys: Label, Selected, Description, Icon, Disabled.
2026-01-11T19:28:13.4869809Z                          .PARAMETER Legend
2026-01-11T19:28:13.4870877Z                              Optional legend text shown under the list.
2026-01-11T19:28:13.4871332Z                          .PARAMETER AllowMultiple
2026-01-11T19:28:13.4872492Z                              Indicates whether multi-select is allowed (kept for future extensibility).
2026-01-11T19:28:13.4872612Z                          .OUTPUTS
2026-01-11T19:28:13.4873181Z                              [int[]] Indices of selected items.
2026-01-11T19:28:13.4873728Z                          #>
2026-01-11T19:28:13.4874810Z                      
2026-01-11T19:28:13.4875173Z                          [CmdletBinding()]
2026-01-11T19:28:13.4876020Z                          param(
2026-01-11T19:28:13.4876585Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.4876716Z                              [string]$Title,
2026-01-11T19:28:13.4877770Z                      
2026-01-11T19:28:13.4878180Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.4879126Z                              [array]$Options,
2026-01-11T19:28:13.4879238Z                      
2026-01-11T19:28:13.4880537Z                              [string]$Legend = "",
2026-01-11T19:28:13.4880642Z                      
2026-01-11T19:28:13.4881908Z                              [bool]$AllowMultiple = $true
2026-01-11T19:28:13.4882016Z                          )
2026-01-11T19:28:13.4883170Z                      
2026-01-11T19:28:13.4884061Z                          $selectedIndices = @()
2026-01-11T19:28:13.4884552Z                      
2026-01-11T19:28:13.4884871Z                          # -------------------------------------------------------------------------
2026-01-11T19:28:13.4885851Z                          # AUTOMATION MODE CHECK
2026-01-11T19:28:13.4886580Z                          # -------------------------------------------------------------------------
2026-01-11T19:28:13.4887292Z                          # Check if the ROCKTUNE_MENU_MODE environment variable is set. If so, we
2026-01-11T19:28:13.4887717Z                          # bypass the interactive do/while loop entirely and apply the selection
2026-01-11T19:28:13.4888987Z                          # mode directly. This enables fully unattended script execution.
2026-01-11T19:28:13.4889102Z                          #
2026-01-11T19:28:13.4889982Z                          # Why check before the loop?
2026-01-11T19:28:13.4891206Z                          # - Avoids any Clear-Host or Write-Host that would clutter CI logs
2026-01-11T19:28:13.4891859Z                          # - Returns immediately for faster automated execution
2026-01-11T19:28:13.4892122Z                          # - Deterministic behavior - no timing or race condition concerns
2026-01-11T19:28:13.4893211Z                          #
2026-01-11T19:28:13.4893857Z                          # The env var is read fresh each time Show-Menu is called, so you can
2026-01-11T19:28:13.4894492Z                          # potentially change it between menus in a complex orchestration scenario
2026-01-11T19:28:13.4895704Z                          # (though this is uncommon - typically set once at the start).
2026-01-11T19:28:13.4896353Z                          # -------------------------------------------------------------------------
2026-01-11T19:28:13.4896955Z                          $menuMode = $env:ROCKTUNE_MENU_MODE
2026-01-11T19:28:13.4897881Z                          if ($menuMode) {
2026-01-11T19:28:13.4898196Z                              # Normalize to lowercase for case-insensitive comparison
2026-01-11T19:28:13.4899256Z                              $menuMode = $menuMode.ToLower()
2026-01-11T19:28:13.4899621Z                      
2026-01-11T19:28:13.4900859Z                              switch ($menuMode) {
2026-01-11T19:28:13.4901106Z                                  'all' {
2026-01-11T19:28:13.4902330Z                                      # Select ALL non-disabled items
2026-01-11T19:28:13.4902852Z                                      # This mirrors pressing 'A' in the interactive menu
2026-01-11T19:28:13.4903982Z                                      for ($i = 0; $i -lt $Options.Count; $i++) {
2026-01-11T19:28:13.4904165Z                                          if (-not $Options[$i].Disabled) {
2026-01-11T19:28:13.4905165Z                                              $Options[$i].Selected = $true
2026-01-11T19:28:13.4905593Z                                          }
2026-01-11T19:28:13.4906412Z                                      }
2026-01-11T19:28:13.4907816Z                                      Write-Host "[AUTO] Menu '$Title': Selected ALL items (ROCKTUNE_MENU_MODE=all)" 
2026-01-11T19:28:13.4907925Z                      -ForegroundColor Cyan
2026-01-11T19:28:13.4909105Z                                  }
2026-01-11T19:28:13.4909430Z                                  'none' {
2026-01-11T19:28:13.4909993Z                                      # Deselect ALL items
2026-01-11T19:28:13.4911267Z                                      # This mirrors pressing 'N' in the interactive menu
2026-01-11T19:28:13.4911441Z                                      for ($i = 0; $i -lt $Options.Count; $i++) {
2026-01-11T19:28:13.4912505Z                                          $Options[$i].Selected = $false
2026-01-11T19:28:13.4912887Z                                      }
2026-01-11T19:28:13.4914430Z                                      Write-Host "[AUTO] Menu '$Title': Selected NONE (ROCKTUNE_MENU_MODE=none)" 
2026-01-11T19:28:13.4914543Z                      -ForegroundColor Cyan
2026-01-11T19:28:13.4915597Z                                  }
2026-01-11T19:28:13.4916040Z                                  'recommended' {
2026-01-11T19:28:13.4917050Z                                      # Select only items marked as recommended (icon = "[*]")
2026-01-11T19:28:13.4917517Z                                      # This mirrors pressing 'R' in the interactive menu
2026-01-11T19:28:13.4917929Z                                      for ($i = 0; $i -lt $Options.Count; $i++) {
2026-01-11T19:28:13.4919067Z                                          $Options[$i].Selected = ($Options[$i].Icon -eq "[*]")
2026-01-11T19:28:13.4919184Z                                      }
2026-01-11T19:28:13.4920500Z                                      Write-Host "[AUTO] Menu '$Title': Selected RECOMMENDED items 
2026-01-11T19:28:13.4920713Z                      (ROCKTUNE_MENU_MODE=recommended)" -ForegroundColor Cyan
2026-01-11T19:28:13.4922140Z                                  }
2026-01-11T19:28:13.4922321Z                                  'default' {
2026-01-11T19:28:13.4923210Z                                      # Keep initial selection state - just proceed
2026-01-11T19:28:13.4924459Z                                      # This mirrors pressing Enter immediately in the interactive menu
2026-01-11T19:28:13.4924762Z                                      Write-Host "[AUTO] Menu '$Title': Using DEFAULT selections 
2026-01-11T19:28:13.4925510Z                      (ROCKTUNE_MENU_MODE=default)" -ForegroundColor Cyan
2026-01-11T19:28:13.4926321Z                                  }
2026-01-11T19:28:13.4926772Z                                  default {
2026-01-11T19:28:13.4927970Z                                      # Unrecognized mode - warn and fall through to interactive
2026-01-11T19:28:13.4928432Z                                      Write-Host "[WARN] Unknown ROCKTUNE_MENU_MODE='$menuMode'. Valid: all, none, 
2026-01-11T19:28:13.4928661Z                      recommended, default" -ForegroundColor Yellow
2026-01-11T19:28:13.4929779Z                                      Write-Host "[WARN] Falling back to interactive mode." -ForegroundColor Yellow
2026-01-11T19:28:13.4930626Z                                      $menuMode = $null  # Clear so we enter the interactive loop
2026-01-11T19:28:13.4930957Z                                  }
2026-01-11T19:28:13.4931603Z                              }
2026-01-11T19:28:13.4932409Z                      
2026-01-11T19:28:13.4932862Z                              # If we successfully processed an automation mode, return immediately
2026-01-11T19:28:13.4933940Z                              if ($menuMode) {
2026-01-11T19:28:13.4934098Z                                  $selectedIndices = @()
2026-01-11T19:28:13.4935167Z                                  for ($i = 0; $i -lt $Options.Count; $i++) {
2026-01-11T19:28:13.4935341Z                                      if ($Options[$i].Selected) {
2026-01-11T19:28:13.4936296Z                                          $selectedIndices += $i
2026-01-11T19:28:13.4936967Z                                      }
2026-01-11T19:28:13.4937904Z                                  }
2026-01-11T19:28:13.4938426Z                                  return $selectedIndices
2026-01-11T19:28:13.4939245Z                              }
2026-01-11T19:28:13.4939684Z                          }
2026-01-11T19:28:13.4940604Z                      
2026-01-11T19:28:13.4940919Z                          # -------------------------------------------------------------------------
2026-01-11T19:28:13.4941895Z                          # INTERACTIVE MODE
2026-01-11T19:28:13.4943094Z                          # -------------------------------------------------------------------------
2026-01-11T19:28:13.4943452Z                          # If ROCKTUNE_MENU_MODE is not set (or was invalid), we fall through to
2026-01-11T19:28:13.4943825Z                          # the standard interactive menu loop. This is the default behavior.
2026-01-11T19:28:13.4944110Z                          # -------------------------------------------------------------------------
2026-01-11T19:28:13.4945170Z                      
2026-01-11T19:28:13.4945297Z                          do {
2026-01-11T19:28:13.4946337Z                              Clear-Host
2026-01-11T19:28:13.4947057Z                      
2026-01-11T19:28:13.4948152Z                              Write-Host "??????????????????????????????????????????????????????????????????????????????
2026-01-11T19:28:13.4948348Z                      ??????????????????????????????????????????????????????????????????????????????????????????????????
2026-01-11T19:28:13.4949391Z                      ?????????????" -ForegroundColor Cyan
2026-01-11T19:28:13.4950359Z                              Write-Host "    $Title" -ForegroundColor Cyan
2026-01-11T19:28:13.4951752Z                              Write-Host "??????????????????????????????????????????????????????????????????????????????
2026-01-11T19:28:13.4951965Z                      ??????????????????????????????????????????????????????????????????????????????????????????????????
2026-01-11T19:28:13.4952315Z                      ?????????????" -ForegroundColor Cyan
2026-01-11T19:28:13.4953232Z                              Write-Host ""
2026-01-11T19:28:13.4953340Z                      
2026-01-11T19:28:13.4954275Z                              for ($i = 0; $i -lt $Options.Count; $i++) {
2026-01-11T19:28:13.4955135Z                                  $option = $Options[$i]
2026-01-11T19:28:13.4956170Z                                  $index = $i + 1
2026-01-11T19:28:13.4956638Z                      
2026-01-11T19:28:13.4957615Z                                  $checkbox = if ($option.Selected) { "X" } else { " " }
2026-01-11T19:28:13.4957947Z                      
2026-01-11T19:28:13.4958911Z                                  $icon = if ($option.Icon) { " $($option.Icon)" } else { "" }
2026-01-11T19:28:13.4959020Z                      
2026-01-11T19:28:13.4959511Z                                  $color = "White"
2026-01-11T19:28:13.4960492Z                                  if ($option.Disabled) {
2026-01-11T19:28:13.4960839Z                                      $color = "DarkGray"
2026-01-11T19:28:13.4961839Z                                  } elseif ($option.Icon -eq "[*]") {
2026-01-11T19:28:13.4962310Z                                      $color = "Green"
2026-01-11T19:28:13.4963266Z                                  } elseif ($option.Icon -eq "[!]") {
2026-01-11T19:28:13.4963656Z                                      $color = "Yellow"
2026-01-11T19:28:13.4964590Z                                  } elseif ($option.Icon -eq "[i]") {
2026-01-11T19:28:13.4964763Z                                      $color = "Cyan"
2026-01-11T19:28:13.4966083Z                                  }
2026-01-11T19:28:13.4966671Z                      
2026-01-11T19:28:13.4968363Z                                  $line = " [$checkbox] $index. $($option.Label)$icon"
2026-01-11T19:28:13.4969158Z                                  Write-Host $line -ForegroundColor $color
2026-01-11T19:28:13.4970323Z                      
2026-01-11T19:28:13.4971533Z                                  if ($option.Description) {
2026-01-11T19:28:13.4972403Z                                      Write-Host "      $($option.Description)" -ForegroundColor DarkGray
2026-01-11T19:28:13.4972543Z                                  }
2026-01-11T19:28:13.4973368Z                              }
2026-01-11T19:28:13.4973520Z                      
2026-01-11T19:28:13.4974845Z                              if ($Legend) {
2026-01-11T19:28:13.4974977Z                                  Write-Host ""
2026-01-11T19:28:13.4975853Z                                  Write-Host "Legend: $Legend" -ForegroundColor DarkGray
2026-01-11T19:28:13.4976455Z                              }
2026-01-11T19:28:13.4977413Z                      
2026-01-11T19:28:13.4978352Z                              Write-Host ""
2026-01-11T19:28:13.4979066Z                              Write-Host "Toggle with numbers, 'A' for all, 'N' for none, 'R' for recommended, Enter to 
2026-01-11T19:28:13.4979420Z                      continue" -ForegroundColor Yellow
2026-01-11T19:28:13.4980455Z                      
2026-01-11T19:28:13.4980669Z                              $choice = Read-Host "Your choice"
2026-01-11T19:28:13.4981654Z                      
2026-01-11T19:28:13.4982273Z                              if ($choice -match '^\d+$') {
2026-01-11T19:28:13.4982728Z                                  $idx = [int]$choice - 1
2026-01-11T19:28:13.4983770Z                                  if ($idx -ge 0 -and $idx -lt $Options.Count -and -not $Options[$idx].Disabled) {
2026-01-11T19:28:13.4983943Z                                      $Options[$idx].Selected = -not $Options[$idx].Selected
2026-01-11T19:28:13.4984857Z                                  }
2026-01-11T19:28:13.4985598Z                              }
2026-01-11T19:28:13.4986118Z                              elseif ($choice -eq 'A' -or $choice -eq 'a') {
2026-01-11T19:28:13.4987164Z                                  for ($i = 0; $i -lt $Options.Count; $i++) {
2026-01-11T19:28:13.4988207Z                                      if (-not $Options[$i].Disabled) {
2026-01-11T19:28:13.4988415Z                                          $Options[$i].Selected = $true
2026-01-11T19:28:13.4988556Z                                      }
2026-01-11T19:28:13.4989611Z                                  }
2026-01-11T19:28:13.4989717Z                              }
2026-01-11T19:28:13.4991113Z                              elseif ($choice -eq 'N' -or $choice -eq 'n') {
2026-01-11T19:28:13.4991315Z                                  for ($i = 0; $i -lt $Options.Count; $i++) {
2026-01-11T19:28:13.4992334Z                                      $Options[$i].Selected = $false
2026-01-11T19:28:13.4992456Z                                  }
2026-01-11T19:28:13.4993634Z                              }
2026-01-11T19:28:13.4993860Z                              elseif ($choice -eq 'R' -or $choice -eq 'r') {
2026-01-11T19:28:13.4995088Z                                  for ($i = 0; $i -lt $Options.Count; $i++) {
2026-01-11T19:28:13.4995603Z                                      $Options[$i].Selected = ($Options[$i].Icon -eq "[*]")
2026-01-11T19:28:13.4996444Z                                  }
2026-01-11T19:28:13.4997237Z                              }
2026-01-11T19:28:13.4997958Z                              elseif ($choice -eq '') {
2026-01-11T19:28:13.4998733Z                                  break
2026-01-11T19:28:13.4999826Z                              }
2026-01-11T19:28:13.5000656Z                      
2026-01-11T19:28:13.5000942Z                          } while ($true)
2026-01-11T19:28:13.5001992Z                      
2026-01-11T19:28:13.5002513Z                          $selectedIndices = @()
2026-01-11T19:28:13.5003249Z                          for ($i = 0; $i -lt $Options.Count; $i++) {
2026-01-11T19:28:13.5004365Z                              if ($Options[$i].Selected) {
2026-01-11T19:28:13.5004539Z                                  $selectedIndices += $i
2026-01-11T19:28:13.5005581Z                              }
2026-01-11T19:28:13.5005705Z                          }
2026-01-11T19:28:13.5006704Z                      
2026-01-11T19:28:13.5007192Z                          return $selectedIndices
2026-01-11T19:28:13.5008444Z                      }
2026-01-11T19:28:13.5008548Z                      
2026-01-11T19:28:13.5009689Z                      function Show-CategoryMenu {
2026-01-11T19:28:13.5009795Z                          <#
2026-01-11T19:28:13.5011528Z                          .SYNOPSIS
2026-01-11T19:28:13.5011715Z                              Presents a category selection menu.
2026-01-11T19:28:13.5011861Z                          .DESCRIPTION
2026-01-11T19:28:13.5013344Z                              Converts category metadata into menu options and returns the selected
2026-01-11T19:28:13.5013474Z                              category keys in the original hash order.
2026-01-11T19:28:13.5014576Z                          .PARAMETER Categories
2026-01-11T19:28:13.5015229Z                              Hashtable of category definitions with Icon/ItemCount/Recommended metadata.
2026-01-11T19:28:13.5015605Z                          .OUTPUTS
2026-01-11T19:28:13.5016709Z                              [string[]] Selected category keys.
2026-01-11T19:28:13.5017138Z                          #>
2026-01-11T19:28:13.5017587Z                      
2026-01-11T19:28:13.5018417Z                          [CmdletBinding()]
2026-01-11T19:28:13.5019167Z                          param(
2026-01-11T19:28:13.5019638Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5020393Z                              [hashtable]$Categories
2026-01-11T19:28:13.5021356Z                          )
2026-01-11T19:28:13.5021459Z                      
2026-01-11T19:28:13.5023054Z                          $options = @()
2026-01-11T19:28:13.5023187Z                          $index = 0
2026-01-11T19:28:13.5023649Z                          foreach ($key in $Categories.Keys) {
2026-01-11T19:28:13.5024004Z                              $cat = $Categories[$key]
2026-01-11T19:28:13.5025040Z                              $options += @{
2026-01-11T19:28:13.5025208Z                                  Label = "$($cat.Icon) $key"
2026-01-11T19:28:13.5026486Z                                  Selected = $true
2026-01-11T19:28:13.5026872Z                                  Description = "$($cat.ItemCount) items ($($cat.Recommended) recommended)"
2026-01-11T19:28:13.5027205Z                                  Icon = ""
2026-01-11T19:28:13.5027620Z                              }
2026-01-11T19:28:13.5028998Z                              $index++
2026-01-11T19:28:13.5029460Z                          }
2026-01-11T19:28:13.5030368Z                      
2026-01-11T19:28:13.5031151Z                          $selectedIndices = Show-Menu -Title "SELECT CATEGORIES" -Options $options -AllowMultiple $true
2026-01-11T19:28:13.5031811Z                      
2026-01-11T19:28:13.5033331Z                          $categoryKeys = @($Categories.Keys)
2026-01-11T19:28:13.5033468Z                          $selectedCategories = @()
2026-01-11T19:28:13.5033629Z                          foreach ($idx in $selectedIndices) {
2026-01-11T19:28:13.5033863Z                              $selectedCategories += $categoryKeys[$idx]
2026-01-11T19:28:13.5035032Z                          }
2026-01-11T19:28:13.5035152Z                      
2026-01-11T19:28:13.5036233Z                          return $selectedCategories
2026-01-11T19:28:13.5036514Z                      }
2026-01-11T19:28:13.5037489Z                      
2026-01-11T19:28:13.5038242Z                      function Get-UserChoice {
2026-01-11T19:28:13.5039049Z                          <#
2026-01-11T19:28:13.5039175Z                          .SYNOPSIS
2026-01-11T19:28:13.5040577Z                              Prompts for a single validated choice.
2026-01-11T19:28:13.5041023Z                          .DESCRIPTION
2026-01-11T19:28:13.5042227Z                              Loops until the user enters one of the allowed choices, optionally
2026-01-11T19:28:13.5042453Z                              accepting a default when Enter is pressed.
2026-01-11T19:28:13.5043529Z                          .PARAMETER Prompt
2026-01-11T19:28:13.5043701Z                              Prompt text shown to the user.
2026-01-11T19:28:13.5044461Z                          .PARAMETER ValidChoices
2026-01-11T19:28:13.5045500Z                              Array of allowed choices (strings).
2026-01-11T19:28:13.5045917Z                          .PARAMETER DefaultChoice
2026-01-11T19:28:13.5047116Z                              Optional default choice when user presses Enter.
2026-01-11T19:28:13.5047259Z                          .OUTPUTS
2026-01-11T19:28:13.5048251Z                              [string] Selected choice.
2026-01-11T19:28:13.5048436Z                          #>
2026-01-11T19:28:13.5049542Z                      
2026-01-11T19:28:13.5049692Z                          [CmdletBinding()]
2026-01-11T19:28:13.5050810Z                          param(
2026-01-11T19:28:13.5051436Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5051622Z                              [string]$Prompt,
2026-01-11T19:28:13.5052329Z                      
2026-01-11T19:28:13.5053372Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5053526Z                              [array]$ValidChoices,
2026-01-11T19:28:13.5054648Z                      
2026-01-11T19:28:13.5054820Z                              [string]$DefaultChoice = ""
2026-01-11T19:28:13.5055755Z                          )
2026-01-11T19:28:13.5055865Z                      
2026-01-11T19:28:13.5057144Z                          do {
2026-01-11T19:28:13.5057932Z                              $validString = $ValidChoices -join '/'
2026-01-11T19:28:13.5058401Z                              if ($DefaultChoice) {
2026-01-11T19:28:13.5059303Z                                  $fullPrompt = "$Prompt [$validString, default=$DefaultChoice]"
2026-01-11T19:28:13.5060367Z                              } else {
2026-01-11T19:28:13.5060585Z                                  $fullPrompt = "$Prompt [$validString]"
2026-01-11T19:28:13.5061519Z                              }
2026-01-11T19:28:13.5061620Z                      
2026-01-11T19:28:13.5062955Z                              $choice = Read-Host $fullPrompt
2026-01-11T19:28:13.5063340Z                      
2026-01-11T19:28:13.5064311Z                              if ($choice -eq '' -and $DefaultChoice) {
2026-01-11T19:28:13.5064482Z                                  $choice = $DefaultChoice
2026-01-11T19:28:13.5065659Z                              }
2026-01-11T19:28:13.5065761Z                      
2026-01-11T19:28:13.5066844Z                              if ($ValidChoices -contains $choice) {
2026-01-11T19:28:13.5067229Z                                  return $choice
2026-01-11T19:28:13.5068028Z                              }
2026-01-11T19:28:13.5068510Z                      
2026-01-11T19:28:13.5069885Z                              Write-Host "Invalid choice. Please select from: $validString" -ForegroundColor Red
2026-01-11T19:28:13.5070023Z                      
2026-01-11T19:28:13.5071091Z                          } while ($true)
2026-01-11T19:28:13.5072060Z                      }
2026-01-11T19:28:13.5072157Z                      
2026-01-11T19:28:13.5073366Z                      function Show-Summary {
2026-01-11T19:28:13.5073739Z                          <#
2026-01-11T19:28:13.5074560Z                          .SYNOPSIS
2026-01-11T19:28:13.5075380Z                              Displays a configuration summary.
2026-01-11T19:28:13.5075759Z                          .DESCRIPTION
2026-01-11T19:28:13.5076906Z                              Prints a categorized view of the selected configuration with simple
2026-01-11T19:28:13.5077368Z                              YES/NO mapping for boolean values.
2026-01-11T19:28:13.5078493Z                          .PARAMETER Title
2026-01-11T19:28:13.5078640Z                              Summary header text.
2026-01-11T19:28:13.5080093Z                          .PARAMETER Config
2026-01-11T19:28:13.5080329Z                              Hashtable of configuration values to display.
2026-01-11T19:28:13.5081032Z                          .OUTPUTS
2026-01-11T19:28:13.5081145Z                              None.
2026-01-11T19:28:13.5081444Z                          #>
2026-01-11T19:28:13.5082536Z                      
2026-01-11T19:28:13.5083026Z                          [CmdletBinding()]
2026-01-11T19:28:13.5083998Z                          param(
2026-01-11T19:28:13.5084183Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5085165Z                              [string]$Title,
2026-01-11T19:28:13.5085581Z                      
2026-01-11T19:28:13.5086419Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5087266Z                              [hashtable]$Config
2026-01-11T19:28:13.5087971Z                          )
2026-01-11T19:28:13.5088488Z                      
2026-01-11T19:28:13.5089374Z                          Clear-Host
2026-01-11T19:28:13.5090301Z                          Write-Host "??????????????????????????????????????????????????????????????????????????????????
2026-01-11T19:28:13.5090612Z                      ??????????????????????????????????????????????????????????????????????????????????????????????????
2026-01-11T19:28:13.5091401Z                      ?????????" -ForegroundColor Cyan
2026-01-11T19:28:13.5092408Z                          Write-Host "    $Title" -ForegroundColor Cyan
2026-01-11T19:28:13.5094796Z                          Write-Host "??????????????????????????????????????????????????????????????????????????????????
2026-01-11T19:28:13.5095071Z                      ??????????????????????????????????????????????????????????????????????????????????????????????????
2026-01-11T19:28:13.5095240Z                      ?????????" -ForegroundColor Cyan
2026-01-11T19:28:13.5095351Z                          Write-Host ""
2026-01-11T19:28:13.5095433Z                      
2026-01-11T19:28:13.5096532Z                          foreach ($category in $Config.Keys | Sort-Object) {
2026-01-11T19:28:13.5096768Z                              Write-Host "${category}:" -ForegroundColor Yellow
2026-01-11T19:28:13.5097188Z                              $items = $Config[$category]
2026-01-11T19:28:13.5098053Z                      
2026-01-11T19:28:13.5098573Z                              if ($items -is [hashtable]) {
2026-01-11T19:28:13.5099266Z                                  foreach ($key in $items.Keys | Sort-Object) {
2026-01-11T19:28:13.5100162Z                                      $value = $items[$key]
2026-01-11T19:28:13.5101334Z                                      $status = if ($value -eq $true) { "YES" } elseif ($value -eq $false) { "NO" } 
2026-01-11T19:28:13.5101433Z                      else { $value }
2026-01-11T19:28:13.5102673Z                                      Write-Host "  $key : $status" -ForegroundColor White
2026-01-11T19:28:13.5102980Z                                  }
2026-01-11T19:28:13.5104120Z                              } elseif ($items -is [array]) {
2026-01-11T19:28:13.5104278Z                                  foreach ($item in $items) {
2026-01-11T19:28:13.5105034Z                                      Write-Host "  - $item" -ForegroundColor White
2026-01-11T19:28:13.5105879Z                                  }
2026-01-11T19:28:13.5106012Z                              } else {
2026-01-11T19:28:13.5107149Z                                  Write-Host "  $items" -ForegroundColor White
2026-01-11T19:28:13.5107259Z                              }
2026-01-11T19:28:13.5108382Z                      
2026-01-11T19:28:13.5108982Z                              Write-Host ""
2026-01-11T19:28:13.5109137Z                          }
2026-01-11T19:28:13.5109405Z                      
2026-01-11T19:28:13.5110970Z                          Write-Host "??????????????????????????????????????????????????????????????????????????????????
2026-01-11T19:28:13.5111272Z                      ??????????????????????????????????????????????????????????????????????????????????????????????????
2026-01-11T19:28:13.5112115Z                      ?????????" -ForegroundColor Cyan
2026-01-11T19:28:13.5112997Z                      }
2026-01-11T19:28:13.5113103Z                      
2026-01-11T19:28:13.5114419Z                      function Show-Welcome {
2026-01-11T19:28:13.5114920Z                          <#
2026-01-11T19:28:13.5115524Z                          .SYNOPSIS
2026-01-11T19:28:13.5115758Z                              Shows the interactive setup welcome screen.
2026-01-11T19:28:13.5116694Z                          .DESCRIPTION
2026-01-11T19:28:13.5118055Z                              Prints a banner and optional system information for user context.
2026-01-11T19:28:13.5118184Z                          .PARAMETER SystemInfo
2026-01-11T19:28:13.5119280Z                              Hashtable of system key/value pairs to display.
2026-01-11T19:28:13.5119663Z                          .OUTPUTS
2026-01-11T19:28:13.5120715Z                              None.
2026-01-11T19:28:13.5121450Z                          #>
2026-01-11T19:28:13.5122592Z                      
2026-01-11T19:28:13.5123417Z                          [CmdletBinding()]
2026-01-11T19:28:13.5123918Z                          param(
2026-01-11T19:28:13.5124868Z                              [hashtable]$SystemInfo = @{}
2026-01-11T19:28:13.5124984Z                          )
2026-01-11T19:28:13.5127077Z                      
2026-01-11T19:28:13.5127223Z                          Clear-Host
2026-01-11T19:28:13.5127586Z                          Write-Host ""
2026-01-11T19:28:13.5128963Z                          Write-Host "??\u0022??????????????????????????????????????????????????????????????????????????
2026-01-11T19:28:13.5129233Z                      ??????????????????????????????????????????????????????????????????????????????????????????????????
2026-01-11T19:28:13.5129534Z                      ?????????????????????????????????????????????????????????????????" -ForegroundColor Cyan
2026-01-11T19:28:13.5131043Z                          Write-Host "???                                                                              
2026-01-11T19:28:13.5131201Z                      ???" -ForegroundColor Cyan
2026-01-11T19:28:13.5132506Z                          Write-Host "???              GAMING PC SETUP - INTERACTIVE CONFIGURATION                     
2026-01-11T19:28:13.5132663Z                      ???" -ForegroundColor Cyan
2026-01-11T19:28:13.5134325Z                          Write-Host "???                                                                              
2026-01-11T19:28:13.5134495Z                      ???" -ForegroundColor Cyan
2026-01-11T19:28:13.5135897Z                          Write-Host "??????????????????????????????????????????????????????????????????????????????????
2026-01-11T19:28:13.5136794Z                      ??????????????????????????????????????????????????????????????????????????????????????????????????
2026-01-11T19:28:13.5137046Z                      ????????????????????????????????????????????????????????????" -ForegroundColor Cyan
2026-01-11T19:28:13.5137211Z                          Write-Host ""
2026-01-11T19:28:13.5138656Z                          Write-Host "Welcome! This wizard will optimize your Windows system for gaming." 
2026-01-11T19:28:13.5138790Z                      -ForegroundColor White
2026-01-11T19:28:13.5138904Z                          Write-Host ""
2026-01-11T19:28:13.5139841Z                      
2026-01-11T19:28:13.5140791Z                          if ($SystemInfo.Count -gt 0) {
2026-01-11T19:28:13.5141069Z                              Write-Host "System Information:" -ForegroundColor Yellow
2026-01-11T19:28:13.5142092Z                              foreach ($key in $SystemInfo.Keys) {
2026-01-11T19:28:13.5142526Z                                  Write-Host "  $key : $($SystemInfo[$key])" -ForegroundColor White
2026-01-11T19:28:13.5142690Z                              }
2026-01-11T19:28:13.5143745Z                              Write-Host ""
2026-01-11T19:28:13.5143850Z                          }
2026-01-11T19:28:13.5145025Z                      }
2026-01-11T19:28:13.5145773Z                      
2026-01-11T19:28:13.5146687Z                      function Show-SetupModeSelection {
2026-01-11T19:28:13.5146977Z                          <#
2026-01-11T19:28:13.5148002Z                          .SYNOPSIS
2026-01-11T19:28:13.5148743Z                              Presents the setup mode selection menu.
2026-01-11T19:28:13.5149955Z                          .DESCRIPTION
2026-01-11T19:28:13.5150282Z                              Lets the user choose between express, custom, or profile-based setup,
2026-01-11T19:28:13.5151500Z                              or exit the wizard.
2026-01-11T19:28:13.5152048Z                      
2026-01-11T19:28:13.5152518Z                              AUTOMATION MODE
2026-01-11T19:28:13.5153540Z                              ===============
2026-01-11T19:28:13.5154666Z                              When the environment variable ROCKTUNE_SETUP_MODE is set, this function
2026-01-11T19:28:13.5155014Z                              bypasses the interactive menu and returns the specified mode directly:
2026-01-11T19:28:13.5155441Z                      
2026-01-11T19:28:13.5156646Z                              - "express"  : Express Setup - uses proven defaults, best for most users
2026-01-11T19:28:13.5156973Z                              - "custom"   : Custom Setup - select each optimization individually
2026-01-11T19:28:13.5157873Z                              - "profile"  : Load Profile - use pre-made competitive/balanced/privacy configurations
2026-01-11T19:28:13.5158152Z                              - "exit"     : Exit the wizard without making changes
2026-01-11T19:28:13.5158606Z                      
2026-01-11T19:28:13.5159060Z                              This is useful for:
2026-01-11T19:28:13.5160334Z                              - CI/CD pipelines that need deterministic, non-interactive execution
2026-01-11T19:28:13.5160575Z                              - Automated testing of specific setup modes
2026-01-11T19:28:13.5161399Z                              - Scripted deployments with pre-determined configurations
2026-01-11T19:28:13.5162428Z                              - Remote execution where interactive prompts would block
2026-01-11T19:28:13.5162758Z                      
2026-01-11T19:28:13.5163818Z                              Example:
2026-01-11T19:28:13.5164653Z                                  $env:ROCKTUNE_SETUP_MODE = "express"
2026-01-11T19:28:13.5165185Z                                  $mode = Show-SetupModeSelection
2026-01-11T19:28:13.5166101Z                                  # Returns "express" without prompting
2026-01-11T19:28:13.5166786Z                      
2026-01-11T19:28:13.5168182Z                              Note: For full automation, combine with ROCKTUNE_MENU_MODE and the
2026-01-11T19:28:13.5168450Z                              -SkipConfirmation parameter on the main script:
2026-01-11T19:28:13.5168583Z                      
2026-01-11T19:28:13.5169792Z                                  $env:ROCKTUNE_SETUP_MODE = "express"
2026-01-11T19:28:13.5170246Z                                  $env:ROCKTUNE_MENU_MODE = "recommended"
2026-01-11T19:28:13.5171393Z                                  .\gaming-pc-setup.ps1 -SkipConfirmation
2026-01-11T19:28:13.5171523Z                      
2026-01-11T19:28:13.5172504Z                          .OUTPUTS
2026-01-11T19:28:13.5173687Z                              [string] One of: express, custom, profile, exit.
2026-01-11T19:28:13.5173788Z                          #>
2026-01-11T19:28:13.5174679Z                      
2026-01-11T19:28:13.5175365Z                          # -------------------------------------------------------------------------
2026-01-11T19:28:13.5175687Z                          # AUTOMATION MODE CHECK
2026-01-11T19:28:13.5176983Z                          # -------------------------------------------------------------------------
2026-01-11T19:28:13.5177240Z                          # Check if ROCKTUNE_SETUP_MODE environment variable is set. If so, we
2026-01-11T19:28:13.5178352Z                          # return the specified mode directly without displaying the menu or
2026-01-11T19:28:13.5178529Z                          # prompting for input.
2026-01-11T19:28:13.5179268Z                          #
2026-01-11T19:28:13.5179693Z                          # Why check first?
2026-01-11T19:28:13.5181021Z                          # - Avoids Clear-Host which would disrupt CI/CD log output
2026-01-11T19:28:13.5181280Z                          # - Returns immediately for faster automated execution
2026-01-11T19:28:13.5182491Z                          # - Provides clear feedback about what mode was auto-selected
2026-01-11T19:28:13.5182590Z                          #
2026-01-11T19:28:13.5183400Z                          # Valid modes match the return values of the interactive menu:
2026-01-11T19:28:13.5184563Z                          # - express  : Maps to menu choice "1" (Express Setup)
2026-01-11T19:28:13.5184776Z                          # - custom   : Maps to menu choice "2" (Custom Setup)
2026-01-11T19:28:13.5185928Z                          # - profile  : Maps to menu choice "3" (Load Profile)
2026-01-11T19:28:13.5186127Z                          # - exit     : Maps to menu choice "4" (Exit)
2026-01-11T19:28:13.5187343Z                          #
2026-01-11T19:28:13.5188001Z                          # Invalid values trigger a warning and fall through to interactive mode.
2026-01-11T19:28:13.5188364Z                          # This is intentional - we don't want automation to silently fail.
2026-01-11T19:28:13.5188787Z                          # -------------------------------------------------------------------------
2026-01-11T19:28:13.5189956Z                          $setupMode = $env:ROCKTUNE_SETUP_MODE
2026-01-11T19:28:13.5190117Z                          if ($setupMode) {
2026-01-11T19:28:13.5191308Z                              # Normalize to lowercase for case-insensitive comparison
2026-01-11T19:28:13.5191500Z                              $setupMode = $setupMode.ToLower()
2026-01-11T19:28:13.5192483Z                      
2026-01-11T19:28:13.5192963Z                              $validModes = @('express', 'custom', 'profile', 'exit')
2026-01-11T19:28:13.5194162Z                              if ($validModes -contains $setupMode) {
2026-01-11T19:28:13.5194448Z                                  # Log the auto-selection for transparency in CI logs
2026-01-11T19:28:13.5195751Z                                  Write-Host "[AUTO] Setup mode: $setupMode (ROCKTUNE_SETUP_MODE env var)" 
2026-01-11T19:28:13.5196148Z                      -ForegroundColor Cyan
2026-01-11T19:28:13.5196320Z                                  return $setupMode
2026-01-11T19:28:13.5197513Z                              } else {
2026-01-11T19:28:13.5198226Z                                  # Invalid mode specified - warn and fall through to interactive
2026-01-11T19:28:13.5199545Z                                  Write-Host "[WARN] Unknown ROCKTUNE_SETUP_MODE='$setupMode'. Valid: express, custom, 
2026-01-11T19:28:13.5199722Z                      profile, exit" -ForegroundColor Yellow
2026-01-11T19:28:13.5200897Z                                  Write-Host "[WARN] Falling back to interactive mode." -ForegroundColor Yellow
2026-01-11T19:28:13.5201011Z                              }
2026-01-11T19:28:13.5201425Z                          }
2026-01-11T19:28:13.5202140Z                      
2026-01-11T19:28:13.5203280Z                          # -------------------------------------------------------------------------
2026-01-11T19:28:13.5203399Z                          # INTERACTIVE MODE
2026-01-11T19:28:13.5204638Z                          # -------------------------------------------------------------------------
2026-01-11T19:28:13.5204995Z                          # If ROCKTUNE_SETUP_MODE is not set (or was invalid), display the menu
2026-01-11T19:28:13.5205398Z                          # and prompt for user input as normal.
2026-01-11T19:28:13.5206422Z                          # -------------------------------------------------------------------------
2026-01-11T19:28:13.5206871Z                      
2026-01-11T19:28:13.5208196Z                          Clear-Host
2026-01-11T19:28:13.5209199Z                          Write-Host "??????????????????????????????????????????????????????????????????????????????????
2026-01-11T19:28:13.5209442Z                      ??????????????????????????????????????????????????????????????????????????????????????????????????
2026-01-11T19:28:13.5210537Z                      ?????????" -ForegroundColor Cyan
2026-01-11T19:28:13.5210843Z                          Write-Host "    SETUP MODE SELECTION" -ForegroundColor Cyan
2026-01-11T19:28:13.5212192Z                          Write-Host "??????????????????????????????????????????????????????????????????????????????????
2026-01-11T19:28:13.5212466Z                      ??????????????????????????????????????????????????????????????????????????????????????????????????
2026-01-11T19:28:13.5212881Z                      ?????????" -ForegroundColor Cyan
2026-01-11T19:28:13.5213630Z                          Write-Host ""
2026-01-11T19:28:13.5214640Z                          Write-Host "Choose your setup mode:" -ForegroundColor Yellow
2026-01-11T19:28:13.5215729Z                          Write-Host ""
2026-01-11T19:28:13.5216240Z                          Write-Host "  1) Express Setup (Recommended)" -ForegroundColor Green
2026-01-11T19:28:13.5216848Z                          Write-Host "     - Uses proven defaults" -ForegroundColor DarkGray
2026-01-11T19:28:13.5217157Z                          Write-Host "     - ~5 minutes setup time" -ForegroundColor DarkGray
2026-01-11T19:28:13.5218115Z                          Write-Host "     - Best for most users" -ForegroundColor DarkGray
2026-01-11T19:28:13.5218449Z                          Write-Host ""
2026-01-11T19:28:13.5219920Z                          Write-Host "  2) Custom Setup (Advanced)" -ForegroundColor Yellow
2026-01-11T19:28:13.5220170Z                          Write-Host "     - Select each optimization individually" -ForegroundColor DarkGray
2026-01-11T19:28:13.5220729Z                          Write-Host "     - ~15 minutes setup time" -ForegroundColor DarkGray
2026-01-11T19:28:13.5221308Z                          Write-Host "     - Full control over every setting" -ForegroundColor DarkGray
2026-01-11T19:28:13.5221463Z                          Write-Host ""
2026-01-11T19:28:13.5222443Z                          Write-Host "  3) Load Profile" -ForegroundColor Cyan
2026-01-11T19:28:13.5223009Z                          Write-Host "     - Pre-made configurations" -ForegroundColor DarkGray
2026-01-11T19:28:13.5224112Z                          Write-Host "     - Competitive / Balanced / Privacy-Focused" -ForegroundColor DarkGray
2026-01-11T19:28:13.5224283Z                          Write-Host ""
2026-01-11T19:28:13.5225538Z                          Write-Host "  4) Exit" -ForegroundColor Red
2026-01-11T19:28:13.5225660Z                          Write-Host ""
2026-01-11T19:28:13.5226645Z                      
2026-01-11T19:28:13.5228131Z                          $choice = Get-UserChoice -Prompt "Your choice" -ValidChoices @('1', '2', '3', '4') 
2026-01-11T19:28:13.5228255Z                      -DefaultChoice '1'
2026-01-11T19:28:13.5229093Z                      
2026-01-11T19:28:13.5229238Z                          switch ($choice) {
2026-01-11T19:28:13.5230087Z                              '1' { return "express" }
2026-01-11T19:28:13.5231288Z                              '2' { return "custom" }
2026-01-11T19:28:13.5231479Z                              '3' { return "profile" }
2026-01-11T19:28:13.5232366Z                              '4' { return "exit" }
2026-01-11T19:28:13.5232512Z                          }
2026-01-11T19:28:13.5233431Z                      }
2026-01-11T19:28:13.5233551Z                      
2026-01-11T19:28:13.5234263Z                      
2026-01-11T19:28:13.5235405Z                      Export-ModuleMember -Function @(
2026-01-11T19:28:13.5235612Z                          'Show-Menu',
2026-01-11T19:28:13.5236964Z                          'Show-CategoryMenu',
2026-01-11T19:28:13.5237101Z                          'Get-UserChoice',
2026-01-11T19:28:13.5237993Z                          'Show-Summary',
2026-01-11T19:28:13.5238127Z                          'Show-Welcome',
2026-01-11T19:28:13.5239146Z                          'Show-SetupModeSelection'
2026-01-11T19:28:13.5239915Z                      )
2026-01-11T19:28:13.5241043Z                      
2026-01-11T19:28:13.5241494Z                      
2026-01-11T19:28:13.5242846Z [32;1mParent             : [0m
2026-01-11T19:28:13.5242861Z 
2026-01-11T19:28:13.5285283Z [32;1mAttributes         : [0m{}
2026-01-11T19:28:13.5285508Z [32;1mUsingStatements    : [0m{}
2026-01-11T19:28:13.5286831Z [32;1mParamBlock         : [0m
2026-01-11T19:28:13.5287831Z [32;1mBeginBlock         : [0m
2026-01-11T19:28:13.5288941Z [32;1mProcessBlock       : [0m
2026-01-11T19:28:13.5291512Z [32;1mEndBlock           : [0mImport-Module (Join-Path $PSScriptRoot "logger.psm1") -Force
2026-01-11T19:28:13.5291631Z                      
2026-01-11T19:28:13.5292233Z                      $script:RegistryBackupIndexPath = Join-Path $PSScriptRoot "..\..\config\registry-backups.json"
2026-01-11T19:28:13.5292741Z                      $script:RegistryBackupIndex = $null
2026-01-11T19:28:13.5293735Z                      
2026-01-11T19:28:13.5294549Z                      function Get-RegistryBackupIndex {
2026-01-11T19:28:13.5295155Z                          if ($null -ne $script:RegistryBackupIndex) {
2026-01-11T19:28:13.5295973Z                              return $script:RegistryBackupIndex
2026-01-11T19:28:13.5296854Z                          }
2026-01-11T19:28:13.5296958Z                      
2026-01-11T19:28:13.5298489Z                          if (-not (Test-Path $script:RegistryBackupIndexPath)) {
2026-01-11T19:28:13.5298682Z                              $script:RegistryBackupIndex = @{}
2026-01-11T19:28:13.5299268Z                              return $script:RegistryBackupIndex
2026-01-11T19:28:13.5300047Z                          }
2026-01-11T19:28:13.5300152Z                      
2026-01-11T19:28:13.5301468Z                          try {
2026-01-11T19:28:13.5301889Z                              $json = Get-Content $script:RegistryBackupIndexPath -Raw | ConvertFrom-Json
2026-01-11T19:28:13.5302727Z                              $index = @{}
2026-01-11T19:28:13.5303587Z                              if ($null -ne $json) {
2026-01-11T19:28:13.5304345Z                                  foreach ($property in $json.PSObject.Properties) {
2026-01-11T19:28:13.5305599Z                                      $index[$property.Name] = $property.Value
2026-01-11T19:28:13.5305965Z                                  }
2026-01-11T19:28:13.5307213Z                              }
2026-01-11T19:28:13.5308241Z                              $script:RegistryBackupIndex = $index
2026-01-11T19:28:13.5308684Z                              return $script:RegistryBackupIndex
2026-01-11T19:28:13.5309641Z                          } catch {
2026-01-11T19:28:13.5310446Z                              Write-Log "Failed to load registry backup index: $_" "WARNING"
2026-01-11T19:28:13.5311552Z                              $script:RegistryBackupIndex = @{}
2026-01-11T19:28:13.5311890Z                              return $script:RegistryBackupIndex
2026-01-11T19:28:13.5312865Z                          }
2026-01-11T19:28:13.5313761Z                      }
2026-01-11T19:28:13.5314223Z                      
2026-01-11T19:28:13.5315215Z                      function Save-RegistryBackupIndex {
2026-01-11T19:28:13.5316513Z                          if ($null -eq $script:RegistryBackupIndex) {
2026-01-11T19:28:13.5316652Z                              return
2026-01-11T19:28:13.5317279Z                          }
2026-01-11T19:28:13.5318086Z                      
2026-01-11T19:28:13.5318952Z                          try {
2026-01-11T19:28:13.5320394Z                              $indexDir = Split-Path $script:RegistryBackupIndexPath -Parent
2026-01-11T19:28:13.5320656Z                              if ($indexDir -and -not (Test-Path $indexDir)) {
2026-01-11T19:28:13.5321290Z                                  New-Item -ItemType Directory -Path $indexDir -Force | Out-Null
2026-01-11T19:28:13.5322138Z                              }
2026-01-11T19:28:13.5322264Z                      
2026-01-11T19:28:13.5323634Z                              $json = $script:RegistryBackupIndex | ConvertTo-Json -Depth 6
2026-01-11T19:28:13.5324182Z                              Set-Content -Path $script:RegistryBackupIndexPath -Value $json -Force
2026-01-11T19:28:13.5324919Z                          } catch {
2026-01-11T19:28:13.5326142Z                              Write-Log "Failed to save registry backup index: $_" "WARNING"
2026-01-11T19:28:13.5326249Z                          }
2026-01-11T19:28:13.5327338Z                      }
2026-01-11T19:28:13.5328129Z                      
2026-01-11T19:28:13.5328822Z                      function Register-RegistryBackup {
2026-01-11T19:28:13.5330021Z                          [CmdletBinding()]
2026-01-11T19:28:13.5330151Z                          param(
2026-01-11T19:28:13.5331653Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5331845Z                              [string]$Path,
2026-01-11T19:28:13.5332198Z                      
2026-01-11T19:28:13.5333278Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5334210Z                              [string]$BackupPath,
2026-01-11T19:28:13.5334854Z                      
2026-01-11T19:28:13.5336070Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5336251Z                              [string]$BackupDir
2026-01-11T19:28:13.5337288Z                          )
2026-01-11T19:28:13.5337407Z                      
2026-01-11T19:28:13.5338642Z                          $index = Get-RegistryBackupIndex
2026-01-11T19:28:13.5338784Z                          $index[$Path] = @{
2026-01-11T19:28:13.5340014Z                              LastBackup = $BackupPath
2026-01-11T19:28:13.5340168Z                              BackupDir = $BackupDir
2026-01-11T19:28:13.5341510Z                              UpdatedAt = (Get-Date).ToString('o')
2026-01-11T19:28:13.5341599Z                          }
2026-01-11T19:28:13.5342776Z                      
2026-01-11T19:28:13.5342992Z                          $script:RegistryBackupIndex = $index
2026-01-11T19:28:13.5343653Z                          Save-RegistryBackupIndex
2026-01-11T19:28:13.5344487Z                      }
2026-01-11T19:28:13.5344617Z                      
2026-01-11T19:28:13.5345578Z                      function Resolve-RegistryBackupPath {
2026-01-11T19:28:13.5346675Z                          [CmdletBinding()]
2026-01-11T19:28:13.5347924Z                          param(
2026-01-11T19:28:13.5348099Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5349405Z                              [string]$Path,
2026-01-11T19:28:13.5349515Z                      
2026-01-11T19:28:13.5350345Z                              [string]$BackupDir = $null
2026-01-11T19:28:13.5350670Z                          )
2026-01-11T19:28:13.5351791Z                      
2026-01-11T19:28:13.5351974Z                          $index = Get-RegistryBackupIndex
2026-01-11T19:28:13.5353014Z                          if ($index.ContainsKey($Path)) {
2026-01-11T19:28:13.5353854Z                              $entry = $index[$Path]
2026-01-11T19:28:13.5354812Z                              if ($entry.LastBackup -and (Test-Path $entry.LastBackup)) {
2026-01-11T19:28:13.5355356Z                                  return $entry.LastBackup
2026-01-11T19:28:13.5356051Z                              }
2026-01-11T19:28:13.5356932Z                              if (-not $BackupDir -and $entry.BackupDir) {
2026-01-11T19:28:13.5357679Z                                  $BackupDir = $entry.BackupDir
2026-01-11T19:28:13.5358615Z                              }
2026-01-11T19:28:13.5359429Z                          }
2026-01-11T19:28:13.5359817Z                      
2026-01-11T19:28:13.5360748Z                          if (-not $BackupDir) {
2026-01-11T19:28:13.5361836Z                              $BackupDir = "$env:TEMP\RegistryBackup"
2026-01-11T19:28:13.5361958Z                          }
2026-01-11T19:28:13.5362560Z                      
2026-01-11T19:28:13.5362938Z                          if (-not (Test-Path $BackupDir)) {
2026-01-11T19:28:13.5363949Z                              return $null
2026-01-11T19:28:13.5364062Z                          }
2026-01-11T19:28:13.5365691Z                      
2026-01-11T19:28:13.5365931Z                          $safeName = $Path.Replace('\', '_').Replace(':', '')
2026-01-11T19:28:13.5366657Z                          $backup = Get-ChildItem -Path $BackupDir -Filter "Backup-*$safeName.reg" -ErrorAction 
2026-01-11T19:28:13.5367789Z                      SilentlyContinue |
2026-01-11T19:28:13.5368036Z                              Sort-Object LastWriteTime -Descending |
2026-01-11T19:28:13.5369032Z                              Select-Object -First 1
2026-01-11T19:28:13.5369442Z                      
2026-01-11T19:28:13.5370508Z                          if ($backup) {
2026-01-11T19:28:13.5371030Z                              return $backup.FullName
2026-01-11T19:28:13.5371167Z                          }
2026-01-11T19:28:13.5372187Z                      
2026-01-11T19:28:13.5373000Z                          return $null
2026-01-11T19:28:13.5373760Z                      }
2026-01-11T19:28:13.5374566Z                      
2026-01-11T19:28:13.5375307Z                      
2026-01-11T19:28:13.5376460Z                      function Backup-RegistryKey {
2026-01-11T19:28:13.5376582Z                          <#
2026-01-11T19:28:13.5377788Z                          .SYNOPSIS
2026-01-11T19:28:13.5378033Z                              Exports a registry key to a .reg file for backup.
2026-01-11T19:28:13.5378975Z                          .DESCRIPTION
2026-01-11T19:28:13.5379409Z                              Uses reg.exe to export the key to a timestamped file in a backup directory.
2026-01-11T19:28:13.5380518Z                              Returns the backup file path or $false on failure.
2026-01-11T19:28:13.5380647Z                          .PARAMETER Path
2026-01-11T19:28:13.5381389Z                              Registry key path (HKLM:\ or HKCU:\).
2026-01-11T19:28:13.5381992Z                          .PARAMETER BackupDir
2026-01-11T19:28:13.5383410Z                              Directory to store .reg backups. Defaults to %TEMP%\RegistryBackup.
2026-01-11T19:28:13.5383528Z                          .OUTPUTS
2026-01-11T19:28:13.5383802Z                              [string] Backup file path on success, or [bool] $false on failure.
2026-01-11T19:28:13.5385013Z                          #>
2026-01-11T19:28:13.5385139Z                      
2026-01-11T19:28:13.5386675Z                          [CmdletBinding()]
2026-01-11T19:28:13.5386781Z                          param(
2026-01-11T19:28:13.5387659Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5388148Z                              [string]$Path,
2026-01-11T19:28:13.5388929Z                      
2026-01-11T19:28:13.5389744Z                              [string]$BackupDir = "$env:TEMP\RegistryBackup"
2026-01-11T19:28:13.5390565Z                          )
2026-01-11T19:28:13.5391261Z                      
2026-01-11T19:28:13.5392065Z                          if (-not (Test-Path $Path)) {
2026-01-11T19:28:13.5393294Z                              Write-Log "Registry path does not exist, skipping backup: $Path" "WARNING"
2026-01-11T19:28:13.5393438Z                              return $false
2026-01-11T19:28:13.5394293Z                          }
2026-01-11T19:28:13.5395215Z                      
2026-01-11T19:28:13.5395346Z                          try {
2026-01-11T19:28:13.5396691Z                              if (-not (Test-Path $BackupDir)) {
2026-01-11T19:28:13.5397281Z                                  New-Item -ItemType Directory -Path $BackupDir -Force | Out-Null
2026-01-11T19:28:13.5397420Z                              }
2026-01-11T19:28:13.5398708Z                      
2026-01-11T19:28:13.5398969Z                              $timestamp = Get-Date -Format 'yyyyMMdd-HHmmss'
2026-01-11T19:28:13.5399450Z                              $safeName = $Path.Replace('\', '_').Replace(':', '')
2026-01-11T19:28:13.5400566Z                              $backupPath = Join-Path $BackupDir "Backup-$timestamp-$safeName.reg"
2026-01-11T19:28:13.5400859Z                      
2026-01-11T19:28:13.5402169Z                              $exportPath = $Path.Replace('HKLM:\', 'HKEY_LOCAL_MACHINE\').Replace('HKCU:\', 
2026-01-11T19:28:13.5402331Z                      'HKEY_CURRENT_USER\')
2026-01-11T19:28:13.5403039Z                      
2026-01-11T19:28:13.5404015Z                              $result = reg export $exportPath $backupPath /y 2>&1
2026-01-11T19:28:13.5404627Z                      
2026-01-11T19:28:13.5405517Z                              if ($LASTEXITCODE -eq 0) {
2026-01-11T19:28:13.5407088Z                                  Write-Log "Backed up registry key: $Path -> $backupPath" "SUCCESS"
2026-01-11T19:28:13.5407428Z                                  Register-RegistryBackup -Path $Path -BackupPath $backupPath -BackupDir $BackupDir
2026-01-11T19:28:13.5407573Z                                  return $backupPath
2026-01-11T19:28:13.5408011Z                              } else {
2026-01-11T19:28:13.5416959Z                                  Write-Log "Failed to backup registry key: $Path (Exit code: $LASTEXITCODE)" "ERROR"
2026-01-11T19:28:13.5417139Z                                  return $false
2026-01-11T19:28:13.5417239Z                              }
2026-01-11T19:28:13.5417458Z                      
2026-01-11T19:28:13.5417554Z                          } catch {
2026-01-11T19:28:13.5417872Z                              Write-Log "Exception backing up registry key $Path : $_" "ERROR"
2026-01-11T19:28:13.5417989Z                              return $false
2026-01-11T19:28:13.5418077Z                          }
2026-01-11T19:28:13.5418152Z                      }
2026-01-11T19:28:13.5418246Z                      
2026-01-11T19:28:13.5418386Z                      function Restore-RegistryKey {
2026-01-11T19:28:13.5418677Z                          <#
2026-01-11T19:28:13.5418785Z                          .SYNOPSIS
2026-01-11T19:28:13.5418988Z                              Restores a registry key from a .reg backup file.
2026-01-11T19:28:13.5419100Z                          .DESCRIPTION
2026-01-11T19:28:13.5419376Z                              Uses reg.exe to import a .reg file. Logs success or failure.
2026-01-11T19:28:13.5419508Z                          .PARAMETER BackupPath
2026-01-11T19:28:13.5419692Z                              Path to the .reg file produced by Backup-RegistryKey.
2026-01-11T19:28:13.5419767Z                          .PARAMETER Path
2026-01-11T19:28:13.5420079Z                              Registry key path (HKLM:\ or HKCU:\) to resolve the latest backup.
2026-01-11T19:28:13.5420180Z                          .OUTPUTS
2026-01-11T19:28:13.5420603Z                              [bool] True on success, false on failure.
2026-01-11T19:28:13.5421402Z                          .NOTES
2026-01-11T19:28:13.5422763Z                              reg.exe writes some output to stderr even on success, so output is suppressed.
2026-01-11T19:28:13.5422877Z                          #>
2026-01-11T19:28:13.5423758Z                      
2026-01-11T19:28:13.5423911Z                          [CmdletBinding()]
2026-01-11T19:28:13.5425276Z                          param(
2026-01-11T19:28:13.5425453Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5426514Z                              [Alias('Path')]
2026-01-11T19:28:13.5427357Z                              [string]$BackupPath
2026-01-11T19:28:13.5427446Z                          )
2026-01-11T19:28:13.5428627Z                      
2026-01-11T19:28:13.5428844Z                          $resolvedBackupPath = $BackupPath
2026-01-11T19:28:13.5430062Z                          if ($BackupPath -match '^(HKLM|HKCU):\\') {
2026-01-11T19:28:13.5430736Z                              $resolvedBackupPath = Resolve-RegistryBackupPath -Path $BackupPath
2026-01-11T19:28:13.5431014Z                              if (-not $resolvedBackupPath) {
2026-01-11T19:28:13.5431591Z                                  Write-Log "No registry backup found for key: $BackupPath" "ERROR"
2026-01-11T19:28:13.5432530Z                                  return $false
2026-01-11T19:28:13.5432655Z                              }
2026-01-11T19:28:13.5433875Z                          }
2026-01-11T19:28:13.5434227Z                      
2026-01-11T19:28:13.5434754Z                          if (-not (Test-Path $resolvedBackupPath)) {
2026-01-11T19:28:13.5435944Z                              Write-Log "Backup file not found: $resolvedBackupPath" "ERROR"
2026-01-11T19:28:13.5436064Z                              return $false
2026-01-11T19:28:13.5437123Z                          }
2026-01-11T19:28:13.5437499Z                      
2026-01-11T19:28:13.5437909Z                          try {
2026-01-11T19:28:13.5438562Z                              # Suppress errors from reg.exe output (it writes success to stderr)
2026-01-11T19:28:13.5438813Z                              $null = reg import $resolvedBackupPath 2>&1
2026-01-11T19:28:13.5439591Z                      
2026-01-11T19:28:13.5440439Z                              if ($LASTEXITCODE -eq 0) {
2026-01-11T19:28:13.5441375Z                                  Write-Log "Restored registry from backup: $resolvedBackupPath" "SUCCESS"
2026-01-11T19:28:13.5441829Z                                  return $true
2026-01-11T19:28:13.5442112Z                              } else {
2026-01-11T19:28:13.5444480Z                                  Write-Log "Failed to restore registry from backup: $resolvedBackupPath (Exit code: 
2026-01-11T19:28:13.5444661Z                      $LASTEXITCODE)" "ERROR"
2026-01-11T19:28:13.5445129Z                                  return $false
2026-01-11T19:28:13.5446313Z                              }
2026-01-11T19:28:13.5446436Z                      
2026-01-11T19:28:13.5447292Z                          } catch {
2026-01-11T19:28:13.5448243Z                              if ($LASTEXITCODE -eq 0) {
2026-01-11T19:28:13.5448750Z                                  Write-Log "Restored registry from backup: $resolvedBackupPath" "SUCCESS"
2026-01-11T19:28:13.5449256Z                                  return $true
2026-01-11T19:28:13.5450092Z                              } else {
2026-01-11T19:28:13.5450677Z                                  Write-Log "Exception restoring registry from backup $resolvedBackupPath : $_" "ERROR"
2026-01-11T19:28:13.5451685Z                                  return $false
2026-01-11T19:28:13.5452138Z                              }
2026-01-11T19:28:13.5453102Z                          }
2026-01-11T19:28:13.5453221Z                      }
2026-01-11T19:28:13.5454342Z                      
2026-01-11T19:28:13.5454450Z                      
2026-01-11T19:28:13.5455914Z                      function Set-RegistryValue {
2026-01-11T19:28:13.5456046Z                          <#
2026-01-11T19:28:13.5457089Z                          .SYNOPSIS
2026-01-11T19:28:13.5457673Z                              Creates or updates a registry value with optional backup.
2026-01-11T19:28:13.5457829Z                          .DESCRIPTION
2026-01-11T19:28:13.5459268Z                              Optionally backs up the parent key, creates the key if missing, and then
2026-01-11T19:28:13.5459484Z                              writes the value using Set-ItemProperty.
2026-01-11T19:28:13.5459637Z                          .PARAMETER Path
2026-01-11T19:28:13.5460524Z                              Registry key path.
2026-01-11T19:28:13.5460664Z                          .PARAMETER Name
2026-01-11T19:28:13.5461874Z                              Registry value name.
2026-01-11T19:28:13.5462076Z                          .PARAMETER Value
2026-01-11T19:28:13.5463185Z                              Registry value data.
2026-01-11T19:28:13.5464635Z                          .PARAMETER Type
2026-01-11T19:28:13.5464848Z                              Registry value type (DWORD, String, etc).
2026-01-11T19:28:13.5466285Z                          .PARAMETER SkipBackup
2026-01-11T19:28:13.5466819Z                              When true, skips reg export before modifying the key.
2026-01-11T19:28:13.5467585Z                          .OUTPUTS
2026-01-11T19:28:13.5468470Z                              [bool] True on success, false on failure.
2026-01-11T19:28:13.5468880Z                          #>
2026-01-11T19:28:13.5469755Z                      
2026-01-11T19:28:13.5470235Z                          [CmdletBinding()]
2026-01-11T19:28:13.5471140Z                          param(
2026-01-11T19:28:13.5471320Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5472548Z                              [string]$Path,
2026-01-11T19:28:13.5472845Z                      
2026-01-11T19:28:13.5473956Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5474473Z                              [string]$Name,
2026-01-11T19:28:13.5475449Z                      
2026-01-11T19:28:13.5476089Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5477017Z                              [object]$Value,
2026-01-11T19:28:13.5477133Z                      
2026-01-11T19:28:13.5478458Z                              [string]$Type = "DWORD",
2026-01-11T19:28:13.5479317Z                      
2026-01-11T19:28:13.5479512Z                              [bool]$SkipBackup = $false
2026-01-11T19:28:13.5480300Z                          )
2026-01-11T19:28:13.5481090Z                      
2026-01-11T19:28:13.5481959Z                          try {
2026-01-11T19:28:13.5483050Z                              if (-not $SkipBackup -and (Test-Path $Path)) {
2026-01-11T19:28:13.5483588Z                                  Backup-RegistryKey -Path $Path | Out-Null
2026-01-11T19:28:13.5483904Z                              }
2026-01-11T19:28:13.5484253Z                      
2026-01-11T19:28:13.5485315Z                              if (-not (Test-Path $Path)) {
2026-01-11T19:28:13.5485864Z                                  New-Item -Path $Path -Force | Out-Null
2026-01-11T19:28:13.5486370Z                                  Write-Log "Created registry path: $Path"
2026-01-11T19:28:13.5486752Z                              }
2026-01-11T19:28:13.5487106Z                      
2026-01-11T19:28:13.5488315Z                              Set-ItemProperty -Path $Path -Name $Name -Value $Value -Type $Type -ErrorAction Stop
2026-01-11T19:28:13.5488703Z                              Write-Log "Set registry value: $Path\$Name = $Value ($Type)" "SUCCESS"
2026-01-11T19:28:13.5489148Z                              return $true
2026-01-11T19:28:13.5489495Z                      
2026-01-11T19:28:13.5490869Z                          } catch {
2026-01-11T19:28:13.5491235Z                              Write-Log "Failed to set registry value $Path\$Name : $_" "ERROR"
2026-01-11T19:28:13.5491471Z                              return $false
2026-01-11T19:28:13.5492474Z                          }
2026-01-11T19:28:13.5492879Z                      }
2026-01-11T19:28:13.5493913Z                      
2026-01-11T19:28:13.5494430Z                      function Get-RegistryValue {
2026-01-11T19:28:13.5495114Z                          <#
2026-01-11T19:28:13.5495845Z                          .SYNOPSIS
2026-01-11T19:28:13.5497039Z                              Reads a registry value with a default fallback.
2026-01-11T19:28:13.5497180Z                          .DESCRIPTION
2026-01-11T19:28:13.5498380Z                              Returns the registry value if it exists, otherwise returns DefaultValue.
2026-01-11T19:28:13.5498538Z                          .PARAMETER Path
2026-01-11T19:28:13.5499402Z                              Registry key path.
2026-01-11T19:28:13.5499610Z                          .PARAMETER Name
2026-01-11T19:28:13.5500747Z                              Registry value name.
2026-01-11T19:28:13.5501066Z                          .PARAMETER DefaultValue
2026-01-11T19:28:13.5502278Z                              Value returned when the registry value does not exist.
2026-01-11T19:28:13.5502409Z                          .OUTPUTS
2026-01-11T19:28:13.5503418Z                              [object] The stored registry data or DefaultValue.
2026-01-11T19:28:13.5503531Z                          #>
2026-01-11T19:28:13.5504836Z                      
2026-01-11T19:28:13.5505446Z                          [CmdletBinding()]
2026-01-11T19:28:13.5506385Z                          param(
2026-01-11T19:28:13.5506760Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5507899Z                              [string]$Path,
2026-01-11T19:28:13.5508220Z                      
2026-01-11T19:28:13.5509419Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5509559Z                              [string]$Name,
2026-01-11T19:28:13.5510252Z                      
2026-01-11T19:28:13.5511156Z                              [object]$DefaultValue = $null
2026-01-11T19:28:13.5511879Z                          )
2026-01-11T19:28:13.5512827Z                      
2026-01-11T19:28:13.5513069Z                          try {
2026-01-11T19:28:13.5514453Z                              if (Test-Path $Path) {
2026-01-11T19:28:13.5515157Z                                  $value = Get-ItemProperty -Path $Path -Name $Name -ErrorAction SilentlyContinue
2026-01-11T19:28:13.5515594Z                                  if ($null -ne $value) {
2026-01-11T19:28:13.5516683Z                                      return $value.$Name
2026-01-11T19:28:13.5516798Z                                  }
2026-01-11T19:28:13.5517829Z                              }
2026-01-11T19:28:13.5517958Z                          } catch {
2026-01-11T19:28:13.5519437Z                              Write-Verbose "Registry value not found: $Path\$Name"
2026-01-11T19:28:13.5519761Z                          }
2026-01-11T19:28:13.5520217Z                      
2026-01-11T19:28:13.5521077Z                          return $DefaultValue
2026-01-11T19:28:13.5521190Z                      }
2026-01-11T19:28:13.5522024Z                      
2026-01-11T19:28:13.5523171Z                      function Remove-RegistryValue {
2026-01-11T19:28:13.5523656Z                          <#
2026-01-11T19:28:13.5524951Z                          .SYNOPSIS
2026-01-11T19:28:13.5525213Z                              Deletes a registry value with optional backup.
2026-01-11T19:28:13.5526409Z                          .DESCRIPTION
2026-01-11T19:28:13.5526932Z                              Optionally backs up the parent key, then removes the value.
2026-01-11T19:28:13.5527303Z                          .PARAMETER Path
2026-01-11T19:28:13.5528140Z                              Registry key path.
2026-01-11T19:28:13.5528892Z                          .PARAMETER Name
2026-01-11T19:28:13.5529075Z                              Registry value name.
2026-01-11T19:28:13.5530351Z                          .PARAMETER SkipBackup
2026-01-11T19:28:13.5530612Z                              When true, skips reg export before deleting the value.
2026-01-11T19:28:13.5531691Z                          .OUTPUTS
2026-01-11T19:28:13.5531897Z                              [bool] True on success, false on failure.
2026-01-11T19:28:13.5532509Z                          #>
2026-01-11T19:28:13.5533471Z                      
2026-01-11T19:28:13.5533597Z                          [CmdletBinding()]
2026-01-11T19:28:13.5534156Z                          param(
2026-01-11T19:28:13.5535166Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5535600Z                              [string]$Path,
2026-01-11T19:28:13.5535813Z                      
2026-01-11T19:28:13.5537028Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5537157Z                              [string]$Name,
2026-01-11T19:28:13.5538020Z                      
2026-01-11T19:28:13.5538748Z                              [bool]$SkipBackup = $false
2026-01-11T19:28:13.5539478Z                          )
2026-01-11T19:28:13.5540107Z                      
2026-01-11T19:28:13.5541157Z                          try {
2026-01-11T19:28:13.5541421Z                              if (-not $SkipBackup -and (Test-Path $Path)) {
2026-01-11T19:28:13.5542572Z                                  Backup-RegistryKey -Path $Path | Out-Null
2026-01-11T19:28:13.5542693Z                              }
2026-01-11T19:28:13.5543588Z                      
2026-01-11T19:28:13.5544586Z                              Remove-ItemProperty -Path $Path -Name $Name -ErrorAction Stop
2026-01-11T19:28:13.5545378Z                              Write-Log "Removed registry value: $Path\$Name" "SUCCESS"
2026-01-11T19:28:13.5545527Z                              return $true
2026-01-11T19:28:13.5546888Z                      
2026-01-11T19:28:13.5547017Z                          } catch {
2026-01-11T19:28:13.5548294Z                              Write-Log "Failed to remove registry value $Path\$Name : $_" "ERROR"
2026-01-11T19:28:13.5548449Z                              return $false
2026-01-11T19:28:13.5549520Z                          }
2026-01-11T19:28:13.5550366Z                      }
2026-01-11T19:28:13.5551344Z                      
2026-01-11T19:28:13.5552303Z                      function Test-RegistryKeyExists {
2026-01-11T19:28:13.5552408Z                          <#
2026-01-11T19:28:13.5553700Z                          .SYNOPSIS
2026-01-11T19:28:13.5553922Z                              Tests whether a registry key exists.
2026-01-11T19:28:13.5554732Z                          .PARAMETER Path
2026-01-11T19:28:13.5554889Z                              Registry key path to test.
2026-01-11T19:28:13.5556132Z                          .OUTPUTS
2026-01-11T19:28:13.5556844Z                              [bool] True if key exists, else false.
2026-01-11T19:28:13.5557421Z                          #>
2026-01-11T19:28:13.5558602Z                      
2026-01-11T19:28:13.5558765Z                          [CmdletBinding()]
2026-01-11T19:28:13.5559514Z                          param(
2026-01-11T19:28:13.5560806Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5561122Z                              [string]$Path
2026-01-11T19:28:13.5561957Z                          )
2026-01-11T19:28:13.5562383Z                      
2026-01-11T19:28:13.5563168Z                          return Test-Path $Path
2026-01-11T19:28:13.5563288Z                      }
2026-01-11T19:28:13.5564742Z                      
2026-01-11T19:28:13.5564911Z                      function Test-RegistryValueExists {
2026-01-11T19:28:13.5566309Z                          <#
2026-01-11T19:28:13.5566462Z                          .SYNOPSIS
2026-01-11T19:28:13.5567820Z                              Tests whether a registry value exists.
2026-01-11T19:28:13.5567966Z                          .PARAMETER Path
2026-01-11T19:28:13.5569043Z                              Registry key path.
2026-01-11T19:28:13.5569779Z                          .PARAMETER Name
2026-01-11T19:28:13.5570269Z                              Registry value name.
2026-01-11T19:28:13.5571381Z                          .OUTPUTS
2026-01-11T19:28:13.5571962Z                              [bool] True if the value exists, else false.
2026-01-11T19:28:13.5572862Z                          #>
2026-01-11T19:28:13.5572962Z                      
2026-01-11T19:28:13.5574046Z                          [CmdletBinding()]
2026-01-11T19:28:13.5574166Z                          param(
2026-01-11T19:28:13.5575295Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5575683Z                              [string]$Path,
2026-01-11T19:28:13.5576849Z                      
2026-01-11T19:28:13.5577044Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5578142Z                              [string]$Name
2026-01-11T19:28:13.5578993Z                          )
2026-01-11T19:28:13.5579098Z                      
2026-01-11T19:28:13.5580255Z                          try {
2026-01-11T19:28:13.5580419Z                              if (Test-Path $Path) {
2026-01-11T19:28:13.5581962Z                                  $value = Get-ItemProperty -Path $Path -Name $Name -ErrorAction SilentlyContinue
2026-01-11T19:28:13.5582079Z                                  return ($null -ne $value)
2026-01-11T19:28:13.5583056Z                              }
2026-01-11T19:28:13.5583275Z                          } catch {
2026-01-11T19:28:13.5584194Z                              return $false
2026-01-11T19:28:13.5584847Z                          }
2026-01-11T19:28:13.5585190Z                      
2026-01-11T19:28:13.5586494Z                          return $false
2026-01-11T19:28:13.5586641Z                      }
2026-01-11T19:28:13.5587665Z                      
2026-01-11T19:28:13.5588119Z                      
2026-01-11T19:28:13.5589399Z                      function Set-ProtectedRegistryValue {
2026-01-11T19:28:13.5589509Z                          <#
2026-01-11T19:28:13.5590189Z                          .SYNOPSIS
2026-01-11T19:28:13.5591422Z                              Sets a registry value on ACL-protected keys by temporarily taking ownership.
2026-01-11T19:28:13.5591511Z                          .DESCRIPTION
2026-01-11T19:28:13.5592834Z                              Some registry keys (like audio device keys under MMDevices) are owned by
2026-01-11T19:28:13.5593253Z                              TrustedInstaller and have restrictive ACLs. This function temporarily takes
2026-01-11T19:28:13.5593740Z                              ownership, grants admin permissions, sets the value, then optionally restores
2026-01-11T19:28:13.5594244Z                              the original ACL.
2026-01-11T19:28:13.5594502Z                          .PARAMETER Path
2026-01-11T19:28:13.5595781Z                              Registry key path (HKLM:\ or HKCU:\).
2026-01-11T19:28:13.5596376Z                          .PARAMETER Name
2026-01-11T19:28:13.5597402Z                              Registry value name.
2026-01-11T19:28:13.5597671Z                          .PARAMETER Value
2026-01-11T19:28:13.5598972Z                              Registry value data.
2026-01-11T19:28:13.5599413Z                          .PARAMETER Type
2026-01-11T19:28:13.5599853Z                              Registry value type (DWORD, String, etc).
2026-01-11T19:28:13.5600852Z                          .OUTPUTS
2026-01-11T19:28:13.5601047Z                              [bool] True on success, false on failure.
2026-01-11T19:28:13.5602213Z                          .NOTES
2026-01-11T19:28:13.5606549Z                              Requires Administrator. Enables SeTakeOwnershipPrivilege and SeRestorePrivilege.
2026-01-11T19:28:13.5606709Z                          #>
2026-01-11T19:28:13.5607070Z                      
2026-01-11T19:28:13.5607417Z                          [CmdletBinding()]
2026-01-11T19:28:13.5608385Z                          param(
2026-01-11T19:28:13.5609173Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5609775Z                              [string]$Path,
2026-01-11T19:28:13.5610760Z                      
2026-01-11T19:28:13.5610936Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5611943Z                              [string]$Name,
2026-01-11T19:28:13.5612073Z                      
2026-01-11T19:28:13.5612452Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5614173Z                              [object]$Value,
2026-01-11T19:28:13.5614313Z                      
2026-01-11T19:28:13.5615762Z                              [string]$Type = "DWORD"
2026-01-11T19:28:13.5615984Z                          )
2026-01-11T19:28:13.5617567Z                      
2026-01-11T19:28:13.5618272Z                          $success = $false
2026-01-11T19:28:13.5619338Z                      
2026-01-11T19:28:13.5619449Z                          try {
2026-01-11T19:28:13.5620717Z                              # First try normal registry write
2026-01-11T19:28:13.5620878Z                              if (-not (Test-Path $Path)) {
2026-01-11T19:28:13.5622227Z                                  New-Item -Path $Path -Force -ErrorAction Stop | Out-Null
2026-01-11T19:28:13.5623064Z                              }
2026-01-11T19:28:13.5624613Z                              New-ItemProperty -Path $Path -Name $Name -Value $Value -PropertyType $Type -Force 
2026-01-11T19:28:13.5624774Z                      -ErrorAction Stop | Out-Null
2026-01-11T19:28:13.5625766Z                              Write-Log "Set protected registry value: $Path\$Name = $Value ($Type)" "SUCCESS"
2026-01-11T19:28:13.5625901Z                              $success = $true
2026-01-11T19:28:13.5625994Z                          }
2026-01-11T19:28:13.5627389Z                          catch [System.Security.SecurityException], [System.UnauthorizedAccessException] {
2026-01-11T19:28:13.5627635Z                              # Need to take ownership and grant permissions
2026-01-11T19:28:13.5628574Z                              try {
2026-01-11T19:28:13.5629226Z                                  # Convert PowerShell path to registry key path
2026-01-11T19:28:13.5630548Z                                  $regPath = $Path -replace '^HKLM:\\', 'HKEY_LOCAL_MACHINE\' -replace '^HKCU:\\', 
2026-01-11T19:28:13.5630708Z                      'HKEY_CURRENT_USER\'
2026-01-11T19:28:13.5631978Z                                  $regPath = $regPath -replace '^Microsoft.PowerShell.Core\\Registry::', ''
2026-01-11T19:28:13.5632135Z                      
2026-01-11T19:28:13.5633184Z                                  # Determine the hive and subpath
2026-01-11T19:28:13.5633422Z                                  if ($regPath -match '^HKEY_LOCAL_MACHINE\\(.+)$') {
2026-01-11T19:28:13.5635081Z                                      $hive = [Microsoft.Win32.Registry]::LocalMachine
2026-01-11T19:28:13.5635269Z                                      $subKey = $Matches[1]
2026-01-11T19:28:13.5635360Z                                  }
2026-01-11T19:28:13.5635710Z                                  elseif ($regPath -match '^HKEY_CURRENT_USER\\(.+)$') {
2026-01-11T19:28:13.5636748Z                                      $hive = [Microsoft.Win32.Registry]::CurrentUser
2026-01-11T19:28:13.5637239Z                                      $subKey = $Matches[1]
2026-01-11T19:28:13.5638149Z                                  }
2026-01-11T19:28:13.5638802Z                                  else {
2026-01-11T19:28:13.5640009Z                                      throw "Unsupported registry hive: $regPath"
2026-01-11T19:28:13.5640121Z                                  }
2026-01-11T19:28:13.5641115Z                      
2026-01-11T19:28:13.5642071Z                                  # Enable SeRestorePrivilege and SeTakeOwnershipPrivilege
2026-01-11T19:28:13.5642486Z                                  $tokenPriv = @'
2026-01-11T19:28:13.5643703Z                      using System;
2026-01-11T19:28:13.5644121Z                      using System.Runtime.InteropServices;
2026-01-11T19:28:13.5645095Z                      public class TokenPrivilege {
2026-01-11T19:28:13.5645317Z                          [DllImport("advapi32.dll", SetLastError=true)]
2026-01-11T19:28:13.5646928Z                          public static extern bool OpenProcessToken(IntPtr ProcessHandle, uint DesiredAccess, out 
2026-01-11T19:28:13.5647091Z                      IntPtr TokenHandle);
2026-01-11T19:28:13.5647903Z                          [DllImport("advapi32.dll", SetLastError=true)]
2026-01-11T19:28:13.5649134Z                          public static extern bool LookupPrivilegeValue(string lpSystemName, string lpName, out long 
2026-01-11T19:28:13.5649248Z                      lpLuid);
2026-01-11T19:28:13.5650287Z                          [DllImport("advapi32.dll", SetLastError=true)]
2026-01-11T19:28:13.5650794Z                          public static extern bool AdjustTokenPrivileges(IntPtr TokenHandle, bool 
2026-01-11T19:28:13.5652207Z                      DisableAllPrivileges, ref TOKEN_PRIVILEGES NewState, uint BufferLength, IntPtr PreviousState, 
2026-01-11T19:28:13.5652351Z                      IntPtr ReturnLength);
2026-01-11T19:28:13.5652866Z                          [StructLayout(LayoutKind.Sequential)]
2026-01-11T19:28:13.5653314Z                          public struct TOKEN_PRIVILEGES {
2026-01-11T19:28:13.5653717Z                              public uint PrivilegeCount;
2026-01-11T19:28:13.5654086Z                              public long Luid;
2026-01-11T19:28:13.5654527Z                              public uint Attributes;
2026-01-11T19:28:13.5655124Z                          }
2026-01-11T19:28:13.5655376Z                          public const uint SE_PRIVILEGE_ENABLED = 0x00000002;
2026-01-11T19:28:13.5656396Z                          public const uint TOKEN_ADJUST_PRIVILEGES = 0x0020;
2026-01-11T19:28:13.5656587Z                          public const uint TOKEN_QUERY = 0x0008;
2026-01-11T19:28:13.5657667Z                      
2026-01-11T19:28:13.5657931Z                          public static void EnablePrivilege(string privilege) {
2026-01-11T19:28:13.5658842Z                              IntPtr hToken;
2026-01-11T19:28:13.5659541Z                              if (!OpenProcessToken(System.Diagnostics.Process.GetCurrentProcess().Handle, 
2026-01-11T19:28:13.5660274Z                      TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, out hToken))
2026-01-11T19:28:13.5661347Z                                  return;
2026-01-11T19:28:13.5661596Z                              TOKEN_PRIVILEGES tp = new TOKEN_PRIVILEGES();
2026-01-11T19:28:13.5662172Z                              tp.PrivilegeCount = 1;
2026-01-11T19:28:13.5662682Z                              tp.Attributes = SE_PRIVILEGE_ENABLED;
2026-01-11T19:28:13.5663204Z                              if (!LookupPrivilegeValue(null, privilege, out tp.Luid))
2026-01-11T19:28:13.5664254Z                                  return;
2026-01-11T19:28:13.5665321Z                              AdjustTokenPrivileges(hToken, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
2026-01-11T19:28:13.5665660Z                          }
2026-01-11T19:28:13.5666541Z                      }
2026-01-11T19:28:13.5666653Z                      '@
2026-01-11T19:28:13.5668048Z                                  if (-not ([System.Management.Automation.PSTypeName]'TokenPrivilege').Type) {
2026-01-11T19:28:13.5668272Z                                      Add-Type -TypeDefinition $tokenPriv -Language CSharp
2026-01-11T19:28:13.5669192Z                                  }
2026-01-11T19:28:13.5670268Z                                  [TokenPrivilege]::EnablePrivilege("SeTakeOwnershipPrivilege")
2026-01-11T19:28:13.5670587Z                                  [TokenPrivilege]::EnablePrivilege("SeRestorePrivilege")
2026-01-11T19:28:13.5670912Z                      
2026-01-11T19:28:13.5671995Z                                  # Open the key with TakeOwnership permission
2026-01-11T19:28:13.5672206Z                                  $key = $hive.OpenSubKey($subKey, 
2026-01-11T19:28:13.5672904Z                      [Microsoft.Win32.RegistryKeyPermissionCheck]::ReadWriteSubTree,
2026-01-11T19:28:13.5673958Z                                      [System.Security.AccessControl.RegistryRights]::TakeOwnership)
2026-01-11T19:28:13.5674378Z                      
2026-01-11T19:28:13.5675212Z                                  if ($null -eq $key) {
2026-01-11T19:28:13.5676120Z                                      throw "Cannot open registry key for ownership: $subKey"
2026-01-11T19:28:13.5676867Z                                  }
2026-01-11T19:28:13.5676980Z                      
2026-01-11T19:28:13.5677808Z                                  # Take ownership as Administrators
2026-01-11T19:28:13.5678635Z                                  $adminSid = New-Object System.Security.Principal.SecurityIdentifier("S-1-5-32-544")
2026-01-11T19:28:13.5678947Z                                  $acl = 
2026-01-11T19:28:13.5680470Z                      $key.GetAccessControl([System.Security.AccessControl.AccessControlSections]::Owner)
2026-01-11T19:28:13.5680651Z                                  $acl.SetOwner($adminSid)
2026-01-11T19:28:13.5681679Z                                  $key.SetAccessControl($acl)
2026-01-11T19:28:13.5681811Z                                  $key.Close()
2026-01-11T19:28:13.5683267Z                      
2026-01-11T19:28:13.5683480Z                                  # Re-open with ChangePermissions
2026-01-11T19:28:13.5684775Z                                  $key = $hive.OpenSubKey($subKey, 
2026-01-11T19:28:13.5686176Z                      [Microsoft.Win32.RegistryKeyPermissionCheck]::ReadWriteSubTree,
2026-01-11T19:28:13.5686573Z                                      [System.Security.AccessControl.RegistryRights]::ChangePermissions)
2026-01-11T19:28:13.5686668Z                      
2026-01-11T19:28:13.5687245Z                                  # Grant Administrators full control
2026-01-11T19:28:13.5688158Z                                  $acl = $key.GetAccessControl()
2026-01-11T19:28:13.5689090Z                                  $rule = New-Object System.Security.AccessControl.RegistryAccessRule(
2026-01-11T19:28:13.5689501Z                                      $adminSid,
2026-01-11T19:28:13.5690459Z                                      [System.Security.AccessControl.RegistryRights]::FullControl,
2026-01-11T19:28:13.5691160Z                                      [System.Security.AccessControl.InheritanceFlags]::None,
2026-01-11T19:28:13.5691771Z                                      [System.Security.AccessControl.PropagationFlags]::None,
2026-01-11T19:28:13.5692448Z                                      [System.Security.AccessControl.AccessControlType]::Allow)
2026-01-11T19:28:13.5693348Z                                  $acl.AddAccessRule($rule)
2026-01-11T19:28:13.5693786Z                                  $key.SetAccessControl($acl)
2026-01-11T19:28:13.5694923Z                                  $key.Close()
2026-01-11T19:28:13.5695035Z                      
2026-01-11T19:28:13.5696107Z                                  # Now set the value
2026-01-11T19:28:13.5697391Z                                  New-ItemProperty -Path $Path -Name $Name -Value $Value -PropertyType $Type -Force 
2026-01-11T19:28:13.5697567Z                      -ErrorAction Stop | Out-Null
2026-01-11T19:28:13.5698844Z                                  Write-Log "Set protected registry value (after ownership change): $Path\$Name = 
2026-01-11T19:28:13.5698990Z                      $Value ($Type)" "SUCCESS"
2026-01-11T19:28:13.5699405Z                                  $success = $true
2026-01-11T19:28:13.5700289Z                      
2026-01-11T19:28:13.5701337Z                              }
2026-01-11T19:28:13.5702187Z                              catch {
2026-01-11T19:28:13.5702594Z                                  Write-Log "Cannot modify protected key: $Path\$Name - $_" "WARNING"
2026-01-11T19:28:13.5703672Z                              }
2026-01-11T19:28:13.5703797Z                          }
2026-01-11T19:28:13.5704991Z                          catch {
2026-01-11T19:28:13.5705682Z                              Write-Log "Failed to set protected registry value $Path\$Name : $_" "ERROR"
2026-01-11T19:28:13.5706532Z                          }
2026-01-11T19:28:13.5706719Z                      
2026-01-11T19:28:13.5707871Z                          return $success
2026-01-11T19:28:13.5707991Z                      }
2026-01-11T19:28:13.5709128Z                      
2026-01-11T19:28:13.5710000Z                      
2026-01-11T19:28:13.5710817Z                      Export-ModuleMember -Function @(
2026-01-11T19:28:13.5711732Z                          'Backup-RegistryKey',
2026-01-11T19:28:13.5712551Z                          'Restore-RegistryKey',
2026-01-11T19:28:13.5713311Z                          'Set-RegistryValue',
2026-01-11T19:28:13.5714455Z                          'Set-ProtectedRegistryValue',
2026-01-11T19:28:13.5714621Z                          'Get-RegistryValue',
2026-01-11T19:28:13.5715345Z                          'Remove-RegistryValue',
2026-01-11T19:28:13.5716112Z                          'Test-RegistryKeyExists',
2026-01-11T19:28:13.5717082Z                          'Test-RegistryValueExists'
2026-01-11T19:28:13.5717494Z                      )
2026-01-11T19:28:13.5718433Z [32;1mCleanBlock         : [0m
2026-01-11T19:28:13.5718706Z [32;1mDynamicParamBlock  : [0m
2026-01-11T19:28:13.5719656Z [32;1mScriptRequirements : [0m
2026-01-11T19:28:13.5721687Z [32;1mExtent             : [0m<#
2026-01-11T19:28:13.5722066Z                      .SYNOPSIS
2026-01-11T19:28:13.5723298Z                          Registry helper utilities with logging and optional backup/restore.
2026-01-11T19:28:13.5723549Z                      .DESCRIPTION
2026-01-11T19:28:13.5724791Z                          Wraps common registry operations (set/get/remove) and uses reg.exe for
2026-01-11T19:28:13.5725093Z                          full key backups and restores, with logging via the core logger module.
2026-01-11T19:28:13.5725504Z                      .NOTES
2026-01-11T19:28:13.5726553Z                          Requires admin for HKLM writes. Uses reg.exe for export/import to capture
2026-01-11T19:28:13.5726763Z                          full key state before modifications.
2026-01-11T19:28:13.5727576Z                      #>
2026-01-11T19:28:13.5727835Z                      
2026-01-11T19:28:13.5729293Z                      Import-Module (Join-Path $PSScriptRoot "logger.psm1") -Force
2026-01-11T19:28:13.5729410Z                      
2026-01-11T19:28:13.5730745Z                      $script:RegistryBackupIndexPath = Join-Path $PSScriptRoot "..\..\config\registry-backups.json"
2026-01-11T19:28:13.5730867Z                      $script:RegistryBackupIndex = $null
2026-01-11T19:28:13.5731382Z                      
2026-01-11T19:28:13.5732558Z                      function Get-RegistryBackupIndex {
2026-01-11T19:28:13.5732785Z                          if ($null -ne $script:RegistryBackupIndex) {
2026-01-11T19:28:13.5733683Z                              return $script:RegistryBackupIndex
2026-01-11T19:28:13.5734464Z                          }
2026-01-11T19:28:13.5735310Z                      
2026-01-11T19:28:13.5736011Z                          if (-not (Test-Path $script:RegistryBackupIndexPath)) {
2026-01-11T19:28:13.5736463Z                              $script:RegistryBackupIndex = @{}
2026-01-11T19:28:13.5737364Z                              return $script:RegistryBackupIndex
2026-01-11T19:28:13.5737490Z                          }
2026-01-11T19:28:13.5739043Z                      
2026-01-11T19:28:13.5739200Z                          try {
2026-01-11T19:28:13.5740520Z                              $json = Get-Content $script:RegistryBackupIndexPath -Raw | ConvertFrom-Json
2026-01-11T19:28:13.5740655Z                              $index = @{}
2026-01-11T19:28:13.5741798Z                              if ($null -ne $json) {
2026-01-11T19:28:13.5742055Z                                  foreach ($property in $json.PSObject.Properties) {
2026-01-11T19:28:13.5743270Z                                      $index[$property.Name] = $property.Value
2026-01-11T19:28:13.5743370Z                                  }
2026-01-11T19:28:13.5744831Z                              }
2026-01-11T19:28:13.5746091Z                              $script:RegistryBackupIndex = $index
2026-01-11T19:28:13.5746305Z                              return $script:RegistryBackupIndex
2026-01-11T19:28:13.5746791Z                          } catch {
2026-01-11T19:28:13.5748076Z                              Write-Log "Failed to load registry backup index: $_" "WARNING"
2026-01-11T19:28:13.5748280Z                              $script:RegistryBackupIndex = @{}
2026-01-11T19:28:13.5748714Z                              return $script:RegistryBackupIndex
2026-01-11T19:28:13.5750137Z                          }
2026-01-11T19:28:13.5750868Z                      }
2026-01-11T19:28:13.5751635Z                      
2026-01-11T19:28:13.5752513Z                      function Save-RegistryBackupIndex {
2026-01-11T19:28:13.5753608Z                          if ($null -eq $script:RegistryBackupIndex) {
2026-01-11T19:28:13.5753747Z                              return
2026-01-11T19:28:13.5754412Z                          }
2026-01-11T19:28:13.5755191Z                      
2026-01-11T19:28:13.5756236Z                          try {
2026-01-11T19:28:13.5757066Z                              $indexDir = Split-Path $script:RegistryBackupIndexPath -Parent
2026-01-11T19:28:13.5758362Z                              if ($indexDir -and -not (Test-Path $indexDir)) {
2026-01-11T19:28:13.5758980Z                                  New-Item -ItemType Directory -Path $indexDir -Force | Out-Null
2026-01-11T19:28:13.5759214Z                              }
2026-01-11T19:28:13.5760824Z                      
2026-01-11T19:28:13.5762463Z                              $json = $script:RegistryBackupIndex | ConvertTo-Json -Depth 6
2026-01-11T19:28:13.5763488Z                              Set-Content -Path $script:RegistryBackupIndexPath -Value $json -Force
2026-01-11T19:28:13.5764525Z                          } catch {
2026-01-11T19:28:13.5765279Z                              Write-Log "Failed to save registry backup index: $_" "WARNING"
2026-01-11T19:28:13.5766121Z                          }
2026-01-11T19:28:13.5766595Z                      }
2026-01-11T19:28:13.5766884Z                      
2026-01-11T19:28:13.5767448Z                      function Register-RegistryBackup {
2026-01-11T19:28:13.5768173Z                          [CmdletBinding()]
2026-01-11T19:28:13.5768763Z                          param(
2026-01-11T19:28:13.5769169Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5770047Z                              [string]$Path,
2026-01-11T19:28:13.5770501Z                      
2026-01-11T19:28:13.5770864Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5771321Z                              [string]$BackupPath,
2026-01-11T19:28:13.5771981Z                      
2026-01-11T19:28:13.5772410Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5772940Z                              [string]$BackupDir
2026-01-11T19:28:13.5773341Z                          )
2026-01-11T19:28:13.5773766Z                      
2026-01-11T19:28:13.5774129Z                          $index = Get-RegistryBackupIndex
2026-01-11T19:28:13.5774773Z                          $index[$Path] = @{
2026-01-11T19:28:13.5775217Z                              LastBackup = $BackupPath
2026-01-11T19:28:13.5775864Z                              BackupDir = $BackupDir
2026-01-11T19:28:13.5776437Z                              UpdatedAt = (Get-Date).ToString('o')
2026-01-11T19:28:13.5777518Z                          }
2026-01-11T19:28:13.5778124Z                      
2026-01-11T19:28:13.5779244Z                          $script:RegistryBackupIndex = $index
2026-01-11T19:28:13.5779749Z                          Save-RegistryBackupIndex
2026-01-11T19:28:13.5780077Z                      }
2026-01-11T19:28:13.5780612Z                      
2026-01-11T19:28:13.5781186Z                      function Resolve-RegistryBackupPath {
2026-01-11T19:28:13.5781682Z                          [CmdletBinding()]
2026-01-11T19:28:13.5782916Z                          param(
2026-01-11T19:28:13.5783389Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5784332Z                              [string]$Path,
2026-01-11T19:28:13.5784777Z                      
2026-01-11T19:28:13.5785253Z                              [string]$BackupDir = $null
2026-01-11T19:28:13.5786536Z                          )
2026-01-11T19:28:13.5787017Z                      
2026-01-11T19:28:13.5787555Z                          $index = Get-RegistryBackupIndex
2026-01-11T19:28:13.5788004Z                          if ($index.ContainsKey($Path)) {
2026-01-11T19:28:13.5788436Z                              $entry = $index[$Path]
2026-01-11T19:28:13.5789874Z                              if ($entry.LastBackup -and (Test-Path $entry.LastBackup)) {
2026-01-11T19:28:13.5790521Z                                  return $entry.LastBackup
2026-01-11T19:28:13.5790933Z                              }
2026-01-11T19:28:13.5791287Z                              if (-not $BackupDir -and $entry.BackupDir) {
2026-01-11T19:28:13.5791593Z                                  $BackupDir = $entry.BackupDir
2026-01-11T19:28:13.5792275Z                              }
2026-01-11T19:28:13.5792577Z                          }
2026-01-11T19:28:13.5792815Z                      
2026-01-11T19:28:13.5793917Z                          if (-not $BackupDir) {
2026-01-11T19:28:13.5794550Z                              $BackupDir = "$env:TEMP\RegistryBackup"
2026-01-11T19:28:13.5795027Z                          }
2026-01-11T19:28:13.5795633Z                      
2026-01-11T19:28:13.5796810Z                          if (-not (Test-Path $BackupDir)) {
2026-01-11T19:28:13.5797152Z                              return $null
2026-01-11T19:28:13.5798374Z                          }
2026-01-11T19:28:13.5798723Z                      
2026-01-11T19:28:13.5799366Z                          $safeName = $Path.Replace('\', '_').Replace(':', '')
2026-01-11T19:28:13.5800371Z                          $backup = Get-ChildItem -Path $BackupDir -Filter "Backup-*$safeName.reg" -ErrorAction 
2026-01-11T19:28:13.5801546Z                      SilentlyContinue |
2026-01-11T19:28:13.5802318Z                              Sort-Object LastWriteTime -Descending |
2026-01-11T19:28:13.5803058Z                              Select-Object -First 1
2026-01-11T19:28:13.5803507Z                      
2026-01-11T19:28:13.5804071Z                          if ($backup) {
2026-01-11T19:28:13.5804482Z                              return $backup.FullName
2026-01-11T19:28:13.5804858Z                          }
2026-01-11T19:28:13.5805275Z                      
2026-01-11T19:28:13.5806110Z                          return $null
2026-01-11T19:28:13.5806529Z                      }
2026-01-11T19:28:13.5807532Z                      
2026-01-11T19:28:13.5807836Z                      
2026-01-11T19:28:13.5808503Z                      function Backup-RegistryKey {
2026-01-11T19:28:13.5809344Z                          <#
2026-01-11T19:28:13.5809879Z                          .SYNOPSIS
2026-01-11T19:28:13.5811317Z                              Exports a registry key to a .reg file for backup.
2026-01-11T19:28:13.5812233Z                          .DESCRIPTION
2026-01-11T19:28:13.5812842Z                              Uses reg.exe to export the key to a timestamped file in a backup directory.
2026-01-11T19:28:13.5813636Z                              Returns the backup file path or $false on failure.
2026-01-11T19:28:13.5814137Z                          .PARAMETER Path
2026-01-11T19:28:13.5814583Z                              Registry key path (HKLM:\ or HKCU:\).
2026-01-11T19:28:13.5815020Z                          .PARAMETER BackupDir
2026-01-11T19:28:13.5815645Z                              Directory to store .reg backups. Defaults to %TEMP%\RegistryBackup.
2026-01-11T19:28:13.5816279Z                          .OUTPUTS
2026-01-11T19:28:13.5816798Z                              [string] Backup file path on success, or [bool] $false on failure.
2026-01-11T19:28:13.5817385Z                          #>
2026-01-11T19:28:13.5817657Z                      
2026-01-11T19:28:13.5817916Z                          [CmdletBinding()]
2026-01-11T19:28:13.5818287Z                          param(
2026-01-11T19:28:13.5818664Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5819097Z                              [string]$Path,
2026-01-11T19:28:13.5819458Z                      
2026-01-11T19:28:13.5819934Z                              [string]$BackupDir = "$env:TEMP\RegistryBackup"
2026-01-11T19:28:13.5820422Z                          )
2026-01-11T19:28:13.5821055Z                      
2026-01-11T19:28:13.5822180Z                          if (-not (Test-Path $Path)) {
2026-01-11T19:28:13.5823981Z                              Write-Log "Registry path does not exist, skipping backup: $Path" "WARNING"
2026-01-11T19:28:13.5824712Z                              return $false
2026-01-11T19:28:13.5825071Z                          }
2026-01-11T19:28:13.5825329Z                      
2026-01-11T19:28:13.5825669Z                          try {
2026-01-11T19:28:13.5826653Z                              if (-not (Test-Path $BackupDir)) {
2026-01-11T19:28:13.5827357Z                                  New-Item -ItemType Directory -Path $BackupDir -Force | Out-Null
2026-01-11T19:28:13.5827952Z                              }
2026-01-11T19:28:13.5828305Z                      
2026-01-11T19:28:13.5828691Z                              $timestamp = Get-Date -Format 'yyyyMMdd-HHmmss'
2026-01-11T19:28:13.5829291Z                              $safeName = $Path.Replace('\', '_').Replace(':', '')
2026-01-11T19:28:13.5830007Z                              $backupPath = Join-Path $BackupDir "Backup-$timestamp-$safeName.reg"
2026-01-11T19:28:13.5830681Z                      
2026-01-11T19:28:13.5831246Z                              $exportPath = $Path.Replace('HKLM:\', 'HKEY_LOCAL_MACHINE\').Replace('HKCU:\', 
2026-01-11T19:28:13.5831925Z                      'HKEY_CURRENT_USER\')
2026-01-11T19:28:13.5832293Z                      
2026-01-11T19:28:13.5832706Z                              $result = reg export $exportPath $backupPath /y 2>&1
2026-01-11T19:28:13.5833194Z                      
2026-01-11T19:28:13.5833487Z                              if ($LASTEXITCODE -eq 0) {
2026-01-11T19:28:13.5834129Z                                  Write-Log "Backed up registry key: $Path -> $backupPath" "SUCCESS"
2026-01-11T19:28:13.5835654Z                                  Register-RegistryBackup -Path $Path -BackupPath $backupPath -BackupDir $BackupDir
2026-01-11T19:28:13.5836444Z                                  return $backupPath
2026-01-11T19:28:13.5836858Z                              } else {
2026-01-11T19:28:13.5837567Z                                  Write-Log "Failed to backup registry key: $Path (Exit code: $LASTEXITCODE)" "ERROR"
2026-01-11T19:28:13.5838303Z                                  return $false
2026-01-11T19:28:13.5838675Z                              }
2026-01-11T19:28:13.5838994Z                      
2026-01-11T19:28:13.5839232Z                          } catch {
2026-01-11T19:28:13.5839768Z                              Write-Log "Exception backing up registry key $Path : $_" "ERROR"
2026-01-11T19:28:13.5840386Z                              return $false
2026-01-11T19:28:13.5840735Z                          }
2026-01-11T19:28:13.5841074Z                      }
2026-01-11T19:28:13.5841331Z                      
2026-01-11T19:28:13.5841658Z                      function Restore-RegistryKey {
2026-01-11T19:28:13.5842032Z                          <#
2026-01-11T19:28:13.5842303Z                          .SYNOPSIS
2026-01-11T19:28:13.5843022Z                              Restores a registry key from a .reg backup file.
2026-01-11T19:28:13.5843568Z                          .DESCRIPTION
2026-01-11T19:28:13.5844095Z                              Uses reg.exe to import a .reg file. Logs success or failure.
2026-01-11T19:28:13.5844701Z                          .PARAMETER BackupPath
2026-01-11T19:28:13.5845172Z                              Path to the .reg file produced by Backup-RegistryKey.
2026-01-11T19:28:13.5845744Z                          .PARAMETER Path
2026-01-11T19:28:13.5846355Z                              Registry key path (HKLM:\ or HKCU:\) to resolve the latest backup.
2026-01-11T19:28:13.5846959Z                          .OUTPUTS
2026-01-11T19:28:13.5847399Z                              [bool] True on success, false on failure.
2026-01-11T19:28:13.5847861Z                          .NOTES
2026-01-11T19:28:13.5848446Z                              reg.exe writes some output to stderr even on success, so output is suppressed.
2026-01-11T19:28:13.5849149Z                          #>
2026-01-11T19:28:13.5849434Z                      
2026-01-11T19:28:13.5849673Z                          [CmdletBinding()]
2026-01-11T19:28:13.5849890Z                          param(
2026-01-11T19:28:13.5850236Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5850668Z                              [Alias('Path')]
2026-01-11T19:28:13.5851326Z                              [string]$BackupPath
2026-01-11T19:28:13.5851746Z                          )
2026-01-11T19:28:13.5852042Z                      
2026-01-11T19:28:13.5852381Z                          $resolvedBackupPath = $BackupPath
2026-01-11T19:28:13.5852908Z                          if ($BackupPath -match '^(HKLM|HKCU):\\') {
2026-01-11T19:28:13.5853569Z                              $resolvedBackupPath = Resolve-RegistryBackupPath -Path $BackupPath
2026-01-11T19:28:13.5853977Z                              if (-not $resolvedBackupPath) {
2026-01-11T19:28:13.5854567Z                                  Write-Log "No registry backup found for key: $BackupPath" "ERROR"
2026-01-11T19:28:13.5855201Z                                  return $false
2026-01-11T19:28:13.5855552Z                              }
2026-01-11T19:28:13.5855827Z                          }
2026-01-11T19:28:13.5856178Z                      
2026-01-11T19:28:13.5856548Z                          if (-not (Test-Path $resolvedBackupPath)) {
2026-01-11T19:28:13.5857634Z                              Write-Log "Backup file not found: $resolvedBackupPath" "ERROR"
2026-01-11T19:28:13.5858251Z                              return $false
2026-01-11T19:28:13.5858911Z                          }
2026-01-11T19:28:13.5859194Z                      
2026-01-11T19:28:13.5859467Z                          try {
2026-01-11T19:28:13.5860014Z                              # Suppress errors from reg.exe output (it writes success to stderr)
2026-01-11T19:28:13.5860741Z                              $null = reg import $resolvedBackupPath 2>&1
2026-01-11T19:28:13.5861176Z                      
2026-01-11T19:28:13.5861485Z                              if ($LASTEXITCODE -eq 0) {
2026-01-11T19:28:13.5862187Z                                  Write-Log "Restored registry from backup: $resolvedBackupPath" "SUCCESS"
2026-01-11T19:28:13.5863224Z                                  return $true
2026-01-11T19:28:13.5863535Z                              } else {
2026-01-11T19:28:13.5864165Z                                  Write-Log "Failed to restore registry from backup: $resolvedBackupPath (Exit code: 
2026-01-11T19:28:13.5864874Z                      $LASTEXITCODE)" "ERROR"
2026-01-11T19:28:13.5865291Z                                  return $false
2026-01-11T19:28:13.5865633Z                              }
2026-01-11T19:28:13.5865946Z                      
2026-01-11T19:28:13.5866276Z                          } catch {
2026-01-11T19:28:13.5867034Z                              if ($LASTEXITCODE -eq 0) {
2026-01-11T19:28:13.5867765Z                                  Write-Log "Restored registry from backup: $resolvedBackupPath" "SUCCESS"
2026-01-11T19:28:13.5868423Z                                  return $true
2026-01-11T19:28:13.5868805Z                              } else {
2026-01-11T19:28:13.5869810Z                                  Write-Log "Exception restoring registry from backup $resolvedBackupPath : $_" "ERROR"
2026-01-11T19:28:13.5870573Z                                  return $false
2026-01-11T19:28:13.5870955Z                              }
2026-01-11T19:28:13.5871257Z                          }
2026-01-11T19:28:13.5871513Z                      }
2026-01-11T19:28:13.5871768Z                      
2026-01-11T19:28:13.5872299Z                      
2026-01-11T19:28:13.5872738Z                      function Set-RegistryValue {
2026-01-11T19:28:13.5873247Z                          <#
2026-01-11T19:28:13.5873550Z                          .SYNOPSIS
2026-01-11T19:28:13.5874286Z                              Creates or updates a registry value with optional backup.
2026-01-11T19:28:13.5874846Z                          .DESCRIPTION
2026-01-11T19:28:13.5876648Z                              Optionally backs up the parent key, creates the key if missing, and then
2026-01-11T19:28:13.5877633Z                              writes the value using Set-ItemProperty.
2026-01-11T19:28:13.5878197Z                          .PARAMETER Path
2026-01-11T19:28:13.5879139Z                              Registry key path.
2026-01-11T19:28:13.5879562Z                          .PARAMETER Name
2026-01-11T19:28:13.5879969Z                              Registry value name.
2026-01-11T19:28:13.5880379Z                          .PARAMETER Value
2026-01-11T19:28:13.5880764Z                              Registry value data.
2026-01-11T19:28:13.5881573Z                          .PARAMETER Type
2026-01-11T19:28:13.5881855Z                              Registry value type (DWORD, String, etc).
2026-01-11T19:28:13.5882375Z                          .PARAMETER SkipBackup
2026-01-11T19:28:13.5883157Z                              When true, skips reg export before modifying the key.
2026-01-11T19:28:13.5883670Z                          .OUTPUTS
2026-01-11T19:28:13.5884086Z                              [bool] True on success, false on failure.
2026-01-11T19:28:13.5884517Z                          #>
2026-01-11T19:28:13.5884836Z                      
2026-01-11T19:28:13.5885135Z                          [CmdletBinding()]
2026-01-11T19:28:13.5885492Z                          param(
2026-01-11T19:28:13.5885813Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5886499Z                              [string]$Path,
2026-01-11T19:28:13.5886806Z                      
2026-01-11T19:28:13.5887852Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5888306Z                              [string]$Name,
2026-01-11T19:28:13.5888832Z                      
2026-01-11T19:28:13.5890053Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5890550Z                              [object]$Value,
2026-01-11T19:28:13.5890950Z                      
2026-01-11T19:28:13.5891236Z                              [string]$Type = "DWORD",
2026-01-11T19:28:13.5891662Z                      
2026-01-11T19:28:13.5892350Z                              [bool]$SkipBackup = $false
2026-01-11T19:28:13.5892981Z                          )
2026-01-11T19:28:13.5894215Z                      
2026-01-11T19:28:13.5894467Z                          try {
2026-01-11T19:28:13.5895028Z                              if (-not $SkipBackup -and (Test-Path $Path)) {
2026-01-11T19:28:13.5896249Z                                  Backup-RegistryKey -Path $Path | Out-Null
2026-01-11T19:28:13.5897141Z                              }
2026-01-11T19:28:13.5897440Z                      
2026-01-11T19:28:13.5897757Z                              if (-not (Test-Path $Path)) {
2026-01-11T19:28:13.5898236Z                                  New-Item -Path $Path -Force | Out-Null
2026-01-11T19:28:13.5898831Z                                  Write-Log "Created registry path: $Path"
2026-01-11T19:28:13.5899313Z                              }
2026-01-11T19:28:13.5900007Z                      
2026-01-11T19:28:13.5900669Z                              Set-ItemProperty -Path $Path -Name $Name -Value $Value -Type $Type -ErrorAction Stop
2026-01-11T19:28:13.5901674Z                              Write-Log "Set registry value: $Path\$Name = $Value ($Type)" "SUCCESS"
2026-01-11T19:28:13.5902318Z                              return $true
2026-01-11T19:28:13.5902705Z                      
2026-01-11T19:28:13.5903288Z                          } catch {
2026-01-11T19:28:13.5903829Z                              Write-Log "Failed to set registry value $Path\$Name : $_" "ERROR"
2026-01-11T19:28:13.5904435Z                              return $false
2026-01-11T19:28:13.5904775Z                          }
2026-01-11T19:28:13.5905048Z                      }
2026-01-11T19:28:13.5905313Z                      
2026-01-11T19:28:13.5905626Z                      function Get-RegistryValue {
2026-01-11T19:28:13.5906020Z                          <#
2026-01-11T19:28:13.5906294Z                          .SYNOPSIS
2026-01-11T19:28:13.5907277Z                              Reads a registry value with a default fallback.
2026-01-11T19:28:13.5907850Z                          .DESCRIPTION
2026-01-11T19:28:13.5908604Z                              Returns the registry value if it exists, otherwise returns DefaultValue.
2026-01-11T19:28:13.5909320Z                          .PARAMETER Path
2026-01-11T19:28:13.5910211Z                              Registry key path.
2026-01-11T19:28:13.5910682Z                          .PARAMETER Name
2026-01-11T19:28:13.5911103Z                              Registry value name.
2026-01-11T19:28:13.5911460Z                          .PARAMETER DefaultValue
2026-01-11T19:28:13.5911940Z                              Value returned when the registry value does not exist.
2026-01-11T19:28:13.5912460Z                          .OUTPUTS
2026-01-11T19:28:13.5912908Z                              [object] The stored registry data or DefaultValue.
2026-01-11T19:28:13.5913401Z                          #>
2026-01-11T19:28:13.5914155Z                      
2026-01-11T19:28:13.5914504Z                          [CmdletBinding()]
2026-01-11T19:28:13.5914806Z                          param(
2026-01-11T19:28:13.5915408Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5915846Z                              [string]$Path,
2026-01-11T19:28:13.5916216Z                      
2026-01-11T19:28:13.5916863Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5917395Z                              [string]$Name,
2026-01-11T19:28:13.5918609Z                      
2026-01-11T19:28:13.5919143Z                              [object]$DefaultValue = $null
2026-01-11T19:28:13.5919570Z                          )
2026-01-11T19:28:13.5921511Z                      
2026-01-11T19:28:13.5922020Z                          try {
2026-01-11T19:28:13.5922387Z                              if (Test-Path $Path) {
2026-01-11T19:28:13.5923480Z                                  $value = Get-ItemProperty -Path $Path -Name $Name -ErrorAction SilentlyContinue
2026-01-11T19:28:13.5924274Z                                  if ($null -ne $value) {
2026-01-11T19:28:13.5924748Z                                      return $value.$Name
2026-01-11T19:28:13.5925118Z                                  }
2026-01-11T19:28:13.5925470Z                              }
2026-01-11T19:28:13.5925724Z                          } catch {
2026-01-11T19:28:13.5926189Z                              Write-Verbose "Registry value not found: $Path\$Name"
2026-01-11T19:28:13.5926651Z                          }
2026-01-11T19:28:13.5927572Z                      
2026-01-11T19:28:13.5927915Z                          return $DefaultValue
2026-01-11T19:28:13.5928275Z                      }
2026-01-11T19:28:13.5928513Z                      
2026-01-11T19:28:13.5928828Z                      function Remove-RegistryValue {
2026-01-11T19:28:13.5929237Z                          <#
2026-01-11T19:28:13.5929833Z                          .SYNOPSIS
2026-01-11T19:28:13.5930300Z                              Deletes a registry value with optional backup.
2026-01-11T19:28:13.5930815Z                          .DESCRIPTION
2026-01-11T19:28:13.5931407Z                              Optionally backs up the parent key, then removes the value.
2026-01-11T19:28:13.5931918Z                          .PARAMETER Path
2026-01-11T19:28:13.5933164Z                              Registry key path.
2026-01-11T19:28:13.5933549Z                          .PARAMETER Name
2026-01-11T19:28:13.5933958Z                              Registry value name.
2026-01-11T19:28:13.5934490Z                          .PARAMETER SkipBackup
2026-01-11T19:28:13.5935058Z                              When true, skips reg export before deleting the value.
2026-01-11T19:28:13.5935765Z                          .OUTPUTS
2026-01-11T19:28:13.5936219Z                              [bool] True on success, false on failure.
2026-01-11T19:28:13.5937013Z                          #>
2026-01-11T19:28:13.5937317Z                      
2026-01-11T19:28:13.5937645Z                          [CmdletBinding()]
2026-01-11T19:28:13.5938565Z                          param(
2026-01-11T19:28:13.5938997Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5939376Z                              [string]$Path,
2026-01-11T19:28:13.5939603Z                      
2026-01-11T19:28:13.5941015Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5941469Z                              [string]$Name,
2026-01-11T19:28:13.5941857Z                      
2026-01-11T19:28:13.5942217Z                              [bool]$SkipBackup = $false
2026-01-11T19:28:13.5942914Z                          )
2026-01-11T19:28:13.5944140Z                      
2026-01-11T19:28:13.5944427Z                          try {
2026-01-11T19:28:13.5944896Z                              if (-not $SkipBackup -and (Test-Path $Path)) {
2026-01-11T19:28:13.5945710Z                                  Backup-RegistryKey -Path $Path | Out-Null
2026-01-11T19:28:13.5946375Z                              }
2026-01-11T19:28:13.5946904Z                      
2026-01-11T19:28:13.5948058Z                              Remove-ItemProperty -Path $Path -Name $Name -ErrorAction Stop
2026-01-11T19:28:13.5948841Z                              Write-Log "Removed registry value: $Path\$Name" "SUCCESS"
2026-01-11T19:28:13.5949591Z                              return $true
2026-01-11T19:28:13.5949929Z                      
2026-01-11T19:28:13.5950282Z                          } catch {
2026-01-11T19:28:13.5951292Z                              Write-Log "Failed to remove registry value $Path\$Name : $_" "ERROR"
2026-01-11T19:28:13.5951919Z                              return $false
2026-01-11T19:28:13.5952424Z                          }
2026-01-11T19:28:13.5952796Z                      }
2026-01-11T19:28:13.5953979Z                      
2026-01-11T19:28:13.5954400Z                      function Test-RegistryKeyExists {
2026-01-11T19:28:13.5955167Z                          <#
2026-01-11T19:28:13.5955677Z                          .SYNOPSIS
2026-01-11T19:28:13.5956876Z                              Tests whether a registry key exists.
2026-01-11T19:28:13.5957432Z                          .PARAMETER Path
2026-01-11T19:28:13.5957839Z                              Registry key path to test.
2026-01-11T19:28:13.5958435Z                          .OUTPUTS
2026-01-11T19:28:13.5959044Z                              [bool] True if key exists, else false.
2026-01-11T19:28:13.5959448Z                          #>
2026-01-11T19:28:13.5960182Z                      
2026-01-11T19:28:13.5961178Z                          [CmdletBinding()]
2026-01-11T19:28:13.5961577Z                          param(
2026-01-11T19:28:13.5961947Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5962394Z                              [string]$Path
2026-01-11T19:28:13.5963015Z                          )
2026-01-11T19:28:13.5963338Z                      
2026-01-11T19:28:13.5964811Z                          return Test-Path $Path
2026-01-11T19:28:13.5965239Z                      }
2026-01-11T19:28:13.5965672Z                      
2026-01-11T19:28:13.5966817Z                      function Test-RegistryValueExists {
2026-01-11T19:28:13.5967234Z                          <#
2026-01-11T19:28:13.5967534Z                          .SYNOPSIS
2026-01-11T19:28:13.5968194Z                              Tests whether a registry value exists.
2026-01-11T19:28:13.5968772Z                          .PARAMETER Path
2026-01-11T19:28:13.5969169Z                              Registry key path.
2026-01-11T19:28:13.5969822Z                          .PARAMETER Name
2026-01-11T19:28:13.5971034Z                              Registry value name.
2026-01-11T19:28:13.5971820Z                          .OUTPUTS
2026-01-11T19:28:13.5972279Z                              [bool] True if the value exists, else false.
2026-01-11T19:28:13.5972763Z                          #>
2026-01-11T19:28:13.5973045Z                      
2026-01-11T19:28:13.5973317Z                          [CmdletBinding()]
2026-01-11T19:28:13.5974197Z                          param(
2026-01-11T19:28:13.5974883Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5975325Z                              [string]$Path,
2026-01-11T19:28:13.5975680Z                      
2026-01-11T19:28:13.5976224Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.5976909Z                              [string]$Name
2026-01-11T19:28:13.5978114Z                          )
2026-01-11T19:28:13.5978448Z                      
2026-01-11T19:28:13.5979042Z                          try {
2026-01-11T19:28:13.5979634Z                              if (Test-Path $Path) {
2026-01-11T19:28:13.5981334Z                                  $value = Get-ItemProperty -Path $Path -Name $Name -ErrorAction SilentlyContinue
2026-01-11T19:28:13.5982115Z                                  return ($null -ne $value)
2026-01-11T19:28:13.5982519Z                              }
2026-01-11T19:28:13.5982793Z                          } catch {
2026-01-11T19:28:13.5983180Z                              return $false
2026-01-11T19:28:13.5984415Z                          }
2026-01-11T19:28:13.5984735Z                      
2026-01-11T19:28:13.5985268Z                          return $false
2026-01-11T19:28:13.5985619Z                      }
2026-01-11T19:28:13.5986208Z                      
2026-01-11T19:28:13.5986601Z                      
2026-01-11T19:28:13.5987819Z                      function Set-ProtectedRegistryValue {
2026-01-11T19:28:13.5988232Z                          <#
2026-01-11T19:28:13.5989195Z                          .SYNOPSIS
2026-01-11T19:28:13.5990079Z                              Sets a registry value on ACL-protected keys by temporarily taking ownership.
2026-01-11T19:28:13.5990918Z                          .DESCRIPTION
2026-01-11T19:28:13.5991690Z                              Some registry keys (like audio device keys under MMDevices) are owned by
2026-01-11T19:28:13.5992601Z                              TrustedInstaller and have restrictive ACLs. This function temporarily takes
2026-01-11T19:28:13.5993482Z                              ownership, grants admin permissions, sets the value, then optionally restores
2026-01-11T19:28:13.5994179Z                              the original ACL.
2026-01-11T19:28:13.5994595Z                          .PARAMETER Path
2026-01-11T19:28:13.5995058Z                              Registry key path (HKLM:\ or HKCU:\).
2026-01-11T19:28:13.5995558Z                          .PARAMETER Name
2026-01-11T19:28:13.5995978Z                              Registry value name.
2026-01-11T19:28:13.5996392Z                          .PARAMETER Value
2026-01-11T19:28:13.5996759Z                              Registry value data.
2026-01-11T19:28:13.5996991Z                          .PARAMETER Type
2026-01-11T19:28:13.5997525Z                              Registry value type (DWORD, String, etc).
2026-01-11T19:28:13.5998073Z                          .OUTPUTS
2026-01-11T19:28:13.5998489Z                              [bool] True on success, false on failure.
2026-01-11T19:28:13.5999050Z                          .NOTES
2026-01-11T19:28:13.5999959Z                              Requires Administrator. Enables SeTakeOwnershipPrivilege and SeRestorePrivilege.
2026-01-11T19:28:13.6000703Z                          #>
2026-01-11T19:28:13.6001434Z                      
2026-01-11T19:28:13.6001917Z                          [CmdletBinding()]
2026-01-11T19:28:13.6003022Z                          param(
2026-01-11T19:28:13.6003600Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.6004248Z                              [string]$Path,
2026-01-11T19:28:13.6004581Z                      
2026-01-11T19:28:13.6005775Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.6006232Z                              [string]$Name,
2026-01-11T19:28:13.6006592Z                      
2026-01-11T19:28:13.6007464Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:13.6007971Z                              [object]$Value,
2026-01-11T19:28:13.6008366Z                      
2026-01-11T19:28:13.6008829Z                              [string]$Type = "DWORD"
2026-01-11T19:28:13.6009290Z                          )
2026-01-11T19:28:13.6010469Z                      
2026-01-11T19:28:13.6011130Z                          $success = $false
2026-01-11T19:28:13.6011624Z                      
2026-01-11T19:28:13.6012557Z                          try {
2026-01-11T19:28:13.6013299Z                              # First try normal registry write
2026-01-11T19:28:13.6014002Z                              if (-not (Test-Path $Path)) {
2026-01-11T19:28:13.6015469Z                                  New-Item -Path $Path -Force -ErrorAction Stop | Out-Null
2026-01-11T19:28:13.6016016Z                              }
2026-01-11T19:28:13.6016693Z                              New-ItemProperty -Path $Path -Name $Name -Value $Value -PropertyType $Type -Force 
2026-01-11T19:28:13.6017386Z                      -ErrorAction Stop | Out-Null
2026-01-11T19:28:13.6018104Z                              Write-Log "Set protected registry value: $Path\$Name = $Value ($Type)" "SUCCESS"
2026-01-11T19:28:13.6019040Z                              $success = $true
2026-01-11T19:28:13.6019414Z                          }
2026-01-11T19:28:13.6020078Z                          catch [System.Security.SecurityException], [System.UnauthorizedAccessException] {
2026-01-11T19:28:13.6021215Z                              # Need to take ownership and grant permissions
2026-01-11T19:28:13.6021650Z                              try {
2026-01-11T19:28:13.6022078Z                                  # Convert PowerShell path to registry key path
2026-01-11T19:28:13.6022889Z                                  $regPath = $Path -replace '^HKLM:\\', 'HKEY_LOCAL_MACHINE\' -replace '^HKCU:\\', 
2026-01-11T19:28:13.6023609Z                      'HKEY_CURRENT_USER\'
2026-01-11T19:28:13.6024353Z                                  $regPath = $regPath -replace '^Microsoft.PowerShell.Core\\Registry::', ''
2026-01-11T19:28:13.6025000Z                      
2026-01-11T19:28:13.6025297Z                                  # Determine the hive and subpath
2026-01-11T19:28:13.6025837Z                                  if ($regPath -match '^HKEY_LOCAL_MACHINE\\(.+)$') {
2026-01-11T19:28:13.6026514Z                                      $hive = [Microsoft.Win32.Registry]::LocalMachine
2026-01-11T19:28:13.6027088Z                                      $subKey = $Matches[1]
2026-01-11T19:28:13.6027550Z                                  }
2026-01-11T19:28:13.6028067Z                                  elseif ($regPath -match '^HKEY_CURRENT_USER\\(.+)$') {
2026-01-11T19:28:13.6028720Z                                      $hive = [Microsoft.Win32.Registry]::CurrentUser
2026-01-11T19:28:13.6029245Z                                      $subKey = $Matches[1]
2026-01-11T19:28:13.6029636Z                                  }
2026-01-11T19:28:13.6029925Z                                  else {
2026-01-11T19:28:13.6030381Z                                      throw "Unsupported registry hive: $regPath"
2026-01-11T19:28:13.6030857Z                                  }
2026-01-11T19:28:13.6031164Z                      
2026-01-11T19:28:13.6031549Z                                  # Enable SeRestorePrivilege and SeTakeOwnershipPrivilege
2026-01-11T19:28:13.6032077Z                                  $tokenPriv = @'
2026-01-11T19:28:13.6032374Z                      using System;
2026-01-11T19:28:13.6032683Z                      using System.Runtime.InteropServices;
2026-01-11T19:28:13.6033145Z                      public class TokenPrivilege {
2026-01-11T19:28:13.6033450Z                          [DllImport("advapi32.dll", SetLastError=true)]
2026-01-11T19:28:13.6034372Z                          public static extern bool OpenProcessToken(IntPtr ProcessHandle, uint DesiredAccess, out 
2026-01-11T19:28:13.6035180Z                      IntPtr TokenHandle);
2026-01-11T19:28:13.6035592Z                          [DllImport("advapi32.dll", SetLastError=true)]
2026-01-11T19:28:13.6037655Z                          public static extern bool LookupPrivilegeValue(string lpSystemName, string lpName, out long 
2026-01-11T19:28:13.6038530Z                      lpLuid);
2026-01-11T19:28:13.6038984Z                          [DllImport("advapi32.dll", SetLastError=true)]
2026-01-11T19:28:13.6039662Z                          public static extern bool AdjustTokenPrivileges(IntPtr TokenHandle, bool 
2026-01-11T19:28:13.6040722Z                      DisableAllPrivileges, ref TOKEN_PRIVILEGES NewState, uint BufferLength, IntPtr PreviousState, 
2026-01-11T19:28:13.6041708Z                      IntPtr ReturnLength);
2026-01-11T19:28:13.6042088Z                          [StructLayout(LayoutKind.Sequential)]
2026-01-11T19:28:13.6042391Z                          public struct TOKEN_PRIVILEGES {
2026-01-11T19:28:13.6042834Z                              public uint PrivilegeCount;
2026-01-11T19:28:13.6043272Z                              public long Luid;
2026-01-11T19:28:13.6043718Z                              public uint Attributes;
2026-01-11T19:28:13.6044561Z                          }
2026-01-11T19:28:13.6044972Z                          public const uint SE_PRIVILEGE_ENABLED = 0x00000002;
2026-01-11T19:28:13.6045589Z                          public const uint TOKEN_ADJUST_PRIVILEGES = 0x0020;
2026-01-11T19:28:13.6046188Z                          public const uint TOKEN_QUERY = 0x0008;
2026-01-11T19:28:13.6046647Z                      
2026-01-11T19:28:13.6047059Z                          public static void EnablePrivilege(string privilege) {
2026-01-11T19:28:13.6047575Z                              IntPtr hToken;
2026-01-11T19:28:13.6048277Z                              if (!OpenProcessToken(System.Diagnostics.Process.GetCurrentProcess().Handle, 
2026-01-11T19:28:13.6049074Z                      TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, out hToken))
2026-01-11T19:28:13.6049429Z                                  return;
2026-01-11T19:28:13.6049818Z                              TOKEN_PRIVILEGES tp = new TOKEN_PRIVILEGES();
2026-01-11T19:28:13.6050271Z                              tp.PrivilegeCount = 1;
2026-01-11T19:28:13.6050544Z                              tp.Attributes = SE_PRIVILEGE_ENABLED;
2026-01-11T19:28:13.6051040Z                              if (!LookupPrivilegeValue(null, privilege, out tp.Luid))
2026-01-11T19:28:13.6051556Z                                  return;
2026-01-11T19:28:13.6052352Z                              AdjustTokenPrivileges(hToken, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
2026-01-11T19:28:13.6052900Z                          }
2026-01-11T19:28:13.6053172Z                      }
2026-01-11T19:28:13.6053743Z                      '@
2026-01-11T19:28:13.6054692Z                                  if (-not ([System.Management.Automation.PSTypeName]'TokenPrivilege').Type) {
2026-01-11T19:28:13.6055641Z                                      Add-Type -TypeDefinition $tokenPriv -Language CSharp
2026-01-11T19:28:13.6056263Z                                  }
2026-01-11T19:28:13.6056871Z                                  [TokenPrivilege]::EnablePrivilege("SeTakeOwnershipPrivilege")
2026-01-11T19:28:13.6057696Z                                  [TokenPrivilege]::EnablePrivilege("SeRestorePrivilege")
2026-01-11T19:28:13.6058248Z                      
2026-01-11T19:28:13.6058634Z                                  # Open the key with TakeOwnership permission
2026-01-11T19:28:13.6059174Z                                  $key = $hive.OpenSubKey($subKey, 
2026-01-11T19:28:13.6059431Z                      [Microsoft.Win32.RegistryKeyPermissionCheck]::ReadWriteSubTree,
2026-01-11T19:28:13.6069472Z                                      [System.Security.AccessControl.RegistryRights]::TakeOwnership)
2026-01-11T19:28:13.6069588Z                      
2026-01-11T19:28:13.6069951Z                                  if ($null -eq $key) {
2026-01-11T19:28:13.6070230Z                                      throw "Cannot open registry key for ownership: $subKey"
2026-01-11T19:28:13.6070331Z                                  }
2026-01-11T19:28:13.6070431Z                      
2026-01-11T19:28:13.6070630Z                                  # Take ownership as Administrators
2026-01-11T19:28:13.6071136Z                                  $adminSid = New-Object System.Security.Principal.SecurityIdentifier("S-1-5-32-544")
2026-01-11T19:28:13.6071255Z                                  $acl = 
2026-01-11T19:28:13.6071759Z                      $key.GetAccessControl([System.Security.AccessControl.AccessControlSections]::Owner)
2026-01-11T19:28:13.6071915Z                                  $acl.SetOwner($adminSid)
2026-01-11T19:28:13.6072079Z                                  $key.SetAccessControl($acl)
2026-01-11T19:28:13.6072206Z                                  $key.Close()
2026-01-11T19:28:13.6072352Z                      
2026-01-11T19:28:13.6072542Z                                  # Re-open with ChangePermissions
2026-01-11T19:28:13.6072719Z                                  $key = $hive.OpenSubKey($subKey, 
2026-01-11T19:28:13.6073375Z                      [Microsoft.Win32.RegistryKeyPermissionCheck]::ReadWriteSubTree,
2026-01-11T19:28:13.6073777Z                                      [System.Security.AccessControl.RegistryRights]::ChangePermissions)
2026-01-11T19:28:13.6073868Z                      
2026-01-11T19:28:13.6074062Z                                  # Grant Administrators full control
2026-01-11T19:28:13.6074233Z                                  $acl = $key.GetAccessControl()
2026-01-11T19:28:13.6074610Z                                  $rule = New-Object System.Security.AccessControl.RegistryAccessRule(
2026-01-11T19:28:13.6074741Z                                      $adminSid,
2026-01-11T19:28:13.6075103Z                                      [System.Security.AccessControl.RegistryRights]::FullControl,
2026-01-11T19:28:13.6075436Z                                      [System.Security.AccessControl.InheritanceFlags]::None,
2026-01-11T19:28:13.6075820Z                                      [System.Security.AccessControl.PropagationFlags]::None,
2026-01-11T19:28:13.6076162Z                                      [System.Security.AccessControl.AccessControlType]::Allow)
2026-01-11T19:28:13.6076320Z                                  $acl.AddAccessRule($rule)
2026-01-11T19:28:13.6076500Z                                  $key.SetAccessControl($acl)
2026-01-11T19:28:13.6076858Z                                  $key.Close()
2026-01-11T19:28:13.6077281Z                      
2026-01-11T19:28:13.6078141Z                                  # Now set the value
2026-01-11T19:28:13.6078828Z                                  New-ItemProperty -Path $Path -Name $Name -Value $Value -PropertyType $Type -Force 
2026-01-11T19:28:13.6079509Z                      -ErrorAction Stop | Out-Null
2026-01-11T19:28:13.6081073Z                                  Write-Log "Set protected registry value (after ownership change): $Path\$Name = 
2026-01-11T19:28:13.6081222Z                      $Value ($Type)" "SUCCESS"
2026-01-11T19:28:13.6081591Z                                  $success = $true
2026-01-11T19:28:13.6082014Z                      
2026-01-11T19:28:13.6082412Z                              }
2026-01-11T19:28:13.6082849Z                              catch {
2026-01-11T19:28:13.6083496Z                                  Write-Log "Cannot modify protected key: $Path\$Name - $_" "WARNING"
2026-01-11T19:28:13.6084323Z                              }
2026-01-11T19:28:13.6084983Z                          }
2026-01-11T19:28:13.6085814Z                          catch {
2026-01-11T19:28:13.6086908Z                              Write-Log "Failed to set protected registry value $Path\$Name : $_" "ERROR"
2026-01-11T19:28:13.6087376Z                          }
2026-01-11T19:28:13.6088273Z                      
2026-01-11T19:28:13.6089322Z                          return $success
2026-01-11T19:28:13.6089445Z                      }
2026-01-11T19:28:13.6090427Z                      
2026-01-11T19:28:13.6090649Z                      
2026-01-11T19:28:13.6091739Z                      Export-ModuleMember -Function @(
2026-01-11T19:28:13.6091887Z                          'Backup-RegistryKey',
2026-01-11T19:28:13.6092651Z                          'Restore-RegistryKey',
2026-01-11T19:28:13.6093515Z                          'Set-RegistryValue',
2026-01-11T19:28:13.6094327Z                          'Set-ProtectedRegistryValue',
2026-01-11T19:28:13.6095288Z                          'Get-RegistryValue',
2026-01-11T19:28:13.6096081Z                          'Remove-RegistryValue',
2026-01-11T19:28:13.6096223Z                          'Test-RegistryKeyExists',
2026-01-11T19:28:13.6096832Z                          'Test-RegistryValueExists'
2026-01-11T19:28:13.6097816Z                      )
2026-01-11T19:28:13.6098260Z                      
2026-01-11T19:28:13.6099557Z [32;1mParent             : [0m
2026-01-11T19:28:13.6099586Z 
2026-01-11T19:28:13.6123863Z [32;1mAttributes         : [0m{}
2026-01-11T19:28:13.6124091Z [32;1mUsingStatements    : [0m{}
2026-01-11T19:28:13.6125632Z [32;1mParamBlock         : [0m
2026-01-11T19:28:13.6126037Z [32;1mBeginBlock         : [0m
2026-01-11T19:28:13.6127109Z [32;1mProcessBlock       : [0m
2026-01-11T19:28:13.6275366Z [32;1mEndBlock           : [0mImport-Module (Join-Path $PSScriptRoot "..\core\logger.psm1") -Force -Global
2026-01-11T19:28:13.6275807Z                      Import-Module (Join-Path $PSScriptRoot "..\core\registry.psm1") -Force -Global
2026-01-11T19:28:13.6275903Z                      
2026-01-11T19:28:13.6275990Z                      
2026-01-11T19:28:13.6276291Z                      
2026-01-11T19:28:13.6276731Z                      function Test-X3DCpu {
2026-01-11T19:28:13.6277974Z                          <#
2026-01-11T19:28:13.6279091Z                          .SYNOPSIS
2026-01-11T19:28:13.6279700Z                              Detects whether the system CPU is a Ryzen X3D model.
2026-01-11T19:28:13.6280732Z                          .DESCRIPTION
2026-01-11T19:28:13.6282258Z                              Queries Win32_Processor and checks against known X3D model substrings.
2026-01-11T19:28:13.6282413Z                          .OUTPUTS
2026-01-11T19:28:13.6282786Z                              [bool] True if an X3D CPU is detected, else false.
2026-01-11T19:28:13.6283665Z                          #>
2026-01-11T19:28:13.6284436Z                          try {
2026-01-11T19:28:13.6284934Z                              $cpuInfo = Get-CimInstance Win32_Processor -ErrorAction Stop
2026-01-11T19:28:13.6286107Z                              $isX3D = $cpuInfo.Name -like "*7900X3D*" -or $cpuInfo.Name -like "*7950X3D*" -or
2026-01-11T19:28:13.6286605Z                                       $cpuInfo.Name -like "*5800X3D*" -or $cpuInfo.Name -like "*5600X3D*" -or
2026-01-11T19:28:13.6287439Z                                       $cpuInfo.Name -like "*9800X3D*" -or $cpuInfo.Name -like "*9900X3D*" -or
2026-01-11T19:28:13.6287680Z                                       $cpuInfo.Name -like "*9950X3D*"
2026-01-11T19:28:13.6287806Z                      
2026-01-11T19:28:13.6287998Z                              if ($isX3D) {
2026-01-11T19:28:13.6289364Z                                  Write-Log "AMD Ryzen X3D CPU detected: $($cpuInfo.Name)" "INFO"
2026-01-11T19:28:13.6289503Z                              }
2026-01-11T19:28:13.6289752Z                      
2026-01-11T19:28:13.6289931Z                              return $isX3D
2026-01-11T19:28:13.6290842Z                          } catch {
2026-01-11T19:28:13.6291700Z                              Write-Log "Error detecting CPU type: $_" "ERROR"
2026-01-11T19:28:13.6292399Z                              return $false
2026-01-11T19:28:13.6293398Z                          }
2026-01-11T19:28:13.6293606Z                      }
2026-01-11T19:28:13.6294732Z                      
2026-01-11T19:28:13.6294919Z                      
2026-01-11T19:28:13.6296274Z                      function Test-AMDChipsetDrivers {
2026-01-11T19:28:13.6296388Z                          <#
2026-01-11T19:28:13.6297336Z                          .SYNOPSIS
2026-01-11T19:28:13.6298799Z                              Verifies AMD chipset driver components required for X3D scheduling.
2026-01-11T19:28:13.6299261Z                          .DESCRIPTION
2026-01-11T19:28:13.6300474Z                              Checks for the 3D V-Cache Performance Optimizer and the PPM provisioning
2026-01-11T19:28:13.6300650Z                              driver using PnP device queries.
2026-01-11T19:28:13.6300976Z                          .OUTPUTS
2026-01-11T19:28:13.6301898Z                              [bool] True when required components are present.
2026-01-11T19:28:13.6302009Z                          #>
2026-01-11T19:28:13.6303128Z                          try {
2026-01-11T19:28:13.6303546Z                              Write-Log "Checking for AMD Chipset Drivers (required for X3D)..." "INFO"
2026-01-11T19:28:13.6304460Z                      
2026-01-11T19:28:13.6306487Z                              $vCacheOptimizer = Get-PnpDevice -FriendlyName "*3D V-Cache*" -ErrorAction 
2026-01-11T19:28:13.6306623Z                      SilentlyContinue
2026-01-11T19:28:13.6306721Z                      
2026-01-11T19:28:13.6307522Z                              $ppmDriver = Get-PnpDevice -FriendlyName "*Provisioning Packages*" -ErrorAction 
2026-01-11T19:28:13.6307681Z                      SilentlyContinue
2026-01-11T19:28:13.6308675Z                      
2026-01-11T19:28:13.6309712Z                              if ($vCacheOptimizer -and $ppmDriver) {
2026-01-11T19:28:13.6310695Z                                  Write-Log "‚úì AMD Chipset Drivers detected (3D V-Cache optimizer and Provisioning 
2026-01-11T19:28:13.6310862Z                      Packages)" "SUCCESS"
2026-01-11T19:28:13.6312080Z                                  return $true
2026-01-11T19:28:13.6312250Z                              } elseif ($vCacheOptimizer) {
2026-01-11T19:28:13.6314027Z                                  Write-Log "‚ö† AMD 3D V-Cache optimizer found, but Provisioning Packages driver 
2026-01-11T19:28:13.6314235Z                      missing" "ERROR"
2026-01-11T19:28:13.6314915Z                                  Write-Log "Install AMD Chipset Drivers: https://www.amd.com/en/support" "ERROR"
2026-01-11T19:28:13.6315289Z                                  return $false
2026-01-11T19:28:13.6316073Z                              } elseif ($ppmDriver) {
2026-01-11T19:28:13.6317572Z                                  Write-Log "‚ö† AMD Provisioning Packages driver found, but 3D V-Cache optimizer 
2026-01-11T19:28:13.6317711Z                      missing" "ERROR"
2026-01-11T19:28:13.6318721Z                                  Write-Log "Install AMD Chipset Drivers: https://www.amd.com/en/support" "ERROR"
2026-01-11T19:28:13.6319647Z                                  return $false
2026-01-11T19:28:13.6320064Z                              } else {
2026-01-11T19:28:13.6320638Z                                  Write-Log "‚úó AMD Chipset Drivers NOT DETECTED!" "ERROR"
2026-01-11T19:28:13.6321112Z                                  Write-Log "Install AMD Chipset Drivers from https://www.amd.com/en/support" "ERROR"
2026-01-11T19:28:13.6321592Z                                  Write-Log "Required for X3D thread steering - CPPC optimizations won't work without 
2026-01-11T19:28:13.6321738Z                      them!" "ERROR"
2026-01-11T19:28:13.6322797Z                                  return $false
2026-01-11T19:28:13.6323812Z                              }
2026-01-11T19:28:13.6323944Z                          } catch {
2026-01-11T19:28:13.6325186Z                              Write-Log "Error checking AMD chipset drivers: $_" "ERROR"
2026-01-11T19:28:13.6325295Z                              return $false
2026-01-11T19:28:13.6326118Z                          }
2026-01-11T19:28:13.6326584Z                      }
2026-01-11T19:28:13.6327563Z                      
2026-01-11T19:28:13.6327703Z                      
2026-01-11T19:28:13.6328934Z                      function Test-X3DOptimizations {
2026-01-11T19:28:13.6329047Z                          <#
2026-01-11T19:28:13.6329755Z                          .SYNOPSIS
2026-01-11T19:28:13.6330867Z                              Verifies that X3D-related registry settings are applied.
2026-01-11T19:28:13.6331016Z                          .DESCRIPTION
2026-01-11T19:28:13.6332382Z                              Ensures CPPC is enabled, HeteroPolicy overrides are removed, and Game Bar
2026-01-11T19:28:13.6332560Z                              overlay settings are disabled for lower overhead.
2026-01-11T19:28:13.6332829Z                          .OUTPUTS
2026-01-11T19:28:13.6334148Z                              [bool] True if all checks pass, else false.
2026-01-11T19:28:13.6334273Z                          #>
2026-01-11T19:28:13.6335189Z                          $allPassed = $true
2026-01-11T19:28:13.6335967Z                      
2026-01-11T19:28:13.6336836Z                          Write-Log "Verifying AMD X3D optimizations..." "INFO"
2026-01-11T19:28:13.6337466Z                      
2026-01-11T19:28:13.6338502Z                          if (-not (Test-AMDChipsetDrivers)) {
2026-01-11T19:28:13.6339866Z                              Write-Log "WARNING: AMD Chipset Drivers not detected - X3D optimizations may not work!" 
2026-01-11T19:28:13.6339979Z                      "ERROR"
2026-01-11T19:28:13.6340297Z                          }
2026-01-11T19:28:13.6341114Z                      
2026-01-11T19:28:13.6342345Z                          $cppcValue = Get-RegistryValue -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Power" -Name 
2026-01-11T19:28:13.6342484Z                      "CppcEnable"
2026-01-11T19:28:13.6343585Z                          if ($cppcValue -eq 1) {
2026-01-11T19:28:13.6343993Z                              Write-Log "‚úì CPPC is ENABLED (correct)" "SUCCESS"
2026-01-11T19:28:13.6344096Z                          } else {
2026-01-11T19:28:13.6346267Z                              Write-Log "‚úó CPPC is not enabled correctly (current value: $cppcValue, expected: 1)" 
2026-01-11T19:28:13.6346417Z                      "ERROR"
2026-01-11T19:28:13.6346558Z                              $allPassed = $false
2026-01-11T19:28:13.6346668Z                          }
2026-01-11T19:28:13.6347381Z                      
2026-01-11T19:28:13.6348875Z                          $heteroExists = Test-RegistryValueExists -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Power" 
2026-01-11T19:28:13.6349030Z                      -Name "HeteroPolicy"
2026-01-11T19:28:13.6349732Z                          if (-not $heteroExists) {
2026-01-11T19:28:13.6350252Z                              Write-Log "‚úì HeteroPolicy removed (correct)" "SUCCESS"
2026-01-11T19:28:13.6350478Z                          } else {
2026-01-11T19:28:13.6351619Z                              Write-Log "‚úó HeteroPolicy still exists (should be removed)" "ERROR"
2026-01-11T19:28:13.6351785Z                              $allPassed = $false
2026-01-11T19:28:13.6352056Z                          }
2026-01-11T19:28:13.6352793Z                      
2026-01-11T19:28:13.6353973Z                          $gameDvrPath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\GameDVR"
2026-01-11T19:28:13.6354880Z                          $appCaptureDisabled = (Get-RegistryValue -Path $gameDvrPath -Name "AppCaptureEnabled") -eq 0
2026-01-11T19:28:13.6355443Z                          $gameDvrDisabled = (Get-RegistryValue -Path $gameDvrPath -Name "GameDVR_Enabled") -eq 0
2026-01-11T19:28:13.6355577Z                      
2026-01-11T19:28:13.6357110Z                          if ($appCaptureDisabled -and $gameDvrDisabled) {
2026-01-11T19:28:13.6357619Z                              Write-Log "‚úì Game Bar overlays disabled (correct)" "SUCCESS"
2026-01-11T19:28:13.6359203Z                          } else {
2026-01-11T19:28:13.6359706Z                              Write-Log "‚úó Game Bar overlay configuration incorrect" "ERROR"
2026-01-11T19:28:13.6359855Z                              $allPassed = $false
2026-01-11T19:28:13.6359961Z                          }
2026-01-11T19:28:13.6360384Z                      
2026-01-11T19:28:13.6361764Z                          return $allPassed
2026-01-11T19:28:13.6362752Z                      }
2026-01-11T19:28:13.6363551Z                      
2026-01-11T19:28:13.6363735Z                      
2026-01-11T19:28:13.6364698Z                      
2026-01-11T19:28:13.6364951Z                      
2026-01-11T19:28:13.6366183Z                      function Enable-CPPCOptimization {
2026-01-11T19:28:13.6366471Z                          <#
2026-01-11T19:28:13.6367553Z                          .SYNOPSIS
2026-01-11T19:28:13.6368089Z                              Enables CPPC registry settings for X3D scheduling.
2026-01-11T19:28:13.6368579Z                          .DESCRIPTION
2026-01-11T19:28:13.6370143Z                              Sets CppcEnable and removes HeteroPolicy overrides that conflict with
2026-01-11T19:28:13.6370551Z                              AMD X3D scheduling.
2026-01-11T19:28:13.6370891Z                          .OUTPUTS
2026-01-11T19:28:13.6372101Z                              None.
2026-01-11T19:28:13.6372577Z                          .NOTES
2026-01-11T19:28:13.6373720Z                              Backs up the parent registry key before modification.
2026-01-11T19:28:13.6374804Z                          #>
2026-01-11T19:28:13.6375069Z                          $regPath = "HKLM:\SYSTEM\CurrentControlSet\Control\Power"
2026-01-11T19:28:13.6376230Z                      
2026-01-11T19:28:13.6376420Z                          Backup-RegistryKey -Path $regPath
2026-01-11T19:28:13.6377450Z                      
2026-01-11T19:28:13.6377578Z                          try {
2026-01-11T19:28:13.6379223Z                              Set-RegistryValue -Path $regPath -Name "CppcEnable" -Value 1 -Type "DWORD"
2026-01-11T19:28:13.6379513Z                              Write-Log "AMD X3D: ENABLED CPPC for proper CCD thread steering" "SUCCESS"
2026-01-11T19:28:13.6379630Z                      
2026-01-11T19:28:13.6380794Z                              if (Test-RegistryValueExists -Path $regPath -Name "HeteroPolicy") {
2026-01-11T19:28:13.6381429Z                                  Remove-RegistryValue -Path $regPath -Name "HeteroPolicy"
2026-01-11T19:28:13.6382872Z                                  Write-Log "AMD X3D: Removed HeteroPolicy registry hack (not needed for AMD)" "SUCCESS"
2026-01-11T19:28:13.6382989Z                              }
2026-01-11T19:28:13.6383070Z                      
2026-01-11T19:28:13.6384139Z                          } catch {
2026-01-11T19:28:13.6385073Z                              Write-Log "Error configuring CPPC: $_" "ERROR"
2026-01-11T19:28:13.6385478Z                              throw
2026-01-11T19:28:13.6386373Z                          }
2026-01-11T19:28:13.6386594Z                      }
2026-01-11T19:28:13.6387698Z                      
2026-01-11T19:28:13.6387907Z                      
2026-01-11T19:28:13.6389081Z                      function Set-GameBarConfiguration {
2026-01-11T19:28:13.6389792Z                          <#
2026-01-11T19:28:13.6390823Z                          .SYNOPSIS
2026-01-11T19:28:13.6392273Z                              Disables Game Bar overlays while keeping scheduler hints.
2026-01-11T19:28:13.6392473Z                          .DESCRIPTION
2026-01-11T19:28:13.6392940Z                              Disables GameDVR capture settings to reduce overhead, but keeps Game Bar
2026-01-11T19:28:13.6394205Z                              detection enabled so the OS can apply gaming heuristics.
2026-01-11T19:28:13.6394321Z                          .OUTPUTS
2026-01-11T19:28:13.6394778Z                              None.
2026-01-11T19:28:13.6396076Z                          #>
2026-01-11T19:28:13.6396216Z                          try {
2026-01-11T19:28:13.6396589Z                              $gameBarPath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\GameDVR"
2026-01-11T19:28:13.6397697Z                      
2026-01-11T19:28:13.6398937Z                              Backup-RegistryKey -Path $gameBarPath
2026-01-11T19:28:13.6399248Z                      
2026-01-11T19:28:13.6400622Z                              Set-RegistryValue -Path $gameBarPath -Name "AppCaptureEnabled" -Value 0 -Type "DWORD"
2026-01-11T19:28:13.6401086Z                              Set-RegistryValue -Path $gameBarPath -Name "GameDVR_Enabled" -Value 0 -Type "DWORD"
2026-01-11T19:28:13.6401534Z                              Write-Log "AMD X3D: Disabled Game Bar overlays and recording" "SUCCESS"
2026-01-11T19:28:13.6401655Z                      
2026-01-11T19:28:13.6402727Z                              $gameConfigPath = "HKCU:\System\GameConfigStore"
2026-01-11T19:28:13.6403113Z                              if (Test-Path $gameConfigPath) {
2026-01-11T19:28:13.6404153Z                                  Backup-RegistryKey -Path $gameConfigPath
2026-01-11T19:28:13.6404894Z                                  Set-RegistryValue -Path $gameConfigPath -Name "GameDVR_Enabled" -Value 0 -Type "DWORD"
2026-01-11T19:28:13.6405007Z                              }
2026-01-11T19:28:13.6405143Z                      
2026-01-11T19:28:13.6406530Z                              Write-Log "AMD X3D: Game Bar detection remains enabled for scheduler hints" "INFO"
2026-01-11T19:28:13.6406660Z                      
2026-01-11T19:28:13.6407912Z                          } catch {
2026-01-11T19:28:13.6408479Z                              Write-Log "Error configuring Game Bar: $_" "ERROR"
2026-01-11T19:28:13.6408893Z                              throw
2026-01-11T19:28:13.6409249Z                          }
2026-01-11T19:28:13.6410392Z                      }
2026-01-11T19:28:13.6411214Z                      
2026-01-11T19:28:13.6411667Z                      
2026-01-11T19:28:13.6412630Z                      
2026-01-11T19:28:13.6413429Z                      
2026-01-11T19:28:13.6414497Z                      function Invoke-X3DOptimizations {
2026-01-11T19:28:13.6414877Z                          <#
2026-01-11T19:28:13.6415719Z                          .SYNOPSIS
2026-01-11T19:28:13.6416258Z                              Applies all AMD X3D optimizations.
2026-01-11T19:28:13.6417252Z                          .DESCRIPTION
2026-01-11T19:28:13.6418528Z                              Confirms the CPU is X3D, warns if chipset drivers are missing, then
2026-01-11T19:28:13.6418849Z                              enables CPPC optimizations and configures Game Bar settings.
2026-01-11T19:28:13.6418995Z                          .OUTPUTS
2026-01-11T19:28:13.6420074Z                              None.
2026-01-11T19:28:13.6420501Z                          #>
2026-01-11T19:28:13.6421422Z                          if (-not (Test-X3DCpu)) {
2026-01-11T19:28:13.6422682Z                              Write-Log "No AMD X3D CPU detected - skipping X3D optimizations" "INFO"
2026-01-11T19:28:13.6423152Z                              return
2026-01-11T19:28:13.6423261Z                          }
2026-01-11T19:28:13.6424420Z                      
2026-01-11T19:28:13.6424722Z                          Write-Log "Applying AMD Ryzen X3D optimizations..." "INFO"
2026-01-11T19:28:13.6425005Z                      
2026-01-11T19:28:13.6426182Z                          $chipsetDriversInstalled = Test-AMDChipsetDrivers
2026-01-11T19:28:13.6426438Z                          if (-not $chipsetDriversInstalled) {
2026-01-11T19:28:13.6426560Z                              Write-Host ""
2026-01-11T19:28:13.6427919Z                              Write-Host "  ‚ö†Ô∏è  WARNING: AMD Chipset Drivers NOT DETECTED!" -ForegroundColor Yellow
2026-01-11T19:28:13.6428743Z                              Write-Host "  The CPPC optimizations will be applied, but they WON'T WORK without:" 
2026-01-11T19:28:13.6429020Z                      -ForegroundColor Yellow
2026-01-11T19:28:13.6429722Z                              Write-Host "    - AMD 3D V-Cache Performance Optimizer" -ForegroundColor White
2026-01-11T19:28:13.6430808Z                              Write-Host "    - AMD PPM Provisioning File Driver" -ForegroundColor White
2026-01-11T19:28:13.6430965Z                              Write-Host ""
2026-01-11T19:28:13.6432076Z                              Write-Host "  Download from: https://www.amd.com/en/support" -ForegroundColor Cyan
2026-01-11T19:28:13.6432895Z                              Write-Host "  (Added to POST-SETUP-CHECKLIST.txt)" -ForegroundColor Gray
2026-01-11T19:28:13.6433054Z                              Write-Host ""
2026-01-11T19:28:13.6433141Z                          }
2026-01-11T19:28:13.6433868Z                      
2026-01-11T19:28:13.6434909Z                          try {
2026-01-11T19:28:13.6435094Z                              Enable-CPPCOptimization
2026-01-11T19:28:13.6436096Z                      
2026-01-11T19:28:13.6436280Z                              Set-GameBarConfiguration
2026-01-11T19:28:13.6437277Z                      
2026-01-11T19:28:13.6438719Z                              Write-Log "AMD X3D optimizations complete" "SUCCESS"
2026-01-11T19:28:13.6438811Z                      
2026-01-11T19:28:13.6440023Z                              if (-not $chipsetDriversInstalled) {
2026-01-11T19:28:13.6440350Z                                  Write-Log "Install AMD Chipset Drivers after reboot!" "ERROR"
2026-01-11T19:28:13.6440937Z                                  Write-Log "Download: https://www.amd.com/en/support" "ERROR"
2026-01-11T19:28:13.6441065Z                              }
2026-01-11T19:28:13.6442029Z                      
2026-01-11T19:28:13.6443154Z                              Write-Log "BIOS: Set 'CPPC Preferred Cores' to AUTO or DRIVER (not DISABLED)" "INFO"
2026-01-11T19:28:13.6443289Z                      
2026-01-11T19:28:13.6444006Z                          } catch {
2026-01-11T19:28:13.6444321Z                              Write-Log "Error applying X3D optimizations: $_" "ERROR"
2026-01-11T19:28:13.6445430Z                              throw
2026-01-11T19:28:13.6446213Z                          }
2026-01-11T19:28:13.6446947Z                      }
2026-01-11T19:28:13.6447643Z                      
2026-01-11T19:28:13.6448362Z                      
2026-01-11T19:28:13.6448940Z                      function Undo-X3DOptimizations {
2026-01-11T19:28:13.6449835Z                          <#
2026-01-11T19:28:13.6450632Z                          .SYNOPSIS
2026-01-11T19:28:13.6451909Z                              Reverts X3D-specific registry changes.
2026-01-11T19:28:13.6452086Z                          .DESCRIPTION
2026-01-11T19:28:13.6452829Z                              Restores backed up registry values for CPPC and Game Bar settings.
2026-01-11T19:28:13.6452951Z                          .OUTPUTS
2026-01-11T19:28:13.6453767Z                              None.
2026-01-11T19:28:13.6454563Z                          #>
2026-01-11T19:28:13.6455654Z                          Write-Log "Rolling back AMD X3D optimizations..." "INFO"
2026-01-11T19:28:13.6456254Z                      
2026-01-11T19:28:13.6457647Z                          try {
2026-01-11T19:28:13.6458130Z                              $powerPath = "HKLM:\SYSTEM\CurrentControlSet\Control\Power"
2026-01-11T19:28:13.6458357Z                              if (Restore-RegistryKey -Path $powerPath) {
2026-01-11T19:28:13.6458908Z                                  Write-Log "Restored CPPC/power registry settings" "SUCCESS"
2026-01-11T19:28:13.6459744Z                              }
2026-01-11T19:28:13.6459930Z                      
2026-01-11T19:28:13.6461576Z                              $gameBarPath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\GameDVR"
2026-01-11T19:28:13.6462077Z                              if (Restore-RegistryKey -Path $gameBarPath) {
2026-01-11T19:28:13.6462354Z                                  Write-Log "Restored Game Bar registry settings" "SUCCESS"
2026-01-11T19:28:13.6462692Z                              }
2026-01-11T19:28:13.6463093Z                      
2026-01-11T19:28:13.6464102Z                              $gameConfigPath = "HKCU:\System\GameConfigStore"
2026-01-11T19:28:13.6464518Z                              if (Test-Path $gameConfigPath) {
2026-01-11T19:28:13.6465398Z                                  Restore-RegistryKey -Path $gameConfigPath
2026-01-11T19:28:13.6465816Z                              }
2026-01-11T19:28:13.6466585Z                      
2026-01-11T19:28:13.6467697Z                              Write-Log "AMD X3D optimization rollback complete" "SUCCESS"
2026-01-11T19:28:13.6468087Z                      
2026-01-11T19:28:13.6468889Z                          } catch {
2026-01-11T19:28:13.6469819Z                              Write-Log "Error during rollback: $_" "ERROR"
2026-01-11T19:28:13.6470232Z                              throw
2026-01-11T19:28:13.6471155Z                          }
2026-01-11T19:28:13.6471610Z                      }
2026-01-11T19:28:13.6472001Z                      
2026-01-11T19:28:13.6472921Z                      
2026-01-11T19:28:13.6474051Z                      Export-ModuleMember -Function @(
2026-01-11T19:28:13.6474189Z                          'Test-X3DCpu',
2026-01-11T19:28:13.6474940Z                          'Test-AMDChipsetDrivers',
2026-01-11T19:28:13.6475978Z                          'Enable-CPPCOptimization',
2026-01-11T19:28:13.6476453Z                          'Set-GameBarConfiguration',
2026-01-11T19:28:13.6476917Z                          'Test-X3DOptimizations',
2026-01-11T19:28:13.6478042Z                          'Invoke-X3DOptimizations',
2026-01-11T19:28:13.6478531Z                          'Undo-X3DOptimizations'
2026-01-11T19:28:13.6479055Z                      )
2026-01-11T19:28:13.6479490Z [32;1mCleanBlock         : [0m
2026-01-11T19:28:13.6480633Z [32;1mDynamicParamBlock  : [0m
2026-01-11T19:28:13.6481500Z [32;1mScriptRequirements : [0mSystem.Management.Automation.Language.ScriptRequirements
2026-01-11T19:28:13.6483118Z [32;1mExtent             : [0m<#
2026-01-11T19:28:13.6483441Z                      .SYNOPSIS
2026-01-11T19:28:13.6484495Z                          AMD Ryzen X3D-specific optimizations and validation.
2026-01-11T19:28:13.6484644Z                      .DESCRIPTION
2026-01-11T19:28:13.6486130Z                          Applies CPPC registry configuration and Game Bar settings that help Windows
2026-01-11T19:28:13.6486520Z                          schedule threads correctly on Ryzen X3D CPUs. Includes chipset driver checks
2026-01-11T19:28:13.6486662Z                          and rollback helpers.
2026-01-11T19:28:13.6487099Z                      .NOTES
2026-01-11T19:28:13.6488551Z                          Requires Administrator. Intended only for supported X3D CPUs.
2026-01-11T19:28:13.6488689Z                      #>
2026-01-11T19:28:13.6489128Z                      #Requires -RunAsAdministrator
2026-01-11T19:28:13.6489605Z                      
2026-01-11T19:28:13.6490712Z                      
2026-01-11T19:28:13.6490888Z                      
2026-01-11T19:28:13.6492045Z                      Import-Module (Join-Path $PSScriptRoot "..\core\logger.psm1") -Force -Global
2026-01-11T19:28:13.6492516Z                      Import-Module (Join-Path $PSScriptRoot "..\core\registry.psm1") -Force -Global
2026-01-11T19:28:13.6493438Z                      
2026-01-11T19:28:13.6493617Z                      
2026-01-11T19:28:13.6494035Z                      
2026-01-11T19:28:13.6495198Z                      function Test-X3DCpu {
2026-01-11T19:28:13.6495287Z                          <#
2026-01-11T19:28:13.6496518Z                          .SYNOPSIS
2026-01-11T19:28:13.6496894Z                              Detects whether the system CPU is a Ryzen X3D model.
2026-01-11T19:28:13.6498294Z                          .DESCRIPTION
2026-01-11T19:28:13.6498623Z                              Queries Win32_Processor and checks against known X3D model substrings.
2026-01-11T19:28:13.6499050Z                          .OUTPUTS
2026-01-11T19:28:13.6500099Z                              [bool] True if an X3D CPU is detected, else false.
2026-01-11T19:28:13.6500237Z                          #>
2026-01-11T19:28:13.6500998Z                          try {
2026-01-11T19:28:13.6502040Z                              $cpuInfo = Get-CimInstance Win32_Processor -ErrorAction Stop
2026-01-11T19:28:13.6502828Z                              $isX3D = $cpuInfo.Name -like "*7900X3D*" -or $cpuInfo.Name -like "*7950X3D*" -or
2026-01-11T19:28:13.6503439Z                                       $cpuInfo.Name -like "*5800X3D*" -or $cpuInfo.Name -like "*5600X3D*" -or
2026-01-11T19:28:13.6504057Z                                       $cpuInfo.Name -like "*9800X3D*" -or $cpuInfo.Name -like "*9900X3D*" -or
2026-01-11T19:28:13.6504512Z                                       $cpuInfo.Name -like "*9950X3D*"
2026-01-11T19:28:13.6505118Z                      
2026-01-11T19:28:13.6505995Z                              if ($isX3D) {
2026-01-11T19:28:13.6506926Z                                  Write-Log "AMD Ryzen X3D CPU detected: $($cpuInfo.Name)" "INFO"
2026-01-11T19:28:13.6507231Z                              }
2026-01-11T19:28:13.6508454Z                      
2026-01-11T19:28:13.6508587Z                              return $isX3D
2026-01-11T19:28:13.6509408Z                          } catch {
2026-01-11T19:28:13.6510728Z                              Write-Log "Error detecting CPU type: $_" "ERROR"
2026-01-11T19:28:13.6510945Z                              return $false
2026-01-11T19:28:13.6511049Z                          }
2026-01-11T19:28:13.6512231Z                      }
2026-01-11T19:28:13.6512335Z                      
2026-01-11T19:28:13.6512575Z                      
2026-01-11T19:28:13.6513161Z                      function Test-AMDChipsetDrivers {
2026-01-11T19:28:13.6513901Z                          <#
2026-01-11T19:28:13.6514798Z                          .SYNOPSIS
2026-01-11T19:28:13.6515187Z                              Verifies AMD chipset driver components required for X3D scheduling.
2026-01-11T19:28:13.6515835Z                          .DESCRIPTION
2026-01-11T19:28:13.6516998Z                              Checks for the 3D V-Cache Performance Optimizer and the PPM provisioning
2026-01-11T19:28:13.6517169Z                              driver using PnP device queries.
2026-01-11T19:28:13.6518346Z                          .OUTPUTS
2026-01-11T19:28:13.6519296Z                              [bool] True when required components are present.
2026-01-11T19:28:13.6519832Z                          #>
2026-01-11T19:28:13.6519943Z                          try {
2026-01-11T19:28:13.6521278Z                              Write-Log "Checking for AMD Chipset Drivers (required for X3D)..." "INFO"
2026-01-11T19:28:13.6521362Z                      
2026-01-11T19:28:13.6523085Z                              $vCacheOptimizer = Get-PnpDevice -FriendlyName "*3D V-Cache*" -ErrorAction 
2026-01-11T19:28:13.6523586Z                      SilentlyContinue
2026-01-11T19:28:13.6523802Z                      
2026-01-11T19:28:13.6524735Z                              $ppmDriver = Get-PnpDevice -FriendlyName "*Provisioning Packages*" -ErrorAction 
2026-01-11T19:28:13.6525132Z                      SilentlyContinue
2026-01-11T19:28:13.6525461Z                      
2026-01-11T19:28:13.6526681Z                              if ($vCacheOptimizer -and $ppmDriver) {
2026-01-11T19:28:13.6527430Z                                  Write-Log "‚úì AMD Chipset Drivers detected (3D V-Cache optimizer and Provisioning 
2026-01-11T19:28:13.6527865Z                      Packages)" "SUCCESS"
2026-01-11T19:28:13.6529042Z                                  return $true
2026-01-11T19:28:13.6529507Z                              } elseif ($vCacheOptimizer) {
2026-01-11T19:28:13.6531087Z                                  Write-Log "‚ö† AMD 3D V-Cache optimizer found, but Provisioning Packages driver 
2026-01-11T19:28:13.6531243Z                      missing" "ERROR"
2026-01-11T19:28:13.6532064Z                                  Write-Log "Install AMD Chipset Drivers: https://www.amd.com/en/support" "ERROR"
2026-01-11T19:28:13.6532205Z                                  return $false
2026-01-11T19:28:13.6532583Z                              } elseif ($ppmDriver) {
2026-01-11T19:28:13.6534248Z                                  Write-Log "‚ö† AMD Provisioning Packages driver found, but 3D V-Cache optimizer 
2026-01-11T19:28:13.6534396Z                      missing" "ERROR"
2026-01-11T19:28:13.6535945Z                                  Write-Log "Install AMD Chipset Drivers: https://www.amd.com/en/support" "ERROR"
2026-01-11T19:28:13.6536096Z                                  return $false
2026-01-11T19:28:13.6536283Z                              } else {
2026-01-11T19:28:13.6537679Z                                  Write-Log "‚úó AMD Chipset Drivers NOT DETECTED!" "ERROR"
2026-01-11T19:28:13.6538890Z                                  Write-Log "Install AMD Chipset Drivers from https://www.amd.com/en/support" "ERROR"
2026-01-11T19:28:13.6539618Z                                  Write-Log "Required for X3D thread steering - CPPC optimizations won't work without 
2026-01-11T19:28:13.6539834Z                      them!" "ERROR"
2026-01-11T19:28:13.6540445Z                                  return $false
2026-01-11T19:28:13.6541182Z                              }
2026-01-11T19:28:13.6542086Z                          } catch {
2026-01-11T19:28:13.6543051Z                              Write-Log "Error checking AMD chipset drivers: $_" "ERROR"
2026-01-11T19:28:13.6543888Z                              return $false
2026-01-11T19:28:13.6544327Z                          }
2026-01-11T19:28:13.6545224Z                      }
2026-01-11T19:28:13.6546010Z                      
2026-01-11T19:28:13.6546610Z                      
2026-01-11T19:28:13.6547823Z                      function Test-X3DOptimizations {
2026-01-11T19:28:13.6548244Z                          <#
2026-01-11T19:28:13.6548453Z                          .SYNOPSIS
2026-01-11T19:28:13.6549574Z                              Verifies that X3D-related registry settings are applied.
2026-01-11T19:28:13.6549726Z                          .DESCRIPTION
2026-01-11T19:28:13.6550178Z                              Ensures CPPC is enabled, HeteroPolicy overrides are removed, and Game Bar
2026-01-11T19:28:13.6551325Z                              overlay settings are disabled for lower overhead.
2026-01-11T19:28:13.6551636Z                          .OUTPUTS
2026-01-11T19:28:13.6552762Z                              [bool] True if all checks pass, else false.
2026-01-11T19:28:13.6553085Z                          #>
2026-01-11T19:28:13.6554065Z                          $allPassed = $true
2026-01-11T19:28:13.6554168Z                      
2026-01-11T19:28:13.6554940Z                          Write-Log "Verifying AMD X3D optimizations..." "INFO"
2026-01-11T19:28:13.6555679Z                      
2026-01-11T19:28:13.6556792Z                          if (-not (Test-AMDChipsetDrivers)) {
2026-01-11T19:28:13.6558145Z                              Write-Log "WARNING: AMD Chipset Drivers not detected - X3D optimizations may not work!" 
2026-01-11T19:28:13.6558282Z                      "ERROR"
2026-01-11T19:28:13.6558715Z                          }
2026-01-11T19:28:13.6559845Z                      
2026-01-11T19:28:13.6561302Z                          $cppcValue = Get-RegistryValue -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Power" -Name 
2026-01-11T19:28:13.6561435Z                      "CppcEnable"
2026-01-11T19:28:13.6561567Z                          if ($cppcValue -eq 1) {
2026-01-11T19:28:13.6562296Z                              Write-Log "‚úì CPPC is ENABLED (correct)" "SUCCESS"
2026-01-11T19:28:13.6563033Z                          } else {
2026-01-11T19:28:13.6564300Z                              Write-Log "‚úó CPPC is not enabled correctly (current value: $cppcValue, expected: 1)" 
2026-01-11T19:28:13.6564428Z                      "ERROR"
2026-01-11T19:28:13.6565017Z                              $allPassed = $false
2026-01-11T19:28:13.6565951Z                          }
2026-01-11T19:28:13.6566053Z                      
2026-01-11T19:28:13.6567801Z                          $heteroExists = Test-RegistryValueExists -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Power" 
2026-01-11T19:28:13.6567954Z                      -Name "HeteroPolicy"
2026-01-11T19:28:13.6568129Z                          if (-not $heteroExists) {
2026-01-11T19:28:13.6568541Z                              Write-Log "‚úì HeteroPolicy removed (correct)" "SUCCESS"
2026-01-11T19:28:13.6568642Z                          } else {
2026-01-11T19:28:13.6569852Z                              Write-Log "‚úó HeteroPolicy still exists (should be removed)" "ERROR"
2026-01-11T19:28:13.6569987Z                              $allPassed = $false
2026-01-11T19:28:13.6570424Z                          }
2026-01-11T19:28:13.6571212Z                      
2026-01-11T19:28:13.6571978Z                          $gameDvrPath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\GameDVR"
2026-01-11T19:28:13.6573176Z                          $appCaptureDisabled = (Get-RegistryValue -Path $gameDvrPath -Name "AppCaptureEnabled") -eq 0
2026-01-11T19:28:13.6574091Z                          $gameDvrDisabled = (Get-RegistryValue -Path $gameDvrPath -Name "GameDVR_Enabled") -eq 0
2026-01-11T19:28:13.6574216Z                      
2026-01-11T19:28:13.6574442Z                          if ($appCaptureDisabled -and $gameDvrDisabled) {
2026-01-11T19:28:13.6574883Z                              Write-Log "‚úì Game Bar overlays disabled (correct)" "SUCCESS"
2026-01-11T19:28:13.6575001Z                          } else {
2026-01-11T19:28:13.6575495Z                              Write-Log "‚úó Game Bar overlay configuration incorrect" "ERROR"
2026-01-11T19:28:13.6576175Z                              $allPassed = $false
2026-01-11T19:28:13.6577217Z                          }
2026-01-11T19:28:13.6577676Z                      
2026-01-11T19:28:13.6578548Z                          return $allPassed
2026-01-11T19:28:13.6579629Z                      }
2026-01-11T19:28:13.6579735Z                      
2026-01-11T19:28:13.6580676Z                      
2026-01-11T19:28:13.6581596Z                      
2026-01-11T19:28:13.6581798Z                      
2026-01-11T19:28:13.6582969Z                      function Enable-CPPCOptimization {
2026-01-11T19:28:13.6583415Z                          <#
2026-01-11T19:28:13.6584526Z                          .SYNOPSIS
2026-01-11T19:28:13.6584761Z                              Enables CPPC registry settings for X3D scheduling.
2026-01-11T19:28:13.6585138Z                          .DESCRIPTION
2026-01-11T19:28:13.6586638Z                              Sets CppcEnable and removes HeteroPolicy overrides that conflict with
2026-01-11T19:28:13.6586910Z                              AMD X3D scheduling.
2026-01-11T19:28:13.6588271Z                          .OUTPUTS
2026-01-11T19:28:13.6588550Z                              None.
2026-01-11T19:28:13.6589644Z                          .NOTES
2026-01-11T19:28:13.6590243Z                              Backs up the parent registry key before modification.
2026-01-11T19:28:13.6591183Z                          #>
2026-01-11T19:28:13.6591577Z                          $regPath = "HKLM:\SYSTEM\CurrentControlSet\Control\Power"
2026-01-11T19:28:13.6592169Z                      
2026-01-11T19:28:13.6593423Z                          Backup-RegistryKey -Path $regPath
2026-01-11T19:28:13.6593531Z                      
2026-01-11T19:28:13.6594203Z                          try {
2026-01-11T19:28:13.6595253Z                              Set-RegistryValue -Path $regPath -Name "CppcEnable" -Value 1 -Type "DWORD"
2026-01-11T19:28:13.6596343Z                              Write-Log "AMD X3D: ENABLED CPPC for proper CCD thread steering" "SUCCESS"
2026-01-11T19:28:13.6596540Z                      
2026-01-11T19:28:13.6597268Z                              if (Test-RegistryValueExists -Path $regPath -Name "HeteroPolicy") {
2026-01-11T19:28:13.6597925Z                                  Remove-RegistryValue -Path $regPath -Name "HeteroPolicy"
2026-01-11T19:28:13.6598406Z                                  Write-Log "AMD X3D: Removed HeteroPolicy registry hack (not needed for AMD)" "SUCCESS"
2026-01-11T19:28:13.6598524Z                              }
2026-01-11T19:28:13.6598657Z                      
2026-01-11T19:28:13.6599741Z                          } catch {
2026-01-11T19:28:13.6599982Z                              Write-Log "Error configuring CPPC: $_" "ERROR"
2026-01-11T19:28:13.6601265Z                              throw
2026-01-11T19:28:13.6601397Z                          }
2026-01-11T19:28:13.6602066Z                      }
2026-01-11T19:28:13.6603235Z                      
2026-01-11T19:28:13.6603336Z                      
2026-01-11T19:28:13.6603838Z                      function Set-GameBarConfiguration {
2026-01-11T19:28:13.6605123Z                          <#
2026-01-11T19:28:13.6605257Z                          .SYNOPSIS
2026-01-11T19:28:13.6606740Z                              Disables Game Bar overlays while keeping scheduler hints.
2026-01-11T19:28:13.6607072Z                          .DESCRIPTION
2026-01-11T19:28:13.6607487Z                              Disables GameDVR capture settings to reduce overhead, but keeps Game Bar
2026-01-11T19:28:13.6608111Z                              detection enabled so the OS can apply gaming heuristics.
2026-01-11T19:28:13.6608796Z                          .OUTPUTS
2026-01-11T19:28:13.6608897Z                              None.
2026-01-11T19:28:13.6608993Z                          #>
2026-01-11T19:28:13.6610040Z                          try {
2026-01-11T19:28:13.6610772Z                              $gameBarPath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\GameDVR"
2026-01-11T19:28:13.6610897Z                      
2026-01-11T19:28:13.6611777Z                              Backup-RegistryKey -Path $gameBarPath
2026-01-11T19:28:13.6611908Z                      
2026-01-11T19:28:13.6612421Z                              Set-RegistryValue -Path $gameBarPath -Name "AppCaptureEnabled" -Value 0 -Type "DWORD"
2026-01-11T19:28:13.6613314Z                              Set-RegistryValue -Path $gameBarPath -Name "GameDVR_Enabled" -Value 0 -Type "DWORD"
2026-01-11T19:28:13.6613572Z                              Write-Log "AMD X3D: Disabled Game Bar overlays and recording" "SUCCESS"
2026-01-11T19:28:13.6613919Z                      
2026-01-11T19:28:13.6614873Z                              $gameConfigPath = "HKCU:\System\GameConfigStore"
2026-01-11T19:28:13.6615458Z                              if (Test-Path $gameConfigPath) {
2026-01-11T19:28:13.6615702Z                                  Backup-RegistryKey -Path $gameConfigPath
2026-01-11T19:28:13.6616353Z                                  Set-RegistryValue -Path $gameConfigPath -Name "GameDVR_Enabled" -Value 0 -Type "DWORD"
2026-01-11T19:28:13.6617496Z                              }
2026-01-11T19:28:13.6617605Z                      
2026-01-11T19:28:13.6618494Z                              Write-Log "AMD X3D: Game Bar detection remains enabled for scheduler hints" "INFO"
2026-01-11T19:28:13.6619476Z                      
2026-01-11T19:28:13.6619590Z                          } catch {
2026-01-11T19:28:13.6620542Z                              Write-Log "Error configuring Game Bar: $_" "ERROR"
2026-01-11T19:28:13.6620684Z                              throw
2026-01-11T19:28:13.6621224Z                          }
2026-01-11T19:28:13.6622345Z                      }
2026-01-11T19:28:13.6622447Z                      
2026-01-11T19:28:13.6623239Z                      
2026-01-11T19:28:13.6624555Z                      
2026-01-11T19:28:13.6624682Z                      
2026-01-11T19:28:13.6625902Z                      function Invoke-X3DOptimizations {
2026-01-11T19:28:13.6626056Z                          <#
2026-01-11T19:28:13.6627012Z                          .SYNOPSIS
2026-01-11T19:28:13.6627903Z                              Applies all AMD X3D optimizations.
2026-01-11T19:28:13.6628816Z                          .DESCRIPTION
2026-01-11T19:28:13.6629871Z                              Confirms the CPU is X3D, warns if chipset drivers are missing, then
2026-01-11T19:28:13.6630424Z                              enables CPPC optimizations and configures Game Bar settings.
2026-01-11T19:28:13.6631344Z                          .OUTPUTS
2026-01-11T19:28:13.6631801Z                              None.
2026-01-11T19:28:13.6632233Z                          #>
2026-01-11T19:28:13.6633308Z                          if (-not (Test-X3DCpu)) {
2026-01-11T19:28:13.6634839Z                              Write-Log "No AMD X3D CPU detected - skipping X3D optimizations" "INFO"
2026-01-11T19:28:13.6634971Z                              return
2026-01-11T19:28:13.6635108Z                          }
2026-01-11T19:28:13.6636442Z                      
2026-01-11T19:28:13.6637031Z                          Write-Log "Applying AMD Ryzen X3D optimizations..." "INFO"
2026-01-11T19:28:13.6637913Z                      
2026-01-11T19:28:13.6638954Z                          $chipsetDriversInstalled = Test-AMDChipsetDrivers
2026-01-11T19:28:13.6639150Z                          if (-not $chipsetDriversInstalled) {
2026-01-11T19:28:13.6639891Z                              Write-Host ""
2026-01-11T19:28:13.6641024Z                              Write-Host "  ‚ö†Ô∏è  WARNING: AMD Chipset Drivers NOT DETECTED!" -ForegroundColor Yellow
2026-01-11T19:28:13.6642230Z                              Write-Host "  The CPPC optimizations will be applied, but they WON'T WORK without:" 
2026-01-11T19:28:13.6642407Z                      -ForegroundColor Yellow
2026-01-11T19:28:13.6643469Z                              Write-Host "    - AMD 3D V-Cache Performance Optimizer" -ForegroundColor White
2026-01-11T19:28:13.6643865Z                              Write-Host "    - AMD PPM Provisioning File Driver" -ForegroundColor White
2026-01-11T19:28:13.6644090Z                              Write-Host ""
2026-01-11T19:28:13.6645702Z                              Write-Host "  Download from: https://www.amd.com/en/support" -ForegroundColor Cyan
2026-01-11T19:28:13.6646078Z                              Write-Host "  (Added to POST-SETUP-CHECKLIST.txt)" -ForegroundColor Gray
2026-01-11T19:28:13.6646232Z                              Write-Host ""
2026-01-11T19:28:13.6646884Z                          }
2026-01-11T19:28:13.6647758Z                      
2026-01-11T19:28:13.6648228Z                          try {
2026-01-11T19:28:13.6649041Z                              Enable-CPPCOptimization
2026-01-11T19:28:13.6649551Z                      
2026-01-11T19:28:13.6649992Z                              Set-GameBarConfiguration
2026-01-11T19:28:13.6651101Z                      
2026-01-11T19:28:13.6651353Z                              Write-Log "AMD X3D optimizations complete" "SUCCESS"
2026-01-11T19:28:13.6651992Z                      
2026-01-11T19:28:13.6652860Z                              if (-not $chipsetDriversInstalled) {
2026-01-11T19:28:13.6654016Z                                  Write-Log "Install AMD Chipset Drivers after reboot!" "ERROR"
2026-01-11T19:28:13.6654633Z                                  Write-Log "Download: https://www.amd.com/en/support" "ERROR"
2026-01-11T19:28:13.6654988Z                              }
2026-01-11T19:28:13.6656030Z                      
2026-01-11T19:28:13.6657407Z                              Write-Log "BIOS: Set 'CPPC Preferred Cores' to AUTO or DRIVER (not DISABLED)" "INFO"
2026-01-11T19:28:13.6657514Z                      
2026-01-11T19:28:13.6658159Z                          } catch {
2026-01-11T19:28:13.6658968Z                              Write-Log "Error applying X3D optimizations: $_" "ERROR"
2026-01-11T19:28:13.6659122Z                              throw
2026-01-11T19:28:13.6659217Z                          }
2026-01-11T19:28:13.6659938Z                      }
2026-01-11T19:28:13.6660764Z                      
2026-01-11T19:28:13.6661461Z                      
2026-01-11T19:28:13.6662137Z                      function Undo-X3DOptimizations {
2026-01-11T19:28:13.6663091Z                          <#
2026-01-11T19:28:13.6663743Z                          .SYNOPSIS
2026-01-11T19:28:13.6664894Z                              Reverts X3D-specific registry changes.
2026-01-11T19:28:13.6665362Z                          .DESCRIPTION
2026-01-11T19:28:13.6665936Z                              Restores backed up registry values for CPPC and Game Bar settings.
2026-01-11T19:28:13.6666353Z                          .OUTPUTS
2026-01-11T19:28:13.6666463Z                              None.
2026-01-11T19:28:13.6667674Z                          #>
2026-01-11T19:28:13.6667941Z                          Write-Log "Rolling back AMD X3D optimizations..." "INFO"
2026-01-11T19:28:13.6668510Z                      
2026-01-11T19:28:13.6669129Z                          try {
2026-01-11T19:28:13.6670475Z                              $powerPath = "HKLM:\SYSTEM\CurrentControlSet\Control\Power"
2026-01-11T19:28:13.6670706Z                              if (Restore-RegistryKey -Path $powerPath) {
2026-01-11T19:28:13.6671327Z                                  Write-Log "Restored CPPC/power registry settings" "SUCCESS"
2026-01-11T19:28:13.6671695Z                              }
2026-01-11T19:28:13.6672730Z                      
2026-01-11T19:28:13.6673179Z                              $gameBarPath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\GameDVR"
2026-01-11T19:28:13.6674395Z                              if (Restore-RegistryKey -Path $gameBarPath) {
2026-01-11T19:28:13.6674913Z                                  Write-Log "Restored Game Bar registry settings" "SUCCESS"
2026-01-11T19:28:13.6675339Z                              }
2026-01-11T19:28:13.6676069Z                      
2026-01-11T19:28:13.6676963Z                              $gameConfigPath = "HKCU:\System\GameConfigStore"
2026-01-11T19:28:13.6678140Z                              if (Test-Path $gameConfigPath) {
2026-01-11T19:28:13.6678592Z                                  Restore-RegistryKey -Path $gameConfigPath
2026-01-11T19:28:13.6679558Z                              }
2026-01-11T19:28:13.6679654Z                      
2026-01-11T19:28:13.6680356Z                              Write-Log "AMD X3D optimization rollback complete" "SUCCESS"
2026-01-11T19:28:13.6681443Z                      
2026-01-11T19:28:13.6681584Z                          } catch {
2026-01-11T19:28:13.6682623Z                              Write-Log "Error during rollback: $_" "ERROR"
2026-01-11T19:28:13.6683353Z                              throw
2026-01-11T19:28:13.6684536Z                          }
2026-01-11T19:28:13.6684893Z                      }
2026-01-11T19:28:13.6685907Z                      
2026-01-11T19:28:13.6686633Z                      
2026-01-11T19:28:13.6687517Z                      Export-ModuleMember -Function @(
2026-01-11T19:28:13.6687668Z                          'Test-X3DCpu',
2026-01-11T19:28:13.6688786Z                          'Test-AMDChipsetDrivers',
2026-01-11T19:28:13.6689055Z                          'Enable-CPPCOptimization',
2026-01-11T19:28:13.6690474Z                          'Set-GameBarConfiguration',
2026-01-11T19:28:13.6690633Z                          'Test-X3DOptimizations',
2026-01-11T19:28:13.6691433Z                          'Invoke-X3DOptimizations',
2026-01-11T19:28:13.6692414Z                          'Undo-X3DOptimizations'
2026-01-11T19:28:13.6692848Z                      )
2026-01-11T19:28:13.6693220Z                      
2026-01-11T19:28:13.6694263Z [32;1mParent             : [0m
2026-01-11T19:28:13.6694278Z 
2026-01-11T19:28:13.6713685Z [32;1mAttributes         : [0m{}
2026-01-11T19:28:13.6713941Z [32;1mUsingStatements    : [0m{}
2026-01-11T19:28:13.6714131Z [32;1mParamBlock         : [0m
2026-01-11T19:28:13.6714960Z [32;1mBeginBlock         : [0m
2026-01-11T19:28:13.6716082Z [32;1mProcessBlock       : [0m
2026-01-11T19:28:13.6717850Z [32;1mEndBlock           : [0mImport-Module (Join-Path $PSScriptRoot "..\core\logger.psm1") -Force -Global
2026-01-11T19:28:13.6718151Z                      Import-Module (Join-Path $PSScriptRoot "..\core\registry.psm1") -Force -Global
2026-01-11T19:28:13.6718274Z                      
2026-01-11T19:28:13.6719127Z                      
2026-01-11T19:28:13.6719778Z                      
2026-01-11T19:28:13.6720828Z                      function Test-AudioOptimizations {
2026-01-11T19:28:13.6721262Z                          <#
2026-01-11T19:28:13.6721936Z                          .SYNOPSIS
2026-01-11T19:28:13.6723107Z                              Verifies applied audio optimizations.
2026-01-11T19:28:13.6723297Z                          .DESCRIPTION
2026-01-11T19:28:13.6724460Z                              Checks registry values used to disable system sounds.
2026-01-11T19:28:13.6725145Z                          .OUTPUTS
2026-01-11T19:28:13.6725366Z                              [bool] True when expected values are present.
2026-01-11T19:28:13.6725822Z                          #>
2026-01-11T19:28:13.6726689Z                          $allPassed = $true
2026-01-11T19:28:13.6726799Z                      
2026-01-11T19:28:13.6727499Z                          Write-Log "Verifying audio optimizations..." "INFO"
2026-01-11T19:28:13.6728472Z                      
2026-01-11T19:28:13.6728859Z                          $audioPath = "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Audio"
2026-01-11T19:28:13.6730262Z                          $systemSoundsDisabled = Get-RegistryValue -Path $audioPath -Name "DisableSystemSounds"
2026-01-11T19:28:13.6730454Z                          if ($systemSoundsDisabled -eq 1) {
2026-01-11T19:28:13.6730875Z                              Write-Log "‚úì System sounds disabled" "SUCCESS"
2026-01-11T19:28:13.6730982Z                          } else {
2026-01-11T19:28:13.6731441Z                              Write-Log "System sounds not disabled" "INFO"
2026-01-11T19:28:13.6732701Z                              $allPassed = $false
2026-01-11T19:28:13.6732807Z                          }
2026-01-11T19:28:13.6733622Z                      
2026-01-11T19:28:13.6734368Z                          return $allPassed
2026-01-11T19:28:13.6735535Z                      }
2026-01-11T19:28:13.6735767Z                      
2026-01-11T19:28:13.6736727Z                      
2026-01-11T19:28:13.6736845Z                      
2026-01-11T19:28:13.6738166Z                      
2026-01-11T19:28:13.6738378Z                      function Disable-AudioEnhancements {
2026-01-11T19:28:13.6739509Z                          <#
2026-01-11T19:28:13.6739673Z                          .SYNOPSIS
2026-01-11T19:28:13.6740576Z                              Disables system sounds and some audio processing overhead.
2026-01-11T19:28:13.6740736Z                          .DESCRIPTION
2026-01-11T19:28:13.6742353Z                              Writes audio settings under HKLM to reduce unnecessary audio processing
2026-01-11T19:28:13.6742576Z                              and lower DPC impact from system sounds.
2026-01-11T19:28:13.6742731Z                          .OUTPUTS
2026-01-11T19:28:13.6743732Z                              None.
2026-01-11T19:28:13.6744350Z                          #>
2026-01-11T19:28:13.6745526Z                          try {
2026-01-11T19:28:13.6746110Z                              $audioPath = "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Audio"
2026-01-11T19:28:13.6746618Z                              Backup-RegistryKey -Path $audioPath
2026-01-11T19:28:13.6747028Z                      
2026-01-11T19:28:13.6748606Z                              Set-RegistryValue -Path $audioPath -Name "DisableSystemSounds" -Value 1 -Type "DWORD"
2026-01-11T19:28:13.6748851Z                              Write-Log "Disabled system sounds" "SUCCESS"
2026-01-11T19:28:13.6748943Z                      
2026-01-11T19:28:13.6749291Z                              # Note: DisableProtectedAudioDG = 0 actually ENABLES protected audio
2026-01-11T19:28:13.6749818Z                              Set-RegistryValue -Path $audioPath -Name "DisableProtectedAudioDG" -Value 0 -Type "DWORD"
2026-01-11T19:28:13.6749984Z                      
2026-01-11T19:28:13.6751080Z                              Write-Log "Audio enhancements configured for reduced DPC latency" "SUCCESS"
2026-01-11T19:28:13.6751224Z                      
2026-01-11T19:28:13.6752143Z                          } catch {
2026-01-11T19:28:13.6753264Z                              Write-Log "Error disabling audio enhancements: $_" "ERROR"
2026-01-11T19:28:13.6753550Z                              throw
2026-01-11T19:28:13.6754431Z                          }
2026-01-11T19:28:13.6755394Z                      }
2026-01-11T19:28:13.6756328Z                      
2026-01-11T19:28:13.6756543Z                      
2026-01-11T19:28:13.6757246Z                      function Set-AudioDriverOptimizations {
2026-01-11T19:28:13.6758378Z                          <#
2026-01-11T19:28:13.6758558Z                          .SYNOPSIS
2026-01-11T19:28:13.6758873Z                              Disables audio driver power management features.
2026-01-11T19:28:13.6759809Z                          .DESCRIPTION
2026-01-11T19:28:13.6760863Z                              Iterates audio device class registry keys and disables power saving
2026-01-11T19:28:13.6761305Z                              features that can introduce latency.
2026-01-11T19:28:13.6762144Z                          .OUTPUTS
2026-01-11T19:28:13.6762533Z                              None.
2026-01-11T19:28:13.6763430Z                          #>
2026-01-11T19:28:13.6763576Z                          try {
2026-01-11T19:28:13.6764920Z                              Write-Log "Optimizing audio drivers for low DPC latency..." "INFO"
2026-01-11T19:28:13.6765036Z                      
2026-01-11T19:28:13.6766049Z                              $audioPath = 
2026-01-11T19:28:13.6766471Z                      "HKLM:\SYSTEM\CurrentControlSet\Control\Class\{4d36e96c-e325-11ce-bfc1-08002be10318}"
2026-01-11T19:28:13.6767357Z                      
2026-01-11T19:28:13.6767866Z                              if (Test-Path $audioPath) {
2026-01-11T19:28:13.6768271Z                                  $audioDrivers = Get-ChildItem $audioPath -ErrorAction SilentlyContinue
2026-01-11T19:28:13.6768684Z                                  foreach ($driver in $audioDrivers) {
2026-01-11T19:28:13.6769120Z                                      $driverPath = $driver.PSPath
2026-01-11T19:28:13.6769594Z                                      try {
2026-01-11T19:28:13.6770969Z                                          Set-RegistryValue -Path $driverPath -Name "DisableHDAudioPowerManagement" 
2026-01-11T19:28:13.6771258Z                      -Value 1 -Type "DWORD" -ErrorAction SilentlyContinue
2026-01-11T19:28:13.6772449Z                                          Set-RegistryValue -Path $driverPath -Name "PowerSave" -Value 0 -Type "DWORD" 
2026-01-11T19:28:13.6772710Z                      -ErrorAction SilentlyContinue
2026-01-11T19:28:13.6772827Z                      
2026-01-11T19:28:13.6773979Z                                      } catch {
2026-01-11T19:28:13.6774092Z                                      }
2026-01-11T19:28:13.6775303Z                                  }
2026-01-11T19:28:13.6775651Z                      
2026-01-11T19:28:13.6777002Z                                  Write-Log "Audio driver power management disabled" "SUCCESS"
2026-01-11T19:28:13.6777659Z                              }
2026-01-11T19:28:13.6778010Z                      
2026-01-11T19:28:13.6779348Z                          } catch {
2026-01-11T19:28:13.6780532Z                              Write-Log "Error optimizing audio drivers: $_" "ERROR"
2026-01-11T19:28:13.6780879Z                              throw
2026-01-11T19:28:13.6782051Z                          }
2026-01-11T19:28:13.6782494Z                      }
2026-01-11T19:28:13.6783334Z                      
2026-01-11T19:28:13.6783968Z                      
2026-01-11T19:28:13.6784878Z                      function Set-AudioExclusiveMode {
2026-01-11T19:28:13.6784991Z                          <#
2026-01-11T19:28:13.6786091Z                          .SYNOPSIS
2026-01-11T19:28:13.6786669Z                              Sets an exclusive-mode preference for audio.
2026-01-11T19:28:13.6787711Z                          .DESCRIPTION
2026-01-11T19:28:13.6789131Z                              Toggles UserDuckingPreference to signal exclusive-mode preference.
2026-01-11T19:28:13.6789324Z                              This is optional and disabled by default.
2026-01-11T19:28:13.6789581Z                          .PARAMETER Enable
2026-01-11T19:28:13.6790849Z                              When true, writes the exclusive mode preference setting.
2026-01-11T19:28:13.6791316Z                          .OUTPUTS
2026-01-11T19:28:13.6791415Z                              None.
2026-01-11T19:28:13.6793023Z                          #>
2026-01-11T19:28:13.6793173Z                          param(
2026-01-11T19:28:13.6793894Z                              [bool]$Enable = $false
2026-01-11T19:28:13.6795187Z                          )
2026-01-11T19:28:13.6795683Z                      
2026-01-11T19:28:13.6795804Z                          try {
2026-01-11T19:28:13.6796912Z                              $duckingPath = "HKCU:\Software\Microsoft\Multimedia\Audio"
2026-01-11T19:28:13.6797019Z                      
2026-01-11T19:28:13.6797572Z                              if ($Enable) {
2026-01-11T19:28:13.6798951Z                                  Backup-RegistryKey -Path $duckingPath
2026-01-11T19:28:13.6799474Z                                  Set-RegistryValue -Path $duckingPath -Name "UserDuckingPreference" -Value 2 -Type 
2026-01-11T19:28:13.6799574Z                      "DWORD"
2026-01-11T19:28:13.6800980Z                                  Write-Log "Enabled exclusive mode preference (opt-in)" "SUCCESS"
2026-01-11T19:28:13.6801107Z                              } else {
2026-01-11T19:28:13.6802352Z                                  Write-Log "Exclusive mode kept disabled (default, shared mode is fine for gaming)" 
2026-01-11T19:28:13.6802493Z                      "INFO"
2026-01-11T19:28:13.6802763Z                              }
2026-01-11T19:28:13.6803832Z                      
2026-01-11T19:28:13.6804237Z                          } catch {
2026-01-11T19:28:13.6805321Z                              Write-Log "Error setting exclusive mode: $_" "ERROR"
2026-01-11T19:28:13.6805701Z                              throw
2026-01-11T19:28:13.6806767Z                          }
2026-01-11T19:28:13.6806898Z                      }
2026-01-11T19:28:13.6807913Z                      
2026-01-11T19:28:13.6808839Z                      
2026-01-11T19:28:13.6809676Z                      function Disable-SystemSounds {
2026-01-11T19:28:13.6810277Z                          <#
2026-01-11T19:28:13.6811407Z                          .SYNOPSIS
2026-01-11T19:28:13.6811782Z                              Disables Windows system sounds for lower background audio activity.
2026-01-11T19:28:13.6812206Z                          .DESCRIPTION
2026-01-11T19:28:13.6813394Z                              Updates AppEvents scheme defaults and specific event paths to silence
2026-01-11T19:28:13.6813579Z                              system sound triggers.
2026-01-11T19:28:13.6814445Z                          .OUTPUTS
2026-01-11T19:28:13.6814559Z                              None.
2026-01-11T19:28:13.6815613Z                          #>
2026-01-11T19:28:13.6816048Z                          try {
2026-01-11T19:28:13.6816969Z                              $soundPath = "HKCU:\AppEvents\Schemes"
2026-01-11T19:28:13.6818150Z                              Backup-RegistryKey -Path $soundPath
2026-01-11T19:28:13.6818390Z                      
2026-01-11T19:28:13.6819681Z                              Set-ItemProperty -Path $soundPath -Name "(Default)" -Value ".None" -ErrorAction 
2026-01-11T19:28:13.6819835Z                      SilentlyContinue
2026-01-11T19:28:13.6820177Z                      
2026-01-11T19:28:13.6821374Z                              $events = @(
2026-01-11T19:28:13.6822298Z                                  "Schemes\Apps\.Default\.Default\.Current",
2026-01-11T19:28:13.6823436Z                                  "Schemes\Apps\.Default\SystemExit\.Current",
2026-01-11T19:28:13.6823640Z                                  "Schemes\Apps\.Default\SystemStart\.Current",
2026-01-11T19:28:13.6824908Z                                  "Schemes\Apps\.Default\WindowsLogon\.Current"
2026-01-11T19:28:13.6825230Z                              )
2026-01-11T19:28:13.6825686Z                      
2026-01-11T19:28:13.6826709Z                              foreach ($event in $events) {
2026-01-11T19:28:13.6827160Z                                  $eventPath = "HKCU:\AppEvents\$event"
2026-01-11T19:28:13.6827942Z                                  if (Test-Path $eventPath) {
2026-01-11T19:28:13.6828717Z                                      Backup-RegistryKey -Path $eventPath
2026-01-11T19:28:13.6830470Z                                      Set-ItemProperty -Path $eventPath -Name "(Default)" -Value "" -ErrorAction 
2026-01-11T19:28:13.6830651Z                      SilentlyContinue
2026-01-11T19:28:13.6830756Z                                  }
2026-01-11T19:28:13.6831352Z                              }
2026-01-11T19:28:13.6831531Z                      
2026-01-11T19:28:13.6832723Z                              Write-Log "Disabled system sounds" "SUCCESS"
2026-01-11T19:28:13.6833141Z                      
2026-01-11T19:28:13.6834239Z                          } catch {
2026-01-11T19:28:13.6835019Z                              Write-Log "Error disabling system sounds: $_" "ERROR"
2026-01-11T19:28:13.6835739Z                              throw
2026-01-11T19:28:13.6835880Z                          }
2026-01-11T19:28:13.6836303Z                      }
2026-01-11T19:28:13.6837242Z                      
2026-01-11T19:28:13.6837420Z                      
2026-01-11T19:28:13.6838815Z                      
2026-01-11T19:28:13.6838939Z                      
2026-01-11T19:28:13.6839636Z                      function Invoke-AudioOptimizations {
2026-01-11T19:28:13.6840705Z                          <#
2026-01-11T19:28:13.6840851Z                          .SYNOPSIS
2026-01-11T19:28:13.6841754Z                              Applies all audio optimizations in this module.
2026-01-11T19:28:13.6842447Z                          .DESCRIPTION
2026-01-11T19:28:13.6843494Z                              Disables audio enhancements and system sounds, applies driver power
2026-01-11T19:28:13.6844543Z                              management changes, and optionally enables exclusive mode preference.
2026-01-11T19:28:13.6844753Z                          .PARAMETER EnableExclusiveMode
2026-01-11T19:28:13.6845834Z                              Enables exclusive mode preference when true.
2026-01-11T19:28:13.6845946Z                          .OUTPUTS
2026-01-11T19:28:13.6846142Z                              None.
2026-01-11T19:28:13.6846587Z                          #>
2026-01-11T19:28:13.6847754Z                          param(
2026-01-11T19:28:13.6848602Z                              [bool]$EnableExclusiveMode = $false
2026-01-11T19:28:13.6849504Z                          )
2026-01-11T19:28:13.6849604Z                      
2026-01-11T19:28:13.6850848Z                          Write-Log "Applying audio optimizations..." "INFO"
2026-01-11T19:28:13.6850956Z                      
2026-01-11T19:28:13.6851570Z                          try {
2026-01-11T19:28:13.6853185Z                              Disable-AudioEnhancements
2026-01-11T19:28:13.6853300Z                      
2026-01-11T19:28:13.6853717Z                              Set-AudioDriverOptimizations
2026-01-11T19:28:13.6854697Z                      
2026-01-11T19:28:13.6854887Z                              Disable-SystemSounds
2026-01-11T19:28:13.6856463Z                      
2026-01-11T19:28:13.6856805Z                              Set-AudioExclusiveMode -Enable $EnableExclusiveMode
2026-01-11T19:28:13.6857822Z                      
2026-01-11T19:28:13.6858863Z                              Write-Log "Audio optimizations complete" "SUCCESS"
2026-01-11T19:28:13.6860188Z                              Write-Log "NOTE: Validate with LatencyMon ‚Üí WPR/WPA to measure DPC improvement" "INFO"
2026-01-11T19:28:13.6860432Z                      
2026-01-11T19:28:13.6860561Z                          } catch {
2026-01-11T19:28:13.6861778Z                              Write-Log "Error applying audio optimizations: $_" "ERROR"
2026-01-11T19:28:13.6861884Z                              throw
2026-01-11T19:28:13.6862755Z                          }
2026-01-11T19:28:13.6862859Z                      }
2026-01-11T19:28:13.6864337Z                      
2026-01-11T19:28:13.6864434Z                      
2026-01-11T19:28:13.6864626Z                      function Undo-AudioOptimizations {
2026-01-11T19:28:13.6865048Z                          <#
2026-01-11T19:28:13.6866070Z                          .SYNOPSIS
2026-01-11T19:28:13.6866338Z                              Reverts audio-related registry changes.
2026-01-11T19:28:13.6867519Z                          .DESCRIPTION
2026-01-11T19:28:13.6867817Z                              Restores backed up registry keys for audio-related settings.
2026-01-11T19:28:13.6868146Z                          .OUTPUTS
2026-01-11T19:28:13.6869292Z                              None.
2026-01-11T19:28:13.6869398Z                          #>
2026-01-11T19:28:13.6870553Z                          Write-Log "Rolling back audio optimizations..." "INFO"
2026-01-11T19:28:13.6870946Z                      
2026-01-11T19:28:13.6872169Z                          try {
2026-01-11T19:28:13.6872326Z                              $paths = @(
2026-01-11T19:28:13.6873935Z                                  "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Audio",
2026-01-11T19:28:13.6874908Z                                  "HKCU:\Software\Microsoft\Multimedia\Audio",
2026-01-11T19:28:13.6876088Z                                  "HKCU:\AppEvents\Schemes"
2026-01-11T19:28:13.6876921Z                              )
2026-01-11T19:28:13.6878092Z                      
2026-01-11T19:28:13.6878295Z                              foreach ($path in $paths) {
2026-01-11T19:28:13.6878716Z                                  if (Restore-RegistryKey -Path $path) {
2026-01-11T19:28:13.6879591Z                                      Write-Log "Restored registry: $path" "SUCCESS"
2026-01-11T19:28:13.6879690Z                                  }
2026-01-11T19:28:13.6880466Z                              }
2026-01-11T19:28:13.6881274Z                      
2026-01-11T19:28:13.6881889Z                      
2026-01-11T19:28:13.6882728Z                              Write-Log "Audio optimization rollback complete" "SUCCESS"
2026-01-11T19:28:13.6883138Z                      
2026-01-11T19:28:13.6884236Z                          } catch {
2026-01-11T19:28:13.6884530Z                              Write-Log "Error during rollback: $_" "ERROR"
2026-01-11T19:28:13.6885533Z                              throw
2026-01-11T19:28:13.6885662Z                          }
2026-01-11T19:28:13.6886686Z                      }
2026-01-11T19:28:13.6886838Z                      
2026-01-11T19:28:13.6888182Z                      
2026-01-11T19:28:13.6888369Z                      Export-ModuleMember -Function @(
2026-01-11T19:28:13.6888880Z                          'Disable-AudioEnhancements',
2026-01-11T19:28:13.6890000Z                          'Set-AudioDriverOptimizations',
2026-01-11T19:28:13.6890210Z                          'Set-AudioExclusiveMode',
2026-01-11T19:28:13.6891179Z                          'Disable-SystemSounds',
2026-01-11T19:28:13.6891659Z                          'Test-AudioOptimizations',
2026-01-11T19:28:13.6892387Z                          'Invoke-AudioOptimizations',
2026-01-11T19:28:13.6893278Z                          'Undo-AudioOptimizations'
2026-01-11T19:28:13.6893389Z                      )
2026-01-11T19:28:13.6894766Z [32;1mCleanBlock         : [0m
2026-01-11T19:28:13.6895182Z [32;1mDynamicParamBlock  : [0m
2026-01-11T19:28:13.6896823Z [32;1mScriptRequirements : [0mSystem.Management.Automation.Language.ScriptRequirements
2026-01-11T19:28:13.6897069Z [32;1mExtent             : [0m<#
2026-01-11T19:28:13.6898026Z                      .SYNOPSIS
2026-01-11T19:28:13.6898310Z                          Audio-related latency and quality-of-life optimizations.
2026-01-11T19:28:13.6898807Z                      .DESCRIPTION
2026-01-11T19:28:13.6900318Z                          Disables system sounds, reduces audio driver power management, and optionally
2026-01-11T19:28:13.6901283Z                          enables exclusive mode hints to lower audio latency.
2026-01-11T19:28:13.6901395Z                      .NOTES
2026-01-11T19:28:13.6901610Z                          Requires Administrator for HKLM changes and driver registry paths.
2026-01-11T19:28:13.6901707Z                      #>
2026-01-11T19:28:13.6903129Z                      #Requires -RunAsAdministrator
2026-01-11T19:28:13.6903571Z                      
2026-01-11T19:28:13.6904420Z                      
2026-01-11T19:28:13.6905049Z                      
2026-01-11T19:28:13.6905995Z                      Import-Module (Join-Path $PSScriptRoot "..\core\logger.psm1") -Force -Global
2026-01-11T19:28:13.6906915Z                      Import-Module (Join-Path $PSScriptRoot "..\core\registry.psm1") -Force -Global
2026-01-11T19:28:13.6907089Z                      
2026-01-11T19:28:13.6908094Z                      
2026-01-11T19:28:13.6908281Z                      
2026-01-11T19:28:13.6909595Z                      function Test-AudioOptimizations {
2026-01-11T19:28:13.6910062Z                          <#
2026-01-11T19:28:13.6910239Z                          .SYNOPSIS
2026-01-11T19:28:13.6911369Z                              Verifies applied audio optimizations.
2026-01-11T19:28:13.6911484Z                          .DESCRIPTION
2026-01-11T19:28:13.6912778Z                              Checks registry values used to disable system sounds.
2026-01-11T19:28:13.6913040Z                          .OUTPUTS
2026-01-11T19:28:13.6913271Z                              [bool] True when expected values are present.
2026-01-11T19:28:13.6913877Z                          #>
2026-01-11T19:28:13.6914096Z                          $allPassed = $true
2026-01-11T19:28:13.6915143Z                      
2026-01-11T19:28:13.6915828Z                          Write-Log "Verifying audio optimizations..." "INFO"
2026-01-11T19:28:13.6916923Z                      
2026-01-11T19:28:13.6917320Z                          $audioPath = "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Audio"
2026-01-11T19:28:13.6918360Z                          $systemSoundsDisabled = Get-RegistryValue -Path $audioPath -Name "DisableSystemSounds"
2026-01-11T19:28:13.6918756Z                          if ($systemSoundsDisabled -eq 1) {
2026-01-11T19:28:13.6920028Z                              Write-Log "‚úì System sounds disabled" "SUCCESS"
2026-01-11T19:28:13.6920182Z                          } else {
2026-01-11T19:28:13.6921391Z                              Write-Log "System sounds not disabled" "INFO"
2026-01-11T19:28:13.6921799Z                              $allPassed = $false
2026-01-11T19:28:13.6922806Z                          }
2026-01-11T19:28:13.6923707Z                      
2026-01-11T19:28:13.6924364Z                          return $allPassed
2026-01-11T19:28:13.6926801Z                      }
2026-01-11T19:28:13.6926949Z                      
2026-01-11T19:28:13.6927038Z                      
2026-01-11T19:28:13.6927126Z                      
2026-01-11T19:28:13.6927534Z                      
2026-01-11T19:28:13.6928361Z                      function Disable-AudioEnhancements {
2026-01-11T19:28:13.6929161Z                          <#
2026-01-11T19:28:13.6929810Z                          .SYNOPSIS
2026-01-11T19:28:13.6930968Z                              Disables system sounds and some audio processing overhead.
2026-01-11T19:28:13.6931115Z                          .DESCRIPTION
2026-01-11T19:28:13.6932378Z                              Writes audio settings under HKLM to reduce unnecessary audio processing
2026-01-11T19:28:13.6932567Z                              and lower DPC impact from system sounds.
2026-01-11T19:28:13.6933284Z                          .OUTPUTS
2026-01-11T19:28:13.6933533Z                              None.
2026-01-11T19:28:13.6934798Z                          #>
2026-01-11T19:28:13.6935693Z                          try {
2026-01-11T19:28:13.6936392Z                              $audioPath = "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Audio"
2026-01-11T19:28:13.6936867Z                              Backup-RegistryKey -Path $audioPath
2026-01-11T19:28:13.6938055Z                      
2026-01-11T19:28:13.6938575Z                              Set-RegistryValue -Path $audioPath -Name "DisableSystemSounds" -Value 1 -Type "DWORD"
2026-01-11T19:28:13.6938827Z                              Write-Log "Disabled system sounds" "SUCCESS"
2026-01-11T19:28:13.6939817Z                      
2026-01-11T19:28:13.6940454Z                              # Note: DisableProtectedAudioDG = 0 actually ENABLES protected audio
2026-01-11T19:28:13.6941749Z                              Set-RegistryValue -Path $audioPath -Name "DisableProtectedAudioDG" -Value 0 -Type "DWORD"
2026-01-11T19:28:13.6941861Z                      
2026-01-11T19:28:13.6942269Z                              Write-Log "Audio enhancements configured for reduced DPC latency" "SUCCESS"
2026-01-11T19:28:13.6942547Z                      
2026-01-11T19:28:13.6942951Z                          } catch {
2026-01-11T19:28:13.6944146Z                              Write-Log "Error disabling audio enhancements: $_" "ERROR"
2026-01-11T19:28:13.6944267Z                              throw
2026-01-11T19:28:13.6945240Z                          }
2026-01-11T19:28:13.6946050Z                      }
2026-01-11T19:28:13.6947080Z                      
2026-01-11T19:28:13.6947286Z                      
2026-01-11T19:28:13.6948627Z                      function Set-AudioDriverOptimizations {
2026-01-11T19:28:13.6949086Z                          <#
2026-01-11T19:28:13.6949968Z                          .SYNOPSIS
2026-01-11T19:28:13.6950857Z                              Disables audio driver power management features.
2026-01-11T19:28:13.6951653Z                          .DESCRIPTION
2026-01-11T19:28:13.6952557Z                              Iterates audio device class registry keys and disables power saving
2026-01-11T19:28:13.6953103Z                              features that can introduce latency.
2026-01-11T19:28:13.6954291Z                          .OUTPUTS
2026-01-11T19:28:13.6954757Z                              None.
2026-01-11T19:28:13.6955201Z                          #>
2026-01-11T19:28:13.6956212Z                          try {
2026-01-11T19:28:13.6956527Z                              Write-Log "Optimizing audio drivers for low DPC latency..." "INFO"
2026-01-11T19:28:13.6956616Z                      
2026-01-11T19:28:13.6957557Z                              $audioPath = 
2026-01-11T19:28:13.6958181Z                      "HKLM:\SYSTEM\CurrentControlSet\Control\Class\{4d36e96c-e325-11ce-bfc1-08002be10318}"
2026-01-11T19:28:13.6958364Z                      
2026-01-11T19:28:13.6958890Z                              if (Test-Path $audioPath) {
2026-01-11T19:28:13.6960425Z                                  $audioDrivers = Get-ChildItem $audioPath -ErrorAction SilentlyContinue
2026-01-11T19:28:13.6960671Z                                  foreach ($driver in $audioDrivers) {
2026-01-11T19:28:13.6960848Z                                      $driverPath = $driver.PSPath
2026-01-11T19:28:13.6961675Z                                      try {
2026-01-11T19:28:13.6962127Z                                          Set-RegistryValue -Path $driverPath -Name "DisableHDAudioPowerManagement" 
2026-01-11T19:28:13.6963219Z                      -Value 1 -Type "DWORD" -ErrorAction SilentlyContinue
2026-01-11T19:28:13.6963666Z                                          Set-RegistryValue -Path $driverPath -Name "PowerSave" -Value 0 -Type "DWORD" 
2026-01-11T19:28:13.6963852Z                      -ErrorAction SilentlyContinue
2026-01-11T19:28:13.6964593Z                      
2026-01-11T19:28:13.6965564Z                                      } catch {
2026-01-11T19:28:13.6965686Z                                      }
2026-01-11T19:28:13.6967097Z                                  }
2026-01-11T19:28:13.6967194Z                      
2026-01-11T19:28:13.6968486Z                                  Write-Log "Audio driver power management disabled" "SUCCESS"
2026-01-11T19:28:13.6968948Z                              }
2026-01-11T19:28:13.6969033Z                      
2026-01-11T19:28:13.6969860Z                          } catch {
2026-01-11T19:28:13.6970388Z                              Write-Log "Error optimizing audio drivers: $_" "ERROR"
2026-01-11T19:28:13.6971514Z                              throw
2026-01-11T19:28:13.6971636Z                          }
2026-01-11T19:28:13.6972729Z                      }
2026-01-11T19:28:13.6972828Z                      
2026-01-11T19:28:13.6973755Z                      
2026-01-11T19:28:13.6973941Z                      function Set-AudioExclusiveMode {
2026-01-11T19:28:13.6974439Z                          <#
2026-01-11T19:28:13.6975494Z                          .SYNOPSIS
2026-01-11T19:28:13.6976770Z                              Sets an exclusive-mode preference for audio.
2026-01-11T19:28:13.6977200Z                          .DESCRIPTION
2026-01-11T19:28:13.6978240Z                              Toggles UserDuckingPreference to signal exclusive-mode preference.
2026-01-11T19:28:13.6978813Z                              This is optional and disabled by default.
2026-01-11T19:28:13.6979677Z                          .PARAMETER Enable
2026-01-11T19:28:13.6980545Z                              When true, writes the exclusive mode preference setting.
2026-01-11T19:28:13.6981143Z                          .OUTPUTS
2026-01-11T19:28:13.6982211Z                              None.
2026-01-11T19:28:13.6982322Z                          #>
2026-01-11T19:28:13.6983056Z                          param(
2026-01-11T19:28:13.6984275Z                              [bool]$Enable = $false
2026-01-11T19:28:13.6984404Z                          )
2026-01-11T19:28:13.6985101Z                      
2026-01-11T19:28:13.6985973Z                          try {
2026-01-11T19:28:13.6986948Z                              $duckingPath = "HKCU:\Software\Microsoft\Multimedia\Audio"
2026-01-11T19:28:13.6987238Z                      
2026-01-11T19:28:13.6988219Z                              if ($Enable) {
2026-01-11T19:28:13.6988842Z                                  Backup-RegistryKey -Path $duckingPath
2026-01-11T19:28:13.6990445Z                                  Set-RegistryValue -Path $duckingPath -Name "UserDuckingPreference" -Value 2 -Type 
2026-01-11T19:28:13.6990587Z                      "DWORD"
2026-01-11T19:28:13.6990947Z                                  Write-Log "Enabled exclusive mode preference (opt-in)" "SUCCESS"
2026-01-11T19:28:13.6991142Z                              } else {
2026-01-11T19:28:13.6992420Z                                  Write-Log "Exclusive mode kept disabled (default, shared mode is fine for gaming)" 
2026-01-11T19:28:13.6992944Z                      "INFO"
2026-01-11T19:28:13.6993277Z                              }
2026-01-11T19:28:13.6993373Z                      
2026-01-11T19:28:13.6994587Z                          } catch {
2026-01-11T19:28:13.6995797Z                              Write-Log "Error setting exclusive mode: $_" "ERROR"
2026-01-11T19:28:13.6995919Z                              throw
2026-01-11T19:28:13.6996470Z                          }
2026-01-11T19:28:13.6997467Z                      }
2026-01-11T19:28:13.6998239Z                      
2026-01-11T19:28:13.6999302Z                      
2026-01-11T19:28:13.6999532Z                      function Disable-SystemSounds {
2026-01-11T19:28:13.7000149Z                          <#
2026-01-11T19:28:13.7001144Z                          .SYNOPSIS
2026-01-11T19:28:13.7002124Z                              Disables Windows system sounds for lower background audio activity.
2026-01-11T19:28:13.7002554Z                          .DESCRIPTION
2026-01-11T19:28:13.7003676Z                              Updates AppEvents scheme defaults and specific event paths to silence
2026-01-11T19:28:13.7004191Z                              system sound triggers.
2026-01-11T19:28:13.7004829Z                          .OUTPUTS
2026-01-11T19:28:13.7005697Z                              None.
2026-01-11T19:28:13.7005821Z                          #>
2026-01-11T19:28:13.7006976Z                          try {
2026-01-11T19:28:13.7007194Z                              $soundPath = "HKCU:\AppEvents\Schemes"
2026-01-11T19:28:13.7008873Z                              Backup-RegistryKey -Path $soundPath
2026-01-11T19:28:13.7009028Z                      
2026-01-11T19:28:13.7009723Z                              Set-ItemProperty -Path $soundPath -Name "(Default)" -Value ".None" -ErrorAction 
2026-01-11T19:28:13.7010551Z                      SilentlyContinue
2026-01-11T19:28:13.7011284Z                      
2026-01-11T19:28:13.7011748Z                              $events = @(
2026-01-11T19:28:13.7012787Z                                  "Schemes\Apps\.Default\.Default\.Current",
2026-01-11T19:28:13.7013809Z                                  "Schemes\Apps\.Default\SystemExit\.Current",
2026-01-11T19:28:13.7014052Z                                  "Schemes\Apps\.Default\SystemStart\.Current",
2026-01-11T19:28:13.7015780Z                                  "Schemes\Apps\.Default\WindowsLogon\.Current"
2026-01-11T19:28:13.7016239Z                              )
2026-01-11T19:28:13.7016411Z                      
2026-01-11T19:28:13.7017790Z                              foreach ($event in $events) {
2026-01-11T19:28:13.7017990Z                                  $eventPath = "HKCU:\AppEvents\$event"
2026-01-11T19:28:13.7018855Z                                  if (Test-Path $eventPath) {
2026-01-11T19:28:13.7019537Z                                      Backup-RegistryKey -Path $eventPath
2026-01-11T19:28:13.7020295Z                                      Set-ItemProperty -Path $eventPath -Name "(Default)" -Value "" -ErrorAction 
2026-01-11T19:28:13.7020429Z                      SilentlyContinue
2026-01-11T19:28:13.7021111Z                                  }
2026-01-11T19:28:13.7022193Z                              }
2026-01-11T19:28:13.7022300Z                      
2026-01-11T19:28:13.7023491Z                              Write-Log "Disabled system sounds" "SUCCESS"
2026-01-11T19:28:13.7023789Z                      
2026-01-11T19:28:13.7024697Z                          } catch {
2026-01-11T19:28:13.7024958Z                              Write-Log "Error disabling system sounds: $_" "ERROR"
2026-01-11T19:28:13.7025915Z                              throw
2026-01-11T19:28:13.7026337Z                          }
2026-01-11T19:28:13.7026549Z                      }
2026-01-11T19:28:13.7027603Z                      
2026-01-11T19:28:13.7027697Z                      
2026-01-11T19:28:13.7028735Z                      
2026-01-11T19:28:13.7028877Z                      
2026-01-11T19:28:13.7029364Z                      function Invoke-AudioOptimizations {
2026-01-11T19:28:13.7030158Z                          <#
2026-01-11T19:28:13.7030360Z                          .SYNOPSIS
2026-01-11T19:28:13.7031327Z                              Applies all audio optimizations in this module.
2026-01-11T19:28:13.7032455Z                          .DESCRIPTION
2026-01-11T19:28:13.7032876Z                              Disables audio enhancements and system sounds, applies driver power
2026-01-11T19:28:13.7033568Z                              management changes, and optionally enables exclusive mode preference.
2026-01-11T19:28:13.7034563Z                          .PARAMETER EnableExclusiveMode
2026-01-11T19:28:13.7034761Z                              Enables exclusive mode preference when true.
2026-01-11T19:28:13.7035583Z                          .OUTPUTS
2026-01-11T19:28:13.7036416Z                              None.
2026-01-11T19:28:13.7037241Z                          #>
2026-01-11T19:28:13.7037394Z                          param(
2026-01-11T19:28:13.7038649Z                              [bool]$EnableExclusiveMode = $false
2026-01-11T19:28:13.7038763Z                          )
2026-01-11T19:28:13.7039476Z                      
2026-01-11T19:28:13.7040679Z                          Write-Log "Applying audio optimizations..." "INFO"
2026-01-11T19:28:13.7040816Z                      
2026-01-11T19:28:13.7041055Z                          try {
2026-01-11T19:28:13.7042129Z                              Disable-AudioEnhancements
2026-01-11T19:28:13.7042581Z                      
2026-01-11T19:28:13.7043838Z                              Set-AudioDriverOptimizations
2026-01-11T19:28:13.7043941Z                      
2026-01-11T19:28:13.7044282Z                              Disable-SystemSounds
2026-01-11T19:28:13.7045260Z                      
2026-01-11T19:28:13.7045608Z                              Set-AudioExclusiveMode -Enable $EnableExclusiveMode
2026-01-11T19:28:13.7046762Z                      
2026-01-11T19:28:13.7047038Z                              Write-Log "Audio optimizations complete" "SUCCESS"
2026-01-11T19:28:13.7048347Z                              Write-Log "NOTE: Validate with LatencyMon ‚Üí WPR/WPA to measure DPC improvement" "INFO"
2026-01-11T19:28:13.7048461Z                      
2026-01-11T19:28:13.7048565Z                          } catch {
2026-01-11T19:28:13.7049940Z                              Write-Log "Error applying audio optimizations: $_" "ERROR"
2026-01-11T19:28:13.7050231Z                              throw
2026-01-11T19:28:13.7050339Z                          }
2026-01-11T19:28:13.7050779Z                      }
2026-01-11T19:28:13.7051660Z                      
2026-01-11T19:28:13.7052654Z                      
2026-01-11T19:28:13.7052843Z                      function Undo-AudioOptimizations {
2026-01-11T19:28:13.7053661Z                          <#
2026-01-11T19:28:13.7054821Z                          .SYNOPSIS
2026-01-11T19:28:13.7055708Z                              Reverts audio-related registry changes.
2026-01-11T19:28:13.7056192Z                          .DESCRIPTION
2026-01-11T19:28:13.7056803Z                              Restores backed up registry keys for audio-related settings.
2026-01-11T19:28:13.7056962Z                          .OUTPUTS
2026-01-11T19:28:13.7058021Z                              None.
2026-01-11T19:28:13.7058150Z                          #>
2026-01-11T19:28:13.7059549Z                          Write-Log "Rolling back audio optimizations..." "INFO"
2026-01-11T19:28:13.7059693Z                      
2026-01-11T19:28:13.7060113Z                          try {
2026-01-11T19:28:13.7061226Z                              $paths = @(
2026-01-11T19:28:13.7061884Z                                  "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Audio",
2026-01-11T19:28:13.7062296Z                                  "HKCU:\Software\Microsoft\Multimedia\Audio",
2026-01-11T19:28:13.7062675Z                                  "HKCU:\AppEvents\Schemes"
2026-01-11T19:28:13.7063040Z                              )
2026-01-11T19:28:13.7064000Z                      
2026-01-11T19:28:13.7064254Z                              foreach ($path in $paths) {
2026-01-11T19:28:13.7065170Z                                  if (Restore-RegistryKey -Path $path) {
2026-01-11T19:28:13.7065656Z                                      Write-Log "Restored registry: $path" "SUCCESS"
2026-01-11T19:28:13.7066328Z                                  }
2026-01-11T19:28:13.7067317Z                              }
2026-01-11T19:28:13.7068137Z                      
2026-01-11T19:28:13.7068929Z                      
2026-01-11T19:28:13.7069231Z                              Write-Log "Audio optimization rollback complete" "SUCCESS"
2026-01-11T19:28:13.7069833Z                      
2026-01-11T19:28:13.7070688Z                          } catch {
2026-01-11T19:28:13.7071234Z                              Write-Log "Error during rollback: $_" "ERROR"
2026-01-11T19:28:13.7072366Z                              throw
2026-01-11T19:28:13.7072764Z                          }
2026-01-11T19:28:13.7072865Z                      }
2026-01-11T19:28:13.7074027Z                      
2026-01-11T19:28:13.7074592Z                      
2026-01-11T19:28:13.7074971Z                      Export-ModuleMember -Function @(
2026-01-11T19:28:13.7075780Z                          'Disable-AudioEnhancements',
2026-01-11T19:28:13.7076698Z                          'Set-AudioDriverOptimizations',
2026-01-11T19:28:13.7076861Z                          'Set-AudioExclusiveMode',
2026-01-11T19:28:13.7077954Z                          'Disable-SystemSounds',
2026-01-11T19:28:13.7078401Z                          'Test-AudioOptimizations',
2026-01-11T19:28:13.7079349Z                          'Invoke-AudioOptimizations',
2026-01-11T19:28:13.7080362Z                          'Undo-AudioOptimizations'
2026-01-11T19:28:13.7080798Z                      )
2026-01-11T19:28:13.7081190Z                      
2026-01-11T19:28:13.7082340Z [32;1mParent             : [0m
2026-01-11T19:28:13.7082356Z 
2026-01-11T19:28:13.7101474Z [32;1mAttributes         : [0m{}
2026-01-11T19:28:13.7101677Z [32;1mUsingStatements    : [0m{}
2026-01-11T19:28:13.7102721Z [32;1mParamBlock         : [0m
2026-01-11T19:28:13.7103132Z [32;1mBeginBlock         : [0m
2026-01-11T19:28:13.7104148Z [32;1mProcessBlock       : [0m
2026-01-11T19:28:13.7105668Z [32;1mEndBlock           : [0mImport-Module (Join-Path $PSScriptRoot "..\core\logger.psm1") -Force -Global
2026-01-11T19:28:13.7106150Z                      Import-Module (Join-Path $PSScriptRoot "..\core\registry.psm1") -Force -Global
2026-01-11T19:28:13.7106270Z                      
2026-01-11T19:28:13.7106991Z                      
2026-01-11T19:28:13.7107251Z                      
2026-01-11T19:28:13.7108059Z                      function Disable-ChromeBackgroundApps {
2026-01-11T19:28:13.7108951Z                          <#
2026-01-11T19:28:13.7109234Z                          .SYNOPSIS
2026-01-11T19:28:13.7110529Z                              Disables Chrome background apps via Group Policy.
2026-01-11T19:28:13.7110660Z                          .DESCRIPTION
2026-01-11T19:28:13.7111059Z                              Sets Chrome policy to prevent background apps from running when
2026-01-11T19:28:13.7111384Z                              Chrome is closed. Uses machine-level Group Policy registry.
2026-01-11T19:28:13.7112255Z                          .PARAMETER Enable
2026-01-11T19:28:13.7112600Z                              When true, disables Chrome background apps.
2026-01-11T19:28:13.7113102Z                          .OUTPUTS
2026-01-11T19:28:13.7114321Z                              None.
2026-01-11T19:28:13.7114992Z                          .NOTES
2026-01-11T19:28:13.7116640Z                              Uses Group Policy registry (HKLM) for reliable, persistent settings.
2026-01-11T19:28:13.7116762Z                          #>
2026-01-11T19:28:13.7117077Z                          param(
2026-01-11T19:28:13.7117911Z                              [bool]$Enable = $true
2026-01-11T19:28:13.7118290Z                          )
2026-01-11T19:28:13.7119432Z                      
2026-01-11T19:28:13.7119564Z                          if (-not $Enable) {
2026-01-11T19:28:13.7120861Z                              Write-Log "Chrome background apps disable: skipped" "INFO"
2026-01-11T19:28:13.7121001Z                              return
2026-01-11T19:28:13.7122059Z                          }
2026-01-11T19:28:13.7122757Z                      
2026-01-11T19:28:13.7123878Z                          try {
2026-01-11T19:28:13.7124167Z                              Write-Log "Disabling Chrome background apps..." "INFO"
2026-01-11T19:28:13.7124863Z                      
2026-01-11T19:28:13.7125421Z                              $chromePolicyPath = "HKLM:\SOFTWARE\Policies\Google\Chrome"
2026-01-11T19:28:13.7125520Z                      
2026-01-11T19:28:13.7126723Z                              # Create policy path if it doesn't exist
2026-01-11T19:28:13.7126957Z                              if (-not (Test-Path $chromePolicyPath)) {
2026-01-11T19:28:13.7127985Z                                  New-Item -Path $chromePolicyPath -Force | Out-Null
2026-01-11T19:28:13.7128379Z                              }
2026-01-11T19:28:13.7129360Z                      
2026-01-11T19:28:13.7130296Z                              Backup-RegistryKey -Path $chromePolicyPath
2026-01-11T19:28:13.7130690Z                      
2026-01-11T19:28:13.7131665Z                              # BackgroundModeEnabled = 0: Disable background apps
2026-01-11T19:28:13.7133257Z                              Set-RegistryValue -Path $chromePolicyPath -Name "BackgroundModeEnabled" -Value 0 -Type 
2026-01-11T19:28:13.7133374Z                      "DWORD"
2026-01-11T19:28:13.7133463Z                      
2026-01-11T19:28:13.7134813Z                              Write-Log "Chrome background apps disabled via Group Policy" "SUCCESS"
2026-01-11T19:28:13.7135470Z                              Write-Log "Chrome will no longer run in background when closed" "INFO"
2026-01-11T19:28:13.7135758Z                      
2026-01-11T19:28:13.7136218Z                          } catch {
2026-01-11T19:28:13.7136777Z                              Write-Log "Error disabling Chrome background apps: $_" "ERROR"
2026-01-11T19:28:13.7136920Z                              throw
2026-01-11T19:28:13.7137954Z                          }
2026-01-11T19:28:13.7138366Z                      }
2026-01-11T19:28:13.7139280Z                      
2026-01-11T19:28:13.7140089Z                      
2026-01-11T19:28:13.7140302Z                      function Disable-EdgeBackgroundApps {
2026-01-11T19:28:13.7140653Z                          <#
2026-01-11T19:28:13.7141226Z                          .SYNOPSIS
2026-01-11T19:28:13.7142327Z                              Disables Edge background apps and startup boost via Group Policy.
2026-01-11T19:28:13.7142844Z                          .DESCRIPTION
2026-01-11T19:28:13.7143792Z                              Sets Edge policies to prevent background apps, startup boost, and
2026-01-11T19:28:13.7144458Z                              background extensions. Uses machine-level Group Policy registry.
2026-01-11T19:28:13.7144875Z                          .PARAMETER Enable
2026-01-11T19:28:13.7145717Z                              When true, disables Edge background features.
2026-01-11T19:28:13.7146086Z                          .OUTPUTS
2026-01-11T19:28:13.7146991Z                              None.
2026-01-11T19:28:13.7147395Z                          .NOTES
2026-01-11T19:28:13.7148332Z                              Uses Group Policy registry (HKLM) for reliable, persistent settings.
2026-01-11T19:28:13.7149056Z                              Targets Edge background bloat: startup boost, background apps, extensions.
2026-01-11T19:28:13.7149475Z                          #>
2026-01-11T19:28:13.7150715Z                          param(
2026-01-11T19:28:13.7150904Z                              [bool]$Enable = $true
2026-01-11T19:28:13.7151843Z                          )
2026-01-11T19:28:13.7152931Z                      
2026-01-11T19:28:13.7153102Z                          if (-not $Enable) {
2026-01-11T19:28:13.7154614Z                              Write-Log "Edge background apps disable: skipped" "INFO"
2026-01-11T19:28:13.7154723Z                              return
2026-01-11T19:28:13.7155905Z                          }
2026-01-11T19:28:13.7156369Z                      
2026-01-11T19:28:13.7157500Z                          try {
2026-01-11T19:28:13.7158977Z                              Write-Log "Disabling Edge background features..." "INFO"
2026-01-11T19:28:13.7159130Z                      
2026-01-11T19:28:13.7159937Z                              $edgePolicyPath = "HKLM:\SOFTWARE\Policies\Microsoft\Edge"
2026-01-11T19:28:13.7160381Z                      
2026-01-11T19:28:13.7160980Z                              # Create policy path if it doesn't exist
2026-01-11T19:28:13.7161945Z                              if (-not (Test-Path $edgePolicyPath)) {
2026-01-11T19:28:13.7162544Z                                  New-Item -Path $edgePolicyPath -Force | Out-Null
2026-01-11T19:28:13.7162885Z                              }
2026-01-11T19:28:13.7163613Z                      
2026-01-11T19:28:13.7164711Z                              Backup-RegistryKey -Path $edgePolicyPath
2026-01-11T19:28:13.7164827Z                      
2026-01-11T19:28:13.7165607Z                              # StartupBoostEnabled = 0: Disable startup boost (preloading)
2026-01-11T19:28:13.7166975Z                              Set-RegistryValue -Path $edgePolicyPath -Name "StartupBoostEnabled" -Value 0 -Type "DWORD"
2026-01-11T19:28:13.7167355Z                              Write-Log "Edge startup boost disabled" "SUCCESS"
2026-01-11T19:28:13.7167447Z                      
2026-01-11T19:28:13.7168118Z                              # BackgroundModeEnabled = 0: Disable background apps
2026-01-11T19:28:13.7169497Z                              Set-RegistryValue -Path $edgePolicyPath -Name "BackgroundModeEnabled" -Value 0 -Type 
2026-01-11T19:28:13.7170017Z                      "DWORD"
2026-01-11T19:28:13.7170287Z                              Write-Log "Edge background apps disabled" "SUCCESS"
2026-01-11T19:28:13.7170484Z                      
2026-01-11T19:28:13.7171570Z                              # BackgroundExtensionsEnabled = 0: Disable background extensions
2026-01-11T19:28:13.7172793Z                              Set-RegistryValue -Path $edgePolicyPath -Name "BackgroundExtensionsEnabled" -Value 0 
2026-01-11T19:28:13.7173064Z                      -Type "DWORD"
2026-01-11T19:28:13.7174469Z                              Write-Log "Edge background extensions disabled" "SUCCESS"
2026-01-11T19:28:13.7174787Z                      
2026-01-11T19:28:13.7176456Z                              Write-Log "Edge background features disabled via Group Policy" "SUCCESS"
2026-01-11T19:28:13.7176856Z                              Write-Log "Edge will no longer run in background or preload at startup" "INFO"
2026-01-11T19:28:13.7177015Z                      
2026-01-11T19:28:13.7177923Z                          } catch {
2026-01-11T19:28:13.7178861Z                              Write-Log "Error disabling Edge background apps: $_" "ERROR"
2026-01-11T19:28:13.7179260Z                              throw
2026-01-11T19:28:13.7180499Z                          }
2026-01-11T19:28:13.7180611Z                      }
2026-01-11T19:28:13.7181559Z                      
2026-01-11T19:28:13.7181761Z                      
2026-01-11T19:28:13.7182501Z                      function Test-BrowserBackgroundApps {
2026-01-11T19:28:13.7183573Z                          <#
2026-01-11T19:28:13.7183779Z                          .SYNOPSIS
2026-01-11T19:28:13.7184195Z                              Verifies that browser background apps are disabled.
2026-01-11T19:28:13.7185629Z                          .DESCRIPTION
2026-01-11T19:28:13.7186231Z                              Checks Chrome and Edge Group Policy registry values.
2026-01-11T19:28:13.7186347Z                          .OUTPUTS
2026-01-11T19:28:13.7186832Z                              [bool] True when checks pass, else false.
2026-01-11T19:28:13.7187973Z                          #>
2026-01-11T19:28:13.7188097Z                          $allPassed = $true
2026-01-11T19:28:13.7189184Z                      
2026-01-11T19:28:13.7190129Z                          Write-Log "Verifying browser background settings..." "INFO"
2026-01-11T19:28:13.7190258Z                      
2026-01-11T19:28:13.7191901Z                          try {
2026-01-11T19:28:13.7192111Z                              # Chrome
2026-01-11T19:28:13.7193390Z                              $chromePolicyPath = "HKLM:\SOFTWARE\Policies\Google\Chrome"
2026-01-11T19:28:13.7193611Z                              if (Test-Path $chromePolicyPath) {
2026-01-11T19:28:13.7194998Z                                  $chromeBgMode = Get-RegistryValue -Path $chromePolicyPath -Name 
2026-01-11T19:28:13.7195154Z                      "BackgroundModeEnabled"
2026-01-11T19:28:13.7195674Z                                  if ($chromeBgMode -eq 0) {
2026-01-11T19:28:13.7196577Z                                      Write-Log "‚úì Chrome background apps disabled" "SUCCESS"
2026-01-11T19:28:13.7196729Z                                  } else {
2026-01-11T19:28:13.7198779Z                                      Write-Log "‚úó Chrome background apps not disabled" "ERROR"
2026-01-11T19:28:13.7198955Z                                      $allPassed = $false
2026-01-11T19:28:13.7199049Z                                  }
2026-01-11T19:28:13.7199180Z                              } else {
2026-01-11T19:28:13.7200339Z                                  Write-Log "‚óã Chrome policy path not found (Chrome may not be installed)" "INFO"
2026-01-11T19:28:13.7200494Z                              }
2026-01-11T19:28:13.7201314Z                      
2026-01-11T19:28:13.7201491Z                              # Edge
2026-01-11T19:28:13.7202740Z                              $edgePolicyPath = "HKLM:\SOFTWARE\Policies\Microsoft\Edge"
2026-01-11T19:28:13.7202948Z                              if (Test-Path $edgePolicyPath) {
2026-01-11T19:28:13.7203572Z                                  $edgeStartupBoost = Get-RegistryValue -Path $edgePolicyPath -Name 
2026-01-11T19:28:13.7204645Z                      "StartupBoostEnabled"
2026-01-11T19:28:13.7205106Z                                  $edgeBgMode = Get-RegistryValue -Path $edgePolicyPath -Name "BackgroundModeEnabled"
2026-01-11T19:28:13.7206144Z                                  $edgeBgExt = Get-RegistryValue -Path $edgePolicyPath -Name 
2026-01-11T19:28:13.7206348Z                      "BackgroundExtensionsEnabled"
2026-01-11T19:28:13.7207172Z                      
2026-01-11T19:28:13.7207363Z                                  if ($edgeStartupBoost -eq 0) {
2026-01-11T19:28:13.7208019Z                                      Write-Log "‚úì Edge startup boost disabled" "SUCCESS"
2026-01-11T19:28:13.7209071Z                                  } else {
2026-01-11T19:28:13.7209546Z                                      Write-Log "‚úó Edge startup boost not disabled" "ERROR"
2026-01-11T19:28:13.7209729Z                                      $allPassed = $false
2026-01-11T19:28:13.7210581Z                                  }
2026-01-11T19:28:13.7211612Z                      
2026-01-11T19:28:13.7212120Z                                  if ($edgeBgMode -eq 0) {
2026-01-11T19:28:13.7213592Z                                      Write-Log "‚úì Edge background apps disabled" "SUCCESS"
2026-01-11T19:28:13.7213721Z                                  } else {
2026-01-11T19:28:13.7214320Z                                      Write-Log "‚úó Edge background apps not disabled" "ERROR"
2026-01-11T19:28:13.7214534Z                                      $allPassed = $false
2026-01-11T19:28:13.7215833Z                                  }
2026-01-11T19:28:13.7215938Z                      
2026-01-11T19:28:13.7216364Z                                  if ($edgeBgExt -eq 0) {
2026-01-11T19:28:13.7217955Z                                      Write-Log "‚úì Edge background extensions disabled" "SUCCESS"
2026-01-11T19:28:13.7218081Z                                  } else {
2026-01-11T19:28:13.7218780Z                                      Write-Log "‚úó Edge background extensions not disabled" "ERROR"
2026-01-11T19:28:13.7218932Z                                      $allPassed = $false
2026-01-11T19:28:13.7219291Z                                  }
2026-01-11T19:28:13.7220327Z                              } else {
2026-01-11T19:28:13.7221413Z                                  Write-Log "‚óã Edge policy path not found (Edge may not be installed)" "INFO"
2026-01-11T19:28:13.7221558Z                              }
2026-01-11T19:28:13.7222515Z                      
2026-01-11T19:28:13.7222794Z                          } catch {
2026-01-11T19:28:13.7224300Z                              Write-Log "Error verifying browser settings: $_" "ERROR"
2026-01-11T19:28:13.7224456Z                              return $false
2026-01-11T19:28:13.7224791Z                          }
2026-01-11T19:28:13.7225006Z                      
2026-01-11T19:28:13.7225991Z                          return $allPassed
2026-01-11T19:28:13.7226999Z                      }
2026-01-11T19:28:13.7227116Z                      
2026-01-11T19:28:13.7228217Z                      
2026-01-11T19:28:13.7229255Z                      function Invoke-BrowserOptimizations {
2026-01-11T19:28:13.7229631Z                          <#
2026-01-11T19:28:13.7230743Z                          .SYNOPSIS
2026-01-11T19:28:13.7231767Z                              Applies all browser optimizations.
2026-01-11T19:28:13.7232270Z                          .DESCRIPTION
2026-01-11T19:28:13.7233308Z                              Disables background apps for Chrome and Edge via Group Policy.
2026-01-11T19:28:13.7233711Z                          .PARAMETER DisableChromeBackground
2026-01-11T19:28:13.7234670Z                              When true, disables Chrome background apps.
2026-01-11T19:28:13.7234910Z                          .PARAMETER DisableEdgeBackground
2026-01-11T19:28:13.7236088Z                              When true, disables Edge background apps and startup boost.
2026-01-11T19:28:13.7236190Z                          .OUTPUTS
2026-01-11T19:28:13.7236814Z                              None.
2026-01-11T19:28:13.7236957Z                          #>
2026-01-11T19:28:13.7237990Z                          param(
2026-01-11T19:28:13.7238821Z                              [bool]$DisableChromeBackground = $true,
2026-01-11T19:28:13.7239576Z                              [bool]$DisableEdgeBackground = $true
2026-01-11T19:28:13.7240561Z                          )
2026-01-11T19:28:13.7240758Z                      
2026-01-11T19:28:13.7241986Z                          Write-Log "Applying browser optimizations..." "INFO"
2026-01-11T19:28:13.7242302Z                      
2026-01-11T19:28:13.7243299Z                          try {
2026-01-11T19:28:13.7244555Z                              if ($DisableChromeBackground) {
2026-01-11T19:28:13.7244839Z                                  Disable-ChromeBackgroundApps -Enable $true
2026-01-11T19:28:13.7245206Z                              }
2026-01-11T19:28:13.7246359Z                      
2026-01-11T19:28:13.7246563Z                              if ($DisableEdgeBackground) {
2026-01-11T19:28:13.7247338Z                                  Disable-EdgeBackgroundApps -Enable $true
2026-01-11T19:28:13.7248062Z                              }
2026-01-11T19:28:13.7248856Z                      
2026-01-11T19:28:13.7249793Z                              Write-Log "Browser optimizations complete" "SUCCESS"
2026-01-11T19:28:13.7251355Z                              Write-Log "Note: Restart browsers for changes to take effect" "INFO"
2026-01-11T19:28:13.7251684Z                      
2026-01-11T19:28:13.7251887Z                          } catch {
2026-01-11T19:28:13.7252851Z                              Write-Log "Error applying browser optimizations: $_" "ERROR"
2026-01-11T19:28:13.7253293Z                              throw
2026-01-11T19:28:13.7254477Z                          }
2026-01-11T19:28:13.7254580Z                      }
2026-01-11T19:28:13.7255592Z                      
2026-01-11T19:28:13.7255703Z                      
2026-01-11T19:28:13.7256718Z                      function Undo-BrowserOptimizations {
2026-01-11T19:28:13.7257653Z                          <#
2026-01-11T19:28:13.7258480Z                          .SYNOPSIS
2026-01-11T19:28:13.7259429Z                              Reverts browser-related changes.
2026-01-11T19:28:13.7260554Z                          .DESCRIPTION
2026-01-11T19:28:13.7261030Z                              Restores default browser background app settings by removing Group Policy keys.
2026-01-11T19:28:13.7261977Z                          .OUTPUTS
2026-01-11T19:28:13.7262437Z                              None.
2026-01-11T19:28:13.7263091Z                          #>
2026-01-11T19:28:13.7264389Z                          Write-Log "Rolling back browser optimizations..." "INFO"
2026-01-11T19:28:13.7264942Z                      
2026-01-11T19:28:13.7265859Z                          try {
2026-01-11T19:28:13.7266299Z                              # Chrome
2026-01-11T19:28:13.7267490Z                              $chromePolicyPath = "HKLM:\SOFTWARE\Policies\Google\Chrome"
2026-01-11T19:28:13.7267917Z                              if (Restore-RegistryKey -Path $chromePolicyPath) {
2026-01-11T19:28:13.7268862Z                                  Write-Log "Restored Chrome policy settings" "SUCCESS"
2026-01-11T19:28:13.7268965Z                              }
2026-01-11T19:28:13.7269643Z                      
2026-01-11T19:28:13.7269786Z                              # Edge
2026-01-11T19:28:13.7271387Z                              $edgePolicyPath = "HKLM:\SOFTWARE\Policies\Microsoft\Edge"
2026-01-11T19:28:13.7271859Z                              if (Restore-RegistryKey -Path $edgePolicyPath) {
2026-01-11T19:28:13.7272110Z                                  Write-Log "Restored Edge policy settings" "SUCCESS"
2026-01-11T19:28:13.7273109Z                              }
2026-01-11T19:28:13.7273860Z                      
2026-01-11T19:28:13.7274564Z                              Write-Log "Browser optimization rollback complete" "SUCCESS"
2026-01-11T19:28:13.7274969Z                              Write-Log "Note: Restart browsers for changes to take effect" "INFO"
2026-01-11T19:28:13.7275426Z                      
2026-01-11T19:28:13.7276414Z                          } catch {
2026-01-11T19:28:13.7277424Z                              Write-Log "Error during rollback: $_" "ERROR"
2026-01-11T19:28:13.7277976Z                              throw
2026-01-11T19:28:13.7278438Z                          }
2026-01-11T19:28:13.7287818Z                      }
2026-01-11T19:28:13.7287961Z                      
2026-01-11T19:28:13.7288056Z                      
2026-01-11T19:28:13.7288237Z                      Export-ModuleMember -Function @(
2026-01-11T19:28:13.7288600Z                          'Disable-ChromeBackgroundApps',
2026-01-11T19:28:13.7288813Z                          'Disable-EdgeBackgroundApps',
2026-01-11T19:28:13.7288979Z                          'Test-BrowserBackgroundApps',
2026-01-11T19:28:13.7289138Z                          'Invoke-BrowserOptimizations',
2026-01-11T19:28:13.7289308Z                          'Undo-BrowserOptimizations'
2026-01-11T19:28:13.7289396Z                      )
2026-01-11T19:28:13.7289659Z [32;1mCleanBlock         : [0m
2026-01-11T19:28:13.7289885Z [32;1mDynamicParamBlock  : [0m
2026-01-11T19:28:13.7290436Z [32;1mScriptRequirements : [0mSystem.Management.Automation.Language.ScriptRequirements
2026-01-11T19:28:13.7290910Z [32;1mExtent             : [0m<#
2026-01-11T19:28:13.7291028Z                      .SYNOPSIS
2026-01-11T19:28:13.7291300Z                          Browser optimizations for gaming (Chrome, Edge, Firefox).
2026-01-11T19:28:13.7291376Z                      .DESCRIPTION
2026-01-11T19:28:13.7291970Z                          Disables browser background apps, hardware acceleration, and startup boost
2026-01-11T19:28:13.7292240Z                          via Group Policy registry keys (machine-wide settings).
2026-01-11T19:28:13.7292339Z                      .NOTES
2026-01-11T19:28:13.7292733Z                          Requires Administrator. Uses machine-level Group Policy registry paths.
2026-01-11T19:28:13.7292842Z                      #>
2026-01-11T19:28:13.7292983Z                      #Requires -RunAsAdministrator
2026-01-11T19:28:13.7293330Z                      
2026-01-11T19:28:13.7294410Z                      
2026-01-11T19:28:13.7294946Z                      
2026-01-11T19:28:13.7295870Z                      Import-Module (Join-Path $PSScriptRoot "..\core\logger.psm1") -Force -Global
2026-01-11T19:28:13.7297129Z                      Import-Module (Join-Path $PSScriptRoot "..\core\registry.psm1") -Force -Global
2026-01-11T19:28:13.7297485Z                      
2026-01-11T19:28:13.7297584Z                      
2026-01-11T19:28:13.7297873Z                      
2026-01-11T19:28:13.7298867Z                      function Disable-ChromeBackgroundApps {
2026-01-11T19:28:13.7299285Z                          <#
2026-01-11T19:28:13.7300191Z                          .SYNOPSIS
2026-01-11T19:28:13.7300751Z                              Disables Chrome background apps via Group Policy.
2026-01-11T19:28:13.7301237Z                          .DESCRIPTION
2026-01-11T19:28:13.7302108Z                              Sets Chrome policy to prevent background apps from running when
2026-01-11T19:28:13.7302700Z                              Chrome is closed. Uses machine-level Group Policy registry.
2026-01-11T19:28:13.7303647Z                          .PARAMETER Enable
2026-01-11T19:28:13.7303904Z                              When true, disables Chrome background apps.
2026-01-11T19:28:13.7304147Z                          .OUTPUTS
2026-01-11T19:28:13.7305159Z                              None.
2026-01-11T19:28:13.7305618Z                          .NOTES
2026-01-11T19:28:13.7306738Z                              Uses Group Policy registry (HKLM) for reliable, persistent settings.
2026-01-11T19:28:13.7306840Z                          #>
2026-01-11T19:28:13.7307639Z                          param(
2026-01-11T19:28:13.7308149Z                              [bool]$Enable = $true
2026-01-11T19:28:13.7308879Z                          )
2026-01-11T19:28:13.7308995Z                      
2026-01-11T19:28:13.7310020Z                          if (-not $Enable) {
2026-01-11T19:28:13.7310319Z                              Write-Log "Chrome background apps disable: skipped" "INFO"
2026-01-11T19:28:13.7310840Z                              return
2026-01-11T19:28:13.7311680Z                          }
2026-01-11T19:28:13.7312504Z                      
2026-01-11T19:28:13.7313492Z                          try {
2026-01-11T19:28:13.7314649Z                              Write-Log "Disabling Chrome background apps..." "INFO"
2026-01-11T19:28:13.7315042Z                      
2026-01-11T19:28:13.7316083Z                              $chromePolicyPath = "HKLM:\SOFTWARE\Policies\Google\Chrome"
2026-01-11T19:28:13.7316493Z                      
2026-01-11T19:28:13.7317743Z                              # Create policy path if it doesn't exist
2026-01-11T19:28:13.7317933Z                              if (-not (Test-Path $chromePolicyPath)) {
2026-01-11T19:28:13.7319423Z                                  New-Item -Path $chromePolicyPath -Force | Out-Null
2026-01-11T19:28:13.7319533Z                              }
2026-01-11T19:28:13.7319799Z                      
2026-01-11T19:28:13.7321343Z                              Backup-RegistryKey -Path $chromePolicyPath
2026-01-11T19:28:13.7321472Z                      
2026-01-11T19:28:13.7321791Z                              # BackgroundModeEnabled = 0: Disable background apps
2026-01-11T19:28:13.7323074Z                              Set-RegistryValue -Path $chromePolicyPath -Name "BackgroundModeEnabled" -Value 0 -Type 
2026-01-11T19:28:13.7323186Z                      "DWORD"
2026-01-11T19:28:13.7323271Z                      
2026-01-11T19:28:13.7324381Z                              Write-Log "Chrome background apps disabled via Group Policy" "SUCCESS"
2026-01-11T19:28:13.7324993Z                              Write-Log "Chrome will no longer run in background when closed" "INFO"
2026-01-11T19:28:13.7325687Z                      
2026-01-11T19:28:13.7326640Z                          } catch {
2026-01-11T19:28:13.7327654Z                              Write-Log "Error disabling Chrome background apps: $_" "ERROR"
2026-01-11T19:28:13.7327991Z                              throw
2026-01-11T19:28:13.7328997Z                          }
2026-01-11T19:28:13.7329577Z                      }
2026-01-11T19:28:13.7330437Z                      
2026-01-11T19:28:13.7331050Z                      
2026-01-11T19:28:13.7331957Z                      function Disable-EdgeBackgroundApps {
2026-01-11T19:28:13.7333304Z                          <#
2026-01-11T19:28:13.7333440Z                          .SYNOPSIS
2026-01-11T19:28:13.7334685Z                              Disables Edge background apps and startup boost via Group Policy.
2026-01-11T19:28:13.7335213Z                          .DESCRIPTION
2026-01-11T19:28:13.7336277Z                              Sets Edge policies to prevent background apps, startup boost, and
2026-01-11T19:28:13.7336595Z                              background extensions. Uses machine-level Group Policy registry.
2026-01-11T19:28:13.7336777Z                          .PARAMETER Enable
2026-01-11T19:28:13.7338130Z                              When true, disables Edge background features.
2026-01-11T19:28:13.7338256Z                          .OUTPUTS
2026-01-11T19:28:13.7338570Z                              None.
2026-01-11T19:28:13.7339428Z                          .NOTES
2026-01-11T19:28:13.7340445Z                              Uses Group Policy registry (HKLM) for reliable, persistent settings.
2026-01-11T19:28:13.7341245Z                              Targets Edge background bloat: startup boost, background apps, extensions.
2026-01-11T19:28:13.7341379Z                          #>
2026-01-11T19:28:13.7342514Z                          param(
2026-01-11T19:28:13.7342675Z                              [bool]$Enable = $true
2026-01-11T19:28:13.7343552Z                          )
2026-01-11T19:28:13.7343965Z                      
2026-01-11T19:28:13.7344433Z                          if (-not $Enable) {
2026-01-11T19:28:13.7345706Z                              Write-Log "Edge background apps disable: skipped" "INFO"
2026-01-11T19:28:13.7345826Z                              return
2026-01-11T19:28:13.7346866Z                          }
2026-01-11T19:28:13.7347265Z                      
2026-01-11T19:28:13.7348167Z                          try {
2026-01-11T19:28:13.7348507Z                              Write-Log "Disabling Edge background features..." "INFO"
2026-01-11T19:28:13.7349126Z                      
2026-01-11T19:28:13.7350729Z                              $edgePolicyPath = "HKLM:\SOFTWARE\Policies\Microsoft\Edge"
2026-01-11T19:28:13.7350849Z                      
2026-01-11T19:28:13.7351848Z                              # Create policy path if it doesn't exist
2026-01-11T19:28:13.7352959Z                              if (-not (Test-Path $edgePolicyPath)) {
2026-01-11T19:28:13.7353279Z                                  New-Item -Path $edgePolicyPath -Force | Out-Null
2026-01-11T19:28:13.7354227Z                              }
2026-01-11T19:28:13.7354472Z                      
2026-01-11T19:28:13.7355985Z                              Backup-RegistryKey -Path $edgePolicyPath
2026-01-11T19:28:13.7356102Z                      
2026-01-11T19:28:13.7356620Z                              # StartupBoostEnabled = 0: Disable startup boost (preloading)
2026-01-11T19:28:13.7357285Z                              Set-RegistryValue -Path $edgePolicyPath -Name "StartupBoostEnabled" -Value 0 -Type "DWORD"
2026-01-11T19:28:13.7357740Z                              Write-Log "Edge startup boost disabled" "SUCCESS"
2026-01-11T19:28:13.7358732Z                      
2026-01-11T19:28:13.7359013Z                              # BackgroundModeEnabled = 0: Disable background apps
2026-01-11T19:28:13.7360452Z                              Set-RegistryValue -Path $edgePolicyPath -Name "BackgroundModeEnabled" -Value 0 -Type 
2026-01-11T19:28:13.7360575Z                      "DWORD"
2026-01-11T19:28:13.7361064Z                              Write-Log "Edge background apps disabled" "SUCCESS"
2026-01-11T19:28:13.7362192Z                      
2026-01-11T19:28:13.7362570Z                              # BackgroundExtensionsEnabled = 0: Disable background extensions
2026-01-11T19:28:13.7363596Z                              Set-RegistryValue -Path $edgePolicyPath -Name "BackgroundExtensionsEnabled" -Value 0 
2026-01-11T19:28:13.7363984Z                      -Type "DWORD"
2026-01-11T19:28:13.7364274Z                              Write-Log "Edge background extensions disabled" "SUCCESS"
2026-01-11T19:28:13.7364363Z                      
2026-01-11T19:28:13.7365836Z                              Write-Log "Edge background features disabled via Group Policy" "SUCCESS"
2026-01-11T19:28:13.7366172Z                              Write-Log "Edge will no longer run in background or preload at startup" "INFO"
2026-01-11T19:28:13.7366535Z                      
2026-01-11T19:28:13.7367438Z                          } catch {
2026-01-11T19:28:13.7367847Z                              Write-Log "Error disabling Edge background apps: $_" "ERROR"
2026-01-11T19:28:13.7368263Z                              throw
2026-01-11T19:28:13.7368496Z                          }
2026-01-11T19:28:13.7369879Z                      }
2026-01-11T19:28:13.7370281Z                      
2026-01-11T19:28:13.7371254Z                      
2026-01-11T19:28:13.7371560Z                      function Test-BrowserBackgroundApps {
2026-01-11T19:28:13.7371737Z                          <#
2026-01-11T19:28:13.7373024Z                          .SYNOPSIS
2026-01-11T19:28:13.7373941Z                              Verifies that browser background apps are disabled.
2026-01-11T19:28:13.7374377Z                          .DESCRIPTION
2026-01-11T19:28:13.7375490Z                              Checks Chrome and Edge Group Policy registry values.
2026-01-11T19:28:13.7375875Z                          .OUTPUTS
2026-01-11T19:28:13.7376585Z                              [bool] True when checks pass, else false.
2026-01-11T19:28:13.7377041Z                          #>
2026-01-11T19:28:13.7378030Z                          $allPassed = $true
2026-01-11T19:28:13.7378127Z                      
2026-01-11T19:28:13.7379447Z                          Write-Log "Verifying browser background settings..." "INFO"
2026-01-11T19:28:13.7379571Z                      
2026-01-11T19:28:13.7379968Z                          try {
2026-01-11T19:28:13.7380400Z                              # Chrome
2026-01-11T19:28:13.7381673Z                              $chromePolicyPath = "HKLM:\SOFTWARE\Policies\Google\Chrome"
2026-01-11T19:28:13.7381871Z                              if (Test-Path $chromePolicyPath) {
2026-01-11T19:28:13.7383078Z                                  $chromeBgMode = Get-RegistryValue -Path $chromePolicyPath -Name 
2026-01-11T19:28:13.7383616Z                      "BackgroundModeEnabled"
2026-01-11T19:28:13.7383798Z                                  if ($chromeBgMode -eq 0) {
2026-01-11T19:28:13.7385164Z                                      Write-Log "‚úì Chrome background apps disabled" "SUCCESS"
2026-01-11T19:28:13.7385553Z                                  } else {
2026-01-11T19:28:13.7386718Z                                      Write-Log "‚úó Chrome background apps not disabled" "ERROR"
2026-01-11T19:28:13.7386927Z                                      $allPassed = $false
2026-01-11T19:28:13.7387878Z                                  }
2026-01-11T19:28:13.7388640Z                              } else {
2026-01-11T19:28:13.7390318Z                                  Write-Log "‚óã Chrome policy path not found (Chrome may not be installed)" "INFO"
2026-01-11T19:28:13.7390436Z                              }
2026-01-11T19:28:13.7391185Z                      
2026-01-11T19:28:13.7391512Z                              # Edge
2026-01-11T19:28:13.7391786Z                              $edgePolicyPath = "HKLM:\SOFTWARE\Policies\Microsoft\Edge"
2026-01-11T19:28:13.7393006Z                              if (Test-Path $edgePolicyPath) {
2026-01-11T19:28:13.7394168Z                                  $edgeStartupBoost = Get-RegistryValue -Path $edgePolicyPath -Name 
2026-01-11T19:28:13.7394319Z                      "StartupBoostEnabled"
2026-01-11T19:28:13.7395440Z                                  $edgeBgMode = Get-RegistryValue -Path $edgePolicyPath -Name "BackgroundModeEnabled"
2026-01-11T19:28:13.7396098Z                                  $edgeBgExt = Get-RegistryValue -Path $edgePolicyPath -Name 
2026-01-11T19:28:13.7396281Z                      "BackgroundExtensionsEnabled"
2026-01-11T19:28:13.7397409Z                      
2026-01-11T19:28:13.7397608Z                                  if ($edgeStartupBoost -eq 0) {
2026-01-11T19:28:13.7398748Z                                      Write-Log "‚úì Edge startup boost disabled" "SUCCESS"
2026-01-11T19:28:13.7399107Z                                  } else {
2026-01-11T19:28:13.7400547Z                                      Write-Log "‚úó Edge startup boost not disabled" "ERROR"
2026-01-11T19:28:13.7400765Z                                      $allPassed = $false
2026-01-11T19:28:13.7401869Z                                  }
2026-01-11T19:28:13.7401974Z                      
2026-01-11T19:28:13.7403161Z                                  if ($edgeBgMode -eq 0) {
2026-01-11T19:28:13.7403622Z                                      Write-Log "‚úì Edge background apps disabled" "SUCCESS"
2026-01-11T19:28:13.7403945Z                                  } else {
2026-01-11T19:28:13.7405354Z                                      Write-Log "‚úó Edge background apps not disabled" "ERROR"
2026-01-11T19:28:13.7405516Z                                      $allPassed = $false
2026-01-11T19:28:13.7405839Z                                  }
2026-01-11T19:28:13.7406717Z                      
2026-01-11T19:28:13.7407221Z                                  if ($edgeBgExt -eq 0) {
2026-01-11T19:28:13.7408398Z                                      Write-Log "‚úì Edge background extensions disabled" "SUCCESS"
2026-01-11T19:28:13.7408924Z                                  } else {
2026-01-11T19:28:13.7409453Z                                      Write-Log "‚úó Edge background extensions not disabled" "ERROR"
2026-01-11T19:28:13.7409595Z                                      $allPassed = $false
2026-01-11T19:28:13.7410350Z                                  }
2026-01-11T19:28:13.7411493Z                              } else {
2026-01-11T19:28:13.7412667Z                                  Write-Log "‚óã Edge policy path not found (Edge may not be installed)" "INFO"
2026-01-11T19:28:13.7412778Z                              }
2026-01-11T19:28:13.7412869Z                      
2026-01-11T19:28:13.7413331Z                          } catch {
2026-01-11T19:28:13.7414241Z                              Write-Log "Error verifying browser settings: $_" "ERROR"
2026-01-11T19:28:13.7414577Z                              return $false
2026-01-11T19:28:13.7415533Z                          }
2026-01-11T19:28:13.7416372Z                      
2026-01-11T19:28:13.7416750Z                          return $allPassed
2026-01-11T19:28:13.7418019Z                      }
2026-01-11T19:28:13.7418123Z                      
2026-01-11T19:28:13.7419213Z                      
2026-01-11T19:28:13.7419500Z                      function Invoke-BrowserOptimizations {
2026-01-11T19:28:13.7420846Z                          <#
2026-01-11T19:28:13.7421078Z                          .SYNOPSIS
2026-01-11T19:28:13.7421803Z                              Applies all browser optimizations.
2026-01-11T19:28:13.7422556Z                          .DESCRIPTION
2026-01-11T19:28:13.7423847Z                              Disables background apps for Chrome and Edge via Group Policy.
2026-01-11T19:28:13.7424052Z                          .PARAMETER DisableChromeBackground
2026-01-11T19:28:13.7424833Z                              When true, disables Chrome background apps.
2026-01-11T19:28:13.7425297Z                          .PARAMETER DisableEdgeBackground
2026-01-11T19:28:13.7425805Z                              When true, disables Edge background apps and startup boost.
2026-01-11T19:28:13.7426874Z                          .OUTPUTS
2026-01-11T19:28:13.7427296Z                              None.
2026-01-11T19:28:13.7427976Z                          #>
2026-01-11T19:28:13.7429571Z                          param(
2026-01-11T19:28:13.7429756Z                              [bool]$DisableChromeBackground = $true,
2026-01-11T19:28:13.7431008Z                              [bool]$DisableEdgeBackground = $true
2026-01-11T19:28:13.7431436Z                          )
2026-01-11T19:28:13.7432084Z                      
2026-01-11T19:28:13.7433080Z                          Write-Log "Applying browser optimizations..." "INFO"
2026-01-11T19:28:13.7433614Z                      
2026-01-11T19:28:13.7433774Z                          try {
2026-01-11T19:28:13.7435165Z                              if ($DisableChromeBackground) {
2026-01-11T19:28:13.7435407Z                                  Disable-ChromeBackgroundApps -Enable $true
2026-01-11T19:28:13.7435742Z                              }
2026-01-11T19:28:13.7436927Z                      
2026-01-11T19:28:13.7437144Z                              if ($DisableEdgeBackground) {
2026-01-11T19:28:13.7438067Z                                  Disable-EdgeBackgroundApps -Enable $true
2026-01-11T19:28:13.7438720Z                              }
2026-01-11T19:28:13.7439371Z                      
2026-01-11T19:28:13.7440469Z                              Write-Log "Browser optimizations complete" "SUCCESS"
2026-01-11T19:28:13.7440835Z                              Write-Log "Note: Restart browsers for changes to take effect" "INFO"
2026-01-11T19:28:13.7441269Z                      
2026-01-11T19:28:13.7442615Z                          } catch {
2026-01-11T19:28:13.7442922Z                              Write-Log "Error applying browser optimizations: $_" "ERROR"
2026-01-11T19:28:13.7443366Z                              throw
2026-01-11T19:28:13.7444511Z                          }
2026-01-11T19:28:13.7444622Z                      }
2026-01-11T19:28:13.7446069Z                      
2026-01-11T19:28:13.7446547Z                      
2026-01-11T19:28:13.7446779Z                      function Undo-BrowserOptimizations {
2026-01-11T19:28:13.7447849Z                          <#
2026-01-11T19:28:13.7447976Z                          .SYNOPSIS
2026-01-11T19:28:13.7449110Z                              Reverts browser-related changes.
2026-01-11T19:28:13.7449232Z                          .DESCRIPTION
2026-01-11T19:28:13.7451238Z                              Restores default browser background app settings by removing Group Policy keys.
2026-01-11T19:28:13.7451435Z                          .OUTPUTS
2026-01-11T19:28:13.7451553Z                              None.
2026-01-11T19:28:13.7452297Z                          #>
2026-01-11T19:28:13.7453267Z                          Write-Log "Rolling back browser optimizations..." "INFO"
2026-01-11T19:28:13.7453385Z                      
2026-01-11T19:28:13.7454306Z                          try {
2026-01-11T19:28:13.7455342Z                              # Chrome
2026-01-11T19:28:13.7455969Z                              $chromePolicyPath = "HKLM:\SOFTWARE\Policies\Google\Chrome"
2026-01-11T19:28:13.7456265Z                              if (Restore-RegistryKey -Path $chromePolicyPath) {
2026-01-11T19:28:13.7456839Z                                  Write-Log "Restored Chrome policy settings" "SUCCESS"
2026-01-11T19:28:13.7457146Z                              }
2026-01-11T19:28:13.7457529Z                      
2026-01-11T19:28:13.7457963Z                              # Edge
2026-01-11T19:28:13.7458537Z                              $edgePolicyPath = "HKLM:\SOFTWARE\Policies\Microsoft\Edge"
2026-01-11T19:28:13.7458926Z                              if (Restore-RegistryKey -Path $edgePolicyPath) {
2026-01-11T19:28:13.7459310Z                                  Write-Log "Restored Edge policy settings" "SUCCESS"
2026-01-11T19:28:13.7459575Z                              }
2026-01-11T19:28:13.7460792Z                      
2026-01-11T19:28:13.7461736Z                              Write-Log "Browser optimization rollback complete" "SUCCESS"
2026-01-11T19:28:13.7462075Z                              Write-Log "Note: Restart browsers for changes to take effect" "INFO"
2026-01-11T19:28:13.7462422Z                      
2026-01-11T19:28:13.7463566Z                          } catch {
2026-01-11T19:28:13.7463794Z                              Write-Log "Error during rollback: $_" "ERROR"
2026-01-11T19:28:13.7464485Z                              throw
2026-01-11T19:28:13.7465603Z                          }
2026-01-11T19:28:13.7465966Z                      }
2026-01-11T19:28:13.7466762Z                      
2026-01-11T19:28:13.7467388Z                      
2026-01-11T19:28:13.7468677Z                      Export-ModuleMember -Function @(
2026-01-11T19:28:13.7468858Z                          'Disable-ChromeBackgroundApps',
2026-01-11T19:28:13.7469802Z                          'Disable-EdgeBackgroundApps',
2026-01-11T19:28:13.7470097Z                          'Test-BrowserBackgroundApps',
2026-01-11T19:28:13.7471093Z                          'Invoke-BrowserOptimizations',
2026-01-11T19:28:13.7472386Z                          'Undo-BrowserOptimizations'
2026-01-11T19:28:13.7472506Z                      )
2026-01-11T19:28:13.7473399Z                      
2026-01-11T19:28:13.7473692Z [32;1mParent             : [0m
2026-01-11T19:28:13.7474531Z 
2026-01-11T19:28:13.7497639Z [32;1mAttributes         : [0m{}
2026-01-11T19:28:13.7498634Z [32;1mUsingStatements    : [0m{}
2026-01-11T19:28:13.7499097Z [32;1mParamBlock         : [0m
2026-01-11T19:28:13.7500040Z [32;1mBeginBlock         : [0m
2026-01-11T19:28:13.7500453Z [32;1mProcessBlock       : [0m
2026-01-11T19:28:13.7502896Z [32;1mEndBlock           : [0mImport-Module (Join-Path $PSScriptRoot "..\core\logger.psm1") -Force -Global
2026-01-11T19:28:13.7503335Z                      Import-Module (Join-Path $PSScriptRoot "..\core\registry.psm1") -Force -Global
2026-01-11T19:28:13.7503441Z                      
2026-01-11T19:28:13.7503531Z                      
2026-01-11T19:28:13.7504298Z                      
2026-01-11T19:28:13.7505181Z                      function Test-GPUVendor {
2026-01-11T19:28:13.7505965Z                          <#
2026-01-11T19:28:13.7506792Z                          .SYNOPSIS
2026-01-11T19:28:13.7508589Z                              Detects the primary GPU vendor.
2026-01-11T19:28:13.7508742Z                          .DESCRIPTION
2026-01-11T19:28:13.7509206Z                              Reads Win32_VideoController and maps the first adapter to nvidia/amd/intel.
2026-01-11T19:28:13.7509417Z                          .OUTPUTS
2026-01-11T19:28:13.7510706Z                              [string] One of: nvidia, amd, intel, unknown.
2026-01-11T19:28:13.7510837Z                          #>
2026-01-11T19:28:13.7510934Z                          try {
2026-01-11T19:28:13.7513551Z                              $gpu = Get-CimInstance Win32_VideoController -ErrorAction Stop | Select-Object -First 1
2026-01-11T19:28:13.7513690Z                      
2026-01-11T19:28:13.7513877Z                              if ($gpu.Name -like "*NVIDIA*") {
2026-01-11T19:28:13.7514144Z                                  Write-Log "Detected NVIDIA GPU: $($gpu.Name)" "INFO"
2026-01-11T19:28:13.7514263Z                                  return "nvidia"
2026-01-11T19:28:13.7514888Z                              } elseif ($gpu.Name -like "*AMD*" -or $gpu.Name -like "*Radeon*") {
2026-01-11T19:28:13.7515405Z                                  Write-Log "Detected AMD GPU: $($gpu.Name)" "INFO"
2026-01-11T19:28:13.7515802Z                                  return "amd"
2026-01-11T19:28:13.7516305Z                              } elseif ($gpu.Name -like "*Intel*") {
2026-01-11T19:28:13.7516727Z                                  Write-Log "Detected Intel GPU: $($gpu.Name)" "INFO"
2026-01-11T19:28:13.7517172Z                                  return "intel"
2026-01-11T19:28:13.7518373Z                              } else {
2026-01-11T19:28:13.7518623Z                                  Write-Log "Unknown GPU vendor: $($gpu.Name)" "INFO"
2026-01-11T19:28:13.7519273Z                                  return "unknown"
2026-01-11T19:28:13.7519382Z                              }
2026-01-11T19:28:13.7520223Z                          } catch {
2026-01-11T19:28:13.7521366Z                              Write-Log "Error detecting GPU vendor: $_" "ERROR"
2026-01-11T19:28:13.7521681Z                              return "unknown"
2026-01-11T19:28:13.7522621Z                          }
2026-01-11T19:28:13.7522811Z                      }
2026-01-11T19:28:13.7523830Z                      
2026-01-11T19:28:13.7524601Z                      
2026-01-11T19:28:13.7525136Z                      function Test-GPUOptimizations {
2026-01-11T19:28:13.7525647Z                          <#
2026-01-11T19:28:13.7526897Z                          .SYNOPSIS
2026-01-11T19:28:13.7527118Z                              Verifies GPU-related settings.
2026-01-11T19:28:13.7527493Z                          .DESCRIPTION
2026-01-11T19:28:13.7528904Z                              Reads HAGS (Hardware-accelerated GPU Scheduling) state from registry.
2026-01-11T19:28:13.7529177Z                          .OUTPUTS
2026-01-11T19:28:13.7529551Z                              [bool] True when verification runs without errors.
2026-01-11T19:28:13.7529895Z                          #>
2026-01-11T19:28:13.7530029Z                          $allPassed = $true
2026-01-11T19:28:13.7531111Z                      
2026-01-11T19:28:13.7531689Z                          Write-Log "Verifying GPU optimizations..." "INFO"
2026-01-11T19:28:13.7532100Z                      
2026-01-11T19:28:13.7533154Z                          $hagsPath = "HKLM:\SYSTEM\CurrentControlSet\Control\GraphicsDrivers"
2026-01-11T19:28:13.7533544Z                          $hagsValue = Get-RegistryValue -Path $hagsPath -Name "HwSchMode"
2026-01-11T19:28:13.7533999Z                          if ($hagsValue -eq 2) {
2026-01-11T19:28:13.7535304Z                              Write-Log "HAGS enabled (validate with benchmarks)" "INFO"
2026-01-11T19:28:13.7535422Z                          } else {
2026-01-11T19:28:13.7535632Z                              Write-Log "HAGS disabled (default)" "INFO"
2026-01-11T19:28:13.7536523Z                          }
2026-01-11T19:28:13.7536678Z                      
2026-01-11T19:28:13.7537993Z                          return $allPassed
2026-01-11T19:28:13.7538105Z                      }
2026-01-11T19:28:13.7538950Z                      
2026-01-11T19:28:13.7539130Z                      
2026-01-11T19:28:13.7539855Z                      
2026-01-11T19:28:13.7540684Z                      
2026-01-11T19:28:13.7541759Z                      function Set-HAGS {
2026-01-11T19:28:13.7541854Z                          <#
2026-01-11T19:28:13.7542961Z                          .SYNOPSIS
2026-01-11T19:28:13.7543824Z                              Enables or disables Hardware-accelerated GPU Scheduling.
2026-01-11T19:28:13.7543986Z                          .DESCRIPTION
2026-01-11T19:28:13.7545254Z                              Writes HwSchMode under GraphicsDrivers and logs the chosen state.
2026-01-11T19:28:13.7545393Z                          .PARAMETER Enable
2026-01-11T19:28:13.7546934Z                              When true, enables HAGS; when false, disables it.
2026-01-11T19:28:13.7547120Z                          .OUTPUTS
2026-01-11T19:28:13.7547214Z                              None.
2026-01-11T19:28:13.7548077Z                          #>
2026-01-11T19:28:13.7549175Z                          param(
2026-01-11T19:28:13.7549522Z                              [bool]$Enable = $false
2026-01-11T19:28:13.7550292Z                          )
2026-01-11T19:28:13.7550584Z                      
2026-01-11T19:28:13.7551759Z                          try {
2026-01-11T19:28:13.7552113Z                              $hagsPath = "HKLM:\SYSTEM\CurrentControlSet\Control\GraphicsDrivers"
2026-01-11T19:28:13.7552576Z                              Backup-RegistryKey -Path $hagsPath
2026-01-11T19:28:13.7552819Z                      
2026-01-11T19:28:13.7553451Z                              if ($Enable) {
2026-01-11T19:28:13.7554816Z                                  Set-RegistryValue -Path $hagsPath -Name "HwSchMode" -Value 2 -Type "DWORD"
2026-01-11T19:28:13.7555228Z                                  Write-Log "Hardware Accelerated GPU Scheduling ENABLED (opt-in)" "SUCCESS"
2026-01-11T19:28:13.7555660Z                                  Write-Log "IMPORTANT: Benchmark before/after to validate improvement" "INFO"
2026-01-11T19:28:13.7555775Z                              } else {
2026-01-11T19:28:13.7556486Z                                  Set-RegistryValue -Path $hagsPath -Name "HwSchMode" -Value 1 -Type "DWORD"
2026-01-11T19:28:13.7556872Z                                  Write-Log "Hardware Accelerated GPU Scheduling DISABLED (default)" "INFO"
2026-01-11T19:28:13.7557195Z                              }
2026-01-11T19:28:13.7558361Z                      
2026-01-11T19:28:13.7558536Z                          } catch {
2026-01-11T19:28:13.7559248Z                              Write-Log "Error configuring HAGS: $_" "ERROR"
2026-01-11T19:28:13.7560302Z                              throw
2026-01-11T19:28:13.7560407Z                          }
2026-01-11T19:28:13.7561516Z                      }
2026-01-11T19:28:13.7562304Z                      
2026-01-11T19:28:13.7563112Z                      
2026-01-11T19:28:13.7563630Z                      function Set-NVIDIAOptimizations {
2026-01-11T19:28:13.7564156Z                          <#
2026-01-11T19:28:13.7564916Z                          .SYNOPSIS
2026-01-11T19:28:13.7565839Z                              Applies NVIDIA-specific housekeeping.
2026-01-11T19:28:13.7566534Z                          .DESCRIPTION
2026-01-11T19:28:13.7567798Z                              Disables known NVIDIA telemetry and updater scheduled tasks. Logs
2026-01-11T19:28:13.7568094Z                              recommended control panel settings for manual review.
2026-01-11T19:28:13.7568718Z                          .OUTPUTS
2026-01-11T19:28:13.7570100Z                              None.
2026-01-11T19:28:13.7570661Z                          #>
2026-01-11T19:28:13.7571822Z                          try {
2026-01-11T19:28:13.7573022Z                              $nvidiaPath = "HKLM:\SYSTEM\CurrentControlSet\Services\nvlddmkm"
2026-01-11T19:28:13.7573186Z                      
2026-01-11T19:28:13.7573953Z                              if (-not (Test-Path $nvidiaPath)) {
2026-01-11T19:28:13.7575290Z                                  Write-Log "NVIDIA driver registry path not found. Ensure NVIDIA drivers are 
2026-01-11T19:28:13.7575436Z                      installed." "ERROR"
2026-01-11T19:28:13.7576279Z                                  return
2026-01-11T19:28:13.7577308Z                              }
2026-01-11T19:28:13.7577456Z                      
2026-01-11T19:28:13.7578699Z                              Write-Log "Applying NVIDIA optimizations..." "INFO"
2026-01-11T19:28:13.7578970Z                              Backup-RegistryKey -Path $nvidiaPath
2026-01-11T19:28:13.7579935Z                      
2026-01-11T19:28:13.7580763Z                              $nvidiaTasks = @(
2026-01-11T19:28:13.7582017Z                                  "NvTmRep_CrashReport1_{B2FE1952-0186-46C3-BAEC-A80AA35AC5B8}",
2026-01-11T19:28:13.7582381Z                                  "NvTmRep_CrashReport2_{B2FE1952-0186-46C3-BAEC-A80AA35AC5B8}",
2026-01-11T19:28:13.7582733Z                                  "NvTmRep_CrashReport3_{B2FE1952-0186-46C3-BAEC-A80AA35AC5B8}",
2026-01-11T19:28:13.7583801Z                                  "NvTmRep_CrashReport4_{B2FE1952-0186-46C3-BAEC-A80AA35AC5B8}",
2026-01-11T19:28:13.7584194Z                                  "NvDriverUpdateCheckDaily_{B2FE1952-0186-46C3-BAEC-A80AA35AC5B8}",
2026-01-11T19:28:13.7584816Z                                  "NVIDIA GeForce Experience SelfUpdate_{B2FE1952-0186-46C3-BAEC-A80AA35AC5B8}",
2026-01-11T19:28:13.7585245Z                                  "NvTmMon_{B2FE1952-0186-46C3-BAEC-A80AA35AC5B8}"
2026-01-11T19:28:13.7585653Z                              )
2026-01-11T19:28:13.7586494Z                      
2026-01-11T19:28:13.7587304Z                              $disabled = 0
2026-01-11T19:28:13.7588104Z                              foreach ($task in $nvidiaTasks) {
2026-01-11T19:28:13.7588564Z                                  try {
2026-01-11T19:28:13.7589852Z                                      schtasks /Change /TN $task /DISABLE 2>&1 | Out-Null
2026-01-11T19:28:13.7590207Z                                      if ($LASTEXITCODE -eq 0) {
2026-01-11T19:28:13.7590879Z                                          $disabled++
2026-01-11T19:28:13.7591109Z                                      }
2026-01-11T19:28:13.7592160Z                                  } catch {
2026-01-11T19:28:13.7592266Z                                  }
2026-01-11T19:28:13.7593317Z                              }
2026-01-11T19:28:13.7593490Z                      
2026-01-11T19:28:13.7594394Z                              if ($disabled -gt 0) {
2026-01-11T19:28:13.7595382Z                                  Write-Log "Disabled $disabled NVIDIA telemetry tasks" "SUCCESS"
2026-01-11T19:28:13.7595744Z                              }
2026-01-11T19:28:13.7596720Z                      
2026-01-11T19:28:13.7597298Z                              Write-Log "NVIDIA optimizations complete" "SUCCESS"
2026-01-11T19:28:13.7598457Z                              Write-Log "RECOMMENDED: Configure NVIDIA Control Panel manually:" "INFO"
2026-01-11T19:28:13.7598855Z                              Write-Log "  - Power management mode: Prefer maximum performance" "INFO"
2026-01-11T19:28:13.7599207Z                              Write-Log "  - Vertical sync: Off (or Fast for G-Sync)" "INFO"
2026-01-11T19:28:13.7600105Z                              Write-Log "  - Low latency mode: Ultra" "INFO"
2026-01-11T19:28:13.7600758Z                              Write-Log "  - Texture filtering - Quality: High performance" "INFO"
2026-01-11T19:28:13.7601054Z                      
2026-01-11T19:28:13.7601967Z                          } catch {
2026-01-11T19:28:13.7602349Z                              Write-Log "Error applying NVIDIA optimizations: $_" "ERROR"
2026-01-11T19:28:13.7603277Z                              throw
2026-01-11T19:28:13.7603483Z                          }
2026-01-11T19:28:13.7604588Z                      }
2026-01-11T19:28:13.7605419Z                      
2026-01-11T19:28:13.7606085Z                      
2026-01-11T19:28:13.7607167Z                      function Set-AMDOptimizations {
2026-01-11T19:28:13.7607645Z                          <#
2026-01-11T19:28:13.7608077Z                          .SYNOPSIS
2026-01-11T19:28:13.7608781Z                              Applies AMD-specific housekeeping.
2026-01-11T19:28:13.7609620Z                          .DESCRIPTION
2026-01-11T19:28:13.7610735Z                              Performs minimal registry backup and prints recommended Radeon settings.
2026-01-11T19:28:13.7611721Z                          .OUTPUTS
2026-01-11T19:28:13.7611849Z                              None.
2026-01-11T19:28:13.7612828Z                          #>
2026-01-11T19:28:13.7612944Z                          try {
2026-01-11T19:28:13.7614114Z                              Write-Log "Applying AMD optimizations..." "INFO"
2026-01-11T19:28:13.7614838Z                      
2026-01-11T19:28:13.7615759Z                              $amdPath = 
2026-01-11T19:28:13.7617169Z                      "HKLM:\SYSTEM\CurrentControlSet\Control\Class\{4d36e968-e325-11ce-bfc1-08002be10318}\0000"
2026-01-11T19:28:13.7617343Z                              if (Test-Path $amdPath) {
2026-01-11T19:28:13.7617523Z                                  Backup-RegistryKey -Path $amdPath
2026-01-11T19:28:13.7618050Z                              }
2026-01-11T19:28:13.7619046Z                      
2026-01-11T19:28:13.7619954Z                              Write-Log "AMD optimizations complete" "SUCCESS"
2026-01-11T19:28:13.7620610Z                              Write-Log "RECOMMENDED: Configure AMD Radeon Software manually:" "INFO"
2026-01-11T19:28:13.7621542Z                              Write-Log "  - Radeon Anti-Lag: On" "INFO"
2026-01-11T19:28:13.7622116Z                              Write-Log "  - Radeon Boost: On (if supported)" "INFO"
2026-01-11T19:28:13.7623611Z                              Write-Log "  - Radeon Image Sharpening: 80% (if desired)" "INFO"
2026-01-11T19:28:13.7623896Z                              Write-Log "  - Wait for Vertical Refresh: Off" "INFO"
2026-01-11T19:28:13.7624266Z                              Write-Log "  - Texture Filtering Quality: Performance" "INFO"
2026-01-11T19:28:13.7624547Z                      
2026-01-11T19:28:13.7626038Z                          } catch {
2026-01-11T19:28:13.7626407Z                              Write-Log "Error applying AMD optimizations: $_" "ERROR"
2026-01-11T19:28:13.7626670Z                              throw
2026-01-11T19:28:13.7627976Z                          }
2026-01-11T19:28:13.7628846Z                      }
2026-01-11T19:28:13.7629187Z                      
2026-01-11T19:28:13.7630302Z                      
2026-01-11T19:28:13.7630587Z                      function Set-IntelOptimizations {
2026-01-11T19:28:13.7631937Z                          <#
2026-01-11T19:28:13.7632852Z                          .SYNOPSIS
2026-01-11T19:28:13.7633413Z                              Applies Intel-specific housekeeping.
2026-01-11T19:28:13.7633901Z                          .DESCRIPTION
2026-01-11T19:28:13.7634828Z                              Logs recommended Intel graphics settings for manual review.
2026-01-11T19:28:13.7635638Z                          .OUTPUTS
2026-01-11T19:28:13.7636467Z                              None.
2026-01-11T19:28:13.7636916Z                          #>
2026-01-11T19:28:13.7637550Z                          try {
2026-01-11T19:28:13.7638961Z                              Write-Log "Applying Intel GPU optimizations..." "INFO"
2026-01-11T19:28:13.7639068Z                      
2026-01-11T19:28:13.7639512Z                              Write-Log "Intel GPU optimizations complete" "SUCCESS"
2026-01-11T19:28:13.7640565Z                              Write-Log "RECOMMENDED: Configure Intel Graphics Command Center manually:" "INFO"
2026-01-11T19:28:13.7641304Z                              Write-Log "  - Use Intel Graphics Command Center for performance profiles" "INFO"
2026-01-11T19:28:13.7641570Z                              Write-Log "  - Enable Gaming mode if available" "INFO"
2026-01-11T19:28:13.7642421Z                      
2026-01-11T19:28:13.7642627Z                          } catch {
2026-01-11T19:28:13.7643577Z                              Write-Log "Error applying Intel optimizations: $_" "ERROR"
2026-01-11T19:28:13.7643874Z                              throw
2026-01-11T19:28:13.7644728Z                          }
2026-01-11T19:28:13.7645704Z                      }
2026-01-11T19:28:13.7646529Z                      
2026-01-11T19:28:13.7646711Z                      
2026-01-11T19:28:13.7647872Z                      function Disable-AmdUlps {
2026-01-11T19:28:13.7647981Z                          <#
2026-01-11T19:28:13.7649097Z                          .SYNOPSIS
2026-01-11T19:28:13.7650436Z                              Disables AMD Ultra Low Power State (ULPS).
2026-01-11T19:28:13.7650569Z                          .DESCRIPTION
2026-01-11T19:28:13.7650912Z                              FR33THY optimization - ULPS causes AMD GPUs to downclock aggressively,
2026-01-11T19:28:13.7651401Z                              which can introduce micro-stutters during power state transitions.
2026-01-11T19:28:13.7652204Z                              Disabling keeps GPU ready for immediate performance.
2026-01-11T19:28:13.7653261Z                          .PARAMETER Enable
2026-01-11T19:28:13.7653962Z                              When true, disables ULPS (counterintuitive but matches pattern).
2026-01-11T19:28:13.7654341Z                          .OUTPUTS
2026-01-11T19:28:13.7654605Z                              None.
2026-01-11T19:28:13.7655803Z                          .NOTES
2026-01-11T19:28:13.7656837Z                              Only affects AMD Radeon GPUs. Safe but increases idle power draw slightly.
2026-01-11T19:28:13.7656970Z                          #>
2026-01-11T19:28:13.7657889Z                          param(
2026-01-11T19:28:13.7658280Z                              [bool]$Enable = $true
2026-01-11T19:28:13.7659437Z                          )
2026-01-11T19:28:13.7659551Z                      
2026-01-11T19:28:13.7660125Z                          if (-not $Enable) {
2026-01-11T19:28:13.7661365Z                              Write-Log "AMD ULPS disable: skipped" "INFO"
2026-01-11T19:28:13.7661784Z                              return
2026-01-11T19:28:13.7662129Z                          }
2026-01-11T19:28:13.7663324Z                      
2026-01-11T19:28:13.7663772Z                          try {
2026-01-11T19:28:13.7664875Z                              $gpuClassPath = 
2026-01-11T19:28:13.7665613Z                      "HKLM:\SYSTEM\CurrentControlSet\Control\Class\{4d36e968-e325-11ce-bfc1-08002be10318}"
2026-01-11T19:28:13.7665757Z                              $foundAmd = $false
2026-01-11T19:28:13.7666335Z                      
2026-01-11T19:28:13.7668071Z                              if (-not (Test-Path $gpuClassPath)) {
2026-01-11T19:28:13.7668333Z                                  Write-Log "GPU class registry path not found" "INFO"
2026-01-11T19:28:13.7668442Z                                  return
2026-01-11T19:28:13.7668892Z                              }
2026-01-11T19:28:13.7669941Z                      
2026-01-11T19:28:13.7670368Z                              Get-ChildItem $gpuClassPath -ErrorAction SilentlyContinue | ForEach-Object {
2026-01-11T19:28:13.7670544Z                                  try {
2026-01-11T19:28:13.7672168Z                                      $driverDesc = Get-ItemPropertyValue $_.PSPath "DriverDesc" -ErrorAction 
2026-01-11T19:28:13.7672711Z                      SilentlyContinue
2026-01-11T19:28:13.7672945Z                                      if ($driverDesc -match "AMD|Radeon") {
2026-01-11T19:28:13.7673356Z                                          $foundAmd = $true
2026-01-11T19:28:13.7674696Z                                          Backup-RegistryKey -Path $_.PSPath
2026-01-11T19:28:13.7674854Z                      
2026-01-11T19:28:13.7675504Z                                          # FR33THY: EnableUlps=0 prevents aggressive downclocking
2026-01-11T19:28:13.7676014Z                                          Set-RegistryValue -Path $_.PSPath -Name "EnableUlps" -Value 0 -Type "DWORD"
2026-01-11T19:28:13.7677052Z                                          Set-RegistryValue -Path $_.PSPath -Name "EnableUlps_NA" -Value 0 -Type "DWORD"
2026-01-11T19:28:13.7677169Z                      
2026-01-11T19:28:13.7678157Z                                          Write-Log "AMD ULPS disabled for: $driverDesc" "SUCCESS"
2026-01-11T19:28:13.7678496Z                                      }
2026-01-11T19:28:13.7679340Z                                  } catch {
2026-01-11T19:28:13.7680234Z                                      # Silently skip entries without DriverDesc
2026-01-11T19:28:13.7680545Z                                  }
2026-01-11T19:28:13.7681502Z                              }
2026-01-11T19:28:13.7681673Z                      
2026-01-11T19:28:13.7682153Z                              if (-not $foundAmd) {
2026-01-11T19:28:13.7683532Z                                  Write-Log "No AMD GPU found, ULPS disable skipped" "INFO"
2026-01-11T19:28:13.7683655Z                              }
2026-01-11T19:28:13.7684735Z                      
2026-01-11T19:28:13.7685179Z                          } catch {
2026-01-11T19:28:13.7686011Z                              Write-Log "Error disabling AMD ULPS: $_" "ERROR"
2026-01-11T19:28:13.7686603Z                          }
2026-01-11T19:28:13.7687638Z                      }
2026-01-11T19:28:13.7687765Z                      
2026-01-11T19:28:13.7688785Z                      
2026-01-11T19:28:13.7689090Z                      function Set-NvidiaP0State {
2026-01-11T19:28:13.7689990Z                          <#
2026-01-11T19:28:13.7690512Z                          .SYNOPSIS
2026-01-11T19:28:13.7691328Z                              Forces NVIDIA GPU to stay in maximum performance state (P0).
2026-01-11T19:28:13.7691986Z                          .DESCRIPTION
2026-01-11T19:28:13.7692837Z                              FR33THY optimization - Disables dynamic P-state switching which
2026-01-11T19:28:13.7693199Z                              causes the GPU to constantly adjust clocks. Forces constant max clocks
2026-01-11T19:28:13.7693542Z                              for consistent frame times. WARNING: Increases heat and power usage.
2026-01-11T19:28:13.7693976Z                          .PARAMETER Enable
2026-01-11T19:28:13.7694674Z                              When true, forces P0 state.
2026-01-11T19:28:13.7695183Z                          .OUTPUTS
2026-01-11T19:28:13.7696319Z                              None.
2026-01-11T19:28:13.7696518Z                          .NOTES
2026-01-11T19:28:13.7697128Z                              RISKY: Significantly increases GPU temperature and power consumption.
2026-01-11T19:28:13.7697644Z                              Recommended only for competitive gaming sessions, not 24/7 use.
2026-01-11T19:28:13.7697871Z                          #>
2026-01-11T19:28:13.7698469Z                          param(
2026-01-11T19:28:13.7699234Z                              [bool]$Enable = $true
2026-01-11T19:28:13.7699788Z                          )
2026-01-11T19:28:13.7700060Z                      
2026-01-11T19:28:13.7700696Z                          if (-not $Enable) {
2026-01-11T19:28:13.7701108Z                              Write-Log "NVIDIA P0 state: skipped" "INFO"
2026-01-11T19:28:13.7701434Z                              return
2026-01-11T19:28:13.7701979Z                          }
2026-01-11T19:28:13.7702275Z                      
2026-01-11T19:28:13.7703073Z                          try {
2026-01-11T19:28:13.7703238Z                              $gpuClassPath = 
2026-01-11T19:28:13.7704483Z                      "HKLM:\SYSTEM\CurrentControlSet\Control\Class\{4d36e968-e325-11ce-bfc1-08002be10318}"
2026-01-11T19:28:13.7704667Z                              $foundNvidia = $false
2026-01-11T19:28:13.7704765Z                      
2026-01-11T19:28:13.7705084Z                              if (-not (Test-Path $gpuClassPath)) {
2026-01-11T19:28:13.7705593Z                                  Write-Log "GPU class registry path not found" "INFO"
2026-01-11T19:28:13.7706375Z                                  return
2026-01-11T19:28:13.7706716Z                              }
2026-01-11T19:28:13.7707458Z                      
2026-01-11T19:28:13.7708235Z                              Get-ChildItem $gpuClassPath -ErrorAction SilentlyContinue | ForEach-Object {
2026-01-11T19:28:13.7708516Z                                  try {
2026-01-11T19:28:13.7710444Z                                      $driverDesc = Get-ItemPropertyValue $_.PSPath "DriverDesc" -ErrorAction 
2026-01-11T19:28:13.7710610Z                      SilentlyContinue
2026-01-11T19:28:13.7710844Z                                      if ($driverDesc -match "NVIDIA|GeForce") {
2026-01-11T19:28:13.7711176Z                                          $foundNvidia = $true
2026-01-11T19:28:13.7711783Z                                          Backup-RegistryKey -Path $_.PSPath
2026-01-11T19:28:13.7712118Z                      
2026-01-11T19:28:13.7712934Z                                          # FR33THY: DisableDynamicPstate=1 forces constant max clocks
2026-01-11T19:28:13.7714627Z                                          Set-RegistryValue -Path $_.PSPath -Name "DisableDynamicPstate" -Value 1 -Type 
2026-01-11T19:28:13.7715421Z                      "DWORD"
2026-01-11T19:28:13.7715510Z                      
2026-01-11T19:28:13.7716443Z                                          Write-Log "NVIDIA P0 state forced for: $driverDesc" "SUCCESS"
2026-01-11T19:28:13.7717153Z                                          Write-Log "WARNING: GPU will run at constant max clocks (increased 
2026-01-11T19:28:13.7717311Z                      heat/power)" "WARNING"
2026-01-11T19:28:13.7718279Z                                      }
2026-01-11T19:28:13.7718499Z                                  } catch {
2026-01-11T19:28:13.7719835Z                                      # Silently skip entries without DriverDesc
2026-01-11T19:28:13.7720191Z                                  }
2026-01-11T19:28:13.7721199Z                              }
2026-01-11T19:28:13.7721683Z                      
2026-01-11T19:28:13.7722831Z                              if (-not $foundNvidia) {
2026-01-11T19:28:13.7723484Z                                  Write-Log "No NVIDIA GPU found, P0 state skip" "INFO"
2026-01-11T19:28:13.7723659Z                              }
2026-01-11T19:28:13.7724762Z                      
2026-01-11T19:28:13.7724879Z                          } catch {
2026-01-11T19:28:13.7726060Z                              Write-Log "Error setting NVIDIA P0 state: $_" "ERROR"
2026-01-11T19:28:13.7726177Z                          }
2026-01-11T19:28:13.7726963Z                      }
2026-01-11T19:28:13.7727141Z                      
2026-01-11T19:28:13.7728267Z                      
2026-01-11T19:28:13.7728816Z                      function Invoke-GPUOptimizations {
2026-01-11T19:28:13.7729549Z                          <#
2026-01-11T19:28:13.7730535Z                          .SYNOPSIS
2026-01-11T19:28:13.7731481Z                              Runs GPU optimizations based on detected vendor.
2026-01-11T19:28:13.7731926Z                          .DESCRIPTION
2026-01-11T19:28:13.7733255Z                              Applies HAGS preference, detects GPU vendor, and executes the matching
2026-01-11T19:28:13.7733444Z                              vendor-specific helper.
2026-01-11T19:28:13.7734603Z                          .PARAMETER EnableHAGS
2026-01-11T19:28:13.7734840Z                              Enables HAGS when true.
2026-01-11T19:28:13.7735130Z                          .OUTPUTS
2026-01-11T19:28:13.7736293Z                              None.
2026-01-11T19:28:13.7736609Z                          #>
2026-01-11T19:28:13.7737452Z                          param(
2026-01-11T19:28:13.7737959Z                              [bool]$EnableHAGS = $false
2026-01-11T19:28:13.7738854Z                          )
2026-01-11T19:28:13.7738962Z                      
2026-01-11T19:28:13.7740321Z                          Write-Log "Applying GPU optimizations..." "INFO"
2026-01-11T19:28:13.7740439Z                      
2026-01-11T19:28:13.7740834Z                          try {
2026-01-11T19:28:13.7741772Z                              Set-HAGS -Enable $EnableHAGS
2026-01-11T19:28:13.7742163Z                      
2026-01-11T19:28:13.7743022Z                              $vendor = Test-GPUVendor
2026-01-11T19:28:13.7743666Z                      
2026-01-11T19:28:13.7744569Z                              switch ($vendor) {
2026-01-11T19:28:13.7744982Z                                  "nvidia" {
2026-01-11T19:28:13.7745856Z                                      Set-NVIDIAOptimizations
2026-01-11T19:28:13.7746241Z                                  }
2026-01-11T19:28:13.7747229Z                                  "amd" {
2026-01-11T19:28:13.7747760Z                                      Set-AMDOptimizations
2026-01-11T19:28:13.7748161Z                                  }
2026-01-11T19:28:13.7749125Z                                  "intel" {
2026-01-11T19:28:13.7749614Z                                      Set-IntelOptimizations
2026-01-11T19:28:13.7750673Z                                  }
2026-01-11T19:28:13.7751066Z                                  default {
2026-01-11T19:28:13.7751928Z                                      Write-Log "Unknown GPU vendor, skipping vendor-specific optimizations" "INFO"
2026-01-11T19:28:13.7752827Z                                  }
2026-01-11T19:28:13.7753270Z                              }
2026-01-11T19:28:13.7754043Z                      
2026-01-11T19:28:13.7754990Z                              Write-Log "GPU optimizations complete" "SUCCESS"
2026-01-11T19:28:13.7755663Z                      
2026-01-11T19:28:13.7756648Z                          } catch {
2026-01-11T19:28:13.7757434Z                              Write-Log "Error applying GPU optimizations: $_" "ERROR"
2026-01-11T19:28:13.7758440Z                              throw
2026-01-11T19:28:13.7758563Z                          }
2026-01-11T19:28:13.7759483Z                      }
2026-01-11T19:28:13.7759910Z                      
2026-01-11T19:28:13.7761021Z                      
2026-01-11T19:28:13.7761905Z                      function Undo-GPUOptimizations {
2026-01-11T19:28:13.7762370Z                          <#
2026-01-11T19:28:13.7763081Z                          .SYNOPSIS
2026-01-11T19:28:13.7764173Z                              Reverts GPU-related settings and tasks.
2026-01-11T19:28:13.7764567Z                          .DESCRIPTION
2026-01-11T19:28:13.7765242Z                              Disables HAGS, re-enables NVIDIA scheduled tasks, and restores backed
2026-01-11T19:28:13.7766142Z                              up registry values when present.
2026-01-11T19:28:13.7766280Z                          .OUTPUTS
2026-01-11T19:28:13.7767287Z                              None.
2026-01-11T19:28:13.7768259Z                          #>
2026-01-11T19:28:13.7769877Z                          Write-Log "Rolling back GPU optimizations..." "INFO"
2026-01-11T19:28:13.7769998Z                      
2026-01-11T19:28:13.7770098Z                          try {
2026-01-11T19:28:13.7770913Z                              Set-HAGS -Enable $false
2026-01-11T19:28:13.7771022Z                      
2026-01-11T19:28:13.7771978Z                              $nvidiaTasks = @(
2026-01-11T19:28:13.7772927Z                                  "NvTmRep_CrashReport1_{B2FE1952-0186-46C3-BAEC-A80AA35AC5B8}",
2026-01-11T19:28:13.7773516Z                                  "NvTmRep_CrashReport2_{B2FE1952-0186-46C3-BAEC-A80AA35AC5B8}",
2026-01-11T19:28:13.7774906Z                                  "NvTmRep_CrashReport3_{B2FE1952-0186-46C3-BAEC-A80AA35AC5B8}",
2026-01-11T19:28:13.7775233Z                                  "NvTmRep_CrashReport4_{B2FE1952-0186-46C3-BAEC-A80AA35AC5B8}",
2026-01-11T19:28:13.7775606Z                                  "NvDriverUpdateCheckDaily_{B2FE1952-0186-46C3-BAEC-A80AA35AC5B8}",
2026-01-11T19:28:13.7776567Z                                  "NVIDIA GeForce Experience SelfUpdate_{B2FE1952-0186-46C3-BAEC-A80AA35AC5B8}",
2026-01-11T19:28:13.7777862Z                                  "NvTmMon_{B2FE1952-0186-46C3-BAEC-A80AA35AC5B8}"
2026-01-11T19:28:13.7778018Z                              )
2026-01-11T19:28:13.7778115Z                      
2026-01-11T19:28:13.7778713Z                              foreach ($task in $nvidiaTasks) {
2026-01-11T19:28:13.7779315Z                                  schtasks /Change /TN $task /ENABLE 2>&1 | Out-Null
2026-01-11T19:28:13.7779995Z                              }
2026-01-11T19:28:13.7780153Z                      
2026-01-11T19:28:13.7780686Z                              $paths = @(
2026-01-11T19:28:13.7781590Z                                  "HKLM:\SYSTEM\CurrentControlSet\Control\GraphicsDrivers",
2026-01-11T19:28:13.7782018Z                                  "HKLM:\SYSTEM\CurrentControlSet\Services\nvlddmkm",
2026-01-11T19:28:13.7782573Z                                  
2026-01-11T19:28:13.7783618Z                      "HKLM:\SYSTEM\CurrentControlSet\Control\Class\{4d36e968-e325-11ce-bfc1-08002be10318}\0000"
2026-01-11T19:28:13.7783900Z                              )
2026-01-11T19:28:13.7784554Z                      
2026-01-11T19:28:13.7785570Z                              foreach ($path in $paths) {
2026-01-11T19:28:13.7786476Z                                  if (Restore-RegistryKey -Path $path) {
2026-01-11T19:28:13.7786878Z                                      Write-Log "Restored registry: $path" "SUCCESS"
2026-01-11T19:28:13.7787116Z                                  }
2026-01-11T19:28:13.7787615Z                              }
2026-01-11T19:28:13.7788570Z                      
2026-01-11T19:28:13.7789468Z                              Write-Log "GPU optimization rollback complete" "SUCCESS"
2026-01-11T19:28:13.7789956Z                      
2026-01-11T19:28:13.7790891Z                          } catch {
2026-01-11T19:28:13.7791597Z                              Write-Log "Error during rollback: $_" "ERROR"
2026-01-11T19:28:13.7792222Z                              throw
2026-01-11T19:28:13.7792823Z                          }
2026-01-11T19:28:13.7793447Z                      }
2026-01-11T19:28:13.7794073Z                      
2026-01-11T19:28:13.7794695Z                      
2026-01-11T19:28:13.7795389Z                      Export-ModuleMember -Function @(
2026-01-11T19:28:13.7795972Z                          'Test-GPUVendor',
2026-01-11T19:28:13.7796663Z                          'Set-HAGS',
2026-01-11T19:28:13.7797395Z                          'Set-NVIDIAOptimizations',
2026-01-11T19:28:13.7798076Z                          'Set-AMDOptimizations',
2026-01-11T19:28:13.7798747Z                          'Set-IntelOptimizations',
2026-01-11T19:28:13.7799389Z                          'Disable-AmdUlps',
2026-01-11T19:28:13.7800075Z                          'Set-NvidiaP0State',
2026-01-11T19:28:13.7800746Z                          'Test-GPUOptimizations',
2026-01-11T19:28:13.7801459Z                          'Invoke-GPUOptimizations',
2026-01-11T19:28:13.7801977Z                          'Undo-GPUOptimizations'
2026-01-11T19:28:13.7802974Z                      )
2026-01-11T19:28:13.7803857Z [32;1mCleanBlock         : [0m
2026-01-11T19:28:13.7804116Z [32;1mDynamicParamBlock  : [0m
2026-01-11T19:28:13.7805724Z [32;1mScriptRequirements : [0mSystem.Management.Automation.Language.ScriptRequirements
2026-01-11T19:28:13.7807451Z [32;1mExtent             : [0m<#
2026-01-11T19:28:13.7807614Z                      .SYNOPSIS
2026-01-11T19:28:13.7808882Z                          GPU optimization helpers with vendor-specific tuning notes.
2026-01-11T19:28:13.7809009Z                      .DESCRIPTION
2026-01-11T19:28:13.7810209Z                          Applies optional HAGS settings and performs vendor-specific housekeeping,
2026-01-11T19:28:13.7810897Z                          primarily focused on reducing background telemetry tasks.
2026-01-11T19:28:13.7811275Z                      .NOTES
2026-01-11T19:28:13.7811763Z                          Requires Administrator. Vendor control panel settings are suggested but not
2026-01-11T19:28:13.7812253Z                          changed by this module.
2026-01-11T19:28:13.7812731Z                      #>
2026-01-11T19:28:13.7813367Z                      #Requires -RunAsAdministrator
2026-01-11T19:28:13.7813642Z                      
2026-01-11T19:28:13.7814883Z                      
2026-01-11T19:28:13.7815115Z                      
2026-01-11T19:28:13.7816207Z                      Import-Module (Join-Path $PSScriptRoot "..\core\logger.psm1") -Force -Global
2026-01-11T19:28:13.7816630Z                      Import-Module (Join-Path $PSScriptRoot "..\core\registry.psm1") -Force -Global
2026-01-11T19:28:13.7817371Z                      
2026-01-11T19:28:13.7818138Z                      
2026-01-11T19:28:13.7818323Z                      
2026-01-11T19:28:13.7819044Z                      function Test-GPUVendor {
2026-01-11T19:28:13.7819337Z                          <#
2026-01-11T19:28:13.7819822Z                          .SYNOPSIS
2026-01-11T19:28:13.7821047Z                              Detects the primary GPU vendor.
2026-01-11T19:28:13.7821531Z                          .DESCRIPTION
2026-01-11T19:28:13.7823089Z                              Reads Win32_VideoController and maps the first adapter to nvidia/amd/intel.
2026-01-11T19:28:13.7823216Z                          .OUTPUTS
2026-01-11T19:28:13.7823425Z                              [string] One of: nvidia, amd, intel, unknown.
2026-01-11T19:28:13.7823950Z                          #>
2026-01-11T19:28:13.7824482Z                          try {
2026-01-11T19:28:13.7825959Z                              $gpu = Get-CimInstance Win32_VideoController -ErrorAction Stop | Select-Object -First 1
2026-01-11T19:28:13.7826060Z                      
2026-01-11T19:28:13.7826828Z                              if ($gpu.Name -like "*NVIDIA*") {
2026-01-11T19:28:13.7827912Z                                  Write-Log "Detected NVIDIA GPU: $($gpu.Name)" "INFO"
2026-01-11T19:28:13.7828079Z                                  return "nvidia"
2026-01-11T19:28:13.7828944Z                              } elseif ($gpu.Name -like "*AMD*" -or $gpu.Name -like "*Radeon*") {
2026-01-11T19:28:13.7829389Z                                  Write-Log "Detected AMD GPU: $($gpu.Name)" "INFO"
2026-01-11T19:28:13.7829876Z                                  return "amd"
2026-01-11T19:28:13.7831414Z                              } elseif ($gpu.Name -like "*Intel*") {
2026-01-11T19:28:13.7831741Z                                  Write-Log "Detected Intel GPU: $($gpu.Name)" "INFO"
2026-01-11T19:28:13.7832052Z                                  return "intel"
2026-01-11T19:28:13.7833116Z                              } else {
2026-01-11T19:28:13.7833936Z                                  Write-Log "Unknown GPU vendor: $($gpu.Name)" "INFO"
2026-01-11T19:28:13.7834243Z                                  return "unknown"
2026-01-11T19:28:13.7835132Z                              }
2026-01-11T19:28:13.7835298Z                          } catch {
2026-01-11T19:28:13.7835687Z                              Write-Log "Error detecting GPU vendor: $_" "ERROR"
2026-01-11T19:28:13.7835962Z                              return "unknown"
2026-01-11T19:28:13.7836666Z                          }
2026-01-11T19:28:13.7837440Z                      }
2026-01-11T19:28:13.7838101Z                      
2026-01-11T19:28:13.7838375Z                      
2026-01-11T19:28:13.7838769Z                      function Test-GPUOptimizations {
2026-01-11T19:28:13.7839465Z                          <#
2026-01-11T19:28:13.7839581Z                          .SYNOPSIS
2026-01-11T19:28:13.7840032Z                              Verifies GPU-related settings.
2026-01-11T19:28:13.7840712Z                          .DESCRIPTION
2026-01-11T19:28:13.7841525Z                              Reads HAGS (Hardware-accelerated GPU Scheduling) state from registry.
2026-01-11T19:28:13.7842163Z                          .OUTPUTS
2026-01-11T19:28:13.7842617Z                              [bool] True when verification runs without errors.
2026-01-11T19:28:13.7843052Z                          #>
2026-01-11T19:28:13.7843713Z                          $allPassed = $true
2026-01-11T19:28:13.7844249Z                      
2026-01-11T19:28:13.7845023Z                          Write-Log "Verifying GPU optimizations..." "INFO"
2026-01-11T19:28:13.7845371Z                      
2026-01-11T19:28:13.7847187Z                          $hagsPath = "HKLM:\SYSTEM\CurrentControlSet\Control\GraphicsDrivers"
2026-01-11T19:28:13.7847517Z                          $hagsValue = Get-RegistryValue -Path $hagsPath -Name "HwSchMode"
2026-01-11T19:28:13.7847661Z                          if ($hagsValue -eq 2) {
2026-01-11T19:28:13.7848669Z                              Write-Log "HAGS enabled (validate with benchmarks)" "INFO"
2026-01-11T19:28:13.7849047Z                          } else {
2026-01-11T19:28:13.7849527Z                              Write-Log "HAGS disabled (default)" "INFO"
2026-01-11T19:28:13.7850285Z                          }
2026-01-11T19:28:13.7850854Z                      
2026-01-11T19:28:13.7851652Z                          return $allPassed
2026-01-11T19:28:13.7852256Z                      }
2026-01-11T19:28:13.7853010Z                      
2026-01-11T19:28:13.7853601Z                      
2026-01-11T19:28:13.7854158Z                      
2026-01-11T19:28:13.7854811Z                      
2026-01-11T19:28:13.7855586Z                      function Set-HAGS {
2026-01-11T19:28:13.7856354Z                          <#
2026-01-11T19:28:13.7856936Z                          .SYNOPSIS
2026-01-11T19:28:13.7857861Z                              Enables or disables Hardware-accelerated GPU Scheduling.
2026-01-11T19:28:13.7858214Z                          .DESCRIPTION
2026-01-11T19:28:13.7859185Z                              Writes HwSchMode under GraphicsDrivers and logs the chosen state.
2026-01-11T19:28:13.7859630Z                          .PARAMETER Enable
2026-01-11T19:28:13.7860535Z                              When true, enables HAGS; when false, disables it.
2026-01-11T19:28:13.7861129Z                          .OUTPUTS
2026-01-11T19:28:13.7861944Z                              None.
2026-01-11T19:28:13.7862726Z                          #>
2026-01-11T19:28:13.7863610Z                          param(
2026-01-11T19:28:13.7864524Z                              [bool]$Enable = $false
2026-01-11T19:28:13.7865624Z                          )
2026-01-11T19:28:13.7867390Z                      
2026-01-11T19:28:13.7868206Z                          try {
2026-01-11T19:28:13.7869250Z                              $hagsPath = "HKLM:\SYSTEM\CurrentControlSet\Control\GraphicsDrivers"
2026-01-11T19:28:13.7869985Z                              Backup-RegistryKey -Path $hagsPath
2026-01-11T19:28:13.7870366Z                      
2026-01-11T19:28:13.7871153Z                              if ($Enable) {
2026-01-11T19:28:13.7872498Z                                  Set-RegistryValue -Path $hagsPath -Name "HwSchMode" -Value 2 -Type "DWORD"
2026-01-11T19:28:13.7872977Z                                  Write-Log "Hardware Accelerated GPU Scheduling ENABLED (opt-in)" "SUCCESS"
2026-01-11T19:28:13.7873442Z                                  Write-Log "IMPORTANT: Benchmark before/after to validate improvement" "INFO"
2026-01-11T19:28:13.7873702Z                              } else {
2026-01-11T19:28:13.7874985Z                                  Set-RegistryValue -Path $hagsPath -Name "HwSchMode" -Value 1 -Type "DWORD"
2026-01-11T19:28:13.7875893Z                                  Write-Log "Hardware Accelerated GPU Scheduling DISABLED (default)" "INFO"
2026-01-11T19:28:13.7876600Z                              }
2026-01-11T19:28:13.7877437Z                      
2026-01-11T19:28:13.7878319Z                          } catch {
2026-01-11T19:28:13.7879473Z                              Write-Log "Error configuring HAGS: $_" "ERROR"
2026-01-11T19:28:13.7880067Z                              throw
2026-01-11T19:28:13.7880878Z                          }
2026-01-11T19:28:13.7881549Z                      }
2026-01-11T19:28:13.7882143Z                      
2026-01-11T19:28:13.7882834Z                      
2026-01-11T19:28:13.7883565Z                      function Set-NVIDIAOptimizations {
2026-01-11T19:28:13.7884384Z                          <#
2026-01-11T19:28:13.7885045Z                          .SYNOPSIS
2026-01-11T19:28:13.7885943Z                              Applies NVIDIA-specific housekeeping.
2026-01-11T19:28:13.7886537Z                          .DESCRIPTION
2026-01-11T19:28:13.7887400Z                              Disables known NVIDIA telemetry and updater scheduled tasks. Logs
2026-01-11T19:28:13.7888202Z                              recommended control panel settings for manual review.
2026-01-11T19:28:13.7888856Z                          .OUTPUTS
2026-01-11T19:28:13.7889647Z                              None.
2026-01-11T19:28:13.7890354Z                          #>
2026-01-11T19:28:13.7891244Z                          try {
2026-01-11T19:28:13.7892246Z                              $nvidiaPath = "HKLM:\SYSTEM\CurrentControlSet\Services\nvlddmkm"
2026-01-11T19:28:13.7892855Z                      
2026-01-11T19:28:13.7893649Z                              if (-not (Test-Path $nvidiaPath)) {
2026-01-11T19:28:13.7894802Z                                  Write-Log "NVIDIA driver registry path not found. Ensure NVIDIA drivers are 
2026-01-11T19:28:13.7895136Z                      installed." "ERROR"
2026-01-11T19:28:13.7895833Z                                  return
2026-01-11T19:28:13.7896600Z                              }
2026-01-11T19:28:13.7897267Z                      
2026-01-11T19:28:13.7898070Z                              Write-Log "Applying NVIDIA optimizations..." "INFO"
2026-01-11T19:28:13.7898754Z                              Backup-RegistryKey -Path $nvidiaPath
2026-01-11T19:28:13.7899386Z                      
2026-01-11T19:28:13.7900198Z                              $nvidiaTasks = @(
2026-01-11T19:28:13.7901203Z                                  "NvTmRep_CrashReport1_{B2FE1952-0186-46C3-BAEC-A80AA35AC5B8}",
2026-01-11T19:28:13.7902020Z                                  "NvTmRep_CrashReport2_{B2FE1952-0186-46C3-BAEC-A80AA35AC5B8}",
2026-01-11T19:28:13.7902568Z                                  "NvTmRep_CrashReport3_{B2FE1952-0186-46C3-BAEC-A80AA35AC5B8}",
2026-01-11T19:28:13.7903148Z                                  "NvTmRep_CrashReport4_{B2FE1952-0186-46C3-BAEC-A80AA35AC5B8}",
2026-01-11T19:28:13.7903882Z                                  "NvDriverUpdateCheckDaily_{B2FE1952-0186-46C3-BAEC-A80AA35AC5B8}",
2026-01-11T19:28:13.7904371Z                                  "NVIDIA GeForce Experience SelfUpdate_{B2FE1952-0186-46C3-BAEC-A80AA35AC5B8}",
2026-01-11T19:28:13.7905040Z                                  "NvTmMon_{B2FE1952-0186-46C3-BAEC-A80AA35AC5B8}"
2026-01-11T19:28:13.7905668Z                              )
2026-01-11T19:28:13.7906437Z                      
2026-01-11T19:28:13.7907442Z                              $disabled = 0
2026-01-11T19:28:13.7908139Z                              foreach ($task in $nvidiaTasks) {
2026-01-11T19:28:13.7908670Z                                  try {
2026-01-11T19:28:13.7909460Z                                      schtasks /Change /TN $task /DISABLE 2>&1 | Out-Null
2026-01-11T19:28:13.7909916Z                                      if ($LASTEXITCODE -eq 0) {
2026-01-11T19:28:13.7910535Z                                          $disabled++
2026-01-11T19:28:13.7911328Z                                      }
2026-01-11T19:28:13.7912050Z                                  } catch {
2026-01-11T19:28:13.7912642Z                                  }
2026-01-11T19:28:13.7913304Z                              }
2026-01-11T19:28:13.7913934Z                      
2026-01-11T19:28:13.7914855Z                              if ($disabled -gt 0) {
2026-01-11T19:28:13.7915718Z                                  Write-Log "Disabled $disabled NVIDIA telemetry tasks" "SUCCESS"
2026-01-11T19:28:13.7916290Z                              }
2026-01-11T19:28:13.7916999Z                      
2026-01-11T19:28:13.7918279Z                              Write-Log "NVIDIA optimizations complete" "SUCCESS"
2026-01-11T19:28:13.7919277Z                              Write-Log "RECOMMENDED: Configure NVIDIA Control Panel manually:" "INFO"
2026-01-11T19:28:13.7920159Z                              Write-Log "  - Power management mode: Prefer maximum performance" "INFO"
2026-01-11T19:28:13.7920817Z                              Write-Log "  - Vertical sync: Off (or Fast for G-Sync)" "INFO"
2026-01-11T19:28:13.7921678Z                              Write-Log "  - Low latency mode: Ultra" "INFO"
2026-01-11T19:28:13.7922848Z                              Write-Log "  - Texture filtering - Quality: High performance" "INFO"
2026-01-11T19:28:13.7923063Z                      
2026-01-11T19:28:13.7923729Z                          } catch {
2026-01-11T19:28:13.7924561Z                              Write-Log "Error applying NVIDIA optimizations: $_" "ERROR"
2026-01-11T19:28:13.7925184Z                              throw
2026-01-11T19:28:13.7925791Z                          }
2026-01-11T19:28:13.7926732Z                      }
2026-01-11T19:28:13.7927378Z                      
2026-01-11T19:28:13.7928075Z                      
2026-01-11T19:28:13.7928789Z                      function Set-AMDOptimizations {
2026-01-11T19:28:13.7929502Z                          <#
2026-01-11T19:28:13.7930376Z                          .SYNOPSIS
2026-01-11T19:28:13.7931132Z                              Applies AMD-specific housekeeping.
2026-01-11T19:28:13.7931783Z                          .DESCRIPTION
2026-01-11T19:28:13.7932709Z                              Performs minimal registry backup and prints recommended Radeon settings.
2026-01-11T19:28:13.7933322Z                          .OUTPUTS
2026-01-11T19:28:13.7933858Z                              None.
2026-01-11T19:28:13.7934589Z                          #>
2026-01-11T19:28:13.7935263Z                          try {
2026-01-11T19:28:13.7936028Z                              Write-Log "Applying AMD optimizations..." "INFO"
2026-01-11T19:28:13.7936586Z                      
2026-01-11T19:28:13.7937438Z                              $amdPath = 
2026-01-11T19:28:13.7938710Z                      "HKLM:\SYSTEM\CurrentControlSet\Control\Class\{4d36e968-e325-11ce-bfc1-08002be10318}\0000"
2026-01-11T19:28:13.7939054Z                              if (Test-Path $amdPath) {
2026-01-11T19:28:13.7939634Z                                  Backup-RegistryKey -Path $amdPath
2026-01-11T19:28:13.7940275Z                              }
2026-01-11T19:28:13.7940913Z                      
2026-01-11T19:28:13.7941725Z                              Write-Log "AMD optimizations complete" "SUCCESS"
2026-01-11T19:28:13.7942555Z                              Write-Log "RECOMMENDED: Configure AMD Radeon Software manually:" "INFO"
2026-01-11T19:28:13.7943239Z                              Write-Log "  - Radeon Anti-Lag: On" "INFO"
2026-01-11T19:28:13.7943885Z                              Write-Log "  - Radeon Boost: On (if supported)" "INFO"
2026-01-11T19:28:13.7944665Z                              Write-Log "  - Radeon Image Sharpening: 80% (if desired)" "INFO"
2026-01-11T19:28:13.7945510Z                              Write-Log "  - Wait for Vertical Refresh: Off" "INFO"
2026-01-11T19:28:13.7946314Z                              Write-Log "  - Texture Filtering Quality: Performance" "INFO"
2026-01-11T19:28:13.7947005Z                      
2026-01-11T19:28:13.7947842Z                          } catch {
2026-01-11T19:28:13.7949021Z                              Write-Log "Error applying AMD optimizations: $_" "ERROR"
2026-01-11T19:28:13.7949653Z                              throw
2026-01-11T19:28:13.7950383Z                          }
2026-01-11T19:28:13.7951249Z                      }
2026-01-11T19:28:13.7951844Z                      
2026-01-11T19:28:13.7952642Z                      
2026-01-11T19:28:13.7953382Z                      function Set-IntelOptimizations {
2026-01-11T19:28:13.7954001Z                          <#
2026-01-11T19:28:13.7954815Z                          .SYNOPSIS
2026-01-11T19:28:13.7955577Z                              Applies Intel-specific housekeeping.
2026-01-11T19:28:13.7956225Z                          .DESCRIPTION
2026-01-11T19:28:13.7957082Z                              Logs recommended Intel graphics settings for manual review.
2026-01-11T19:28:13.7957642Z                          .OUTPUTS
2026-01-11T19:28:13.7958308Z                              None.
2026-01-11T19:28:13.7958989Z                          #>
2026-01-11T19:28:13.7959629Z                          try {
2026-01-11T19:28:13.7960504Z                              Write-Log "Applying Intel GPU optimizations..." "INFO"
2026-01-11T19:28:13.7961035Z                      
2026-01-11T19:28:13.7961884Z                              Write-Log "Intel GPU optimizations complete" "SUCCESS"
2026-01-11T19:28:13.7962988Z                              Write-Log "RECOMMENDED: Configure Intel Graphics Command Center manually:" "INFO"
2026-01-11T19:28:13.7963861Z                              Write-Log "  - Use Intel Graphics Command Center for performance profiles" "INFO"
2026-01-11T19:28:13.7964114Z                              Write-Log "  - Enable Gaming mode if available" "INFO"
2026-01-11T19:28:13.7964475Z                      
2026-01-11T19:28:13.7965117Z                          } catch {
2026-01-11T19:28:13.7965989Z                              Write-Log "Error applying Intel optimizations: $_" "ERROR"
2026-01-11T19:28:13.7966554Z                              throw
2026-01-11T19:28:13.7967299Z                          }
2026-01-11T19:28:13.7969062Z                      }
2026-01-11T19:28:13.7969718Z                      
2026-01-11T19:28:13.7970268Z                      
2026-01-11T19:28:13.7971054Z                      function Disable-AmdUlps {
2026-01-11T19:28:13.7971588Z                          <#
2026-01-11T19:28:13.7972346Z                          .SYNOPSIS
2026-01-11T19:28:13.7973079Z                              Disables AMD Ultra Low Power State (ULPS).
2026-01-11T19:28:13.7973617Z                          .DESCRIPTION
2026-01-11T19:28:13.7974486Z                              FR33THY optimization - ULPS causes AMD GPUs to downclock aggressively,
2026-01-11T19:28:13.7975308Z                              which can introduce micro-stutters during power state transitions.
2026-01-11T19:28:13.7975948Z                              Disabling keeps GPU ready for immediate performance.
2026-01-11T19:28:13.7976608Z                          .PARAMETER Enable
2026-01-11T19:28:13.7977417Z                              When true, disables ULPS (counterintuitive but matches pattern).
2026-01-11T19:28:13.7977862Z                          .OUTPUTS
2026-01-11T19:28:13.7978650Z                              None.
2026-01-11T19:28:13.7979396Z                          .NOTES
2026-01-11T19:28:13.7980389Z                              Only affects AMD Radeon GPUs. Safe but increases idle power draw slightly.
2026-01-11T19:28:13.7981023Z                          #>
2026-01-11T19:28:13.7981850Z                          param(
2026-01-11T19:28:13.7982589Z                              [bool]$Enable = $true
2026-01-11T19:28:13.7983147Z                          )
2026-01-11T19:28:13.7983979Z                      
2026-01-11T19:28:13.7984690Z                          if (-not $Enable) {
2026-01-11T19:28:13.7985663Z                              Write-Log "AMD ULPS disable: skipped" "INFO"
2026-01-11T19:28:13.7985997Z                              return
2026-01-11T19:28:13.7986889Z                          }
2026-01-11T19:28:13.7986985Z                      
2026-01-11T19:28:13.7987727Z                          try {
2026-01-11T19:28:13.7988644Z                              $gpuClassPath = 
2026-01-11T19:28:13.7989765Z                      "HKLM:\SYSTEM\CurrentControlSet\Control\Class\{4d36e968-e325-11ce-bfc1-08002be10318}"
2026-01-11T19:28:13.7989947Z                              $foundAmd = $false
2026-01-11T19:28:13.7990655Z                      
2026-01-11T19:28:13.7991529Z                              if (-not (Test-Path $gpuClassPath)) {
2026-01-11T19:28:13.7992159Z                                  Write-Log "GPU class registry path not found" "INFO"
2026-01-11T19:28:13.7992912Z                                  return
2026-01-11T19:28:13.7993689Z                              }
2026-01-11T19:28:13.7994269Z                      
2026-01-11T19:28:13.7995482Z                              Get-ChildItem $gpuClassPath -ErrorAction SilentlyContinue | ForEach-Object {
2026-01-11T19:28:13.7995890Z                                  try {
2026-01-11T19:28:13.7997308Z                                      $driverDesc = Get-ItemPropertyValue $_.PSPath "DriverDesc" -ErrorAction 
2026-01-11T19:28:13.7997519Z                      SilentlyContinue
2026-01-11T19:28:13.7998431Z                                      if ($driverDesc -match "AMD|Radeon") {
2026-01-11T19:28:13.7999956Z                                          $foundAmd = $true
2026-01-11T19:28:13.8000177Z                                          Backup-RegistryKey -Path $_.PSPath
2026-01-11T19:28:13.8000951Z                      
2026-01-11T19:28:13.8001936Z                                          # FR33THY: EnableUlps=0 prevents aggressive downclocking
2026-01-11T19:28:13.8003097Z                                          Set-RegistryValue -Path $_.PSPath -Name "EnableUlps" -Value 0 -Type "DWORD"
2026-01-11T19:28:13.8003797Z                                          Set-RegistryValue -Path $_.PSPath -Name "EnableUlps_NA" -Value 0 -Type "DWORD"
2026-01-11T19:28:13.8003900Z                      
2026-01-11T19:28:13.8004721Z                                          Write-Log "AMD ULPS disabled for: $driverDesc" "SUCCESS"
2026-01-11T19:28:13.8005273Z                                      }
2026-01-11T19:28:13.8005878Z                                  } catch {
2026-01-11T19:28:13.8007170Z                                      # Silently skip entries without DriverDesc
2026-01-11T19:28:13.8007293Z                                  }
2026-01-11T19:28:13.8008122Z                              }
2026-01-11T19:28:13.8008776Z                      
2026-01-11T19:28:13.8009519Z                              if (-not $foundAmd) {
2026-01-11T19:28:13.8010323Z                                  Write-Log "No AMD GPU found, ULPS disable skipped" "INFO"
2026-01-11T19:28:13.8010876Z                              }
2026-01-11T19:28:13.8011574Z                      
2026-01-11T19:28:13.8012345Z                          } catch {
2026-01-11T19:28:13.8013140Z                              Write-Log "Error disabling AMD ULPS: $_" "ERROR"
2026-01-11T19:28:13.8013716Z                          }
2026-01-11T19:28:13.8014426Z                      }
2026-01-11T19:28:13.8015038Z                      
2026-01-11T19:28:13.8015731Z                      
2026-01-11T19:28:13.8016436Z                      function Set-NvidiaP0State {
2026-01-11T19:28:13.8017097Z                          <#
2026-01-11T19:28:13.8017806Z                          .SYNOPSIS
2026-01-11T19:28:13.8018697Z                              Forces NVIDIA GPU to stay in maximum performance state (P0).
2026-01-11T19:28:13.8019215Z                          .DESCRIPTION
2026-01-11T19:28:13.8020077Z                              FR33THY optimization - Disables dynamic P-state switching which
2026-01-11T19:28:13.8020852Z                              causes the GPU to constantly adjust clocks. Forces constant max clocks
2026-01-11T19:28:13.8021504Z                              for consistent frame times. WARNING: Increases heat and power usage.
2026-01-11T19:28:13.8022012Z                          .PARAMETER Enable
2026-01-11T19:28:13.8023114Z                              When true, forces P0 state.
2026-01-11T19:28:13.8023545Z                          .OUTPUTS
2026-01-11T19:28:13.8024339Z                              None.
2026-01-11T19:28:13.8025453Z                          .NOTES
2026-01-11T19:28:13.8026206Z                              RISKY: Significantly increases GPU temperature and power consumption.
2026-01-11T19:28:13.8026833Z                              Recommended only for competitive gaming sessions, not 24/7 use.
2026-01-11T19:28:13.8027541Z                          #>
2026-01-11T19:28:13.8028260Z                          param(
2026-01-11T19:28:13.8028978Z                              [bool]$Enable = $true
2026-01-11T19:28:13.8029592Z                          )
2026-01-11T19:28:13.8030285Z                      
2026-01-11T19:28:13.8031125Z                          if (-not $Enable) {
2026-01-11T19:28:13.8031899Z                              Write-Log "NVIDIA P0 state: skipped" "INFO"
2026-01-11T19:28:13.8032512Z                              return
2026-01-11T19:28:13.8033235Z                          }
2026-01-11T19:28:13.8033886Z                      
2026-01-11T19:28:13.8034597Z                          try {
2026-01-11T19:28:13.8035532Z                              $gpuClassPath = 
2026-01-11T19:28:13.8036826Z                      "HKLM:\SYSTEM\CurrentControlSet\Control\Class\{4d36e968-e325-11ce-bfc1-08002be10318}"
2026-01-11T19:28:13.8037158Z                              $foundNvidia = $false
2026-01-11T19:28:13.8037695Z                      
2026-01-11T19:28:13.8038437Z                              if (-not (Test-Path $gpuClassPath)) {
2026-01-11T19:28:13.8039186Z                                  Write-Log "GPU class registry path not found" "INFO"
2026-01-11T19:28:13.8039787Z                                  return
2026-01-11T19:28:13.8040441Z                              }
2026-01-11T19:28:13.8041117Z                      
2026-01-11T19:28:13.8042339Z                              Get-ChildItem $gpuClassPath -ErrorAction SilentlyContinue | ForEach-Object {
2026-01-11T19:28:13.8042485Z                                  try {
2026-01-11T19:28:13.8043471Z                                      $driverDesc = Get-ItemPropertyValue $_.PSPath "DriverDesc" -ErrorAction 
2026-01-11T19:28:13.8043867Z                      SilentlyContinue
2026-01-11T19:28:13.8044721Z                                      if ($driverDesc -match "NVIDIA|GeForce") {
2026-01-11T19:28:13.8045809Z                                          $foundNvidia = $true
2026-01-11T19:28:13.8046205Z                                          Backup-RegistryKey -Path $_.PSPath
2026-01-11T19:28:13.8046863Z                      
2026-01-11T19:28:13.8047878Z                                          # FR33THY: DisableDynamicPstate=1 forces constant max clocks
2026-01-11T19:28:13.8049020Z                                          Set-RegistryValue -Path $_.PSPath -Name "DisableDynamicPstate" -Value 1 -Type 
2026-01-11T19:28:13.8049136Z                      "DWORD"
2026-01-11T19:28:13.8049725Z                      
2026-01-11T19:28:13.8050694Z                                          Write-Log "NVIDIA P0 state forced for: $driverDesc" "SUCCESS"
2026-01-11T19:28:13.8051531Z                                          Write-Log "WARNING: GPU will run at constant max clocks (increased 
2026-01-11T19:28:13.8051933Z                      heat/power)" "WARNING"
2026-01-11T19:28:13.8052556Z                                      }
2026-01-11T19:28:13.8053219Z                                  } catch {
2026-01-11T19:28:13.8054019Z                                      # Silently skip entries without DriverDesc
2026-01-11T19:28:13.8054650Z                                  }
2026-01-11T19:28:13.8055325Z                              }
2026-01-11T19:28:13.8055990Z                      
2026-01-11T19:28:13.8056706Z                              if (-not $foundNvidia) {
2026-01-11T19:28:13.8059075Z                                  Write-Log "No NVIDIA GPU found, P0 state skip" "INFO"
2026-01-11T19:28:13.8059481Z                              }
2026-01-11T19:28:13.8059578Z                      
2026-01-11T19:28:13.8059684Z                          } catch {
2026-01-11T19:28:13.8060473Z                              Write-Log "Error setting NVIDIA P0 state: $_" "ERROR"
2026-01-11T19:28:13.8061048Z                          }
2026-01-11T19:28:13.8061698Z                      }
2026-01-11T19:28:13.8062375Z                      
2026-01-11T19:28:13.8063015Z                      
2026-01-11T19:28:13.8063792Z                      function Invoke-GPUOptimizations {
2026-01-11T19:28:13.8064514Z                          <#
2026-01-11T19:28:13.8065193Z                          .SYNOPSIS
2026-01-11T19:28:13.8066402Z                              Runs GPU optimizations based on detected vendor.
2026-01-11T19:28:13.8066910Z                          .DESCRIPTION
2026-01-11T19:28:13.8068001Z                              Applies HAGS preference, detects GPU vendor, and executes the matching
2026-01-11T19:28:13.8068406Z                              vendor-specific helper.
2026-01-11T19:28:13.8069053Z                          .PARAMETER EnableHAGS
2026-01-11T19:28:13.8069755Z                              Enables HAGS when true.
2026-01-11T19:28:13.8070516Z                          .OUTPUTS
2026-01-11T19:28:13.8071207Z                              None.
2026-01-11T19:28:13.8071891Z                          #>
2026-01-11T19:28:13.8072536Z                          param(
2026-01-11T19:28:13.8073310Z                              [bool]$EnableHAGS = $false
2026-01-11T19:28:13.8073906Z                          )
2026-01-11T19:28:13.8074604Z                      
2026-01-11T19:28:13.8075373Z                          Write-Log "Applying GPU optimizations..." "INFO"
2026-01-11T19:28:13.8075961Z                      
2026-01-11T19:28:13.8076630Z                          try {
2026-01-11T19:28:13.8077377Z                              Set-HAGS -Enable $EnableHAGS
2026-01-11T19:28:13.8077972Z                      
2026-01-11T19:28:13.8078680Z                              $vendor = Test-GPUVendor
2026-01-11T19:28:13.8079265Z                      
2026-01-11T19:28:13.8080044Z                              switch ($vendor) {
2026-01-11T19:28:13.8080518Z                                  "nvidia" {
2026-01-11T19:28:13.8081181Z                                      Set-NVIDIAOptimizations
2026-01-11T19:28:13.8081936Z                                  }
2026-01-11T19:28:13.8082623Z                                  "amd" {
2026-01-11T19:28:13.8083348Z                                      Set-AMDOptimizations
2026-01-11T19:28:13.8083938Z                                  }
2026-01-11T19:28:13.8084835Z                                  "intel" {
2026-01-11T19:28:13.8085902Z                                      Set-IntelOptimizations
2026-01-11T19:28:13.8086528Z                                  }
2026-01-11T19:28:13.8087356Z                                  default {
2026-01-11T19:28:13.8088461Z                                      Write-Log "Unknown GPU vendor, skipping vendor-specific optimizations" "INFO"
2026-01-11T19:28:13.8088812Z                                  }
2026-01-11T19:28:13.8089413Z                              }
2026-01-11T19:28:13.8090053Z                      
2026-01-11T19:28:13.8090857Z                              Write-Log "GPU optimizations complete" "SUCCESS"
2026-01-11T19:28:13.8091453Z                      
2026-01-11T19:28:13.8092130Z                          } catch {
2026-01-11T19:28:13.8092945Z                              Write-Log "Error applying GPU optimizations: $_" "ERROR"
2026-01-11T19:28:13.8093545Z                              throw
2026-01-11T19:28:13.8094225Z                          }
2026-01-11T19:28:13.8094883Z                      }
2026-01-11T19:28:13.8095551Z                      
2026-01-11T19:28:13.8096323Z                      
2026-01-11T19:28:13.8096997Z                      function Undo-GPUOptimizations {
2026-01-11T19:28:13.8097793Z                          <#
2026-01-11T19:28:13.8098387Z                          .SYNOPSIS
2026-01-11T19:28:13.8099174Z                              Reverts GPU-related settings and tasks.
2026-01-11T19:28:13.8099859Z                          .DESCRIPTION
2026-01-11T19:28:13.8100930Z                              Disables HAGS, re-enables NVIDIA scheduled tasks, and restores backed
2026-01-11T19:28:13.8102053Z                              up registry values when present.
2026-01-11T19:28:13.8102841Z                          .OUTPUTS
2026-01-11T19:28:13.8103653Z                              None.
2026-01-11T19:28:13.8104354Z                          #>
2026-01-11T19:28:13.8105226Z                          Write-Log "Rolling back GPU optimizations..." "INFO"
2026-01-11T19:28:13.8106265Z                      
2026-01-11T19:28:13.8106603Z                          try {
2026-01-11T19:28:13.8107326Z                              Set-HAGS -Enable $false
2026-01-11T19:28:13.8108111Z                      
2026-01-11T19:28:13.8108874Z                              $nvidiaTasks = @(
2026-01-11T19:28:13.8109709Z                                  "NvTmRep_CrashReport1_{B2FE1952-0186-46C3-BAEC-A80AA35AC5B8}",
2026-01-11T19:28:13.8110510Z                                  "NvTmRep_CrashReport2_{B2FE1952-0186-46C3-BAEC-A80AA35AC5B8}",
2026-01-11T19:28:13.8111104Z                                  "NvTmRep_CrashReport3_{B2FE1952-0186-46C3-BAEC-A80AA35AC5B8}",
2026-01-11T19:28:13.8111842Z                                  "NvTmRep_CrashReport4_{B2FE1952-0186-46C3-BAEC-A80AA35AC5B8}",
2026-01-11T19:28:13.8112668Z                                  "NvDriverUpdateCheckDaily_{B2FE1952-0186-46C3-BAEC-A80AA35AC5B8}",
2026-01-11T19:28:13.8113714Z                                  "NVIDIA GeForce Experience SelfUpdate_{B2FE1952-0186-46C3-BAEC-A80AA35AC5B8}",
2026-01-11T19:28:13.8113949Z                                  "NvTmMon_{B2FE1952-0186-46C3-BAEC-A80AA35AC5B8}"
2026-01-11T19:28:13.8114474Z                              )
2026-01-11T19:28:13.8115124Z                      
2026-01-11T19:28:13.8115947Z                              foreach ($task in $nvidiaTasks) {
2026-01-11T19:28:13.8116695Z                                  schtasks /Change /TN $task /ENABLE 2>&1 | Out-Null
2026-01-11T19:28:13.8117273Z                              }
2026-01-11T19:28:13.8117893Z                      
2026-01-11T19:28:13.8118560Z                              $paths = @(
2026-01-11T19:28:13.8119485Z                                  "HKLM:\SYSTEM\CurrentControlSet\Control\GraphicsDrivers",
2026-01-11T19:28:13.8120173Z                                  "HKLM:\SYSTEM\CurrentControlSet\Services\nvlddmkm",
2026-01-11T19:28:13.8120792Z                                  
2026-01-11T19:28:13.8122023Z                      "HKLM:\SYSTEM\CurrentControlSet\Control\Class\{4d36e968-e325-11ce-bfc1-08002be10318}\0000"
2026-01-11T19:28:13.8122270Z                              )
2026-01-11T19:28:13.8122874Z                      
2026-01-11T19:28:13.8123595Z                              foreach ($path in $paths) {
2026-01-11T19:28:13.8124292Z                                  if (Restore-RegistryKey -Path $path) {
2026-01-11T19:28:13.8125176Z                                      Write-Log "Restored registry: $path" "SUCCESS"
2026-01-11T19:28:13.8126082Z                                  }
2026-01-11T19:28:13.8126450Z                              }
2026-01-11T19:28:13.8127029Z                      
2026-01-11T19:28:13.8127818Z                              Write-Log "GPU optimization rollback complete" "SUCCESS"
2026-01-11T19:28:13.8128560Z                      
2026-01-11T19:28:13.8129033Z                          } catch {
2026-01-11T19:28:13.8129963Z                              Write-Log "Error during rollback: $_" "ERROR"
2026-01-11T19:28:13.8130477Z                              throw
2026-01-11T19:28:13.8131541Z                          }
2026-01-11T19:28:13.8132360Z                      }
2026-01-11T19:28:13.8133122Z                      
2026-01-11T19:28:13.8134084Z                      
2026-01-11T19:28:13.8134775Z                      Export-ModuleMember -Function @(
2026-01-11T19:28:13.8135605Z                          'Test-GPUVendor',
2026-01-11T19:28:13.8136598Z                          'Set-HAGS',
2026-01-11T19:28:13.8137500Z                          'Set-NVIDIAOptimizations',
2026-01-11T19:28:13.8138345Z                          'Set-AMDOptimizations',
2026-01-11T19:28:13.8139278Z                          'Set-IntelOptimizations',
2026-01-11T19:28:13.8140083Z                          'Disable-AmdUlps',
2026-01-11T19:28:13.8140965Z                          'Set-NvidiaP0State',
2026-01-11T19:28:13.8141743Z                          'Test-GPUOptimizations',
2026-01-11T19:28:13.8142506Z                          'Invoke-GPUOptimizations',
2026-01-11T19:28:13.8143240Z                          'Undo-GPUOptimizations'
2026-01-11T19:28:13.8143925Z                      )
2026-01-11T19:28:13.8144835Z                      
2026-01-11T19:28:13.8146563Z [32;1mParent             : [0m
2026-01-11T19:28:13.8146825Z 
2026-01-11T19:28:13.8188277Z [32;1mAttributes         : [0m{}
2026-01-11T19:28:13.8188504Z [32;1mUsingStatements    : [0m{}
2026-01-11T19:28:13.8189056Z [32;1mParamBlock         : [0m
2026-01-11T19:28:13.8189225Z [32;1mBeginBlock         : [0m
2026-01-11T19:28:13.8189404Z [32;1mProcessBlock       : [0m
2026-01-11T19:28:13.8192834Z [32;1mEndBlock           : [0mImport-Module (Join-Path $PSScriptRoot "..\core\logger.psm1") -Force -Global
2026-01-11T19:28:13.8193180Z                      Import-Module (Join-Path $PSScriptRoot "..\core\registry.psm1") -Force -Global
2026-01-11T19:28:13.8193278Z                      
2026-01-11T19:28:13.8193401Z                      
2026-01-11T19:28:13.8194420Z                      
2026-01-11T19:28:13.8195347Z                      function Get-ActiveNetworkAdapter {
2026-01-11T19:28:13.8195793Z                          <#
2026-01-11T19:28:13.8196740Z                          .SYNOPSIS
2026-01-11T19:28:13.8197101Z                              Finds the first active Ethernet or Wi-Fi adapter.
2026-01-11T19:28:13.8198120Z                          .DESCRIPTION
2026-01-11T19:28:13.8198517Z                              Scans enabled adapters and selects the first matching Ethernet/Wi-Fi
2026-01-11T19:28:13.8198946Z                              interface for subsequent configuration.
2026-01-11T19:28:13.8199252Z                          .OUTPUTS
2026-01-11T19:28:13.8200504Z                              [Microsoft.Management.Infrastructure.CimInstance] Adapter object or $null.
2026-01-11T19:28:13.8200654Z                          #>
2026-01-11T19:28:13.8201080Z                          try {
2026-01-11T19:28:13.8202215Z                              $adapter = Get-NetAdapter | Where-Object {
2026-01-11T19:28:13.8202360Z                                  $_.Status -eq "Up" -and
2026-01-11T19:28:13.8203922Z                                  ($_.InterfaceDescription -like "*Ethernet*" -or $_.InterfaceDescription -like 
2026-01-11T19:28:13.8204034Z                      "*Wi-Fi*")
2026-01-11T19:28:13.8204581Z                              } | Select-Object -First 1
2026-01-11T19:28:13.8206014Z                      
2026-01-11T19:28:13.8206286Z                              if ($adapter) {
2026-01-11T19:28:13.8206812Z                                  Write-Log "Detected network adapter: $($adapter.Name)" "INFO"
2026-01-11T19:28:13.8206943Z                              } else {
2026-01-11T19:28:13.8208013Z                                  Write-Log "No active network adapter found" "ERROR"
2026-01-11T19:28:13.8208114Z                              }
2026-01-11T19:28:13.8208539Z                      
2026-01-11T19:28:13.8209406Z                              return $adapter
2026-01-11T19:28:13.8210168Z                          } catch {
2026-01-11T19:28:13.8211193Z                              Write-Log "Error detecting network adapter: $_" "ERROR"
2026-01-11T19:28:13.8211555Z                              return $null
2026-01-11T19:28:13.8212283Z                          }
2026-01-11T19:28:13.8213189Z                      }
2026-01-11T19:28:13.8213312Z                      
2026-01-11T19:28:13.8214317Z                      
2026-01-11T19:28:13.8215321Z                      function Test-NetworkOptimizations {
2026-01-11T19:28:13.8215531Z                          <#
2026-01-11T19:28:13.8216328Z                          .SYNOPSIS
2026-01-11T19:28:13.8217271Z                              Verifies network-related registry settings.
2026-01-11T19:28:13.8217725Z                          .DESCRIPTION
2026-01-11T19:28:13.8218834Z                              Checks for Receive Side Scaling (RSS) enablement.
2026-01-11T19:28:13.8218965Z                          .OUTPUTS
2026-01-11T19:28:13.8220053Z                              [bool] True when checks pass, else false.
2026-01-11T19:28:13.8220434Z                          #>
2026-01-11T19:28:13.8221345Z                          $allPassed = $true
2026-01-11T19:28:13.8221464Z                      
2026-01-11T19:28:13.8222444Z                          Write-Log "Verifying network optimizations..." "INFO"
2026-01-11T19:28:13.8222827Z                      
2026-01-11T19:28:13.8223954Z                          $tcpPath = "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters"
2026-01-11T19:28:13.8224287Z                          $rssEnabled = Get-RegistryValue -Path $tcpPath -Name "EnableRSS"
2026-01-11T19:28:13.8225297Z                          if ($rssEnabled -eq 1) {
2026-01-11T19:28:13.8225997Z                              Write-Log "‚úì RSS (Receive Side Scaling) enabled" "SUCCESS"
2026-01-11T19:28:13.8226310Z                          } else {
2026-01-11T19:28:13.8226774Z                              Write-Log "‚úó RSS not enabled" "ERROR"
2026-01-11T19:28:13.8226920Z                              $allPassed = $false
2026-01-11T19:28:13.8227696Z                          }
2026-01-11T19:28:13.8228989Z                      
2026-01-11T19:28:13.8229311Z                          return $allPassed
2026-01-11T19:28:13.8230253Z                      }
2026-01-11T19:28:13.8231114Z                      
2026-01-11T19:28:13.8231268Z                      
2026-01-11T19:28:13.8232324Z                      
2026-01-11T19:28:13.8232585Z                      
2026-01-11T19:28:13.8234093Z                      function Set-NetworkAdapterOptimizations {
2026-01-11T19:28:13.8234376Z                          <#
2026-01-11T19:28:13.8234816Z                          .SYNOPSIS
2026-01-11T19:28:13.8236156Z                              Applies adapter-level network optimizations.
2026-01-11T19:28:13.8236260Z                          .DESCRIPTION
2026-01-11T19:28:13.8236901Z                              Enables RSS and optionally disables RSC. Attempts to disable adapter
2026-01-11T19:28:13.8237141Z                              power saving for more consistent latency.
2026-01-11T19:28:13.8238049Z                          .PARAMETER DisableRSC
2026-01-11T19:28:13.8239007Z                              When true, disables Receive Segment Coalescing (opt-in).
2026-01-11T19:28:13.8239384Z                          .OUTPUTS
2026-01-11T19:28:13.8240348Z                              None.
2026-01-11T19:28:13.8241103Z                          #>
2026-01-11T19:28:13.8242010Z                          param(
2026-01-11T19:28:13.8242697Z                              [bool]$DisableRSC = $false
2026-01-11T19:28:13.8243761Z                          )
2026-01-11T19:28:13.8243938Z                      
2026-01-11T19:28:13.8245424Z                          try {
2026-01-11T19:28:13.8246479Z                              $adapter = Get-ActiveNetworkAdapter
2026-01-11T19:28:13.8247464Z                              if (-not $adapter) { return }
2026-01-11T19:28:13.8247888Z                      
2026-01-11T19:28:13.8249055Z                              $tcpPath = "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters"
2026-01-11T19:28:13.8249499Z                              Backup-RegistryKey -Path $tcpPath
2026-01-11T19:28:13.8249899Z                      
2026-01-11T19:28:13.8251210Z                              Set-RegistryValue -Path $tcpPath -Name "EnableRSS" -Value 1 -Type "DWORD"
2026-01-11T19:28:13.8251635Z                              Write-Log "Enabled RSS (Receive Side Scaling) for multi-core performance" "SUCCESS"
2026-01-11T19:28:13.8251792Z                      
2026-01-11T19:28:13.8252556Z                              if ($DisableRSC) {
2026-01-11T19:28:13.8252945Z                                  Set-RegistryValue -Path $tcpPath -Name "EnableRSC" -Value 0 -Type "DWORD"
2026-01-11T19:28:13.8254104Z                                  Write-Log "Disabled RSC (opt-in, validate with network monitoring)" "SUCCESS"
2026-01-11T19:28:13.8254260Z                              } else {
2026-01-11T19:28:13.8255689Z                                  Write-Log "RSC kept enabled (default, disable only if measured jitter)" "INFO"
2026-01-11T19:28:13.8255805Z                              }
2026-01-11T19:28:13.8256172Z                      
2026-01-11T19:28:13.8257384Z                              try {
2026-01-11T19:28:13.8258242Z                                  $adapterGuid = $adapter.InterfaceGuid
2026-01-11T19:28:13.8259092Z                                  $powerMgmt = Get-WmiObject MSPower_DeviceEnable -Namespace root\wmi | Where-Object { 
2026-01-11T19:28:13.8260399Z                      $_.InstanceName -like "*$adapterGuid*" }
2026-01-11T19:28:13.8260540Z                                  if ($powerMgmt) {
2026-01-11T19:28:13.8261632Z                                      $powerMgmt.Enable = $false
2026-01-11T19:28:13.8262690Z                                      $powerMgmt.Put() | Out-Null
2026-01-11T19:28:13.8263038Z                                      Write-Log "Disabled power saving for network adapter" "SUCCESS"
2026-01-11T19:28:13.8264067Z                                  }
2026-01-11T19:28:13.8264735Z                              } catch {
2026-01-11T19:28:13.8266955Z                                  Write-Log "Could not disable network adapter power saving (may require manual 
2026-01-11T19:28:13.8267097Z                      config)" "ERROR"
2026-01-11T19:28:13.8267260Z                              }
2026-01-11T19:28:13.8267927Z                      
2026-01-11T19:28:13.8268112Z                          } catch {
2026-01-11T19:28:13.8269264Z                              Write-Log "Error optimizing network adapter: $_" "ERROR"
2026-01-11T19:28:13.8269361Z                              throw
2026-01-11T19:28:13.8270399Z                          }
2026-01-11T19:28:13.8270530Z                      }
2026-01-11T19:28:13.8271387Z                      
2026-01-11T19:28:13.8272172Z                      
2026-01-11T19:28:13.8273121Z                      function Set-DNSProvider {
2026-01-11T19:28:13.8273241Z                          <#
2026-01-11T19:28:13.8274303Z                          .SYNOPSIS
2026-01-11T19:28:13.8275188Z                              Sets the DNS resolver for the active adapter.
2026-01-11T19:28:13.8275847Z                          .DESCRIPTION
2026-01-11T19:28:13.8277049Z                              Applies a well-known DNS provider or restores ISP defaults via DHCP.
2026-01-11T19:28:13.8277325Z                              Flushes DNS cache and performs a simple resolution test.
2026-01-11T19:28:13.8277765Z                          .PARAMETER Provider
2026-01-11T19:28:13.8278993Z                              DNS provider name: cloudflare, google, quad9, adguard, opendns, isp.
2026-01-11T19:28:13.8279092Z                          .OUTPUTS
2026-01-11T19:28:13.8280204Z                              None.
2026-01-11T19:28:13.8280315Z                          #>
2026-01-11T19:28:13.8281744Z                          param(
2026-01-11T19:28:13.8282485Z                              [ValidateSet("cloudflare", "google", "quad9", "adguard", "opendns", "isp")]
2026-01-11T19:28:13.8284231Z                              [string]$Provider = "cloudflare"
2026-01-11T19:28:13.8284341Z                          )
2026-01-11T19:28:13.8284407Z                      
2026-01-11T19:28:13.8284634Z                          try {
2026-01-11T19:28:13.8286292Z                              $adapter = Get-ActiveNetworkAdapter
2026-01-11T19:28:13.8287193Z                              if (-not $adapter) { return }
2026-01-11T19:28:13.8287808Z                      
2026-01-11T19:28:13.8288732Z                              $primaryDNS = ""
2026-01-11T19:28:13.8289728Z                              $secondaryDNS = ""
2026-01-11T19:28:13.8289851Z                      
2026-01-11T19:28:13.8290906Z                              switch ($Provider) {
2026-01-11T19:28:13.8291658Z                                  "cloudflare" {
2026-01-11T19:28:13.8292466Z                                      $primaryDNS = "1.1.1.1"
2026-01-11T19:28:13.8293138Z                                      $secondaryDNS = "1.0.0.1"
2026-01-11T19:28:13.8294291Z                                      Write-Log "Setting Cloudflare DNS (high privacy)" "INFO"
2026-01-11T19:28:13.8294594Z                                  }
2026-01-11T19:28:13.8295623Z                                  "google" {
2026-01-11T19:28:13.8296487Z                                      $primaryDNS = "8.8.8.8"
2026-01-11T19:28:13.8296658Z                                      $secondaryDNS = "8.8.4.4"
2026-01-11T19:28:13.8297179Z                                      Write-Log "Setting Google DNS (reliable)" "INFO"
2026-01-11T19:28:13.8298165Z                                  }
2026-01-11T19:28:13.8299061Z                                  "quad9" {
2026-01-11T19:28:13.8299308Z                                      $primaryDNS = "9.9.9.9"
2026-01-11T19:28:13.8300248Z                                      $secondaryDNS = "149.112.112.112"
2026-01-11T19:28:13.8301499Z                                      Write-Log "Setting Quad9 DNS (high privacy, blocks malware)" "INFO"
2026-01-11T19:28:13.8301650Z                                  }
2026-01-11T19:28:13.8302814Z                                  "adguard" {
2026-01-11T19:28:13.8304976Z                                      $primaryDNS = "94.140.14.14"
2026-01-11T19:28:13.8305951Z                                      $secondaryDNS = "94.140.15.15"
2026-01-11T19:28:13.8307645Z                                      Write-Log "Setting AdGuard DNS (privacy + blocking)" "INFO"
2026-01-11T19:28:13.8308528Z                                  }
2026-01-11T19:28:13.8309155Z                                  "opendns" {
2026-01-11T19:28:13.8309842Z                                      $primaryDNS = "208.67.222.222"
2026-01-11T19:28:13.8310541Z                                      $secondaryDNS = "208.67.220.220"
2026-01-11T19:28:13.8311714Z                                      Write-Log "Setting OpenDNS (reliable, filtering options)" "INFO"
2026-01-11T19:28:13.8312358Z                                  }
2026-01-11T19:28:13.8312906Z                                  "isp" {
2026-01-11T19:28:13.8313603Z                                      Set-DnsClientServerAddress -InterfaceIndex $adapter.InterfaceIndex 
2026-01-11T19:28:13.8314649Z                      -ResetServerAddresses
2026-01-11T19:28:13.8315212Z                                      Write-Log "Restored ISP default DNS (DHCP)" "SUCCESS"
2026-01-11T19:28:13.8316274Z                                      return
2026-01-11T19:28:13.8316742Z                                  }
2026-01-11T19:28:13.8317071Z                              }
2026-01-11T19:28:13.8317734Z                      
2026-01-11T19:28:13.8318397Z                              Set-DnsClientServerAddress -InterfaceIndex $adapter.InterfaceIndex -ServerAddresses 
2026-01-11T19:28:13.8319262Z                      ($primaryDNS, $secondaryDNS) -ErrorAction Stop
2026-01-11T19:28:13.8319978Z                              Write-Log "IPv4 DNS set to ${Provider}: ${primaryDNS}, ${secondaryDNS}" "SUCCESS"
2026-01-11T19:28:13.8320866Z                      
2026-01-11T19:28:13.8321282Z                              ipconfig /flushdns 2>&1 | Out-Null
2026-01-11T19:28:13.8321789Z                              Write-Log "DNS cache flushed" "SUCCESS"
2026-01-11T19:28:13.8322206Z                      
2026-01-11T19:28:13.8322416Z                              try {
2026-01-11T19:28:13.8323093Z                                  $testResult = Resolve-DnsName -Name "google.com" -Server $primaryDNS -ErrorAction 
2026-01-11T19:28:13.8323587Z                      Stop -QuickTimeout
2026-01-11T19:28:13.8324273Z                                  if ($testResult) {
2026-01-11T19:28:13.8324821Z                                      Write-Log "DNS resolution test successful" "SUCCESS"
2026-01-11T19:28:13.8325361Z                                  }
2026-01-11T19:28:13.8325695Z                              } catch {
2026-01-11T19:28:13.8326275Z                                  Write-Log "DNS resolution test failed (network may need time to update)" "ERROR"
2026-01-11T19:28:13.8326928Z                              }
2026-01-11T19:28:13.8327219Z                      
2026-01-11T19:28:13.8327702Z                              Write-Log "NOTE: DNS provider does NOT affect ping to game servers" "INFO"
2026-01-11T19:28:13.8328729Z                              Write-Log "It only improves name resolution speed (e.g., when typing URLs)" "INFO"
2026-01-11T19:28:13.8329347Z                      
2026-01-11T19:28:13.8329565Z                          } catch {
2026-01-11T19:28:13.8329959Z                              Write-Log "Error configuring DNS: $_" "ERROR"
2026-01-11T19:28:13.8338047Z                              throw
2026-01-11T19:28:13.8338390Z                          }
2026-01-11T19:28:13.8338886Z                      }
2026-01-11T19:28:13.8339633Z                      
2026-01-11T19:28:13.8339928Z                      
2026-01-11T19:28:13.8340300Z                      function Set-IPv4Preference {
2026-01-11T19:28:13.8340750Z                          <#
2026-01-11T19:28:13.8341023Z                          .SYNOPSIS
2026-01-11T19:28:13.8341281Z                              Optionally prefers IPv4 over IPv6.
2026-01-11T19:28:13.8341742Z                          .DESCRIPTION
2026-01-11T19:28:13.8342347Z                              Sets the DisabledComponents value to prefer IPv4. Requires reboot.
2026-01-11T19:28:13.8343017Z                          .PARAMETER Enable
2026-01-11T19:28:13.8343449Z                              When true, applies IPv4 preference.
2026-01-11T19:28:13.8343818Z                          .OUTPUTS
2026-01-11T19:28:13.8344012Z                              None.
2026-01-11T19:28:13.8344704Z                          #>
2026-01-11T19:28:13.8345048Z                          param(
2026-01-11T19:28:13.8345425Z                              [bool]$Enable = $false
2026-01-11T19:28:13.8345684Z                          )
2026-01-11T19:28:13.8345860Z                      
2026-01-11T19:28:13.8346053Z                          if (-not $Enable) {
2026-01-11T19:28:13.8346560Z                              Write-Log "IPv4 preference skipped" "INFO"
2026-01-11T19:28:13.8347010Z                              return
2026-01-11T19:28:13.8347326Z                          }
2026-01-11T19:28:13.8347501Z                      
2026-01-11T19:28:13.8347737Z                          try {
2026-01-11T19:28:13.8348164Z                              Write-Log "Setting IPv4 preference..." "INFO"
2026-01-11T19:28:13.8348657Z                      
2026-01-11T19:28:13.8349178Z                              $ipv6Path = "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters"
2026-01-11T19:28:13.8349862Z                              Backup-RegistryKey -Path $ipv6Path
2026-01-11T19:28:13.8350344Z                      
2026-01-11T19:28:13.8350777Z                              # Value 32 = Prefer IPv4 over IPv6 (see Microsoft KB 929852)
2026-01-11T19:28:13.8351895Z                              Set-RegistryValue -Path $ipv6Path -Name "DisabledComponents" -Value 32 -Type "DWORD"
2026-01-11T19:28:13.8352710Z                      
2026-01-11T19:28:13.8353097Z                              Write-Log "IPv4 preferred over IPv6" "SUCCESS"
2026-01-11T19:28:13.8353857Z                              Write-Log "Warning: May break IPv6-only paths or Xbox/Store features" "INFO"
2026-01-11T19:28:13.8354645Z                              Write-Log "Requires reboot to take effect" "INFO"
2026-01-11T19:28:13.8355222Z                          } catch {
2026-01-11T19:28:13.8355715Z                              Write-Log "Error setting IPv4 preference: $_" "ERROR"
2026-01-11T19:28:13.8356159Z                          }
2026-01-11T19:28:13.8356379Z                      }
2026-01-11T19:28:13.8356640Z                      
2026-01-11T19:28:13.8356882Z                      
2026-01-11T19:28:13.8357200Z                      function Disable-Teredo {
2026-01-11T19:28:13.8357569Z                          <#
2026-01-11T19:28:13.8357877Z                          .SYNOPSIS
2026-01-11T19:28:13.8358324Z                              Optionally disables Teredo IPv6 tunneling.
2026-01-11T19:28:13.8358813Z                          .DESCRIPTION
2026-01-11T19:28:13.8359434Z                              Disables Teredo via netsh when requested. Requires reboot for full effect.
2026-01-11T19:28:13.8360364Z                          .PARAMETER Enable
2026-01-11T19:28:13.8360800Z                              When true, disables Teredo.
2026-01-11T19:28:13.8361211Z                          .OUTPUTS
2026-01-11T19:28:13.8361530Z                              None.
2026-01-11T19:28:13.8361873Z                          #>
2026-01-11T19:28:13.8362162Z                          param(
2026-01-11T19:28:13.8362529Z                              [bool]$Enable = $false
2026-01-11T19:28:13.8362903Z                          )
2026-01-11T19:28:13.8363165Z                      
2026-01-11T19:28:13.8363341Z                          if (-not $Enable) {
2026-01-11T19:28:13.8363629Z                              Write-Log "Teredo disable skipped" "INFO"
2026-01-11T19:28:13.8363899Z                              return
2026-01-11T19:28:13.8364501Z                          }
2026-01-11T19:28:13.8364857Z                      
2026-01-11T19:28:13.8365317Z                          try {
2026-01-11T19:28:13.8366447Z                              Write-Log "Disabling Teredo IPv6 tunneling..." "INFO"
2026-01-11T19:28:13.8367000Z                      
2026-01-11T19:28:13.8367450Z                              $result = netsh interface teredo set state disabled 2>&1
2026-01-11T19:28:13.8368211Z                              if ($LASTEXITCODE -eq 0) {
2026-01-11T19:28:13.8368776Z                                  Write-Log "Teredo disabled via netsh" "SUCCESS"
2026-01-11T19:28:13.8369184Z                              }
2026-01-11T19:28:13.8369529Z                      
2026-01-11T19:28:13.8370209Z                              $ipv6Path = "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters"
2026-01-11T19:28:13.8370798Z                              Backup-RegistryKey -Path $ipv6Path
2026-01-11T19:28:13.8371269Z                      
2026-01-11T19:28:13.8373075Z                              $currentValue = Get-RegistryValue -Path $ipv6Path -Name "DisabledComponents"
2026-01-11T19:28:13.8374235Z                              if ($null -eq $currentValue) { $currentValue = 0 }
2026-01-11T19:28:13.8374782Z                      
2026-01-11T19:28:13.8375144Z                              $newValue = $currentValue -bor 1
2026-01-11T19:28:13.8375990Z                              Set-RegistryValue -Path $ipv6Path -Name "DisabledComponents" -Value $newValue -Type 
2026-01-11T19:28:13.8376790Z                      "DWORD"
2026-01-11T19:28:13.8377102Z                      
2026-01-11T19:28:13.8377538Z                              Write-Log "Teredo IPv6 tunneling disabled" "SUCCESS"
2026-01-11T19:28:13.8378238Z                              Write-Log "Warning: May break Xbox Live connectivity" "INFO"
2026-01-11T19:28:13.8379228Z                              Write-Log "Requires reboot to take effect" "INFO"
2026-01-11T19:28:13.8379780Z                          } catch {
2026-01-11T19:28:13.8380257Z                              Write-Log "Error disabling Teredo: $_" "ERROR"
2026-01-11T19:28:13.8380776Z                          }
2026-01-11T19:28:13.8381052Z                      }
2026-01-11T19:28:13.8381327Z                      
2026-01-11T19:28:13.8381599Z                      
2026-01-11T19:28:13.8381934Z                      function Set-QoSConfiguration {
2026-01-11T19:28:13.8382348Z                          <#
2026-01-11T19:28:13.8382672Z                          .SYNOPSIS
2026-01-11T19:28:13.8382987Z                              Creates QoS policies for selected game executables.
2026-01-11T19:28:13.8383296Z                          .DESCRIPTION
2026-01-11T19:28:13.8383976Z                              Adds per-executable QoS policies with DSCP 46 for priority handling.
2026-01-11T19:28:13.8384918Z                          .PARAMETER GameExecutables
2026-01-11T19:28:13.8385456Z                              Executable names to target (e.g., cs2.exe).
2026-01-11T19:28:13.8385978Z                          .OUTPUTS
2026-01-11T19:28:13.8386688Z                              None.
2026-01-11T19:28:13.8387105Z                          #>
2026-01-11T19:28:13.8387427Z                          param(
2026-01-11T19:28:13.8388021Z                              [string[]]$GameExecutables = @("cs2.exe", "dota2.exe", "helldivers2.exe", 
2026-01-11T19:28:13.8388675Z                      "SpaceMarine2.exe")
2026-01-11T19:28:13.8389025Z                          )
2026-01-11T19:28:13.8389297Z                      
2026-01-11T19:28:13.8390604Z                          try {
2026-01-11T19:28:13.8391050Z                              Write-Log "Configuring QoS policies..." "INFO"
2026-01-11T19:28:13.8391519Z                      
2026-01-11T19:28:13.8391812Z                              foreach ($exe in $GameExecutables) {
2026-01-11T19:28:13.8392425Z                                  $qosPolicy = Get-NetQosPolicy -Name "Game-$exe" -ErrorAction SilentlyContinue
2026-01-11T19:28:13.8393058Z                                  if (-not $qosPolicy) {
2026-01-11T19:28:13.8394580Z                                      New-NetQosPolicy -Name "Game-$exe" -AppPathNameMatchCondition $exe -DSCPAction 46 
2026-01-11T19:28:13.8395497Z                      -NetworkProfile All -ErrorAction Stop | Out-Null
2026-01-11T19:28:13.8396166Z                                      Write-Log "Created QoS policy for $exe (DSCP 46)" "SUCCESS"
2026-01-11T19:28:13.8396505Z                                  } else {
2026-01-11T19:28:13.8396978Z                                      Write-Log "QoS policy for $exe already exists" "INFO"
2026-01-11T19:28:13.8397523Z                                  }
2026-01-11T19:28:13.8397862Z                              }
2026-01-11T19:28:13.8398165Z                      
2026-01-11T19:28:13.8398647Z                              Write-Log "QoS configuration complete" "SUCCESS"
2026-01-11T19:28:13.8399247Z                              Write-Log "NOTE: Requires router QoS/SQM support to be effective" "INFO"
2026-01-11T19:28:13.8399877Z                      
2026-01-11T19:28:13.8400147Z                          } catch {
2026-01-11T19:28:13.8400643Z                              Write-Log "Error configuring QoS (requires Windows Pro/Enterprise): $_" "ERROR"
2026-01-11T19:28:13.8401268Z                          }
2026-01-11T19:28:13.8401476Z                      }
2026-01-11T19:28:13.8401672Z                      
2026-01-11T19:28:13.8402925Z                      
2026-01-11T19:28:13.8403225Z                      
2026-01-11T19:28:13.8403530Z                      
2026-01-11T19:28:13.8404024Z                      function Enable-QoSGaming {
2026-01-11T19:28:13.8405715Z                          <#
2026-01-11T19:28:13.8406008Z                          .SYNOPSIS
2026-01-11T19:28:13.8407572Z                              Creates QoS policies to prioritize gaming network traffic.
2026-01-11T19:28:13.8408209Z                          .DESCRIPTION
2026-01-11T19:28:13.8408833Z                              Configures Windows QoS to mark gaming UDP traffic with high priority
2026-01-11T19:28:13.8409683Z                              DSCP values for better handling by routers that support QoS.
2026-01-11T19:28:13.8410272Z                          .PARAMETER Enable
2026-01-11T19:28:13.8410766Z                              When true, creates QoS policies for gaming traffic.
2026-01-11T19:28:13.8411306Z                          .PARAMETER GamePorts
2026-01-11T19:28:13.8411802Z                              UDP port ranges to mark with DSCP 46.
2026-01-11T19:28:13.8412265Z                          .OUTPUTS
2026-01-11T19:28:13.8412578Z                              None.
2026-01-11T19:28:13.8412924Z                          #>
2026-01-11T19:28:13.8413215Z                          param(
2026-01-11T19:28:13.8413569Z                              [bool]$Enable = $true,
2026-01-11T19:28:13.8414289Z                              [string[]]$GamePorts = @("27015-27030", "3478-3480", "7000-9000")  # Common game ports
2026-01-11T19:28:13.8415109Z                          )
2026-01-11T19:28:13.8415377Z                      
2026-01-11T19:28:13.8415676Z                          if (-not $Enable) {
2026-01-11T19:28:13.8416156Z                              Write-Log "QoS Gaming: skipped" "INFO"
2026-01-11T19:28:13.8416621Z                              return
2026-01-11T19:28:13.8416929Z                          }
2026-01-11T19:28:13.8417272Z                      
2026-01-11T19:28:13.8417824Z                          try {
2026-01-11T19:28:13.8418792Z                              # Remove existing gaming QoS policies first
2026-01-11T19:28:13.8419916Z                              Get-NetQosPolicy | Where-Object { $_.Name -like "RockTune-*" } | Remove-NetQosPolicy 
2026-01-11T19:28:13.8420777Z                      -Confirm:$false -ErrorAction SilentlyContinue
2026-01-11T19:28:13.8421229Z                      
2026-01-11T19:28:13.8421730Z                              # Create QoS policy for UDP gaming traffic with DSCP 46 (Expedited Forwarding)
2026-01-11T19:28:13.8422370Z                              foreach ($portRange in $GamePorts) {
2026-01-11T19:28:13.8423042Z                                  $policyName = "RockTune-Gaming-$($portRange -replace '-','to')"
2026-01-11T19:28:13.8423737Z                                  New-NetQosPolicy -Name $policyName `
2026-01-11T19:28:13.8424214Z                                      -NetworkProfile All `
2026-01-11T19:28:13.8424996Z                                      -IPProtocolMatchCondition UDP `
2026-01-11T19:28:13.8425529Z                                      -IPDstPortMatchCondition $portRange `
2026-01-11T19:28:13.8425968Z                                      -DSCPAction 46 `
2026-01-11T19:28:13.8426492Z                                      -ErrorAction SilentlyContinue | Out-Null
2026-01-11T19:28:13.8426963Z                              }
2026-01-11T19:28:13.8427294Z                      
2026-01-11T19:28:13.8427662Z                              # Create policy for common voice chat (Discord, etc.)
2026-01-11T19:28:13.8428321Z                              New-NetQosPolicy -Name "RockTune-VoiceChat" `
2026-01-11T19:28:13.8428906Z                                  -NetworkProfile All `
2026-01-11T19:28:13.8429598Z                                  -IPProtocolMatchCondition UDP `
2026-01-11T19:28:13.8430582Z                                  -IPDstPortMatchCondition "50000-50100" `
2026-01-11T19:28:13.8431114Z                                  -DSCPAction 46 `
2026-01-11T19:28:13.8431621Z                                  -ErrorAction SilentlyContinue | Out-Null
2026-01-11T19:28:13.8432072Z                      
2026-01-11T19:28:13.8432623Z                              Write-Log "QoS Gaming policies created (DSCP 46 for game traffic)" "SUCCESS"
2026-01-11T19:28:13.8433715Z                              Write-Log "Note: Router must support QoS for full benefit" "INFO"
2026-01-11T19:28:13.8434295Z                          } catch {
2026-01-11T19:28:13.8434690Z                              Write-Log "Error enabling QoS Gaming: $_" "ERROR"
2026-01-11T19:28:13.8435159Z                          }
2026-01-11T19:28:13.8435458Z                      }
2026-01-11T19:28:13.8435723Z                      
2026-01-11T19:28:13.8435957Z                      
2026-01-11T19:28:13.8436267Z                      function Disable-NetworkThrottling {
2026-01-11T19:28:13.8436707Z                          <#
2026-01-11T19:28:13.8436994Z                          .SYNOPSIS
2026-01-11T19:28:13.8437476Z                              Disables Windows network throttling mechanisms.
2026-01-11T19:28:13.8437952Z                          .DESCRIPTION
2026-01-11T19:28:13.8438302Z                              Removes the NetworkThrottlingIndex limit that Windows applies
2026-01-11T19:28:13.8438974Z                              to multimedia streaming to prevent network congestion.
2026-01-11T19:28:13.8439565Z                              This can improve network performance for games.
2026-01-11T19:28:13.8440128Z                          .PARAMETER Enable
2026-01-11T19:28:13.8440457Z                              When true, disables network throttling.
2026-01-11T19:28:13.8440888Z                          .OUTPUTS
2026-01-11T19:28:13.8441229Z                              None.
2026-01-11T19:28:13.8441546Z                          #>
2026-01-11T19:28:13.8441815Z                          param(
2026-01-11T19:28:13.8442170Z                              [bool]$Enable = $true
2026-01-11T19:28:13.8442582Z                          )
2026-01-11T19:28:13.8442872Z                      
2026-01-11T19:28:13.8443397Z                          if (-not $Enable) {
2026-01-11T19:28:13.8444876Z                              Write-Log "Disable network throttling: skipped" "INFO"
2026-01-11T19:28:13.8445925Z                              return
2026-01-11T19:28:13.8446271Z                          }
2026-01-11T19:28:13.8447407Z                      
2026-01-11T19:28:13.8447669Z                          try {
2026-01-11T19:28:13.8448388Z                              $mmcssPath = "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile"
2026-01-11T19:28:13.8449244Z                              Backup-RegistryKey -Path $mmcssPath
2026-01-11T19:28:13.8449593Z                      
2026-01-11T19:28:13.8449888Z                              # Set NetworkThrottlingIndex to maximum (0xFFFFFFFF = disabled)
2026-01-11T19:28:13.8450713Z                              Set-RegistryValue -Path $mmcssPath -Name "NetworkThrottlingIndex" -Value 0xFFFFFFFF -Type 
2026-01-11T19:28:13.8451376Z                      "DWORD"
2026-01-11T19:28:13.8451685Z                      
2026-01-11T19:28:13.8452267Z                              # Also set SystemResponsiveness to 0 for minimum reserved bandwidth
2026-01-11T19:28:13.8453430Z                              Set-RegistryValue -Path $mmcssPath -Name "SystemResponsiveness" -Value 0 -Type "DWORD"
2026-01-11T19:28:13.8454169Z                      
2026-01-11T19:28:13.8454689Z                              Write-Log "Disabled network throttling (maximum throughput)" "SUCCESS"
2026-01-11T19:28:13.8455511Z                          } catch {
2026-01-11T19:28:13.8455956Z                              Write-Log "Error disabling network throttling: $_" "ERROR"
2026-01-11T19:28:13.8456896Z                          }
2026-01-11T19:28:13.8457199Z                      }
2026-01-11T19:28:13.8457481Z                      
2026-01-11T19:28:13.8457639Z                      
2026-01-11T19:28:13.8457836Z                      function Set-TCPOptimizations {
2026-01-11T19:28:13.8458205Z                          <#
2026-01-11T19:28:13.8458772Z                          .SYNOPSIS
2026-01-11T19:28:13.8459927Z                              Optimizes TCP stack settings for gaming.
2026-01-11T19:28:13.8460671Z                          .DESCRIPTION
2026-01-11T19:28:13.8461241Z                              Configures TCP settings for lower latency gaming including
2026-01-11T19:28:13.8461869Z                              disabling Nagle's algorithm, optimizing ACK behavior, and
2026-01-11T19:28:13.8464216Z                              tuning window scaling.
2026-01-11T19:28:13.8465463Z                          .PARAMETER Enable
2026-01-11T19:28:13.8467032Z                              When true, applies TCP stack changes.
2026-01-11T19:28:13.8467533Z                          .OUTPUTS
2026-01-11T19:28:13.8468093Z                              None.
2026-01-11T19:28:13.8469173Z                          #>
2026-01-11T19:28:13.8469556Z                          param(
2026-01-11T19:28:13.8469857Z                              [bool]$Enable = $true
2026-01-11T19:28:13.8470280Z                          )
2026-01-11T19:28:13.8470654Z                      
2026-01-11T19:28:13.8471242Z                          if (-not $Enable) {
2026-01-11T19:28:13.8471802Z                              Write-Log "TCP optimizations: skipped" "INFO"
2026-01-11T19:28:13.8472367Z                              return
2026-01-11T19:28:13.8473285Z                          }
2026-01-11T19:28:13.8473593Z                      
2026-01-11T19:28:13.8474155Z                          try {
2026-01-11T19:28:13.8475006Z                              $tcpPath = "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters"
2026-01-11T19:28:13.8475656Z                              Backup-RegistryKey -Path $tcpPath
2026-01-11T19:28:13.8476062Z                      
2026-01-11T19:28:13.8476603Z                              # Disable Nagle's Algorithm globally (reduces latency)
2026-01-11T19:28:13.8477359Z                              Set-RegistryValue -Path $tcpPath -Name "TcpNoDelay" -Value 1 -Type "DWORD"
2026-01-11T19:28:13.8477998Z                      
2026-01-11T19:28:13.8478759Z                              # Reduce TCP ACK frequency for faster acknowledgments
2026-01-11T19:28:13.8479789Z                              Set-RegistryValue -Path $tcpPath -Name "TcpAckFrequency" -Value 1 -Type "DWORD"
2026-01-11T19:28:13.8480509Z                      
2026-01-11T19:28:13.8480946Z                              # Disable TCP/IP auto-tuning for more predictable behavior
2026-01-11T19:28:13.8481707Z                              netsh int tcp set global autotuninglevel=disabled 2>&1 | Out-Null
2026-01-11T19:28:13.8482300Z                      
2026-01-11T19:28:13.8482859Z                              # Disable ECN (Explicit Congestion Notification) - can cause issues with some games
2026-01-11T19:28:13.8484010Z                              netsh int tcp set global ecncapability=disabled 2>&1 | Out-Null
2026-01-11T19:28:13.8484570Z                      
2026-01-11T19:28:13.8484940Z                              # Disable timestamps for slightly lower overhead
2026-01-11T19:28:13.8485605Z                              netsh int tcp set global timestamps=disabled 2>&1 | Out-Null
2026-01-11T19:28:13.8486312Z                      
2026-01-11T19:28:13.8486814Z                              # Set higher initial RTO (Retransmission Timeout) for stable connections
2026-01-11T19:28:13.8487548Z                              netsh int tcp set global initialRto=2000 2>&1 | Out-Null
2026-01-11T19:28:13.8488045Z                      
2026-01-11T19:28:13.8488564Z                              Write-Log "TCP stack optimized for gaming (Nagle off, fast ACK)" "SUCCESS"
2026-01-11T19:28:13.8489185Z                          } catch {
2026-01-11T19:28:13.8489648Z                              Write-Log "Error applying TCP optimizations: $_" "ERROR"
2026-01-11T19:28:13.8490156Z                          }
2026-01-11T19:28:13.8490422Z                      }
2026-01-11T19:28:13.8490664Z                      
2026-01-11T19:28:13.8490990Z                      
2026-01-11T19:28:13.8491320Z                      function Remove-NetworkBindings {
2026-01-11T19:28:13.8491991Z                          <#
2026-01-11T19:28:13.8492278Z                          .SYNOPSIS
2026-01-11T19:28:13.8492805Z                              Strips unnecessary network protocol bindings for minimal overhead.
2026-01-11T19:28:13.8493398Z                          .DESCRIPTION
2026-01-11T19:28:13.8493938Z                              FR33THY optimization - Removes non-essential network bindings from
2026-01-11T19:28:13.8494715Z                              active adapters including IPv6, file/printer sharing, LLDP, QoS,
2026-01-11T19:28:13.8495467Z                              and network discovery protocols. Leaves only IPv4 for pure gaming.
2026-01-11T19:28:13.8496018Z                      
2026-01-11T19:28:13.8496489Z                              WARNING: This breaks file sharing, printer sharing, network discovery,
2026-01-11T19:28:13.8497307Z                              and some enterprise features. Only use for dedicated gaming machines.
2026-01-11T19:28:13.8497912Z                          .PARAMETER Enable
2026-01-11T19:28:13.8498296Z                              When true, strips network bindings.
2026-01-11T19:28:13.8498562Z                          .OUTPUTS
2026-01-11T19:28:13.8499122Z                              None.
2026-01-11T19:28:13.8499464Z                          .NOTES
2026-01-11T19:28:13.8499948Z                              RISKY: Breaks file/printer sharing and network discovery.
2026-01-11T19:28:13.8501163Z                              Recommended only for dedicated gaming PCs without local network sharing needs.
2026-01-11T19:28:13.8502083Z                          #>
2026-01-11T19:28:13.8502947Z                          param(
2026-01-11T19:28:13.8503291Z                              [bool]$Enable = $true
2026-01-11T19:28:13.8503529Z                          )
2026-01-11T19:28:13.8503703Z                      
2026-01-11T19:28:13.8504058Z                          if (-not $Enable) {
2026-01-11T19:28:13.8504550Z                              Write-Log "Network binding strip: skipped" "INFO"
2026-01-11T19:28:13.8505235Z                              return
2026-01-11T19:28:13.8505773Z                          }
2026-01-11T19:28:13.8506717Z                      
2026-01-11T19:28:13.8507734Z                          try {
2026-01-11T19:28:13.8508504Z                              Write-Log "WARNING: Stripping network bindings breaks file/printer sharing!" "WARNING"
2026-01-11T19:28:13.8509215Z                      
2026-01-11T19:28:13.8509775Z                              # Network bindings to disable (keep only IPv4)
2026-01-11T19:28:13.8510267Z                              $bindingsToDisable = @(
2026-01-11T19:28:13.8511049Z                                  "ms_lldp",      # Link Layer Discovery Protocol
2026-01-11T19:28:13.8511658Z                                  "ms_lltdio",    # Link Layer Topology Discovery I/O
2026-01-11T19:28:13.8512435Z                                  "ms_implat",    # Microsoft Network Adapter Multiplexor Protocol
2026-01-11T19:28:13.8513182Z                                  "ms_rspndr",    # Link Layer Topology Discovery Responder
2026-01-11T19:28:13.8513763Z                                  "ms_tcpip6",    # IPv6
2026-01-11T19:28:13.8514254Z                                  "ms_server",    # File and Printer Sharing
2026-01-11T19:28:13.8514642Z                                  "ms_msclient",  # Client for Microsoft Networks
2026-01-11T19:28:13.8514979Z                                  "ms_pacer"      # QoS Packet Scheduler
2026-01-11T19:28:13.8515431Z                              )
2026-01-11T19:28:13.8515731Z                      
2026-01-11T19:28:13.8516069Z                              # Get active network adapters
2026-01-11T19:28:13.8516841Z                              $adapters = Get-NetAdapter | Where-Object { $_.Status -eq "Up" }
2026-01-11T19:28:13.8517424Z                              $totalDisabled = 0
2026-01-11T19:28:13.8517765Z                      
2026-01-11T19:28:13.8518348Z                              foreach ($adapter in $adapters) {
2026-01-11T19:28:13.8518850Z                                  foreach ($binding in $bindingsToDisable) {
2026-01-11T19:28:13.8519142Z                                      try {
2026-01-11T19:28:13.8519918Z                                          $currentBinding = Get-NetAdapterBinding -Name $adapter.Name -ComponentID 
2026-01-11T19:28:13.8520539Z                      $binding -ErrorAction SilentlyContinue
2026-01-11T19:28:13.8521541Z                                          if ($currentBinding -and $currentBinding.Enabled) {
2026-01-11T19:28:13.8522433Z                                              Disable-NetAdapterBinding -Name $adapter.Name -ComponentID $binding 
2026-01-11T19:28:13.8523389Z                      -ErrorAction Stop
2026-01-11T19:28:13.8523838Z                                              $totalDisabled++
2026-01-11T19:28:13.8524232Z                                          }
2026-01-11T19:28:13.8524619Z                                      } catch {
2026-01-11T19:28:13.8525083Z                                          # Binding may not exist on this adapter
2026-01-11T19:28:13.8525531Z                                      }
2026-01-11T19:28:13.8526133Z                                  }
2026-01-11T19:28:13.8526461Z                              }
2026-01-11T19:28:13.8526775Z                      
2026-01-11T19:28:13.8527122Z                              if ($totalDisabled -gt 0) {
2026-01-11T19:28:13.8527782Z                                  Write-Log "Stripped $totalDisabled network bindings (IPv4 only mode)" "SUCCESS"
2026-01-11T19:28:13.8528767Z                                  Write-Log "Disabled: IPv6, File Sharing, Network Discovery, QoS" "INFO"
2026-01-11T19:28:13.8529439Z                              } else {
2026-01-11T19:28:13.8530044Z                                  Write-Log "No network bindings modified (may already be stripped)" "INFO"
2026-01-11T19:28:13.8530730Z                              }
2026-01-11T19:28:13.8531061Z                      
2026-01-11T19:28:13.8531334Z                          } catch {
2026-01-11T19:28:13.8531803Z                              Write-Log "Error stripping network bindings: $_" "ERROR"
2026-01-11T19:28:13.8532267Z                          }
2026-01-11T19:28:13.8532537Z                      }
2026-01-11T19:28:13.8532819Z                      
2026-01-11T19:28:13.8533093Z                      
2026-01-11T19:28:13.8533493Z                      function Set-NetworkAdapterAdvancedSettings {
2026-01-11T19:28:13.8533995Z                          <#
2026-01-11T19:28:13.8534288Z                          .SYNOPSIS
2026-01-11T19:28:13.8534952Z                              Configures network adapter Device Manager advanced properties for gaming.
2026-01-11T19:28:13.8535564Z                          .DESCRIPTION
2026-01-11T19:28:13.8536210Z                              Disables Interrupt Moderation, Flow Control, Energy Efficient Ethernet,
2026-01-11T19:28:13.8537071Z                              and optionally disables LSO and maximizes buffers for pro gamers.
2026-01-11T19:28:13.8538068Z                              These are the settings typically found in Device Manager > Network Adapter > Advanced tab.
2026-01-11T19:28:13.8538928Z                          .PARAMETER DisableInterruptModeration
2026-01-11T19:28:13.8539651Z                              Disables interrupt moderation for lower latency (slight CPU increase).
2026-01-11T19:28:13.8540083Z                          .PARAMETER DisableFlowControl
2026-01-11T19:28:13.8540479Z                              Disables flow control (no network pausing).
2026-01-11T19:28:13.8540959Z                          .PARAMETER DisableEEE
2026-01-11T19:28:13.8541534Z                              Disables Energy Efficient Ethernet (prevents wake latency).
2026-01-11T19:28:13.8542157Z                          .PARAMETER DisableLSO
2026-01-11T19:28:13.8542774Z                              Disables Large Send Offload v1/v2 (opt-in for pro_gamer, increases CPU).
2026-01-11T19:28:13.8543781Z                          .PARAMETER MaximizeBuffers
2026-01-11T19:28:13.8544406Z                              Sets Receive/Transmit buffers to maximum (opt-in for pro_gamer).
2026-01-11T19:28:13.8545015Z                          .OUTPUTS
2026-01-11T19:28:13.8545247Z                              None.
2026-01-11T19:28:13.8545441Z                          .NOTES
2026-01-11T19:28:13.8545878Z                              Property names vary by NIC vendor (Intel, Realtek, Killer, etc.).
2026-01-11T19:28:13.8546742Z                              This function attempts multiple common property names for compatibility.
2026-01-11T19:28:13.8547324Z                          #>
2026-01-11T19:28:13.8547676Z                          param(
2026-01-11T19:28:13.8548103Z                              [bool]$DisableInterruptModeration = $true,
2026-01-11T19:28:13.8548632Z                              [bool]$DisableFlowControl = $true,
2026-01-11T19:28:13.8549148Z                              [bool]$DisableEEE = $true,
2026-01-11T19:28:13.8549569Z                              [bool]$DisableLSO = $false,
2026-01-11T19:28:13.8550036Z                              [bool]$MaximizeBuffers = $false
2026-01-11T19:28:13.8551965Z                          )
2026-01-11T19:28:13.8552212Z                      
2026-01-11T19:28:13.8552385Z                          try {
2026-01-11T19:28:13.8552828Z                              $adapter = Get-ActiveNetworkAdapter
2026-01-11T19:28:13.8553334Z                              if (-not $adapter) { return }
2026-01-11T19:28:13.8553719Z                      
2026-01-11T19:28:13.8554077Z                              Write-Log "Configuring network adapter advanced properties..." "INFO"
2026-01-11T19:28:13.8554476Z                      
2026-01-11T19:28:13.8554909Z                              # Helper function to set adapter property with fallback names
2026-01-11T19:28:13.8555540Z                              function Set-AdapterProperty {
2026-01-11T19:28:13.8555977Z                                  param(
2026-01-11T19:28:13.8556374Z                                      [string]$AdapterName,
2026-01-11T19:28:13.8556833Z                                      [string[]]$PropertyNames,
2026-01-11T19:28:13.8557306Z                                      [string]$Value,
2026-01-11T19:28:13.8557738Z                                      [string]$Description
2026-01-11T19:28:13.8558118Z                                  )
2026-01-11T19:28:13.8558435Z                      
2026-01-11T19:28:13.8558838Z                                  $set = $false
2026-01-11T19:28:13.8560098Z                                  foreach ($propName in $PropertyNames) {
2026-01-11T19:28:13.8560940Z                                      try {
2026-01-11T19:28:13.8561666Z                                          $currentProp = Get-NetAdapterAdvancedProperty -Name $AdapterName 
2026-01-11T19:28:13.8562387Z                      -RegistryKeyword $propName -ErrorAction SilentlyContinue
2026-01-11T19:28:13.8562747Z                                          if ($currentProp) {
2026-01-11T19:28:13.8563581Z                                              Set-NetAdapterAdvancedProperty -Name $AdapterName -RegistryKeyword 
2026-01-11T19:28:13.8564732Z                      $propName -RegistryValue $Value -ErrorAction Stop
2026-01-11T19:28:13.8565182Z                                              Write-Log "$Description set to $Value" "SUCCESS"
2026-01-11T19:28:13.8565745Z                                              $set = $true
2026-01-11T19:28:13.8566022Z                                              break
2026-01-11T19:28:13.8566596Z                                          }
2026-01-11T19:28:13.8567260Z                                      } catch {
2026-01-11T19:28:13.8567677Z                                          # Try next property name
2026-01-11T19:28:13.8568298Z                                      }
2026-01-11T19:28:13.8569190Z                                  }
2026-01-11T19:28:13.8569524Z                      
2026-01-11T19:28:13.8570130Z                                  if (-not $set) {
2026-01-11T19:28:13.8571023Z                                      Write-Log "$Description not found on this adapter (may not support it)" "INFO"
2026-01-11T19:28:13.8571716Z                                  }
2026-01-11T19:28:13.8572059Z                              }
2026-01-11T19:28:13.8572697Z                      
2026-01-11T19:28:13.8572996Z                              # Interrupt Moderation
2026-01-11T19:28:13.8573425Z                              if ($DisableInterruptModeration) {
2026-01-11T19:28:13.8574196Z                                  Set-AdapterProperty -AdapterName $adapter.Name `
2026-01-11T19:28:13.8574982Z                                      -PropertyNames @("*InterruptModeration", "ITR") `
2026-01-11T19:28:13.8575520Z                                      -Value "0" `
2026-01-11T19:28:13.8576012Z                                      -Description "Interrupt Moderation"
2026-01-11T19:28:13.8576764Z                              }
2026-01-11T19:28:13.8577080Z                      
2026-01-11T19:28:13.8577361Z                              # Flow Control
2026-01-11T19:28:13.8578100Z                              if ($DisableFlowControl) {
2026-01-11T19:28:13.8578667Z                                  Set-AdapterProperty -AdapterName $adapter.Name `
2026-01-11T19:28:13.8579256Z                                      -PropertyNames @("*FlowControl", "FlowControl") `
2026-01-11T19:28:13.8579830Z                                      -Value "0" `
2026-01-11T19:28:13.8580289Z                                      -Description "Flow Control"
2026-01-11T19:28:13.8580750Z                              }
2026-01-11T19:28:13.8581062Z                      
2026-01-11T19:28:13.8581790Z                              # Energy Efficient Ethernet
2026-01-11T19:28:13.8582761Z                              if ($DisableEEE) {
2026-01-11T19:28:13.8583276Z                                  Set-AdapterProperty -AdapterName $adapter.Name `
2026-01-11T19:28:13.8584730Z                                      -PropertyNames @("EEELinkAdvertisement", "EnergyEfficientEthernet", 
2026-01-11T19:28:13.8585394Z                      "GreenEthernet", "*EEE") `
2026-01-11T19:28:13.8585727Z                                      -Value "0" `
2026-01-11T19:28:13.8586456Z                                      -Description "Energy Efficient Ethernet"
2026-01-11T19:28:13.8586930Z                              }
2026-01-11T19:28:13.8587499Z                      
2026-01-11T19:28:13.8589042Z                              # Large Send Offload (opt-in for pro gamers)
2026-01-11T19:28:13.8590001Z                              if ($DisableLSO) {
2026-01-11T19:28:13.8590523Z                                  Set-AdapterProperty -AdapterName $adapter.Name `
2026-01-11T19:28:13.8591169Z                                      -PropertyNames @("*LsoV2IPv4") `
2026-01-11T19:28:13.8591698Z                                      -Value "0" `
2026-01-11T19:28:13.8592283Z                                      -Description "Large Send Offload v2 (IPv4)"
2026-01-11T19:28:13.8592733Z                      
2026-01-11T19:28:13.8593182Z                                  Set-AdapterProperty -AdapterName $adapter.Name `
2026-01-11T19:28:13.8593789Z                                      -PropertyNames @("*LsoV2IPv6") `
2026-01-11T19:28:13.8594258Z                                      -Value "0" `
2026-01-11T19:28:13.8594701Z                                      -Description "Large Send Offload v2 (IPv6)"
2026-01-11T19:28:13.8595165Z                              }
2026-01-11T19:28:13.8595471Z                      
2026-01-11T19:28:13.8596106Z                              # Maximize Buffers (opt-in for pro gamers)
2026-01-11T19:28:13.8596642Z                              if ($MaximizeBuffers) {
2026-01-11T19:28:13.8596843Z                                  # Try to set buffers to maximum supported value
2026-01-11T19:28:13.8599171Z                                  try {
2026-01-11T19:28:13.8599744Z                                      $rxBuffer = Get-NetAdapterAdvancedProperty -Name $adapter.Name -RegistryKeyword 
2026-01-11T19:28:13.8599975Z                      "*ReceiveBuffers" -ErrorAction SilentlyContinue
2026-01-11T19:28:13.8600124Z                                      if ($rxBuffer) {
2026-01-11T19:28:13.8600335Z                                          # Get max value from ValidDisplayValues
2026-01-11T19:28:13.8600705Z                                          $maxRx = ($rxBuffer.ValidDisplayValues | Measure-Object -Maximum).Maximum
2026-01-11T19:28:13.8600912Z                                          if ($maxRx) {
2026-01-11T19:28:13.8602527Z                                              Set-NetAdapterAdvancedProperty -Name $adapter.Name -RegistryKeyword 
2026-01-11T19:28:13.8603126Z                      "*ReceiveBuffers" -RegistryValue $maxRx -ErrorAction Stop
2026-01-11T19:28:13.8603468Z                                              Write-Log "Receive Buffers set to maximum ($maxRx)" "SUCCESS"
2026-01-11T19:28:13.8603627Z                                          }
2026-01-11T19:28:13.8605730Z                                      }
2026-01-11T19:28:13.8606111Z                                  } catch {
2026-01-11T19:28:13.8607135Z                                      Write-Log "Could not maximize Receive Buffers" "INFO"
2026-01-11T19:28:13.8607505Z                                  }
2026-01-11T19:28:13.8608583Z                      
2026-01-11T19:28:13.8608700Z                                  try {
2026-01-11T19:28:13.8610346Z                                      $txBuffer = Get-NetAdapterAdvancedProperty -Name $adapter.Name -RegistryKeyword 
2026-01-11T19:28:13.8610620Z                      "*TransmitBuffers" -ErrorAction SilentlyContinue
2026-01-11T19:28:13.8611306Z                                      if ($txBuffer) {
2026-01-11T19:28:13.8612911Z                                          $maxTx = ($txBuffer.ValidDisplayValues | Measure-Object -Maximum).Maximum
2026-01-11T19:28:13.8613062Z                                          if ($maxTx) {
2026-01-11T19:28:13.8614318Z                                              Set-NetAdapterAdvancedProperty -Name $adapter.Name -RegistryKeyword 
2026-01-11T19:28:13.8614604Z                      "*TransmitBuffers" -RegistryValue $maxTx -ErrorAction Stop
2026-01-11T19:28:13.8614962Z                                              Write-Log "Transmit Buffers set to maximum ($maxTx)" "SUCCESS"
2026-01-11T19:28:13.8615152Z                                          }
2026-01-11T19:28:13.8615589Z                                      }
2026-01-11T19:28:13.8616615Z                                  } catch {
2026-01-11T19:28:13.8616867Z                                      Write-Log "Could not maximize Transmit Buffers" "INFO"
2026-01-11T19:28:13.8616971Z                                  }
2026-01-11T19:28:13.8617948Z                              }
2026-01-11T19:28:13.8618062Z                      
2026-01-11T19:28:13.8619519Z                              Write-Log "Network adapter advanced properties configured" "SUCCESS"
2026-01-11T19:28:13.8620136Z                              Write-Log "Note: Changes may require network adapter restart to take effect" "INFO"
2026-01-11T19:28:13.8620247Z                      
2026-01-11T19:28:13.8620601Z                          } catch {
2026-01-11T19:28:13.8622286Z                              Write-Log "Error configuring network adapter advanced properties: $_" "ERROR"
2026-01-11T19:28:13.8622382Z                              throw
2026-01-11T19:28:13.8623377Z                          }
2026-01-11T19:28:13.8624038Z                      }
2026-01-11T19:28:13.8625016Z                      
2026-01-11T19:28:13.8625213Z                      
2026-01-11T19:28:13.8626630Z                      function Test-NetworkAdapterAdvancedSettings {
2026-01-11T19:28:13.8626943Z                          <#
2026-01-11T19:28:13.8628754Z                          .SYNOPSIS
2026-01-11T19:28:13.8629387Z                              Verifies network adapter advanced property settings.
2026-01-11T19:28:13.8629522Z                          .DESCRIPTION
2026-01-11T19:28:13.8630025Z                              Checks that Interrupt Moderation, Flow Control, and EEE are disabled.
2026-01-11T19:28:13.8630414Z                          .OUTPUTS
2026-01-11T19:28:13.8630927Z                              [bool] True when checks pass, else false.
2026-01-11T19:28:13.8632005Z                          #>
2026-01-11T19:28:13.8632305Z                          $allPassed = $true
2026-01-11T19:28:13.8633070Z                      
2026-01-11T19:28:13.8634368Z                          Write-Log "Verifying network adapter advanced settings..." "INFO"
2026-01-11T19:28:13.8634644Z                      
2026-01-11T19:28:13.8635550Z                          try {
2026-01-11T19:28:13.8636371Z                              $adapter = Get-ActiveNetworkAdapter
2026-01-11T19:28:13.8637452Z                              if (-not $adapter) { return $false }
2026-01-11T19:28:13.8637730Z                      
2026-01-11T19:28:13.8638187Z                              function Check-AdapterProperty {
2026-01-11T19:28:13.8639093Z                                  param(
2026-01-11T19:28:13.8640171Z                                      [string]$AdapterName,
2026-01-11T19:28:13.8640358Z                                      [string[]]$PropertyNames,
2026-01-11T19:28:13.8640747Z                                      [string]$ExpectedValue,
2026-01-11T19:28:13.8641979Z                                      [string]$Description
2026-01-11T19:28:13.8642225Z                                  )
2026-01-11T19:28:13.8643274Z                      
2026-01-11T19:28:13.8643837Z                                  foreach ($propName in $PropertyNames) {
2026-01-11T19:28:13.8644565Z                                      try {
2026-01-11T19:28:13.8645930Z                                          $prop = Get-NetAdapterAdvancedProperty -Name $AdapterName -RegistryKeyword 
2026-01-11T19:28:13.8646117Z                      $propName -ErrorAction SilentlyContinue
2026-01-11T19:28:13.8646704Z                                          if ($prop) {
2026-01-11T19:28:13.8647953Z                                              if ($prop.RegistryValue -eq $ExpectedValue) {
2026-01-11T19:28:13.8648586Z                                                  Write-Log "‚úì $Description disabled" "SUCCESS"
2026-01-11T19:28:13.8648751Z                                                  return $true
2026-01-11T19:28:13.8648859Z                                              } else {
2026-01-11T19:28:13.8650629Z                                                  Write-Log "‚úó $Description not disabled (current: 
2026-01-11T19:28:13.8650802Z                      $($prop.RegistryValue))" "ERROR"
2026-01-11T19:28:13.8651285Z                                                  return $false
2026-01-11T19:28:13.8651434Z                                              }
2026-01-11T19:28:13.8652494Z                                          }
2026-01-11T19:28:13.8652633Z                                      } catch {
2026-01-11T19:28:13.8653688Z                                          # Try next property name
2026-01-11T19:28:13.8653809Z                                      }
2026-01-11T19:28:13.8654922Z                                  }
2026-01-11T19:28:13.8655019Z                      
2026-01-11T19:28:13.8656142Z                                  Write-Log "‚óã $Description not found on this adapter" "INFO"
2026-01-11T19:28:13.8656630Z                                  return $true  # Don't fail if property doesn't exist
2026-01-11T19:28:13.8657128Z                              }
2026-01-11T19:28:13.8657907Z                      
2026-01-11T19:28:13.8659152Z                              if (-not (Check-AdapterProperty -AdapterName $adapter.Name -PropertyNames 
2026-01-11T19:28:13.8659842Z                      @("*InterruptModeration", "ITR") -ExpectedValue "0" -Description "Interrupt Moderation")) {
2026-01-11T19:28:13.8660013Z                                  $allPassed = $false
2026-01-11T19:28:13.8660121Z                              }
2026-01-11T19:28:13.8660223Z                      
2026-01-11T19:28:13.8661672Z                              if (-not (Check-AdapterProperty -AdapterName $adapter.Name -PropertyNames 
2026-01-11T19:28:13.8662414Z                      @("*FlowControl") -ExpectedValue "0" -Description "Flow Control")) {
2026-01-11T19:28:13.8662722Z                                  $allPassed = $false
2026-01-11T19:28:13.8662831Z                              }
2026-01-11T19:28:13.8663282Z                      
2026-01-11T19:28:13.8664824Z                              if (-not (Check-AdapterProperty -AdapterName $adapter.Name -PropertyNames 
2026-01-11T19:28:13.8665214Z                      @("EEELinkAdvertisement", "EnergyEfficientEthernet", "GreenEthernet") -ExpectedValue "0" 
2026-01-11T19:28:13.8665633Z                      -Description "Energy Efficient Ethernet")) {
2026-01-11T19:28:13.8666032Z                                  $allPassed = $false
2026-01-11T19:28:13.8666481Z                              }
2026-01-11T19:28:13.8667593Z                      
2026-01-11T19:28:13.8667800Z                          } catch {
2026-01-11T19:28:13.8669259Z                              Write-Log "Error verifying adapter settings: $_" "ERROR"
2026-01-11T19:28:13.8669392Z                              return $false
2026-01-11T19:28:13.8669710Z                          }
2026-01-11T19:28:13.8670849Z                      
2026-01-11T19:28:13.8670980Z                          return $allPassed
2026-01-11T19:28:13.8671361Z                      }
2026-01-11T19:28:13.8672232Z                      
2026-01-11T19:28:13.8673011Z                      
2026-01-11T19:28:13.8673824Z                      function Invoke-NetworkOptimizations {
2026-01-11T19:28:13.8674523Z                          <#
2026-01-11T19:28:13.8675405Z                          .SYNOPSIS
2026-01-11T19:28:13.8676244Z                              Applies the full network optimization set.
2026-01-11T19:28:13.8677234Z                          .DESCRIPTION
2026-01-11T19:28:13.8678220Z                              Tunes adapter settings, DNS, IPv4/Teredo, and optional QoS policies.
2026-01-11T19:28:13.8678400Z                          .PARAMETER DNSProvider
2026-01-11T19:28:13.8680015Z                              DNS provider to apply (cloudflare, google, quad9, adguard, opendns, isp).
2026-01-11T19:28:13.8680549Z                          .PARAMETER DisableRSC
2026-01-11T19:28:13.8680790Z                              Disables Receive Segment Coalescing when true.
2026-01-11T19:28:13.8681240Z                          .PARAMETER PreferIPv4
2026-01-11T19:28:13.8682519Z                              Prefers IPv4 over IPv6 when true.
2026-01-11T19:28:13.8682697Z                          .PARAMETER DisableTeredo
2026-01-11T19:28:13.8683757Z                              Disables Teredo tunneling when true.
2026-01-11T19:28:13.8684249Z                          .PARAMETER EnableQoS
2026-01-11T19:28:13.8684836Z                              Enables per-game QoS policies when true.
2026-01-11T19:28:13.8685747Z                          .PARAMETER GameExecutables
2026-01-11T19:28:13.8686802Z                              Executable names for per-game QoS policy creation.
2026-01-11T19:28:13.8687859Z                          .PARAMETER EnableAdapterAdvanced
2026-01-11T19:28:13.8688571Z                              Enables network adapter advanced property optimizations when true.
2026-01-11T19:28:13.8688731Z                          .PARAMETER DisableLSO
2026-01-11T19:28:13.8689289Z                              Disables LSO when adapter advanced settings are enabled (opt-in).
2026-01-11T19:28:13.8689498Z                          .PARAMETER MaximizeBuffers
2026-01-11T19:28:13.8691094Z                              Maximizes adapter buffers when adapter advanced settings are enabled (opt-in).
2026-01-11T19:28:13.8691230Z                          .OUTPUTS
2026-01-11T19:28:13.8691565Z                              None.
2026-01-11T19:28:13.8692850Z                          #>
2026-01-11T19:28:13.8693055Z                          param(
2026-01-11T19:28:13.8694697Z                              [ValidateSet("cloudflare", "google", "quad9", "adguard", "opendns", "isp")]
2026-01-11T19:28:13.8694934Z                              [string]$DNSProvider = "cloudflare",
2026-01-11T19:28:13.8695248Z                      
2026-01-11T19:28:13.8695650Z                              [bool]$DisableRSC = $false,
2026-01-11T19:28:13.8696453Z                      
2026-01-11T19:28:13.8696737Z                              [bool]$PreferIPv4 = $false,
2026-01-11T19:28:13.8697626Z                      
2026-01-11T19:28:13.8698567Z                              [bool]$DisableTeredo = $false,
2026-01-11T19:28:13.8698971Z                      
2026-01-11T19:28:13.8699947Z                              [bool]$EnableQoS = $false,
2026-01-11T19:28:13.8700404Z                      
2026-01-11T19:28:13.8701522Z                              [string[]]$GameExecutables = @("cs2.exe", "dota2.exe", "helldivers2.exe", 
2026-01-11T19:28:13.8701952Z                      "SpaceMarine2.exe"),
2026-01-11T19:28:13.8702052Z                      
2026-01-11T19:28:13.8703127Z                              [bool]$EnableAdapterAdvanced = $true,
2026-01-11T19:28:13.8703222Z                      
2026-01-11T19:28:13.8704277Z                              [bool]$DisableLSO = $false,
2026-01-11T19:28:13.8704698Z                      
2026-01-11T19:28:13.8705644Z                              [bool]$MaximizeBuffers = $false
2026-01-11T19:28:13.8705749Z                          )
2026-01-11T19:28:13.8706739Z                      
2026-01-11T19:28:13.8707057Z                          Write-Log "Applying network optimizations..." "INFO"
2026-01-11T19:28:13.8707659Z                      
2026-01-11T19:28:13.8708177Z                          try {
2026-01-11T19:28:13.8709396Z                              Set-NetworkAdapterOptimizations -DisableRSC $DisableRSC
2026-01-11T19:28:13.8709503Z                      
2026-01-11T19:28:13.8710499Z                              if ($EnableAdapterAdvanced) {
2026-01-11T19:28:13.8710730Z                                  Set-NetworkAdapterAdvancedSettings `
2026-01-11T19:28:13.8711781Z                                      -DisableInterruptModeration $true `
2026-01-11T19:28:13.8712317Z                                      -DisableFlowControl $true `
2026-01-11T19:28:13.8713427Z                                      -DisableEEE $true `
2026-01-11T19:28:13.8713605Z                                      -DisableLSO $DisableLSO `
2026-01-11T19:28:13.8713993Z                                      -MaximizeBuffers $MaximizeBuffers
2026-01-11T19:28:13.8714953Z                              }
2026-01-11T19:28:13.8715289Z                      
2026-01-11T19:28:13.8716607Z                              Set-DNSProvider -Provider $DNSProvider
2026-01-11T19:28:13.8717003Z                      
2026-01-11T19:28:13.8718146Z                              Set-IPv4Preference -Enable $PreferIPv4
2026-01-11T19:28:13.8718259Z                      
2026-01-11T19:28:13.8719364Z                              Disable-Teredo -Enable $DisableTeredo
2026-01-11T19:28:13.8719472Z                      
2026-01-11T19:28:13.8720394Z                              if ($EnableQoS) {
2026-01-11T19:28:13.8720741Z                                  Set-QoSConfiguration -GameExecutables $GameExecutables
2026-01-11T19:28:13.8721729Z                              }
2026-01-11T19:28:13.8722658Z                      
2026-01-11T19:28:13.8723599Z                              Write-Log "Network optimizations complete" "SUCCESS"
2026-01-11T19:28:13.8724443Z                      
2026-01-11T19:28:13.8724553Z                          } catch {
2026-01-11T19:28:13.8726194Z                              Write-Log "Error applying network optimizations: $_" "ERROR"
2026-01-11T19:28:13.8726317Z                              throw
2026-01-11T19:28:13.8726429Z                          }
2026-01-11T19:28:13.8727326Z                      }
2026-01-11T19:28:13.8727801Z                      
2026-01-11T19:28:13.8728584Z                      
2026-01-11T19:28:13.8729643Z                      function Undo-NetworkOptimizations {
2026-01-11T19:28:13.8729929Z                          <#
2026-01-11T19:28:13.8730963Z                          .SYNOPSIS
2026-01-11T19:28:13.8731148Z                              Reverts network-related changes.
2026-01-11T19:28:13.8732238Z                          .DESCRIPTION
2026-01-11T19:28:13.8732930Z                              Resets DNS to DHCP, restores IPv6 defaults, removes QoS policies,
2026-01-11T19:28:13.8733176Z                              and restores TCP/IP registry settings.
2026-01-11T19:28:13.8733490Z                          .OUTPUTS
2026-01-11T19:28:13.8734572Z                              None.
2026-01-11T19:28:13.8734676Z                          #>
2026-01-11T19:28:13.8735913Z                          Write-Log "Rolling back network optimizations..." "INFO"
2026-01-11T19:28:13.8736234Z                      
2026-01-11T19:28:13.8737210Z                          try {
2026-01-11T19:28:13.8737415Z                              $adapter = Get-ActiveNetworkAdapter
2026-01-11T19:28:13.8738350Z                              if ($adapter) {
2026-01-11T19:28:13.8739541Z                                  Set-DnsClientServerAddress -InterfaceIndex $adapter.InterfaceIndex 
2026-01-11T19:28:13.8740012Z                      -ResetServerAddresses
2026-01-11T19:28:13.8740373Z                                  Write-Log "Restored ISP default DNS" "SUCCESS"
2026-01-11T19:28:13.8741447Z                              }
2026-01-11T19:28:13.8741580Z                      
2026-01-11T19:28:13.8742517Z                              try {
2026-01-11T19:28:13.8743417Z                                  Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters" 
2026-01-11T19:28:13.8744621Z                      -Name "DisabledComponents" -Value 0 -ErrorAction SilentlyContinue
2026-01-11T19:28:13.8745606Z                                  Write-Log "Restored IPv6 component defaults" "SUCCESS"
2026-01-11T19:28:13.8746395Z                              } catch {}
2026-01-11T19:28:13.8747385Z                      
2026-01-11T19:28:13.8748449Z                              try { netsh interface teredo set state default 2>&1 | Out-Null } catch {}
2026-01-11T19:28:13.8748590Z                      
2026-01-11T19:28:13.8750067Z                              $qosPolicies = Get-NetQosPolicy | Where-Object { $_.Name -like "Game-*" }
2026-01-11T19:28:13.8750254Z                              foreach ($policy in $qosPolicies) {
2026-01-11T19:28:13.8751613Z                                  Remove-NetQosPolicy -Name $policy.Name -Confirm:$false -ErrorAction SilentlyContinue
2026-01-11T19:28:13.8751969Z                                  Write-Log "Removed QoS policy: $($policy.Name)" "SUCCESS"
2026-01-11T19:28:13.8752206Z                              }
2026-01-11T19:28:13.8753244Z                      
2026-01-11T19:28:13.8753935Z                              $tcpPath = "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters"
2026-01-11T19:28:13.8754156Z                              if (Restore-RegistryKey -Path $tcpPath) {
2026-01-11T19:28:13.8755165Z                                  Write-Log "Restored TCP/IP registry settings" "SUCCESS"
2026-01-11T19:28:13.8755716Z                              }
2026-01-11T19:28:13.8756929Z                      
2026-01-11T19:28:13.8757251Z                              Write-Log "Network optimization rollback complete" "SUCCESS"
2026-01-11T19:28:13.8758091Z                      
2026-01-11T19:28:13.8758212Z                          } catch {
2026-01-11T19:28:13.8759774Z                              Write-Log "Error during rollback: $_" "ERROR"
2026-01-11T19:28:13.8759921Z                              throw
2026-01-11T19:28:13.8760273Z                          }
2026-01-11T19:28:13.8761157Z                      }
2026-01-11T19:28:13.8761622Z                      
2026-01-11T19:28:13.8762551Z                      
2026-01-11T19:28:13.8762740Z                      Export-ModuleMember -Function @(
2026-01-11T19:28:13.8764460Z                          'Get-ActiveNetworkAdapter',
2026-01-11T19:28:13.8764848Z                          'Set-NetworkAdapterOptimizations',
2026-01-11T19:28:13.8765069Z                          'Set-NetworkAdapterAdvancedSettings',
2026-01-11T19:28:13.8766155Z                          'Test-NetworkAdapterAdvancedSettings',
2026-01-11T19:28:13.8766296Z                          'Set-DNSProvider',
2026-01-11T19:28:13.8767601Z                          'Set-IPv4Preference',
2026-01-11T19:28:13.8767734Z                          'Disable-Teredo',
2026-01-11T19:28:13.8768880Z                          'Set-QoSConfiguration',
2026-01-11T19:28:13.8769034Z                          'Enable-QoSGaming',
2026-01-11T19:28:13.8770138Z                          'Disable-NetworkThrottling',
2026-01-11T19:28:13.8770512Z                          'Set-TCPOptimizations',
2026-01-11T19:28:13.8770990Z                          'Remove-NetworkBindings',
2026-01-11T19:28:13.8772069Z                          'Test-NetworkOptimizations',
2026-01-11T19:28:13.8772239Z                          'Invoke-NetworkOptimizations',
2026-01-11T19:28:13.8773246Z                          'Undo-NetworkOptimizations'
2026-01-11T19:28:13.8773351Z                      )
2026-01-11T19:28:13.8774897Z [32;1mCleanBlock         : [0m
2026-01-11T19:28:13.8775059Z [32;1mDynamicParamBlock  : [0m
2026-01-11T19:28:13.8776377Z [32;1mScriptRequirements : [0mSystem.Management.Automation.Language.ScriptRequirements
2026-01-11T19:28:13.8779021Z [32;1mExtent             : [0m<#
2026-01-11T19:28:13.8779479Z                      .SYNOPSIS
2026-01-11T19:28:13.8780859Z                          Network performance and latency optimizations.
2026-01-11T19:28:13.8781013Z                      .DESCRIPTION
2026-01-11T19:28:13.8781387Z                          Tunes adapter settings, DNS providers, IPv4 preference, Teredo, QoS, and
2026-01-11T19:28:13.8782603Z                          TCP stack parameters aimed at gaming latency and stability.
2026-01-11T19:28:13.8782898Z                      .NOTES
2026-01-11T19:28:13.8783582Z                          Requires Administrator. Some changes require reboot or router QoS support.
2026-01-11T19:28:13.8784569Z                      #>
2026-01-11T19:28:13.8785109Z                      #Requires -RunAsAdministrator
2026-01-11T19:28:13.8786273Z                      
2026-01-11T19:28:13.8786421Z                      
2026-01-11T19:28:13.8786498Z                      
2026-01-11T19:28:13.8787969Z                      Import-Module (Join-Path $PSScriptRoot "..\core\logger.psm1") -Force -Global
2026-01-11T19:28:13.8788451Z                      Import-Module (Join-Path $PSScriptRoot "..\core\registry.psm1") -Force -Global
2026-01-11T19:28:13.8788565Z                      
2026-01-11T19:28:13.8789754Z                      
2026-01-11T19:28:13.8789874Z                      
2026-01-11T19:28:13.8791029Z                      function Get-ActiveNetworkAdapter {
2026-01-11T19:28:13.8791138Z                          <#
2026-01-11T19:28:13.8792343Z                          .SYNOPSIS
2026-01-11T19:28:13.8792589Z                              Finds the first active Ethernet or Wi-Fi adapter.
2026-01-11T19:28:13.8793803Z                          .DESCRIPTION
2026-01-11T19:28:13.8794215Z                              Scans enabled adapters and selects the first matching Ethernet/Wi-Fi
2026-01-11T19:28:13.8794792Z                              interface for subsequent configuration.
2026-01-11T19:28:13.8794999Z                          .OUTPUTS
2026-01-11T19:28:13.8796844Z                              [Microsoft.Management.Infrastructure.CimInstance] Adapter object or $null.
2026-01-11T19:28:13.8796954Z                          #>
2026-01-11T19:28:13.8797515Z                          try {
2026-01-11T19:28:13.8797867Z                              $adapter = Get-NetAdapter | Where-Object {
2026-01-11T19:28:13.8798591Z                                  $_.Status -eq "Up" -and
2026-01-11T19:28:13.8799935Z                                  ($_.InterfaceDescription -like "*Ethernet*" -or $_.InterfaceDescription -like 
2026-01-11T19:28:13.8800077Z                      "*Wi-Fi*")
2026-01-11T19:28:13.8801141Z                              } | Select-Object -First 1
2026-01-11T19:28:13.8802094Z                      
2026-01-11T19:28:13.8802230Z                              if ($adapter) {
2026-01-11T19:28:13.8803594Z                                  Write-Log "Detected network adapter: $($adapter.Name)" "INFO"
2026-01-11T19:28:13.8803757Z                              } else {
2026-01-11T19:28:13.8804810Z                                  Write-Log "No active network adapter found" "ERROR"
2026-01-11T19:28:13.8805205Z                              }
2026-01-11T19:28:13.8806102Z                      
2026-01-11T19:28:13.8806564Z                              return $adapter
2026-01-11T19:28:13.8807289Z                          } catch {
2026-01-11T19:28:13.8808246Z                              Write-Log "Error detecting network adapter: $_" "ERROR"
2026-01-11T19:28:13.8808388Z                              return $null
2026-01-11T19:28:13.8809345Z                          }
2026-01-11T19:28:13.8809444Z                      }
2026-01-11T19:28:13.8810726Z                      
2026-01-11T19:28:13.8810979Z                      
2026-01-11T19:28:13.8812234Z                      function Test-NetworkOptimizations {
2026-01-11T19:28:13.8812354Z                          <#
2026-01-11T19:28:13.8813371Z                          .SYNOPSIS
2026-01-11T19:28:13.8813843Z                              Verifies network-related registry settings.
2026-01-11T19:28:13.8814136Z                          .DESCRIPTION
2026-01-11T19:28:13.8815152Z                              Checks for Receive Side Scaling (RSS) enablement.
2026-01-11T19:28:13.8815278Z                          .OUTPUTS
2026-01-11T19:28:13.8816420Z                              [bool] True when checks pass, else false.
2026-01-11T19:28:13.8816876Z                          #>
2026-01-11T19:28:13.8817935Z                          $allPassed = $true
2026-01-11T19:28:13.8819246Z                      
2026-01-11T19:28:13.8819585Z                          Write-Log "Verifying network optimizations..." "INFO"
2026-01-11T19:28:13.8819683Z                      
2026-01-11T19:28:13.8820475Z                          $tcpPath = "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters"
2026-01-11T19:28:13.8821267Z                          $rssEnabled = Get-RegistryValue -Path $tcpPath -Name "EnableRSS"
2026-01-11T19:28:13.8822481Z                          if ($rssEnabled -eq 1) {
2026-01-11T19:28:13.8823201Z                              Write-Log "‚úì RSS (Receive Side Scaling) enabled" "SUCCESS"
2026-01-11T19:28:13.8823310Z                          } else {
2026-01-11T19:28:13.8824613Z                              Write-Log "‚úó RSS not enabled" "ERROR"
2026-01-11T19:28:13.8825060Z                              $allPassed = $false
2026-01-11T19:28:13.8825391Z                          }
2026-01-11T19:28:13.8826531Z                      
2026-01-11T19:28:13.8827604Z                          return $allPassed
2026-01-11T19:28:13.8827739Z                      }
2026-01-11T19:28:13.8828838Z                      
2026-01-11T19:28:13.8829674Z                      
2026-01-11T19:28:13.8830787Z                      
2026-01-11T19:28:13.8830894Z                      
2026-01-11T19:28:13.8831962Z                      function Set-NetworkAdapterOptimizations {
2026-01-11T19:28:13.8832791Z                          <#
2026-01-11T19:28:13.8832903Z                          .SYNOPSIS
2026-01-11T19:28:13.8834413Z                              Applies adapter-level network optimizations.
2026-01-11T19:28:13.8834559Z                          .DESCRIPTION
2026-01-11T19:28:13.8835290Z                              Enables RSS and optionally disables RSC. Attempts to disable adapter
2026-01-11T19:28:13.8835457Z                              power saving for more consistent latency.
2026-01-11T19:28:13.8836600Z                          .PARAMETER DisableRSC
2026-01-11T19:28:13.8837106Z                              When true, disables Receive Segment Coalescing (opt-in).
2026-01-11T19:28:13.8837520Z                          .OUTPUTS
2026-01-11T19:28:13.8838763Z                              None.
2026-01-11T19:28:13.8839088Z                          #>
2026-01-11T19:28:13.8840027Z                          param(
2026-01-11T19:28:13.8840554Z                              [bool]$DisableRSC = $false
2026-01-11T19:28:13.8841776Z                          )
2026-01-11T19:28:13.8842689Z                      
2026-01-11T19:28:13.8842800Z                          try {
2026-01-11T19:28:13.8844587Z                              $adapter = Get-ActiveNetworkAdapter
2026-01-11T19:28:13.8844771Z                              if (-not $adapter) { return }
2026-01-11T19:28:13.8845173Z                      
2026-01-11T19:28:13.8846498Z                              $tcpPath = "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters"
2026-01-11T19:28:13.8846696Z                              Backup-RegistryKey -Path $tcpPath
2026-01-11T19:28:13.8846793Z                      
2026-01-11T19:28:13.8848280Z                              Set-RegistryValue -Path $tcpPath -Name "EnableRSS" -Value 1 -Type "DWORD"
2026-01-11T19:28:13.8848586Z                              Write-Log "Enabled RSS (Receive Side Scaling) for multi-core performance" "SUCCESS"
2026-01-11T19:28:13.8849406Z                      
2026-01-11T19:28:13.8850387Z                              if ($DisableRSC) {
2026-01-11T19:28:13.8851166Z                                  Set-RegistryValue -Path $tcpPath -Name "EnableRSC" -Value 0 -Type "DWORD"
2026-01-11T19:28:13.8851800Z                                  Write-Log "Disabled RSC (opt-in, validate with network monitoring)" "SUCCESS"
2026-01-11T19:28:13.8851934Z                              } else {
2026-01-11T19:28:13.8853379Z                                  Write-Log "RSC kept enabled (default, disable only if measured jitter)" "INFO"
2026-01-11T19:28:13.8853491Z                              }
2026-01-11T19:28:13.8853784Z                      
2026-01-11T19:28:13.8854693Z                              try {
2026-01-11T19:28:13.8854875Z                                  $adapterGuid = $adapter.InterfaceGuid
2026-01-11T19:28:13.8856601Z                                  $powerMgmt = Get-WmiObject MSPower_DeviceEnable -Namespace root\wmi | Where-Object { 
2026-01-11T19:28:13.8856727Z                      $_.InstanceName -like "*$adapterGuid*" }
2026-01-11T19:28:13.8857586Z                                  if ($powerMgmt) {
2026-01-11T19:28:13.8858441Z                                      $powerMgmt.Enable = $false
2026-01-11T19:28:13.8859627Z                                      $powerMgmt.Put() | Out-Null
2026-01-11T19:28:13.8860004Z                                      Write-Log "Disabled power saving for network adapter" "SUCCESS"
2026-01-11T19:28:13.8860141Z                                  }
2026-01-11T19:28:13.8860727Z                              } catch {
2026-01-11T19:28:13.8862234Z                                  Write-Log "Could not disable network adapter power saving (may require manual 
2026-01-11T19:28:13.8862332Z                      config)" "ERROR"
2026-01-11T19:28:13.8862725Z                              }
2026-01-11T19:28:13.8864218Z                      
2026-01-11T19:28:13.8864610Z                          } catch {
2026-01-11T19:28:13.8865222Z                              Write-Log "Error optimizing network adapter: $_" "ERROR"
2026-01-11T19:28:13.8866413Z                              throw
2026-01-11T19:28:13.8866552Z                          }
2026-01-11T19:28:13.8868046Z                      }
2026-01-11T19:28:13.8868165Z                      
2026-01-11T19:28:13.8869195Z                      
2026-01-11T19:28:13.8869368Z                      function Set-DNSProvider {
2026-01-11T19:28:13.8870718Z                          <#
2026-01-11T19:28:13.8870859Z                          .SYNOPSIS
2026-01-11T19:28:13.8872459Z                              Sets the DNS resolver for the active adapter.
2026-01-11T19:28:13.8872562Z                          .DESCRIPTION
2026-01-11T19:28:13.8873869Z                              Applies a well-known DNS provider or restores ISP defaults via DHCP.
2026-01-11T19:28:13.8874176Z                              Flushes DNS cache and performs a simple resolution test.
2026-01-11T19:28:13.8875160Z                          .PARAMETER Provider
2026-01-11T19:28:13.8876193Z                              DNS provider name: cloudflare, google, quad9, adguard, opendns, isp.
2026-01-11T19:28:13.8876499Z                          .OUTPUTS
2026-01-11T19:28:13.8877484Z                              None.
2026-01-11T19:28:13.8877598Z                          #>
2026-01-11T19:28:13.8878980Z                          param(
2026-01-11T19:28:13.8879342Z                              [ValidateSet("cloudflare", "google", "quad9", "adguard", "opendns", "isp")]
2026-01-11T19:28:13.8880586Z                              [string]$Provider = "cloudflare"
2026-01-11T19:28:13.8880711Z                          )
2026-01-11T19:28:13.8881293Z                      
2026-01-11T19:28:13.8881550Z                          try {
2026-01-11T19:28:13.8882669Z                              $adapter = Get-ActiveNetworkAdapter
2026-01-11T19:28:13.8883723Z                              if (-not $adapter) { return }
2026-01-11T19:28:13.8883910Z                      
2026-01-11T19:28:13.8885074Z                              $primaryDNS = ""
2026-01-11T19:28:13.8885240Z                              $secondaryDNS = ""
2026-01-11T19:28:13.8886372Z                      
2026-01-11T19:28:13.8886688Z                              switch ($Provider) {
2026-01-11T19:28:13.8887876Z                                  "cloudflare" {
2026-01-11T19:28:13.8888395Z                                      $primaryDNS = "1.1.1.1"
2026-01-11T19:28:13.8889451Z                                      $secondaryDNS = "1.0.0.1"
2026-01-11T19:28:13.8889739Z                                      Write-Log "Setting Cloudflare DNS (high privacy)" "INFO"
2026-01-11T19:28:13.8890731Z                                  }
2026-01-11T19:28:13.8891497Z                                  "google" {
2026-01-11T19:28:13.8891698Z                                      $primaryDNS = "8.8.8.8"
2026-01-11T19:28:13.8893055Z                                      $secondaryDNS = "8.8.4.4"
2026-01-11T19:28:13.8893392Z                                      Write-Log "Setting Google DNS (reliable)" "INFO"
2026-01-11T19:28:13.8894586Z                                  }
2026-01-11T19:28:13.8894722Z                                  "quad9" {
2026-01-11T19:28:13.8895999Z                                      $primaryDNS = "9.9.9.9"
2026-01-11T19:28:13.8896207Z                                      $secondaryDNS = "149.112.112.112"
2026-01-11T19:28:13.8897700Z                                      Write-Log "Setting Quad9 DNS (high privacy, blocks malware)" "INFO"
2026-01-11T19:28:13.8897827Z                                  }
2026-01-11T19:28:13.8898758Z                                  "adguard" {
2026-01-11T19:28:13.8898931Z                                      $primaryDNS = "94.140.14.14"
2026-01-11T19:28:13.8899706Z                                      $secondaryDNS = "94.140.15.15"
2026-01-11T19:28:13.8901063Z                                      Write-Log "Setting AdGuard DNS (privacy + blocking)" "INFO"
2026-01-11T19:28:13.8901178Z                                  }
2026-01-11T19:28:13.8902087Z                                  "opendns" {
2026-01-11T19:28:13.8902291Z                                      $primaryDNS = "208.67.222.222"
2026-01-11T19:28:13.8902719Z                                      $secondaryDNS = "208.67.220.220"
2026-01-11T19:28:13.8903983Z                                      Write-Log "Setting OpenDNS (reliable, filtering options)" "INFO"
2026-01-11T19:28:13.8904054Z                                  }
2026-01-11T19:28:13.8904801Z                                  "isp" {
2026-01-11T19:28:13.8906156Z                                      Set-DnsClientServerAddress -InterfaceIndex $adapter.InterfaceIndex 
2026-01-11T19:28:13.8906267Z                      -ResetServerAddresses
2026-01-11T19:28:13.8907582Z                                      Write-Log "Restored ISP default DNS (DHCP)" "SUCCESS"
2026-01-11T19:28:13.8907838Z                                      return
2026-01-11T19:28:13.8908243Z                                  }
2026-01-11T19:28:13.8909063Z                              }
2026-01-11T19:28:13.8909501Z                      
2026-01-11T19:28:13.8910293Z                              Set-DnsClientServerAddress -InterfaceIndex $adapter.InterfaceIndex -ServerAddresses 
2026-01-11T19:28:13.8911452Z                      ($primaryDNS, $secondaryDNS) -ErrorAction Stop
2026-01-11T19:28:13.8912225Z                              Write-Log "IPv4 DNS set to ${Provider}: ${primaryDNS}, ${secondaryDNS}" "SUCCESS"
2026-01-11T19:28:13.8912555Z                      
2026-01-11T19:28:13.8913014Z                              ipconfig /flushdns 2>&1 | Out-Null
2026-01-11T19:28:13.8913875Z                              Write-Log "DNS cache flushed" "SUCCESS"
2026-01-11T19:28:13.8914768Z                      
2026-01-11T19:28:13.8914880Z                              try {
2026-01-11T19:28:13.8916376Z                                  $testResult = Resolve-DnsName -Name "google.com" -Server $primaryDNS -ErrorAction 
2026-01-11T19:28:13.8916546Z                      Stop -QuickTimeout
2026-01-11T19:28:13.8917708Z                                  if ($testResult) {
2026-01-11T19:28:13.8918107Z                                      Write-Log "DNS resolution test successful" "SUCCESS"
2026-01-11T19:28:13.8919078Z                                  }
2026-01-11T19:28:13.8919436Z                              } catch {
2026-01-11T19:28:13.8921016Z                                  Write-Log "DNS resolution test failed (network may need time to update)" "ERROR"
2026-01-11T19:28:13.8921134Z                              }
2026-01-11T19:28:13.8921478Z                      
2026-01-11T19:28:13.8923012Z                              Write-Log "NOTE: DNS provider does NOT affect ping to game servers" "INFO"
2026-01-11T19:28:13.8923878Z                              Write-Log "It only improves name resolution speed (e.g., when typing URLs)" "INFO"
2026-01-11T19:28:13.8923994Z                      
2026-01-11T19:28:13.8924441Z                          } catch {
2026-01-11T19:28:13.8925320Z                              Write-Log "Error configuring DNS: $_" "ERROR"
2026-01-11T19:28:13.8925986Z                              throw
2026-01-11T19:28:13.8927010Z                          }
2026-01-11T19:28:13.8927223Z                      }
2026-01-11T19:28:13.8928063Z                      
2026-01-11T19:28:13.8929081Z                      
2026-01-11T19:28:13.8929307Z                      function Set-IPv4Preference {
2026-01-11T19:28:13.8930405Z                          <#
2026-01-11T19:28:13.8931058Z                          .SYNOPSIS
2026-01-11T19:28:13.8932019Z                              Optionally prefers IPv4 over IPv6.
2026-01-11T19:28:13.8933341Z                          .DESCRIPTION
2026-01-11T19:28:13.8933727Z                              Sets the DisabledComponents value to prefer IPv4. Requires reboot.
2026-01-11T19:28:13.8933874Z                          .PARAMETER Enable
2026-01-11T19:28:13.8935028Z                              When true, applies IPv4 preference.
2026-01-11T19:28:13.8935385Z                          .OUTPUTS
2026-01-11T19:28:13.8935891Z                              None.
2026-01-11T19:28:13.8936828Z                          #>
2026-01-11T19:28:13.8937105Z                          param(
2026-01-11T19:28:13.8938448Z                              [bool]$Enable = $false
2026-01-11T19:28:13.8938574Z                          )
2026-01-11T19:28:13.8939341Z                      
2026-01-11T19:28:13.8939905Z                          if (-not $Enable) {
2026-01-11T19:28:13.8940838Z                              Write-Log "IPv4 preference skipped" "INFO"
2026-01-11T19:28:13.8940954Z                              return
2026-01-11T19:28:13.8942414Z                          }
2026-01-11T19:28:13.8943272Z                      
2026-01-11T19:28:13.8943899Z                          try {
2026-01-11T19:28:13.8945175Z                              Write-Log "Setting IPv4 preference..." "INFO"
2026-01-11T19:28:13.8945297Z                      
2026-01-11T19:28:13.8946163Z                              $ipv6Path = "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters"
2026-01-11T19:28:13.8946345Z                              Backup-RegistryKey -Path $ipv6Path
2026-01-11T19:28:13.8947306Z                      
2026-01-11T19:28:13.8948338Z                              # Value 32 = Prefer IPv4 over IPv6 (see Microsoft KB 929852)
2026-01-11T19:28:13.8949090Z                              Set-RegistryValue -Path $ipv6Path -Name "DisabledComponents" -Value 32 -Type "DWORD"
2026-01-11T19:28:13.8949192Z                      
2026-01-11T19:28:13.8950539Z                              Write-Log "IPv4 preferred over IPv6" "SUCCESS"
2026-01-11T19:28:13.8950973Z                              Write-Log "Warning: May break IPv6-only paths or Xbox/Store features" "INFO"
2026-01-11T19:28:13.8951297Z                              Write-Log "Requires reboot to take effect" "INFO"
2026-01-11T19:28:13.8952552Z                          } catch {
2026-01-11T19:28:13.8952864Z                              Write-Log "Error setting IPv4 preference: $_" "ERROR"
2026-01-11T19:28:13.8953708Z                          }
2026-01-11T19:28:13.8953810Z                      }
2026-01-11T19:28:13.8955010Z                      
2026-01-11T19:28:13.8955460Z                      
2026-01-11T19:28:13.8956818Z                      function Disable-Teredo {
2026-01-11T19:28:13.8956953Z                          <#
2026-01-11T19:28:13.8957372Z                          .SYNOPSIS
2026-01-11T19:28:13.8958326Z                              Optionally disables Teredo IPv6 tunneling.
2026-01-11T19:28:13.8958912Z                          .DESCRIPTION
2026-01-11T19:28:13.8959568Z                              Disables Teredo via netsh when requested. Requires reboot for full effect.
2026-01-11T19:28:13.8960609Z                          .PARAMETER Enable
2026-01-11T19:28:13.8961704Z                              When true, disables Teredo.
2026-01-11T19:28:13.8962147Z                          .OUTPUTS
2026-01-11T19:28:13.8963280Z                              None.
2026-01-11T19:28:13.8964112Z                          #>
2026-01-11T19:28:13.8964911Z                          param(
2026-01-11T19:28:13.8965844Z                              [bool]$Enable = $false
2026-01-11T19:28:13.8966598Z                          )
2026-01-11T19:28:13.8967665Z                      
2026-01-11T19:28:13.8968543Z                          if (-not $Enable) {
2026-01-11T19:28:13.8969736Z                              Write-Log "Teredo disable skipped" "INFO"
2026-01-11T19:28:13.8970058Z                              return
2026-01-11T19:28:13.8971049Z                          }
2026-01-11T19:28:13.8971172Z                      
2026-01-11T19:28:13.8972405Z                          try {
2026-01-11T19:28:13.8972692Z                              Write-Log "Disabling Teredo IPv6 tunneling..." "INFO"
2026-01-11T19:28:13.8973773Z                      
2026-01-11T19:28:13.8975097Z                              $result = netsh interface teredo set state disabled 2>&1
2026-01-11T19:28:13.8975300Z                              if ($LASTEXITCODE -eq 0) {
2026-01-11T19:28:13.8976350Z                                  Write-Log "Teredo disabled via netsh" "SUCCESS"
2026-01-11T19:28:13.8976532Z                              }
2026-01-11T19:28:13.8977857Z                      
2026-01-11T19:28:13.8978246Z                              $ipv6Path = "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters"
2026-01-11T19:28:13.8979268Z                              Backup-RegistryKey -Path $ipv6Path
2026-01-11T19:28:13.8979544Z                      
2026-01-11T19:28:13.8980020Z                              $currentValue = Get-RegistryValue -Path $ipv6Path -Name "DisabledComponents"
2026-01-11T19:28:13.8981079Z                              if ($null -eq $currentValue) { $currentValue = 0 }
2026-01-11T19:28:13.8981183Z                      
2026-01-11T19:28:13.8982342Z                              $newValue = $currentValue -bor 1
2026-01-11T19:28:13.8983620Z                              Set-RegistryValue -Path $ipv6Path -Name "DisabledComponents" -Value $newValue -Type 
2026-01-11T19:28:13.8983708Z                      "DWORD"
2026-01-11T19:28:13.8984684Z                      
2026-01-11T19:28:13.8985192Z                              Write-Log "Teredo IPv6 tunneling disabled" "SUCCESS"
2026-01-11T19:28:13.8986279Z                              Write-Log "Warning: May break Xbox Live connectivity" "INFO"
2026-01-11T19:28:13.8986576Z                              Write-Log "Requires reboot to take effect" "INFO"
2026-01-11T19:28:13.8987326Z                          } catch {
2026-01-11T19:28:13.8988579Z                              Write-Log "Error disabling Teredo: $_" "ERROR"
2026-01-11T19:28:13.8988949Z                          }
2026-01-11T19:28:13.8989926Z                      }
2026-01-11T19:28:13.8990866Z                      
2026-01-11T19:28:13.8991601Z                      
2026-01-11T19:28:13.8992110Z                      function Set-QoSConfiguration {
2026-01-11T19:28:13.8993181Z                          <#
2026-01-11T19:28:13.8993299Z                          .SYNOPSIS
2026-01-11T19:28:13.8994763Z                              Creates QoS policies for selected game executables.
2026-01-11T19:28:13.8994911Z                          .DESCRIPTION
2026-01-11T19:28:13.8995226Z                              Adds per-executable QoS policies with DSCP 46 for priority handling.
2026-01-11T19:28:13.8996373Z                          .PARAMETER GameExecutables
2026-01-11T19:28:13.8996583Z                              Executable names to target (e.g., cs2.exe).
2026-01-11T19:28:13.8997597Z                          .OUTPUTS
2026-01-11T19:28:13.8997707Z                              None.
2026-01-11T19:28:13.8998864Z                          #>
2026-01-11T19:28:13.8999454Z                          param(
2026-01-11T19:28:13.9000524Z                              [string[]]$GameExecutables = @("cs2.exe", "dota2.exe", "helldivers2.exe", 
2026-01-11T19:28:13.9000875Z                      "SpaceMarine2.exe")
2026-01-11T19:28:13.9001731Z                          )
2026-01-11T19:28:13.9002752Z                      
2026-01-11T19:28:13.9002895Z                          try {
2026-01-11T19:28:13.9004285Z                              Write-Log "Configuring QoS policies..." "INFO"
2026-01-11T19:28:13.9004395Z                      
2026-01-11T19:28:13.9005571Z                              foreach ($exe in $GameExecutables) {
2026-01-11T19:28:13.9005893Z                                  $qosPolicy = Get-NetQosPolicy -Name "Game-$exe" -ErrorAction SilentlyContinue
2026-01-11T19:28:13.9006593Z                                  if (-not $qosPolicy) {
2026-01-11T19:28:13.9007943Z                                      New-NetQosPolicy -Name "Game-$exe" -AppPathNameMatchCondition $exe -DSCPAction 46 
2026-01-11T19:28:13.9008230Z                      -NetworkProfile All -ErrorAction Stop | Out-Null
2026-01-11T19:28:13.9009809Z                                      Write-Log "Created QoS policy for $exe (DSCP 46)" "SUCCESS"
2026-01-11T19:28:13.9009964Z                                  } else {
2026-01-11T19:28:13.9011133Z                                      Write-Log "QoS policy for $exe already exists" "INFO"
2026-01-11T19:28:13.9011271Z                                  }
2026-01-11T19:28:13.9012514Z                              }
2026-01-11T19:28:13.9012915Z                      
2026-01-11T19:28:13.9014058Z                              Write-Log "QoS configuration complete" "SUCCESS"
2026-01-11T19:28:13.9014702Z                              Write-Log "NOTE: Requires router QoS/SQM support to be effective" "INFO"
2026-01-11T19:28:13.9014800Z                      
2026-01-11T19:28:13.9015849Z                          } catch {
2026-01-11T19:28:13.9016254Z                              Write-Log "Error configuring QoS (requires Windows Pro/Enterprise): $_" "ERROR"
2026-01-11T19:28:13.9017228Z                          }
2026-01-11T19:28:13.9017346Z                      }
2026-01-11T19:28:13.9018507Z                      
2026-01-11T19:28:13.9018609Z                      
2026-01-11T19:28:13.9019791Z                      
2026-01-11T19:28:13.9019896Z                      
2026-01-11T19:28:13.9031082Z                      function Enable-QoSGaming {
2026-01-11T19:28:13.9031202Z                          <#
2026-01-11T19:28:13.9031522Z                          .SYNOPSIS
2026-01-11T19:28:13.9031860Z                              Creates QoS policies to prioritize gaming network traffic.
2026-01-11T19:28:13.9031984Z                          .DESCRIPTION
2026-01-11T19:28:13.9032328Z                              Configures Windows QoS to mark gaming UDP traffic with high priority
2026-01-11T19:28:13.9032505Z                              DSCP values for better handling by routers that support QoS.
2026-01-11T19:28:13.9032620Z                          .PARAMETER Enable
2026-01-11T19:28:13.9032851Z                              When true, creates QoS policies for gaming traffic.
2026-01-11T19:28:13.9032963Z                          .PARAMETER GamePorts
2026-01-11T19:28:13.9033118Z                              UDP port ranges to mark with DSCP 46.
2026-01-11T19:28:13.9033253Z                          .OUTPUTS
2026-01-11T19:28:13.9033343Z                              None.
2026-01-11T19:28:13.9033422Z                          #>
2026-01-11T19:28:13.9033510Z                          param(
2026-01-11T19:28:13.9033634Z                              [bool]$Enable = $true,
2026-01-11T19:28:13.9033993Z                              [string[]]$GamePorts = @("27015-27030", "3478-3480", "7000-9000")  # Common game ports
2026-01-11T19:28:13.9034088Z                          )
2026-01-11T19:28:13.9034168Z                      
2026-01-11T19:28:13.9034291Z                          if (-not $Enable) {
2026-01-11T19:28:13.9034475Z                              Write-Log "QoS Gaming: skipped" "INFO"
2026-01-11T19:28:13.9034618Z                              return
2026-01-11T19:28:13.9034729Z                          }
2026-01-11T19:28:13.9034850Z                      
2026-01-11T19:28:13.9035871Z                          try {
2026-01-11T19:28:13.9036655Z                              # Remove existing gaming QoS policies first
2026-01-11T19:28:13.9037791Z                              Get-NetQosPolicy | Where-Object { $_.Name -like "RockTune-*" } | Remove-NetQosPolicy 
2026-01-11T19:28:13.9037954Z                      -Confirm:$false -ErrorAction SilentlyContinue
2026-01-11T19:28:13.9038879Z                      
2026-01-11T19:28:13.9040016Z                              # Create QoS policy for UDP gaming traffic with DSCP 46 (Expedited Forwarding)
2026-01-11T19:28:13.9040217Z                              foreach ($portRange in $GamePorts) {
2026-01-11T19:28:13.9041801Z                                  $policyName = "RockTune-Gaming-$($portRange -replace '-','to')"
2026-01-11T19:28:13.9042271Z                                  New-NetQosPolicy -Name $policyName `
2026-01-11T19:28:13.9043226Z                                      -NetworkProfile All `
2026-01-11T19:28:13.9043774Z                                      -IPProtocolMatchCondition UDP `
2026-01-11T19:28:13.9044225Z                                      -IPDstPortMatchCondition $portRange `
2026-01-11T19:28:13.9045247Z                                      -DSCPAction 46 `
2026-01-11T19:28:13.9045481Z                                      -ErrorAction SilentlyContinue | Out-Null
2026-01-11T19:28:13.9046626Z                              }
2026-01-11T19:28:13.9046737Z                      
2026-01-11T19:28:13.9047879Z                              # Create policy for common voice chat (Discord, etc.)
2026-01-11T19:28:13.9048683Z                              New-NetQosPolicy -Name "RockTune-VoiceChat" `
2026-01-11T19:28:13.9049423Z                                  -NetworkProfile All `
2026-01-11T19:28:13.9050629Z                                  -IPProtocolMatchCondition UDP `
2026-01-11T19:28:13.9050889Z                                  -IPDstPortMatchCondition "50000-50100" `
2026-01-11T19:28:13.9051790Z                                  -DSCPAction 46 `
2026-01-11T19:28:13.9052660Z                                  -ErrorAction SilentlyContinue | Out-Null
2026-01-11T19:28:13.9052975Z                      
2026-01-11T19:28:13.9054325Z                              Write-Log "QoS Gaming policies created (DSCP 46 for game traffic)" "SUCCESS"
2026-01-11T19:28:13.9054680Z                              Write-Log "Note: Router must support QoS for full benefit" "INFO"
2026-01-11T19:28:13.9055020Z                          } catch {
2026-01-11T19:28:13.9055763Z                              Write-Log "Error enabling QoS Gaming: $_" "ERROR"
2026-01-11T19:28:13.9056117Z                          }
2026-01-11T19:28:13.9057382Z                      }
2026-01-11T19:28:13.9057776Z                      
2026-01-11T19:28:13.9058864Z                      
2026-01-11T19:28:13.9059093Z                      function Disable-NetworkThrottling {
2026-01-11T19:28:13.9059882Z                          <#
2026-01-11T19:28:13.9060719Z                          .SYNOPSIS
2026-01-11T19:28:13.9061887Z                              Disables Windows network throttling mechanisms.
2026-01-11T19:28:13.9062576Z                          .DESCRIPTION
2026-01-11T19:28:13.9063122Z                              Removes the NetworkThrottlingIndex limit that Windows applies
2026-01-11T19:28:13.9063543Z                              to multimedia streaming to prevent network congestion.
2026-01-11T19:28:13.9064480Z                              This can improve network performance for games.
2026-01-11T19:28:13.9065563Z                          .PARAMETER Enable
2026-01-11T19:28:13.9065980Z                              When true, disables network throttling.
2026-01-11T19:28:13.9066858Z                          .OUTPUTS
2026-01-11T19:28:13.9067701Z                              None.
2026-01-11T19:28:13.9068312Z                          #>
2026-01-11T19:28:13.9069448Z                          param(
2026-01-11T19:28:13.9069628Z                              [bool]$Enable = $true
2026-01-11T19:28:13.9070430Z                          )
2026-01-11T19:28:13.9071261Z                      
2026-01-11T19:28:13.9072282Z                          if (-not $Enable) {
2026-01-11T19:28:13.9073276Z                              Write-Log "Disable network throttling: skipped" "INFO"
2026-01-11T19:28:13.9073649Z                              return
2026-01-11T19:28:13.9074593Z                          }
2026-01-11T19:28:13.9074703Z                      
2026-01-11T19:28:13.9076018Z                          try {
2026-01-11T19:28:13.9076448Z                              $mmcssPath = "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile"
2026-01-11T19:28:13.9077615Z                              Backup-RegistryKey -Path $mmcssPath
2026-01-11T19:28:13.9077747Z                      
2026-01-11T19:28:13.9079093Z                              # Set NetworkThrottlingIndex to maximum (0xFFFFFFFF = disabled)
2026-01-11T19:28:13.9079818Z                              Set-RegistryValue -Path $mmcssPath -Name "NetworkThrottlingIndex" -Value 0xFFFFFFFF -Type 
2026-01-11T19:28:13.9080261Z                      "DWORD"
2026-01-11T19:28:13.9080960Z                      
2026-01-11T19:28:13.9082298Z                              # Also set SystemResponsiveness to 0 for minimum reserved bandwidth
2026-01-11T19:28:13.9083106Z                              Set-RegistryValue -Path $mmcssPath -Name "SystemResponsiveness" -Value 0 -Type "DWORD"
2026-01-11T19:28:13.9083199Z                      
2026-01-11T19:28:13.9083832Z                              Write-Log "Disabled network throttling (maximum throughput)" "SUCCESS"
2026-01-11T19:28:13.9084207Z                          } catch {
2026-01-11T19:28:13.9085373Z                              Write-Log "Error disabling network throttling: $_" "ERROR"
2026-01-11T19:28:13.9085719Z                          }
2026-01-11T19:28:13.9086564Z                      }
2026-01-11T19:28:13.9087558Z                      
2026-01-11T19:28:13.9087736Z                      
2026-01-11T19:28:13.9089344Z                      function Set-TCPOptimizations {
2026-01-11T19:28:13.9090991Z                          <#
2026-01-11T19:28:13.9091066Z                          .SYNOPSIS
2026-01-11T19:28:13.9091199Z                              Optimizes TCP stack settings for gaming.
2026-01-11T19:28:13.9091383Z                          .DESCRIPTION
2026-01-11T19:28:13.9092571Z                              Configures TCP settings for lower latency gaming including
2026-01-11T19:28:13.9092866Z                              disabling Nagle's algorithm, optimizing ACK behavior, and
2026-01-11T19:28:13.9093064Z                              tuning window scaling.
2026-01-11T19:28:13.9093909Z                          .PARAMETER Enable
2026-01-11T19:28:13.9094421Z                              When true, applies TCP stack changes.
2026-01-11T19:28:13.9095188Z                          .OUTPUTS
2026-01-11T19:28:13.9095565Z                              None.
2026-01-11T19:28:13.9096548Z                          #>
2026-01-11T19:28:13.9097338Z                          param(
2026-01-11T19:28:13.9098071Z                              [bool]$Enable = $true
2026-01-11T19:28:13.9099267Z                          )
2026-01-11T19:28:13.9099402Z                      
2026-01-11T19:28:13.9100531Z                          if (-not $Enable) {
2026-01-11T19:28:13.9101006Z                              Write-Log "TCP optimizations: skipped" "INFO"
2026-01-11T19:28:13.9101969Z                              return
2026-01-11T19:28:13.9102714Z                          }
2026-01-11T19:28:13.9103174Z                      
2026-01-11T19:28:13.9103799Z                          try {
2026-01-11T19:28:13.9104852Z                              $tcpPath = "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters"
2026-01-11T19:28:13.9105301Z                              Backup-RegistryKey -Path $tcpPath
2026-01-11T19:28:13.9106171Z                      
2026-01-11T19:28:13.9107166Z                              # Disable Nagle's Algorithm globally (reduces latency)
2026-01-11T19:28:13.9107813Z                              Set-RegistryValue -Path $tcpPath -Name "TcpNoDelay" -Value 1 -Type "DWORD"
2026-01-11T19:28:13.9107986Z                      
2026-01-11T19:28:13.9109108Z                              # Reduce TCP ACK frequency for faster acknowledgments
2026-01-11T19:28:13.9109845Z                              Set-RegistryValue -Path $tcpPath -Name "TcpAckFrequency" -Value 1 -Type "DWORD"
2026-01-11T19:28:13.9110171Z                      
2026-01-11T19:28:13.9111054Z                              # Disable TCP/IP auto-tuning for more predictable behavior
2026-01-11T19:28:13.9112148Z                              netsh int tcp set global autotuninglevel=disabled 2>&1 | Out-Null
2026-01-11T19:28:13.9112282Z                      
2026-01-11T19:28:13.9114033Z                              # Disable ECN (Explicit Congestion Notification) - can cause issues with some games
2026-01-11T19:28:13.9114352Z                              netsh int tcp set global ecncapability=disabled 2>&1 | Out-Null
2026-01-11T19:28:13.9114446Z                      
2026-01-11T19:28:13.9114999Z                              # Disable timestamps for slightly lower overhead
2026-01-11T19:28:13.9115510Z                              netsh int tcp set global timestamps=disabled 2>&1 | Out-Null
2026-01-11T19:28:13.9115625Z                      
2026-01-11T19:28:13.9116911Z                              # Set higher initial RTO (Retransmission Timeout) for stable connections
2026-01-11T19:28:13.9117184Z                              netsh int tcp set global initialRto=2000 2>&1 | Out-Null
2026-01-11T19:28:13.9117496Z                      
2026-01-11T19:28:13.9118748Z                              Write-Log "TCP stack optimized for gaming (Nagle off, fast ACK)" "SUCCESS"
2026-01-11T19:28:13.9119045Z                          } catch {
2026-01-11T19:28:13.9119356Z                              Write-Log "Error applying TCP optimizations: $_" "ERROR"
2026-01-11T19:28:13.9120645Z                          }
2026-01-11T19:28:13.9121000Z                      }
2026-01-11T19:28:13.9121111Z                      
2026-01-11T19:28:13.9122305Z                      
2026-01-11T19:28:13.9123217Z                      function Remove-NetworkBindings {
2026-01-11T19:28:13.9123371Z                          <#
2026-01-11T19:28:13.9124610Z                          .SYNOPSIS
2026-01-11T19:28:13.9125705Z                              Strips unnecessary network protocol bindings for minimal overhead.
2026-01-11T19:28:13.9126077Z                          .DESCRIPTION
2026-01-11T19:28:13.9127071Z                              FR33THY optimization - Removes non-essential network bindings from
2026-01-11T19:28:13.9127764Z                              active adapters including IPv6, file/printer sharing, LLDP, QoS,
2026-01-11T19:28:13.9128357Z                              and network discovery protocols. Leaves only IPv4 for pure gaming.
2026-01-11T19:28:13.9129169Z                      
2026-01-11T19:28:13.9129541Z                              WARNING: This breaks file sharing, printer sharing, network discovery,
2026-01-11T19:28:13.9130624Z                              and some enterprise features. Only use for dedicated gaming machines.
2026-01-11T19:28:13.9130992Z                          .PARAMETER Enable
2026-01-11T19:28:13.9131480Z                              When true, strips network bindings.
2026-01-11T19:28:13.9131806Z                          .OUTPUTS
2026-01-11T19:28:13.9132246Z                              None.
2026-01-11T19:28:13.9132629Z                          .NOTES
2026-01-11T19:28:13.9133166Z                              RISKY: Breaks file/printer sharing and network discovery.
2026-01-11T19:28:13.9133823Z                              Recommended only for dedicated gaming PCs without local network sharing needs.
2026-01-11T19:28:13.9133965Z                          #>
2026-01-11T19:28:13.9134849Z                          param(
2026-01-11T19:28:13.9135693Z                              [bool]$Enable = $true
2026-01-11T19:28:13.9136436Z                          )
2026-01-11T19:28:13.9136853Z                      
2026-01-11T19:28:13.9137901Z                          if (-not $Enable) {
2026-01-11T19:28:13.9139320Z                              Write-Log "Network binding strip: skipped" "INFO"
2026-01-11T19:28:13.9139466Z                              return
2026-01-11T19:28:13.9140582Z                          }
2026-01-11T19:28:13.9141365Z                      
2026-01-11T19:28:13.9142238Z                          try {
2026-01-11T19:28:13.9143425Z                              Write-Log "WARNING: Stripping network bindings breaks file/printer sharing!" "WARNING"
2026-01-11T19:28:13.9143557Z                      
2026-01-11T19:28:13.9145663Z                              # Network bindings to disable (keep only IPv4)
2026-01-11T19:28:13.9145847Z                              $bindingsToDisable = @(
2026-01-11T19:28:13.9146063Z                                  "ms_lldp",      # Link Layer Discovery Protocol
2026-01-11T19:28:13.9146673Z                                  "ms_lltdio",    # Link Layer Topology Discovery I/O
2026-01-11T19:28:13.9147000Z                                  "ms_implat",    # Microsoft Network Adapter Multiplexor Protocol
2026-01-11T19:28:13.9148308Z                                  "ms_rspndr",    # Link Layer Topology Discovery Responder
2026-01-11T19:28:13.9148896Z                                  "ms_tcpip6",    # IPv6
2026-01-11T19:28:13.9149109Z                                  "ms_server",    # File and Printer Sharing
2026-01-11T19:28:13.9150144Z                                  "ms_msclient",  # Client for Microsoft Networks
2026-01-11T19:28:13.9150654Z                                  "ms_pacer"      # QoS Packet Scheduler
2026-01-11T19:28:13.9151793Z                              )
2026-01-11T19:28:13.9151903Z                      
2026-01-11T19:28:13.9152978Z                              # Get active network adapters
2026-01-11T19:28:13.9153587Z                              $adapters = Get-NetAdapter | Where-Object { $_.Status -eq "Up" }
2026-01-11T19:28:13.9154533Z                              $totalDisabled = 0
2026-01-11T19:28:13.9155310Z                      
2026-01-11T19:28:13.9156246Z                              foreach ($adapter in $adapters) {
2026-01-11T19:28:13.9156493Z                                  foreach ($binding in $bindingsToDisable) {
2026-01-11T19:28:13.9157528Z                                      try {
2026-01-11T19:28:13.9158190Z                                          $currentBinding = Get-NetAdapterBinding -Name $adapter.Name -ComponentID 
2026-01-11T19:28:13.9158392Z                      $binding -ErrorAction SilentlyContinue
2026-01-11T19:28:13.9159586Z                                          if ($currentBinding -and $currentBinding.Enabled) {
2026-01-11T19:28:13.9161004Z                                              Disable-NetAdapterBinding -Name $adapter.Name -ComponentID $binding 
2026-01-11T19:28:13.9161106Z                      -ErrorAction Stop
2026-01-11T19:28:13.9161570Z                                              $totalDisabled++
2026-01-11T19:28:13.9162355Z                                          }
2026-01-11T19:28:13.9163211Z                                      } catch {
2026-01-11T19:28:13.9163644Z                                          # Binding may not exist on this adapter
2026-01-11T19:28:13.9164554Z                                      }
2026-01-11T19:28:13.9164986Z                                  }
2026-01-11T19:28:13.9165897Z                              }
2026-01-11T19:28:13.9166015Z                      
2026-01-11T19:28:13.9167469Z                              if ($totalDisabled -gt 0) {
2026-01-11T19:28:13.9167842Z                                  Write-Log "Stripped $totalDisabled network bindings (IPv4 only mode)" "SUCCESS"
2026-01-11T19:28:13.9169215Z                                  Write-Log "Disabled: IPv6, File Sharing, Network Discovery, QoS" "INFO"
2026-01-11T19:28:13.9169345Z                              } else {
2026-01-11T19:28:13.9169771Z                                  Write-Log "No network bindings modified (may already be stripped)" "INFO"
2026-01-11T19:28:13.9170525Z                              }
2026-01-11T19:28:13.9170628Z                      
2026-01-11T19:28:13.9171104Z                          } catch {
2026-01-11T19:28:13.9172260Z                              Write-Log "Error stripping network bindings: $_" "ERROR"
2026-01-11T19:28:13.9172367Z                          }
2026-01-11T19:28:13.9173563Z                      }
2026-01-11T19:28:13.9173678Z                      
2026-01-11T19:28:13.9174728Z                      
2026-01-11T19:28:13.9174999Z                      function Set-NetworkAdapterAdvancedSettings {
2026-01-11T19:28:13.9176312Z                          <#
2026-01-11T19:28:13.9176503Z                          .SYNOPSIS
2026-01-11T19:28:13.9177907Z                              Configures network adapter Device Manager advanced properties for gaming.
2026-01-11T19:28:13.9178103Z                          .DESCRIPTION
2026-01-11T19:28:13.9179285Z                              Disables Interrupt Moderation, Flow Control, Energy Efficient Ethernet,
2026-01-11T19:28:13.9180555Z                              and optionally disables LSO and maximizes buffers for pro gamers.
2026-01-11T19:28:13.9181319Z                              These are the settings typically found in Device Manager > Network Adapter > Advanced tab.
2026-01-11T19:28:13.9181582Z                          .PARAMETER DisableInterruptModeration
2026-01-11T19:28:13.9190175Z                              Disables interrupt moderation for lower latency (slight CPU increase).
2026-01-11T19:28:13.9191371Z                          .PARAMETER DisableFlowControl
2026-01-11T19:28:13.9191597Z                              Disables flow control (no network pausing).
2026-01-11T19:28:13.9192743Z                          .PARAMETER DisableEEE
2026-01-11T19:28:13.9193287Z                              Disables Energy Efficient Ethernet (prevents wake latency).
2026-01-11T19:28:13.9194274Z                          .PARAMETER DisableLSO
2026-01-11T19:28:13.9195315Z                              Disables Large Send Offload v1/v2 (opt-in for pro_gamer, increases CPU).
2026-01-11T19:28:13.9195654Z                          .PARAMETER MaximizeBuffers
2026-01-11T19:28:13.9196321Z                              Sets Receive/Transmit buffers to maximum (opt-in for pro_gamer).
2026-01-11T19:28:13.9196478Z                          .OUTPUTS
2026-01-11T19:28:13.9197501Z                              None.
2026-01-11T19:28:13.9197617Z                          .NOTES
2026-01-11T19:28:13.9199024Z                              Property names vary by NIC vendor (Intel, Realtek, Killer, etc.).
2026-01-11T19:28:13.9199746Z                              This function attempts multiple common property names for compatibility.
2026-01-11T19:28:13.9199865Z                          #>
2026-01-11T19:28:13.9200853Z                          param(
2026-01-11T19:28:13.9201078Z                              [bool]$DisableInterruptModeration = $true,
2026-01-11T19:28:13.9202310Z                              [bool]$DisableFlowControl = $true,
2026-01-11T19:28:13.9202483Z                              [bool]$DisableEEE = $true,
2026-01-11T19:28:13.9203542Z                              [bool]$DisableLSO = $false,
2026-01-11T19:28:13.9203808Z                              [bool]$MaximizeBuffers = $false
2026-01-11T19:28:13.9204820Z                          )
2026-01-11T19:28:13.9206173Z                      
2026-01-11T19:28:13.9206288Z                          try {
2026-01-11T19:28:13.9206525Z                              $adapter = Get-ActiveNetworkAdapter
2026-01-11T19:28:13.9207657Z                              if (-not $adapter) { return }
2026-01-11T19:28:13.9207986Z                      
2026-01-11T19:28:13.9209446Z                              Write-Log "Configuring network adapter advanced properties..." "INFO"
2026-01-11T19:28:13.9209526Z                      
2026-01-11T19:28:13.9210838Z                              # Helper function to set adapter property with fallback names
2026-01-11T19:28:13.9211025Z                              function Set-AdapterProperty {
2026-01-11T19:28:13.9211483Z                                  param(
2026-01-11T19:28:13.9212629Z                                      [string]$AdapterName,
2026-01-11T19:28:13.9212842Z                                      [string[]]$PropertyNames,
2026-01-11T19:28:13.9213770Z                                      [string]$Value,
2026-01-11T19:28:13.9213959Z                                      [string]$Description
2026-01-11T19:28:13.9215105Z                                  )
2026-01-11T19:28:13.9215231Z                      
2026-01-11T19:28:13.9216821Z                                  $set = $false
2026-01-11T19:28:13.9217070Z                                  foreach ($propName in $PropertyNames) {
2026-01-11T19:28:13.9217801Z                                      try {
2026-01-11T19:28:13.9218208Z                                          $currentProp = Get-NetAdapterAdvancedProperty -Name $AdapterName 
2026-01-11T19:28:13.9219463Z                      -RegistryKeyword $propName -ErrorAction SilentlyContinue
2026-01-11T19:28:13.9219644Z                                          if ($currentProp) {
2026-01-11T19:28:13.9220623Z                                              Set-NetAdapterAdvancedProperty -Name $AdapterName -RegistryKeyword 
2026-01-11T19:28:13.9220893Z                      $propName -RegistryValue $Value -ErrorAction Stop
2026-01-11T19:28:13.9221917Z                                              Write-Log "$Description set to $Value" "SUCCESS"
2026-01-11T19:28:13.9222193Z                                              $set = $true
2026-01-11T19:28:13.9223177Z                                              break
2026-01-11T19:28:13.9223977Z                                          }
2026-01-11T19:28:13.9224737Z                                      } catch {
2026-01-11T19:28:13.9225885Z                                          # Try next property name
2026-01-11T19:28:13.9226083Z                                      }
2026-01-11T19:28:13.9227038Z                                  }
2026-01-11T19:28:13.9227150Z                      
2026-01-11T19:28:13.9228512Z                                  if (-not $set) {
2026-01-11T19:28:13.9228950Z                                      Write-Log "$Description not found on this adapter (may not support it)" "INFO"
2026-01-11T19:28:13.9229748Z                                  }
2026-01-11T19:28:13.9230306Z                              }
2026-01-11T19:28:13.9230541Z                      
2026-01-11T19:28:13.9231834Z                              # Interrupt Moderation
2026-01-11T19:28:13.9232364Z                              if ($DisableInterruptModeration) {
2026-01-11T19:28:13.9233728Z                                  Set-AdapterProperty -AdapterName $adapter.Name `
2026-01-11T19:28:13.9234202Z                                      -PropertyNames @("*InterruptModeration", "ITR") `
2026-01-11T19:28:13.9234502Z                                      -Value "0" `
2026-01-11T19:28:13.9236184Z                                      -Description "Interrupt Moderation"
2026-01-11T19:28:13.9236298Z                              }
2026-01-11T19:28:13.9236402Z                      
2026-01-11T19:28:13.9237557Z                              # Flow Control
2026-01-11T19:28:13.9238556Z                              if ($DisableFlowControl) {
2026-01-11T19:28:13.9238857Z                                  Set-AdapterProperty -AdapterName $adapter.Name `
2026-01-11T19:28:13.9240086Z                                      -PropertyNames @("*FlowControl", "FlowControl") `
2026-01-11T19:28:13.9240568Z                                      -Value "0" `
2026-01-11T19:28:13.9241969Z                                      -Description "Flow Control"
2026-01-11T19:28:13.9242078Z                              }
2026-01-11T19:28:13.9242206Z                      
2026-01-11T19:28:13.9243376Z                              # Energy Efficient Ethernet
2026-01-11T19:28:13.9243520Z                              if ($DisableEEE) {
2026-01-11T19:28:13.9244571Z                                  Set-AdapterProperty -AdapterName $adapter.Name `
2026-01-11T19:28:13.9245766Z                                      -PropertyNames @("EEELinkAdvertisement", "EnergyEfficientEthernet", 
2026-01-11T19:28:13.9245922Z                      "GreenEthernet", "*EEE") `
2026-01-11T19:28:13.9246903Z                                      -Value "0" `
2026-01-11T19:28:13.9247138Z                                      -Description "Energy Efficient Ethernet"
2026-01-11T19:28:13.9248204Z                              }
2026-01-11T19:28:13.9248542Z                      
2026-01-11T19:28:13.9249754Z                              # Large Send Offload (opt-in for pro gamers)
2026-01-11T19:28:13.9249891Z                              if ($DisableLSO) {
2026-01-11T19:28:13.9251047Z                                  Set-AdapterProperty -AdapterName $adapter.Name `
2026-01-11T19:28:13.9251726Z                                      -PropertyNames @("*LsoV2IPv4") `
2026-01-11T19:28:13.9251849Z                                      -Value "0" `
2026-01-11T19:28:13.9252950Z                                      -Description "Large Send Offload v2 (IPv4)"
2026-01-11T19:28:13.9253393Z                      
2026-01-11T19:28:13.9254568Z                                  Set-AdapterProperty -AdapterName $adapter.Name `
2026-01-11T19:28:13.9254944Z                                      -PropertyNames @("*LsoV2IPv6") `
2026-01-11T19:28:13.9255848Z                                      -Value "0" `
2026-01-11T19:28:13.9256742Z                                      -Description "Large Send Offload v2 (IPv6)"
2026-01-11T19:28:13.9257913Z                              }
2026-01-11T19:28:13.9258016Z                      
2026-01-11T19:28:13.9258460Z                              # Maximize Buffers (opt-in for pro gamers)
2026-01-11T19:28:13.9259126Z                              if ($MaximizeBuffers) {
2026-01-11T19:28:13.9260640Z                                  # Try to set buffers to maximum supported value
2026-01-11T19:28:13.9261130Z                                  try {
2026-01-11T19:28:13.9262605Z                                      $rxBuffer = Get-NetAdapterAdvancedProperty -Name $adapter.Name -RegistryKeyword 
2026-01-11T19:28:13.9262837Z                      "*ReceiveBuffers" -ErrorAction SilentlyContinue
2026-01-11T19:28:13.9263298Z                                      if ($rxBuffer) {
2026-01-11T19:28:13.9264518Z                                          # Get max value from ValidDisplayValues
2026-01-11T19:28:13.9265241Z                                          $maxRx = ($rxBuffer.ValidDisplayValues | Measure-Object -Maximum).Maximum
2026-01-11T19:28:13.9265596Z                                          if ($maxRx) {
2026-01-11T19:28:13.9267150Z                                              Set-NetAdapterAdvancedProperty -Name $adapter.Name -RegistryKeyword 
2026-01-11T19:28:13.9267458Z                      "*ReceiveBuffers" -RegistryValue $maxRx -ErrorAction Stop
2026-01-11T19:28:13.9268715Z                                              Write-Log "Receive Buffers set to maximum ($maxRx)" "SUCCESS"
2026-01-11T19:28:13.9268830Z                                          }
2026-01-11T19:28:13.9269435Z                                      }
2026-01-11T19:28:13.9270460Z                                  } catch {
2026-01-11T19:28:13.9271062Z                                      Write-Log "Could not maximize Receive Buffers" "INFO"
2026-01-11T19:28:13.9271935Z                                  }
2026-01-11T19:28:13.9272977Z                      
2026-01-11T19:28:13.9273142Z                                  try {
2026-01-11T19:28:13.9274862Z                                      $txBuffer = Get-NetAdapterAdvancedProperty -Name $adapter.Name -RegistryKeyword 
2026-01-11T19:28:13.9275020Z                      "*TransmitBuffers" -ErrorAction SilentlyContinue
2026-01-11T19:28:13.9275496Z                                      if ($txBuffer) {
2026-01-11T19:28:13.9276870Z                                          $maxTx = ($txBuffer.ValidDisplayValues | Measure-Object -Maximum).Maximum
2026-01-11T19:28:13.9277128Z                                          if ($maxTx) {
2026-01-11T19:28:13.9278415Z                                              Set-NetAdapterAdvancedProperty -Name $adapter.Name -RegistryKeyword 
2026-01-11T19:28:13.9278746Z                      "*TransmitBuffers" -RegistryValue $maxTx -ErrorAction Stop
2026-01-11T19:28:13.9279702Z                                              Write-Log "Transmit Buffers set to maximum ($maxTx)" "SUCCESS"
2026-01-11T19:28:13.9280905Z                                          }
2026-01-11T19:28:13.9281038Z                                      }
2026-01-11T19:28:13.9281201Z                                  } catch {
2026-01-11T19:28:13.9282652Z                                      Write-Log "Could not maximize Transmit Buffers" "INFO"
2026-01-11T19:28:13.9283376Z                                  }
2026-01-11T19:28:13.9284064Z                              }
2026-01-11T19:28:13.9285276Z                      
2026-01-11T19:28:13.9286247Z                              Write-Log "Network adapter advanced properties configured" "SUCCESS"
2026-01-11T19:28:13.9286736Z                              Write-Log "Note: Changes may require network adapter restart to take effect" "INFO"
2026-01-11T19:28:13.9287605Z                      
2026-01-11T19:28:13.9287730Z                          } catch {
2026-01-11T19:28:13.9289650Z                              Write-Log "Error configuring network adapter advanced properties: $_" "ERROR"
2026-01-11T19:28:13.9289951Z                              throw
2026-01-11T19:28:13.9290218Z                          }
2026-01-11T19:28:13.9290785Z                      }
2026-01-11T19:28:13.9291252Z                      
2026-01-11T19:28:13.9291342Z                      
2026-01-11T19:28:13.9293780Z                      function Test-NetworkAdapterAdvancedSettings {
2026-01-11T19:28:13.9293885Z                          <#
2026-01-11T19:28:13.9293978Z                          .SYNOPSIS
2026-01-11T19:28:13.9294256Z                              Verifies network adapter advanced property settings.
2026-01-11T19:28:13.9294875Z                          .DESCRIPTION
2026-01-11T19:28:13.9296262Z                              Checks that Interrupt Moderation, Flow Control, and EEE are disabled.
2026-01-11T19:28:13.9296387Z                          .OUTPUTS
2026-01-11T19:28:13.9297749Z                              [bool] True when checks pass, else false.
2026-01-11T19:28:13.9298976Z                          #>
2026-01-11T19:28:13.9299117Z                          $allPassed = $true
2026-01-11T19:28:13.9299448Z                      
2026-01-11T19:28:13.9300550Z                          Write-Log "Verifying network adapter advanced settings..." "INFO"
2026-01-11T19:28:13.9300971Z                      
2026-01-11T19:28:13.9302142Z                          try {
2026-01-11T19:28:13.9302372Z                              $adapter = Get-ActiveNetworkAdapter
2026-01-11T19:28:13.9303579Z                              if (-not $adapter) { return $false }
2026-01-11T19:28:13.9303710Z                      
2026-01-11T19:28:13.9304811Z                              function Check-AdapterProperty {
2026-01-11T19:28:13.9305517Z                                  param(
2026-01-11T19:28:13.9306342Z                                      [string]$AdapterName,
2026-01-11T19:28:13.9307355Z                                      [string[]]$PropertyNames,
2026-01-11T19:28:13.9307565Z                                      [string]$ExpectedValue,
2026-01-11T19:28:13.9308763Z                                      [string]$Description
2026-01-11T19:28:13.9309196Z                                  )
2026-01-11T19:28:13.9310105Z                      
2026-01-11T19:28:13.9310341Z                                  foreach ($propName in $PropertyNames) {
2026-01-11T19:28:13.9311106Z                                      try {
2026-01-11T19:28:13.9312610Z                                          $prop = Get-NetAdapterAdvancedProperty -Name $AdapterName -RegistryKeyword 
2026-01-11T19:28:13.9312851Z                      $propName -ErrorAction SilentlyContinue
2026-01-11T19:28:13.9313944Z                                          if ($prop) {
2026-01-11T19:28:13.9314565Z                                              if ($prop.RegistryValue -eq $ExpectedValue) {
2026-01-11T19:28:13.9316311Z                                                  Write-Log "‚úì $Description disabled" "SUCCESS"
2026-01-11T19:28:13.9316761Z                                                  return $true
2026-01-11T19:28:13.9316916Z                                              } else {
2026-01-11T19:28:13.9318233Z                                                  Write-Log "‚úó $Description not disabled (current: 
2026-01-11T19:28:13.9318760Z                      $($prop.RegistryValue))" "ERROR"
2026-01-11T19:28:13.9319524Z                                                  return $false
2026-01-11T19:28:13.9320737Z                                              }
2026-01-11T19:28:13.9320847Z                                          }
2026-01-11T19:28:13.9322005Z                                      } catch {
2026-01-11T19:28:13.9322529Z                                          # Try next property name
2026-01-11T19:28:13.9323909Z                                      }
2026-01-11T19:28:13.9324024Z                                  }
2026-01-11T19:28:13.9324960Z                      
2026-01-11T19:28:13.9326181Z                                  Write-Log "‚óã $Description not found on this adapter" "INFO"
2026-01-11T19:28:13.9326703Z                                  return $true  # Don't fail if property doesn't exist
2026-01-11T19:28:13.9327671Z                              }
2026-01-11T19:28:13.9328257Z                      
2026-01-11T19:28:13.9329514Z                              if (-not (Check-AdapterProperty -AdapterName $adapter.Name -PropertyNames 
2026-01-11T19:28:13.9330358Z                      @("*InterruptModeration", "ITR") -ExpectedValue "0" -Description "Interrupt Moderation")) {
2026-01-11T19:28:13.9330507Z                                  $allPassed = $false
2026-01-11T19:28:13.9331445Z                              }
2026-01-11T19:28:13.9331557Z                      
2026-01-11T19:28:13.9333145Z                              if (-not (Check-AdapterProperty -AdapterName $adapter.Name -PropertyNames 
2026-01-11T19:28:13.9333469Z                      @("*FlowControl") -ExpectedValue "0" -Description "Flow Control")) {
2026-01-11T19:28:13.9333703Z                                  $allPassed = $false
2026-01-11T19:28:13.9334823Z                              }
2026-01-11T19:28:13.9335092Z                      
2026-01-11T19:28:13.9336786Z                              if (-not (Check-AdapterProperty -AdapterName $adapter.Name -PropertyNames 
2026-01-11T19:28:13.9337234Z                      @("EEELinkAdvertisement", "EnergyEfficientEthernet", "GreenEthernet") -ExpectedValue "0" 
2026-01-11T19:28:13.9338761Z                      -Description "Energy Efficient Ethernet")) {
2026-01-11T19:28:13.9338891Z                                  $allPassed = $false
2026-01-11T19:28:13.9339982Z                              }
2026-01-11T19:28:13.9340179Z                      
2026-01-11T19:28:13.9341244Z                          } catch {
2026-01-11T19:28:13.9341532Z                              Write-Log "Error verifying adapter settings: $_" "ERROR"
2026-01-11T19:28:13.9342553Z                              return $false
2026-01-11T19:28:13.9342996Z                          }
2026-01-11T19:28:13.9344303Z                      
2026-01-11T19:28:13.9344450Z                          return $allPassed
2026-01-11T19:28:13.9345455Z                      }
2026-01-11T19:28:13.9345779Z                      
2026-01-11T19:28:13.9346629Z                      
2026-01-11T19:28:13.9346843Z                      function Invoke-NetworkOptimizations {
2026-01-11T19:28:13.9347830Z                          <#
2026-01-11T19:28:13.9347952Z                          .SYNOPSIS
2026-01-11T19:28:13.9349384Z                              Applies the full network optimization set.
2026-01-11T19:28:13.9349512Z                          .DESCRIPTION
2026-01-11T19:28:13.9350749Z                              Tunes adapter settings, DNS, IPv4/Teredo, and optional QoS policies.
2026-01-11T19:28:13.9351145Z                          .PARAMETER DNSProvider
2026-01-11T19:28:13.9352349Z                              DNS provider to apply (cloudflare, google, quad9, adguard, opendns, isp).
2026-01-11T19:28:13.9352545Z                          .PARAMETER DisableRSC
2026-01-11T19:28:13.9353058Z                              Disables Receive Segment Coalescing when true.
2026-01-11T19:28:13.9353949Z                          .PARAMETER PreferIPv4
2026-01-11T19:28:13.9354814Z                              Prefers IPv4 over IPv6 when true.
2026-01-11T19:28:13.9355554Z                          .PARAMETER DisableTeredo
2026-01-11T19:28:13.9356820Z                              Disables Teredo tunneling when true.
2026-01-11T19:28:13.9356983Z                          .PARAMETER EnableQoS
2026-01-11T19:28:13.9358012Z                              Enables per-game QoS policies when true.
2026-01-11T19:28:13.9358162Z                          .PARAMETER GameExecutables
2026-01-11T19:28:13.9359442Z                              Executable names for per-game QoS policy creation.
2026-01-11T19:28:13.9359611Z                          .PARAMETER EnableAdapterAdvanced
2026-01-11T19:28:13.9361025Z                              Enables network adapter advanced property optimizations when true.
2026-01-11T19:28:13.9361186Z                          .PARAMETER DisableLSO
2026-01-11T19:28:13.9361798Z                              Disables LSO when adapter advanced settings are enabled (opt-in).
2026-01-11T19:28:13.9362717Z                          .PARAMETER MaximizeBuffers
2026-01-11T19:28:13.9363677Z                              Maximizes adapter buffers when adapter advanced settings are enabled (opt-in).
2026-01-11T19:28:13.9363799Z                          .OUTPUTS
2026-01-11T19:28:13.9364930Z                              None.
2026-01-11T19:28:13.9365249Z                          #>
2026-01-11T19:28:13.9366383Z                          param(
2026-01-11T19:28:13.9367603Z                              [ValidateSet("cloudflare", "google", "quad9", "adguard", "opendns", "isp")]
2026-01-11T19:28:13.9367810Z                              [string]$DNSProvider = "cloudflare",
2026-01-11T19:28:13.9367898Z                      
2026-01-11T19:28:13.9368963Z                              [bool]$DisableRSC = $false,
2026-01-11T19:28:13.9369099Z                      
2026-01-11T19:28:13.9370301Z                              [bool]$PreferIPv4 = $false,
2026-01-11T19:28:13.9370412Z                      
2026-01-11T19:28:13.9371487Z                              [bool]$DisableTeredo = $false,
2026-01-11T19:28:13.9371623Z                      
2026-01-11T19:28:13.9372751Z                              [bool]$EnableQoS = $false,
2026-01-11T19:28:13.9373366Z                      
2026-01-11T19:28:13.9374738Z                              [string[]]$GameExecutables = @("cs2.exe", "dota2.exe", "helldivers2.exe", 
2026-01-11T19:28:13.9374883Z                      "SpaceMarine2.exe"),
2026-01-11T19:28:13.9375302Z                      
2026-01-11T19:28:13.9376438Z                              [bool]$EnableAdapterAdvanced = $true,
2026-01-11T19:28:13.9376542Z                      
2026-01-11T19:28:13.9377603Z                              [bool]$DisableLSO = $false,
2026-01-11T19:28:13.9378034Z                      
2026-01-11T19:28:13.9379393Z                              [bool]$MaximizeBuffers = $false
2026-01-11T19:28:13.9379525Z                          )
2026-01-11T19:28:13.9380255Z                      
2026-01-11T19:28:13.9381519Z                          Write-Log "Applying network optimizations..." "INFO"
2026-01-11T19:28:13.9381654Z                      
2026-01-11T19:28:13.9382849Z                          try {
2026-01-11T19:28:13.9383157Z                              Set-NetworkAdapterOptimizations -DisableRSC $DisableRSC
2026-01-11T19:28:13.9383968Z                      
2026-01-11T19:28:13.9384494Z                              if ($EnableAdapterAdvanced) {
2026-01-11T19:28:13.9385490Z                                  Set-NetworkAdapterAdvancedSettings `
2026-01-11T19:28:13.9386025Z                                      -DisableInterruptModeration $true `
2026-01-11T19:28:13.9386624Z                                      -DisableFlowControl $true `
2026-01-11T19:28:13.9387122Z                                      -DisableEEE $true `
2026-01-11T19:28:13.9388266Z                                      -DisableLSO $DisableLSO `
2026-01-11T19:28:13.9388493Z                                      -MaximizeBuffers $MaximizeBuffers
2026-01-11T19:28:13.9389423Z                              }
2026-01-11T19:28:13.9390304Z                      
2026-01-11T19:28:13.9390549Z                              Set-DNSProvider -Provider $DNSProvider
2026-01-11T19:28:13.9391795Z                      
2026-01-11T19:28:13.9392038Z                              Set-IPv4Preference -Enable $PreferIPv4
2026-01-11T19:28:13.9392403Z                      
2026-01-11T19:28:13.9393865Z                              Disable-Teredo -Enable $DisableTeredo
2026-01-11T19:28:13.9393971Z                      
2026-01-11T19:28:13.9394875Z                              if ($EnableQoS) {
2026-01-11T19:28:13.9395169Z                                  Set-QoSConfiguration -GameExecutables $GameExecutables
2026-01-11T19:28:13.9396074Z                              }
2026-01-11T19:28:13.9396860Z                      
2026-01-11T19:28:13.9397597Z                              Write-Log "Network optimizations complete" "SUCCESS"
2026-01-11T19:28:13.9398655Z                      
2026-01-11T19:28:13.9398797Z                          } catch {
2026-01-11T19:28:13.9400114Z                              Write-Log "Error applying network optimizations: $_" "ERROR"
2026-01-11T19:28:13.9400419Z                              throw
2026-01-11T19:28:13.9401050Z                          }
2026-01-11T19:28:13.9402157Z                      }
2026-01-11T19:28:13.9402282Z                      
2026-01-11T19:28:13.9402988Z                      
2026-01-11T19:28:13.9403866Z                      function Undo-NetworkOptimizations {
2026-01-11T19:28:13.9403996Z                          <#
2026-01-11T19:28:13.9405047Z                          .SYNOPSIS
2026-01-11T19:28:13.9405969Z                              Reverts network-related changes.
2026-01-11T19:28:13.9406108Z                          .DESCRIPTION
2026-01-11T19:28:13.9407472Z                              Resets DNS to DHCP, restores IPv6 defaults, removes QoS policies,
2026-01-11T19:28:13.9407680Z                              and restores TCP/IP registry settings.
2026-01-11T19:28:13.9408811Z                          .OUTPUTS
2026-01-11T19:28:13.9409510Z                              None.
2026-01-11T19:28:13.9410616Z                          #>
2026-01-11T19:28:13.9410947Z                          Write-Log "Rolling back network optimizations..." "INFO"
2026-01-11T19:28:13.9411767Z                      
2026-01-11T19:28:13.9412743Z                          try {
2026-01-11T19:28:13.9412967Z                              $adapter = Get-ActiveNetworkAdapter
2026-01-11T19:28:13.9414040Z                              if ($adapter) {
2026-01-11T19:28:13.9415340Z                                  Set-DnsClientServerAddress -InterfaceIndex $adapter.InterfaceIndex 
2026-01-11T19:28:13.9415493Z                      -ResetServerAddresses
2026-01-11T19:28:13.9416534Z                                  Write-Log "Restored ISP default DNS" "SUCCESS"
2026-01-11T19:28:13.9416883Z                              }
2026-01-11T19:28:13.9417933Z                      
2026-01-11T19:28:13.9418517Z                              try {
2026-01-11T19:28:13.9420167Z                                  Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters" 
2026-01-11T19:28:13.9420366Z                      -Name "DisabledComponents" -Value 0 -ErrorAction SilentlyContinue
2026-01-11T19:28:13.9420919Z                                  Write-Log "Restored IPv6 component defaults" "SUCCESS"
2026-01-11T19:28:13.9421994Z                              } catch {}
2026-01-11T19:28:13.9422682Z                      
2026-01-11T19:28:13.9424015Z                              try { netsh interface teredo set state default 2>&1 | Out-Null } catch {}
2026-01-11T19:28:13.9424168Z                      
2026-01-11T19:28:13.9425561Z                              $qosPolicies = Get-NetQosPolicy | Where-Object { $_.Name -like "Game-*" }
2026-01-11T19:28:13.9425699Z                              foreach ($policy in $qosPolicies) {
2026-01-11T19:28:13.9426968Z                                  Remove-NetQosPolicy -Name $policy.Name -Confirm:$false -ErrorAction SilentlyContinue
2026-01-11T19:28:13.9427327Z                                  Write-Log "Removed QoS policy: $($policy.Name)" "SUCCESS"
2026-01-11T19:28:13.9427430Z                              }
2026-01-11T19:28:13.9428356Z                      
2026-01-11T19:28:13.9429221Z                              $tcpPath = "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters"
2026-01-11T19:28:13.9429721Z                              if (Restore-RegistryKey -Path $tcpPath) {
2026-01-11T19:28:13.9430884Z                                  Write-Log "Restored TCP/IP registry settings" "SUCCESS"
2026-01-11T19:28:13.9431055Z                              }
2026-01-11T19:28:13.9431961Z                      
2026-01-11T19:28:13.9433101Z                              Write-Log "Network optimization rollback complete" "SUCCESS"
2026-01-11T19:28:13.9433479Z                      
2026-01-11T19:28:13.9434356Z                          } catch {
2026-01-11T19:28:13.9434907Z                              Write-Log "Error during rollback: $_" "ERROR"
2026-01-11T19:28:13.9435885Z                              throw
2026-01-11T19:28:13.9435990Z                          }
2026-01-11T19:28:13.9437186Z                      }
2026-01-11T19:28:13.9438167Z                      
2026-01-11T19:28:13.9439012Z                      
2026-01-11T19:28:13.9440475Z                      Export-ModuleMember -Function @(
2026-01-11T19:28:13.9440679Z                          'Get-ActiveNetworkAdapter',
2026-01-11T19:28:13.9442030Z                          'Set-NetworkAdapterOptimizations',
2026-01-11T19:28:13.9442255Z                          'Set-NetworkAdapterAdvancedSettings',
2026-01-11T19:28:13.9443271Z                          'Test-NetworkAdapterAdvancedSettings',
2026-01-11T19:28:13.9443400Z                          'Set-DNSProvider',
2026-01-11T19:28:13.9444499Z                          'Set-IPv4Preference',
2026-01-11T19:28:13.9444633Z                          'Disable-Teredo',
2026-01-11T19:28:13.9445870Z                          'Set-QoSConfiguration',
2026-01-11T19:28:13.9446258Z                          'Enable-QoSGaming',
2026-01-11T19:28:13.9447275Z                          'Disable-NetworkThrottling',
2026-01-11T19:28:13.9447444Z                          'Set-TCPOptimizations',
2026-01-11T19:28:13.9448391Z                          'Remove-NetworkBindings',
2026-01-11T19:28:13.9448742Z                          'Test-NetworkOptimizations',
2026-01-11T19:28:13.9449939Z                          'Invoke-NetworkOptimizations',
2026-01-11T19:28:13.9450122Z                          'Undo-NetworkOptimizations'
2026-01-11T19:28:13.9451106Z                      )
2026-01-11T19:28:13.9451426Z                      
2026-01-11T19:28:13.9452522Z [32;1mParent             : [0m
2026-01-11T19:28:13.9452571Z 
2026-01-11T19:28:13.9490146Z [32;1mAttributes         : [0m{}
2026-01-11T19:28:13.9490347Z [32;1mUsingStatements    : [0m{}
2026-01-11T19:28:13.9490504Z [32;1mParamBlock         : [0m
2026-01-11T19:28:13.9491785Z [32;1mBeginBlock         : [0m
2026-01-11T19:28:13.9492200Z [32;1mProcessBlock       : [0m
2026-01-11T19:28:13.9495304Z [32;1mEndBlock           : [0mImport-Module (Join-Path $PSScriptRoot "..\core\logger.psm1") -Force -Global
2026-01-11T19:28:13.9495747Z                      Import-Module (Join-Path $PSScriptRoot "..\core\registry.psm1") -Force -Global
2026-01-11T19:28:13.9495886Z                      
2026-01-11T19:28:13.9496820Z                      
2026-01-11T19:28:13.9497408Z                      
2026-01-11T19:28:13.9498640Z                      function Test-PerformanceOptimizations {
2026-01-11T19:28:13.9498809Z                          <#
2026-01-11T19:28:13.9499925Z                          .SYNOPSIS
2026-01-11T19:28:13.9500556Z                              Verifies key performance-related registry settings.
2026-01-11T19:28:13.9501463Z                          .DESCRIPTION
2026-01-11T19:28:13.9501850Z                              Checks MMCSS GPU priority, scheduler priority separation, and timer
2026-01-11T19:28:13.9502890Z                              resolution registry preferences.
2026-01-11T19:28:13.9503287Z                          .PARAMETER HPETDisabled
2026-01-11T19:28:13.9504223Z                              Currently unused; retained for parity with historical interfaces.
2026-01-11T19:28:13.9505067Z                          .PARAMETER CoreParkingDisabled
2026-01-11T19:28:13.9505638Z                              Currently unused; retained for parity with historical interfaces.
2026-01-11T19:28:13.9506361Z                          .OUTPUTS
2026-01-11T19:28:13.9507387Z                              [bool] True when checks pass, else false.
2026-01-11T19:28:13.9507494Z                          #>
2026-01-11T19:28:13.9508573Z                          param(
2026-01-11T19:28:13.9509233Z                              [bool]$HPETDisabled = $false,
2026-01-11T19:28:13.9510401Z                              [bool]$CoreParkingDisabled = $false
2026-01-11T19:28:13.9510538Z                          )
2026-01-11T19:28:13.9511861Z                      
2026-01-11T19:28:13.9512032Z                          $allPassed = $true
2026-01-11T19:28:13.9512737Z                      
2026-01-11T19:28:13.9513422Z                          Write-Log "Verifying performance optimizations..." "INFO"
2026-01-11T19:28:13.9513882Z                      
2026-01-11T19:28:13.9515187Z                          $mmcssPath = "HKLM:\SOFTWARE\Microsoft\Windows 
2026-01-11T19:28:13.9515468Z                      NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games"
2026-01-11T19:28:13.9516062Z                          $gpuPriority = Get-RegistryValue -Path $mmcssPath -Name "GPU Priority"
2026-01-11T19:28:13.9517323Z                          if ($gpuPriority -eq 8) {
2026-01-11T19:28:13.9517858Z                              Write-Log "‚úì MMCSS GPU Priority: 8 (correct)" "SUCCESS"
2026-01-11T19:28:13.9518038Z                          } else {
2026-01-11T19:28:13.9519708Z                              Write-Log "‚úó MMCSS GPU Priority incorrect (current: $gpuPriority, expected: 8)" "ERROR"
2026-01-11T19:28:13.9519871Z                              $allPassed = $false
2026-01-11T19:28:13.9520663Z                          }
2026-01-11T19:28:13.9521425Z                      
2026-01-11T19:28:13.9522825Z                          $schedulerPath = "HKLM:\SYSTEM\CurrentControlSet\Control\PriorityControl"
2026-01-11T19:28:13.9523360Z                          $win32Priority = Get-RegistryValue -Path $schedulerPath -Name "Win32PrioritySeparation"
2026-01-11T19:28:13.9523539Z                          if ($win32Priority -eq 26) {
2026-01-11T19:28:13.9524381Z                              Write-Log "‚úì Win32PrioritySeparation: 26 (balanced gaming)" "SUCCESS"
2026-01-11T19:28:13.9524550Z                          } else {
2026-01-11T19:28:13.9526500Z                              Write-Log "‚úó Win32PrioritySeparation incorrect (current: $win32Priority, expected: 26)" 
2026-01-11T19:28:13.9526626Z                      "ERROR"
2026-01-11T19:28:13.9527126Z                              $allPassed = $false
2026-01-11T19:28:13.9528127Z                          }
2026-01-11T19:28:13.9528941Z                      
2026-01-11T19:28:13.9529824Z                          $timerPath = "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\kernel"
2026-01-11T19:28:13.9531050Z                          $globalTimer = Get-RegistryValue -Path $timerPath -Name "GlobalTimerResolutionRequests"
2026-01-11T19:28:13.9531162Z                          if ($globalTimer -eq 1) {
2026-01-11T19:28:13.9532022Z                              Write-Log "‚úì GlobalTimerResolutionRequests enabled" "SUCCESS"
2026-01-11T19:28:13.9532137Z                          }
2026-01-11T19:28:13.9533185Z                      
2026-01-11T19:28:13.9533335Z                          return $allPassed
2026-01-11T19:28:13.9534775Z                      }
2026-01-11T19:28:13.9534903Z                      
2026-01-11T19:28:13.9535758Z                      
2026-01-11T19:28:13.9536966Z                      
2026-01-11T19:28:13.9537089Z                      
2026-01-11T19:28:13.9538257Z                      function Disable-HPET {
2026-01-11T19:28:13.9538365Z                          <#
2026-01-11T19:28:13.9539829Z                          .SYNOPSIS
2026-01-11T19:28:13.9540725Z                              Optionally disables HPET-related boot settings.
2026-01-11T19:28:13.9541148Z                          .DESCRIPTION
2026-01-11T19:28:13.9542393Z                              Uses bcdedit to disable useplatformclock and dynamic tick. This is an
2026-01-11T19:28:13.9542601Z                              opt-in change and requires a reboot.
2026-01-11T19:28:13.9542945Z                          .PARAMETER Enable
2026-01-11T19:28:13.9543951Z                              When true, applies the HPET-related changes.
2026-01-11T19:28:13.9545098Z                          .OUTPUTS
2026-01-11T19:28:13.9545231Z                              None.
2026-01-11T19:28:13.9546092Z                          #>
2026-01-11T19:28:13.9547150Z                          param(
2026-01-11T19:28:13.9547301Z                              [bool]$Enable = $false
2026-01-11T19:28:13.9548390Z                          )
2026-01-11T19:28:13.9548489Z                      
2026-01-11T19:28:13.9549911Z                          if (-not $Enable) {
2026-01-11T19:28:13.9550971Z                              Write-Log "HPET disable: OPT-IN only (skipped, default: keep enabled)" "INFO"
2026-01-11T19:28:13.9551089Z                              return
2026-01-11T19:28:13.9552173Z                          }
2026-01-11T19:28:13.9552374Z                      
2026-01-11T19:28:13.9553717Z                          Write-Log "Disabling HPET (High Precision Event Timer)..." "INFO"
2026-01-11T19:28:13.9553815Z                      
2026-01-11T19:28:13.9554911Z                          try {
2026-01-11T19:28:13.9555205Z                              $result = bcdedit /set useplatformclock false 2>&1
2026-01-11T19:28:13.9555624Z                              if ($LASTEXITCODE -eq 0) {
2026-01-11T19:28:13.9556550Z                                  Write-Log "Disabled useplatformclock" "SUCCESS"
2026-01-11T19:28:13.9556731Z                              } else {
2026-01-11T19:28:13.9558369Z                                  Write-Log "Could not disable useplatformclock (may not be supported)" "ERROR"
2026-01-11T19:28:13.9558520Z                              }
2026-01-11T19:28:13.9559514Z                      
2026-01-11T19:28:13.9560463Z                              $result = bcdedit /set disabledynamictick yes 2>&1
2026-01-11T19:28:13.9560920Z                              if ($LASTEXITCODE -eq 0) {
2026-01-11T19:28:13.9561983Z                                  Write-Log "Disabled dynamic tick" "SUCCESS"
2026-01-11T19:28:13.9562410Z                              } else {
2026-01-11T19:28:13.9563631Z                                  Write-Log "Could not disable disabledynamictick (may not be supported)" "ERROR"
2026-01-11T19:28:13.9563781Z                              }
2026-01-11T19:28:13.9564687Z                      
2026-01-11T19:28:13.9566019Z                              Write-Log "HPET configuration complete. Requires reboot." "SUCCESS"
2026-01-11T19:28:13.9566115Z                      
2026-01-11T19:28:13.9567049Z                          } catch {
2026-01-11T19:28:13.9567587Z                              Write-Log "Error disabling HPET: $_" "ERROR"
2026-01-11T19:28:13.9568415Z                              throw
2026-01-11T19:28:13.9568786Z                          }
2026-01-11T19:28:13.9569326Z                      }
2026-01-11T19:28:13.9570218Z                      
2026-01-11T19:28:13.9571089Z                      
2026-01-11T19:28:13.9571267Z                      function Enable-MSIMode {
2026-01-11T19:28:13.9572614Z                          <#
2026-01-11T19:28:13.9572734Z                          .SYNOPSIS
2026-01-11T19:28:13.9573959Z                              Enables MSI mode for GPU and network adapters.
2026-01-11T19:28:13.9574351Z                          .DESCRIPTION
2026-01-11T19:28:13.9575595Z                              Toggles MessageSignaledInterruptProperties for selected devices to
2026-01-11T19:28:13.9575809Z                              reduce interrupt latency.
2026-01-11T19:28:13.9576815Z                          .OUTPUTS
2026-01-11T19:28:13.9577942Z                              None.
2026-01-11T19:28:13.9578593Z                          #>
2026-01-11T19:28:13.9579802Z                          Write-Log "Configuring MSI Mode for devices (reduces DPC latency)..." "INFO"
2026-01-11T19:28:13.9579943Z                      
2026-01-11T19:28:13.9580977Z                          $msiEnabled = 0
2026-01-11T19:28:13.9581315Z                      
2026-01-11T19:28:13.9581794Z                          try {
2026-01-11T19:28:13.9583189Z                              $gpuDevices = Get-PnpDevice | Where-Object {
2026-01-11T19:28:13.9583771Z                                  ($_.Class -eq "Display") -or
2026-01-11T19:28:13.9584910Z                                  ($_.FriendlyName -like "*NVIDIA*") -or
2026-01-11T19:28:13.9585424Z                                  ($_.FriendlyName -like "*AMD*") -or
2026-01-11T19:28:13.9585615Z                                  ($_.FriendlyName -like "*Intel*")
2026-01-11T19:28:13.9586424Z                              } | Select-Object -First 3
2026-01-11T19:28:13.9587100Z                      
2026-01-11T19:28:13.9588098Z                              foreach ($device in $gpuDevices) {
2026-01-11T19:28:13.9588864Z                                  try {
2026-01-11T19:28:13.9589852Z                                      $deviceId = $device.InstanceId
2026-01-11T19:28:13.9590024Z                                      if ($deviceId) {
2026-01-11T19:28:13.9591268Z                                          $msiPath = "HKLM:\SYSTEM\CurrentControlSet\Enum\$deviceId\Device 
2026-01-11T19:28:13.9591676Z                      Parameters\Interrupt Management\MessageSignaledInterruptProperties"
2026-01-11T19:28:13.9591961Z                                          if (Test-Path $msiPath) {
2026-01-11T19:28:13.9592986Z                                              Backup-RegistryKey -Path $msiPath
2026-01-11T19:28:13.9594137Z                                              Set-RegistryValue -Path $msiPath -Name "MSISupported" -Value 1 -Type 
2026-01-11T19:28:13.9594280Z                      "DWORD"
2026-01-11T19:28:13.9595827Z                                              Write-Log "Enabled MSI mode for GPU: $($device.FriendlyName)" "SUCCESS"
2026-01-11T19:28:13.9596014Z                                              $msiEnabled++
2026-01-11T19:28:13.9596942Z                                          }
2026-01-11T19:28:13.9597982Z                                      }
2026-01-11T19:28:13.9598102Z                                  } catch {
2026-01-11T19:28:13.9599458Z                                      Write-Log "Could not enable MSI mode for $($device.FriendlyName): $_" "ERROR"
2026-01-11T19:28:13.9599531Z                                  }
2026-01-11T19:28:13.9600379Z                              }
2026-01-11T19:28:13.9601127Z                      
2026-01-11T19:28:13.9602115Z                              $netAdapters = Get-NetAdapter | Where-Object { $_.Status -eq "Up" }
2026-01-11T19:28:13.9602330Z                              foreach ($adapter in $netAdapters) {
2026-01-11T19:28:13.9603212Z                                  try {
2026-01-11T19:28:13.9604743Z                                      $netDevice = Get-PnpDevice | Where-Object { $_.FriendlyName -eq 
2026-01-11T19:28:13.9604931Z                      $adapter.InterfaceDescription } | Select-Object -First 1
2026-01-11T19:28:13.9605504Z                                      if ($netDevice -and $netDevice.InstanceId) {
2026-01-11T19:28:13.9606421Z                                          $deviceId = $netDevice.InstanceId
2026-01-11T19:28:13.9607606Z                                          $msiPath = "HKLM:\SYSTEM\CurrentControlSet\Enum\$deviceId\Device 
2026-01-11T19:28:13.9607890Z                      Parameters\Interrupt Management\MessageSignaledInterruptProperties"
2026-01-11T19:28:13.9609075Z                                          if (Test-Path $msiPath) {
2026-01-11T19:28:13.9609344Z                                              Backup-RegistryKey -Path $msiPath
2026-01-11T19:28:13.9610635Z                                              Set-RegistryValue -Path $msiPath -Name "MSISupported" -Value 1 -Type 
2026-01-11T19:28:13.9610760Z                      "DWORD"
2026-01-11T19:28:13.9611933Z                                              Write-Log "Enabled MSI mode for network adapter: $($adapter.Name)" 
2026-01-11T19:28:13.9612277Z                      "SUCCESS"
2026-01-11T19:28:13.9612833Z                                              $msiEnabled++
2026-01-11T19:28:13.9613317Z                                          }
2026-01-11T19:28:13.9614461Z                                      }
2026-01-11T19:28:13.9614577Z                                  } catch {
2026-01-11T19:28:13.9616384Z                                      Write-Log "Could not enable MSI mode for network adapter $($adapter.Name): $_" 
2026-01-11T19:28:13.9616508Z                      "ERROR"
2026-01-11T19:28:13.9616603Z                                  }
2026-01-11T19:28:13.9617563Z                              }
2026-01-11T19:28:13.9617897Z                      
2026-01-11T19:28:13.9618789Z                              if ($msiEnabled -gt 0) {
2026-01-11T19:28:13.9619585Z                                  Write-Log "MSI Mode enabled for $msiEnabled device(s). Reboot required." "SUCCESS"
2026-01-11T19:28:13.9619925Z                              } else {
2026-01-11T19:28:13.9621342Z                                  Write-Log "No devices found that support MSI Mode, or it's already enabled" "INFO"
2026-01-11T19:28:13.9621452Z                              }
2026-01-11T19:28:13.9621776Z                      
2026-01-11T19:28:13.9622573Z                          } catch {
2026-01-11T19:28:13.9622807Z                              Write-Log "Error enabling MSI mode: $_" "ERROR"
2026-01-11T19:28:13.9623803Z                              throw
2026-01-11T19:28:13.9623909Z                          }
2026-01-11T19:28:13.9625107Z                      }
2026-01-11T19:28:13.9625219Z                      
2026-01-11T19:28:13.9626376Z                      
2026-01-11T19:28:13.9626765Z                      function Set-CoreParking {
2026-01-11T19:28:13.9627883Z                          <#
2026-01-11T19:28:13.9628004Z                          .SYNOPSIS
2026-01-11T19:28:13.9629356Z                              Disables CPU core parking (opt-in).
2026-01-11T19:28:13.9629518Z                          .DESCRIPTION
2026-01-11T19:28:13.9630874Z                              Updates power-related registry settings and per-scheme powercfg values
2026-01-11T19:28:13.9631042Z                              to keep cores unparked.
2026-01-11T19:28:13.9632199Z                          .PARAMETER Disable
2026-01-11T19:28:13.9632690Z                              When true, disables core parking.
2026-01-11T19:28:13.9633624Z                          .OUTPUTS
2026-01-11T19:28:13.9634365Z                              None.
2026-01-11T19:28:13.9634560Z                          #>
2026-01-11T19:28:13.9635890Z                          param(
2026-01-11T19:28:13.9637237Z                              [bool]$Disable = $false
2026-01-11T19:28:13.9637725Z                          )
2026-01-11T19:28:13.9638961Z                      
2026-01-11T19:28:13.9639134Z                          if (-not $Disable) {
2026-01-11T19:28:13.9640571Z                              Write-Log "Core parking: KEPT ENABLED (default, especially for X3D CPUs)" "INFO"
2026-01-11T19:28:13.9640698Z                              return
2026-01-11T19:28:13.9641089Z                          }
2026-01-11T19:28:13.9641701Z                      
2026-01-11T19:28:13.9642908Z                          Write-Log "Disabling CPU core parking (opt-in)..." "INFO"
2026-01-11T19:28:13.9643014Z                      
2026-01-11T19:28:13.9644285Z                          try {
2026-01-11T19:28:13.9644594Z                              $cpuParkPath = "HKLM:\SYSTEM\CurrentControlSet\Control\Power"
2026-01-11T19:28:13.9645516Z                              Backup-RegistryKey -Path $cpuParkPath
2026-01-11T19:28:13.9646290Z                              Set-RegistryValue -Path $cpuParkPath -Name "CpuParkingEnabled" -Value 0 -Type "DWORD"
2026-01-11T19:28:13.9647022Z                              Set-RegistryValue -Path $cpuParkPath -Name "CpuParkingMinCores" -Value 100 -Type "DWORD"
2026-01-11T19:28:13.9647111Z                      
2026-01-11T19:28:13.9648550Z                              $schemes = powercfg /list | Select-String "GUID" | ForEach-Object { ($_ -split '\s+')[-1] 
2026-01-11T19:28:13.9648744Z                      }
2026-01-11T19:28:13.9649251Z                              foreach ($scheme in $schemes) {
2026-01-11T19:28:13.9650132Z                                  powercfg /setacvalueindex $scheme 54533251-82be-4824-96c1-47b60b740d00 
2026-01-11T19:28:13.9650424Z                      0cc5b647-c1df-4637-891a-dec35c318583 0 2>&1 | Out-Null
2026-01-11T19:28:13.9651785Z                                  powercfg /setdcvalueindex $scheme 54533251-82be-4824-96c1-47b60b740d00 
2026-01-11T19:28:13.9652048Z                      0cc5b647-c1df-4637-891a-dec35c318583 0 2>&1 | Out-Null
2026-01-11T19:28:13.9652887Z                              }
2026-01-11T19:28:13.9652991Z                      
2026-01-11T19:28:13.9654134Z                              Write-Log "Disabled CPU core parking" "SUCCESS"
2026-01-11T19:28:13.9654455Z                      
2026-01-11T19:28:13.9655457Z                          } catch {
2026-01-11T19:28:13.9656886Z                              Write-Log "Error configuring core parking: $_" "ERROR"
2026-01-11T19:28:13.9657039Z                              throw
2026-01-11T19:28:13.9657802Z                          }
2026-01-11T19:28:13.9658499Z                      }
2026-01-11T19:28:13.9659560Z                      
2026-01-11T19:28:13.9660092Z                      
2026-01-11T19:28:13.9660911Z                      function Set-SchedulerOptimizations {
2026-01-11T19:28:13.9661156Z                          <#
2026-01-11T19:28:13.9661946Z                          .SYNOPSIS
2026-01-11T19:28:13.9663143Z                              Applies Windows scheduler tuning for games.
2026-01-11T19:28:13.9663311Z                          .DESCRIPTION
2026-01-11T19:28:13.9664295Z                              Sets Win32PrioritySeparation and IRQ8Priority to values commonly used
2026-01-11T19:28:13.9664749Z                              for balanced gaming performance.
2026-01-11T19:28:13.9665634Z                          .OUTPUTS
2026-01-11T19:28:13.9666344Z                              None.
2026-01-11T19:28:13.9667162Z                          #>
2026-01-11T19:28:13.9667920Z                          try {
2026-01-11T19:28:13.9669559Z                              $schedulerPath = "HKLM:\SYSTEM\CurrentControlSet\Control\PriorityControl"
2026-01-11T19:28:13.9669789Z                              Backup-RegistryKey -Path $schedulerPath
2026-01-11T19:28:13.9669877Z                      
2026-01-11T19:28:13.9671434Z                              Set-RegistryValue -Path $schedulerPath -Name "Win32PrioritySeparation" -Value 26 -Type 
2026-01-11T19:28:13.9671540Z                      "DWORD"
2026-01-11T19:28:13.9672131Z                              Write-Log "Set Win32PrioritySeparation to 26 (balanced gaming)" "SUCCESS"
2026-01-11T19:28:13.9672615Z                      
2026-01-11T19:28:13.9673166Z                              Set-RegistryValue -Path $schedulerPath -Name "IRQ8Priority" -Value 1 -Type "DWORD"
2026-01-11T19:28:13.9674234Z                              Write-Log "Set IRQ8Priority for frame time consistency" "SUCCESS"
2026-01-11T19:28:13.9674341Z                      
2026-01-11T19:28:13.9674754Z                          } catch {
2026-01-11T19:28:13.9676159Z                              Write-Log "Error configuring scheduler: $_" "ERROR"
2026-01-11T19:28:13.9676252Z                              throw
2026-01-11T19:28:13.9676333Z                          }
2026-01-11T19:28:13.9677350Z                      }
2026-01-11T19:28:13.9677692Z                      
2026-01-11T19:28:13.9678304Z                      
2026-01-11T19:28:13.9679588Z                      function Set-TimerResolution {
2026-01-11T19:28:13.9679684Z                          <#
2026-01-11T19:28:13.9680624Z                          .SYNOPSIS
2026-01-11T19:28:13.9680909Z                              Configures registry preferences for timer resolution.
2026-01-11T19:28:13.9682229Z                          .DESCRIPTION
2026-01-11T19:28:13.9682514Z                              Enables GlobalTimerResolutionRequests and sets related multimedia and
2026-01-11T19:28:13.9683619Z                              power settings that influence timer behavior. Use timer-tool.ps1 at
2026-01-11T19:28:13.9683815Z                              runtime for actual 0.5ms resolution.
2026-01-11T19:28:13.9684852Z                          .OUTPUTS
2026-01-11T19:28:13.9685336Z                              None.
2026-01-11T19:28:13.9686381Z                          #>
2026-01-11T19:28:13.9686811Z                          try {
2026-01-11T19:28:13.9688171Z                              $timerPath = "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\kernel"
2026-01-11T19:28:13.9688378Z                              Backup-RegistryKey -Path $timerPath
2026-01-11T19:28:13.9689633Z                              Set-RegistryValue -Path $timerPath -Name "GlobalTimerResolutionRequests" -Value 1 -Type 
2026-01-11T19:28:13.9689763Z                      "DWORD"
2026-01-11T19:28:13.9689877Z                      
2026-01-11T19:28:13.9691314Z                              $multimediaPath = "HKLM:\SOFTWARE\Microsoft\Windows 
2026-01-11T19:28:13.9691494Z                      NT\CurrentVersion\Multimedia\SystemProfile"
2026-01-11T19:28:13.9692334Z                              Backup-RegistryKey -Path $multimediaPath
2026-01-11T19:28:13.9693771Z                              Set-RegistryValue -Path $multimediaPath -Name "SystemResponsiveness" -Value 0 -Type 
2026-01-11T19:28:13.9693899Z                      "DWORD"
2026-01-11T19:28:13.9693992Z                      
2026-01-11T19:28:13.9695240Z                              $powerPath = "HKLM:\SYSTEM\CurrentControlSet\Control\Power"
2026-01-11T19:28:13.9695427Z                              Backup-RegistryKey -Path $powerPath
2026-01-11T19:28:13.9696966Z                              Set-RegistryValue -Path $powerPath -Name "EnergyEstimationEnabled" -Value 0 -Type "DWORD"
2026-01-11T19:28:13.9697774Z                              Set-RegistryValue -Path $powerPath -Name "PlatformAoAcOverride" -Value 0 -Type "DWORD"
2026-01-11T19:28:13.9697915Z                      
2026-01-11T19:28:13.9699029Z                              Set-RegistryValue -Path $powerPath -Name "CsEnabled" -Value 0 -Type "DWORD"
2026-01-11T19:28:13.9699162Z                      
2026-01-11T19:28:13.9700977Z                              Write-Log "Timer resolution registry configured. Use timer-tool.ps1 during gameplay." 
2026-01-11T19:28:13.9701099Z                      "SUCCESS"
2026-01-11T19:28:13.9701193Z                      
2026-01-11T19:28:13.9702037Z                          } catch {
2026-01-11T19:28:13.9703305Z                              Write-Log "Error configuring timer resolution: $_" "ERROR"
2026-01-11T19:28:13.9703470Z                              throw
2026-01-11T19:28:13.9704645Z                          }
2026-01-11T19:28:13.9704762Z                      }
2026-01-11T19:28:13.9705932Z                      
2026-01-11T19:28:13.9706054Z                      
2026-01-11T19:28:13.9707008Z                      function Set-MMCSSGamingTweaks {
2026-01-11T19:28:13.9707134Z                          <#
2026-01-11T19:28:13.9708022Z                          .SYNOPSIS
2026-01-11T19:28:13.9708731Z                              Applies MMCSS tweaks for gaming workloads.
2026-01-11T19:28:13.9708878Z                          .DESCRIPTION
2026-01-11T19:28:13.9710147Z                              Adjusts MMCSS game task priorities to favor GPU and CPU scheduling.
2026-01-11T19:28:13.9710279Z                          .OUTPUTS
2026-01-11T19:28:13.9711152Z                              None.
2026-01-11T19:28:13.9711586Z                          #>
2026-01-11T19:28:13.9712431Z                          try {
2026-01-11T19:28:13.9713364Z                              $mmcssGamesPath = "HKLM:\SOFTWARE\Microsoft\Windows 
2026-01-11T19:28:13.9713823Z                      NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games"
2026-01-11T19:28:13.9714806Z                              Backup-RegistryKey -Path $mmcssGamesPath
2026-01-11T19:28:13.9715216Z                      
2026-01-11T19:28:13.9716618Z                              Set-RegistryValue -Path $mmcssGamesPath -Name "GPU Priority" -Value 8 -Type "DWORD"
2026-01-11T19:28:13.9717339Z                              Set-RegistryValue -Path $mmcssGamesPath -Name "Priority" -Value 6 -Type "DWORD"
2026-01-11T19:28:13.9718533Z                              Set-RegistryValue -Path $mmcssGamesPath -Name "Scheduling Category" -Value "High" -Type 
2026-01-11T19:28:13.9718933Z                      "String"
2026-01-11T19:28:13.9720317Z                              Set-RegistryValue -Path $mmcssGamesPath -Name "SFIO Priority" -Value "High" -Type "String"
2026-01-11T19:28:13.9720436Z                      
2026-01-11T19:28:13.9721561Z                              Write-Log "Applied MMCSS gaming tweaks (prioritizes games)" "SUCCESS"
2026-01-11T19:28:13.9721676Z                      
2026-01-11T19:28:13.9722676Z                          } catch {
2026-01-11T19:28:13.9722908Z                              Write-Log "Error configuring MMCSS: $_" "ERROR"
2026-01-11T19:28:13.9723944Z                              throw
2026-01-11T19:28:13.9724051Z                          }
2026-01-11T19:28:13.9725144Z                      }
2026-01-11T19:28:13.9725249Z                      
2026-01-11T19:28:13.9726232Z                      
2026-01-11T19:28:13.9726996Z                      function Enable-GameMode {
2026-01-11T19:28:13.9727136Z                          <#
2026-01-11T19:28:13.9728357Z                          .SYNOPSIS
2026-01-11T19:28:13.9728536Z                              Enables Windows Game Mode.
2026-01-11T19:28:13.9729747Z                          .DESCRIPTION
2026-01-11T19:28:13.9729962Z                              Sets the policy manager flag for Game Mode.
2026-01-11T19:28:13.9730782Z                          .OUTPUTS
2026-01-11T19:28:13.9730911Z                              None.
2026-01-11T19:28:13.9732084Z                          #>
2026-01-11T19:28:13.9732196Z                          try {
2026-01-11T19:28:13.9733878Z                              $gameModePath = 
2026-01-11T19:28:13.9734324Z                      "HKLM:\SOFTWARE\Microsoft\PolicyManager\default\ApplicationManagement\AllowGameMode"
2026-01-11T19:28:13.9734842Z                              Backup-RegistryKey -Path $gameModePath
2026-01-11T19:28:13.9735469Z                              Set-RegistryValue -Path $gameModePath -Name "value" -Value 1 -Type "DWORD"
2026-01-11T19:28:13.9736270Z                      
2026-01-11T19:28:13.9736531Z                              Write-Log "Enabled Windows Game Mode" "SUCCESS"
2026-01-11T19:28:13.9738502Z                      
2026-01-11T19:28:13.9738635Z                          } catch {
2026-01-11T19:28:13.9738927Z                              Write-Log "Error enabling Game Mode: $_" "ERROR"
2026-01-11T19:28:13.9739992Z                              throw
2026-01-11T19:28:13.9740293Z                          }
2026-01-11T19:28:13.9741036Z                      }
2026-01-11T19:28:13.9741684Z                      
2026-01-11T19:28:13.9742720Z                      
2026-01-11T19:28:13.9742867Z                      function Set-GameDVR {
2026-01-11T19:28:13.9743877Z                          <#
2026-01-11T19:28:13.9744003Z                          .SYNOPSIS
2026-01-11T19:28:13.9745365Z                              Disables GameDVR capture and recording.
2026-01-11T19:28:13.9745491Z                          .DESCRIPTION
2026-01-11T19:28:13.9746733Z                              Turns off GameDVR capture and sets related GameConfigStore values.
2026-01-11T19:28:13.9747104Z                          .PARAMETER Enable
2026-01-11T19:28:13.9748321Z                              When true, applies the disablement (opt-in flag naming kept for API parity).
2026-01-11T19:28:13.9748698Z                          .OUTPUTS
2026-01-11T19:28:13.9749131Z                              None.
2026-01-11T19:28:13.9750087Z                          #>
2026-01-11T19:28:13.9750889Z                          param(
2026-01-11T19:28:13.9751874Z                              [bool]$Enable = $true
2026-01-11T19:28:13.9751982Z                          )
2026-01-11T19:28:13.9753042Z                      
2026-01-11T19:28:13.9753476Z                          if (-not $Enable) {
2026-01-11T19:28:13.9754332Z                              Write-Log "GameDVR disable skipped by config" "INFO"
2026-01-11T19:28:13.9755451Z                              return
2026-01-11T19:28:13.9756405Z                          }
2026-01-11T19:28:13.9757549Z                      
2026-01-11T19:28:13.9757687Z                          try {
2026-01-11T19:28:13.9758959Z                              $dvrPath = "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\GameDVR"
2026-01-11T19:28:13.9759276Z                              Backup-RegistryKey -Path $dvrPath
2026-01-11T19:28:13.9760267Z                              Set-RegistryValue -Path $dvrPath -Name "AppCaptureEnabled" -Value 0 -Type "DWORD"
2026-01-11T19:28:13.9760742Z                              Set-RegistryValue -Path $dvrPath -Name "GameDVR_Enabled" -Value 0 -Type "DWORD"
2026-01-11T19:28:13.9760864Z                      
2026-01-11T19:28:13.9762117Z                              $configStore = "HKCU:\System\GameConfigStore"
2026-01-11T19:28:13.9762338Z                              Backup-RegistryKey -Path $configStore
2026-01-11T19:28:13.9763564Z                              Set-RegistryValue -Path $configStore -Name "GameDVR_FSEBehaviorMode" -Value 2 -Type 
2026-01-11T19:28:13.9763694Z                      "DWORD"
2026-01-11T19:28:13.9764837Z                              Set-RegistryValue -Path $configStore -Name "GameDVR_HonorUserFSEBehaviorMode" -Value 1 
2026-01-11T19:28:13.9764995Z                      -Type "DWORD"
2026-01-11T19:28:13.9766103Z                      
2026-01-11T19:28:13.9766732Z                              Write-Log "GameDVR disabled (capture + FSE behavior)" "SUCCESS"
2026-01-11T19:28:13.9767673Z                          } catch {
2026-01-11T19:28:13.9767905Z                              Write-Log "Error disabling GameDVR: $_" "ERROR"
2026-01-11T19:28:13.9768859Z                              throw
2026-01-11T19:28:13.9769712Z                          }
2026-01-11T19:28:13.9770370Z                      }
2026-01-11T19:28:13.9771478Z                      
2026-01-11T19:28:13.9771602Z                      
2026-01-11T19:28:13.9772418Z                      function Set-FullscreenOptimizations {
2026-01-11T19:28:13.9773192Z                          <#
2026-01-11T19:28:13.9773419Z                          .SYNOPSIS
2026-01-11T19:28:13.9775221Z                              Disables Fullscreen Optimizations (FSO).
2026-01-11T19:28:13.9775360Z                          .DESCRIPTION
2026-01-11T19:28:13.9776702Z                              Writes GameConfigStore values to opt out of FSO for reduced overhead.
2026-01-11T19:28:13.9776873Z                          .PARAMETER Enable
2026-01-11T19:28:13.9777887Z                              When true, applies the disablement (opt-in flag naming kept for API parity).
2026-01-11T19:28:13.9778276Z                          .OUTPUTS
2026-01-11T19:28:13.9779519Z                              None.
2026-01-11T19:28:13.9779839Z                          #>
2026-01-11T19:28:13.9780609Z                          param(
2026-01-11T19:28:13.9781760Z                              [bool]$Enable = $true
2026-01-11T19:28:13.9781882Z                          )
2026-01-11T19:28:13.9782698Z                      
2026-01-11T19:28:13.9783835Z                          if (-not $Enable) {
2026-01-11T19:28:13.9784395Z                              Write-Log "FSO disable skipped by config" "INFO"
2026-01-11T19:28:13.9785122Z                              return
2026-01-11T19:28:13.9786071Z                          }
2026-01-11T19:28:13.9786409Z                      
2026-01-11T19:28:13.9787041Z                          try {
2026-01-11T19:28:13.9787964Z                              $configStore = "HKCU:\System\GameConfigStore"
2026-01-11T19:28:13.9788722Z                              Backup-RegistryKey -Path $configStore
2026-01-11T19:28:13.9790206Z                              Set-RegistryValue -Path $configStore -Name "GameDVR_FSEBehaviorMode" -Value 2 -Type 
2026-01-11T19:28:13.9790288Z                      "DWORD"
2026-01-11T19:28:13.9791796Z                              Set-RegistryValue -Path $configStore -Name "GameDVR_HonorUserFSEBehaviorMode" -Value 1 
2026-01-11T19:28:13.9791928Z                      -Type "DWORD"
2026-01-11T19:28:13.9792465Z                              Write-Log "Fullscreen Optimizations disabled (watch HDR/color-managed titles)" "SUCCESS"
2026-01-11T19:28:13.9792603Z                          } catch {
2026-01-11T19:28:13.9793594Z                              Write-Log "Error disabling Fullscreen Optimizations: $_" "ERROR"
2026-01-11T19:28:13.9794010Z                              throw
2026-01-11T19:28:13.9795061Z                          }
2026-01-11T19:28:13.9795529Z                      }
2026-01-11T19:28:13.9796875Z                      
2026-01-11T19:28:13.9797224Z                      
2026-01-11T19:28:13.9798213Z                      function Test-NVMeSupport {
2026-01-11T19:28:13.9798640Z                          <#
2026-01-11T19:28:13.9799398Z                          .SYNOPSIS
2026-01-11T19:28:13.9800561Z                              Tests if Native NVMe optimization can be applied to this system.
2026-01-11T19:28:13.9800768Z                          .DESCRIPTION
2026-01-11T19:28:13.9801741Z                              Checks for:
2026-01-11T19:28:13.9802278Z                              1. NVMe drives present
2026-01-11T19:28:13.9803380Z                              2. Windows 11 24H2+ (Build 26100+) or Windows Server 2025
2026-01-11T19:28:13.9803858Z                              3. Using Windows in-box stornvme.sys driver (not vendor driver)
2026-01-11T19:28:13.9804192Z                          .OUTPUTS
2026-01-11T19:28:13.9805447Z                              PSObject with HasNVMe, IsSupported, UsesInboxDriver, Message properties
2026-01-11T19:28:13.9805566Z                          #>
2026-01-11T19:28:13.9806117Z                      
2026-01-11T19:28:13.9807014Z                          $result = [PSCustomObject]@{
2026-01-11T19:28:13.9807621Z                              HasNVMe = $false
2026-01-11T19:28:13.9808673Z                              IsSupported = $false
2026-01-11T19:28:13.9809094Z                              UsesInboxDriver = $false
2026-01-11T19:28:13.9809951Z                              BuildNumber = 0
2026-01-11T19:28:13.9811508Z                              Message = ""
2026-01-11T19:28:13.9811706Z                              NVMeDrives = @()
2026-01-11T19:28:13.9812059Z                          }
2026-01-11T19:28:13.9812476Z                      
2026-01-11T19:28:13.9812897Z                          try {
2026-01-11T19:28:13.9813363Z                              # Check for NVMe drives
2026-01-11T19:28:13.9813999Z                              $nvmeDrives = Get-PhysicalDisk | Where-Object { $_.BusType -eq "NVMe" }
2026-01-11T19:28:13.9814394Z                              if (-not $nvmeDrives) {
2026-01-11T19:28:13.9814642Z                                  $result.Message = "No NVMe drives detected"
2026-01-11T19:28:13.9815759Z                                  Write-Log "Native NVMe: No NVMe drives detected" "INFO"
2026-01-11T19:28:13.9816921Z                                  return $result
2026-01-11T19:28:13.9817152Z                              }
2026-01-11T19:28:13.9818304Z                      
2026-01-11T19:28:13.9818627Z                              $result.HasNVMe = $true
2026-01-11T19:28:13.9820042Z                              $result.NVMeDrives = $nvmeDrives | Select-Object FriendlyName, MediaType, Size
2026-01-11T19:28:13.9820646Z                              Write-Log "Native NVMe: Found $($nvmeDrives.Count) NVMe drive(s)" "INFO"
2026-01-11T19:28:13.9820751Z                      
2026-01-11T19:28:13.9821788Z                              # Check Windows version (Build 26100+ for Windows 11 24H2)
2026-01-11T19:28:13.9822294Z                              $build = [int](Get-CimInstance Win32_OperatingSystem).BuildNumber
2026-01-11T19:28:13.9823352Z                              $result.BuildNumber = $build
2026-01-11T19:28:13.9824047Z                      
2026-01-11T19:28:13.9824507Z                              if ($build -lt 26100) {
2026-01-11T19:28:13.9824968Z                                  $result.Message = "Requires Windows 11 24H2+ (Build 26100+). Current: $build"
2026-01-11T19:28:13.9825736Z                                  Write-Log "Native NVMe: Unsupported Windows version (Build $build, need 26100+)" 
2026-01-11T19:28:13.9826148Z                      "INFO"
2026-01-11T19:28:13.9827280Z                                  return $result
2026-01-11T19:28:13.9828090Z                              }
2026-01-11T19:28:13.9829234Z                      
2026-01-11T19:28:13.9829434Z                              $result.IsSupported = $true
2026-01-11T19:28:13.9830590Z                      
2026-01-11T19:28:13.9831135Z                              # Check if using in-box stornvme driver
2026-01-11T19:28:13.9832367Z                              $stornvmeDevices = Get-PnpDevice -Class DiskDrive -ErrorAction SilentlyContinue | 
2026-01-11T19:28:13.9832544Z                      Where-Object {
2026-01-11T19:28:13.9833545Z                                  $_.InstanceId -like "*NVME*"
2026-01-11T19:28:13.9833903Z                              } | ForEach-Object {
2026-01-11T19:28:13.9835277Z                                  $svc = (Get-PnpDeviceProperty -InstanceId $_.InstanceId -KeyName 
2026-01-11T19:28:13.9835599Z                      "DEVPKEY_Device_Service" -ErrorAction SilentlyContinue).Data
2026-01-11T19:28:13.9836182Z                                  if ($svc -eq "stornvme") { $_ }
2026-01-11T19:28:13.9836791Z                              }
2026-01-11T19:28:13.9837972Z                      
2026-01-11T19:28:13.9838124Z                              if ($stornvmeDevices) {
2026-01-11T19:28:13.9839062Z                                  $result.UsesInboxDriver = $true
2026-01-11T19:28:13.9839513Z                                  Write-Log "Native NVMe: Using Windows in-box stornvme.sys driver" "SUCCESS"
2026-01-11T19:28:13.9840444Z                              } else {
2026-01-11T19:28:13.9840915Z                                  Write-Log "Native NVMe: Using vendor NVMe driver (in-box driver not detected)" "INFO"
2026-01-11T19:28:13.9842454Z                                  $result.Message = "NVMe drives using vendor driver - Native NVMe only works with 
2026-01-11T19:28:13.9842558Z                      stornvme.sys"
2026-01-11T19:28:13.9842679Z                              }
2026-01-11T19:28:13.9843717Z                      
2026-01-11T19:28:13.9844254Z                              if (-not $result.Message) {
2026-01-11T19:28:13.9845294Z                                  $result.Message = "System supports Native NVMe optimization"
2026-01-11T19:28:13.9845406Z                              }
2026-01-11T19:28:13.9846348Z                      
2026-01-11T19:28:13.9846465Z                          } catch {
2026-01-11T19:28:13.9847781Z                              $result.Message = "Error checking NVMe support: $_"
2026-01-11T19:28:13.9848029Z                              Write-Log "Native NVMe: Error during detection - $_" "ERROR"
2026-01-11T19:28:13.9848979Z                          }
2026-01-11T19:28:13.9849706Z                      
2026-01-11T19:28:13.9850614Z                          return $result
2026-01-11T19:28:13.9850756Z                      }
2026-01-11T19:28:13.9850890Z                      
2026-01-11T19:28:13.9852057Z                      
2026-01-11T19:28:13.9852718Z                      function Enable-NativeNVMe {
2026-01-11T19:28:13.9853537Z                          <#
2026-01-11T19:28:13.9853658Z                          .SYNOPSIS
2026-01-11T19:28:13.9854824Z                              Enables Native NVMe I/O path on Windows 11 24H2+ / Server 2025.
2026-01-11T19:28:13.9855656Z                          .DESCRIPTION
2026-01-11T19:28:13.9856816Z                              Eliminates SCSI translation layer for NVMe drives, delivering:
2026-01-11T19:28:13.9857479Z                              - Up to ~80% more IOPS
2026-01-11T19:28:13.9858411Z                              - ~45% reduction in CPU cycles per I/O
2026-01-11T19:28:13.9859414Z                              - Direct multi-queue access to NVMe hardware
2026-01-11T19:28:13.9859519Z                      
2026-01-11T19:28:13.9860914Z                              After reboot, NVMe devices move from "Disk drives" to "Storage disks" in Device Manager.
2026-01-11T19:28:13.9861025Z                      
2026-01-11T19:28:13.9862485Z                              EXPERIMENTAL: Known issues with Data Deduplication - disable dedup first if enabled.
2026-01-11T19:28:13.9862660Z                          .PARAMETER Enable
2026-01-11T19:28:13.9863485Z                              If false, skips enabling Native NVMe (opt-in only)
2026-01-11T19:28:13.9864360Z                          .PARAMETER Force
2026-01-11T19:28:13.9865056Z                              If true, enables even if vendor driver detected (may have no effect)
2026-01-11T19:28:13.9865922Z                          #>
2026-01-11T19:28:13.9866393Z                          param(
2026-01-11T19:28:13.9867344Z                              [bool]$Enable = $false,
2026-01-11T19:28:13.9868095Z                              [bool]$Force = $false
2026-01-11T19:28:13.9868524Z                          )
2026-01-11T19:28:13.9869466Z                      
2026-01-11T19:28:13.9869633Z                          if (-not $Enable) {
2026-01-11T19:28:13.9870964Z                              Write-Log "Native NVMe: OPT-IN only (skipped)" "INFO"
2026-01-11T19:28:13.9871098Z                              return $false
2026-01-11T19:28:13.9871948Z                          }
2026-01-11T19:28:13.9872047Z                      
2026-01-11T19:28:13.9873305Z                          Write-Log "Enabling Native NVMe I/O path..." "INFO"
2026-01-11T19:28:13.9874117Z                      
2026-01-11T19:28:13.9875419Z                          try {
2026-01-11T19:28:13.9876133Z                              # Run detection
2026-01-11T19:28:13.9877149Z                              $support = Test-NVMeSupport
2026-01-11T19:28:13.9877535Z                      
2026-01-11T19:28:13.9878530Z                              if (-not $support.HasNVMe) {
2026-01-11T19:28:13.9879550Z                                  Write-Log "Native NVMe: Skipped - No NVMe drives detected" "INFO"
2026-01-11T19:28:13.9879722Z                                  return $false
2026-01-11T19:28:13.9879855Z                              }
2026-01-11T19:28:13.9880164Z                      
2026-01-11T19:28:13.9881475Z                              if (-not $support.IsSupported) {
2026-01-11T19:28:13.9881773Z                                  Write-Log "Native NVMe: Skipped - $($support.Message)" "INFO"
2026-01-11T19:28:13.9882877Z                                  return $false
2026-01-11T19:28:13.9882983Z                              }
2026-01-11T19:28:13.9883866Z                      
2026-01-11T19:28:13.9884184Z                              if (-not $support.UsesInboxDriver -and -not $Force) {
2026-01-11T19:28:13.9885234Z                                  Write-Log "Native NVMe: Warning - NVMe drives using vendor driver" "INFO"
2026-01-11T19:28:13.9886407Z                                  Write-Log "Native NVMe: Native NVMe only works with Windows in-box stornvme.sys 
2026-01-11T19:28:13.9886544Z                      driver" "INFO"
2026-01-11T19:28:13.9887961Z                                  Write-Log "Native NVMe: Continuing anyway (may have no effect on vendor-driver 
2026-01-11T19:28:13.9888337Z                      devices)" "INFO"
2026-01-11T19:28:13.9888757Z                              }
2026-01-11T19:28:13.9889389Z                      
2026-01-11T19:28:13.9890370Z                              # Enable Native NVMe via Feature Management registry key
2026-01-11T19:28:13.9891001Z                              $nvmePath = 
2026-01-11T19:28:13.9892329Z                      "HKLM:\SYSTEM\CurrentControlSet\Policies\Microsoft\FeatureManagement\Overrides"
2026-01-11T19:28:13.9892840Z                      
2026-01-11T19:28:13.9893067Z                              if (-not (Test-Path $nvmePath)) {
2026-01-11T19:28:13.9894855Z                                  New-Item -Path $nvmePath -Force | Out-Null
2026-01-11T19:28:13.9895128Z                                  Write-Log "Created Native NVMe registry path" "INFO"
2026-01-11T19:28:13.9895233Z                              }
2026-01-11T19:28:13.9895364Z                      
2026-01-11T19:28:13.9896436Z                              Backup-RegistryKey -Path $nvmePath
2026-01-11T19:28:13.9896849Z                              Set-RegistryValue -Path $nvmePath -Name "1176759950" -Value 1 -Type "DWORD"
2026-01-11T19:28:13.9896976Z                      
2026-01-11T19:28:13.9898247Z                              Write-Log "Native NVMe I/O path enabled (reboot required)" "SUCCESS"
2026-01-11T19:28:13.9899631Z                              Write-Log "After reboot: NVMe devices move from 'Disk drives' to 'Storage disks' in 
2026-01-11T19:28:13.9899761Z                      Device Manager" "INFO"
2026-01-11T19:28:13.9901102Z                              Write-Log "EXPERIMENTAL: Known issues with Data Deduplication - disable dedup first if 
2026-01-11T19:28:13.9901271Z                      enabled" "INFO"
2026-01-11T19:28:13.9901441Z                      
2026-01-11T19:28:13.9902678Z                              return $true
2026-01-11T19:28:13.9902783Z                      
2026-01-11T19:28:13.9903911Z                          } catch {
2026-01-11T19:28:13.9904171Z                              Write-Log "Error enabling Native NVMe: $_" "ERROR"
2026-01-11T19:28:13.9905344Z                              throw
2026-01-11T19:28:13.9905450Z                          }
2026-01-11T19:28:13.9906562Z                      }
2026-01-11T19:28:13.9906746Z                      
2026-01-11T19:28:13.9907828Z                      
2026-01-11T19:28:13.9908069Z                      function Disable-NativeNVMe {
2026-01-11T19:28:13.9909066Z                          <#
2026-01-11T19:28:13.9909470Z                          .SYNOPSIS
2026-01-11T19:28:13.9910672Z                              Disables Native NVMe I/O path and reverts to legacy SCSI translation.
2026-01-11T19:28:13.9911083Z                          .DESCRIPTION
2026-01-11T19:28:13.9911746Z                              Sets the feature flag to 0 and requires a reboot.
2026-01-11T19:28:13.9912869Z                              After reboot, NVMe devices return to "Disk drives" in Device Manager.
2026-01-11T19:28:13.9913001Z                          .OUTPUTS
2026-01-11T19:28:13.9913885Z                              [bool] True when a change was made, else false.
2026-01-11T19:28:13.9914733Z                          #>
2026-01-11T19:28:13.9915677Z                      
2026-01-11T19:28:13.9916618Z                          Write-Log "Disabling Native NVMe I/O path..." "INFO"
2026-01-11T19:28:13.9916988Z                      
2026-01-11T19:28:13.9917987Z                          try {
2026-01-11T19:28:13.9918805Z                              $nvmePath = 
2026-01-11T19:28:13.9919282Z                      "HKLM:\SYSTEM\CurrentControlSet\Policies\Microsoft\FeatureManagement\Overrides"
2026-01-11T19:28:13.9920177Z                      
2026-01-11T19:28:13.9920351Z                              if (Test-Path $nvmePath) {
2026-01-11T19:28:13.9921630Z                                  $currentValue = Get-RegistryValue -Path $nvmePath -Name "1176759950"
2026-01-11T19:28:13.9922120Z                                  if ($null -ne $currentValue) {
2026-01-11T19:28:13.9922462Z                                      Set-RegistryValue -Path $nvmePath -Name "1176759950" -Value 0 -Type "DWORD"
2026-01-11T19:28:13.9923348Z                                      Write-Log "Native NVMe disabled (reboot required)" "SUCCESS"
2026-01-11T19:28:13.9924720Z                                      Write-Log "After reboot: NVMe devices return to 'Disk drives' in Device Manager" 
2026-01-11T19:28:13.9924835Z                      "INFO"
2026-01-11T19:28:13.9925294Z                                      return $true
2026-01-11T19:28:13.9926304Z                                  } else {
2026-01-11T19:28:13.9927371Z                                      Write-Log "Native NVMe was not enabled (registry key not found)" "INFO"
2026-01-11T19:28:13.9927537Z                                      return $false
2026-01-11T19:28:13.9928408Z                                  }
2026-01-11T19:28:13.9928537Z                              } else {
2026-01-11T19:28:13.9929962Z                                  Write-Log "Native NVMe was not enabled (registry path not found)" "INFO"
2026-01-11T19:28:13.9930131Z                                  return $false
2026-01-11T19:28:13.9931158Z                              }
2026-01-11T19:28:13.9931384Z                      
2026-01-11T19:28:13.9932520Z                          } catch {
2026-01-11T19:28:13.9932909Z                              Write-Log "Error disabling Native NVMe: $_" "ERROR"
2026-01-11T19:28:13.9934015Z                              throw
2026-01-11T19:28:13.9934129Z                          }
2026-01-11T19:28:13.9935103Z                      }
2026-01-11T19:28:13.9936194Z                      
2026-01-11T19:28:13.9936329Z                      
2026-01-11T19:28:13.9937121Z                      function Test-NativeNVMeStatus {
2026-01-11T19:28:13.9938110Z                          <#
2026-01-11T19:28:13.9938319Z                          .SYNOPSIS
2026-01-11T19:28:13.9939605Z                              Checks if Native NVMe is currently enabled.
2026-01-11T19:28:13.9939730Z                          .OUTPUTS
2026-01-11T19:28:13.9940759Z                              $true if enabled, $false otherwise
2026-01-11T19:28:13.9940871Z                          #>
2026-01-11T19:28:13.9942049Z                      
2026-01-11T19:28:13.9942163Z                          try {
2026-01-11T19:28:13.9943234Z                              $nvmePath = 
2026-01-11T19:28:13.9944593Z                      "HKLM:\SYSTEM\CurrentControlSet\Policies\Microsoft\FeatureManagement\Overrides"
2026-01-11T19:28:13.9944697Z                      
2026-01-11T19:28:13.9945127Z                              if (Test-Path $nvmePath) {
2026-01-11T19:28:13.9946555Z                                  $value = Get-RegistryValue -Path $nvmePath -Name "1176759950"
2026-01-11T19:28:13.9946670Z                                  if ($value -eq 1) {
2026-01-11T19:28:13.9947640Z                                      Write-Log "Native NVMe: Currently ENABLED" "SUCCESS"
2026-01-11T19:28:13.9948059Z                                      return $true
2026-01-11T19:28:13.9948957Z                                  }
2026-01-11T19:28:13.9949060Z                              }
2026-01-11T19:28:13.9950028Z                      
2026-01-11T19:28:13.9950914Z                              Write-Log "Native NVMe: Currently DISABLED" "INFO"
2026-01-11T19:28:13.9951804Z                              return $false
2026-01-11T19:28:13.9951908Z                      
2026-01-11T19:28:13.9952913Z                          } catch {
2026-01-11T19:28:13.9953555Z                              Write-Log "Error checking Native NVMe status: $_" "ERROR"
2026-01-11T19:28:13.9954403Z                              return $false
2026-01-11T19:28:13.9954732Z                          }
2026-01-11T19:28:13.9955959Z                      }
2026-01-11T19:28:13.9956077Z                      
2026-01-11T19:28:13.9956828Z                      
2026-01-11T19:28:13.9958064Z                      function Invoke-PerformanceOptimizations {
2026-01-11T19:28:13.9958182Z                          <#
2026-01-11T19:28:13.9959198Z                          .SYNOPSIS
2026-01-11T19:28:13.9959462Z                              Applies the full performance optimization set.
2026-01-11T19:28:13.9960514Z                          .DESCRIPTION
2026-01-11T19:28:13.9961204Z                              Runs GameDVR/FSO toggles, HPET (opt-in), MSI mode, scheduler tweaks,
2026-01-11T19:28:13.9961660Z                              timer and MMCSS adjustments, Game Mode, and optional Native NVMe.
2026-01-11T19:28:13.9962490Z                          .PARAMETER DisableHPET
2026-01-11T19:28:13.9963063Z                              Enables HPET-related changes when true (opt-in).
2026-01-11T19:28:13.9963978Z                          .PARAMETER DisableCoreParking
2026-01-11T19:28:13.9964920Z                              Disables core parking when true (opt-in).
2026-01-11T19:28:13.9965092Z                          .PARAMETER DisableGameDVR
2026-01-11T19:28:13.9966219Z                              Disables GameDVR capture when true.
2026-01-11T19:28:13.9966614Z                          .PARAMETER DisableFSO
2026-01-11T19:28:13.9967452Z                              Disables Fullscreen Optimizations when true.
2026-01-11T19:28:13.9967775Z                          .PARAMETER EnableNativeNVMe
2026-01-11T19:28:13.9969147Z                              Enables Native NVMe I/O path when true (opt-in).
2026-01-11T19:28:13.9969261Z                          .OUTPUTS
2026-01-11T19:28:13.9970238Z                              None.
2026-01-11T19:28:13.9970981Z                          #>
2026-01-11T19:28:13.9971560Z                          param(
2026-01-11T19:28:13.9972790Z                              [bool]$DisableHPET = $false,
2026-01-11T19:28:13.9973013Z                              [bool]$DisableCoreParking = $false,
2026-01-11T19:28:13.9973291Z                              [bool]$DisableGameDVR = $true,
2026-01-11T19:28:13.9973813Z                              [bool]$DisableFSO = $true,
2026-01-11T19:28:13.9974548Z                              [bool]$EnableNativeNVMe = $false
2026-01-11T19:28:13.9975859Z                          )
2026-01-11T19:28:13.9976386Z                      
2026-01-11T19:28:13.9977299Z                          Write-Log "Applying performance optimizations..." "INFO"
2026-01-11T19:28:13.9977508Z                      
2026-01-11T19:28:13.9977994Z                          try {
2026-01-11T19:28:13.9978415Z                              Set-GameDVR -Enable $DisableGameDVR
2026-01-11T19:28:13.9979202Z                              Set-FullscreenOptimizations -Enable $DisableFSO
2026-01-11T19:28:13.9980187Z                      
2026-01-11T19:28:13.9980416Z                              Disable-HPET -Enable $DisableHPET
2026-01-11T19:28:13.9981138Z                      
2026-01-11T19:28:13.9982170Z                              Enable-MSIMode
2026-01-11T19:28:13.9982560Z                      
2026-01-11T19:28:13.9983483Z                              Set-CoreParking -Disable $DisableCoreParking
2026-01-11T19:28:13.9983569Z                      
2026-01-11T19:28:13.9984837Z                              Set-SchedulerOptimizations
2026-01-11T19:28:13.9984952Z                      
2026-01-11T19:28:13.9985860Z                              Set-TimerResolution
2026-01-11T19:28:13.9986714Z                      
2026-01-11T19:28:13.9987392Z                              Set-MMCSSGamingTweaks
2026-01-11T19:28:13.9988421Z                      
2026-01-11T19:28:13.9988788Z                              Enable-GameMode
2026-01-11T19:28:13.9989795Z                      
2026-01-11T19:28:13.9990144Z                              Enable-NativeNVMe -Enable $EnableNativeNVMe
2026-01-11T19:28:13.9991243Z                      
2026-01-11T19:28:13.9991566Z                              Write-Log "Performance optimizations complete" "SUCCESS"
2026-01-11T19:28:13.9993267Z                              Write-Log "IMPORTANT: Reboot required for HPET, MSI mode, and Native NVMe changes" "INFO"
2026-01-11T19:28:13.9994046Z                              Write-Log "Run timer-tool.ps1 during gameplay for 0.5-1.0ms timer resolution" "INFO"
2026-01-11T19:28:13.9994186Z                      
2026-01-11T19:28:13.9995025Z                          } catch {
2026-01-11T19:28:13.9996418Z                              Write-Log "Error applying performance optimizations: $_" "ERROR"
2026-01-11T19:28:13.9996527Z                              throw
2026-01-11T19:28:13.9997476Z                          }
2026-01-11T19:28:13.9997577Z                      }
2026-01-11T19:28:13.9998830Z                      
2026-01-11T19:28:13.9999903Z                      
2026-01-11T19:28:14.0000128Z                      function Disable-MultiplaneOverlay {
2026-01-11T19:28:14.0000917Z                          <#
2026-01-11T19:28:14.0001717Z                          .SYNOPSIS
2026-01-11T19:28:14.0003027Z                              Disables Multiplane Overlay (MPO) for reduced GPU overhead.
2026-01-11T19:28:14.0003154Z                          .DESCRIPTION
2026-01-11T19:28:14.0004219Z                              MPO is a DWM feature that can cause stuttering during streaming/recording.
2026-01-11T19:28:14.0004518Z                              Disabling it reduces GPU overhead from window composition.
2026-01-11T19:28:14.0005049Z                              Best for: Streamers and users experiencing DWM-related stutters.
2026-01-11T19:28:14.0006155Z                          .OUTPUTS
2026-01-11T19:28:14.0006268Z                              None.
2026-01-11T19:28:14.0007264Z                          #>
2026-01-11T19:28:14.0007912Z                          param(
2026-01-11T19:28:14.0008971Z                              [bool]$Enable = $true
2026-01-11T19:28:14.0009329Z                          )
2026-01-11T19:28:14.0010147Z                      
2026-01-11T19:28:14.0011272Z                          if (-not $Enable) {
2026-01-11T19:28:14.0011891Z                              Write-Log "Disable Multiplane Overlay: skipped" "INFO"
2026-01-11T19:28:14.0012081Z                              return
2026-01-11T19:28:14.0013250Z                          }
2026-01-11T19:28:14.0014090Z                      
2026-01-11T19:28:14.0014719Z                          try {
2026-01-11T19:28:14.0016235Z                              $dwmPath = "HKLM:\SOFTWARE\Microsoft\Windows\Dwm"
2026-01-11T19:28:14.0016825Z                              Backup-RegistryKey -Path $dwmPath
2026-01-11T19:28:14.0016945Z                      
2026-01-11T19:28:14.0017386Z                              # OverlayTestMode = 5 disables MPO
2026-01-11T19:28:14.0019058Z                              Set-RegistryValue -Path $dwmPath -Name "OverlayTestMode" -Value 5 -Type "DWORD"
2026-01-11T19:28:14.0019181Z                      
2026-01-11T19:28:14.0019734Z                              Write-Log "Disabled Multiplane Overlay (reduces GPU overhead for streaming)" "SUCCESS"
2026-01-11T19:28:14.0019871Z                          } catch {
2026-01-11T19:28:14.0021026Z                              Write-Log "Error disabling Multiplane Overlay: $_" "ERROR"
2026-01-11T19:28:14.0021132Z                          }
2026-01-11T19:28:14.0022113Z                      }
2026-01-11T19:28:14.0022956Z                      
2026-01-11T19:28:14.0023597Z                      
2026-01-11T19:28:14.0024490Z                      function Disable-ProcessMitigations {
2026-01-11T19:28:14.0025687Z                          <#
2026-01-11T19:28:14.0025839Z                          .SYNOPSIS
2026-01-11T19:28:14.0026970Z                              Disables Windows process mitigations for maximum performance.
2026-01-11T19:28:14.0027098Z                          .DESCRIPTION
2026-01-11T19:28:14.0028324Z                              Security mitigations like CFG and SEHOP add overhead.
2026-01-11T19:28:14.0028945Z                              Disabling them can improve benchmark scores but reduces security.
2026-01-11T19:28:14.0029240Z                              Best for: Benchmarking only - NOT recommended for daily use.
2026-01-11T19:28:14.0029380Z                          .OUTPUTS
2026-01-11T19:28:14.0030362Z                              None.
2026-01-11T19:28:14.0030469Z                          #>
2026-01-11T19:28:14.0031586Z                          param(
2026-01-11T19:28:14.0032356Z                              [bool]$Enable = $true
2026-01-11T19:28:14.0033063Z                          )
2026-01-11T19:28:14.0034473Z                      
2026-01-11T19:28:14.0034692Z                          if (-not $Enable) {
2026-01-11T19:28:14.0034925Z                              Write-Log "Disable process mitigations: skipped" "INFO"
2026-01-11T19:28:14.0035499Z                              return
2026-01-11T19:28:14.0036659Z                          }
2026-01-11T19:28:14.0036765Z                      
2026-01-11T19:28:14.0037868Z                          try {
2026-01-11T19:28:14.0038718Z                              # Disable system-wide exploit protection mitigations
2026-01-11T19:28:14.0039138Z                              $exploitPath = "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\kernel"
2026-01-11T19:28:14.0040227Z                              Backup-RegistryKey -Path $exploitPath
2026-01-11T19:28:14.0040317Z                      
2026-01-11T19:28:14.0041313Z                              # Disable Kernel CET (Shadow Stacks) - only on supported systems
2026-01-11T19:28:14.0042750Z                              Set-RegistryValue -Path $exploitPath -Name "KernelShadowStacksForceDisabled" -Value 1 
2026-01-11T19:28:14.0042979Z                      -Type "DWORD" -ErrorAction SilentlyContinue
2026-01-11T19:28:14.0043107Z                      
2026-01-11T19:28:14.0044649Z                              Write-Log "Disabled process mitigations (benchmarking mode - reduces security)" "SUCCESS"
2026-01-11T19:28:14.0045114Z                              Write-Log "WARNING: Re-enable mitigations after benchmarking for security" "ERROR"
2026-01-11T19:28:14.0045228Z                          } catch {
2026-01-11T19:28:14.0045854Z                              Write-Log "Error disabling process mitigations: $_" "ERROR"
2026-01-11T19:28:14.0046096Z                          }
2026-01-11T19:28:14.0046528Z                      }
2026-01-11T19:28:14.0046931Z                      
2026-01-11T19:28:14.0047349Z                      
2026-01-11T19:28:14.0047848Z                      function Set-InterruptAffinity {
2026-01-11T19:28:14.0048175Z                          <#
2026-01-11T19:28:14.0048609Z                          .SYNOPSIS
2026-01-11T19:28:14.0049963Z                              Configures GPU interrupt affinity to reduce DPC latency.
2026-01-11T19:28:14.0050100Z                          .DESCRIPTION
2026-01-11T19:28:14.0050425Z                              Assigns GPU interrupts to a specific CPU core to reduce
2026-01-11T19:28:14.0052145Z                              context switching and improve frame consistency.
2026-01-11T19:28:14.0052385Z                              Best for: High-end systems chasing benchmark scores.
2026-01-11T19:28:14.0052454Z                          .OUTPUTS
2026-01-11T19:28:14.0053478Z                              None.
2026-01-11T19:28:14.0054366Z                          #>
2026-01-11T19:28:14.0054588Z                          param(
2026-01-11T19:28:14.0055814Z                              [bool]$Enable = $true
2026-01-11T19:28:14.0055927Z                          )
2026-01-11T19:28:14.0057068Z                      
2026-01-11T19:28:14.0057830Z                          if (-not $Enable) {
2026-01-11T19:28:14.0058715Z                              Write-Log "GPU interrupt affinity: skipped" "INFO"
2026-01-11T19:28:14.0059655Z                              return
2026-01-11T19:28:14.0060498Z                          }
2026-01-11T19:28:14.0060851Z                      
2026-01-11T19:28:14.0061688Z                          try {
2026-01-11T19:28:14.0062619Z                              # Find GPU device
2026-01-11T19:28:14.0063877Z                              $gpuDevice = Get-PnpDevice -Class Display | Where-Object { $_.Status -eq "OK" } | 
2026-01-11T19:28:14.0063976Z                      Select-Object -First 1
2026-01-11T19:28:14.0065104Z                      
2026-01-11T19:28:14.0065268Z                              if (-not $gpuDevice) {
2026-01-11T19:28:14.0066704Z                                  Write-Log "No GPU found for interrupt affinity configuration" "INFO"
2026-01-11T19:28:14.0066829Z                                  return
2026-01-11T19:28:14.0067886Z                              }
2026-01-11T19:28:14.0068051Z                      
2026-01-11T19:28:14.0069183Z                              $deviceId = $gpuDevice.InstanceId
2026-01-11T19:28:14.0070599Z                              $msiPath = "HKLM:\SYSTEM\CurrentControlSet\Enum\$deviceId\Device Parameters\Interrupt 
2026-01-11T19:28:14.0070762Z                      Management\Affinity Policy"
2026-01-11T19:28:14.0070925Z                      
2026-01-11T19:28:14.0071995Z                              if (-not (Test-Path $msiPath)) {
2026-01-11T19:28:14.0073003Z                                  New-Item -Path $msiPath -Force | Out-Null
2026-01-11T19:28:14.0073261Z                              }
2026-01-11T19:28:14.0074183Z                      
2026-01-11T19:28:14.0075343Z                              Backup-RegistryKey -Path $msiPath
2026-01-11T19:28:14.0075672Z                      
2026-01-11T19:28:14.0076934Z                              # DevicePolicy = 4 (IrqPolicySpreadMessagesAcrossAllProcessors is default)
2026-01-11T19:28:14.0077185Z                              # We set to specific processor for consistency
2026-01-11T19:28:14.0078642Z                              Set-RegistryValue -Path $msiPath -Name "DevicePolicy" -Value 3 -Type "DWORD"  # 
2026-01-11T19:28:14.0078857Z                      IrqPolicySpecifiedProcessors
2026-01-11T19:28:14.0079271Z                      
2026-01-11T19:28:14.0080568Z                              # AssignmentSetOverride = target processor mask (CPU 0 = 1, CPU 1 = 2, etc.)
2026-01-11T19:28:14.0080788Z                              # Default to CPU 0 for GPU interrupts
2026-01-11T19:28:14.0081938Z                              Set-RegistryValue -Path $msiPath -Name "AssignmentSetOverride" -Value 1 -Type "DWORD"
2026-01-11T19:28:14.0082005Z                      
2026-01-11T19:28:14.0083261Z                              Write-Log "GPU interrupt affinity configured (assigned to CPU 0)" "SUCCESS"
2026-01-11T19:28:14.0083632Z                              Write-Log "Reboot required for interrupt affinity changes" "INFO"
2026-01-11T19:28:14.0084072Z                          } catch {
2026-01-11T19:28:14.0085183Z                              Write-Log "Error setting interrupt affinity: $_" "ERROR"
2026-01-11T19:28:14.0085496Z                          }
2026-01-11T19:28:14.0086545Z                      }
2026-01-11T19:28:14.0086646Z                      
2026-01-11T19:28:14.0087764Z                      
2026-01-11T19:28:14.0087952Z                      function Disable-CoreIsolation {
2026-01-11T19:28:14.0088890Z                          <#
2026-01-11T19:28:14.0089010Z                          .SYNOPSIS
2026-01-11T19:28:14.0090508Z                              Disables Core Isolation (VBS/HVCI) for maximum performance.
2026-01-11T19:28:14.0090642Z                          .DESCRIPTION
2026-01-11T19:28:14.0091691Z                              Virtualization-Based Security adds ~5-10% overhead.
2026-01-11T19:28:14.0092826Z                              Disabling it improves performance but reduces security.
2026-01-11T19:28:14.0093560Z                              Best for: Benchmarking only - NOT recommended for daily use.
2026-01-11T19:28:14.0093698Z                          .OUTPUTS
2026-01-11T19:28:14.0094062Z                              None.
2026-01-11T19:28:14.0095239Z                          #>
2026-01-11T19:28:14.0095368Z                          param(
2026-01-11T19:28:14.0096688Z                              [bool]$Enable = $true
2026-01-11T19:28:14.0096795Z                          )
2026-01-11T19:28:14.0097916Z                      
2026-01-11T19:28:14.0098065Z                          if (-not $Enable) {
2026-01-11T19:28:14.0099327Z                              Write-Log "Disable Core Isolation: skipped" "INFO"
2026-01-11T19:28:14.0100236Z                              return
2026-01-11T19:28:14.0101102Z                          }
2026-01-11T19:28:14.0101579Z                      
2026-01-11T19:28:14.0102792Z                          try {
2026-01-11T19:28:14.0103547Z                              $deviceGuardPath = "HKLM:\SYSTEM\CurrentControlSet\Control\DeviceGuard"
2026-01-11T19:28:14.0104211Z                              Backup-RegistryKey -Path $deviceGuardPath
2026-01-11T19:28:14.0105225Z                      
2026-01-11T19:28:14.0105355Z                              # Disable VBS
2026-01-11T19:28:14.0107060Z                              Set-RegistryValue -Path $deviceGuardPath -Name "EnableVirtualizationBasedSecurity" -Value 
2026-01-11T19:28:14.0107147Z                      0 -Type "DWORD"
2026-01-11T19:28:14.0107578Z                      
2026-01-11T19:28:14.0108439Z                              $hvciPath = 
2026-01-11T19:28:14.0109366Z                      "HKLM:\SYSTEM\CurrentControlSet\Control\DeviceGuard\Scenarios\HypervisorEnforcedCodeIntegrity"
2026-01-11T19:28:14.0109571Z                              if (Test-Path $hvciPath) {
2026-01-11T19:28:14.0110560Z                                  Backup-RegistryKey -Path $hvciPath
2026-01-11T19:28:14.0110936Z                                  Set-RegistryValue -Path $hvciPath -Name "Enabled" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.0111245Z                              }
2026-01-11T19:28:14.0112556Z                      
2026-01-11T19:28:14.0113238Z                              Write-Log "Disabled Core Isolation / VBS (benchmarking mode - reduces security)" "SUCCESS"
2026-01-11T19:28:14.0113622Z                              Write-Log "WARNING: Re-enable Core Isolation after benchmarking for security" "ERROR"
2026-01-11T19:28:14.0114768Z                              Write-Log "Reboot required for Core Isolation changes" "INFO"
2026-01-11T19:28:14.0114889Z                          } catch {
2026-01-11T19:28:14.0115847Z                              Write-Log "Error disabling Core Isolation: $_" "ERROR"
2026-01-11T19:28:14.0115944Z                          }
2026-01-11T19:28:14.0116025Z                      }
2026-01-11T19:28:14.0125085Z                      
2026-01-11T19:28:14.0125214Z                      
2026-01-11T19:28:14.0125635Z                      function Undo-PerformanceOptimizations {
2026-01-11T19:28:14.0125757Z                          <#
2026-01-11T19:28:14.0125860Z                          .SYNOPSIS
2026-01-11T19:28:14.0126055Z                              Rolls back performance-related changes.
2026-01-11T19:28:14.0126160Z                          .DESCRIPTION
2026-01-11T19:28:14.0126536Z                              Removes HPET boot flags, restores registry backups, and disables Native
2026-01-11T19:28:14.0126668Z                              NVMe when it was enabled.
2026-01-11T19:28:14.0126752Z                          .OUTPUTS
2026-01-11T19:28:14.0126849Z                              None.
2026-01-11T19:28:14.0126941Z                          #>
2026-01-11T19:28:14.0127238Z                          Write-Log "Rolling back performance optimizations..." "INFO"
2026-01-11T19:28:14.0127333Z                      
2026-01-11T19:28:14.0127455Z                          try {
2026-01-11T19:28:14.0127690Z                              bcdedit /deletevalue useplatformclock 2>&1 | Out-Null
2026-01-11T19:28:14.0127923Z                              bcdedit /deletevalue disabledynamictick 2>&1 | Out-Null
2026-01-11T19:28:14.0128262Z                      
2026-01-11T19:28:14.0128377Z                              $paths = @(
2026-01-11T19:28:14.0128622Z                                  "HKLM:\SYSTEM\CurrentControlSet\Control\PriorityControl",
2026-01-11T19:28:14.0128962Z                                  "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\kernel",
2026-01-11T19:28:14.0129388Z                                  "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile",
2026-01-11T19:28:14.0129969Z                                  "HKLM:\SYSTEM\CurrentControlSet\Control\Power",
2026-01-11T19:28:14.0130338Z                                  "HKLM:\SOFTWARE\Microsoft\Windows 
2026-01-11T19:28:14.0131677Z                      NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games",
2026-01-11T19:28:14.0132810Z                                  "HKLM:\SOFTWARE\Microsoft\PolicyManager\default\ApplicationManagement\AllowGameMode",
2026-01-11T19:28:14.0133101Z                                  "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\GameDVR",
2026-01-11T19:28:14.0133507Z                                  "HKCU:\System\GameConfigStore"
2026-01-11T19:28:14.0134574Z                              )
2026-01-11T19:28:14.0135251Z                      
2026-01-11T19:28:14.0136165Z                              foreach ($path in $paths) {
2026-01-11T19:28:14.0136998Z                                  if (Restore-RegistryKey -Path $path) {
2026-01-11T19:28:14.0138043Z                                      Write-Log "Restored registry: $path" "SUCCESS"
2026-01-11T19:28:14.0138159Z                                  }
2026-01-11T19:28:14.0139215Z                              }
2026-01-11T19:28:14.0139330Z                      
2026-01-11T19:28:14.0140544Z                              # Disable Native NVMe if it was enabled
2026-01-11T19:28:14.0140840Z                              Disable-NativeNVMe | Out-Null
2026-01-11T19:28:14.0141568Z                      
2026-01-11T19:28:14.0143208Z                              Write-Log "Performance optimization rollback complete (restart required)" "SUCCESS"
2026-01-11T19:28:14.0143311Z                      
2026-01-11T19:28:14.0144138Z                          } catch {
2026-01-11T19:28:14.0145024Z                              Write-Log "Error during rollback: $_" "ERROR"
2026-01-11T19:28:14.0145918Z                              throw
2026-01-11T19:28:14.0146028Z                          }
2026-01-11T19:28:14.0147291Z                      }
2026-01-11T19:28:14.0147412Z                      
2026-01-11T19:28:14.0148512Z                      
2026-01-11T19:28:14.0149042Z                      Export-ModuleMember -Function @(
2026-01-11T19:28:14.0149887Z                          'Disable-HPET',
2026-01-11T19:28:14.0150244Z                          'Enable-MSIMode',
2026-01-11T19:28:14.0150893Z                          'Set-CoreParking',
2026-01-11T19:28:14.0152021Z                          'Set-SchedulerOptimizations',
2026-01-11T19:28:14.0152799Z                          'Set-TimerResolution',
2026-01-11T19:28:14.0152993Z                          'Set-MMCSSGamingTweaks',
2026-01-11T19:28:14.0153368Z                          'Enable-GameMode',
2026-01-11T19:28:14.0153845Z                          'Set-GameDVR',
2026-01-11T19:28:14.0154962Z                          'Set-FullscreenOptimizations',
2026-01-11T19:28:14.0155368Z                          'Test-NVMeSupport',
2026-01-11T19:28:14.0156548Z                          'Enable-NativeNVMe',
2026-01-11T19:28:14.0156715Z                          'Disable-NativeNVMe',
2026-01-11T19:28:14.0157514Z                          'Test-NativeNVMeStatus',
2026-01-11T19:28:14.0158450Z                          'Disable-MultiplaneOverlay',
2026-01-11T19:28:14.0159286Z                          'Disable-ProcessMitigations',
2026-01-11T19:28:14.0159459Z                          'Set-InterruptAffinity',
2026-01-11T19:28:14.0159639Z                          'Disable-CoreIsolation',
2026-01-11T19:28:14.0160755Z                          'Test-PerformanceOptimizations',
2026-01-11T19:28:14.0161048Z                          'Invoke-PerformanceOptimizations',
2026-01-11T19:28:14.0162162Z                          'Undo-PerformanceOptimizations'
2026-01-11T19:28:14.0162269Z                      )
2026-01-11T19:28:14.0163720Z [32;1mCleanBlock         : [0m
2026-01-11T19:28:14.0163952Z [32;1mDynamicParamBlock  : [0m
2026-01-11T19:28:14.0164889Z [32;1mScriptRequirements : [0mSystem.Management.Automation.Language.ScriptRequirements
2026-01-11T19:28:14.0167389Z [32;1mExtent             : [0m<#
2026-01-11T19:28:14.0167511Z                      .SYNOPSIS
2026-01-11T19:28:14.0168991Z                          Performance-focused optimizations (scheduler, timer, GameDVR, NVMe, etc).
2026-01-11T19:28:14.0169164Z                      .DESCRIPTION
2026-01-11T19:28:14.0170349Z                          Applies registry and boot configuration tweaks that target frame pacing and
2026-01-11T19:28:14.0170589Z                          latency. Includes opt-in changes that carry risk (HPET, mitigations, Core
2026-01-11T19:28:14.0171493Z                          Isolation) and a rollback helper.
2026-01-11T19:28:14.0171859Z                      .NOTES
2026-01-11T19:28:14.0173549Z                          Requires Administrator. Some changes require reboot to take effect.
2026-01-11T19:28:14.0173667Z                      #>
2026-01-11T19:28:14.0174942Z                      #Requires -RunAsAdministrator
2026-01-11T19:28:14.0175074Z                      
2026-01-11T19:28:14.0175407Z                      
2026-01-11T19:28:14.0176612Z                      
2026-01-11T19:28:14.0177376Z                      Import-Module (Join-Path $PSScriptRoot "..\core\logger.psm1") -Force -Global
2026-01-11T19:28:14.0177812Z                      Import-Module (Join-Path $PSScriptRoot "..\core\registry.psm1") -Force -Global
2026-01-11T19:28:14.0178056Z                      
2026-01-11T19:28:14.0179263Z                      
2026-01-11T19:28:14.0179375Z                      
2026-01-11T19:28:14.0180827Z                      function Test-PerformanceOptimizations {
2026-01-11T19:28:14.0180951Z                          <#
2026-01-11T19:28:14.0182029Z                          .SYNOPSIS
2026-01-11T19:28:14.0182290Z                              Verifies key performance-related registry settings.
2026-01-11T19:28:14.0182740Z                          .DESCRIPTION
2026-01-11T19:28:14.0183085Z                              Checks MMCSS GPU priority, scheduler priority separation, and timer
2026-01-11T19:28:14.0184178Z                              resolution registry preferences.
2026-01-11T19:28:14.0184338Z                          .PARAMETER HPETDisabled
2026-01-11T19:28:14.0185937Z                              Currently unused; retained for parity with historical interfaces.
2026-01-11T19:28:14.0186136Z                          .PARAMETER CoreParkingDisabled
2026-01-11T19:28:14.0186525Z                              Currently unused; retained for parity with historical interfaces.
2026-01-11T19:28:14.0187497Z                          .OUTPUTS
2026-01-11T19:28:14.0187699Z                              [bool] True when checks pass, else false.
2026-01-11T19:28:14.0188069Z                          #>
2026-01-11T19:28:14.0189161Z                          param(
2026-01-11T19:28:14.0189335Z                              [bool]$HPETDisabled = $false,
2026-01-11T19:28:14.0190561Z                              [bool]$CoreParkingDisabled = $false
2026-01-11T19:28:14.0190927Z                          )
2026-01-11T19:28:14.0191547Z                      
2026-01-11T19:28:14.0192510Z                          $allPassed = $true
2026-01-11T19:28:14.0193609Z                      
2026-01-11T19:28:14.0194572Z                          Write-Log "Verifying performance optimizations..." "INFO"
2026-01-11T19:28:14.0194663Z                      
2026-01-11T19:28:14.0196085Z                          $mmcssPath = "HKLM:\SOFTWARE\Microsoft\Windows 
2026-01-11T19:28:14.0196489Z                      NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games"
2026-01-11T19:28:14.0197809Z                          $gpuPriority = Get-RegistryValue -Path $mmcssPath -Name "GPU Priority"
2026-01-11T19:28:14.0197957Z                          if ($gpuPriority -eq 8) {
2026-01-11T19:28:14.0198733Z                              Write-Log "‚úì MMCSS GPU Priority: 8 (correct)" "SUCCESS"
2026-01-11T19:28:14.0199750Z                          } else {
2026-01-11T19:28:14.0200811Z                              Write-Log "‚úó MMCSS GPU Priority incorrect (current: $gpuPriority, expected: 8)" "ERROR"
2026-01-11T19:28:14.0200959Z                              $allPassed = $false
2026-01-11T19:28:14.0201612Z                          }
2026-01-11T19:28:14.0201738Z                      
2026-01-11T19:28:14.0202800Z                          $schedulerPath = "HKLM:\SYSTEM\CurrentControlSet\Control\PriorityControl"
2026-01-11T19:28:14.0203284Z                          $win32Priority = Get-RegistryValue -Path $schedulerPath -Name "Win32PrioritySeparation"
2026-01-11T19:28:14.0203460Z                          if ($win32Priority -eq 26) {
2026-01-11T19:28:14.0204602Z                              Write-Log "‚úì Win32PrioritySeparation: 26 (balanced gaming)" "SUCCESS"
2026-01-11T19:28:14.0204727Z                          } else {
2026-01-11T19:28:14.0206938Z                              Write-Log "‚úó Win32PrioritySeparation incorrect (current: $win32Priority, expected: 26)" 
2026-01-11T19:28:14.0207073Z                      "ERROR"
2026-01-11T19:28:14.0207212Z                              $allPassed = $false
2026-01-11T19:28:14.0207312Z                          }
2026-01-11T19:28:14.0208141Z                      
2026-01-11T19:28:14.0208692Z                          $timerPath = "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\kernel"
2026-01-11T19:28:14.0210864Z                          $globalTimer = Get-RegistryValue -Path $timerPath -Name "GlobalTimerResolutionRequests"
2026-01-11T19:28:14.0211446Z                          if ($globalTimer -eq 1) {
2026-01-11T19:28:14.0212142Z                              Write-Log "‚úì GlobalTimerResolutionRequests enabled" "SUCCESS"
2026-01-11T19:28:14.0212253Z                          }
2026-01-11T19:28:14.0213317Z                      
2026-01-11T19:28:14.0215573Z                          return $allPassed
2026-01-11T19:28:14.0216331Z                      }
2026-01-11T19:28:14.0217078Z                      
2026-01-11T19:28:14.0217776Z                      
2026-01-11T19:28:14.0219177Z                      
2026-01-11T19:28:14.0219842Z                      
2026-01-11T19:28:14.0220794Z                      function Disable-HPET {
2026-01-11T19:28:14.0221616Z                          <#
2026-01-11T19:28:14.0222628Z                          .SYNOPSIS
2026-01-11T19:28:14.0223581Z                              Optionally disables HPET-related boot settings.
2026-01-11T19:28:14.0224626Z                          .DESCRIPTION
2026-01-11T19:28:14.0225026Z                              Uses bcdedit to disable useplatformclock and dynamic tick. This is an
2026-01-11T19:28:14.0225289Z                              opt-in change and requires a reboot.
2026-01-11T19:28:14.0225700Z                          .PARAMETER Enable
2026-01-11T19:28:14.0226667Z                              When true, applies the HPET-related changes.
2026-01-11T19:28:14.0227013Z                          .OUTPUTS
2026-01-11T19:28:14.0228098Z                              None.
2026-01-11T19:28:14.0228752Z                          #>
2026-01-11T19:28:14.0229101Z                          param(
2026-01-11T19:28:14.0230034Z                              [bool]$Enable = $false
2026-01-11T19:28:14.0230155Z                          )
2026-01-11T19:28:14.0230353Z                      
2026-01-11T19:28:14.0231305Z                          if (-not $Enable) {
2026-01-11T19:28:14.0231876Z                              Write-Log "HPET disable: OPT-IN only (skipped, default: keep enabled)" "INFO"
2026-01-11T19:28:14.0233535Z                              return
2026-01-11T19:28:14.0233681Z                          }
2026-01-11T19:28:14.0234687Z                      
2026-01-11T19:28:14.0235105Z                          Write-Log "Disabling HPET (High Precision Event Timer)..." "INFO"
2026-01-11T19:28:14.0235212Z                      
2026-01-11T19:28:14.0235501Z                          try {
2026-01-11T19:28:14.0237236Z                              $result = bcdedit /set useplatformclock false 2>&1
2026-01-11T19:28:14.0237464Z                              if ($LASTEXITCODE -eq 0) {
2026-01-11T19:28:14.0237906Z                                  Write-Log "Disabled useplatformclock" "SUCCESS"
2026-01-11T19:28:14.0238181Z                              } else {
2026-01-11T19:28:14.0238927Z                                  Write-Log "Could not disable useplatformclock (may not be supported)" "ERROR"
2026-01-11T19:28:14.0239164Z                              }
2026-01-11T19:28:14.0239861Z                      
2026-01-11T19:28:14.0240526Z                              $result = bcdedit /set disabledynamictick yes 2>&1
2026-01-11T19:28:14.0240924Z                              if ($LASTEXITCODE -eq 0) {
2026-01-11T19:28:14.0241912Z                                  Write-Log "Disabled dynamic tick" "SUCCESS"
2026-01-11T19:28:14.0242025Z                              } else {
2026-01-11T19:28:14.0242460Z                                  Write-Log "Could not disable disabledynamictick (may not be supported)" "ERROR"
2026-01-11T19:28:14.0242577Z                              }
2026-01-11T19:28:14.0243013Z                      
2026-01-11T19:28:14.0244678Z                              Write-Log "HPET configuration complete. Requires reboot." "SUCCESS"
2026-01-11T19:28:14.0244809Z                      
2026-01-11T19:28:14.0245103Z                          } catch {
2026-01-11T19:28:14.0246195Z                              Write-Log "Error disabling HPET: $_" "ERROR"
2026-01-11T19:28:14.0246320Z                              throw
2026-01-11T19:28:14.0246426Z                          }
2026-01-11T19:28:14.0246640Z                      }
2026-01-11T19:28:14.0247697Z                      
2026-01-11T19:28:14.0248304Z                      
2026-01-11T19:28:14.0248699Z                      function Enable-MSIMode {
2026-01-11T19:28:14.0249058Z                          <#
2026-01-11T19:28:14.0249483Z                          .SYNOPSIS
2026-01-11T19:28:14.0250140Z                              Enables MSI mode for GPU and network adapters.
2026-01-11T19:28:14.0250784Z                          .DESCRIPTION
2026-01-11T19:28:14.0252375Z                              Toggles MessageSignaledInterruptProperties for selected devices to
2026-01-11T19:28:14.0252806Z                              reduce interrupt latency.
2026-01-11T19:28:14.0252933Z                          .OUTPUTS
2026-01-11T19:28:14.0253053Z                              None.
2026-01-11T19:28:14.0253388Z                          #>
2026-01-11T19:28:14.0254716Z                          Write-Log "Configuring MSI Mode for devices (reduces DPC latency)..." "INFO"
2026-01-11T19:28:14.0254833Z                      
2026-01-11T19:28:14.0254959Z                          $msiEnabled = 0
2026-01-11T19:28:14.0256123Z                      
2026-01-11T19:28:14.0256779Z                          try {
2026-01-11T19:28:14.0257967Z                              $gpuDevices = Get-PnpDevice | Where-Object {
2026-01-11T19:28:14.0258138Z                                  ($_.Class -eq "Display") -or
2026-01-11T19:28:14.0259325Z                                  ($_.FriendlyName -like "*NVIDIA*") -or
2026-01-11T19:28:14.0259547Z                                  ($_.FriendlyName -like "*AMD*") -or
2026-01-11T19:28:14.0260937Z                                  ($_.FriendlyName -like "*Intel*")
2026-01-11T19:28:14.0261115Z                              } | Select-Object -First 3
2026-01-11T19:28:14.0261562Z                      
2026-01-11T19:28:14.0262453Z                              foreach ($device in $gpuDevices) {
2026-01-11T19:28:14.0262805Z                                  try {
2026-01-11T19:28:14.0264064Z                                      $deviceId = $device.InstanceId
2026-01-11T19:28:14.0264215Z                                      if ($deviceId) {
2026-01-11T19:28:14.0265543Z                                          $msiPath = "HKLM:\SYSTEM\CurrentControlSet\Enum\$deviceId\Device 
2026-01-11T19:28:14.0265950Z                      Parameters\Interrupt Management\MessageSignaledInterruptProperties"
2026-01-11T19:28:14.0266271Z                                          if (Test-Path $msiPath) {
2026-01-11T19:28:14.0267286Z                                              Backup-RegistryKey -Path $msiPath
2026-01-11T19:28:14.0268717Z                                              Set-RegistryValue -Path $msiPath -Name "MSISupported" -Value 1 -Type 
2026-01-11T19:28:14.0268840Z                      "DWORD"
2026-01-11T19:28:14.0270158Z                                              Write-Log "Enabled MSI mode for GPU: $($device.FriendlyName)" "SUCCESS"
2026-01-11T19:28:14.0270324Z                                              $msiEnabled++
2026-01-11T19:28:14.0271108Z                                          }
2026-01-11T19:28:14.0271236Z                                      }
2026-01-11T19:28:14.0272043Z                                  } catch {
2026-01-11T19:28:14.0273249Z                                      Write-Log "Could not enable MSI mode for $($device.FriendlyName): $_" "ERROR"
2026-01-11T19:28:14.0273600Z                                  }
2026-01-11T19:28:14.0274352Z                              }
2026-01-11T19:28:14.0275129Z                      
2026-01-11T19:28:14.0276018Z                              $netAdapters = Get-NetAdapter | Where-Object { $_.Status -eq "Up" }
2026-01-11T19:28:14.0276805Z                              foreach ($adapter in $netAdapters) {
2026-01-11T19:28:14.0276940Z                                  try {
2026-01-11T19:28:14.0277394Z                                      $netDevice = Get-PnpDevice | Where-Object { $_.FriendlyName -eq 
2026-01-11T19:28:14.0278640Z                      $adapter.InterfaceDescription } | Select-Object -First 1
2026-01-11T19:28:14.0278868Z                                      if ($netDevice -and $netDevice.InstanceId) {
2026-01-11T19:28:14.0279433Z                                          $deviceId = $netDevice.InstanceId
2026-01-11T19:28:14.0280598Z                                          $msiPath = "HKLM:\SYSTEM\CurrentControlSet\Enum\$deviceId\Device 
2026-01-11T19:28:14.0281260Z                      Parameters\Interrupt Management\MessageSignaledInterruptProperties"
2026-01-11T19:28:14.0282625Z                                          if (Test-Path $msiPath) {
2026-01-11T19:28:14.0282883Z                                              Backup-RegistryKey -Path $msiPath
2026-01-11T19:28:14.0283308Z                                              Set-RegistryValue -Path $msiPath -Name "MSISupported" -Value 1 -Type 
2026-01-11T19:28:14.0283448Z                      "DWORD"
2026-01-11T19:28:14.0284607Z                                              Write-Log "Enabled MSI mode for network adapter: $($adapter.Name)" 
2026-01-11T19:28:14.0284715Z                      "SUCCESS"
2026-01-11T19:28:14.0286070Z                                              $msiEnabled++
2026-01-11T19:28:14.0286190Z                                          }
2026-01-11T19:28:14.0286994Z                                      }
2026-01-11T19:28:14.0287810Z                                  } catch {
2026-01-11T19:28:14.0289047Z                                      Write-Log "Could not enable MSI mode for network adapter $($adapter.Name): $_" 
2026-01-11T19:28:14.0289152Z                      "ERROR"
2026-01-11T19:28:14.0290094Z                                  }
2026-01-11T19:28:14.0290199Z                              }
2026-01-11T19:28:14.0291503Z                      
2026-01-11T19:28:14.0292082Z                              if ($msiEnabled -gt 0) {
2026-01-11T19:28:14.0292502Z                                  Write-Log "MSI Mode enabled for $msiEnabled device(s). Reboot required." "SUCCESS"
2026-01-11T19:28:14.0293616Z                              } else {
2026-01-11T19:28:14.0294072Z                                  Write-Log "No devices found that support MSI Mode, or it's already enabled" "INFO"
2026-01-11T19:28:14.0295014Z                              }
2026-01-11T19:28:14.0295117Z                      
2026-01-11T19:28:14.0296386Z                          } catch {
2026-01-11T19:28:14.0296935Z                              Write-Log "Error enabling MSI mode: $_" "ERROR"
2026-01-11T19:28:14.0297897Z                              throw
2026-01-11T19:28:14.0298033Z                          }
2026-01-11T19:28:14.0299312Z                      }
2026-01-11T19:28:14.0299433Z                      
2026-01-11T19:28:14.0300246Z                      
2026-01-11T19:28:14.0300429Z                      function Set-CoreParking {
2026-01-11T19:28:14.0301522Z                          <#
2026-01-11T19:28:14.0301644Z                          .SYNOPSIS
2026-01-11T19:28:14.0302848Z                              Disables CPU core parking (opt-in).
2026-01-11T19:28:14.0303672Z                          .DESCRIPTION
2026-01-11T19:28:14.0304740Z                              Updates power-related registry settings and per-scheme powercfg values
2026-01-11T19:28:14.0304929Z                              to keep cores unparked.
2026-01-11T19:28:14.0305528Z                          .PARAMETER Disable
2026-01-11T19:28:14.0306423Z                              When true, disables core parking.
2026-01-11T19:28:14.0307029Z                          .OUTPUTS
2026-01-11T19:28:14.0307729Z                              None.
2026-01-11T19:28:14.0307844Z                          #>
2026-01-11T19:28:14.0308768Z                          param(
2026-01-11T19:28:14.0308946Z                              [bool]$Disable = $false
2026-01-11T19:28:14.0309641Z                          )
2026-01-11T19:28:14.0310318Z                      
2026-01-11T19:28:14.0310454Z                          if (-not $Disable) {
2026-01-11T19:28:14.0311557Z                              Write-Log "Core parking: KEPT ENABLED (default, especially for X3D CPUs)" "INFO"
2026-01-11T19:28:14.0311666Z                              return
2026-01-11T19:28:14.0311785Z                          }
2026-01-11T19:28:14.0312791Z                      
2026-01-11T19:28:14.0313168Z                          Write-Log "Disabling CPU core parking (opt-in)..." "INFO"
2026-01-11T19:28:14.0313635Z                      
2026-01-11T19:28:14.0314591Z                          try {
2026-01-11T19:28:14.0315843Z                              $cpuParkPath = "HKLM:\SYSTEM\CurrentControlSet\Control\Power"
2026-01-11T19:28:14.0316068Z                              Backup-RegistryKey -Path $cpuParkPath
2026-01-11T19:28:14.0316719Z                              Set-RegistryValue -Path $cpuParkPath -Name "CpuParkingEnabled" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.0317291Z                              Set-RegistryValue -Path $cpuParkPath -Name "CpuParkingMinCores" -Value 100 -Type "DWORD"
2026-01-11T19:28:14.0317414Z                      
2026-01-11T19:28:14.0318464Z                              $schemes = powercfg /list | Select-String "GUID" | ForEach-Object { ($_ -split '\s+')[-1] 
2026-01-11T19:28:14.0318573Z                      }
2026-01-11T19:28:14.0318922Z                              foreach ($scheme in $schemes) {
2026-01-11T19:28:14.0320480Z                                  powercfg /setacvalueindex $scheme 54533251-82be-4824-96c1-47b60b740d00 
2026-01-11T19:28:14.0320763Z                      0cc5b647-c1df-4637-891a-dec35c318583 0 2>&1 | Out-Null
2026-01-11T19:28:14.0321188Z                                  powercfg /setdcvalueindex $scheme 54533251-82be-4824-96c1-47b60b740d00 
2026-01-11T19:28:14.0321602Z                      0cc5b647-c1df-4637-891a-dec35c318583 0 2>&1 | Out-Null
2026-01-11T19:28:14.0322002Z                              }
2026-01-11T19:28:14.0322631Z                      
2026-01-11T19:28:14.0323254Z                              Write-Log "Disabled CPU core parking" "SUCCESS"
2026-01-11T19:28:14.0323397Z                      
2026-01-11T19:28:14.0324362Z                          } catch {
2026-01-11T19:28:14.0325034Z                              Write-Log "Error configuring core parking: $_" "ERROR"
2026-01-11T19:28:14.0325175Z                              throw
2026-01-11T19:28:14.0325414Z                          }
2026-01-11T19:28:14.0326084Z                      }
2026-01-11T19:28:14.0326427Z                      
2026-01-11T19:28:14.0327421Z                      
2026-01-11T19:28:14.0327638Z                      function Set-SchedulerOptimizations {
2026-01-11T19:28:14.0328218Z                          <#
2026-01-11T19:28:14.0328579Z                          .SYNOPSIS
2026-01-11T19:28:14.0329245Z                              Applies Windows scheduler tuning for games.
2026-01-11T19:28:14.0329558Z                          .DESCRIPTION
2026-01-11T19:28:14.0330252Z                              Sets Win32PrioritySeparation and IRQ8Priority to values commonly used
2026-01-11T19:28:14.0330429Z                              for balanced gaming performance.
2026-01-11T19:28:14.0331426Z                          .OUTPUTS
2026-01-11T19:28:14.0331846Z                              None.
2026-01-11T19:28:14.0331995Z                          #>
2026-01-11T19:28:14.0332089Z                          try {
2026-01-11T19:28:14.0333382Z                              $schedulerPath = "HKLM:\SYSTEM\CurrentControlSet\Control\PriorityControl"
2026-01-11T19:28:14.0333614Z                              Backup-RegistryKey -Path $schedulerPath
2026-01-11T19:28:14.0333706Z                      
2026-01-11T19:28:14.0335097Z                              Set-RegistryValue -Path $schedulerPath -Name "Win32PrioritySeparation" -Value 26 -Type 
2026-01-11T19:28:14.0335241Z                      "DWORD"
2026-01-11T19:28:14.0335647Z                              Write-Log "Set Win32PrioritySeparation to 26 (balanced gaming)" "SUCCESS"
2026-01-11T19:28:14.0335766Z                      
2026-01-11T19:28:14.0337402Z                              Set-RegistryValue -Path $schedulerPath -Name "IRQ8Priority" -Value 1 -Type "DWORD"
2026-01-11T19:28:14.0337730Z                              Write-Log "Set IRQ8Priority for frame time consistency" "SUCCESS"
2026-01-11T19:28:14.0337827Z                      
2026-01-11T19:28:14.0337977Z                          } catch {
2026-01-11T19:28:14.0338765Z                              Write-Log "Error configuring scheduler: $_" "ERROR"
2026-01-11T19:28:14.0338868Z                              throw
2026-01-11T19:28:14.0339514Z                          }
2026-01-11T19:28:14.0340208Z                      }
2026-01-11T19:28:14.0340478Z                      
2026-01-11T19:28:14.0341229Z                      
2026-01-11T19:28:14.0341426Z                      function Set-TimerResolution {
2026-01-11T19:28:14.0342116Z                          <#
2026-01-11T19:28:14.0342244Z                          .SYNOPSIS
2026-01-11T19:28:14.0343047Z                              Configures registry preferences for timer resolution.
2026-01-11T19:28:14.0343173Z                          .DESCRIPTION
2026-01-11T19:28:14.0343693Z                              Enables GlobalTimerResolutionRequests and sets related multimedia and
2026-01-11T19:28:14.0344177Z                              power settings that influence timer behavior. Use timer-tool.ps1 at
2026-01-11T19:28:14.0344417Z                              runtime for actual 0.5ms resolution.
2026-01-11T19:28:14.0345073Z                          .OUTPUTS
2026-01-11T19:28:14.0345223Z                              None.
2026-01-11T19:28:14.0346228Z                          #>
2026-01-11T19:28:14.0346401Z                          try {
2026-01-11T19:28:14.0347334Z                              $timerPath = "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\kernel"
2026-01-11T19:28:14.0347555Z                              Backup-RegistryKey -Path $timerPath
2026-01-11T19:28:14.0349016Z                              Set-RegistryValue -Path $timerPath -Name "GlobalTimerResolutionRequests" -Value 1 -Type 
2026-01-11T19:28:14.0349158Z                      "DWORD"
2026-01-11T19:28:14.0350277Z                      
2026-01-11T19:28:14.0350604Z                              $multimediaPath = "HKLM:\SOFTWARE\Microsoft\Windows 
2026-01-11T19:28:14.0350986Z                      NT\CurrentVersion\Multimedia\SystemProfile"
2026-01-11T19:28:14.0351897Z                              Backup-RegistryKey -Path $multimediaPath
2026-01-11T19:28:14.0352884Z                              Set-RegistryValue -Path $multimediaPath -Name "SystemResponsiveness" -Value 0 -Type 
2026-01-11T19:28:14.0353016Z                      "DWORD"
2026-01-11T19:28:14.0353275Z                      
2026-01-11T19:28:14.0354237Z                              $powerPath = "HKLM:\SYSTEM\CurrentControlSet\Control\Power"
2026-01-11T19:28:14.0354441Z                              Backup-RegistryKey -Path $powerPath
2026-01-11T19:28:14.0355128Z                              Set-RegistryValue -Path $powerPath -Name "EnergyEstimationEnabled" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.0355640Z                              Set-RegistryValue -Path $powerPath -Name "PlatformAoAcOverride" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.0355748Z                      
2026-01-11T19:28:14.0356328Z                              Set-RegistryValue -Path $powerPath -Name "CsEnabled" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.0356449Z                      
2026-01-11T19:28:14.0357332Z                              Write-Log "Timer resolution registry configured. Use timer-tool.ps1 during gameplay." 
2026-01-11T19:28:14.0357447Z                      "SUCCESS"
2026-01-11T19:28:14.0357699Z                      
2026-01-11T19:28:14.0359057Z                          } catch {
2026-01-11T19:28:14.0359399Z                              Write-Log "Error configuring timer resolution: $_" "ERROR"
2026-01-11T19:28:14.0359512Z                              throw
2026-01-11T19:28:14.0359904Z                          }
2026-01-11T19:28:14.0360688Z                      }
2026-01-11T19:28:14.0360804Z                      
2026-01-11T19:28:14.0361489Z                      
2026-01-11T19:28:14.0361678Z                      function Set-MMCSSGamingTweaks {
2026-01-11T19:28:14.0362312Z                          <#
2026-01-11T19:28:14.0362427Z                          .SYNOPSIS
2026-01-11T19:28:14.0363306Z                              Applies MMCSS tweaks for gaming workloads.
2026-01-11T19:28:14.0364137Z                          .DESCRIPTION
2026-01-11T19:28:14.0364506Z                              Adjusts MMCSS game task priorities to favor GPU and CPU scheduling.
2026-01-11T19:28:14.0364602Z                          .OUTPUTS
2026-01-11T19:28:14.0365351Z                              None.
2026-01-11T19:28:14.0365465Z                          #>
2026-01-11T19:28:14.0366472Z                          try {
2026-01-11T19:28:14.0367237Z                              $mmcssGamesPath = "HKLM:\SOFTWARE\Microsoft\Windows 
2026-01-11T19:28:14.0367512Z                      NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games"
2026-01-11T19:28:14.0367906Z                              Backup-RegistryKey -Path $mmcssGamesPath
2026-01-11T19:28:14.0368022Z                      
2026-01-11T19:28:14.0369542Z                              Set-RegistryValue -Path $mmcssGamesPath -Name "GPU Priority" -Value 8 -Type "DWORD"
2026-01-11T19:28:14.0371637Z                              Set-RegistryValue -Path $mmcssGamesPath -Name "Priority" -Value 6 -Type "DWORD"
2026-01-11T19:28:14.0372231Z                              Set-RegistryValue -Path $mmcssGamesPath -Name "Scheduling Category" -Value "High" -Type 
2026-01-11T19:28:14.0372382Z                      "String"
2026-01-11T19:28:14.0373900Z                              Set-RegistryValue -Path $mmcssGamesPath -Name "SFIO Priority" -Value "High" -Type "String"
2026-01-11T19:28:14.0374021Z                      
2026-01-11T19:28:14.0375144Z                              Write-Log "Applied MMCSS gaming tweaks (prioritizes games)" "SUCCESS"
2026-01-11T19:28:14.0375290Z                      
2026-01-11T19:28:14.0380220Z                          } catch {
2026-01-11T19:28:14.0381077Z                              Write-Log "Error configuring MMCSS: $_" "ERROR"
2026-01-11T19:28:14.0381297Z                              throw
2026-01-11T19:28:14.0382405Z                          }
2026-01-11T19:28:14.0383013Z                      }
2026-01-11T19:28:14.0383730Z                      
2026-01-11T19:28:14.0384142Z                      
2026-01-11T19:28:14.0384700Z                      function Enable-GameMode {
2026-01-11T19:28:14.0385432Z                          <#
2026-01-11T19:28:14.0385562Z                          .SYNOPSIS
2026-01-11T19:28:14.0386349Z                              Enables Windows Game Mode.
2026-01-11T19:28:14.0386474Z                          .DESCRIPTION
2026-01-11T19:28:14.0386905Z                              Sets the policy manager flag for Game Mode.
2026-01-11T19:28:14.0387547Z                          .OUTPUTS
2026-01-11T19:28:14.0387697Z                              None.
2026-01-11T19:28:14.0388459Z                          #>
2026-01-11T19:28:14.0388588Z                          try {
2026-01-11T19:28:14.0389394Z                              $gameModePath = 
2026-01-11T19:28:14.0390535Z                      "HKLM:\SOFTWARE\Microsoft\PolicyManager\default\ApplicationManagement\AllowGameMode"
2026-01-11T19:28:14.0390921Z                              Backup-RegistryKey -Path $gameModePath
2026-01-11T19:28:14.0392227Z                              Set-RegistryValue -Path $gameModePath -Name "value" -Value 1 -Type "DWORD"
2026-01-11T19:28:14.0392327Z                      
2026-01-11T19:28:14.0393036Z                              Write-Log "Enabled Windows Game Mode" "SUCCESS"
2026-01-11T19:28:14.0393145Z                      
2026-01-11T19:28:14.0394434Z                          } catch {
2026-01-11T19:28:14.0394988Z                              Write-Log "Error enabling Game Mode: $_" "ERROR"
2026-01-11T19:28:14.0396533Z                              throw
2026-01-11T19:28:14.0396760Z                          }
2026-01-11T19:28:14.0397583Z                      }
2026-01-11T19:28:14.0398380Z                      
2026-01-11T19:28:14.0399050Z                      
2026-01-11T19:28:14.0399723Z                      function Set-GameDVR {
2026-01-11T19:28:14.0400365Z                          <#
2026-01-11T19:28:14.0401101Z                          .SYNOPSIS
2026-01-11T19:28:14.0402077Z                              Disables GameDVR capture and recording.
2026-01-11T19:28:14.0402212Z                          .DESCRIPTION
2026-01-11T19:28:14.0403143Z                              Turns off GameDVR capture and sets related GameConfigStore values.
2026-01-11T19:28:14.0403285Z                          .PARAMETER Enable
2026-01-11T19:28:14.0403923Z                              When true, applies the disablement (opt-in flag naming kept for API parity).
2026-01-11T19:28:14.0404802Z                          .OUTPUTS
2026-01-11T19:28:14.0405240Z                              None.
2026-01-11T19:28:14.0405829Z                          #>
2026-01-11T19:28:14.0406177Z                          param(
2026-01-11T19:28:14.0407656Z                              [bool]$Enable = $true
2026-01-11T19:28:14.0407761Z                          )
2026-01-11T19:28:14.0407994Z                      
2026-01-11T19:28:14.0409033Z                          if (-not $Enable) {
2026-01-11T19:28:14.0409346Z                              Write-Log "GameDVR disable skipped by config" "INFO"
2026-01-11T19:28:14.0409489Z                              return
2026-01-11T19:28:14.0410031Z                          }
2026-01-11T19:28:14.0410410Z                      
2026-01-11T19:28:14.0411213Z                          try {
2026-01-11T19:28:14.0412442Z                              $dvrPath = "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\GameDVR"
2026-01-11T19:28:14.0412658Z                              Backup-RegistryKey -Path $dvrPath
2026-01-11T19:28:14.0413156Z                              Set-RegistryValue -Path $dvrPath -Name "AppCaptureEnabled" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.0413614Z                              Set-RegistryValue -Path $dvrPath -Name "GameDVR_Enabled" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.0413708Z                      
2026-01-11T19:28:14.0413941Z                              $configStore = "HKCU:\System\GameConfigStore"
2026-01-11T19:28:14.0414300Z                              Backup-RegistryKey -Path $configStore
2026-01-11T19:28:14.0415238Z                              Set-RegistryValue -Path $configStore -Name "GameDVR_FSEBehaviorMode" -Value 2 -Type 
2026-01-11T19:28:14.0415387Z                      "DWORD"
2026-01-11T19:28:14.0417059Z                              Set-RegistryValue -Path $configStore -Name "GameDVR_HonorUserFSEBehaviorMode" -Value 1 
2026-01-11T19:28:14.0417559Z                      -Type "DWORD"
2026-01-11T19:28:14.0418510Z                      
2026-01-11T19:28:14.0418876Z                              Write-Log "GameDVR disabled (capture + FSE behavior)" "SUCCESS"
2026-01-11T19:28:14.0419101Z                          } catch {
2026-01-11T19:28:14.0420239Z                              Write-Log "Error disabling GameDVR: $_" "ERROR"
2026-01-11T19:28:14.0420429Z                              throw
2026-01-11T19:28:14.0420791Z                          }
2026-01-11T19:28:14.0421771Z                      }
2026-01-11T19:28:14.0421880Z                      
2026-01-11T19:28:14.0422052Z                      
2026-01-11T19:28:14.0422875Z                      function Set-FullscreenOptimizations {
2026-01-11T19:28:14.0423268Z                          <#
2026-01-11T19:28:14.0424057Z                          .SYNOPSIS
2026-01-11T19:28:14.0425251Z                              Disables Fullscreen Optimizations (FSO).
2026-01-11T19:28:14.0425434Z                          .DESCRIPTION
2026-01-11T19:28:14.0426378Z                              Writes GameConfigStore values to opt out of FSO for reduced overhead.
2026-01-11T19:28:14.0426543Z                          .PARAMETER Enable
2026-01-11T19:28:14.0426952Z                              When true, applies the disablement (opt-in flag naming kept for API parity).
2026-01-11T19:28:14.0427094Z                          .OUTPUTS
2026-01-11T19:28:14.0428297Z                              None.
2026-01-11T19:28:14.0428397Z                          #>
2026-01-11T19:28:14.0429452Z                          param(
2026-01-11T19:28:14.0429653Z                              [bool]$Enable = $true
2026-01-11T19:28:14.0429747Z                          )
2026-01-11T19:28:14.0430455Z                      
2026-01-11T19:28:14.0430690Z                          if (-not $Enable) {
2026-01-11T19:28:14.0431493Z                              Write-Log "FSO disable skipped by config" "INFO"
2026-01-11T19:28:14.0432158Z                              return
2026-01-11T19:28:14.0432833Z                          }
2026-01-11T19:28:14.0432934Z                      
2026-01-11T19:28:14.0433793Z                          try {
2026-01-11T19:28:14.0434014Z                              $configStore = "HKCU:\System\GameConfigStore"
2026-01-11T19:28:14.0434859Z                              Backup-RegistryKey -Path $configStore
2026-01-11T19:28:14.0435636Z                              Set-RegistryValue -Path $configStore -Name "GameDVR_FSEBehaviorMode" -Value 2 -Type 
2026-01-11T19:28:14.0435756Z                      "DWORD"
2026-01-11T19:28:14.0436749Z                              Set-RegistryValue -Path $configStore -Name "GameDVR_HonorUserFSEBehaviorMode" -Value 1 
2026-01-11T19:28:14.0436883Z                      -Type "DWORD"
2026-01-11T19:28:14.0437783Z                              Write-Log "Fullscreen Optimizations disabled (watch HDR/color-managed titles)" "SUCCESS"
2026-01-11T19:28:14.0437909Z                          } catch {
2026-01-11T19:28:14.0438395Z                              Write-Log "Error disabling Fullscreen Optimizations: $_" "ERROR"
2026-01-11T19:28:14.0438707Z                              throw
2026-01-11T19:28:14.0439258Z                          }
2026-01-11T19:28:14.0439935Z                      }
2026-01-11T19:28:14.0440073Z                      
2026-01-11T19:28:14.0440905Z                      
2026-01-11T19:28:14.0441098Z                      function Test-NVMeSupport {
2026-01-11T19:28:14.0441864Z                          <#
2026-01-11T19:28:14.0442004Z                          .SYNOPSIS
2026-01-11T19:28:14.0443417Z                              Tests if Native NVMe optimization can be applied to this system.
2026-01-11T19:28:14.0443524Z                          .DESCRIPTION
2026-01-11T19:28:14.0443649Z                              Checks for:
2026-01-11T19:28:14.0443815Z                              1. NVMe drives present
2026-01-11T19:28:14.0444619Z                              2. Windows 11 24H2+ (Build 26100+) or Windows Server 2025
2026-01-11T19:28:14.0445572Z                              3. Using Windows in-box stornvme.sys driver (not vendor driver)
2026-01-11T19:28:14.0445687Z                          .OUTPUTS
2026-01-11T19:28:14.0446045Z                              PSObject with HasNVMe, IsSupported, UsesInboxDriver, Message properties
2026-01-11T19:28:14.0446139Z                          #>
2026-01-11T19:28:14.0446759Z                      
2026-01-11T19:28:14.0446926Z                          $result = [PSCustomObject]@{
2026-01-11T19:28:14.0447314Z                              HasNVMe = $false
2026-01-11T19:28:14.0448246Z                              IsSupported = $false
2026-01-11T19:28:14.0448447Z                              UsesInboxDriver = $false
2026-01-11T19:28:14.0449117Z                              BuildNumber = 0
2026-01-11T19:28:14.0449870Z                              Message = ""
2026-01-11T19:28:14.0449990Z                              NVMeDrives = @()
2026-01-11T19:28:14.0450622Z                          }
2026-01-11T19:28:14.0450724Z                      
2026-01-11T19:28:14.0451651Z                          try {
2026-01-11T19:28:14.0452228Z                              # Check for NVMe drives
2026-01-11T19:28:14.0453375Z                              $nvmeDrives = Get-PhysicalDisk | Where-Object { $_.BusType -eq "NVMe" }
2026-01-11T19:28:14.0453532Z                              if (-not $nvmeDrives) {
2026-01-11T19:28:14.0454042Z                                  $result.Message = "No NVMe drives detected"
2026-01-11T19:28:14.0454714Z                                  Write-Log "Native NVMe: No NVMe drives detected" "INFO"
2026-01-11T19:28:14.0454890Z                                  return $result
2026-01-11T19:28:14.0455637Z                              }
2026-01-11T19:28:14.0456283Z                      
2026-01-11T19:28:14.0456455Z                              $result.HasNVMe = $true
2026-01-11T19:28:14.0457710Z                              $result.NVMeDrives = $nvmeDrives | Select-Object FriendlyName, MediaType, Size
2026-01-11T19:28:14.0458071Z                              Write-Log "Native NVMe: Found $($nvmeDrives.Count) NVMe drive(s)" "INFO"
2026-01-11T19:28:14.0458570Z                      
2026-01-11T19:28:14.0459347Z                              # Check Windows version (Build 26100+ for Windows 11 24H2)
2026-01-11T19:28:14.0459695Z                              $build = [int](Get-CimInstance Win32_OperatingSystem).BuildNumber
2026-01-11T19:28:14.0459861Z                              $result.BuildNumber = $build
2026-01-11T19:28:14.0460108Z                      
2026-01-11T19:28:14.0460880Z                              if ($build -lt 26100) {
2026-01-11T19:28:14.0461960Z                                  $result.Message = "Requires Windows 11 24H2+ (Build 26100+). Current: $build"
2026-01-11T19:28:14.0462623Z                                  Write-Log "Native NVMe: Unsupported Windows version (Build $build, need 26100+)" 
2026-01-11T19:28:14.0462769Z                      "INFO"
2026-01-11T19:28:14.0463459Z                                  return $result
2026-01-11T19:28:14.0463564Z                              }
2026-01-11T19:28:14.0464433Z                      
2026-01-11T19:28:14.0464634Z                              $result.IsSupported = $true
2026-01-11T19:28:14.0465334Z                      
2026-01-11T19:28:14.0466389Z                              # Check if using in-box stornvme driver
2026-01-11T19:28:14.0466864Z                              $stornvmeDevices = Get-PnpDevice -Class DiskDrive -ErrorAction SilentlyContinue | 
2026-01-11T19:28:14.0467131Z                      Where-Object {
2026-01-11T19:28:14.0468341Z                                  $_.InstanceId -like "*NVME*"
2026-01-11T19:28:14.0468900Z                              } | ForEach-Object {
2026-01-11T19:28:14.0470603Z                                  $svc = (Get-PnpDeviceProperty -InstanceId $_.InstanceId -KeyName 
2026-01-11T19:28:14.0470878Z                      "DEVPKEY_Device_Service" -ErrorAction SilentlyContinue).Data
2026-01-11T19:28:14.0470984Z                                  if ($svc -eq "stornvme") { $_ }
2026-01-11T19:28:14.0471621Z                              }
2026-01-11T19:28:14.0472437Z                      
2026-01-11T19:28:14.0473144Z                              if ($stornvmeDevices) {
2026-01-11T19:28:14.0474061Z                                  $result.UsesInboxDriver = $true
2026-01-11T19:28:14.0475185Z                                  Write-Log "Native NVMe: Using Windows in-box stornvme.sys driver" "SUCCESS"
2026-01-11T19:28:14.0475603Z                              } else {
2026-01-11T19:28:14.0476706Z                                  Write-Log "Native NVMe: Using vendor NVMe driver (in-box driver not detected)" "INFO"
2026-01-11T19:28:14.0478007Z                                  $result.Message = "NVMe drives using vendor driver - Native NVMe only works with 
2026-01-11T19:28:14.0478148Z                      stornvme.sys"
2026-01-11T19:28:14.0479064Z                              }
2026-01-11T19:28:14.0479540Z                      
2026-01-11T19:28:14.0480492Z                              if (-not $result.Message) {
2026-01-11T19:28:14.0481144Z                                  $result.Message = "System supports Native NVMe optimization"
2026-01-11T19:28:14.0481745Z                              }
2026-01-11T19:28:14.0482785Z                      
2026-01-11T19:28:14.0483553Z                          } catch {
2026-01-11T19:28:14.0484779Z                              $result.Message = "Error checking NVMe support: $_"
2026-01-11T19:28:14.0485132Z                              Write-Log "Native NVMe: Error during detection - $_" "ERROR"
2026-01-11T19:28:14.0485465Z                          }
2026-01-11T19:28:14.0486316Z                      
2026-01-11T19:28:14.0486783Z                          return $result
2026-01-11T19:28:14.0487862Z                      }
2026-01-11T19:28:14.0488042Z                      
2026-01-11T19:28:14.0488788Z                      
2026-01-11T19:28:14.0489805Z                      function Enable-NativeNVMe {
2026-01-11T19:28:14.0490826Z                          <#
2026-01-11T19:28:14.0491603Z                          .SYNOPSIS
2026-01-11T19:28:14.0491915Z                              Enables Native NVMe I/O path on Windows 11 24H2+ / Server 2025.
2026-01-11T19:28:14.0492149Z                          .DESCRIPTION
2026-01-11T19:28:14.0493447Z                              Eliminates SCSI translation layer for NVMe drives, delivering:
2026-01-11T19:28:14.0493642Z                              - Up to ~80% more IOPS
2026-01-11T19:28:14.0494540Z                              - ~45% reduction in CPU cycles per I/O
2026-01-11T19:28:14.0494767Z                              - Direct multi-queue access to NVMe hardware
2026-01-11T19:28:14.0495437Z                      
2026-01-11T19:28:14.0496599Z                              After reboot, NVMe devices move from "Disk drives" to "Storage disks" in Device Manager.
2026-01-11T19:28:14.0496672Z                      
2026-01-11T19:28:14.0498036Z                              EXPERIMENTAL: Known issues with Data Deduplication - disable dedup first if enabled.
2026-01-11T19:28:14.0498560Z                          .PARAMETER Enable
2026-01-11T19:28:14.0498797Z                              If false, skips enabling Native NVMe (opt-in only)
2026-01-11T19:28:14.0499717Z                          .PARAMETER Force
2026-01-11T19:28:14.0500753Z                              If true, enables even if vendor driver detected (may have no effect)
2026-01-11T19:28:14.0501083Z                          #>
2026-01-11T19:28:14.0501719Z                          param(
2026-01-11T19:28:14.0502810Z                              [bool]$Enable = $false,
2026-01-11T19:28:14.0503343Z                              [bool]$Force = $false
2026-01-11T19:28:14.0503446Z                          )
2026-01-11T19:28:14.0504545Z                      
2026-01-11T19:28:14.0504695Z                          if (-not $Enable) {
2026-01-11T19:28:14.0506011Z                              Write-Log "Native NVMe: OPT-IN only (skipped)" "INFO"
2026-01-11T19:28:14.0506434Z                              return $false
2026-01-11T19:28:14.0507354Z                          }
2026-01-11T19:28:14.0508138Z                      
2026-01-11T19:28:14.0508923Z                          Write-Log "Enabling Native NVMe I/O path..." "INFO"
2026-01-11T19:28:14.0509778Z                      
2026-01-11T19:28:14.0510000Z                          try {
2026-01-11T19:28:14.0511354Z                              # Run detection
2026-01-11T19:28:14.0512165Z                              $support = Test-NVMeSupport
2026-01-11T19:28:14.0512250Z                      
2026-01-11T19:28:14.0512750Z                              if (-not $support.HasNVMe) {
2026-01-11T19:28:14.0513384Z                                  Write-Log "Native NVMe: Skipped - No NVMe drives detected" "INFO"
2026-01-11T19:28:14.0513519Z                                  return $false
2026-01-11T19:28:14.0514420Z                              }
2026-01-11T19:28:14.0515197Z                      
2026-01-11T19:28:14.0516190Z                              if (-not $support.IsSupported) {
2026-01-11T19:28:14.0516801Z                                  Write-Log "Native NVMe: Skipped - $($support.Message)" "INFO"
2026-01-11T19:28:14.0517601Z                                  return $false
2026-01-11T19:28:14.0518483Z                              }
2026-01-11T19:28:14.0519198Z                      
2026-01-11T19:28:14.0520239Z                              if (-not $support.UsesInboxDriver -and -not $Force) {
2026-01-11T19:28:14.0520706Z                                  Write-Log "Native NVMe: Warning - NVMe drives using vendor driver" "INFO"
2026-01-11T19:28:14.0521163Z                                  Write-Log "Native NVMe: Native NVMe only works with Windows in-box stornvme.sys 
2026-01-11T19:28:14.0521280Z                      driver" "INFO"
2026-01-11T19:28:14.0522425Z                                  Write-Log "Native NVMe: Continuing anyway (may have no effect on vendor-driver 
2026-01-11T19:28:14.0522563Z                      devices)" "INFO"
2026-01-11T19:28:14.0522819Z                              }
2026-01-11T19:28:14.0523567Z                      
2026-01-11T19:28:14.0523828Z                              # Enable Native NVMe via Feature Management registry key
2026-01-11T19:28:14.0524814Z                              $nvmePath = 
2026-01-11T19:28:14.0525690Z                      "HKLM:\SYSTEM\CurrentControlSet\Policies\Microsoft\FeatureManagement\Overrides"
2026-01-11T19:28:14.0525949Z                      
2026-01-11T19:28:14.0526226Z                              if (-not (Test-Path $nvmePath)) {
2026-01-11T19:28:14.0527314Z                                  New-Item -Path $nvmePath -Force | Out-Null
2026-01-11T19:28:14.0527565Z                                  Write-Log "Created Native NVMe registry path" "INFO"
2026-01-11T19:28:14.0530419Z                              }
2026-01-11T19:28:14.0530708Z                      
2026-01-11T19:28:14.0531905Z                              Backup-RegistryKey -Path $nvmePath
2026-01-11T19:28:14.0533367Z                              Set-RegistryValue -Path $nvmePath -Name "1176759950" -Value 1 -Type "DWORD"
2026-01-11T19:28:14.0533486Z                      
2026-01-11T19:28:14.0535074Z                              Write-Log "Native NVMe I/O path enabled (reboot required)" "SUCCESS"
2026-01-11T19:28:14.0535617Z                              Write-Log "After reboot: NVMe devices move from 'Disk drives' to 'Storage disks' in 
2026-01-11T19:28:14.0535768Z                      Device Manager" "INFO"
2026-01-11T19:28:14.0537435Z                              Write-Log "EXPERIMENTAL: Known issues with Data Deduplication - disable dedup first if 
2026-01-11T19:28:14.0537598Z                      enabled" "INFO"
2026-01-11T19:28:14.0537694Z                      
2026-01-11T19:28:14.0537859Z                              return $true
2026-01-11T19:28:14.0539050Z                      
2026-01-11T19:28:14.0539884Z                          } catch {
2026-01-11T19:28:14.0540141Z                              Write-Log "Error enabling Native NVMe: $_" "ERROR"
2026-01-11T19:28:14.0540485Z                              throw
2026-01-11T19:28:14.0541485Z                          }
2026-01-11T19:28:14.0541665Z                      }
2026-01-11T19:28:14.0541753Z                      
2026-01-11T19:28:14.0542368Z                      
2026-01-11T19:28:14.0543262Z                      function Disable-NativeNVMe {
2026-01-11T19:28:14.0543364Z                          <#
2026-01-11T19:28:14.0543733Z                          .SYNOPSIS
2026-01-11T19:28:14.0544491Z                              Disables Native NVMe I/O path and reverts to legacy SCSI translation.
2026-01-11T19:28:14.0544711Z                          .DESCRIPTION
2026-01-11T19:28:14.0545956Z                              Sets the feature flag to 0 and requires a reboot.
2026-01-11T19:28:14.0547201Z                              After reboot, NVMe devices return to "Disk drives" in Device Manager.
2026-01-11T19:28:14.0547357Z                          .OUTPUTS
2026-01-11T19:28:14.0548217Z                              [bool] True when a change was made, else false.
2026-01-11T19:28:14.0549221Z                          #>
2026-01-11T19:28:14.0550132Z                      
2026-01-11T19:28:14.0550427Z                          Write-Log "Disabling Native NVMe I/O path..." "INFO"
2026-01-11T19:28:14.0550806Z                      
2026-01-11T19:28:14.0551562Z                          try {
2026-01-11T19:28:14.0552856Z                              $nvmePath = 
2026-01-11T19:28:14.0553298Z                      "HKLM:\SYSTEM\CurrentControlSet\Policies\Microsoft\FeatureManagement\Overrides"
2026-01-11T19:28:14.0553515Z                      
2026-01-11T19:28:14.0554870Z                              if (Test-Path $nvmePath) {
2026-01-11T19:28:14.0555192Z                                  $currentValue = Get-RegistryValue -Path $nvmePath -Name "1176759950"
2026-01-11T19:28:14.0556162Z                                  if ($null -ne $currentValue) {
2026-01-11T19:28:14.0556896Z                                      Set-RegistryValue -Path $nvmePath -Name "1176759950" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.0557234Z                                      Write-Log "Native NVMe disabled (reboot required)" "SUCCESS"
2026-01-11T19:28:14.0558359Z                                      Write-Log "After reboot: NVMe devices return to 'Disk drives' in Device Manager" 
2026-01-11T19:28:14.0558448Z                      "INFO"
2026-01-11T19:28:14.0559657Z                                      return $true
2026-01-11T19:28:14.0560088Z                                  } else {
2026-01-11T19:28:14.0560513Z                                      Write-Log "Native NVMe was not enabled (registry key not found)" "INFO"
2026-01-11T19:28:14.0561637Z                                      return $false
2026-01-11T19:28:14.0561747Z                                  }
2026-01-11T19:28:14.0562568Z                              } else {
2026-01-11T19:28:14.0563673Z                                  Write-Log "Native NVMe was not enabled (registry path not found)" "INFO"
2026-01-11T19:28:14.0564063Z                                  return $false
2026-01-11T19:28:14.0565278Z                              }
2026-01-11T19:28:14.0566066Z                      
2026-01-11T19:28:14.0566820Z                          } catch {
2026-01-11T19:28:14.0568041Z                              Write-Log "Error disabling Native NVMe: $_" "ERROR"
2026-01-11T19:28:14.0568471Z                              throw
2026-01-11T19:28:14.0569729Z                          }
2026-01-11T19:28:14.0569844Z                      }
2026-01-11T19:28:14.0571071Z                      
2026-01-11T19:28:14.0571954Z                      
2026-01-11T19:28:14.0573358Z                      function Test-NativeNVMeStatus {
2026-01-11T19:28:14.0573497Z                          <#
2026-01-11T19:28:14.0574281Z                          .SYNOPSIS
2026-01-11T19:28:14.0575413Z                              Checks if Native NVMe is currently enabled.
2026-01-11T19:28:14.0575873Z                          .OUTPUTS
2026-01-11T19:28:14.0577041Z                              $true if enabled, $false otherwise
2026-01-11T19:28:14.0577432Z                          #>
2026-01-11T19:28:14.0578336Z                      
2026-01-11T19:28:14.0578449Z                          try {
2026-01-11T19:28:14.0579663Z                              $nvmePath = 
2026-01-11T19:28:14.0580025Z                      "HKLM:\SYSTEM\CurrentControlSet\Policies\Microsoft\FeatureManagement\Overrides"
2026-01-11T19:28:14.0580933Z                      
2026-01-11T19:28:14.0581844Z                              if (Test-Path $nvmePath) {
2026-01-11T19:28:14.0582513Z                                  $value = Get-RegistryValue -Path $nvmePath -Name "1176759950"
2026-01-11T19:28:14.0582905Z                                  if ($value -eq 1) {
2026-01-11T19:28:14.0584236Z                                      Write-Log "Native NVMe: Currently ENABLED" "SUCCESS"
2026-01-11T19:28:14.0584372Z                                      return $true
2026-01-11T19:28:14.0585256Z                                  }
2026-01-11T19:28:14.0585372Z                              }
2026-01-11T19:28:14.0586627Z                      
2026-01-11T19:28:14.0586878Z                              Write-Log "Native NVMe: Currently DISABLED" "INFO"
2026-01-11T19:28:14.0587971Z                              return $false
2026-01-11T19:28:14.0588071Z                      
2026-01-11T19:28:14.0589409Z                          } catch {
2026-01-11T19:28:14.0590446Z                              Write-Log "Error checking Native NVMe status: $_" "ERROR"
2026-01-11T19:28:14.0591353Z                              return $false
2026-01-11T19:28:14.0591462Z                          }
2026-01-11T19:28:14.0592686Z                      }
2026-01-11T19:28:14.0592811Z                      
2026-01-11T19:28:14.0593700Z                      
2026-01-11T19:28:14.0595086Z                      function Invoke-PerformanceOptimizations {
2026-01-11T19:28:14.0595182Z                          <#
2026-01-11T19:28:14.0596326Z                          .SYNOPSIS
2026-01-11T19:28:14.0596602Z                              Applies the full performance optimization set.
2026-01-11T19:28:14.0597721Z                          .DESCRIPTION
2026-01-11T19:28:14.0598404Z                              Runs GameDVR/FSO toggles, HPET (opt-in), MSI mode, scheduler tweaks,
2026-01-11T19:28:14.0598750Z                              timer and MMCSS adjustments, Game Mode, and optional Native NVMe.
2026-01-11T19:28:14.0599806Z                          .PARAMETER DisableHPET
2026-01-11T19:28:14.0600708Z                              Enables HPET-related changes when true (opt-in).
2026-01-11T19:28:14.0601392Z                          .PARAMETER DisableCoreParking
2026-01-11T19:28:14.0601925Z                              Disables core parking when true (opt-in).
2026-01-11T19:28:14.0603088Z                          .PARAMETER DisableGameDVR
2026-01-11T19:28:14.0603285Z                              Disables GameDVR capture when true.
2026-01-11T19:28:14.0604343Z                          .PARAMETER DisableFSO
2026-01-11T19:28:14.0604682Z                              Disables Fullscreen Optimizations when true.
2026-01-11T19:28:14.0605802Z                          .PARAMETER EnableNativeNVMe
2026-01-11T19:28:14.0606090Z                              Enables Native NVMe I/O path when true (opt-in).
2026-01-11T19:28:14.0606846Z                          .OUTPUTS
2026-01-11T19:28:14.0607896Z                              None.
2026-01-11T19:28:14.0608063Z                          #>
2026-01-11T19:28:14.0609580Z                          param(
2026-01-11T19:28:14.0610110Z                              [bool]$DisableHPET = $false,
2026-01-11T19:28:14.0610947Z                              [bool]$DisableCoreParking = $false,
2026-01-11T19:28:14.0612132Z                              [bool]$DisableGameDVR = $true,
2026-01-11T19:28:14.0612302Z                              [bool]$DisableFSO = $true,
2026-01-11T19:28:14.0613172Z                              [bool]$EnableNativeNVMe = $false
2026-01-11T19:28:14.0614141Z                          )
2026-01-11T19:28:14.0615018Z                      
2026-01-11T19:28:14.0616427Z                          Write-Log "Applying performance optimizations..." "INFO"
2026-01-11T19:28:14.0616539Z                      
2026-01-11T19:28:14.0617532Z                          try {
2026-01-11T19:28:14.0617729Z                              Set-GameDVR -Enable $DisableGameDVR
2026-01-11T19:28:14.0618948Z                              Set-FullscreenOptimizations -Enable $DisableFSO
2026-01-11T19:28:14.0619081Z                      
2026-01-11T19:28:14.0620351Z                              Disable-HPET -Enable $DisableHPET
2026-01-11T19:28:14.0620836Z                      
2026-01-11T19:28:14.0621893Z                              Enable-MSIMode
2026-01-11T19:28:14.0622039Z                      
2026-01-11T19:28:14.0623289Z                              Set-CoreParking -Disable $DisableCoreParking
2026-01-11T19:28:14.0623400Z                      
2026-01-11T19:28:14.0624361Z                              Set-SchedulerOptimizations
2026-01-11T19:28:14.0625192Z                      
2026-01-11T19:28:14.0625892Z                              Set-TimerResolution
2026-01-11T19:28:14.0627144Z                      
2026-01-11T19:28:14.0627280Z                              Set-MMCSSGamingTweaks
2026-01-11T19:28:14.0628296Z                      
2026-01-11T19:28:14.0629361Z                              Enable-GameMode
2026-01-11T19:28:14.0629483Z                      
2026-01-11T19:28:14.0629699Z                              Enable-NativeNVMe -Enable $EnableNativeNVMe
2026-01-11T19:28:14.0631238Z                      
2026-01-11T19:28:14.0631739Z                              Write-Log "Performance optimizations complete" "SUCCESS"
2026-01-11T19:28:14.0632941Z                              Write-Log "IMPORTANT: Reboot required for HPET, MSI mode, and Native NVMe changes" "INFO"
2026-01-11T19:28:14.0633424Z                              Write-Log "Run timer-tool.ps1 during gameplay for 0.5-1.0ms timer resolution" "INFO"
2026-01-11T19:28:14.0633547Z                      
2026-01-11T19:28:14.0633667Z                          } catch {
2026-01-11T19:28:14.0635037Z                              Write-Log "Error applying performance optimizations: $_" "ERROR"
2026-01-11T19:28:14.0635168Z                              throw
2026-01-11T19:28:14.0636242Z                          }
2026-01-11T19:28:14.0636908Z                      }
2026-01-11T19:28:14.0637962Z                      
2026-01-11T19:28:14.0638695Z                      
2026-01-11T19:28:14.0639044Z                      function Disable-MultiplaneOverlay {
2026-01-11T19:28:14.0640081Z                          <#
2026-01-11T19:28:14.0640202Z                          .SYNOPSIS
2026-01-11T19:28:14.0641746Z                              Disables Multiplane Overlay (MPO) for reduced GPU overhead.
2026-01-11T19:28:14.0641842Z                          .DESCRIPTION
2026-01-11T19:28:14.0642885Z                              MPO is a DWM feature that can cause stuttering during streaming/recording.
2026-01-11T19:28:14.0643488Z                              Disabling it reduces GPU overhead from window composition.
2026-01-11T19:28:14.0644179Z                              Best for: Streamers and users experiencing DWM-related stutters.
2026-01-11T19:28:14.0644318Z                          .OUTPUTS
2026-01-11T19:28:14.0645358Z                              None.
2026-01-11T19:28:14.0646116Z                          #>
2026-01-11T19:28:14.0647045Z                          param(
2026-01-11T19:28:14.0647198Z                              [bool]$Enable = $true
2026-01-11T19:28:14.0648223Z                          )
2026-01-11T19:28:14.0648675Z                      
2026-01-11T19:28:14.0649098Z                          if (-not $Enable) {
2026-01-11T19:28:14.0650374Z                              Write-Log "Disable Multiplane Overlay: skipped" "INFO"
2026-01-11T19:28:14.0650497Z                              return
2026-01-11T19:28:14.0651513Z                          }
2026-01-11T19:28:14.0652139Z                      
2026-01-11T19:28:14.0652933Z                          try {
2026-01-11T19:28:14.0653728Z                              $dwmPath = "HKLM:\SOFTWARE\Microsoft\Windows\Dwm"
2026-01-11T19:28:14.0654521Z                              Backup-RegistryKey -Path $dwmPath
2026-01-11T19:28:14.0654624Z                      
2026-01-11T19:28:14.0654785Z                              # OverlayTestMode = 5 disables MPO
2026-01-11T19:28:14.0656002Z                              Set-RegistryValue -Path $dwmPath -Name "OverlayTestMode" -Value 5 -Type "DWORD"
2026-01-11T19:28:14.0656216Z                      
2026-01-11T19:28:14.0657655Z                              Write-Log "Disabled Multiplane Overlay (reduces GPU overhead for streaming)" "SUCCESS"
2026-01-11T19:28:14.0658234Z                          } catch {
2026-01-11T19:28:14.0658685Z                              Write-Log "Error disabling Multiplane Overlay: $_" "ERROR"
2026-01-11T19:28:14.0658816Z                          }
2026-01-11T19:28:14.0658911Z                      }
2026-01-11T19:28:14.0659353Z                      
2026-01-11T19:28:14.0660356Z                      
2026-01-11T19:28:14.0660842Z                      function Disable-ProcessMitigations {
2026-01-11T19:28:14.0661010Z                          <#
2026-01-11T19:28:14.0662149Z                          .SYNOPSIS
2026-01-11T19:28:14.0662479Z                              Disables Windows process mitigations for maximum performance.
2026-01-11T19:28:14.0662728Z                          .DESCRIPTION
2026-01-11T19:28:14.0663721Z                              Security mitigations like CFG and SEHOP add overhead.
2026-01-11T19:28:14.0664055Z                              Disabling them can improve benchmark scores but reduces security.
2026-01-11T19:28:14.0664365Z                              Best for: Benchmarking only - NOT recommended for daily use.
2026-01-11T19:28:14.0664594Z                          .OUTPUTS
2026-01-11T19:28:14.0665419Z                              None.
2026-01-11T19:28:14.0666073Z                          #>
2026-01-11T19:28:14.0666484Z                          param(
2026-01-11T19:28:14.0667318Z                              [bool]$Enable = $true
2026-01-11T19:28:14.0667800Z                          )
2026-01-11T19:28:14.0668137Z                      
2026-01-11T19:28:14.0668816Z                          if (-not $Enable) {
2026-01-11T19:28:14.0669779Z                              Write-Log "Disable process mitigations: skipped" "INFO"
2026-01-11T19:28:14.0669881Z                              return
2026-01-11T19:28:14.0670542Z                          }
2026-01-11T19:28:14.0670658Z                      
2026-01-11T19:28:14.0671801Z                          try {
2026-01-11T19:28:14.0672495Z                              # Disable system-wide exploit protection mitigations
2026-01-11T19:28:14.0672947Z                              $exploitPath = "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\kernel"
2026-01-11T19:28:14.0673159Z                              Backup-RegistryKey -Path $exploitPath
2026-01-11T19:28:14.0673269Z                      
2026-01-11T19:28:14.0673852Z                              # Disable Kernel CET (Shadow Stacks) - only on supported systems
2026-01-11T19:28:14.0675435Z                              Set-RegistryValue -Path $exploitPath -Name "KernelShadowStacksForceDisabled" -Value 1 
2026-01-11T19:28:14.0675669Z                      -Type "DWORD" -ErrorAction SilentlyContinue
2026-01-11T19:28:14.0675771Z                      
2026-01-11T19:28:14.0676254Z                              Write-Log "Disabled process mitigations (benchmarking mode - reduces security)" "SUCCESS"
2026-01-11T19:28:14.0676836Z                              Write-Log "WARNING: Re-enable mitigations after benchmarking for security" "ERROR"
2026-01-11T19:28:14.0676968Z                          } catch {
2026-01-11T19:28:14.0677465Z                              Write-Log "Error disabling process mitigations: $_" "ERROR"
2026-01-11T19:28:14.0677765Z                          }
2026-01-11T19:28:14.0678155Z                      }
2026-01-11T19:28:14.0679001Z                      
2026-01-11T19:28:14.0679110Z                      
2026-01-11T19:28:14.0679970Z                      function Set-InterruptAffinity {
2026-01-11T19:28:14.0680629Z                          <#
2026-01-11T19:28:14.0680757Z                          .SYNOPSIS
2026-01-11T19:28:14.0681580Z                              Configures GPU interrupt affinity to reduce DPC latency.
2026-01-11T19:28:14.0681712Z                          .DESCRIPTION
2026-01-11T19:28:14.0682047Z                              Assigns GPU interrupts to a specific CPU core to reduce
2026-01-11T19:28:14.0682571Z                              context switching and improve frame consistency.
2026-01-11T19:28:14.0682911Z                              Best for: High-end systems chasing benchmark scores.
2026-01-11T19:28:14.0683233Z                          .OUTPUTS
2026-01-11T19:28:14.0683870Z                              None.
2026-01-11T19:28:14.0684026Z                          #>
2026-01-11T19:28:14.0685022Z                          param(
2026-01-11T19:28:14.0685184Z                              [bool]$Enable = $true
2026-01-11T19:28:14.0685958Z                          )
2026-01-11T19:28:14.0686666Z                      
2026-01-11T19:28:14.0687132Z                          if (-not $Enable) {
2026-01-11T19:28:14.0687393Z                              Write-Log "GPU interrupt affinity: skipped" "INFO"
2026-01-11T19:28:14.0688393Z                              return
2026-01-11T19:28:14.0689138Z                          }
2026-01-11T19:28:14.0689242Z                      
2026-01-11T19:28:14.0690024Z                          try {
2026-01-11T19:28:14.0690831Z                              # Find GPU device
2026-01-11T19:28:14.0691883Z                              $gpuDevice = Get-PnpDevice -Class Display | Where-Object { $_.Status -eq "OK" } | 
2026-01-11T19:28:14.0692025Z                      Select-Object -First 1
2026-01-11T19:28:14.0692209Z                      
2026-01-11T19:28:14.0692908Z                              if (-not $gpuDevice) {
2026-01-11T19:28:14.0693254Z                                  Write-Log "No GPU found for interrupt affinity configuration" "INFO"
2026-01-11T19:28:14.0693467Z                                  return
2026-01-11T19:28:14.0693861Z                              }
2026-01-11T19:28:14.0694814Z                      
2026-01-11T19:28:14.0695007Z                              $deviceId = $gpuDevice.InstanceId
2026-01-11T19:28:14.0696066Z                              $msiPath = "HKLM:\SYSTEM\CurrentControlSet\Enum\$deviceId\Device Parameters\Interrupt 
2026-01-11T19:28:14.0696308Z                      Management\Affinity Policy"
2026-01-11T19:28:14.0697179Z                      
2026-01-11T19:28:14.0697898Z                              if (-not (Test-Path $msiPath)) {
2026-01-11T19:28:14.0698091Z                                  New-Item -Path $msiPath -Force | Out-Null
2026-01-11T19:28:14.0698698Z                              }
2026-01-11T19:28:14.0698810Z                      
2026-01-11T19:28:14.0699693Z                              Backup-RegistryKey -Path $msiPath
2026-01-11T19:28:14.0699788Z                      
2026-01-11T19:28:14.0700745Z                              # DevicePolicy = 4 (IrqPolicySpreadMessagesAcrossAllProcessors is default)
2026-01-11T19:28:14.0701016Z                              # We set to specific processor for consistency
2026-01-11T19:28:14.0702183Z                              Set-RegistryValue -Path $msiPath -Name "DevicePolicy" -Value 3 -Type "DWORD"  # 
2026-01-11T19:28:14.0702396Z                      IrqPolicySpecifiedProcessors
2026-01-11T19:28:14.0702758Z                      
2026-01-11T19:28:14.0703655Z                              # AssignmentSetOverride = target processor mask (CPU 0 = 1, CPU 1 = 2, etc.)
2026-01-11T19:28:14.0703848Z                              # Default to CPU 0 for GPU interrupts
2026-01-11T19:28:14.0705209Z                              Set-RegistryValue -Path $msiPath -Name "AssignmentSetOverride" -Value 1 -Type "DWORD"
2026-01-11T19:28:14.0705332Z                      
2026-01-11T19:28:14.0705730Z                              Write-Log "GPU interrupt affinity configured (assigned to CPU 0)" "SUCCESS"
2026-01-11T19:28:14.0706058Z                              Write-Log "Reboot required for interrupt affinity changes" "INFO"
2026-01-11T19:28:14.0706333Z                          } catch {
2026-01-11T19:28:14.0707010Z                              Write-Log "Error setting interrupt affinity: $_" "ERROR"
2026-01-11T19:28:14.0707590Z                          }
2026-01-11T19:28:14.0708329Z                      }
2026-01-11T19:28:14.0708995Z                      
2026-01-11T19:28:14.0709103Z                      
2026-01-11T19:28:14.0710120Z                      function Disable-CoreIsolation {
2026-01-11T19:28:14.0710210Z                          <#
2026-01-11T19:28:14.0710542Z                          .SYNOPSIS
2026-01-11T19:28:14.0712039Z                              Disables Core Isolation (VBS/HVCI) for maximum performance.
2026-01-11T19:28:14.0712167Z                          .DESCRIPTION
2026-01-11T19:28:14.0712396Z                              Virtualization-Based Security adds ~5-10% overhead.
2026-01-11T19:28:14.0712914Z                              Disabling it improves performance but reduces security.
2026-01-11T19:28:14.0713709Z                              Best for: Benchmarking only - NOT recommended for daily use.
2026-01-11T19:28:14.0713812Z                          .OUTPUTS
2026-01-11T19:28:14.0714552Z                              None.
2026-01-11T19:28:14.0715215Z                          #>
2026-01-11T19:28:14.0715329Z                          param(
2026-01-11T19:28:14.0716220Z                              [bool]$Enable = $true
2026-01-11T19:28:14.0716585Z                          )
2026-01-11T19:28:14.0717283Z                      
2026-01-11T19:28:14.0718177Z                          if (-not $Enable) {
2026-01-11T19:28:14.0718442Z                              Write-Log "Disable Core Isolation: skipped" "INFO"
2026-01-11T19:28:14.0718866Z                              return
2026-01-11T19:28:14.0719220Z                          }
2026-01-11T19:28:14.0719714Z                      
2026-01-11T19:28:14.0721432Z                          try {
2026-01-11T19:28:14.0721810Z                              $deviceGuardPath = "HKLM:\SYSTEM\CurrentControlSet\Control\DeviceGuard"
2026-01-11T19:28:14.0722052Z                              Backup-RegistryKey -Path $deviceGuardPath
2026-01-11T19:28:14.0722194Z                      
2026-01-11T19:28:14.0723310Z                              # Disable VBS
2026-01-11T19:28:14.0724479Z                              Set-RegistryValue -Path $deviceGuardPath -Name "EnableVirtualizationBasedSecurity" -Value 
2026-01-11T19:28:14.0724612Z                      0 -Type "DWORD"
2026-01-11T19:28:14.0724710Z                      
2026-01-11T19:28:14.0725645Z                              $hvciPath = 
2026-01-11T19:28:14.0726191Z                      "HKLM:\SYSTEM\CurrentControlSet\Control\DeviceGuard\Scenarios\HypervisorEnforcedCodeIntegrity"
2026-01-11T19:28:14.0726386Z                              if (Test-Path $hvciPath) {
2026-01-11T19:28:14.0727202Z                                  Backup-RegistryKey -Path $hvciPath
2026-01-11T19:28:14.0728775Z                                  Set-RegistryValue -Path $hvciPath -Name "Enabled" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.0728888Z                              }
2026-01-11T19:28:14.0729327Z                      
2026-01-11T19:28:14.0730969Z                              Write-Log "Disabled Core Isolation / VBS (benchmarking mode - reduces security)" "SUCCESS"
2026-01-11T19:28:14.0731438Z                              Write-Log "WARNING: Re-enable Core Isolation after benchmarking for security" "ERROR"
2026-01-11T19:28:14.0731747Z                              Write-Log "Reboot required for Core Isolation changes" "INFO"
2026-01-11T19:28:14.0731861Z                          } catch {
2026-01-11T19:28:14.0732105Z                              Write-Log "Error disabling Core Isolation: $_" "ERROR"
2026-01-11T19:28:14.0732213Z                          }
2026-01-11T19:28:14.0732494Z                      }
2026-01-11T19:28:14.0733528Z                      
2026-01-11T19:28:14.0733645Z                      
2026-01-11T19:28:14.0734517Z                      function Undo-PerformanceOptimizations {
2026-01-11T19:28:14.0735528Z                          <#
2026-01-11T19:28:14.0735668Z                          .SYNOPSIS
2026-01-11T19:28:14.0736725Z                              Rolls back performance-related changes.
2026-01-11T19:28:14.0736849Z                          .DESCRIPTION
2026-01-11T19:28:14.0737429Z                              Removes HPET boot flags, restores registry backups, and disables Native
2026-01-11T19:28:14.0737707Z                              NVMe when it was enabled.
2026-01-11T19:28:14.0738793Z                          .OUTPUTS
2026-01-11T19:28:14.0738921Z                              None.
2026-01-11T19:28:14.0739581Z                          #>
2026-01-11T19:28:14.0740023Z                          Write-Log "Rolling back performance optimizations..." "INFO"
2026-01-11T19:28:14.0740268Z                      
2026-01-11T19:28:14.0740948Z                          try {
2026-01-11T19:28:14.0742541Z                              bcdedit /deletevalue useplatformclock 2>&1 | Out-Null
2026-01-11T19:28:14.0742822Z                              bcdedit /deletevalue disabledynamictick 2>&1 | Out-Null
2026-01-11T19:28:14.0742908Z                      
2026-01-11T19:28:14.0743491Z                              $paths = @(
2026-01-11T19:28:14.0744303Z                                  "HKLM:\SYSTEM\CurrentControlSet\Control\PriorityControl",
2026-01-11T19:28:14.0744637Z                                  "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\kernel",
2026-01-11T19:28:14.0745315Z                                  "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile",
2026-01-11T19:28:14.0746004Z                                  "HKLM:\SYSTEM\CurrentControlSet\Control\Power",
2026-01-11T19:28:14.0746196Z                                  "HKLM:\SOFTWARE\Microsoft\Windows 
2026-01-11T19:28:14.0746736Z                      NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games",
2026-01-11T19:28:14.0747243Z                                  "HKLM:\SOFTWARE\Microsoft\PolicyManager\default\ApplicationManagement\AllowGameMode",
2026-01-11T19:28:14.0747521Z                                  "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\GameDVR",
2026-01-11T19:28:14.0747692Z                                  "HKCU:\System\GameConfigStore"
2026-01-11T19:28:14.0748038Z                              )
2026-01-11T19:28:14.0748632Z                      
2026-01-11T19:28:14.0748893Z                              foreach ($path in $paths) {
2026-01-11T19:28:14.0749646Z                                  if (Restore-RegistryKey -Path $path) {
2026-01-11T19:28:14.0749907Z                                      Write-Log "Restored registry: $path" "SUCCESS"
2026-01-11T19:28:14.0750140Z                                  }
2026-01-11T19:28:14.0750683Z                              }
2026-01-11T19:28:14.0751230Z                      
2026-01-11T19:28:14.0752018Z                              # Disable Native NVMe if it was enabled
2026-01-11T19:28:14.0752203Z                              Disable-NativeNVMe | Out-Null
2026-01-11T19:28:14.0752469Z                      
2026-01-11T19:28:14.0753833Z                              Write-Log "Performance optimization rollback complete (restart required)" "SUCCESS"
2026-01-11T19:28:14.0753940Z                      
2026-01-11T19:28:14.0754060Z                          } catch {
2026-01-11T19:28:14.0754278Z                              Write-Log "Error during rollback: $_" "ERROR"
2026-01-11T19:28:14.0754474Z                              throw
2026-01-11T19:28:14.0755451Z                          }
2026-01-11T19:28:14.0756126Z                      }
2026-01-11T19:28:14.0756231Z                      
2026-01-11T19:28:14.0757246Z                      
2026-01-11T19:28:14.0757458Z                      Export-ModuleMember -Function @(
2026-01-11T19:28:14.0757597Z                          'Disable-HPET',
2026-01-11T19:28:14.0757840Z                          'Enable-MSIMode',
2026-01-11T19:28:14.0758801Z                          'Set-CoreParking',
2026-01-11T19:28:14.0758990Z                          'Set-SchedulerOptimizations',
2026-01-11T19:28:14.0759133Z                          'Set-TimerResolution',
2026-01-11T19:28:14.0759402Z                          'Set-MMCSSGamingTweaks',
2026-01-11T19:28:14.0760196Z                          'Enable-GameMode',
2026-01-11T19:28:14.0760321Z                          'Set-GameDVR',
2026-01-11T19:28:14.0760797Z                          'Set-FullscreenOptimizations',
2026-01-11T19:28:14.0761629Z                          'Test-NVMeSupport',
2026-01-11T19:28:14.0762847Z                          'Enable-NativeNVMe',
2026-01-11T19:28:14.0763027Z                          'Disable-NativeNVMe',
2026-01-11T19:28:14.0763173Z                          'Test-NativeNVMeStatus',
2026-01-11T19:28:14.0763339Z                          'Disable-MultiplaneOverlay',
2026-01-11T19:28:14.0763508Z                          'Disable-ProcessMitigations',
2026-01-11T19:28:14.0763790Z                          'Set-InterruptAffinity',
2026-01-11T19:28:14.0764182Z                          'Disable-CoreIsolation',
2026-01-11T19:28:14.0764611Z                          'Test-PerformanceOptimizations',
2026-01-11T19:28:14.0764982Z                          'Invoke-PerformanceOptimizations',
2026-01-11T19:28:14.0765670Z                          'Undo-PerformanceOptimizations'
2026-01-11T19:28:14.0765840Z                      )
2026-01-11T19:28:14.0766223Z                      
2026-01-11T19:28:14.0767114Z [32;1mParent             : [0m
2026-01-11T19:28:14.0767133Z 
2026-01-11T19:28:14.0787267Z [32;1mAttributes         : [0m{}
2026-01-11T19:28:14.0787486Z [32;1mUsingStatements    : [0m{}
2026-01-11T19:28:14.0788633Z [32;1mParamBlock         : [0m
2026-01-11T19:28:14.0788857Z [32;1mBeginBlock         : [0m
2026-01-11T19:28:14.0790094Z [32;1mProcessBlock       : [0m
2026-01-11T19:28:14.0792128Z [32;1mEndBlock           : [0mImport-Module (Join-Path $PSScriptRoot "..\core\logger.psm1") -Force -Global
2026-01-11T19:28:14.0792572Z                      Import-Module (Join-Path $PSScriptRoot "..\core\registry.psm1") -Force -Global
2026-01-11T19:28:14.0792670Z                      
2026-01-11T19:28:14.0793268Z                      
2026-01-11T19:28:14.0793919Z                      
2026-01-11T19:28:14.0794135Z                      function Disable-MouseAcceleration {
2026-01-11T19:28:14.0794727Z                          <#
2026-01-11T19:28:14.0794940Z                          .SYNOPSIS
2026-01-11T19:28:14.0795795Z                              Disables Windows mouse acceleration (Enhance pointer precision).
2026-01-11T19:28:14.0796056Z                          .DESCRIPTION
2026-01-11T19:28:14.0796902Z                              Sets registry values to disable mouse acceleration and apply 1:1 linear
2026-01-11T19:28:14.0797237Z                              mouse movement. This is the "Enhance pointer precision" setting in
2026-01-11T19:28:14.0797442Z                              Mouse Properties > Pointer Options.
2026-01-11T19:28:14.0798293Z                          .PARAMETER Enable
2026-01-11T19:28:14.0798585Z                              When true, applies mouse acceleration settings.
2026-01-11T19:28:14.0798705Z                          .OUTPUTS
2026-01-11T19:28:14.0799237Z                              None.
2026-01-11T19:28:14.0799627Z                          .NOTES
2026-01-11T19:28:14.0800425Z                              Mouse acceleration makes cursor speed inconsistent, breaking muscle memory.
2026-01-11T19:28:14.0800609Z                              Pro gamers always disable this.
2026-01-11T19:28:14.0800893Z                          #>
2026-01-11T19:28:14.0801290Z                          param(
2026-01-11T19:28:14.0802249Z                              [bool]$Enable = $true
2026-01-11T19:28:14.0802845Z                          )
2026-01-11T19:28:14.0803307Z                      
2026-01-11T19:28:14.0804034Z                          if (-not $Enable) {
2026-01-11T19:28:14.0804325Z                              Write-Log "Mouse acceleration disable: skipped" "INFO"
2026-01-11T19:28:14.0804625Z                              return
2026-01-11T19:28:14.0805560Z                          }
2026-01-11T19:28:14.0805681Z                      
2026-01-11T19:28:14.0805797Z                          try {
2026-01-11T19:28:14.0806638Z                              Write-Log "Disabling mouse acceleration..." "INFO"
2026-01-11T19:28:14.0806761Z                      
2026-01-11T19:28:14.0807530Z                              $mousePath = "HKCU:\Control Panel\Mouse"
2026-01-11T19:28:14.0808002Z                              Backup-RegistryKey -Path $mousePath
2026-01-11T19:28:14.0809435Z                      
2026-01-11T19:28:14.0809668Z                              # MouseSpeed = 0: Disable acceleration
2026-01-11T19:28:14.0810048Z                              # MouseThreshold1/2 = 0: Disable threshold-based acceleration
2026-01-11T19:28:14.0810499Z                              Set-RegistryValue -Path $mousePath -Name "MouseSpeed" -Value "0" -Type "String"
2026-01-11T19:28:14.0810977Z                              Set-RegistryValue -Path $mousePath -Name "MouseThreshold1" -Value "0" -Type "String"
2026-01-11T19:28:14.0811451Z                              Set-RegistryValue -Path $mousePath -Name "MouseThreshold2" -Value "0" -Type "String"
2026-01-11T19:28:14.0811545Z                      
2026-01-11T19:28:14.0811909Z                              Write-Log "Mouse acceleration disabled (1:1 linear movement)" "SUCCESS"
2026-01-11T19:28:14.0812398Z                              Write-Log "This is the 'Enhance pointer precision' setting in Mouse Properties" "INFO"
2026-01-11T19:28:14.0812742Z                              Write-Log "Note: May require logout/login to take full effect" "INFO"
2026-01-11T19:28:14.0813070Z                      
2026-01-11T19:28:14.0813399Z                              # Also set SmoothMouseXCurve and SmoothMouseYCurve for true 1:1
2026-01-11T19:28:14.0813529Z                              try {
2026-01-11T19:28:14.0814805Z                                  # Linear curve: 00 00 00 00 00 00 00 00 | C0 CC 0C 00 00 00 00 00 | 80 99 19 00 00 00 
2026-01-11T19:28:14.0815410Z                      00 00 | 40 66 26 00 00 00 00 00 | 00 33 33 00 00 00 00 00
2026-01-11T19:28:14.0815871Z                                  $linearCurve = [byte[]](0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
2026-01-11T19:28:14.0816813Z                                                          0xC0, 0xCC, 0x0C, 0x00, 0x00, 0x00, 0x00, 0x00,
2026-01-11T19:28:14.0817076Z                                                          0x80, 0x99, 0x19, 0x00, 0x00, 0x00, 0x00, 0x00,
2026-01-11T19:28:14.0817444Z                                                          0x40, 0x66, 0x26, 0x00, 0x00, 0x00, 0x00, 0x00,
2026-01-11T19:28:14.0817846Z                                                          0x00, 0x33, 0x33, 0x00, 0x00, 0x00, 0x00, 0x00)
2026-01-11T19:28:14.0818075Z                      
2026-01-11T19:28:14.0819710Z                                  Set-RegistryValue -Path $mousePath -Name "SmoothMouseXCurve" -Value $linearCurve 
2026-01-11T19:28:14.0819864Z                      -Type "Binary"
2026-01-11T19:28:14.0820407Z                                  Set-RegistryValue -Path $mousePath -Name "SmoothMouseYCurve" -Value $linearCurve 
2026-01-11T19:28:14.0820537Z                      -Type "Binary"
2026-01-11T19:28:14.0820918Z                      
2026-01-11T19:28:14.0822013Z                                  Write-Log "Applied 1:1 linear mouse curve" "SUCCESS"
2026-01-11T19:28:14.0822145Z                              } catch {
2026-01-11T19:28:14.0822563Z                                  Write-Log "Could not set linear mouse curve (optional, not critical)" "INFO"
2026-01-11T19:28:14.0822671Z                              }
2026-01-11T19:28:14.0822941Z                      
2026-01-11T19:28:14.0823585Z                          } catch {
2026-01-11T19:28:14.0824042Z                              Write-Log "Error disabling mouse acceleration: $_" "ERROR"
2026-01-11T19:28:14.0824173Z                              throw
2026-01-11T19:28:14.0824573Z                          }
2026-01-11T19:28:14.0824862Z                      }
2026-01-11T19:28:14.0825730Z                      
2026-01-11T19:28:14.0825847Z                      
2026-01-11T19:28:14.0826287Z                      function Enable-MouseAcceleration {
2026-01-11T19:28:14.0826945Z                          <#
2026-01-11T19:28:14.0827249Z                          .SYNOPSIS
2026-01-11T19:28:14.0828105Z                              Re-enables Windows mouse acceleration.
2026-01-11T19:28:14.0828816Z                          .DESCRIPTION
2026-01-11T19:28:14.0830040Z                              Restores default Windows mouse acceleration settings.
2026-01-11T19:28:14.0830165Z                          .OUTPUTS
2026-01-11T19:28:14.0830267Z                              None.
2026-01-11T19:28:14.0830576Z                          #>
2026-01-11T19:28:14.0831509Z                          try {
2026-01-11T19:28:14.0832415Z                              Write-Log "Re-enabling mouse acceleration..." "INFO"
2026-01-11T19:28:14.0832731Z                      
2026-01-11T19:28:14.0833646Z                              $mousePath = "HKCU:\Control Panel\Mouse"
2026-01-11T19:28:14.0834231Z                              Backup-RegistryKey -Path $mousePath
2026-01-11T19:28:14.0835265Z                      
2026-01-11T19:28:14.0836369Z                              # Windows defaults
2026-01-11T19:28:14.0836850Z                              Set-RegistryValue -Path $mousePath -Name "MouseSpeed" -Value "1" -Type "String"
2026-01-11T19:28:14.0838168Z                              Set-RegistryValue -Path $mousePath -Name "MouseThreshold1" -Value "6" -Type "String"
2026-01-11T19:28:14.0838974Z                              Set-RegistryValue -Path $mousePath -Name "MouseThreshold2" -Value "10" -Type "String"
2026-01-11T19:28:14.0839079Z                      
2026-01-11T19:28:14.0839459Z                              Write-Log "Mouse acceleration re-enabled (Windows defaults)" "SUCCESS"
2026-01-11T19:28:14.0839908Z                              Write-Log "Note: May require logout/login to take full effect" "INFO"
2026-01-11T19:28:14.0840165Z                      
2026-01-11T19:28:14.0841019Z                          } catch {
2026-01-11T19:28:14.0842303Z                              Write-Log "Error enabling mouse acceleration: $_" "ERROR"
2026-01-11T19:28:14.0842415Z                              throw
2026-01-11T19:28:14.0842690Z                          }
2026-01-11T19:28:14.0843531Z                      }
2026-01-11T19:28:14.0843904Z                      
2026-01-11T19:28:14.0844541Z                      
2026-01-11T19:28:14.0845424Z                      function Test-MouseAcceleration {
2026-01-11T19:28:14.0845569Z                          <#
2026-01-11T19:28:14.0846368Z                          .SYNOPSIS
2026-01-11T19:28:14.0847331Z                              Verifies that mouse acceleration is disabled.
2026-01-11T19:28:14.0848779Z                          .DESCRIPTION
2026-01-11T19:28:14.0850616Z                              Checks registry values for MouseSpeed, MouseThreshold1, and MouseThreshold2.
2026-01-11T19:28:14.0852396Z                          .OUTPUTS
2026-01-11T19:28:14.0854255Z                              [bool] True when acceleration is disabled, else false.
2026-01-11T19:28:14.0855927Z                          #>
2026-01-11T19:28:14.0857389Z                          $allPassed = $true
2026-01-11T19:28:14.0858879Z                      
2026-01-11T19:28:14.0860459Z                          Write-Log "Verifying mouse acceleration settings..." "INFO"
2026-01-11T19:28:14.0862220Z                      
2026-01-11T19:28:14.0863670Z                          try {
2026-01-11T19:28:14.0865453Z                              $mousePath = "HKCU:\Control Panel\Mouse"
2026-01-11T19:28:14.0867463Z                      
2026-01-11T19:28:14.0868779Z                              $mouseSpeed = Get-RegistryValue -Path $mousePath -Name "MouseSpeed"
2026-01-11T19:28:14.0870925Z                              $threshold1 = Get-RegistryValue -Path $mousePath -Name "MouseThreshold1"
2026-01-11T19:28:14.0873132Z                              $threshold2 = Get-RegistryValue -Path $mousePath -Name "MouseThreshold2"
2026-01-11T19:28:14.0874945Z                      
2026-01-11T19:28:14.0876337Z                              if ($mouseSpeed -eq "0") {
2026-01-11T19:28:14.0879923Z                                  Write-Log "‚úì Mouse acceleration disabled (MouseSpeed = 0)" "SUCCESS"
2026-01-11T19:28:14.0880747Z                              } else {
2026-01-11T19:28:14.0881964Z                                  Write-Log "‚úó Mouse acceleration enabled (MouseSpeed = $mouseSpeed)" "ERROR"
2026-01-11T19:28:14.0883371Z                                  $allPassed = $false
2026-01-11T19:28:14.0884615Z                              }
2026-01-11T19:28:14.0885694Z                      
2026-01-11T19:28:14.0886944Z                              if ($threshold1 -eq "0" -and $threshold2 -eq "0") {
2026-01-11T19:28:14.0889109Z                                  Write-Log "‚úì Mouse thresholds disabled" "SUCCESS"
2026-01-11T19:28:14.0890508Z                              } else {
2026-01-11T19:28:14.0892231Z                                  Write-Log "‚úó Mouse thresholds not disabled (T1=$threshold1, T2=$threshold2)" "ERROR"
2026-01-11T19:28:14.0893858Z                                  $allPassed = $false
2026-01-11T19:28:14.0895061Z                              }
2026-01-11T19:28:14.0896141Z                      
2026-01-11T19:28:14.0897384Z                          } catch {
2026-01-11T19:28:14.0898825Z                              Write-Log "Error verifying mouse settings: $_" "ERROR"
2026-01-11T19:28:14.0900695Z                              return $false
2026-01-11T19:28:14.0902049Z                          }
2026-01-11T19:28:14.0903349Z                      
2026-01-11T19:28:14.0904672Z                          return $allPassed
2026-01-11T19:28:14.0906038Z                      }
2026-01-11T19:28:14.0907286Z                      
2026-01-11T19:28:14.0908842Z                      
2026-01-11T19:28:14.0910020Z                      function Invoke-PeripheralOptimizations {
2026-01-11T19:28:14.0911291Z                          <#
2026-01-11T19:28:14.0912322Z                          .SYNOPSIS
2026-01-11T19:28:14.0913553Z                              Applies all peripheral optimizations.
2026-01-11T19:28:14.0914848Z                          .DESCRIPTION
2026-01-11T19:28:14.0916172Z                              Disables mouse acceleration and applies other peripheral tweaks.
2026-01-11T19:28:14.0917660Z                          .PARAMETER DisableMouseAcceleration
2026-01-11T19:28:14.0918934Z                              When true, disables mouse acceleration.
2026-01-11T19:28:14.0920134Z                          .OUTPUTS
2026-01-11T19:28:14.0921216Z                              None.
2026-01-11T19:28:14.0922228Z                          #>
2026-01-11T19:28:14.0923308Z                          param(
2026-01-11T19:28:14.0924522Z                              [bool]$DisableMouseAcceleration = $true
2026-01-11T19:28:14.0926045Z                          )
2026-01-11T19:28:14.0927307Z                      
2026-01-11T19:28:14.0929100Z                          Write-Log "Applying peripheral optimizations..." "INFO"
2026-01-11T19:28:14.0930685Z                      
2026-01-11T19:28:14.0931889Z                          try {
2026-01-11T19:28:14.0933121Z                              if ($DisableMouseAcceleration) {
2026-01-11T19:28:14.0934568Z                                  Disable-MouseAcceleration -Enable $true
2026-01-11T19:28:14.0935850Z                              }
2026-01-11T19:28:14.0936964Z                      
2026-01-11T19:28:14.0938155Z                              Write-Log "Peripheral optimizations complete" "SUCCESS"
2026-01-11T19:28:14.0939600Z                      
2026-01-11T19:28:14.0940805Z                          } catch {
2026-01-11T19:28:14.0942316Z                              Write-Log "Error applying peripheral optimizations: $_" "ERROR"
2026-01-11T19:28:14.0943958Z                              throw
2026-01-11T19:28:14.0945280Z                          }
2026-01-11T19:28:14.0946436Z                      }
2026-01-11T19:28:14.0947463Z                      
2026-01-11T19:28:14.0948928Z                      
2026-01-11T19:28:14.0950118Z                      function Undo-PeripheralOptimizations {
2026-01-11T19:28:14.0951627Z                          <#
2026-01-11T19:28:14.0952849Z                          .SYNOPSIS
2026-01-11T19:28:14.0954194Z                              Reverts peripheral-related changes.
2026-01-11T19:28:14.0955654Z                          .DESCRIPTION
2026-01-11T19:28:14.0956999Z                              Restores Windows default mouse acceleration settings.
2026-01-11T19:28:14.0958406Z                          .OUTPUTS
2026-01-11T19:28:14.0959517Z                              None.
2026-01-11T19:28:14.0960603Z                          #>
2026-01-11T19:28:14.0961853Z                          Write-Log "Rolling back peripheral optimizations..." "INFO"
2026-01-11T19:28:14.0963203Z                      
2026-01-11T19:28:14.0964417Z                          try {
2026-01-11T19:28:14.0965599Z                              Enable-MouseAcceleration
2026-01-11T19:28:14.0967054Z                      
2026-01-11T19:28:14.0968904Z                              $mousePath = "HKCU:\Control Panel\Mouse"
2026-01-11T19:28:14.0970516Z                              if (Restore-RegistryKey -Path $mousePath) {
2026-01-11T19:28:14.0972220Z                                  Write-Log "Restored mouse registry settings" "SUCCESS"
2026-01-11T19:28:14.0974133Z                              }
2026-01-11T19:28:14.0975471Z                      
2026-01-11T19:28:14.0977397Z                              Write-Log "Peripheral optimization rollback complete" "SUCCESS"
2026-01-11T19:28:14.0978388Z                      
2026-01-11T19:28:14.0979538Z                          } catch {
2026-01-11T19:28:14.0980452Z                              Write-Log "Error during rollback: $_" "ERROR"
2026-01-11T19:28:14.0982116Z                              throw
2026-01-11T19:28:14.0983115Z                          }
2026-01-11T19:28:14.0983698Z                      }
2026-01-11T19:28:14.0984274Z                      
2026-01-11T19:28:14.0984824Z                      
2026-01-11T19:28:14.0985728Z                      Export-ModuleMember -Function @(
2026-01-11T19:28:14.0986430Z                          'Disable-MouseAcceleration',
2026-01-11T19:28:14.0987651Z                          'Enable-MouseAcceleration',
2026-01-11T19:28:14.0988134Z                          'Test-MouseAcceleration',
2026-01-11T19:28:14.0989050Z                          'Invoke-PeripheralOptimizations',
2026-01-11T19:28:14.0989600Z                          'Undo-PeripheralOptimizations'
2026-01-11T19:28:14.0990026Z                      )
2026-01-11T19:28:14.0990693Z [32;1mCleanBlock         : [0m
2026-01-11T19:28:14.0991340Z [32;1mDynamicParamBlock  : [0m
2026-01-11T19:28:14.0992195Z [32;1mScriptRequirements : [0mSystem.Management.Automation.Language.ScriptRequirements
2026-01-11T19:28:14.0993235Z [32;1mExtent             : [0m<#
2026-01-11T19:28:14.0993790Z                      .SYNOPSIS
2026-01-11T19:28:14.0994529Z                          Peripheral device optimizations (mouse, keyboard).
2026-01-11T19:28:14.0995580Z                      .DESCRIPTION
2026-01-11T19:28:14.0996429Z                          Configures mouse acceleration, keyboard settings, and other peripheral
2026-01-11T19:28:14.0997533Z                          optimizations for gaming.
2026-01-11T19:28:14.0998386Z                      .NOTES
2026-01-11T19:28:14.0999009Z                          Requires Administrator for some operations.
2026-01-11T19:28:14.0999690Z                      #>
2026-01-11T19:28:14.1000312Z                      #Requires -RunAsAdministrator
2026-01-11T19:28:14.1001142Z                      
2026-01-11T19:28:14.1001427Z                      
2026-01-11T19:28:14.1001895Z                      
2026-01-11T19:28:14.1002857Z                      Import-Module (Join-Path $PSScriptRoot "..\core\logger.psm1") -Force -Global
2026-01-11T19:28:14.1004426Z                      Import-Module (Join-Path $PSScriptRoot "..\core\registry.psm1") -Force -Global
2026-01-11T19:28:14.1006433Z                      
2026-01-11T19:28:14.1006943Z                      
2026-01-11T19:28:14.1007642Z                      
2026-01-11T19:28:14.1008234Z                      function Disable-MouseAcceleration {
2026-01-11T19:28:14.1008867Z                          <#
2026-01-11T19:28:14.1009389Z                          .SYNOPSIS
2026-01-11T19:28:14.1010345Z                              Disables Windows mouse acceleration (Enhance pointer precision).
2026-01-11T19:28:14.1011365Z                          .DESCRIPTION
2026-01-11T19:28:14.1012387Z                              Sets registry values to disable mouse acceleration and apply 1:1 linear
2026-01-11T19:28:14.1014026Z                              mouse movement. This is the "Enhance pointer precision" setting in
2026-01-11T19:28:14.1014756Z                              Mouse Properties > Pointer Options.
2026-01-11T19:28:14.1015225Z                          .PARAMETER Enable
2026-01-11T19:28:14.1015711Z                              When true, applies mouse acceleration settings.
2026-01-11T19:28:14.1016211Z                          .OUTPUTS
2026-01-11T19:28:14.1016547Z                              None.
2026-01-11T19:28:14.1016870Z                          .NOTES
2026-01-11T19:28:14.1017461Z                              Mouse acceleration makes cursor speed inconsistent, breaking muscle memory.
2026-01-11T19:28:14.1018434Z                              Pro gamers always disable this.
2026-01-11T19:28:14.1018858Z                          #>
2026-01-11T19:28:14.1019157Z                          param(
2026-01-11T19:28:14.1019493Z                              [bool]$Enable = $true
2026-01-11T19:28:14.1019880Z                          )
2026-01-11T19:28:14.1020186Z                      
2026-01-11T19:28:14.1020493Z                          if (-not $Enable) {
2026-01-11T19:28:14.1021215Z                              Write-Log "Mouse acceleration disable: skipped" "INFO"
2026-01-11T19:28:14.1021749Z                              return
2026-01-11T19:28:14.1022085Z                          }
2026-01-11T19:28:14.1022377Z                      
2026-01-11T19:28:14.1022645Z                          try {
2026-01-11T19:28:14.1023075Z                              Write-Log "Disabling mouse acceleration..." "INFO"
2026-01-11T19:28:14.1023578Z                      
2026-01-11T19:28:14.1023918Z                              $mousePath = "HKCU:\Control Panel\Mouse"
2026-01-11T19:28:14.1024471Z                              Backup-RegistryKey -Path $mousePath
2026-01-11T19:28:14.1024935Z                      
2026-01-11T19:28:14.1025553Z                              # MouseSpeed = 0: Disable acceleration
2026-01-11T19:28:14.1026189Z                              # MouseThreshold1/2 = 0: Disable threshold-based acceleration
2026-01-11T19:28:14.1027279Z                              Set-RegistryValue -Path $mousePath -Name "MouseSpeed" -Value "0" -Type "String"
2026-01-11T19:28:14.1028350Z                              Set-RegistryValue -Path $mousePath -Name "MouseThreshold1" -Value "0" -Type "String"
2026-01-11T19:28:14.1029446Z                              Set-RegistryValue -Path $mousePath -Name "MouseThreshold2" -Value "0" -Type "String"
2026-01-11T19:28:14.1030184Z                      
2026-01-11T19:28:14.1040561Z                              Write-Log "Mouse acceleration disabled (1:1 linear movement)" "SUCCESS"
2026-01-11T19:28:14.1041564Z                              Write-Log "This is the 'Enhance pointer precision' setting in Mouse Properties" "INFO"
2026-01-11T19:28:14.1042568Z                              Write-Log "Note: May require logout/login to take full effect" "INFO"
2026-01-11T19:28:14.1043185Z                      
2026-01-11T19:28:14.1043703Z                              # Also set SmoothMouseXCurve and SmoothMouseYCurve for true 1:1
2026-01-11T19:28:14.1044316Z                              try {
2026-01-11T19:28:14.1044909Z                                  # Linear curve: 00 00 00 00 00 00 00 00 | C0 CC 0C 00 00 00 00 00 | 80 99 19 00 00 00 
2026-01-11T19:28:14.1046002Z                      00 00 | 40 66 26 00 00 00 00 00 | 00 33 33 00 00 00 00 00
2026-01-11T19:28:14.1047032Z                                  $linearCurve = [byte[]](0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
2026-01-11T19:28:14.1047811Z                                                          0xC0, 0xCC, 0x0C, 0x00, 0x00, 0x00, 0x00, 0x00,
2026-01-11T19:28:14.1048474Z                                                          0x80, 0x99, 0x19, 0x00, 0x00, 0x00, 0x00, 0x00,
2026-01-11T19:28:14.1049124Z                                                          0x40, 0x66, 0x26, 0x00, 0x00, 0x00, 0x00, 0x00,
2026-01-11T19:28:14.1049777Z                                                          0x00, 0x33, 0x33, 0x00, 0x00, 0x00, 0x00, 0x00)
2026-01-11T19:28:14.1050306Z                      
2026-01-11T19:28:14.1050937Z                                  Set-RegistryValue -Path $mousePath -Name "SmoothMouseXCurve" -Value $linearCurve 
2026-01-11T19:28:14.1051682Z                      -Type "Binary"
2026-01-11T19:28:14.1052450Z                                  Set-RegistryValue -Path $mousePath -Name "SmoothMouseYCurve" -Value $linearCurve 
2026-01-11T19:28:14.1053216Z                      -Type "Binary"
2026-01-11T19:28:14.1053818Z                      
2026-01-11T19:28:14.1054228Z                                  Write-Log "Applied 1:1 linear mouse curve" "SUCCESS"
2026-01-11T19:28:14.1054761Z                              } catch {
2026-01-11T19:28:14.1055392Z                                  Write-Log "Could not set linear mouse curve (optional, not critical)" "INFO"
2026-01-11T19:28:14.1056054Z                              }
2026-01-11T19:28:14.1056368Z                      
2026-01-11T19:28:14.1056629Z                          } catch {
2026-01-11T19:28:14.1057125Z                              Write-Log "Error disabling mouse acceleration: $_" "ERROR"
2026-01-11T19:28:14.1057694Z                              throw
2026-01-11T19:28:14.1058016Z                          }
2026-01-11T19:28:14.1058305Z                      }
2026-01-11T19:28:14.1058589Z                      
2026-01-11T19:28:14.1058864Z                      
2026-01-11T19:28:14.1059213Z                      function Enable-MouseAcceleration {
2026-01-11T19:28:14.1059668Z                          <#
2026-01-11T19:28:14.1059977Z                          .SYNOPSIS
2026-01-11T19:28:14.1060409Z                              Re-enables Windows mouse acceleration.
2026-01-11T19:28:14.1060881Z                          .DESCRIPTION
2026-01-11T19:28:14.1061401Z                              Restores default Windows mouse acceleration settings.
2026-01-11T19:28:14.1061970Z                          .OUTPUTS
2026-01-11T19:28:14.1062326Z                              None.
2026-01-11T19:28:14.1062696Z                          #>
2026-01-11T19:28:14.1062997Z                          try {
2026-01-11T19:28:14.1063484Z                              Write-Log "Re-enabling mouse acceleration..." "INFO"
2026-01-11T19:28:14.1064021Z                      
2026-01-11T19:28:14.1064417Z                              $mousePath = "HKCU:\Control Panel\Mouse"
2026-01-11T19:28:14.1065002Z                              Backup-RegistryKey -Path $mousePath
2026-01-11T19:28:14.1065474Z                      
2026-01-11T19:28:14.1065775Z                              # Windows defaults
2026-01-11T19:28:14.1066532Z                              Set-RegistryValue -Path $mousePath -Name "MouseSpeed" -Value "1" -Type "String"
2026-01-11T19:28:14.1068064Z                              Set-RegistryValue -Path $mousePath -Name "MouseThreshold1" -Value "6" -Type "String"
2026-01-11T19:28:14.1069268Z                              Set-RegistryValue -Path $mousePath -Name "MouseThreshold2" -Value "10" -Type "String"
2026-01-11T19:28:14.1070095Z                      
2026-01-11T19:28:14.1070658Z                              Write-Log "Mouse acceleration re-enabled (Windows defaults)" "SUCCESS"
2026-01-11T19:28:14.1071846Z                              Write-Log "Note: May require logout/login to take full effect" "INFO"
2026-01-11T19:28:14.1072510Z                      
2026-01-11T19:28:14.1072804Z                          } catch {
2026-01-11T19:28:14.1073343Z                              Write-Log "Error enabling mouse acceleration: $_" "ERROR"
2026-01-11T19:28:14.1073926Z                              throw
2026-01-11T19:28:14.1074273Z                          }
2026-01-11T19:28:14.1074570Z                      }
2026-01-11T19:28:14.1074856Z                      
2026-01-11T19:28:14.1075134Z                      
2026-01-11T19:28:14.1075478Z                      function Test-MouseAcceleration {
2026-01-11T19:28:14.1075929Z                          <#
2026-01-11T19:28:14.1076238Z                          .SYNOPSIS
2026-01-11T19:28:14.1076701Z                              Verifies that mouse acceleration is disabled.
2026-01-11T19:28:14.1077227Z                          .DESCRIPTION
2026-01-11T19:28:14.1077929Z                              Checks registry values for MouseSpeed, MouseThreshold1, and MouseThreshold2.
2026-01-11T19:28:14.1078622Z                          .OUTPUTS
2026-01-11T19:28:14.1079107Z                              [bool] True when acceleration is disabled, else false.
2026-01-11T19:28:14.1079915Z                          #>
2026-01-11T19:28:14.1080269Z                          $allPassed = $true
2026-01-11T19:28:14.1080648Z                      
2026-01-11T19:28:14.1081118Z                          Write-Log "Verifying mouse acceleration settings..." "INFO"
2026-01-11T19:28:14.1081697Z                      
2026-01-11T19:28:14.1082003Z                          try {
2026-01-11T19:28:14.1082425Z                              $mousePath = "HKCU:\Control Panel\Mouse"
2026-01-11T19:28:14.1082896Z                      
2026-01-11T19:28:14.1083437Z                              $mouseSpeed = Get-RegistryValue -Path $mousePath -Name "MouseSpeed"
2026-01-11T19:28:14.1084384Z                              $threshold1 = Get-RegistryValue -Path $mousePath -Name "MouseThreshold1"
2026-01-11T19:28:14.1085389Z                              $threshold2 = Get-RegistryValue -Path $mousePath -Name "MouseThreshold2"
2026-01-11T19:28:14.1086092Z                      
2026-01-11T19:28:14.1086443Z                              if ($mouseSpeed -eq "0") {
2026-01-11T19:28:14.1087936Z                                  Write-Log "‚úì Mouse acceleration disabled (MouseSpeed = 0)" "SUCCESS"
2026-01-11T19:28:14.1088644Z                              } else {
2026-01-11T19:28:14.1089515Z                                  Write-Log "‚úó Mouse acceleration enabled (MouseSpeed = $mouseSpeed)" "ERROR"
2026-01-11T19:28:14.1090297Z                                  $allPassed = $false
2026-01-11T19:28:14.1090719Z                              }
2026-01-11T19:28:14.1091048Z                      
2026-01-11T19:28:14.1091460Z                              if ($threshold1 -eq "0" -and $threshold2 -eq "0") {
2026-01-11T19:28:14.1092330Z                                  Write-Log "‚úì Mouse thresholds disabled" "SUCCESS"
2026-01-11T19:28:14.1092891Z                              } else {
2026-01-11T19:28:14.1093828Z                                  Write-Log "‚úó Mouse thresholds not disabled (T1=$threshold1, T2=$threshold2)" "ERROR"
2026-01-11T19:28:14.1094663Z                                  $allPassed = $false
2026-01-11T19:28:14.1095097Z                              }
2026-01-11T19:28:14.1095420Z                      
2026-01-11T19:28:14.1095698Z                          } catch {
2026-01-11T19:28:14.1096211Z                              Write-Log "Error verifying mouse settings: $_" "ERROR"
2026-01-11T19:28:14.1096789Z                              return $false
2026-01-11T19:28:14.1097197Z                          }
2026-01-11T19:28:14.1097499Z                      
2026-01-11T19:28:14.1097813Z                          return $allPassed
2026-01-11T19:28:14.1098187Z                      }
2026-01-11T19:28:14.1098459Z                      
2026-01-11T19:28:14.1098719Z                      
2026-01-11T19:28:14.1099353Z                      function Invoke-PeripheralOptimizations {
2026-01-11T19:28:14.1099862Z                          <#
2026-01-11T19:28:14.1100181Z                          .SYNOPSIS
2026-01-11T19:28:14.1100623Z                              Applies all peripheral optimizations.
2026-01-11T19:28:14.1101102Z                          .DESCRIPTION
2026-01-11T19:28:14.1101716Z                              Disables mouse acceleration and applies other peripheral tweaks.
2026-01-11T19:28:14.1102483Z                          .PARAMETER DisableMouseAcceleration
2026-01-11T19:28:14.1103026Z                              When true, disables mouse acceleration.
2026-01-11T19:28:14.1103503Z                          .OUTPUTS
2026-01-11T19:28:14.1103835Z                              None.
2026-01-11T19:28:14.1104168Z                          #>
2026-01-11T19:28:14.1104469Z                          param(
2026-01-11T19:28:14.1104894Z                              [bool]$DisableMouseAcceleration = $true
2026-01-11T19:28:14.1105356Z                          )
2026-01-11T19:28:14.1105643Z                      
2026-01-11T19:28:14.1106081Z                          Write-Log "Applying peripheral optimizations..." "INFO"
2026-01-11T19:28:14.1106851Z                      
2026-01-11T19:28:14.1107130Z                          try {
2026-01-11T19:28:14.1107908Z                              if ($DisableMouseAcceleration) {
2026-01-11T19:28:14.1108483Z                                  Disable-MouseAcceleration -Enable $true
2026-01-11T19:28:14.1108954Z                              }
2026-01-11T19:28:14.1109267Z                      
2026-01-11T19:28:14.1109699Z                              Write-Log "Peripheral optimizations complete" "SUCCESS"
2026-01-11T19:28:14.1110256Z                      
2026-01-11T19:28:14.1110532Z                          } catch {
2026-01-11T19:28:14.1111084Z                              Write-Log "Error applying peripheral optimizations: $_" "ERROR"
2026-01-11T19:28:14.1111710Z                              throw
2026-01-11T19:28:14.1112030Z                          }
2026-01-11T19:28:14.1112326Z                      }
2026-01-11T19:28:14.1112586Z                      
2026-01-11T19:28:14.1112856Z                      
2026-01-11T19:28:14.1113223Z                      function Undo-PeripheralOptimizations {
2026-01-11T19:28:14.1113685Z                          <#
2026-01-11T19:28:14.1113988Z                          .SYNOPSIS
2026-01-11T19:28:14.1114425Z                              Reverts peripheral-related changes.
2026-01-11T19:28:14.1114896Z                          .DESCRIPTION
2026-01-11T19:28:14.1115401Z                              Restores Windows default mouse acceleration settings.
2026-01-11T19:28:14.1115946Z                          .OUTPUTS
2026-01-11T19:28:14.1116283Z                              None.
2026-01-11T19:28:14.1116616Z                          #>
2026-01-11T19:28:14.1117117Z                          Write-Log "Rolling back peripheral optimizations..." "INFO"
2026-01-11T19:28:14.1117687Z                      
2026-01-11T19:28:14.1117948Z                          try {
2026-01-11T19:28:14.1118313Z                              Enable-MouseAcceleration
2026-01-11T19:28:14.1118741Z                      
2026-01-11T19:28:14.1119112Z                              $mousePath = "HKCU:\Control Panel\Mouse"
2026-01-11T19:28:14.1119687Z                              if (Restore-RegistryKey -Path $mousePath) {
2026-01-11T19:28:14.1120371Z                                  Write-Log "Restored mouse registry settings" "SUCCESS"
2026-01-11T19:28:14.1120929Z                              }
2026-01-11T19:28:14.1121259Z                      
2026-01-11T19:28:14.1121775Z                              Write-Log "Peripheral optimization rollback complete" "SUCCESS"
2026-01-11T19:28:14.1122392Z                      
2026-01-11T19:28:14.1122672Z                          } catch {
2026-01-11T19:28:14.1123353Z                              Write-Log "Error during rollback: $_" "ERROR"
2026-01-11T19:28:14.1123873Z                              throw
2026-01-11T19:28:14.1124198Z                          }
2026-01-11T19:28:14.1124483Z                      }
2026-01-11T19:28:14.1124737Z                      
2026-01-11T19:28:14.1125010Z                      
2026-01-11T19:28:14.1125329Z                      Export-ModuleMember -Function @(
2026-01-11T19:28:14.1125815Z                          'Disable-MouseAcceleration',
2026-01-11T19:28:14.1126308Z                          'Enable-MouseAcceleration',
2026-01-11T19:28:14.1126783Z                          'Test-MouseAcceleration',
2026-01-11T19:28:14.1127291Z                          'Invoke-PeripheralOptimizations',
2026-01-11T19:28:14.1128189Z                          'Undo-PeripheralOptimizations'
2026-01-11T19:28:14.1128625Z                      )
2026-01-11T19:28:14.1128887Z                      
2026-01-11T19:28:14.1129304Z [32;1mParent             : [0m
2026-01-11T19:28:14.1129547Z 
2026-01-11T19:28:14.1158150Z [32;1mAttributes         : [0m{}
2026-01-11T19:28:14.1158919Z [32;1mUsingStatements    : [0m{}
2026-01-11T19:28:14.1159772Z [32;1mParamBlock         : [0m
2026-01-11T19:28:14.1160716Z [32;1mBeginBlock         : [0m
2026-01-11T19:28:14.1161029Z [32;1mProcessBlock       : [0m
2026-01-11T19:28:14.1163944Z [32;1mEndBlock           : [0mImport-Module (Join-Path $PSScriptRoot "..\core\logger.psm1") -Force -Global
2026-01-11T19:28:14.1165094Z                      Import-Module (Join-Path $PSScriptRoot "..\core\registry.psm1") -Force -Global
2026-01-11T19:28:14.1166200Z                      
2026-01-11T19:28:14.1166477Z                      
2026-01-11T19:28:14.1166747Z                      
2026-01-11T19:28:14.1167087Z                      function Test-PowerOptimizations {
2026-01-11T19:28:14.1167514Z                          <#
2026-01-11T19:28:14.1167823Z                          .SYNOPSIS
2026-01-11T19:28:14.1168268Z                              Verifies power-related optimizations.
2026-01-11T19:28:14.1168755Z                          .DESCRIPTION
2026-01-11T19:28:14.1169404Z                              Checks for a high-performance power plan and confirms hibernation state.
2026-01-11T19:28:14.1170116Z                          .OUTPUTS
2026-01-11T19:28:14.1170552Z                              [bool] True when checks pass, else false.
2026-01-11T19:28:14.1171025Z                          #>
2026-01-11T19:28:14.1171359Z                          $allPassed = $true
2026-01-11T19:28:14.1171749Z                      
2026-01-11T19:28:14.1172169Z                          Write-Log "Verifying power optimizations..." "INFO"
2026-01-11T19:28:14.1172678Z                      
2026-01-11T19:28:14.1173036Z                          $activePlan = powercfg /getactivescheme
2026-01-11T19:28:14.1173864Z                          if ($activePlan -like "*High performance*" -or $activePlan -like "*Ultimate Performance*") {
2026-01-11T19:28:14.1175008Z                              Write-Log "‚úì High Performance power plan active" "SUCCESS"
2026-01-11T19:28:14.1175603Z                          } else {
2026-01-11T19:28:14.1176224Z                              Write-Log "‚úó High Performance power plan not active" "ERROR"
2026-01-11T19:28:14.1176837Z                              $allPassed = $false
2026-01-11T19:28:14.1177212Z                          }
2026-01-11T19:28:14.1177491Z                      
2026-01-11T19:28:14.1177848Z                          $hiberFile = Test-Path "C:\hiberfil.sys"
2026-01-11T19:28:14.1178358Z                          if (-not $hiberFile) {
2026-01-11T19:28:14.1178994Z                              Write-Log "‚úì Hibernation disabled" "SUCCESS"
2026-01-11T19:28:14.1179481Z                          } else {
2026-01-11T19:28:14.1180044Z                              Write-Log "Hibernation file still exists (may be enabled)" "INFO"
2026-01-11T19:28:14.1180648Z                          }
2026-01-11T19:28:14.1181009Z                      
2026-01-11T19:28:14.1181684Z                          return $allPassed
2026-01-11T19:28:14.1182075Z                      }
2026-01-11T19:28:14.1182330Z                      
2026-01-11T19:28:14.1182583Z                      
2026-01-11T19:28:14.1182851Z                      
2026-01-11T19:28:14.1183098Z                      
2026-01-11T19:28:14.1183448Z                      function Set-UltimatePerformancePlan {
2026-01-11T19:28:14.1183897Z                          <#
2026-01-11T19:28:14.1184193Z                          .SYNOPSIS
2026-01-11T19:28:14.1184693Z                              Creates or activates the Ultimate Performance power plan.
2026-01-11T19:28:14.1185266Z                          .DESCRIPTION
2026-01-11T19:28:14.1186221Z                              Duplicates the Ultimate Performance scheme if needed, activates it,
2026-01-11T19:28:14.1186987Z                              and falls back to High Performance when unavailable.
2026-01-11T19:28:14.1187529Z                          .OUTPUTS
2026-01-11T19:28:14.1187853Z                              None.
2026-01-11T19:28:14.1188173Z                          #>
2026-01-11T19:28:14.1188455Z                          try {
2026-01-11T19:28:14.1189157Z                              Write-Log "Adding Ultimate Performance power plan..." "INFO"
2026-01-11T19:28:14.1189722Z                      
2026-01-11T19:28:14.1190143Z                              $ultPerfGuid = "e9a42b02-d5df-448d-aa00-03f14749eb61"
2026-01-11T19:28:14.1190677Z                      
2026-01-11T19:28:14.1191092Z                              $result = powercfg /duplicatescheme $ultPerfGuid 2>&1
2026-01-11T19:28:14.1191684Z                              if ($LASTEXITCODE -eq 0) {
2026-01-11T19:28:14.1192341Z                                  $newGuid = $result -replace '.*GUID:\s*', '' -replace '\s*\(.*', ''
2026-01-11T19:28:14.1192985Z                                  if ($newGuid) {
2026-01-11T19:28:14.1193530Z                                      powercfg /setactive $newGuid.Trim() 2>&1 | Out-Null
2026-01-11T19:28:14.1194344Z                                      Write-Log "Ultimate Performance plan created and activated" "SUCCESS"
2026-01-11T19:28:14.1195293Z                                      Write-Log "Warning: High idle power/thermals - avoid on laptops" "INFO"
2026-01-11T19:28:14.1195964Z                                      return
2026-01-11T19:28:14.1196321Z                                  }
2026-01-11T19:28:14.1196641Z                              }
2026-01-11T19:28:14.1196932Z                      
2026-01-11T19:28:14.1197540Z                              $existingUlt = powercfg /list | Select-String "Ultimate Performance" | ForEach-Object { 
2026-01-11T19:28:14.1198286Z                      ($_ -split '\s+')[3] }
2026-01-11T19:28:14.1198676Z                              if ($existingUlt) {
2026-01-11T19:28:14.1199156Z                                  powercfg /setactive $existingUlt 2>&1 | Out-Null
2026-01-11T19:28:14.1199908Z                                  Write-Log "Activated existing Ultimate Performance plan" "SUCCESS"
2026-01-11T19:28:14.1200548Z                                  return
2026-01-11T19:28:14.1200892Z                              }
2026-01-11T19:28:14.1201211Z                      
2026-01-11T19:28:14.1201798Z                              Write-Log "Ultimate Performance not available, using High Performance" "INFO"
2026-01-11T19:28:14.1202532Z                              Set-PowerPlan
2026-01-11T19:28:14.1202890Z                      
2026-01-11T19:28:14.1203158Z                          } catch {
2026-01-11T19:28:14.1203653Z                              Write-Log "Error setting Ultimate Performance: $_" "ERROR"
2026-01-11T19:28:14.1204223Z                              throw
2026-01-11T19:28:14.1204545Z                          }
2026-01-11T19:28:14.1204840Z                      }
2026-01-11T19:28:14.1205107Z                      
2026-01-11T19:28:14.1205355Z                      
2026-01-11T19:28:14.1205911Z                      function Set-PowerPlan {
2026-01-11T19:28:14.1206672Z                          <#
2026-01-11T19:28:14.1206980Z                          .SYNOPSIS
2026-01-11T19:28:14.1207405Z                              Activates the High Performance power plan.
2026-01-11T19:28:14.1207889Z                          .DESCRIPTION
2026-01-11T19:28:14.1208514Z                              Finds and activates High Performance; if missing, attempts to create it.
2026-01-11T19:28:14.1209175Z                          .OUTPUTS
2026-01-11T19:28:14.1209507Z                              None.
2026-01-11T19:28:14.1209829Z                          #>
2026-01-11T19:28:14.1210124Z                          try {
2026-01-11T19:28:14.1210538Z                              Write-Log "Configuring power plan..." "INFO"
2026-01-11T19:28:14.1211008Z                      
2026-01-11T19:28:14.1211670Z                              $highPerfPlan = powercfg /list | Select-String "High performance" | ForEach-Object { ($_ 
2026-01-11T19:28:14.1212474Z                      -split '\s+')[3] }
2026-01-11T19:28:14.1212828Z                      
2026-01-11T19:28:14.1213132Z                              if ($highPerfPlan) {
2026-01-11T19:28:14.1213819Z                                  powercfg /setactive $highPerfPlan
2026-01-11T19:28:14.1214525Z                                  Write-Log "Set power plan to High Performance: $highPerfPlan" "SUCCESS"
2026-01-11T19:28:14.1215193Z                              } else {
2026-01-11T19:28:14.1215858Z                                  $guid = powercfg /duplicatescheme 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c 2>&1
2026-01-11T19:28:14.1216642Z                                  if ($LASTEXITCODE -eq 0 -and $guid) {
2026-01-11T19:28:14.1217324Z                                      $guid = ($guid -split '\s+')[-1]
2026-01-11T19:28:14.1217861Z                                      powercfg /setactive $guid 2>&1 | Out-Null
2026-01-11T19:28:14.1218661Z                                      Write-Log "Created and activated Ultimate Performance plan: $guid" "SUCCESS"
2026-01-11T19:28:14.1219373Z                                  } else {
2026-01-11T19:28:14.1220085Z                                      Write-Log "Could not create Ultimate Performance plan, using current plan" "ERROR"
2026-01-11T19:28:14.1220833Z                                  }
2026-01-11T19:28:14.1221154Z                              }
2026-01-11T19:28:14.1221457Z                      
2026-01-11T19:28:14.1221841Z                              powercfg /setactive SCHEME_CURRENT 2>&1 | Out-Null
2026-01-11T19:28:14.1222361Z                      
2026-01-11T19:28:14.1222628Z                          } catch {
2026-01-11T19:28:14.1223085Z                              Write-Log "Error setting power plan: $_" "ERROR"
2026-01-11T19:28:14.1223597Z                              throw
2026-01-11T19:28:14.1223924Z                          }
2026-01-11T19:28:14.1224212Z                      }
2026-01-11T19:28:14.1224473Z                      
2026-01-11T19:28:14.1224731Z                      
2026-01-11T19:28:14.1225048Z                      function Disable-PCIeLinkState {
2026-01-11T19:28:14.1225491Z                          <#
2026-01-11T19:28:14.1225794Z                          .SYNOPSIS
2026-01-11T19:28:14.1226220Z                              Disables PCIe link state power management.
2026-01-11T19:28:14.1227056Z                          .DESCRIPTION
2026-01-11T19:28:14.1227561Z                              Sets PCIe link state power settings to Off for AC and DC.
2026-01-11T19:28:14.1228108Z                          .OUTPUTS
2026-01-11T19:28:14.1228433Z                              None.
2026-01-11T19:28:14.1228767Z                          #>
2026-01-11T19:28:14.1229073Z                          try {
2026-01-11T19:28:14.1229734Z                              powercfg /setacvalueindex SCHEME_CURRENT 501a4d13-42af-4429-9fd1-a8218c268e20 
2026-01-11T19:28:14.1230845Z                      ee12f906-d277-404b-b6da-e5fa1a576df5 0 2>&1 | Out-Null
2026-01-11T19:28:14.1231397Z                      
2026-01-11T19:28:14.1232023Z                              powercfg /setdcvalueindex SCHEME_CURRENT 501a4d13-42af-4429-9fd1-a8218c268e20 
2026-01-11T19:28:14.1232905Z                      ee12f906-d277-404b-b6da-e5fa1a576df5 0 2>&1 | Out-Null
2026-01-11T19:28:14.1233436Z                      
2026-01-11T19:28:14.1233835Z                              powercfg /setactive SCHEME_CURRENT 2>&1 | Out-Null
2026-01-11T19:28:14.1234346Z                      
2026-01-11T19:28:14.1234833Z                              Write-Log "Disabled PCIe Link State Power Management" "SUCCESS"
2026-01-11T19:28:14.1235420Z                      
2026-01-11T19:28:14.1235698Z                          } catch {
2026-01-11T19:28:14.1236187Z                              Write-Log "Error disabling PCIe Link State: $_" "ERROR"
2026-01-11T19:28:14.1236735Z                              throw
2026-01-11T19:28:14.1237077Z                          }
2026-01-11T19:28:14.1237366Z                      }
2026-01-11T19:28:14.1237621Z                      
2026-01-11T19:28:14.1237863Z                      
2026-01-11T19:28:14.1238218Z                      function Disable-USBSelectiveSuspend {
2026-01-11T19:28:14.1238899Z                          <#
2026-01-11T19:28:14.1239202Z                          .SYNOPSIS
2026-01-11T19:28:14.1239593Z                              Disables USB selective suspend.
2026-01-11T19:28:14.1240043Z                          .DESCRIPTION
2026-01-11T19:28:14.1240584Z                              Prevents USB devices from entering low-power sleep states.
2026-01-11T19:28:14.1241188Z                          .OUTPUTS
2026-01-11T19:28:14.1241511Z                              None.
2026-01-11T19:28:14.1241838Z                          #>
2026-01-11T19:28:14.1242137Z                          try {
2026-01-11T19:28:14.1242768Z                              powercfg /setacvalueindex SCHEME_CURRENT 2a737441-1930-4402-8d77-b2bebba308a3 
2026-01-11T19:28:14.1243669Z                      48e6b7a6-50f5-4782-a5d4-53bb8f07e226 0 2>&1 | Out-Null
2026-01-11T19:28:14.1244191Z                      
2026-01-11T19:28:14.1244624Z                              powercfg /setdcvalueindex SCHEME_CURRENT 2a737441-1930-4402-8d77-b2bebba308a3 
2026-01-11T19:28:14.1244863Z                      48e6b7a6-50f5-4782-a5d4-53bb8f07e226 0 2>&1 | Out-Null
2026-01-11T19:28:14.1244953Z                      
2026-01-11T19:28:14.1245188Z                              powercfg /setactive SCHEME_CURRENT 2>&1 | Out-Null
2026-01-11T19:28:14.1245276Z                      
2026-01-11T19:28:14.1245519Z                              Write-Log "Disabled USB Selective Suspend" "SUCCESS"
2026-01-11T19:28:14.1245613Z                      
2026-01-11T19:28:14.1245714Z                          } catch {
2026-01-11T19:28:14.1246013Z                              Write-Log "Error disabling USB Selective Suspend: $_" "ERROR"
2026-01-11T19:28:14.1246119Z                              throw
2026-01-11T19:28:14.1246228Z                          }
2026-01-11T19:28:14.1246338Z                      }
2026-01-11T19:28:14.1246433Z                      
2026-01-11T19:28:14.1246971Z                      
2026-01-11T19:28:14.1247174Z                      function Set-ProcessorIdlePolicy {
2026-01-11T19:28:14.1247270Z                          <#
2026-01-11T19:28:14.1247378Z                          .SYNOPSIS
2026-01-11T19:28:14.1247650Z                              Configures minimum processor state for the active plan.
2026-01-11T19:28:14.1247761Z                          .DESCRIPTION
2026-01-11T19:28:14.1248094Z                              Sets the minimum processor state to a bounded percentage (5-100).
2026-01-11T19:28:14.1248284Z                          .PARAMETER MinProcessorStatePercent
2026-01-11T19:28:14.1248570Z                              Minimum CPU state percentage; values are clamped to 5..100.
2026-01-11T19:28:14.1248669Z                          .OUTPUTS
2026-01-11T19:28:14.1249020Z                              None.
2026-01-11T19:28:14.1249125Z                          #>
2026-01-11T19:28:14.1249229Z                          param(
2026-01-11T19:28:14.1249430Z                              [int]$MinProcessorStatePercent = 5
2026-01-11T19:28:14.1249530Z                          )
2026-01-11T19:28:14.1249620Z                      
2026-01-11T19:28:14.1249723Z                          try {
2026-01-11T19:28:14.1250145Z                              if ($MinProcessorStatePercent -lt 5) { $MinProcessorStatePercent = 5 }
2026-01-11T19:28:14.1250581Z                              if ($MinProcessorStatePercent -gt 100) { $MinProcessorStatePercent = 100 }
2026-01-11T19:28:14.1251125Z                      
2026-01-11T19:28:14.1253355Z                              powercfg /setacvalueindex SCHEME_CURRENT 54533251-82be-4824-96c1-47b60b740d00 
2026-01-11T19:28:14.1253851Z                      bc5038f7-23e0-4960-96da-33abaf5935ed $MinProcessorStatePercent 2>&1 | Out-Null
2026-01-11T19:28:14.1254316Z                              powercfg /setdcvalueindex SCHEME_CURRENT 54533251-82be-4824-96c1-47b60b740d00 
2026-01-11T19:28:14.1254752Z                      bc5038f7-23e0-4960-96da-33abaf5935ed $MinProcessorStatePercent 2>&1 | Out-Null
2026-01-11T19:28:14.1255110Z                      
2026-01-11T19:28:14.1255280Z                      
2026-01-11T19:28:14.1256101Z                              powercfg /setactive SCHEME_CURRENT 2>&1 | Out-Null
2026-01-11T19:28:14.1256425Z                      
2026-01-11T19:28:14.1258320Z                              Write-Log "Set minimum processor state to ${MinProcessorStatePercent}% (C-states enabled 
2026-01-11T19:28:14.1258524Z                      for thermal headroom)" "SUCCESS"
2026-01-11T19:28:14.1258634Z                      
2026-01-11T19:28:14.1259063Z                          } catch {
2026-01-11T19:28:14.1259735Z                              Write-Log "Error setting processor idle policy: $_" "ERROR"
2026-01-11T19:28:14.1259949Z                              throw
2026-01-11T19:28:14.1260911Z                          }
2026-01-11T19:28:14.1261078Z                      }
2026-01-11T19:28:14.1261173Z                      
2026-01-11T19:28:14.1262028Z                      
2026-01-11T19:28:14.1262324Z                      function Disable-Hibernation {
2026-01-11T19:28:14.1263275Z                          <#
2026-01-11T19:28:14.1264038Z                          .SYNOPSIS
2026-01-11T19:28:14.1264472Z                              Disables Windows hibernation.
2026-01-11T19:28:14.1265541Z                          .DESCRIPTION
2026-01-11T19:28:14.1265965Z                              Removes hiberfil.sys and reduces disk usage. Also disables Fast Startup
2026-01-11T19:28:14.1266170Z                              if it depends on hibernation.
2026-01-11T19:28:14.1266686Z                          .OUTPUTS
2026-01-11T19:28:14.1267717Z                              None.
2026-01-11T19:28:14.1268000Z                          #>
2026-01-11T19:28:14.1268953Z                          try {
2026-01-11T19:28:14.1269159Z                              powercfg /hibernate off 2>&1 | Out-Null
2026-01-11T19:28:14.1269702Z                              Write-Log "Disabled hibernation (saves disk space)" "SUCCESS"
2026-01-11T19:28:14.1269956Z                      
2026-01-11T19:28:14.1271400Z                          } catch {
2026-01-11T19:28:14.1271664Z                              Write-Log "Error disabling hibernation: $_" "ERROR"
2026-01-11T19:28:14.1272052Z                              throw
2026-01-11T19:28:14.1272853Z                          }
2026-01-11T19:28:14.1273644Z                      }
2026-01-11T19:28:14.1274458Z                      
2026-01-11T19:28:14.1274624Z                      
2026-01-11T19:28:14.1274724Z                      
2026-01-11T19:28:14.1275394Z                      
2026-01-11T19:28:14.1275616Z                      function Invoke-PowerOptimizations {
2026-01-11T19:28:14.1275972Z                          <#
2026-01-11T19:28:14.1276949Z                          .SYNOPSIS
2026-01-11T19:28:14.1277189Z                              Applies the full power optimization set.
2026-01-11T19:28:14.1277421Z                          .DESCRIPTION
2026-01-11T19:28:14.1278142Z                              Activates a high-performance plan, disables PCIe and USB power saving,
2026-01-11T19:28:14.1279814Z                              configures minimum processor state, and disables hibernation.
2026-01-11T19:28:14.1280052Z                          .PARAMETER MinProcessorStatePercent
2026-01-11T19:28:14.1280571Z                              Minimum processor state percentage to apply.
2026-01-11T19:28:14.1281682Z                          .OUTPUTS
2026-01-11T19:28:14.1282308Z                              None.
2026-01-11T19:28:14.1282950Z                          #>
2026-01-11T19:28:14.1283228Z                          param(
2026-01-11T19:28:14.1284205Z                              [int]$MinProcessorStatePercent = 5
2026-01-11T19:28:14.1284757Z                          )
2026-01-11T19:28:14.1285274Z                      
2026-01-11T19:28:14.1286483Z                          Write-Log "Applying power optimizations..." "INFO"
2026-01-11T19:28:14.1288489Z                      
2026-01-11T19:28:14.1288602Z                          try {
2026-01-11T19:28:14.1288729Z                              Set-PowerPlan
2026-01-11T19:28:14.1288821Z                      
2026-01-11T19:28:14.1288984Z                              Disable-PCIeLinkState
2026-01-11T19:28:14.1289081Z                      
2026-01-11T19:28:14.1289259Z                              Disable-USBSelectiveSuspend
2026-01-11T19:28:14.1289539Z                      
2026-01-11T19:28:14.1290453Z                              Set-ProcessorIdlePolicy -MinProcessorStatePercent $MinProcessorStatePercent
2026-01-11T19:28:14.1290997Z                      
2026-01-11T19:28:14.1291815Z                              Disable-Hibernation
2026-01-11T19:28:14.1291924Z                      
2026-01-11T19:28:14.1292449Z                              Write-Log "Power optimizations complete" "SUCCESS"
2026-01-11T19:28:14.1292720Z                      
2026-01-11T19:28:14.1293747Z                          } catch {
2026-01-11T19:28:14.1294653Z                              Write-Log "Error applying power optimizations: $_" "ERROR"
2026-01-11T19:28:14.1294856Z                              throw
2026-01-11T19:28:14.1295642Z                          }
2026-01-11T19:28:14.1296308Z                      }
2026-01-11T19:28:14.1296409Z                      
2026-01-11T19:28:14.1297074Z                      
2026-01-11T19:28:14.1297282Z                      function Undo-PowerOptimizations {
2026-01-11T19:28:14.1297619Z                          <#
2026-01-11T19:28:14.1298141Z                          .SYNOPSIS
2026-01-11T19:28:14.1299133Z                              Reverts power-related changes.
2026-01-11T19:28:14.1299502Z                          .DESCRIPTION
2026-01-11T19:28:14.1300766Z                              Restores the Balanced plan, re-enables hibernation, and resets default
2026-01-11T19:28:14.1300902Z                              power schemes.
2026-01-11T19:28:14.1301014Z                          .OUTPUTS
2026-01-11T19:28:14.1301159Z                              None.
2026-01-11T19:28:14.1301567Z                          #>
2026-01-11T19:28:14.1302377Z                          Write-Log "Rolling back power optimizations..." "INFO"
2026-01-11T19:28:14.1302477Z                      
2026-01-11T19:28:14.1302905Z                          try {
2026-01-11T19:28:14.1304632Z                              $balancedPlan = powercfg /list | Select-String "Balanced" | ForEach-Object { ($_ -split 
2026-01-11T19:28:14.1304762Z                      '\s+')[3] }
2026-01-11T19:28:14.1304898Z                              if ($balancedPlan) {
2026-01-11T19:28:14.1305205Z                                  powercfg /setactive $balancedPlan 2>&1 | Out-Null
2026-01-11T19:28:14.1305893Z                                  Write-Log "Restored Balanced power plan" "SUCCESS"
2026-01-11T19:28:14.1306196Z                              }
2026-01-11T19:28:14.1306631Z                      
2026-01-11T19:28:14.1308121Z                              powercfg /hibernate on 2>&1 | Out-Null
2026-01-11T19:28:14.1308346Z                              Write-Log "Re-enabled hibernation" "SUCCESS"
2026-01-11T19:28:14.1308443Z                      
2026-01-11T19:28:14.1308848Z                              powercfg /restoredefaultschemes 2>&1 | Out-Null
2026-01-11T19:28:14.1309798Z                      
2026-01-11T19:28:14.1310576Z                              Write-Log "Power optimization rollback complete" "SUCCESS"
2026-01-11T19:28:14.1311826Z                      
2026-01-11T19:28:14.1312018Z                          } catch {
2026-01-11T19:28:14.1313106Z                              Write-Log "Error during rollback: $_" "ERROR"
2026-01-11T19:28:14.1313415Z                              throw
2026-01-11T19:28:14.1314392Z                          }
2026-01-11T19:28:14.1314574Z                      }
2026-01-11T19:28:14.1314673Z                      
2026-01-11T19:28:14.1315345Z                      
2026-01-11T19:28:14.1315834Z                      Export-ModuleMember -Function @(
2026-01-11T19:28:14.1316605Z                          'Set-PowerPlan',
2026-01-11T19:28:14.1316778Z                          'Set-UltimatePerformancePlan',
2026-01-11T19:28:14.1317480Z                          'Disable-PCIeLinkState',
2026-01-11T19:28:14.1317684Z                          'Disable-USBSelectiveSuspend',
2026-01-11T19:28:14.1318695Z                          'Set-ProcessorIdlePolicy',
2026-01-11T19:28:14.1319080Z                          'Disable-Hibernation',
2026-01-11T19:28:14.1320234Z                          'Test-PowerOptimizations',
2026-01-11T19:28:14.1321345Z                          'Invoke-PowerOptimizations',
2026-01-11T19:28:14.1321496Z                          'Undo-PowerOptimizations'
2026-01-11T19:28:14.1321906Z                      )
2026-01-11T19:28:14.1323324Z [32;1mCleanBlock         : [0m
2026-01-11T19:28:14.1324756Z [32;1mDynamicParamBlock  : [0m
2026-01-11T19:28:14.1325700Z [32;1mScriptRequirements : [0mSystem.Management.Automation.Language.ScriptRequirements
2026-01-11T19:28:14.1327617Z [32;1mExtent             : [0m<#
2026-01-11T19:28:14.1328020Z                      .SYNOPSIS
2026-01-11T19:28:14.1329382Z                          Power plan and power management optimizations.
2026-01-11T19:28:14.1329513Z                      .DESCRIPTION
2026-01-11T19:28:14.1331120Z                          Activates high-performance power plans and disables select power-saving
2026-01-11T19:28:14.1331494Z                          features that can introduce latency or device sleep during gaming.
2026-01-11T19:28:14.1332541Z                      .NOTES
2026-01-11T19:28:14.1333629Z                          Requires Administrator. Many settings apply to the active power scheme.
2026-01-11T19:28:14.1333768Z                      #>
2026-01-11T19:28:14.1335069Z                      #Requires -RunAsAdministrator
2026-01-11T19:28:14.1335208Z                      
2026-01-11T19:28:14.1336189Z                      
2026-01-11T19:28:14.1336431Z                      
2026-01-11T19:28:14.1337894Z                      Import-Module (Join-Path $PSScriptRoot "..\core\logger.psm1") -Force -Global
2026-01-11T19:28:14.1338347Z                      Import-Module (Join-Path $PSScriptRoot "..\core\registry.psm1") -Force -Global
2026-01-11T19:28:14.1338478Z                      
2026-01-11T19:28:14.1339361Z                      
2026-01-11T19:28:14.1339543Z                      
2026-01-11T19:28:14.1340883Z                      function Test-PowerOptimizations {
2026-01-11T19:28:14.1341274Z                          <#
2026-01-11T19:28:14.1342296Z                          .SYNOPSIS
2026-01-11T19:28:14.1342548Z                              Verifies power-related optimizations.
2026-01-11T19:28:14.1344636Z                          .DESCRIPTION
2026-01-11T19:28:14.1344918Z                              Checks for a high-performance power plan and confirms hibernation state.
2026-01-11T19:28:14.1345085Z                          .OUTPUTS
2026-01-11T19:28:14.1345348Z                              [bool] True when checks pass, else false.
2026-01-11T19:28:14.1346094Z                          #>
2026-01-11T19:28:14.1347203Z                          $allPassed = $true
2026-01-11T19:28:14.1347323Z                      
2026-01-11T19:28:14.1348497Z                          Write-Log "Verifying power optimizations..." "INFO"
2026-01-11T19:28:14.1348605Z                      
2026-01-11T19:28:14.1349754Z                          $activePlan = powercfg /getactivescheme
2026-01-11T19:28:14.1350175Z                          if ($activePlan -like "*High performance*" -or $activePlan -like "*Ultimate Performance*") {
2026-01-11T19:28:14.1351440Z                              Write-Log "‚úì High Performance power plan active" "SUCCESS"
2026-01-11T19:28:14.1351785Z                          } else {
2026-01-11T19:28:14.1352552Z                              Write-Log "‚úó High Performance power plan not active" "ERROR"
2026-01-11T19:28:14.1352942Z                              $allPassed = $false
2026-01-11T19:28:14.1353103Z                          }
2026-01-11T19:28:14.1354003Z                      
2026-01-11T19:28:14.1354920Z                          $hiberFile = Test-Path "C:\hiberfil.sys"
2026-01-11T19:28:14.1355099Z                          if (-not $hiberFile) {
2026-01-11T19:28:14.1356390Z                              Write-Log "‚úì Hibernation disabled" "SUCCESS"
2026-01-11T19:28:14.1356530Z                          } else {
2026-01-11T19:28:14.1357585Z                              Write-Log "Hibernation file still exists (may be enabled)" "INFO"
2026-01-11T19:28:14.1357695Z                          }
2026-01-11T19:28:14.1358726Z                      
2026-01-11T19:28:14.1358890Z                          return $allPassed
2026-01-11T19:28:14.1359807Z                      }
2026-01-11T19:28:14.1360663Z                      
2026-01-11T19:28:14.1361492Z                      
2026-01-11T19:28:14.1362585Z                      
2026-01-11T19:28:14.1362696Z                      
2026-01-11T19:28:14.1363772Z                      function Set-UltimatePerformancePlan {
2026-01-11T19:28:14.1364722Z                          <#
2026-01-11T19:28:14.1364866Z                          .SYNOPSIS
2026-01-11T19:28:14.1366087Z                              Creates or activates the Ultimate Performance power plan.
2026-01-11T19:28:14.1366277Z                          .DESCRIPTION
2026-01-11T19:28:14.1367439Z                              Duplicates the Ultimate Performance scheme if needed, activates it,
2026-01-11T19:28:14.1368402Z                              and falls back to High Performance when unavailable.
2026-01-11T19:28:14.1368656Z                          .OUTPUTS
2026-01-11T19:28:14.1369785Z                              None.
2026-01-11T19:28:14.1370580Z                          #>
2026-01-11T19:28:14.1370977Z                          try {
2026-01-11T19:28:14.1372227Z                              Write-Log "Adding Ultimate Performance power plan..." "INFO"
2026-01-11T19:28:14.1372377Z                      
2026-01-11T19:28:14.1373653Z                              $ultPerfGuid = "e9a42b02-d5df-448d-aa00-03f14749eb61"
2026-01-11T19:28:14.1373797Z                      
2026-01-11T19:28:14.1375256Z                              $result = powercfg /duplicatescheme $ultPerfGuid 2>&1
2026-01-11T19:28:14.1375421Z                              if ($LASTEXITCODE -eq 0) {
2026-01-11T19:28:14.1376148Z                                  $newGuid = $result -replace '.*GUID:\s*', '' -replace '\s*\(.*', ''
2026-01-11T19:28:14.1376628Z                                  if ($newGuid) {
2026-01-11T19:28:14.1377686Z                                      powercfg /setactive $newGuid.Trim() 2>&1 | Out-Null
2026-01-11T19:28:14.1378292Z                                      Write-Log "Ultimate Performance plan created and activated" "SUCCESS"
2026-01-11T19:28:14.1379003Z                                      Write-Log "Warning: High idle power/thermals - avoid on laptops" "INFO"
2026-01-11T19:28:14.1379533Z                                      return
2026-01-11T19:28:14.1380477Z                                  }
2026-01-11T19:28:14.1381267Z                              }
2026-01-11T19:28:14.1382198Z                      
2026-01-11T19:28:14.1383287Z                              $existingUlt = powercfg /list | Select-String "Ultimate Performance" | ForEach-Object { 
2026-01-11T19:28:14.1383820Z                      ($_ -split '\s+')[3] }
2026-01-11T19:28:14.1384247Z                              if ($existingUlt) {
2026-01-11T19:28:14.1385507Z                                  powercfg /setactive $existingUlt 2>&1 | Out-Null
2026-01-11T19:28:14.1386403Z                                  Write-Log "Activated existing Ultimate Performance plan" "SUCCESS"
2026-01-11T19:28:14.1386863Z                                  return
2026-01-11T19:28:14.1387838Z                              }
2026-01-11T19:28:14.1387940Z                      
2026-01-11T19:28:14.1389285Z                              Write-Log "Ultimate Performance not available, using High Performance" "INFO"
2026-01-11T19:28:14.1389420Z                              Set-PowerPlan
2026-01-11T19:28:14.1390628Z                      
2026-01-11T19:28:14.1390767Z                          } catch {
2026-01-11T19:28:14.1392330Z                              Write-Log "Error setting Ultimate Performance: $_" "ERROR"
2026-01-11T19:28:14.1392466Z                              throw
2026-01-11T19:28:14.1393605Z                          }
2026-01-11T19:28:14.1393708Z                      }
2026-01-11T19:28:14.1394509Z                      
2026-01-11T19:28:14.1394675Z                      
2026-01-11T19:28:14.1396111Z                      function Set-PowerPlan {
2026-01-11T19:28:14.1396208Z                          <#
2026-01-11T19:28:14.1397133Z                          .SYNOPSIS
2026-01-11T19:28:14.1397620Z                              Activates the High Performance power plan.
2026-01-11T19:28:14.1397893Z                          .DESCRIPTION
2026-01-11T19:28:14.1399189Z                              Finds and activates High Performance; if missing, attempts to create it.
2026-01-11T19:28:14.1399288Z                          .OUTPUTS
2026-01-11T19:28:14.1400347Z                              None.
2026-01-11T19:28:14.1400461Z                          #>
2026-01-11T19:28:14.1401566Z                          try {
2026-01-11T19:28:14.1402078Z                              Write-Log "Configuring power plan..." "INFO"
2026-01-11T19:28:14.1402660Z                      
2026-01-11T19:28:14.1404768Z                              $highPerfPlan = powercfg /list | Select-String "High performance" | ForEach-Object { ($_ 
2026-01-11T19:28:14.1404922Z                      -split '\s+')[3] }
2026-01-11T19:28:14.1405027Z                      
2026-01-11T19:28:14.1406422Z                              if ($highPerfPlan) {
2026-01-11T19:28:14.1406621Z                                  powercfg /setactive $highPerfPlan
2026-01-11T19:28:14.1407621Z                                  Write-Log "Set power plan to High Performance: $highPerfPlan" "SUCCESS"
2026-01-11T19:28:14.1408406Z                              } else {
2026-01-11T19:28:14.1409321Z                                  $guid = powercfg /duplicatescheme 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c 2>&1
2026-01-11T19:28:14.1409716Z                                  if ($LASTEXITCODE -eq 0 -and $guid) {
2026-01-11T19:28:14.1410841Z                                      $guid = ($guid -split '\s+')[-1]
2026-01-11T19:28:14.1411049Z                                      powercfg /setactive $guid 2>&1 | Out-Null
2026-01-11T19:28:14.1412758Z                                      Write-Log "Created and activated Ultimate Performance plan: $guid" "SUCCESS"
2026-01-11T19:28:14.1412900Z                                  } else {
2026-01-11T19:28:14.1413321Z                                      Write-Log "Could not create Ultimate Performance plan, using current plan" "ERROR"
2026-01-11T19:28:14.1413717Z                                  }
2026-01-11T19:28:14.1414636Z                              }
2026-01-11T19:28:14.1414736Z                      
2026-01-11T19:28:14.1416202Z                              powercfg /setactive SCHEME_CURRENT 2>&1 | Out-Null
2026-01-11T19:28:14.1416340Z                      
2026-01-11T19:28:14.1416431Z                          } catch {
2026-01-11T19:28:14.1417702Z                              Write-Log "Error setting power plan: $_" "ERROR"
2026-01-11T19:28:14.1417815Z                              throw
2026-01-11T19:28:14.1419010Z                          }
2026-01-11T19:28:14.1419117Z                      }
2026-01-11T19:28:14.1420207Z                      
2026-01-11T19:28:14.1420316Z                      
2026-01-11T19:28:14.1421389Z                      function Disable-PCIeLinkState {
2026-01-11T19:28:14.1421761Z                          <#
2026-01-11T19:28:14.1422764Z                          .SYNOPSIS
2026-01-11T19:28:14.1423296Z                              Disables PCIe link state power management.
2026-01-11T19:28:14.1424275Z                          .DESCRIPTION
2026-01-11T19:28:14.1425303Z                              Sets PCIe link state power settings to Off for AC and DC.
2026-01-11T19:28:14.1426120Z                          .OUTPUTS
2026-01-11T19:28:14.1426489Z                              None.
2026-01-11T19:28:14.1427488Z                          #>
2026-01-11T19:28:14.1427850Z                          try {
2026-01-11T19:28:14.1429214Z                              powercfg /setacvalueindex SCHEME_CURRENT 501a4d13-42af-4429-9fd1-a8218c268e20 
2026-01-11T19:28:14.1429459Z                      ee12f906-d277-404b-b6da-e5fa1a576df5 0 2>&1 | Out-Null
2026-01-11T19:28:14.1429992Z                      
2026-01-11T19:28:14.1431221Z                              powercfg /setdcvalueindex SCHEME_CURRENT 501a4d13-42af-4429-9fd1-a8218c268e20 
2026-01-11T19:28:14.1431507Z                      ee12f906-d277-404b-b6da-e5fa1a576df5 0 2>&1 | Out-Null
2026-01-11T19:28:14.1431849Z                      
2026-01-11T19:28:14.1432988Z                              powercfg /setactive SCHEME_CURRENT 2>&1 | Out-Null
2026-01-11T19:28:14.1433095Z                      
2026-01-11T19:28:14.1433626Z                              Write-Log "Disabled PCIe Link State Power Management" "SUCCESS"
2026-01-11T19:28:14.1434682Z                      
2026-01-11T19:28:14.1434795Z                          } catch {
2026-01-11T19:28:14.1435936Z                              Write-Log "Error disabling PCIe Link State: $_" "ERROR"
2026-01-11T19:28:14.1436070Z                              throw
2026-01-11T19:28:14.1437180Z                          }
2026-01-11T19:28:14.1437294Z                      }
2026-01-11T19:28:14.1438351Z                      
2026-01-11T19:28:14.1439269Z                      
2026-01-11T19:28:14.1439562Z                      function Disable-USBSelectiveSuspend {
2026-01-11T19:28:14.1440597Z                          <#
2026-01-11T19:28:14.1440740Z                          .SYNOPSIS
2026-01-11T19:28:14.1441722Z                              Disables USB selective suspend.
2026-01-11T19:28:14.1442454Z                          .DESCRIPTION
2026-01-11T19:28:14.1443640Z                              Prevents USB devices from entering low-power sleep states.
2026-01-11T19:28:14.1443965Z                          .OUTPUTS
2026-01-11T19:28:14.1444960Z                              None.
2026-01-11T19:28:14.1445344Z                          #>
2026-01-11T19:28:14.1446795Z                          try {
2026-01-11T19:28:14.1447407Z                              powercfg /setacvalueindex SCHEME_CURRENT 2a737441-1930-4402-8d77-b2bebba308a3 
2026-01-11T19:28:14.1448195Z                      48e6b7a6-50f5-4782-a5d4-53bb8f07e226 0 2>&1 | Out-Null
2026-01-11T19:28:14.1448642Z                      
2026-01-11T19:28:14.1449827Z                              powercfg /setdcvalueindex SCHEME_CURRENT 2a737441-1930-4402-8d77-b2bebba308a3 
2026-01-11T19:28:14.1450100Z                      48e6b7a6-50f5-4782-a5d4-53bb8f07e226 0 2>&1 | Out-Null
2026-01-11T19:28:14.1450832Z                      
2026-01-11T19:28:14.1451723Z                              powercfg /setactive SCHEME_CURRENT 2>&1 | Out-Null
2026-01-11T19:28:14.1451825Z                      
2026-01-11T19:28:14.1453182Z                              Write-Log "Disabled USB Selective Suspend" "SUCCESS"
2026-01-11T19:28:14.1453285Z                      
2026-01-11T19:28:14.1454412Z                          } catch {
2026-01-11T19:28:14.1454778Z                              Write-Log "Error disabling USB Selective Suspend: $_" "ERROR"
2026-01-11T19:28:14.1455145Z                              throw
2026-01-11T19:28:14.1456168Z                          }
2026-01-11T19:28:14.1456286Z                      }
2026-01-11T19:28:14.1457594Z                      
2026-01-11T19:28:14.1457699Z                      
2026-01-11T19:28:14.1458771Z                      function Set-ProcessorIdlePolicy {
2026-01-11T19:28:14.1459159Z                          <#
2026-01-11T19:28:14.1460293Z                          .SYNOPSIS
2026-01-11T19:28:14.1460572Z                              Configures minimum processor state for the active plan.
2026-01-11T19:28:14.1461501Z                          .DESCRIPTION
2026-01-11T19:28:14.1462047Z                              Sets the minimum processor state to a bounded percentage (5-100).
2026-01-11T19:28:14.1463131Z                          .PARAMETER MinProcessorStatePercent
2026-01-11T19:28:14.1463425Z                              Minimum CPU state percentage; values are clamped to 5..100.
2026-01-11T19:28:14.1464412Z                          .OUTPUTS
2026-01-11T19:28:14.1465352Z                              None.
2026-01-11T19:28:14.1466161Z                          #>
2026-01-11T19:28:14.1466368Z                          param(
2026-01-11T19:28:14.1467743Z                              [int]$MinProcessorStatePercent = 5
2026-01-11T19:28:14.1467873Z                          )
2026-01-11T19:28:14.1468750Z                      
2026-01-11T19:28:14.1469007Z                          try {
2026-01-11T19:28:14.1470587Z                              if ($MinProcessorStatePercent -lt 5) { $MinProcessorStatePercent = 5 }
2026-01-11T19:28:14.1470849Z                              if ($MinProcessorStatePercent -gt 100) { $MinProcessorStatePercent = 100 }
2026-01-11T19:28:14.1470943Z                      
2026-01-11T19:28:14.1472779Z                              powercfg /setacvalueindex SCHEME_CURRENT 54533251-82be-4824-96c1-47b60b740d00 
2026-01-11T19:28:14.1473112Z                      bc5038f7-23e0-4960-96da-33abaf5935ed $MinProcessorStatePercent 2>&1 | Out-Null
2026-01-11T19:28:14.1474369Z                              powercfg /setdcvalueindex SCHEME_CURRENT 54533251-82be-4824-96c1-47b60b740d00 
2026-01-11T19:28:14.1474915Z                      bc5038f7-23e0-4960-96da-33abaf5935ed $MinProcessorStatePercent 2>&1 | Out-Null
2026-01-11T19:28:14.1475258Z                      
2026-01-11T19:28:14.1476374Z                      
2026-01-11T19:28:14.1476886Z                              powercfg /setactive SCHEME_CURRENT 2>&1 | Out-Null
2026-01-11T19:28:14.1477464Z                      
2026-01-11T19:28:14.1478906Z                              Write-Log "Set minimum processor state to ${MinProcessorStatePercent}% (C-states enabled 
2026-01-11T19:28:14.1479045Z                      for thermal headroom)" "SUCCESS"
2026-01-11T19:28:14.1479399Z                      
2026-01-11T19:28:14.1480459Z                          } catch {
2026-01-11T19:28:14.1480794Z                              Write-Log "Error setting processor idle policy: $_" "ERROR"
2026-01-11T19:28:14.1482822Z                              throw
2026-01-11T19:28:14.1483259Z                          }
2026-01-11T19:28:14.1484659Z                      }
2026-01-11T19:28:14.1484875Z                      
2026-01-11T19:28:14.1484995Z                      
2026-01-11T19:28:14.1485855Z                      function Disable-Hibernation {
2026-01-11T19:28:14.1486907Z                          <#
2026-01-11T19:28:14.1487649Z                          .SYNOPSIS
2026-01-11T19:28:14.1488702Z                              Disables Windows hibernation.
2026-01-11T19:28:14.1489754Z                          .DESCRIPTION
2026-01-11T19:28:14.1490526Z                              Removes hiberfil.sys and reduces disk usage. Also disables Fast Startup
2026-01-11T19:28:14.1491084Z                              if it depends on hibernation.
2026-01-11T19:28:14.1491438Z                          .OUTPUTS
2026-01-11T19:28:14.1492492Z                              None.
2026-01-11T19:28:14.1492927Z                          #>
2026-01-11T19:28:14.1493866Z                          try {
2026-01-11T19:28:14.1494098Z                              powercfg /hibernate off 2>&1 | Out-Null
2026-01-11T19:28:14.1495247Z                              Write-Log "Disabled hibernation (saves disk space)" "SUCCESS"
2026-01-11T19:28:14.1495615Z                      
2026-01-11T19:28:14.1496479Z                          } catch {
2026-01-11T19:28:14.1497412Z                              Write-Log "Error disabling hibernation: $_" "ERROR"
2026-01-11T19:28:14.1497684Z                              throw
2026-01-11T19:28:14.1498664Z                          }
2026-01-11T19:28:14.1498818Z                      }
2026-01-11T19:28:14.1500086Z                      
2026-01-11T19:28:14.1500528Z                      
2026-01-11T19:28:14.1501318Z                      
2026-01-11T19:28:14.1502158Z                      
2026-01-11T19:28:14.1503226Z                      function Invoke-PowerOptimizations {
2026-01-11T19:28:14.1503335Z                          <#
2026-01-11T19:28:14.1504850Z                          .SYNOPSIS
2026-01-11T19:28:14.1505077Z                              Applies the full power optimization set.
2026-01-11T19:28:14.1506047Z                          .DESCRIPTION
2026-01-11T19:28:14.1506437Z                              Activates a high-performance plan, disables PCIe and USB power saving,
2026-01-11T19:28:14.1507566Z                              configures minimum processor state, and disables hibernation.
2026-01-11T19:28:14.1507784Z                          .PARAMETER MinProcessorStatePercent
2026-01-11T19:28:14.1509007Z                              Minimum processor state percentage to apply.
2026-01-11T19:28:14.1509126Z                          .OUTPUTS
2026-01-11T19:28:14.1510070Z                              None.
2026-01-11T19:28:14.1510184Z                          #>
2026-01-11T19:28:14.1511361Z                          param(
2026-01-11T19:28:14.1511907Z                              [int]$MinProcessorStatePercent = 5
2026-01-11T19:28:14.1512889Z                          )
2026-01-11T19:28:14.1513606Z                      
2026-01-11T19:28:14.1514189Z                          Write-Log "Applying power optimizations..." "INFO"
2026-01-11T19:28:14.1514625Z                      
2026-01-11T19:28:14.1515199Z                          try {
2026-01-11T19:28:14.1516395Z                              Set-PowerPlan
2026-01-11T19:28:14.1516524Z                      
2026-01-11T19:28:14.1517491Z                              Disable-PCIeLinkState
2026-01-11T19:28:14.1517590Z                      
2026-01-11T19:28:14.1518820Z                              Disable-USBSelectiveSuspend
2026-01-11T19:28:14.1518920Z                      
2026-01-11T19:28:14.1520402Z                              Set-ProcessorIdlePolicy -MinProcessorStatePercent $MinProcessorStatePercent
2026-01-11T19:28:14.1520477Z                      
2026-01-11T19:28:14.1521442Z                              Disable-Hibernation
2026-01-11T19:28:14.1522152Z                      
2026-01-11T19:28:14.1523422Z                              Write-Log "Power optimizations complete" "SUCCESS"
2026-01-11T19:28:14.1523538Z                      
2026-01-11T19:28:14.1523677Z                          } catch {
2026-01-11T19:28:14.1525339Z                              Write-Log "Error applying power optimizations: $_" "ERROR"
2026-01-11T19:28:14.1525452Z                              throw
2026-01-11T19:28:14.1526506Z                          }
2026-01-11T19:28:14.1526613Z                      }
2026-01-11T19:28:14.1527652Z                      
2026-01-11T19:28:14.1528489Z                      
2026-01-11T19:28:14.1529733Z                      function Undo-PowerOptimizations {
2026-01-11T19:28:14.1529861Z                          <#
2026-01-11T19:28:14.1530569Z                          .SYNOPSIS
2026-01-11T19:28:14.1531443Z                              Reverts power-related changes.
2026-01-11T19:28:14.1532527Z                          .DESCRIPTION
2026-01-11T19:28:14.1532940Z                              Restores the Balanced plan, re-enables hibernation, and resets default
2026-01-11T19:28:14.1534053Z                              power schemes.
2026-01-11T19:28:14.1534166Z                          .OUTPUTS
2026-01-11T19:28:14.1535395Z                              None.
2026-01-11T19:28:14.1536200Z                          #>
2026-01-11T19:28:14.1536676Z                          Write-Log "Rolling back power optimizations..." "INFO"
2026-01-11T19:28:14.1537589Z                      
2026-01-11T19:28:14.1537774Z                          try {
2026-01-11T19:28:14.1539426Z                              $balancedPlan = powercfg /list | Select-String "Balanced" | ForEach-Object { ($_ -split 
2026-01-11T19:28:14.1539636Z                      '\s+')[3] }
2026-01-11T19:28:14.1539980Z                              if ($balancedPlan) {
2026-01-11T19:28:14.1540882Z                                  powercfg /setactive $balancedPlan 2>&1 | Out-Null
2026-01-11T19:28:14.1541968Z                                  Write-Log "Restored Balanced power plan" "SUCCESS"
2026-01-11T19:28:14.1542331Z                              }
2026-01-11T19:28:14.1542789Z                      
2026-01-11T19:28:14.1543731Z                              powercfg /hibernate on 2>&1 | Out-Null
2026-01-11T19:28:14.1544516Z                              Write-Log "Re-enabled hibernation" "SUCCESS"
2026-01-11T19:28:14.1544927Z                      
2026-01-11T19:28:14.1545990Z                              powercfg /restoredefaultschemes 2>&1 | Out-Null
2026-01-11T19:28:14.1546125Z                      
2026-01-11T19:28:14.1547253Z                              Write-Log "Power optimization rollback complete" "SUCCESS"
2026-01-11T19:28:14.1547368Z                      
2026-01-11T19:28:14.1548506Z                          } catch {
2026-01-11T19:28:14.1548727Z                              Write-Log "Error during rollback: $_" "ERROR"
2026-01-11T19:28:14.1549974Z                              throw
2026-01-11T19:28:14.1550093Z                          }
2026-01-11T19:28:14.1551290Z                      }
2026-01-11T19:28:14.1551414Z                      
2026-01-11T19:28:14.1552464Z                      
2026-01-11T19:28:14.1553439Z                      Export-ModuleMember -Function @(
2026-01-11T19:28:14.1553572Z                          'Set-PowerPlan',
2026-01-11T19:28:14.1554421Z                          'Set-UltimatePerformancePlan',
2026-01-11T19:28:14.1555209Z                          'Disable-PCIeLinkState',
2026-01-11T19:28:14.1556002Z                          'Disable-USBSelectiveSuspend',
2026-01-11T19:28:14.1556782Z                          'Set-ProcessorIdlePolicy',
2026-01-11T19:28:14.1557502Z                          'Disable-Hibernation',
2026-01-11T19:28:14.1558622Z                          'Test-PowerOptimizations',
2026-01-11T19:28:14.1559097Z                          'Invoke-PowerOptimizations',
2026-01-11T19:28:14.1560278Z                          'Undo-PowerOptimizations'
2026-01-11T19:28:14.1560688Z                      )
2026-01-11T19:28:14.1561219Z                      
2026-01-11T19:28:14.1561767Z [32;1mParent             : [0m
2026-01-11T19:28:14.1562850Z 
2026-01-11T19:28:14.1597491Z [32;1mAttributes         : [0m{}
2026-01-11T19:28:14.1597723Z [32;1mUsingStatements    : [0m{}
2026-01-11T19:28:14.1597948Z [32;1mParamBlock         : [0m
2026-01-11T19:28:14.1599055Z [32;1mBeginBlock         : [0m
2026-01-11T19:28:14.1599288Z [32;1mProcessBlock       : [0m
2026-01-11T19:28:14.1602459Z [32;1mEndBlock           : [0mImport-Module (Join-Path $PSScriptRoot "..\core\logger.psm1") -Force -Global
2026-01-11T19:28:14.1602770Z                      Import-Module (Join-Path $PSScriptRoot "..\core\registry.psm1") -Force -Global
2026-01-11T19:28:14.1602826Z                      
2026-01-11T19:28:14.1603828Z                      
2026-01-11T19:28:14.1604954Z                      # --- Helper Functions ---
2026-01-11T19:28:14.1605440Z                      
2026-01-11T19:28:14.1606501Z                      function Set-ScheduledTaskState {
2026-01-11T19:28:14.1607287Z                          <#
2026-01-11T19:28:14.1607388Z                          .SYNOPSIS
2026-01-11T19:28:14.1608903Z                              Enables or disables a Windows scheduled task.
2026-01-11T19:28:14.1609282Z                          .PARAMETER TaskPath
2026-01-11T19:28:14.1609924Z                              The full task path (e.g., "Microsoft\Windows\Autochk\Proxy").
2026-01-11T19:28:14.1610755Z                          .PARAMETER State
2026-01-11T19:28:14.1611678Z                              "Disabled" or "Enabled".
2026-01-11T19:28:14.1612435Z                          #>
2026-01-11T19:28:14.1613412Z                          param(
2026-01-11T19:28:14.1613911Z                              [string]$TaskPath,
2026-01-11T19:28:14.1615091Z                              [string]$State
2026-01-11T19:28:14.1615226Z                          )
2026-01-11T19:28:14.1615952Z                          try {
2026-01-11T19:28:14.1616778Z                              if ($State -eq 'Disabled') {
2026-01-11T19:28:14.1618163Z                                  Disable-ScheduledTask -TaskName $TaskPath -ErrorAction SilentlyContinue | Out-Null
2026-01-11T19:28:14.1618310Z                              } else {
2026-01-11T19:28:14.1619049Z                                  Enable-ScheduledTask -TaskName $TaskPath -ErrorAction SilentlyContinue | Out-Null
2026-01-11T19:28:14.1619540Z                              }
2026-01-11T19:28:14.1620125Z                              Write-Log "Scheduled task '$TaskPath' set to $State" "INFO"
2026-01-11T19:28:14.1621179Z                              return $true
2026-01-11T19:28:14.1621287Z                          } catch {
2026-01-11T19:28:14.1622640Z                              Write-Log "Failed to set task '$TaskPath': $($_.Exception.Message)" "WARNING"
2026-01-11T19:28:14.1622803Z                              return $false
2026-01-11T19:28:14.1623180Z                          }
2026-01-11T19:28:14.1623976Z                      }
2026-01-11T19:28:14.1624764Z                      
2026-01-11T19:28:14.1624866Z                      
2026-01-11T19:28:14.1626519Z                      function Test-PrivacyOptimizations {
2026-01-11T19:28:14.1626907Z                          <#
2026-01-11T19:28:14.1628010Z                          .SYNOPSIS
2026-01-11T19:28:14.1628244Z                              Verifies privacy-related registry values.
2026-01-11T19:28:14.1629263Z                          .DESCRIPTION
2026-01-11T19:28:14.1630206Z                              Checks advertising ID and activity history policies.
2026-01-11T19:28:14.1630546Z                          .OUTPUTS
2026-01-11T19:28:14.1631494Z                              [bool] True when checks pass, else false.
2026-01-11T19:28:14.1631850Z                          #>
2026-01-11T19:28:14.1632923Z                          $allPassed = $true
2026-01-11T19:28:14.1633055Z                      
2026-01-11T19:28:14.1634347Z                          Write-Log "Verifying privacy optimizations..." "INFO"
2026-01-11T19:28:14.1634533Z                      
2026-01-11T19:28:14.1635588Z                          $advID = Get-RegistryValue -Path 
2026-01-11T19:28:14.1635967Z                      "HKCU:\Software\Microsoft\Windows\CurrentVersion\AdvertisingInfo" -Name "Enabled"
2026-01-11T19:28:14.1637210Z                          if ($advID -eq 0) {
2026-01-11T19:28:14.1637864Z                              Write-Log "‚úì Advertising ID disabled" "SUCCESS"
2026-01-11T19:28:14.1638256Z                          } else {
2026-01-11T19:28:14.1639408Z                              Write-Log "‚úó Advertising ID not disabled" "ERROR"
2026-01-11T19:28:14.1639558Z                              $allPassed = $false
2026-01-11T19:28:14.1640569Z                          }
2026-01-11T19:28:14.1641915Z                      
2026-01-11T19:28:14.1643586Z                          $activityHistory = Get-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\System" 
2026-01-11T19:28:14.1643757Z                      -Name "PublishUserActivities"
2026-01-11T19:28:14.1644272Z                          if ($activityHistory -eq 0) {
2026-01-11T19:28:14.1645818Z                              Write-Log "‚úì Activity History disabled" "SUCCESS"
2026-01-11T19:28:14.1645972Z                          }
2026-01-11T19:28:14.1647037Z                      
2026-01-11T19:28:14.1647242Z                          return $allPassed
2026-01-11T19:28:14.1648334Z                      }
2026-01-11T19:28:14.1649206Z                      
2026-01-11T19:28:14.1650142Z                      
2026-01-11T19:28:14.1650235Z                      
2026-01-11T19:28:14.1651194Z                      
2026-01-11T19:28:14.1652032Z                      function Apply-PrivacyTier1Safe {
2026-01-11T19:28:14.1652965Z                          <#
2026-01-11T19:28:14.1653177Z                          .SYNOPSIS
2026-01-11T19:28:14.1654485Z                              Applies Tier 1 privacy settings (safe defaults).
2026-01-11T19:28:14.1654611Z                          .DESCRIPTION
2026-01-11T19:28:14.1655420Z                              Disables advertising ID, activity history, WiFi Sense, feedback prompts,
2026-01-11T19:28:14.1656069Z                              spotlight content, cloud clipboard, and reduces telemetry level.
2026-01-11T19:28:14.1656872Z                          .OUTPUTS
2026-01-11T19:28:14.1656988Z                              None.
2026-01-11T19:28:14.1658240Z                          #>
2026-01-11T19:28:14.1658407Z                          try {
2026-01-11T19:28:14.1659596Z                              Write-Log "Applying Tier 1 safe privacy tweaks..." "INFO"
2026-01-11T19:28:14.1659884Z                      
2026-01-11T19:28:14.1660936Z                              $advPath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\AdvertisingInfo"
2026-01-11T19:28:14.1661187Z                              Backup-RegistryKey -Path $advPath
2026-01-11T19:28:14.1662597Z                              Set-RegistryValue -Path $advPath -Name "Enabled" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.1663098Z                      
2026-01-11T19:28:14.1663902Z                              $advPath2 = "HKLM:\SOFTWARE\Policies\Microsoft\Windows\AdvertisingInfo"
2026-01-11T19:28:14.1664349Z                              Backup-RegistryKey -Path $advPath2
2026-01-11T19:28:14.1665647Z                              Set-RegistryValue -Path $advPath2 -Name "DisabledByGroupPolicy" -Value 1 -Type "DWORD"
2026-01-11T19:28:14.1665914Z                              Write-Log "Disabled Advertising ID" "SUCCESS"
2026-01-11T19:28:14.1666616Z                      
2026-01-11T19:28:14.1667842Z                              $activityPath = "HKLM:\SOFTWARE\Policies\Microsoft\Windows\System"
2026-01-11T19:28:14.1668284Z                              Backup-RegistryKey -Path $activityPath
2026-01-11T19:28:14.1669343Z                              Set-RegistryValue -Path $activityPath -Name "PublishUserActivities" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.1669761Z                              Set-RegistryValue -Path $activityPath -Name "UploadUserActivities" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.1669928Z                              Write-Log "Disabled Activity History / Timeline" "SUCCESS"
2026-01-11T19:28:14.1670313Z                      
2026-01-11T19:28:14.1671362Z                              $wifiPath = "HKLM:\SOFTWARE\Microsoft\WcmSvc\wifinetworkmanager\config"
2026-01-11T19:28:14.1671547Z                              Backup-RegistryKey -Path $wifiPath
2026-01-11T19:28:14.1672811Z                              Set-RegistryValue -Path $wifiPath -Name "AutoConnectAllowedOEM" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.1673153Z                              Set-RegistryValue -Path $wifiPath -Name "WiFISenseAllowed" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.1673516Z                              Write-Log "Disabled WiFi Sense" "SUCCESS"
2026-01-11T19:28:14.1673886Z                      
2026-01-11T19:28:14.1674439Z                              $feedbackPath = "HKCU:\Software\Microsoft\Siuf\Rules"
2026-01-11T19:28:14.1674788Z                              Backup-RegistryKey -Path $feedbackPath
2026-01-11T19:28:14.1675516Z                              Set-RegistryValue -Path $feedbackPath -Name "NumberOfSIUFInPeriod" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.1675739Z                              Write-Log "Disabled Windows Feedback" "SUCCESS"
2026-01-11T19:28:14.1676677Z                      
2026-01-11T19:28:14.1677200Z                              $spotlightPath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager"
2026-01-11T19:28:14.1678104Z                              Backup-RegistryKey -Path $spotlightPath
2026-01-11T19:28:14.1678667Z                              Set-RegistryValue -Path $spotlightPath -Name "RotatingLockScreenEnabled" -Value 0 -Type 
2026-01-11T19:28:14.1678800Z                      "DWORD"
2026-01-11T19:28:14.1680287Z                              Set-RegistryValue -Path $spotlightPath -Name "RotatingLockScreenOverlayEnabled" -Value 0 
2026-01-11T19:28:14.1680379Z                      -Type "DWORD"
2026-01-11T19:28:14.1681956Z                              Set-RegistryValue -Path $spotlightPath -Name "SubscribedContent-338389Enabled" -Value 0 
2026-01-11T19:28:14.1682096Z                      -Type "DWORD"
2026-01-11T19:28:14.1682624Z                              Write-Log "Disabled Windows Spotlight" "SUCCESS"
2026-01-11T19:28:14.1682967Z                      
2026-01-11T19:28:14.1684123Z                              $clipboardPath = "HKCU:\Software\Microsoft\Clipboard"
2026-01-11T19:28:14.1684358Z                              Backup-RegistryKey -Path $clipboardPath
2026-01-11T19:28:14.1685638Z                              Set-RegistryValue -Path $clipboardPath -Name "EnableClipboardHistory" -Value 0 -Type 
2026-01-11T19:28:14.1685787Z                      "DWORD"
2026-01-11T19:28:14.1686913Z                              Write-Log "Disabled Cloud Clipboard Sync" "SUCCESS"
2026-01-11T19:28:14.1687037Z                      
2026-01-11T19:28:14.1688486Z                              $telemetryPath = "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\DataCollection"
2026-01-11T19:28:14.1688634Z                              Backup-RegistryKey -Path $telemetryPath
2026-01-11T19:28:14.1689874Z                              Set-RegistryValue -Path $telemetryPath -Name "AllowTelemetry" -Value 1 -Type "DWORD"  # 1 
2026-01-11T19:28:14.1690122Z                      = Security only (not 0 = off, requires Enterprise)
2026-01-11T19:28:14.1691487Z                              Set-RegistryValue -Path $telemetryPath -Name "DoNotShowFeedbackNotifications" -Value 1 
2026-01-11T19:28:14.1691621Z                      -Type "DWORD"
2026-01-11T19:28:14.1692187Z                              Write-Log "Reduced diagnostic data to minimum (Security level)" "SUCCESS"
2026-01-11T19:28:14.1693197Z                      
2026-01-11T19:28:14.1693702Z                              Write-Log "Tier 1 safe privacy tweaks complete" "SUCCESS"
2026-01-11T19:28:14.1694164Z                      
2026-01-11T19:28:14.1695273Z                          } catch {
2026-01-11T19:28:14.1695607Z                              Write-Log "Error applying Tier 1 privacy tweaks: $_" "ERROR"
2026-01-11T19:28:14.1696279Z                              throw
2026-01-11T19:28:14.1697282Z                          }
2026-01-11T19:28:14.1697719Z                      }
2026-01-11T19:28:14.1698606Z                      
2026-01-11T19:28:14.1699076Z                      
2026-01-11T19:28:14.1699891Z                      
2026-01-11T19:28:14.1700346Z                      
2026-01-11T19:28:14.1701729Z                      function Apply-PrivacyTier2Moderate {
2026-01-11T19:28:14.1701838Z                          <#
2026-01-11T19:28:14.1703247Z                          .SYNOPSIS
2026-01-11T19:28:14.1703492Z                              Applies Tier 2 privacy settings (moderate).
2026-01-11T19:28:14.1704519Z                          .DESCRIPTION
2026-01-11T19:28:14.1705572Z                              Disables telemetry scheduled tasks, services, and applies comprehensive
2026-01-11T19:28:14.1706048Z                              privacy registry settings.
2026-01-11T19:28:14.1706156Z                          .OUTPUTS
2026-01-11T19:28:14.1707081Z                              None.
2026-01-11T19:28:14.1707959Z                          #>
2026-01-11T19:28:14.1708632Z                          try {
2026-01-11T19:28:14.1709791Z                              Write-Log "Applying Tier 2 moderate privacy tweaks..." "INFO"
2026-01-11T19:28:14.1709903Z                      
2026-01-11T19:28:14.1711142Z                              # --- Disable telemetry scheduled tasks ---
2026-01-11T19:28:14.1711423Z                              Write-Log "Disabling telemetry scheduled tasks..." "INFO"
2026-01-11T19:28:14.1711830Z                              $telemetryTasks = @(
2026-01-11T19:28:14.1713016Z                                  "Microsoft\Windows\Autochk\Proxy",
2026-01-11T19:28:14.1713441Z                                  "Microsoft\Windows\Customer Experience Improvement Program\Consolidator",
2026-01-11T19:28:14.1714030Z                                  "Microsoft\Windows\Customer Experience Improvement Program\UsbCeip",
2026-01-11T19:28:14.1714825Z                                  "Microsoft\Windows\DiskDiagnostic\Microsoft-Windows-DiskDiagnosticDataCollector",
2026-01-11T19:28:14.1715294Z                                  "Microsoft\Windows\Feedback\Siuf\DmClient",
2026-01-11T19:28:14.1716491Z                                  "Microsoft\Windows\Feedback\Siuf\DmClientOnScenarioDownload",
2026-01-11T19:28:14.1716746Z                                  "Microsoft\Windows\Windows Error Reporting\QueueReporting",
2026-01-11T19:28:14.1717887Z                                  "Microsoft\Windows\Application Experience\MareBackup",
2026-01-11T19:28:14.1718389Z                                  "Microsoft\Windows\Application Experience\StartupAppTask",
2026-01-11T19:28:14.1718993Z                                  "Microsoft\Windows\Application Experience\PcaPatchDbTask"
2026-01-11T19:28:14.1719352Z                              )
2026-01-11T19:28:14.1719864Z                              foreach ($task in $telemetryTasks) {
2026-01-11T19:28:14.1720343Z                                  Set-ScheduledTaskState -TaskPath $task -State "Disabled"
2026-01-11T19:28:14.1720582Z                              }
2026-01-11T19:28:14.1721569Z                              Write-Log "Telemetry scheduled tasks disabled" "SUCCESS"
2026-01-11T19:28:14.1721674Z                      
2026-01-11T19:28:14.1722957Z                              # --- AllowTelemetry at both policy paths ---
2026-01-11T19:28:14.1723525Z                              $telemetryPath1 = 
2026-01-11T19:28:14.1724262Z                      "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\DataCollection"
2026-01-11T19:28:14.1724946Z                              Backup-RegistryKey -Path $telemetryPath1
2026-01-11T19:28:14.1726205Z                              Set-RegistryValue -Path $telemetryPath1 -Name "AllowTelemetry" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.1726393Z                      
2026-01-11T19:28:14.1726819Z                              $telemetryPath2 = "HKLM:\SOFTWARE\Policies\Microsoft\Windows\DataCollection"
2026-01-11T19:28:14.1727906Z                              Backup-RegistryKey -Path $telemetryPath2
2026-01-11T19:28:14.1728408Z                              Set-RegistryValue -Path $telemetryPath2 -Name "AllowTelemetry" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.1729655Z                              Set-RegistryValue -Path $telemetryPath2 -Name "DoNotShowFeedbackNotifications" -Value 1 
2026-01-11T19:28:14.1729766Z                      -Type "DWORD"
2026-01-11T19:28:14.1730184Z                              Write-Log "Telemetry set to minimum" "SUCCESS"
2026-01-11T19:28:14.1730525Z                      
2026-01-11T19:28:14.1731233Z                              # --- ContentDeliveryManager (content suggestions, pre-installed apps) ---
2026-01-11T19:28:14.1731681Z                              $cdmPath = "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager"
2026-01-11T19:28:14.1732143Z                              Backup-RegistryKey -Path $cdmPath
2026-01-11T19:28:14.1732908Z                              Set-RegistryValue -Path $cdmPath -Name "ContentDeliveryAllowed" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.1733551Z                              Set-RegistryValue -Path $cdmPath -Name "OemPreInstalledAppsEnabled" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.1734021Z                              Set-RegistryValue -Path $cdmPath -Name "PreInstalledAppsEnabled" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.1735412Z                              Set-RegistryValue -Path $cdmPath -Name "PreInstalledAppsEverEnabled" -Value 0 -Type 
2026-01-11T19:28:14.1735540Z                      "DWORD"
2026-01-11T19:28:14.1736653Z                              Set-RegistryValue -Path $cdmPath -Name "SilentInstalledAppsEnabled" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.1737110Z                              Set-RegistryValue -Path $cdmPath -Name "SubscribedContent-338387Enabled" -Value 0 -Type 
2026-01-11T19:28:14.1737730Z                      "DWORD"
2026-01-11T19:28:14.1738983Z                              Set-RegistryValue -Path $cdmPath -Name "SubscribedContent-338388Enabled" -Value 0 -Type 
2026-01-11T19:28:14.1739126Z                      "DWORD"
2026-01-11T19:28:14.1740585Z                              Set-RegistryValue -Path $cdmPath -Name "SubscribedContent-338389Enabled" -Value 0 -Type 
2026-01-11T19:28:14.1740704Z                      "DWORD"
2026-01-11T19:28:14.1741973Z                              Set-RegistryValue -Path $cdmPath -Name "SubscribedContent-353698Enabled" -Value 0 -Type 
2026-01-11T19:28:14.1742064Z                      "DWORD"
2026-01-11T19:28:14.1743235Z                              Set-RegistryValue -Path $cdmPath -Name "SystemPaneSuggestionsEnabled" -Value 0 -Type 
2026-01-11T19:28:14.1743633Z                      "DWORD"
2026-01-11T19:28:14.1744596Z                              Write-Log "Content delivery/suggestions disabled" "SUCCESS"
2026-01-11T19:28:14.1744914Z                      
2026-01-11T19:28:14.1745863Z                              # --- Feedback and advertising ---
2026-01-11T19:28:14.1746106Z                              $siufPath = "HKCU:\SOFTWARE\Microsoft\Siuf\Rules"
2026-01-11T19:28:14.1747352Z                              Backup-RegistryKey -Path $siufPath
2026-01-11T19:28:14.1747847Z                              Set-RegistryValue -Path $siufPath -Name "NumberOfSIUFInPeriod" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.1747984Z                      
2026-01-11T19:28:14.1749075Z                              $cloudPath = "HKCU:\SOFTWARE\Policies\Microsoft\Windows\CloudContent"
2026-01-11T19:28:14.1749579Z                              Backup-RegistryKey -Path $cloudPath
2026-01-11T19:28:14.1750375Z                              Set-RegistryValue -Path $cloudPath -Name "DisableTailoredExperiencesWithDiagnosticData" 
2026-01-11T19:28:14.1751193Z                      -Value 1 -Type "DWORD"
2026-01-11T19:28:14.1751651Z                      
2026-01-11T19:28:14.1752989Z                              $adInfoPath = "HKLM:\SOFTWARE\Policies\Microsoft\Windows\AdvertisingInfo"
2026-01-11T19:28:14.1753230Z                              Backup-RegistryKey -Path $adInfoPath
2026-01-11T19:28:14.1754532Z                              Set-RegistryValue -Path $adInfoPath -Name "DisabledByGroupPolicy" -Value 1 -Type "DWORD"
2026-01-11T19:28:14.1754786Z                              Write-Log "Feedback and advertising disabled" "SUCCESS"
2026-01-11T19:28:14.1755090Z                      
2026-01-11T19:28:14.1756266Z                              # --- Windows Error Reporting ---
2026-01-11T19:28:14.1756631Z                              $werPath = "HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting"
2026-01-11T19:28:14.1756856Z                              Backup-RegistryKey -Path $werPath
2026-01-11T19:28:14.1758109Z                              Set-RegistryValue -Path $werPath -Name "Disabled" -Value 1 -Type "DWORD"
2026-01-11T19:28:14.1758637Z                              Write-Log "Windows Error Reporting disabled" "SUCCESS"
2026-01-11T19:28:14.1758741Z                      
2026-01-11T19:28:14.1759887Z                              # --- Delivery Optimization P2P at both paths ---
2026-01-11T19:28:14.1760386Z                              $doPath1 = "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\DeliveryOptimization\Config"
2026-01-11T19:28:14.1760584Z                              Backup-RegistryKey -Path $doPath1
2026-01-11T19:28:14.1760899Z                              Set-RegistryValue -Path $doPath1 -Name "DODownloadMode" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.1761976Z                      
2026-01-11T19:28:14.1762449Z                              $doPath2 = "HKLM:\SOFTWARE\Policies\Microsoft\Windows\DeliveryOptimization"
2026-01-11T19:28:14.1763343Z                              Backup-RegistryKey -Path $doPath2
2026-01-11T19:28:14.1764825Z                              Set-RegistryValue -Path $doPath2 -Name "DODownloadMode" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.1765079Z                              Write-Log "Delivery Optimization P2P disabled" "SUCCESS"
2026-01-11T19:28:14.1765452Z                      
2026-01-11T19:28:14.1766488Z                              # --- Disable telemetry services ---
2026-01-11T19:28:14.1766633Z                              try {
2026-01-11T19:28:14.1768099Z                                  $service = Get-Service -Name "DiagTrack" -ErrorAction SilentlyContinue
2026-01-11T19:28:14.1768246Z                                  if ($service) {
2026-01-11T19:28:14.1768516Z                                      Stop-Service -Name "DiagTrack" -Force -ErrorAction SilentlyContinue
2026-01-11T19:28:14.1769959Z                                      Set-Service -Name "DiagTrack" -StartupType Disabled -ErrorAction SilentlyContinue
2026-01-11T19:28:14.1770179Z                                      Write-Log "Disabled DiagTrack service" "SUCCESS"
2026-01-11T19:28:14.1770589Z                                  }
2026-01-11T19:28:14.1771537Z                              } catch {
2026-01-11T19:28:14.1771800Z                                  Write-Log "Error disabling DiagTrack: $_" "WARNING"
2026-01-11T19:28:14.1772734Z                              }
2026-01-11T19:28:14.1772834Z                      
2026-01-11T19:28:14.1773997Z                              try {
2026-01-11T19:28:14.1774365Z                                  $service = Get-Service -Name "dmwappushservice" -ErrorAction SilentlyContinue
2026-01-11T19:28:14.1775197Z                                  if ($service) {
2026-01-11T19:28:14.1776177Z                                      Stop-Service -Name "dmwappushservice" -Force -ErrorAction SilentlyContinue
2026-01-11T19:28:14.1776801Z                                      Set-Service -Name "dmwappushservice" -StartupType Disabled -ErrorAction 
2026-01-11T19:28:14.1777384Z                      SilentlyContinue
2026-01-11T19:28:14.1777634Z                                      Write-Log "Disabled dmwappushservice" "SUCCESS"
2026-01-11T19:28:14.1778715Z                                  }
2026-01-11T19:28:14.1779068Z                              } catch {
2026-01-11T19:28:14.1780265Z                                  Write-Log "Error disabling dmwappushservice: $_" "WARNING"
2026-01-11T19:28:14.1780381Z                              }
2026-01-11T19:28:14.1781366Z                      
2026-01-11T19:28:14.1781773Z                              Write-Log "Tier 2 privacy tweaks complete (tasks + registry + services)" "SUCCESS"
2026-01-11T19:28:14.1782974Z                      
2026-01-11T19:28:14.1783941Z                          } catch {
2026-01-11T19:28:14.1785248Z                              Write-Log "Error applying Tier 2 privacy tweaks: $_" "ERROR"
2026-01-11T19:28:14.1785386Z                              throw
2026-01-11T19:28:14.1786350Z                          }
2026-01-11T19:28:14.1787095Z                      }
2026-01-11T19:28:14.1787531Z                      
2026-01-11T19:28:14.1788439Z                      
2026-01-11T19:28:14.1789390Z                      
2026-01-11T19:28:14.1789490Z                      
2026-01-11T19:28:14.1790875Z                      function Apply-PrivacyTier3Aggressive {
2026-01-11T19:28:14.1790997Z                          <#
2026-01-11T19:28:14.1792114Z                          .SYNOPSIS
2026-01-11T19:28:14.1792344Z                              Applies Tier 3 privacy settings (aggressive).
2026-01-11T19:28:14.1793325Z                          .DESCRIPTION
2026-01-11T19:28:14.1794511Z                              Disables Xbox/Game Pass services and other components that can break
2026-01-11T19:28:14.1794637Z                              Microsoft gaming features.
2026-01-11T19:28:14.1795634Z                          .OUTPUTS
2026-01-11T19:28:14.1796469Z                              None.
2026-01-11T19:28:14.1796949Z                          #>
2026-01-11T19:28:14.1797842Z                          try {
2026-01-11T19:28:14.1798435Z                              Write-Log "Applying Tier 3 aggressive privacy tweaks (opt-in, BREAKS features)..." "INFO"
2026-01-11T19:28:14.1800458Z                              Write-Log "WARNING: This will BREAK Game Pass and Xbox app functionality!" "ERROR"
2026-01-11T19:28:14.1800576Z                      
2026-01-11T19:28:14.1800693Z                              $xboxServices = @(
2026-01-11T19:28:14.1800841Z                                  "XblAuthManager",
2026-01-11T19:28:14.1801017Z                                  "XblGameSave",
2026-01-11T19:28:14.1802073Z                                  "XboxGipSvc",
2026-01-11T19:28:14.1802856Z                                  "XboxNetApiSvc"
2026-01-11T19:28:14.1803616Z                              )
2026-01-11T19:28:14.1804019Z                      
2026-01-11T19:28:14.1805062Z                              foreach ($serviceName in $xboxServices) {
2026-01-11T19:28:14.1805185Z                                  try {
2026-01-11T19:28:14.1806611Z                                      $service = Get-Service -Name $serviceName -ErrorAction SilentlyContinue
2026-01-11T19:28:14.1806765Z                                      if ($service) {
2026-01-11T19:28:14.1807944Z                                          Stop-Service -Name $serviceName -Force -ErrorAction Stop
2026-01-11T19:28:14.1808339Z                                          Set-Service -Name $serviceName -StartupType Disabled -ErrorAction Stop
2026-01-11T19:28:14.1808792Z                                          Write-Log "Disabled Xbox service: $serviceName (BREAKS Game Pass)" "SUCCESS"
2026-01-11T19:28:14.1809234Z                                      }
2026-01-11T19:28:14.1810123Z                                  } catch {
2026-01-11T19:28:14.1810730Z                                      Write-Log "Error disabling Xbox service $serviceName : $_" "ERROR"
2026-01-11T19:28:14.1810884Z                                  }
2026-01-11T19:28:14.1811949Z                              }
2026-01-11T19:28:14.1812055Z                      
2026-01-11T19:28:14.1813607Z                              Write-Log "Tier 3 aggressive privacy tweaks complete (Game Pass BROKEN)" "SUCCESS"
2026-01-11T19:28:14.1813741Z                      
2026-01-11T19:28:14.1814480Z                          } catch {
2026-01-11T19:28:14.1815465Z                              Write-Log "Error applying Tier 3 privacy tweaks: $_" "ERROR"
2026-01-11T19:28:14.1816322Z                              throw
2026-01-11T19:28:14.1816510Z                          }
2026-01-11T19:28:14.1817687Z                      }
2026-01-11T19:28:14.1817791Z                      
2026-01-11T19:28:14.1818936Z                      
2026-01-11T19:28:14.1819036Z                      
2026-01-11T19:28:14.1820402Z                      
2026-01-11T19:28:14.1820574Z                      function Remove-Bloatware {
2026-01-11T19:28:14.1822136Z                          <#
2026-01-11T19:28:14.1822579Z                          .SYNOPSIS
2026-01-11T19:28:14.1822784Z                              Removes selected built-in UWP apps.
2026-01-11T19:28:14.1823747Z                          .DESCRIPTION
2026-01-11T19:28:14.1824104Z                              Uninstalls a curated list of consumer apps for a leaner system.
2026-01-11T19:28:14.1824607Z                          .OUTPUTS
2026-01-11T19:28:14.1825384Z                              None.
2026-01-11T19:28:14.1826292Z                          #>
2026-01-11T19:28:14.1826404Z                          try {
2026-01-11T19:28:14.1827833Z                              Write-Log "Removing UWP bloatware..." "INFO"
2026-01-11T19:28:14.1827957Z                      
2026-01-11T19:28:14.1829218Z                              $appsToRemove = @(
2026-01-11T19:28:14.1829828Z                                  "Microsoft.GetHelp",
2026-01-11T19:28:14.1830197Z                                  "Microsoft.Getstarted",
2026-01-11T19:28:14.1831400Z                                  "Microsoft.Microsoft3DViewer",
2026-01-11T19:28:14.1831608Z                                  "Microsoft.MicrosoftOfficeHub",
2026-01-11T19:28:14.1832823Z                                  "Microsoft.MicrosoftSolitaireCollection",
2026-01-11T19:28:14.1833058Z                                  "Microsoft.MixedReality.Portal",
2026-01-11T19:28:14.1834250Z                                  "Microsoft.People",
2026-01-11T19:28:14.1834406Z                                  "Microsoft.SkypeApp",
2026-01-11T19:28:14.1835221Z                                  "Microsoft.YourPhone",
2026-01-11T19:28:14.1836019Z                                  "Microsoft.ZuneMusic",
2026-01-11T19:28:14.1837028Z                                  "Microsoft.ZuneVideo"
2026-01-11T19:28:14.1837476Z                              )
2026-01-11T19:28:14.1838362Z                      
2026-01-11T19:28:14.1839285Z                              $removed = 0
2026-01-11T19:28:14.1839501Z                              foreach ($app in $appsToRemove) {
2026-01-11T19:28:14.1840783Z                                  try {
2026-01-11T19:28:14.1842074Z                                      $package = Get-AppxPackage -Name $app -ErrorAction SilentlyContinue
2026-01-11T19:28:14.1842263Z                                      if ($package) {
2026-01-11T19:28:14.1843760Z                                          Remove-AppxPackage -Package $package.PackageFullName -ErrorAction Stop
2026-01-11T19:28:14.1843895Z                                          Write-Log "Removed app: $app" "SUCCESS"
2026-01-11T19:28:14.1844735Z                                          $removed++
2026-01-11T19:28:14.1845333Z                                      }
2026-01-11T19:28:14.1846422Z                                  } catch {
2026-01-11T19:28:14.1855960Z                                      Write-Log "Error removing app $app : $_" "ERROR"
2026-01-11T19:28:14.1856124Z                                  }
2026-01-11T19:28:14.1856262Z                              }
2026-01-11T19:28:14.1856374Z                      
2026-01-11T19:28:14.1856761Z                              Write-Log "Bloatware removal complete: $removed apps removed" "SUCCESS"
2026-01-11T19:28:14.1856861Z                      
2026-01-11T19:28:14.1856964Z                          } catch {
2026-01-11T19:28:14.1857199Z                              Write-Log "Error removing bloatware: $_" "ERROR"
2026-01-11T19:28:14.1857303Z                              throw
2026-01-11T19:28:14.1857400Z                          }
2026-01-11T19:28:14.1857511Z                      }
2026-01-11T19:28:14.1857601Z                      
2026-01-11T19:28:14.1857693Z                      
2026-01-11T19:28:14.1857845Z                      function Remove-XboxApps {
2026-01-11T19:28:14.1857961Z                          <#
2026-01-11T19:28:14.1858064Z                          .SYNOPSIS
2026-01-11T19:28:14.1858237Z                              Removes Xbox-related UWP apps.
2026-01-11T19:28:14.1858377Z                          .DESCRIPTION
2026-01-11T19:28:14.1860252Z                              Uninstalls Xbox UWP apps. This breaks Game Pass and Xbox app features.
2026-01-11T19:28:14.1860320Z                          .OUTPUTS
2026-01-11T19:28:14.1860387Z                              None.
2026-01-11T19:28:14.1860454Z                          #>
2026-01-11T19:28:14.1860511Z                          try {
2026-01-11T19:28:14.1861041Z                              Write-Log "Removing Xbox UWP apps (BREAKS Game Pass)..." "INFO"
2026-01-11T19:28:14.1862320Z                      
2026-01-11T19:28:14.1862455Z                              $xboxApps = @(
2026-01-11T19:28:14.1862620Z                                  "Microsoft.XboxApp",
2026-01-11T19:28:14.1863763Z                                  "Microsoft.XboxGameCallableUI",
2026-01-11T19:28:14.1863961Z                                  "Microsoft.XboxGamingOverlay",
2026-01-11T19:28:14.1865142Z                                  "Microsoft.XboxIdentityProvider",
2026-01-11T19:28:14.1865366Z                                  "Microsoft.XboxSpeechToTextOverlay",
2026-01-11T19:28:14.1865917Z                                  "Microsoft.Xbox.TCUI"
2026-01-11T19:28:14.1866249Z                              )
2026-01-11T19:28:14.1867307Z                      
2026-01-11T19:28:14.1867437Z                              $removed = 0
2026-01-11T19:28:14.1868650Z                              foreach ($app in $xboxApps) {
2026-01-11T19:28:14.1868764Z                                  try {
2026-01-11T19:28:14.1870345Z                                      $package = Get-AppxPackage -Name $app -ErrorAction SilentlyContinue
2026-01-11T19:28:14.1870513Z                                      if ($package) {
2026-01-11T19:28:14.1871204Z                                          Remove-AppxPackage -Package $package.PackageFullName -ErrorAction Stop
2026-01-11T19:28:14.1871610Z                                          Write-Log "Removed Xbox app: $app (Game Pass BROKEN)" "SUCCESS"
2026-01-11T19:28:14.1872380Z                                          $removed++
2026-01-11T19:28:14.1873124Z                                      }
2026-01-11T19:28:14.1873895Z                                  } catch {
2026-01-11T19:28:14.1874908Z                                      Write-Log "Error removing Xbox app $app : $_" "ERROR"
2026-01-11T19:28:14.1875514Z                                  }
2026-01-11T19:28:14.1876421Z                              }
2026-01-11T19:28:14.1876527Z                      
2026-01-11T19:28:14.1878265Z                              Write-Log "Xbox app removal complete: $removed apps removed (Game Pass BROKEN)" "SUCCESS"
2026-01-11T19:28:14.1878388Z                      
2026-01-11T19:28:14.1878490Z                          } catch {
2026-01-11T19:28:14.1879715Z                              Write-Log "Error removing Xbox apps: $_" "ERROR"
2026-01-11T19:28:14.1879883Z                              throw
2026-01-11T19:28:14.1881343Z                          }
2026-01-11T19:28:14.1881460Z                      }
2026-01-11T19:28:14.1882526Z                      
2026-01-11T19:28:14.1882886Z                      
2026-01-11T19:28:14.1883768Z                      
2026-01-11T19:28:14.1884797Z                      
2026-01-11T19:28:14.1885350Z                      function Set-BackgroundAppsOff {
2026-01-11T19:28:14.1885791Z                          <#
2026-01-11T19:28:14.1886908Z                          .SYNOPSIS
2026-01-11T19:28:14.1887109Z                              Disables background UWP app activity.
2026-01-11T19:28:14.1887873Z                          .DESCRIPTION
2026-01-11T19:28:14.1888856Z                              Turns off background app access and related search toggles.
2026-01-11T19:28:14.1889351Z                          .OUTPUTS
2026-01-11T19:28:14.1890449Z                              None.
2026-01-11T19:28:14.1891105Z                          #>
2026-01-11T19:28:14.1892124Z                          try {
2026-01-11T19:28:14.1892844Z                              $path = "HKCU:\Software\Microsoft\Windows\CurrentVersion\BackgroundAccessApplications"
2026-01-11T19:28:14.1893012Z                              Backup-RegistryKey -Path $path
2026-01-11T19:28:14.1894278Z                              Set-RegistryValue -Path $path -Name "GlobalUserDisabled" -Value 1 -Type "DWORD"
2026-01-11T19:28:14.1894422Z                      
2026-01-11T19:28:14.1895701Z                              $searchPath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\Search"
2026-01-11T19:28:14.1896175Z                              Backup-RegistryKey -Path $searchPath
2026-01-11T19:28:14.1897324Z                              Set-RegistryValue -Path $searchPath -Name "BackgroundAppGlobalToggle" -Value 0 -Type 
2026-01-11T19:28:14.1897482Z                      "DWORD"
2026-01-11T19:28:14.1898267Z                      
2026-01-11T19:28:14.1899195Z                              Write-Log "Background Store apps disabled" "SUCCESS"
2026-01-11T19:28:14.1899502Z                          } catch {
2026-01-11T19:28:14.1900501Z                              Write-Log "Error disabling background apps: $_" "ERROR"
2026-01-11T19:28:14.1900806Z                              throw
2026-01-11T19:28:14.1901719Z                          }
2026-01-11T19:28:14.1901821Z                      }
2026-01-11T19:28:14.1903172Z                      
2026-01-11T19:28:14.1903639Z                      
2026-01-11T19:28:14.1904847Z                      function Apply-EdgeDebloat {
2026-01-11T19:28:14.1904981Z                          <#
2026-01-11T19:28:14.1906306Z                          .SYNOPSIS
2026-01-11T19:28:14.1906541Z                              Applies Microsoft Edge policy debloat settings.
2026-01-11T19:28:14.1907028Z                          .DESCRIPTION
2026-01-11T19:28:14.1908199Z                              Disables select Edge UI features and prompts via policy keys.
2026-01-11T19:28:14.1908331Z                          .OUTPUTS
2026-01-11T19:28:14.1909596Z                              None.
2026-01-11T19:28:14.1909710Z                          #>
2026-01-11T19:28:14.1910746Z                          try {
2026-01-11T19:28:14.1911294Z                              $edge = "HKLM:\SOFTWARE\Policies\Microsoft\Edge"
2026-01-11T19:28:14.1911791Z                              Backup-RegistryKey -Path $edge
2026-01-11T19:28:14.1913396Z                              Set-RegistryValue -Path $edge -Name "HideFirstRunExperience" -Value 1 -Type "DWORD"
2026-01-11T19:28:14.1913775Z                              Set-RegistryValue -Path $edge -Name "EdgeShoppingAssistantEnabled" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.1914081Z                              Set-RegistryValue -Path $edge -Name "WebWidgetAllowed" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.1915567Z                              Set-RegistryValue -Path $edge -Name "NewTabPageCompanyLogoVisible" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.1915837Z                              Write-Log "Applied Edge debloat policies" "SUCCESS"
2026-01-11T19:28:14.1915941Z                          } catch {
2026-01-11T19:28:14.1916147Z                              Write-Log "Error applying Edge debloat: $_" "ERROR"
2026-01-11T19:28:14.1916314Z                              throw
2026-01-11T19:28:14.1917172Z                          }
2026-01-11T19:28:14.1917933Z                      }
2026-01-11T19:28:14.1919018Z                      
2026-01-11T19:28:14.1919152Z                      
2026-01-11T19:28:14.1920012Z                      function Disable-Copilot {
2026-01-11T19:28:14.1921065Z                          <#
2026-01-11T19:28:14.1921805Z                          .SYNOPSIS
2026-01-11T19:28:14.1923069Z                              Disables Windows Copilot completely.
2026-01-11T19:28:14.1924181Z                          .DESCRIPTION
2026-01-11T19:28:14.1924515Z                              Applies 8 registry keys and removes Copilot AppX packages.
2026-01-11T19:28:14.1925796Z                          .OUTPUTS
2026-01-11T19:28:14.1926348Z                              None.
2026-01-11T19:28:14.1927338Z                          #>
2026-01-11T19:28:14.1927967Z                          try {
2026-01-11T19:28:14.1929126Z                              Write-Log "Disabling Copilot..." "INFO"
2026-01-11T19:28:14.1929229Z                      
2026-01-11T19:28:14.1930333Z                              # Policy keys (HKLM and HKCU) - most authoritative
2026-01-11T19:28:14.1930683Z                              $policyCopilotLM = "HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsCopilot"
2026-01-11T19:28:14.1931605Z                              Backup-RegistryKey -Path $policyCopilotLM
2026-01-11T19:28:14.1932945Z                              Set-RegistryValue -Path $policyCopilotLM -Name "TurnOffWindowsCopilot" -Value 1 -Type 
2026-01-11T19:28:14.1933028Z                      "DWORD"
2026-01-11T19:28:14.1933435Z                      
2026-01-11T19:28:14.1934908Z                              $policyCopilotCU = "HKCU:\Software\Policies\Microsoft\Windows\WindowsCopilot"
2026-01-11T19:28:14.1935080Z                              Backup-RegistryKey -Path $policyCopilotCU
2026-01-11T19:28:14.1936531Z                              Set-RegistryValue -Path $policyCopilotCU -Name "TurnOffWindowsCopilot" -Value 1 -Type 
2026-01-11T19:28:14.1936644Z                      "DWORD"
2026-01-11T19:28:14.1937540Z                      
2026-01-11T19:28:14.1937774Z                              # UI visibility - hide button from taskbar
2026-01-11T19:28:14.1939157Z                              $explorerAdvanced = "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced"
2026-01-11T19:28:14.1939309Z                              Backup-RegistryKey -Path $explorerAdvanced
2026-01-11T19:28:14.1940830Z                              Set-RegistryValue -Path $explorerAdvanced -Name "ShowCopilotButton" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.1940942Z                      
2026-01-11T19:28:14.1942064Z                              # Availability flags
2026-01-11T19:28:14.1942447Z                              $shellCopilot = "HKLM:\SOFTWARE\Microsoft\Windows\Shell\Copilot"
2026-01-11T19:28:14.1943715Z                              Backup-RegistryKey -Path $shellCopilot
2026-01-11T19:28:14.1944626Z                              Set-RegistryValue -Path $shellCopilot -Name "IsCopilotAvailable" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.1945055Z                              Set-RegistryValue -Path $shellCopilot -Name "CopilotDisabledReason" -Value 
2026-01-11T19:28:14.1945213Z                      "IsEnabledForGeographicRegionFailed" -Type "String"
2026-01-11T19:28:14.1946134Z                      
2026-01-11T19:28:14.1947084Z                              $windowsCopilot = "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsCopilot"
2026-01-11T19:28:14.1947747Z                              Backup-RegistryKey -Path $windowsCopilot
2026-01-11T19:28:14.1949049Z                              Set-RegistryValue -Path $windowsCopilot -Name "AllowCopilotRuntime" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.1949167Z                      
2026-01-11T19:28:14.1949534Z                              # Block shell extension
2026-01-11T19:28:14.1950985Z                              $blockedExtensions = "HKLM:\SOFTWARE\Microsoft\Windows\Shell Extensions\Blocked"
2026-01-11T19:28:14.1951243Z                              Backup-RegistryKey -Path $blockedExtensions
2026-01-11T19:28:14.1952623Z                              Set-RegistryValue -Path $blockedExtensions -Name "{CB3B0003-8088-4EDE-8769-8B354AB2FF8C}" 
2026-01-11T19:28:14.1952753Z                      -Value "" -Type "String"
2026-01-11T19:28:14.1953189Z                      
2026-01-11T19:28:14.1954297Z                              # BingChat eligibility
2026-01-11T19:28:14.1954692Z                              $bingChat = "HKLM:\SOFTWARE\Microsoft\Windows\Shell\Copilot\BingChat"
2026-01-11T19:28:14.1954884Z                              Backup-RegistryKey -Path $bingChat
2026-01-11T19:28:14.1956540Z                              Set-RegistryValue -Path $bingChat -Name "IsUserEligible" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.1956678Z                      
2026-01-11T19:28:14.1957608Z                              # Remove Copilot AppX packages
2026-01-11T19:28:14.1958302Z                              Write-Log "Removing Copilot packages..." "INFO"
2026-01-11T19:28:14.1960194Z                              Get-AppxPackage -AllUsers *Copilot* -ErrorAction SilentlyContinue | Remove-AppxPackage 
2026-01-11T19:28:14.1960418Z                      -AllUsers -ErrorAction SilentlyContinue
2026-01-11T19:28:14.1960828Z                              Get-AppxPackage -AllUsers Microsoft.MicrosoftOfficeHub -ErrorAction SilentlyContinue | 
2026-01-11T19:28:14.1961065Z                      Remove-AppxPackage -AllUsers -ErrorAction SilentlyContinue
2026-01-11T19:28:14.1961196Z                      
2026-01-11T19:28:14.1962513Z                              Write-Log "Copilot disabled and packages removed" "SUCCESS"
2026-01-11T19:28:14.1962667Z                          } catch {
2026-01-11T19:28:14.1963617Z                              Write-Log "Error disabling Copilot: $_" "ERROR"
2026-01-11T19:28:14.1963740Z                              throw
2026-01-11T19:28:14.1964837Z                          }
2026-01-11T19:28:14.1965216Z                      }
2026-01-11T19:28:14.1966157Z                      
2026-01-11T19:28:14.1966262Z                      
2026-01-11T19:28:14.1967383Z                      function Disable-Notifications {
2026-01-11T19:28:14.1967750Z                          <#
2026-01-11T19:28:14.1968696Z                          .SYNOPSIS
2026-01-11T19:28:14.1969349Z                              Disables Windows notification center and toast notifications.
2026-01-11T19:28:14.1969874Z                          .DESCRIPTION
2026-01-11T19:28:14.1970916Z                              Prevents popup distractions during gaming sessions.
2026-01-11T19:28:14.1972147Z                              Disables both the notification center and individual toast popups.
2026-01-11T19:28:14.1972303Z                          .PARAMETER Enable
2026-01-11T19:28:14.1972585Z                              When true, disables notifications.
2026-01-11T19:28:14.1973517Z                          .OUTPUTS
2026-01-11T19:28:14.1973661Z                              None.
2026-01-11T19:28:14.1974622Z                          #>
2026-01-11T19:28:14.1975053Z                          param(
2026-01-11T19:28:14.1976172Z                              [bool]$Enable = $true
2026-01-11T19:28:14.1976284Z                          )
2026-01-11T19:28:14.1977256Z                      
2026-01-11T19:28:14.1977748Z                          if (-not $Enable) {
2026-01-11T19:28:14.1979043Z                              Write-Log "Disable notifications: skipped" "INFO"
2026-01-11T19:28:14.1979179Z                              return
2026-01-11T19:28:14.1979961Z                          }
2026-01-11T19:28:14.1981158Z                      
2026-01-11T19:28:14.1982278Z                          try {
2026-01-11T19:28:14.1983148Z                              # Disable Notification Center
2026-01-11T19:28:14.1983460Z                              $notifPath = "HKCU:\Software\Policies\Microsoft\Windows\Explorer"
2026-01-11T19:28:14.1984365Z                              Backup-RegistryKey -Path $notifPath
2026-01-11T19:28:14.1985729Z                              Set-RegistryValue -Path $notifPath -Name "DisableNotificationCenter" -Value 1 -Type 
2026-01-11T19:28:14.1985801Z                      "DWORD"
2026-01-11T19:28:14.1986933Z                      
2026-01-11T19:28:14.1987135Z                              # Disable toast notifications
2026-01-11T19:28:14.1988516Z                              $toastPath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\PushNotifications"
2026-01-11T19:28:14.1988729Z                              Backup-RegistryKey -Path $toastPath
2026-01-11T19:28:14.1989558Z                              Set-RegistryValue -Path $toastPath -Name "ToastEnabled" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.1989928Z                      
2026-01-11T19:28:14.1990669Z                              # Disable lock screen notifications
2026-01-11T19:28:14.1992083Z                              $lockPath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\Notifications\Settings"
2026-01-11T19:28:14.1992293Z                              Backup-RegistryKey -Path $lockPath
2026-01-11T19:28:14.1993631Z                              Set-RegistryValue -Path $lockPath -Name "NOC_GLOBAL_SETTING_ALLOW_TOASTS_ABOVE_LOCK" 
2026-01-11T19:28:14.1993788Z                      -Value 0 -Type "DWORD"
2026-01-11T19:28:14.1994943Z                              Set-RegistryValue -Path $lockPath -Name 
2026-01-11T19:28:14.1995350Z                      "NOC_GLOBAL_SETTING_ALLOW_CRITICAL_TOASTS_ABOVE_LOCK" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.1995691Z                      
2026-01-11T19:28:14.1996925Z                              Write-Log "Disabled notifications (no popups during gaming)" "SUCCESS"
2026-01-11T19:28:14.1997283Z                          } catch {
2026-01-11T19:28:14.1998530Z                              Write-Log "Error disabling notifications: $_" "ERROR"
2026-01-11T19:28:14.1998645Z                          }
2026-01-11T19:28:14.2000119Z                      }
2026-01-11T19:28:14.2000490Z                      
2026-01-11T19:28:14.2000832Z                      
2026-01-11T19:28:14.2001990Z                      function Disable-PS7Telemetry {
2026-01-11T19:28:14.2002107Z                          <#
2026-01-11T19:28:14.2003144Z                          .SYNOPSIS
2026-01-11T19:28:14.2004054Z                              Disables PowerShell 7 telemetry collection.
2026-01-11T19:28:14.2004525Z                          .DESCRIPTION
2026-01-11T19:28:14.2005723Z                              Sets the POWERSHELL_TELEMETRY_OPTOUT environment variable.
2026-01-11T19:28:14.2006152Z                              Only relevant if PowerShell 7 is installed.
2026-01-11T19:28:14.2007085Z                          .PARAMETER Enable
2026-01-11T19:28:14.2007351Z                              When true, sets the opt-out environment variable.
2026-01-11T19:28:14.2008425Z                          .OUTPUTS
2026-01-11T19:28:14.2008546Z                              None.
2026-01-11T19:28:14.2009856Z                          #>
2026-01-11T19:28:14.2009976Z                          param(
2026-01-11T19:28:14.2011148Z                              [bool]$Enable = $true
2026-01-11T19:28:14.2011495Z                          )
2026-01-11T19:28:14.2012664Z                      
2026-01-11T19:28:14.2012838Z                          if (-not $Enable) {
2026-01-11T19:28:14.2013945Z                              Write-Log "Disable PS7 telemetry: skipped" "INFO"
2026-01-11T19:28:14.2014321Z                              return
2026-01-11T19:28:14.2015312Z                          }
2026-01-11T19:28:14.2015415Z                      
2026-01-11T19:28:14.2016634Z                          try {
2026-01-11T19:28:14.2017480Z                              # Check if PowerShell 7 is installed
2026-01-11T19:28:14.2018207Z                              $ps7Path = "$env:ProgramFiles\PowerShell\7\pwsh.exe"
2026-01-11T19:28:14.2019191Z                              if (-not (Test-Path $ps7Path)) {
2026-01-11T19:28:14.2019856Z                                  Write-Log "PowerShell 7 not installed - skipping telemetry opt-out" "INFO"
2026-01-11T19:28:14.2020629Z                                  return
2026-01-11T19:28:14.2021758Z                              }
2026-01-11T19:28:14.2022199Z                      
2026-01-11T19:28:14.2023352Z                              # Set environment variable to opt out of PS7 telemetry
2026-01-11T19:28:14.2023729Z                              [Environment]::SetEnvironmentVariable("POWERSHELL_TELEMETRY_OPTOUT", "1", "Machine")
2026-01-11T19:28:14.2024836Z                              Write-Log "Disabled PowerShell 7 telemetry (env var set)" "SUCCESS"
2026-01-11T19:28:14.2025191Z                          } catch {
2026-01-11T19:28:14.2025781Z                              Write-Log "Error disabling PS7 telemetry: $_" "ERROR"
2026-01-11T19:28:14.2026388Z                          }
2026-01-11T19:28:14.2027406Z                      }
2026-01-11T19:28:14.2027525Z                      
2026-01-11T19:28:14.2027873Z                      
2026-01-11T19:28:14.2029025Z                      function Disable-WPBT {
2026-01-11T19:28:14.2029141Z                          <#
2026-01-11T19:28:14.2030357Z                          .SYNOPSIS
2026-01-11T19:28:14.2030625Z                              Disables Windows Platform Binary Table (WPBT).
2026-01-11T19:28:14.2031497Z                          .DESCRIPTION
2026-01-11T19:28:14.2031743Z                              WPBT allows OEMs to inject software at boot time.
2026-01-11T19:28:14.2032978Z                              Disabling prevents manufacturer bloatware from auto-installing.
2026-01-11T19:28:14.2033110Z                          .PARAMETER Enable
2026-01-11T19:28:14.2034131Z                              When true, disables WPBT execution.
2026-01-11T19:28:14.2035149Z                          .OUTPUTS
2026-01-11T19:28:14.2035255Z                              None.
2026-01-11T19:28:14.2036334Z                          #>
2026-01-11T19:28:14.2036458Z                          param(
2026-01-11T19:28:14.2037645Z                              [bool]$Enable = $true
2026-01-11T19:28:14.2038008Z                          )
2026-01-11T19:28:14.2039248Z                      
2026-01-11T19:28:14.2040364Z                          if (-not $Enable) {
2026-01-11T19:28:14.2040600Z                              Write-Log "Disable WPBT: skipped" "INFO"
2026-01-11T19:28:14.2041693Z                              return
2026-01-11T19:28:14.2041792Z                          }
2026-01-11T19:28:14.2042505Z                      
2026-01-11T19:28:14.2043286Z                          try {
2026-01-11T19:28:14.2044322Z                              $wpbtPath = "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager"
2026-01-11T19:28:14.2044932Z                              Backup-RegistryKey -Path $wpbtPath
2026-01-11T19:28:14.2046295Z                              Set-RegistryValue -Path $wpbtPath -Name "DisableWpbtExecution" -Value 1 -Type "DWORD"
2026-01-11T19:28:14.2046408Z                      
2026-01-11T19:28:14.2047745Z                              Write-Log "Disabled WPBT (blocks OEM bloatware injection at boot)" "SUCCESS"
2026-01-11T19:28:14.2047856Z                          } catch {
2026-01-11T19:28:14.2048379Z                              Write-Log "Error disabling WPBT: $_" "ERROR"
2026-01-11T19:28:14.2049310Z                          }
2026-01-11T19:28:14.2050319Z                      }
2026-01-11T19:28:14.2050660Z                      
2026-01-11T19:28:14.2051761Z                      
2026-01-11T19:28:14.2051860Z                      
2026-01-11T19:28:14.2053281Z                      
2026-01-11T19:28:14.2053504Z                      function Invoke-PrivacyOptimizations {
2026-01-11T19:28:14.2054430Z                          <#
2026-01-11T19:28:14.2055244Z                          .SYNOPSIS
2026-01-11T19:28:14.2056211Z                              Applies selected privacy optimization tiers and extras.
2026-01-11T19:28:14.2056559Z                          .DESCRIPTION
2026-01-11T19:28:14.2057691Z                              Runs tiered privacy settings
2026-01-11T19:28:14.2058083Z                          .PARAMETER Tier1Safe
2026-01-11T19:28:14.2058909Z                              Applies safe privacy defaults when true.
2026-01-11T19:28:14.2059867Z                          .PARAMETER Tier2Moderate
2026-01-11T19:28:14.2060186Z                              Applies moderate privacy settings when true.
2026-01-11T19:28:14.2061280Z                          .PARAMETER Tier3Aggressive
2026-01-11T19:28:14.2061864Z                              Applies aggressive settings (breaks Xbox/Game Pass) when true.
2026-01-11T19:28:14.2062347Z                          .PARAMETER RemoveBloatware
2026-01-11T19:28:14.2063794Z                              Removes select built-in apps when true.
2026-01-11T19:28:14.2063976Z                          .PARAMETER RemoveXboxApps
2026-01-11T19:28:14.2064311Z                              Removes Xbox apps (breaks Game Pass) when true.
2026-01-11T19:28:14.2065294Z                          .PARAMETER BackgroundAppsOff
2026-01-11T19:28:14.2065494Z                              Disables background UWP apps when true.
2026-01-11T19:28:14.2066762Z                          .PARAMETER EdgeDebloat
2026-01-11T19:28:14.2066997Z                              Applies Edge policy debloat settings when true.
2026-01-11T19:28:14.2067822Z                          .PARAMETER DisableCopilot
2026-01-11T19:28:14.2068023Z                              Disables Windows Copilot when true.
2026-01-11T19:28:14.2069261Z                          .PARAMETER DisableNotifications
2026-01-11T19:28:14.2069460Z                              Disables notifications when true.
2026-01-11T19:28:14.2070592Z                          .PARAMETER DisablePS7Telemetry
2026-01-11T19:28:14.2070808Z                              Disables PowerShell 7 telemetry when true.
2026-01-11T19:28:14.2071961Z                          .PARAMETER DisableWPBT
2026-01-11T19:28:14.2072224Z                              Disables WPBT execution when true.
2026-01-11T19:28:14.2073008Z                          .OUTPUTS
2026-01-11T19:28:14.2074075Z                              None.
2026-01-11T19:28:14.2074258Z                          #>
2026-01-11T19:28:14.2075453Z                          param(
2026-01-11T19:28:14.2075874Z                              [bool]$Tier1Safe = $true,
2026-01-11T19:28:14.2077066Z                              [bool]$Tier2Moderate = $false,
2026-01-11T19:28:14.2077603Z                              [bool]$Tier3Aggressive = $false,
2026-01-11T19:28:14.2078392Z                              [bool]$RemoveBloatware = $true,
2026-01-11T19:28:14.2079256Z                              [bool]$RemoveXboxApps = $false,
2026-01-11T19:28:14.2080443Z                              [bool]$BackgroundAppsOff = $true,
2026-01-11T19:28:14.2081138Z                              [bool]$EdgeDebloat = $true,
2026-01-11T19:28:14.2081289Z                              [bool]$DisableCopilot = $true,
2026-01-11T19:28:14.2082542Z                              [bool]$DisableNotifications = $true,
2026-01-11T19:28:14.2082731Z                              [bool]$DisablePS7Telemetry = $true,
2026-01-11T19:28:14.2084189Z                              [bool]$DisableWPBT = $true
2026-01-11T19:28:14.2084310Z                          )
2026-01-11T19:28:14.2085408Z                      
2026-01-11T19:28:14.2086876Z                          Write-Log "Applying privacy optimizations..." "INFO"
2026-01-11T19:28:14.2087007Z                      
2026-01-11T19:28:14.2087151Z                          try {
2026-01-11T19:28:14.2087443Z                              if ($Tier1Safe) {
2026-01-11T19:28:14.2088677Z                                  Apply-PrivacyTier1Safe
2026-01-11T19:28:14.2088813Z                              }
2026-01-11T19:28:14.2089985Z                      
2026-01-11T19:28:14.2090866Z                              if ($Tier2Moderate) {
2026-01-11T19:28:14.2091753Z                                  Apply-PrivacyTier2Moderate
2026-01-11T19:28:14.2092146Z                              }
2026-01-11T19:28:14.2093172Z                      
2026-01-11T19:28:14.2093698Z                              if ($Tier3Aggressive) {
2026-01-11T19:28:14.2094519Z                                  Apply-PrivacyTier3Aggressive
2026-01-11T19:28:14.2094905Z                              }
2026-01-11T19:28:14.2095841Z                      
2026-01-11T19:28:14.2097071Z                              if ($RemoveBloatware) {
2026-01-11T19:28:14.2097250Z                                  Remove-Bloatware
2026-01-11T19:28:14.2098411Z                              }
2026-01-11T19:28:14.2098887Z                      
2026-01-11T19:28:14.2099873Z                              if ($RemoveXboxApps) {
2026-01-11T19:28:14.2100716Z                                  Remove-XboxApps
2026-01-11T19:28:14.2102085Z                              }
2026-01-11T19:28:14.2102214Z                      
2026-01-11T19:28:14.2102997Z                              if ($BackgroundAppsOff) {
2026-01-11T19:28:14.2103778Z                                  Set-BackgroundAppsOff
2026-01-11T19:28:14.2104773Z                              }
2026-01-11T19:28:14.2105527Z                      
2026-01-11T19:28:14.2106447Z                              if ($EdgeDebloat) {
2026-01-11T19:28:14.2107434Z                                  Apply-EdgeDebloat
2026-01-11T19:28:14.2107929Z                              }
2026-01-11T19:28:14.2108812Z                      
2026-01-11T19:28:14.2109129Z                              if ($DisableCopilot) {
2026-01-11T19:28:14.2110278Z                                  Disable-Copilot
2026-01-11T19:28:14.2110392Z                              }
2026-01-11T19:28:14.2111105Z                      
2026-01-11T19:28:14.2112374Z                              Disable-Notifications -Enable $DisableNotifications
2026-01-11T19:28:14.2112501Z                      
2026-01-11T19:28:14.2113711Z                              Disable-PS7Telemetry -Enable $DisablePS7Telemetry
2026-01-11T19:28:14.2114040Z                      
2026-01-11T19:28:14.2115231Z                              Disable-WPBT -Enable $DisableWPBT
2026-01-11T19:28:14.2115340Z                      
2026-01-11T19:28:14.2116628Z                              Write-Log "Privacy optimizations complete" "SUCCESS"
2026-01-11T19:28:14.2116959Z                              Write-Log "SmartScreen and Windows Update remain ENABLED (security)" "INFO"
2026-01-11T19:28:14.2118273Z                      
2026-01-11T19:28:14.2118435Z                          } catch {
2026-01-11T19:28:14.2120152Z                              Write-Log "Error applying privacy optimizations: $_" "ERROR"
2026-01-11T19:28:14.2120613Z                              throw
2026-01-11T19:28:14.2121310Z                          }
2026-01-11T19:28:14.2122347Z                      }
2026-01-11T19:28:14.2123111Z                      
2026-01-11T19:28:14.2123548Z                      
2026-01-11T19:28:14.2124626Z                      function Undo-PrivacyOptimizations {
2026-01-11T19:28:14.2124725Z                          <#
2026-01-11T19:28:14.2125806Z                          .SYNOPSIS
2026-01-11T19:28:14.2126132Z                              Reverts privacy-related changes.
2026-01-11T19:28:14.2127343Z                          .DESCRIPTION
2026-01-11T19:28:14.2128035Z                              Re-enables services and restores backed up registry values.
2026-01-11T19:28:14.2128365Z                          .OUTPUTS
2026-01-11T19:28:14.2129582Z                              None.
2026-01-11T19:28:14.2129720Z                          #>
2026-01-11T19:28:14.2130850Z                          Write-Log "Rolling back privacy optimizations..." "INFO"
2026-01-11T19:28:14.2130960Z                      
2026-01-11T19:28:14.2131815Z                          try {
2026-01-11T19:28:14.2132327Z                              $services = @("DiagTrack", "dmwappushservice", "SysMain", "XblAuthManager", 
2026-01-11T19:28:14.2133440Z                      "XblGameSave", "XboxGipSvc", "XboxNetApiSvc")
2026-01-11T19:28:14.2133616Z                              foreach ($serviceName in $services) {
2026-01-11T19:28:14.2134258Z                                  try {
2026-01-11T19:28:14.2135461Z                                      $service = Get-Service -Name $serviceName -ErrorAction SilentlyContinue
2026-01-11T19:28:14.2135637Z                                      if ($service) {
2026-01-11T19:28:14.2136767Z                                          Set-Service -Name $serviceName -StartupType Automatic -ErrorAction Stop
2026-01-11T19:28:14.2137272Z                                          Start-Service -Name $serviceName -ErrorAction SilentlyContinue
2026-01-11T19:28:14.2138643Z                                          Write-Log "Re-enabled service: $serviceName" "SUCCESS"
2026-01-11T19:28:14.2138752Z                                      }
2026-01-11T19:28:14.2138903Z                                  } catch {
2026-01-11T19:28:14.2140345Z                                      Write-Log "Error re-enabling service $serviceName : $_" "ERROR"
2026-01-11T19:28:14.2140482Z                                  }
2026-01-11T19:28:14.2141556Z                              }
2026-01-11T19:28:14.2141669Z                      
2026-01-11T19:28:14.2143178Z                              $paths = @(
2026-01-11T19:28:14.2143561Z                                  "HKCU:\Software\Microsoft\Windows\CurrentVersion\AdvertisingInfo",
2026-01-11T19:28:14.2144193Z                                  "HKLM:\SOFTWARE\Policies\Microsoft\Windows\AdvertisingInfo",
2026-01-11T19:28:14.2144771Z                                  "HKLM:\SOFTWARE\Policies\Microsoft\Windows\System",
2026-01-11T19:28:14.2145804Z                                  "HKLM:\SOFTWARE\Microsoft\WcmSvc\wifinetworkmanager\config",
2026-01-11T19:28:14.2146163Z                                  "HKCU:\Software\Microsoft\Siuf\Rules",
2026-01-11T19:28:14.2147326Z                                  "HKCU:\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager",
2026-01-11T19:28:14.2147525Z                                  "HKCU:\Software\Microsoft\Clipboard",
2026-01-11T19:28:14.2148341Z                                  "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\DataCollection",
2026-01-11T19:28:14.2148695Z                                  "HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting",
2026-01-11T19:28:14.2149329Z                                  "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\DeliveryOptimization\Config",
2026-01-11T19:28:14.2149771Z                                  "HKCU:\Software\Microsoft\Windows\CurrentVersion\BackgroundAccessApplications",
2026-01-11T19:28:14.2150910Z                                  "HKCU:\Software\Microsoft\Windows\CurrentVersion\Search",
2026-01-11T19:28:14.2151110Z                                  "HKLM:\SOFTWARE\Policies\Microsoft\Edge",
2026-01-11T19:28:14.2151733Z                                  "HKCU:\SOFTWARE\Microsoft\Windows\Shell\CopilotAI",
2026-01-11T19:28:14.2152724Z                                  "HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsCopilot"
2026-01-11T19:28:14.2153040Z                              )
2026-01-11T19:28:14.2153838Z                      
2026-01-11T19:28:14.2154655Z                              foreach ($path in $paths) {
2026-01-11T19:28:14.2156089Z                                  if (Restore-RegistryKey -Path $path) {
2026-01-11T19:28:14.2156341Z                                      Write-Log "Restored registry: $path" "SUCCESS"
2026-01-11T19:28:14.2156488Z                                  }
2026-01-11T19:28:14.2157763Z                              }
2026-01-11T19:28:14.2157882Z                      
2026-01-11T19:28:14.2159624Z                              Write-Log "Privacy optimization rollback complete" "SUCCESS"
2026-01-11T19:28:14.2159729Z                      
2026-01-11T19:28:14.2159816Z                          } catch {
2026-01-11T19:28:14.2160612Z                              Write-Log "Error during rollback: $_" "ERROR"
2026-01-11T19:28:14.2160996Z                              throw
2026-01-11T19:28:14.2162064Z                          }
2026-01-11T19:28:14.2162477Z                      }
2026-01-11T19:28:14.2163321Z                      
2026-01-11T19:28:14.2164250Z                      
2026-01-11T19:28:14.2164444Z                      Export-ModuleMember -Function @(
2026-01-11T19:28:14.2165422Z                          'Apply-PrivacyTier1Safe',
2026-01-11T19:28:14.2166321Z                          'Apply-PrivacyTier2Moderate',
2026-01-11T19:28:14.2167009Z                          'Apply-PrivacyTier3Aggressive',
2026-01-11T19:28:14.2167396Z                          'Remove-Bloatware',
2026-01-11T19:28:14.2167818Z                          'Remove-XboxApps',
2026-01-11T19:28:14.2168247Z                          'Set-BackgroundAppsOff',
2026-01-11T19:28:14.2168617Z                          'Apply-EdgeDebloat',
2026-01-11T19:28:14.2169039Z                          'Disable-Copilot',
2026-01-11T19:28:14.2169438Z                          'Disable-Notifications',
2026-01-11T19:28:14.2170252Z                          'Disable-PS7Telemetry',
2026-01-11T19:28:14.2170946Z                          'Disable-WPBT',
2026-01-11T19:28:14.2171829Z                          'Test-PrivacyOptimizations',
2026-01-11T19:28:14.2172663Z                          'Invoke-PrivacyOptimizations',
2026-01-11T19:28:14.2173583Z                          'Undo-PrivacyOptimizations'
2026-01-11T19:28:14.2174470Z                      )
2026-01-11T19:28:14.2175032Z [32;1mCleanBlock         : [0m
2026-01-11T19:28:14.2176135Z [32;1mDynamicParamBlock  : [0m
2026-01-11T19:28:14.2176486Z [32;1mScriptRequirements : [0mSystem.Management.Automation.Language.ScriptRequirements
2026-01-11T19:28:14.2179357Z [32;1mExtent             : [0m<#
2026-01-11T19:28:14.2179478Z                      .SYNOPSIS
2026-01-11T19:28:14.2180602Z                          Privacy-focused tweaks and optional debloat actions.
2026-01-11T19:28:14.2181247Z                      .DESCRIPTION
2026-01-11T19:28:14.2181681Z                          Applies tiered privacy settings, reduces telemetry, removes select UWP apps,
2026-01-11T19:28:14.2182312Z                          and configures Windows privacy-related policies.
2026-01-11T19:28:14.2183148Z                      .NOTES
2026-01-11T19:28:14.2184282Z                          Requires Administrator. Tier 3 and Xbox removals can break Game Pass features.
2026-01-11T19:28:14.2184404Z                      #>
2026-01-11T19:28:14.2185320Z                      #Requires -RunAsAdministrator
2026-01-11T19:28:14.2186252Z                      
2026-01-11T19:28:14.2186351Z                      
2026-01-11T19:28:14.2187508Z                      
2026-01-11T19:28:14.2187944Z                      Import-Module (Join-Path $PSScriptRoot "..\core\logger.psm1") -Force -Global
2026-01-11T19:28:14.2189273Z                      Import-Module (Join-Path $PSScriptRoot "..\core\registry.psm1") -Force -Global
2026-01-11T19:28:14.2189386Z                      
2026-01-11T19:28:14.2189764Z                      
2026-01-11T19:28:14.2190444Z                      # --- Helper Functions ---
2026-01-11T19:28:14.2191303Z                      
2026-01-11T19:28:14.2191486Z                      function Set-ScheduledTaskState {
2026-01-11T19:28:14.2192808Z                          <#
2026-01-11T19:28:14.2192954Z                          .SYNOPSIS
2026-01-11T19:28:14.2194103Z                              Enables or disables a Windows scheduled task.
2026-01-11T19:28:14.2194281Z                          .PARAMETER TaskPath
2026-01-11T19:28:14.2195628Z                              The full task path (e.g., "Microsoft\Windows\Autochk\Proxy").
2026-01-11T19:28:14.2195798Z                          .PARAMETER State
2026-01-11T19:28:14.2196913Z                              "Disabled" or "Enabled".
2026-01-11T19:28:14.2197032Z                          #>
2026-01-11T19:28:14.2197999Z                          param(
2026-01-11T19:28:14.2198904Z                              [string]$TaskPath,
2026-01-11T19:28:14.2199098Z                              [string]$State
2026-01-11T19:28:14.2199978Z                          )
2026-01-11T19:28:14.2200541Z                          try {
2026-01-11T19:28:14.2201155Z                              if ($State -eq 'Disabled') {
2026-01-11T19:28:14.2202292Z                                  Disable-ScheduledTask -TaskName $TaskPath -ErrorAction SilentlyContinue | Out-Null
2026-01-11T19:28:14.2202416Z                              } else {
2026-01-11T19:28:14.2203179Z                                  Enable-ScheduledTask -TaskName $TaskPath -ErrorAction SilentlyContinue | Out-Null
2026-01-11T19:28:14.2203458Z                              }
2026-01-11T19:28:14.2204241Z                              Write-Log "Scheduled task '$TaskPath' set to $State" "INFO"
2026-01-11T19:28:14.2204728Z                              return $true
2026-01-11T19:28:14.2205654Z                          } catch {
2026-01-11T19:28:14.2206052Z                              Write-Log "Failed to set task '$TaskPath': $($_.Exception.Message)" "WARNING"
2026-01-11T19:28:14.2206416Z                              return $false
2026-01-11T19:28:14.2206932Z                          }
2026-01-11T19:28:14.2207576Z                      }
2026-01-11T19:28:14.2208389Z                      
2026-01-11T19:28:14.2209452Z                      
2026-01-11T19:28:14.2209686Z                      function Test-PrivacyOptimizations {
2026-01-11T19:28:14.2210528Z                          <#
2026-01-11T19:28:14.2211366Z                          .SYNOPSIS
2026-01-11T19:28:14.2212240Z                              Verifies privacy-related registry values.
2026-01-11T19:28:14.2213196Z                          .DESCRIPTION
2026-01-11T19:28:14.2213918Z                              Checks advertising ID and activity history policies.
2026-01-11T19:28:14.2214800Z                          .OUTPUTS
2026-01-11T19:28:14.2215724Z                              [bool] True when checks pass, else false.
2026-01-11T19:28:14.2216225Z                          #>
2026-01-11T19:28:14.2217121Z                          $allPassed = $true
2026-01-11T19:28:14.2217513Z                      
2026-01-11T19:28:14.2219729Z                          Write-Log "Verifying privacy optimizations..." "INFO"
2026-01-11T19:28:14.2219883Z                      
2026-01-11T19:28:14.2220065Z                          $advID = Get-RegistryValue -Path 
2026-01-11T19:28:14.2220510Z                      "HKCU:\Software\Microsoft\Windows\CurrentVersion\AdvertisingInfo" -Name "Enabled"
2026-01-11T19:28:14.2221124Z                          if ($advID -eq 0) {
2026-01-11T19:28:14.2221577Z                              Write-Log "‚úì Advertising ID disabled" "SUCCESS"
2026-01-11T19:28:14.2222596Z                          } else {
2026-01-11T19:28:14.2223396Z                              Write-Log "‚úó Advertising ID not disabled" "ERROR"
2026-01-11T19:28:14.2223538Z                              $allPassed = $false
2026-01-11T19:28:14.2223765Z                          }
2026-01-11T19:28:14.2224691Z                      
2026-01-11T19:28:14.2226378Z                          $activityHistory = Get-RegistryValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\System" 
2026-01-11T19:28:14.2226808Z                      -Name "PublishUserActivities"
2026-01-11T19:28:14.2226968Z                          if ($activityHistory -eq 0) {
2026-01-11T19:28:14.2227395Z                              Write-Log "‚úì Activity History disabled" "SUCCESS"
2026-01-11T19:28:14.2228399Z                          }
2026-01-11T19:28:14.2228598Z                      
2026-01-11T19:28:14.2229126Z                          return $allPassed
2026-01-11T19:28:14.2230017Z                      }
2026-01-11T19:28:14.2230242Z                      
2026-01-11T19:28:14.2230792Z                      
2026-01-11T19:28:14.2231748Z                      
2026-01-11T19:28:14.2232429Z                      
2026-01-11T19:28:14.2233559Z                      function Apply-PrivacyTier1Safe {
2026-01-11T19:28:14.2233999Z                          <#
2026-01-11T19:28:14.2234629Z                          .SYNOPSIS
2026-01-11T19:28:14.2235497Z                              Applies Tier 1 privacy settings (safe defaults).
2026-01-11T19:28:14.2236423Z                          .DESCRIPTION
2026-01-11T19:28:14.2237783Z                              Disables advertising ID, activity history, WiFi Sense, feedback prompts,
2026-01-11T19:28:14.2238144Z                              spotlight content, cloud clipboard, and reduces telemetry level.
2026-01-11T19:28:14.2238761Z                          .OUTPUTS
2026-01-11T19:28:14.2238875Z                              None.
2026-01-11T19:28:14.2240289Z                          #>
2026-01-11T19:28:14.2240499Z                          try {
2026-01-11T19:28:14.2240993Z                              Write-Log "Applying Tier 1 safe privacy tweaks..." "INFO"
2026-01-11T19:28:14.2241094Z                      
2026-01-11T19:28:14.2242470Z                              $advPath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\AdvertisingInfo"
2026-01-11T19:28:14.2242670Z                              Backup-RegistryKey -Path $advPath
2026-01-11T19:28:14.2243276Z                              Set-RegistryValue -Path $advPath -Name "Enabled" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.2243647Z                      
2026-01-11T19:28:14.2245100Z                              $advPath2 = "HKLM:\SOFTWARE\Policies\Microsoft\Windows\AdvertisingInfo"
2026-01-11T19:28:14.2245306Z                              Backup-RegistryKey -Path $advPath2
2026-01-11T19:28:14.2245808Z                              Set-RegistryValue -Path $advPath2 -Name "DisabledByGroupPolicy" -Value 1 -Type "DWORD"
2026-01-11T19:28:14.2246664Z                              Write-Log "Disabled Advertising ID" "SUCCESS"
2026-01-11T19:28:14.2247099Z                      
2026-01-11T19:28:14.2248586Z                              $activityPath = "HKLM:\SOFTWARE\Policies\Microsoft\Windows\System"
2026-01-11T19:28:14.2248820Z                              Backup-RegistryKey -Path $activityPath
2026-01-11T19:28:14.2249330Z                              Set-RegistryValue -Path $activityPath -Name "PublishUserActivities" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.2249931Z                              Set-RegistryValue -Path $activityPath -Name "UploadUserActivities" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.2250506Z                              Write-Log "Disabled Activity History / Timeline" "SUCCESS"
2026-01-11T19:28:14.2250697Z                      
2026-01-11T19:28:14.2252259Z                              $wifiPath = "HKLM:\SOFTWARE\Microsoft\WcmSvc\wifinetworkmanager\config"
2026-01-11T19:28:14.2252465Z                              Backup-RegistryKey -Path $wifiPath
2026-01-11T19:28:14.2252987Z                              Set-RegistryValue -Path $wifiPath -Name "AutoConnectAllowedOEM" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.2253464Z                              Set-RegistryValue -Path $wifiPath -Name "WiFISenseAllowed" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.2253654Z                              Write-Log "Disabled WiFi Sense" "SUCCESS"
2026-01-11T19:28:14.2254354Z                      
2026-01-11T19:28:14.2255874Z                              $feedbackPath = "HKCU:\Software\Microsoft\Siuf\Rules"
2026-01-11T19:28:14.2256098Z                              Backup-RegistryKey -Path $feedbackPath
2026-01-11T19:28:14.2256512Z                              Set-RegistryValue -Path $feedbackPath -Name "NumberOfSIUFInPeriod" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.2256799Z                              Write-Log "Disabled Windows Feedback" "SUCCESS"
2026-01-11T19:28:14.2257934Z                      
2026-01-11T19:28:14.2258475Z                              $spotlightPath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager"
2026-01-11T19:28:14.2259318Z                              Backup-RegistryKey -Path $spotlightPath
2026-01-11T19:28:14.2260472Z                              Set-RegistryValue -Path $spotlightPath -Name "RotatingLockScreenEnabled" -Value 0 -Type 
2026-01-11T19:28:14.2260605Z                      "DWORD"
2026-01-11T19:28:14.2262042Z                              Set-RegistryValue -Path $spotlightPath -Name "RotatingLockScreenOverlayEnabled" -Value 0 
2026-01-11T19:28:14.2262134Z                      -Type "DWORD"
2026-01-11T19:28:14.2263579Z                              Set-RegistryValue -Path $spotlightPath -Name "SubscribedContent-338389Enabled" -Value 0 
2026-01-11T19:28:14.2263955Z                      -Type "DWORD"
2026-01-11T19:28:14.2264165Z                              Write-Log "Disabled Windows Spotlight" "SUCCESS"
2026-01-11T19:28:14.2265372Z                      
2026-01-11T19:28:14.2265653Z                              $clipboardPath = "HKCU:\Software\Microsoft\Clipboard"
2026-01-11T19:28:14.2266410Z                              Backup-RegistryKey -Path $clipboardPath
2026-01-11T19:28:14.2267785Z                              Set-RegistryValue -Path $clipboardPath -Name "EnableClipboardHistory" -Value 0 -Type 
2026-01-11T19:28:14.2267899Z                      "DWORD"
2026-01-11T19:28:14.2268165Z                              Write-Log "Disabled Cloud Clipboard Sync" "SUCCESS"
2026-01-11T19:28:14.2269232Z                      
2026-01-11T19:28:14.2269812Z                              $telemetryPath = "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\DataCollection"
2026-01-11T19:28:14.2270025Z                              Backup-RegistryKey -Path $telemetryPath
2026-01-11T19:28:14.2271454Z                              Set-RegistryValue -Path $telemetryPath -Name "AllowTelemetry" -Value 1 -Type "DWORD"  # 1 
2026-01-11T19:28:14.2271683Z                      = Security only (not 0 = off, requires Enterprise)
2026-01-11T19:28:14.2272508Z                              Set-RegistryValue -Path $telemetryPath -Name "DoNotShowFeedbackNotifications" -Value 1 
2026-01-11T19:28:14.2272633Z                      -Type "DWORD"
2026-01-11T19:28:14.2273619Z                              Write-Log "Reduced diagnostic data to minimum (Security level)" "SUCCESS"
2026-01-11T19:28:14.2273744Z                      
2026-01-11T19:28:14.2274650Z                              Write-Log "Tier 1 safe privacy tweaks complete" "SUCCESS"
2026-01-11T19:28:14.2275477Z                      
2026-01-11T19:28:14.2275592Z                          } catch {
2026-01-11T19:28:14.2277880Z                              Write-Log "Error applying Tier 1 privacy tweaks: $_" "ERROR"
2026-01-11T19:28:14.2277999Z                              throw
2026-01-11T19:28:14.2278083Z                          }
2026-01-11T19:28:14.2278988Z                      }
2026-01-11T19:28:14.2279741Z                      
2026-01-11T19:28:14.2280776Z                      
2026-01-11T19:28:14.2280863Z                      
2026-01-11T19:28:14.2281776Z                      
2026-01-11T19:28:14.2282623Z                      function Apply-PrivacyTier2Moderate {
2026-01-11T19:28:14.2283202Z                          <#
2026-01-11T19:28:14.2283385Z                          .SYNOPSIS
2026-01-11T19:28:14.2284603Z                              Applies Tier 2 privacy settings (moderate).
2026-01-11T19:28:14.2284977Z                          .DESCRIPTION
2026-01-11T19:28:14.2286669Z                              Disables telemetry scheduled tasks, services, and applies comprehensive
2026-01-11T19:28:14.2286840Z                              privacy registry settings.
2026-01-11T19:28:14.2286944Z                          .OUTPUTS
2026-01-11T19:28:14.2287586Z                              None.
2026-01-11T19:28:14.2288592Z                          #>
2026-01-11T19:28:14.2288802Z                          try {
2026-01-11T19:28:14.2289892Z                              Write-Log "Applying Tier 2 moderate privacy tweaks..." "INFO"
2026-01-11T19:28:14.2290486Z                      
2026-01-11T19:28:14.2291516Z                              # --- Disable telemetry scheduled tasks ---
2026-01-11T19:28:14.2291799Z                              Write-Log "Disabling telemetry scheduled tasks..." "INFO"
2026-01-11T19:28:14.2292073Z                              $telemetryTasks = @(
2026-01-11T19:28:14.2293568Z                                  "Microsoft\Windows\Autochk\Proxy",
2026-01-11T19:28:14.2294231Z                                  "Microsoft\Windows\Customer Experience Improvement Program\Consolidator",
2026-01-11T19:28:14.2294588Z                                  "Microsoft\Windows\Customer Experience Improvement Program\UsbCeip",
2026-01-11T19:28:14.2295317Z                                  "Microsoft\Windows\DiskDiagnostic\Microsoft-Windows-DiskDiagnosticDataCollector",
2026-01-11T19:28:14.2295549Z                                  "Microsoft\Windows\Feedback\Siuf\DmClient",
2026-01-11T19:28:14.2296522Z                                  "Microsoft\Windows\Feedback\Siuf\DmClientOnScenarioDownload",
2026-01-11T19:28:14.2297998Z                                  "Microsoft\Windows\Windows Error Reporting\QueueReporting",
2026-01-11T19:28:14.2298211Z                                  "Microsoft\Windows\Application Experience\MareBackup",
2026-01-11T19:28:14.2298879Z                                  "Microsoft\Windows\Application Experience\StartupAppTask",
2026-01-11T19:28:14.2299322Z                                  "Microsoft\Windows\Application Experience\PcaPatchDbTask"
2026-01-11T19:28:14.2299632Z                              )
2026-01-11T19:28:14.2300831Z                              foreach ($task in $telemetryTasks) {
2026-01-11T19:28:14.2301127Z                                  Set-ScheduledTaskState -TaskPath $task -State "Disabled"
2026-01-11T19:28:14.2301962Z                              }
2026-01-11T19:28:14.2302301Z                              Write-Log "Telemetry scheduled tasks disabled" "SUCCESS"
2026-01-11T19:28:14.2303204Z                      
2026-01-11T19:28:14.2304077Z                              # --- AllowTelemetry at both policy paths ---
2026-01-11T19:28:14.2305034Z                              $telemetryPath1 = 
2026-01-11T19:28:14.2305755Z                      "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\DataCollection"
2026-01-11T19:28:14.2306360Z                              Backup-RegistryKey -Path $telemetryPath1
2026-01-11T19:28:14.2306823Z                              Set-RegistryValue -Path $telemetryPath1 -Name "AllowTelemetry" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.2306989Z                      
2026-01-11T19:28:14.2308411Z                              $telemetryPath2 = "HKLM:\SOFTWARE\Policies\Microsoft\Windows\DataCollection"
2026-01-11T19:28:14.2308575Z                              Backup-RegistryKey -Path $telemetryPath2
2026-01-11T19:28:14.2309704Z                              Set-RegistryValue -Path $telemetryPath2 -Name "AllowTelemetry" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.2310163Z                              Set-RegistryValue -Path $telemetryPath2 -Name "DoNotShowFeedbackNotifications" -Value 1 
2026-01-11T19:28:14.2310275Z                      -Type "DWORD"
2026-01-11T19:28:14.2311263Z                              Write-Log "Telemetry set to minimum" "SUCCESS"
2026-01-11T19:28:14.2311719Z                      
2026-01-11T19:28:14.2313285Z                              # --- ContentDeliveryManager (content suggestions, pre-installed apps) ---
2026-01-11T19:28:14.2313776Z                              $cdmPath = "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager"
2026-01-11T19:28:14.2314002Z                              Backup-RegistryKey -Path $cdmPath
2026-01-11T19:28:14.2314486Z                              Set-RegistryValue -Path $cdmPath -Name "ContentDeliveryAllowed" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.2315170Z                              Set-RegistryValue -Path $cdmPath -Name "OemPreInstalledAppsEnabled" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.2315666Z                              Set-RegistryValue -Path $cdmPath -Name "PreInstalledAppsEnabled" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.2317042Z                              Set-RegistryValue -Path $cdmPath -Name "PreInstalledAppsEverEnabled" -Value 0 -Type 
2026-01-11T19:28:14.2317146Z                      "DWORD"
2026-01-11T19:28:14.2318471Z                              Set-RegistryValue -Path $cdmPath -Name "SilentInstalledAppsEnabled" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.2319398Z                              Set-RegistryValue -Path $cdmPath -Name "SubscribedContent-338387Enabled" -Value 0 -Type 
2026-01-11T19:28:14.2319826Z                      "DWORD"
2026-01-11T19:28:14.2320307Z                              Set-RegistryValue -Path $cdmPath -Name "SubscribedContent-338388Enabled" -Value 0 -Type 
2026-01-11T19:28:14.2320917Z                      "DWORD"
2026-01-11T19:28:14.2322337Z                              Set-RegistryValue -Path $cdmPath -Name "SubscribedContent-338389Enabled" -Value 0 -Type 
2026-01-11T19:28:14.2322688Z                      "DWORD"
2026-01-11T19:28:14.2323325Z                              Set-RegistryValue -Path $cdmPath -Name "SubscribedContent-353698Enabled" -Value 0 -Type 
2026-01-11T19:28:14.2323921Z                      "DWORD"
2026-01-11T19:28:14.2325491Z                              Set-RegistryValue -Path $cdmPath -Name "SystemPaneSuggestionsEnabled" -Value 0 -Type 
2026-01-11T19:28:14.2325611Z                      "DWORD"
2026-01-11T19:28:14.2325938Z                              Write-Log "Content delivery/suggestions disabled" "SUCCESS"
2026-01-11T19:28:14.2326819Z                      
2026-01-11T19:28:14.2327352Z                              # --- Feedback and advertising ---
2026-01-11T19:28:14.2327769Z                              $siufPath = "HKCU:\SOFTWARE\Microsoft\Siuf\Rules"
2026-01-11T19:28:14.2328804Z                              Backup-RegistryKey -Path $siufPath
2026-01-11T19:28:14.2329621Z                              Set-RegistryValue -Path $siufPath -Name "NumberOfSIUFInPeriod" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.2329753Z                      
2026-01-11T19:28:14.2330960Z                              $cloudPath = "HKCU:\SOFTWARE\Policies\Microsoft\Windows\CloudContent"
2026-01-11T19:28:14.2331180Z                              Backup-RegistryKey -Path $cloudPath
2026-01-11T19:28:14.2332455Z                              Set-RegistryValue -Path $cloudPath -Name "DisableTailoredExperiencesWithDiagnosticData" 
2026-01-11T19:28:14.2332637Z                      -Value 1 -Type "DWORD"
2026-01-11T19:28:14.2333628Z                      
2026-01-11T19:28:14.2334114Z                              $adInfoPath = "HKLM:\SOFTWARE\Policies\Microsoft\Windows\AdvertisingInfo"
2026-01-11T19:28:14.2334342Z                              Backup-RegistryKey -Path $adInfoPath
2026-01-11T19:28:14.2335779Z                              Set-RegistryValue -Path $adInfoPath -Name "DisabledByGroupPolicy" -Value 1 -Type "DWORD"
2026-01-11T19:28:14.2336038Z                              Write-Log "Feedback and advertising disabled" "SUCCESS"
2026-01-11T19:28:14.2336553Z                      
2026-01-11T19:28:14.2337280Z                              # --- Windows Error Reporting ---
2026-01-11T19:28:14.2338371Z                              $werPath = "HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting"
2026-01-11T19:28:14.2339126Z                              Backup-RegistryKey -Path $werPath
2026-01-11T19:28:14.2339556Z                              Set-RegistryValue -Path $werPath -Name "Disabled" -Value 1 -Type "DWORD"
2026-01-11T19:28:14.2340134Z                              Write-Log "Windows Error Reporting disabled" "SUCCESS"
2026-01-11T19:28:14.2340506Z                      
2026-01-11T19:28:14.2341396Z                              # --- Delivery Optimization P2P at both paths ---
2026-01-11T19:28:14.2342152Z                              $doPath1 = "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\DeliveryOptimization\Config"
2026-01-11T19:28:14.2342534Z                              Backup-RegistryKey -Path $doPath1
2026-01-11T19:28:14.2343189Z                              Set-RegistryValue -Path $doPath1 -Name "DODownloadMode" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.2343384Z                      
2026-01-11T19:28:14.2344767Z                              $doPath2 = "HKLM:\SOFTWARE\Policies\Microsoft\Windows\DeliveryOptimization"
2026-01-11T19:28:14.2344964Z                              Backup-RegistryKey -Path $doPath2
2026-01-11T19:28:14.2345686Z                              Set-RegistryValue -Path $doPath2 -Name "DODownloadMode" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.2346203Z                              Write-Log "Delivery Optimization P2P disabled" "SUCCESS"
2026-01-11T19:28:14.2346331Z                      
2026-01-11T19:28:14.2347277Z                              # --- Disable telemetry services ---
2026-01-11T19:28:14.2347538Z                              try {
2026-01-11T19:28:14.2348925Z                                  $service = Get-Service -Name "DiagTrack" -ErrorAction SilentlyContinue
2026-01-11T19:28:14.2349097Z                                  if ($service) {
2026-01-11T19:28:14.2350352Z                                      Stop-Service -Name "DiagTrack" -Force -ErrorAction SilentlyContinue
2026-01-11T19:28:14.2350850Z                                      Set-Service -Name "DiagTrack" -StartupType Disabled -ErrorAction SilentlyContinue
2026-01-11T19:28:14.2351076Z                                      Write-Log "Disabled DiagTrack service" "SUCCESS"
2026-01-11T19:28:14.2351941Z                                  }
2026-01-11T19:28:14.2352697Z                              } catch {
2026-01-11T19:28:14.2353256Z                                  Write-Log "Error disabling DiagTrack: $_" "WARNING"
2026-01-11T19:28:14.2354068Z                              }
2026-01-11T19:28:14.2354803Z                      
2026-01-11T19:28:14.2354970Z                              try {
2026-01-11T19:28:14.2356492Z                                  $service = Get-Service -Name "dmwappushservice" -ErrorAction SilentlyContinue
2026-01-11T19:28:14.2356646Z                                  if ($service) {
2026-01-11T19:28:14.2357964Z                                      Stop-Service -Name "dmwappushservice" -Force -ErrorAction SilentlyContinue
2026-01-11T19:28:14.2358438Z                                      Set-Service -Name "dmwappushservice" -StartupType Disabled -ErrorAction 
2026-01-11T19:28:14.2359246Z                      SilentlyContinue
2026-01-11T19:28:14.2360262Z                                      Write-Log "Disabled dmwappushservice" "SUCCESS"
2026-01-11T19:28:14.2360887Z                                  }
2026-01-11T19:28:14.2362064Z                              } catch {
2026-01-11T19:28:14.2362736Z                                  Write-Log "Error disabling dmwappushservice: $_" "WARNING"
2026-01-11T19:28:14.2362937Z                              }
2026-01-11T19:28:14.2364178Z                      
2026-01-11T19:28:14.2365544Z                              Write-Log "Tier 2 privacy tweaks complete (tasks + registry + services)" "SUCCESS"
2026-01-11T19:28:14.2365646Z                      
2026-01-11T19:28:14.2366286Z                          } catch {
2026-01-11T19:28:14.2366584Z                              Write-Log "Error applying Tier 2 privacy tweaks: $_" "ERROR"
2026-01-11T19:28:14.2367138Z                              throw
2026-01-11T19:28:14.2367471Z                          }
2026-01-11T19:28:14.2368527Z                      }
2026-01-11T19:28:14.2368747Z                      
2026-01-11T19:28:14.2369925Z                      
2026-01-11T19:28:14.2370134Z                      
2026-01-11T19:28:14.2371413Z                      
2026-01-11T19:28:14.2371644Z                      function Apply-PrivacyTier3Aggressive {
2026-01-11T19:28:14.2372904Z                          <#
2026-01-11T19:28:14.2373040Z                          .SYNOPSIS
2026-01-11T19:28:14.2374107Z                              Applies Tier 3 privacy settings (aggressive).
2026-01-11T19:28:14.2374223Z                          .DESCRIPTION
2026-01-11T19:28:14.2375648Z                              Disables Xbox/Game Pass services and other components that can break
2026-01-11T19:28:14.2375840Z                              Microsoft gaming features.
2026-01-11T19:28:14.2376842Z                          .OUTPUTS
2026-01-11T19:28:14.2377646Z                              None.
2026-01-11T19:28:14.2378500Z                          #>
2026-01-11T19:28:14.2378628Z                          try {
2026-01-11T19:28:14.2380381Z                              Write-Log "Applying Tier 3 aggressive privacy tweaks (opt-in, BREAKS features)..." "INFO"
2026-01-11T19:28:14.2382649Z                              Write-Log "WARNING: This will BREAK Game Pass and Xbox app functionality!" "ERROR"
2026-01-11T19:28:14.2382906Z                      
2026-01-11T19:28:14.2383061Z                              $xboxServices = @(
2026-01-11T19:28:14.2383198Z                                  "XblAuthManager",
2026-01-11T19:28:14.2383326Z                                  "XblGameSave",
2026-01-11T19:28:14.2383456Z                                  "XboxGipSvc",
2026-01-11T19:28:14.2383599Z                                  "XboxNetApiSvc"
2026-01-11T19:28:14.2383695Z                              )
2026-01-11T19:28:14.2383787Z                      
2026-01-11T19:28:14.2384508Z                              foreach ($serviceName in $xboxServices) {
2026-01-11T19:28:14.2384630Z                                  try {
2026-01-11T19:28:14.2386149Z                                      $service = Get-Service -Name $serviceName -ErrorAction SilentlyContinue
2026-01-11T19:28:14.2386316Z                                      if ($service) {
2026-01-11T19:28:14.2386964Z                                          Stop-Service -Name $serviceName -Force -ErrorAction Stop
2026-01-11T19:28:14.2387731Z                                          Set-Service -Name $serviceName -StartupType Disabled -ErrorAction Stop
2026-01-11T19:28:14.2388259Z                                          Write-Log "Disabled Xbox service: $serviceName (BREAKS Game Pass)" "SUCCESS"
2026-01-11T19:28:14.2389182Z                                      }
2026-01-11T19:28:14.2389585Z                                  } catch {
2026-01-11T19:28:14.2390811Z                                      Write-Log "Error disabling Xbox service $serviceName : $_" "ERROR"
2026-01-11T19:28:14.2390921Z                                  }
2026-01-11T19:28:14.2391198Z                              }
2026-01-11T19:28:14.2392032Z                      
2026-01-11T19:28:14.2393741Z                              Write-Log "Tier 3 aggressive privacy tweaks complete (Game Pass BROKEN)" "SUCCESS"
2026-01-11T19:28:14.2393875Z                      
2026-01-11T19:28:14.2394022Z                          } catch {
2026-01-11T19:28:14.2395250Z                              Write-Log "Error applying Tier 3 privacy tweaks: $_" "ERROR"
2026-01-11T19:28:14.2395390Z                              throw
2026-01-11T19:28:14.2396510Z                          }
2026-01-11T19:28:14.2396616Z                      }
2026-01-11T19:28:14.2398010Z                      
2026-01-11T19:28:14.2398107Z                      
2026-01-11T19:28:14.2399045Z                      
2026-01-11T19:28:14.2399482Z                      
2026-01-11T19:28:14.2401078Z                      function Remove-Bloatware {
2026-01-11T19:28:14.2401203Z                          <#
2026-01-11T19:28:14.2401333Z                          .SYNOPSIS
2026-01-11T19:28:14.2402567Z                              Removes selected built-in UWP apps.
2026-01-11T19:28:14.2403000Z                          .DESCRIPTION
2026-01-11T19:28:14.2404206Z                              Uninstalls a curated list of consumer apps for a leaner system.
2026-01-11T19:28:14.2404546Z                          .OUTPUTS
2026-01-11T19:28:14.2405571Z                              None.
2026-01-11T19:28:14.2406400Z                          #>
2026-01-11T19:28:14.2407561Z                          try {
2026-01-11T19:28:14.2407820Z                              Write-Log "Removing UWP bloatware..." "INFO"
2026-01-11T19:28:14.2408635Z                      
2026-01-11T19:28:14.2409496Z                              $appsToRemove = @(
2026-01-11T19:28:14.2410305Z                                  "Microsoft.GetHelp",
2026-01-11T19:28:14.2410727Z                                  "Microsoft.Getstarted",
2026-01-11T19:28:14.2411701Z                                  "Microsoft.Microsoft3DViewer",
2026-01-11T19:28:14.2411932Z                                  "Microsoft.MicrosoftOfficeHub",
2026-01-11T19:28:14.2412881Z                                  "Microsoft.MicrosoftSolitaireCollection",
2026-01-11T19:28:14.2413129Z                                  "Microsoft.MixedReality.Portal",
2026-01-11T19:28:14.2414153Z                                  "Microsoft.People",
2026-01-11T19:28:14.2414319Z                                  "Microsoft.SkypeApp",
2026-01-11T19:28:14.2415224Z                                  "Microsoft.YourPhone",
2026-01-11T19:28:14.2416308Z                                  "Microsoft.ZuneMusic",
2026-01-11T19:28:14.2416713Z                                  "Microsoft.ZuneVideo"
2026-01-11T19:28:14.2417059Z                              )
2026-01-11T19:28:14.2418135Z                      
2026-01-11T19:28:14.2418333Z                              $removed = 0
2026-01-11T19:28:14.2419837Z                              foreach ($app in $appsToRemove) {
2026-01-11T19:28:14.2420280Z                                  try {
2026-01-11T19:28:14.2421484Z                                      $package = Get-AppxPackage -Name $app -ErrorAction SilentlyContinue
2026-01-11T19:28:14.2421911Z                                      if ($package) {
2026-01-11T19:28:14.2423011Z                                          Remove-AppxPackage -Package $package.PackageFullName -ErrorAction Stop
2026-01-11T19:28:14.2423204Z                                          Write-Log "Removed app: $app" "SUCCESS"
2026-01-11T19:28:14.2423322Z                                          $removed++
2026-01-11T19:28:14.2423971Z                                      }
2026-01-11T19:28:14.2424074Z                                  } catch {
2026-01-11T19:28:14.2425429Z                                      Write-Log "Error removing app $app : $_" "ERROR"
2026-01-11T19:28:14.2425819Z                                  }
2026-01-11T19:28:14.2426596Z                              }
2026-01-11T19:28:14.2427623Z                      
2026-01-11T19:28:14.2428013Z                              Write-Log "Bloatware removal complete: $removed apps removed" "SUCCESS"
2026-01-11T19:28:14.2428533Z                      
2026-01-11T19:28:14.2429413Z                          } catch {
2026-01-11T19:28:14.2429637Z                              Write-Log "Error removing bloatware: $_" "ERROR"
2026-01-11T19:28:14.2430852Z                              throw
2026-01-11T19:28:14.2430990Z                          }
2026-01-11T19:28:14.2432169Z                      }
2026-01-11T19:28:14.2432273Z                      
2026-01-11T19:28:14.2433405Z                      
2026-01-11T19:28:14.2434432Z                      function Remove-XboxApps {
2026-01-11T19:28:14.2435489Z                          <#
2026-01-11T19:28:14.2436157Z                          .SYNOPSIS
2026-01-11T19:28:14.2439250Z                              Removes Xbox-related UWP apps.
2026-01-11T19:28:14.2439427Z                          .DESCRIPTION
2026-01-11T19:28:14.2440009Z                              Uninstalls Xbox UWP apps. This breaks Game Pass and Xbox app features.
2026-01-11T19:28:14.2440148Z                          .OUTPUTS
2026-01-11T19:28:14.2440250Z                              None.
2026-01-11T19:28:14.2440755Z                          #>
2026-01-11T19:28:14.2441919Z                          try {
2026-01-11T19:28:14.2442232Z                              Write-Log "Removing Xbox UWP apps (BREAKS Game Pass)..." "INFO"
2026-01-11T19:28:14.2442792Z                      
2026-01-11T19:28:14.2443858Z                              $xboxApps = @(
2026-01-11T19:28:14.2444570Z                                  "Microsoft.XboxApp",
2026-01-11T19:28:14.2445828Z                                  "Microsoft.XboxGameCallableUI",
2026-01-11T19:28:14.2446049Z                                  "Microsoft.XboxGamingOverlay",
2026-01-11T19:28:14.2446351Z                                  "Microsoft.XboxIdentityProvider",
2026-01-11T19:28:14.2447543Z                                  "Microsoft.XboxSpeechToTextOverlay",
2026-01-11T19:28:14.2447993Z                                  "Microsoft.Xbox.TCUI"
2026-01-11T19:28:14.2448320Z                              )
2026-01-11T19:28:14.2449501Z                      
2026-01-11T19:28:14.2449993Z                              $removed = 0
2026-01-11T19:28:14.2450938Z                              foreach ($app in $xboxApps) {
2026-01-11T19:28:14.2451403Z                                  try {
2026-01-11T19:28:14.2452560Z                                      $package = Get-AppxPackage -Name $app -ErrorAction SilentlyContinue
2026-01-11T19:28:14.2452889Z                                      if ($package) {
2026-01-11T19:28:14.2454248Z                                          Remove-AppxPackage -Package $package.PackageFullName -ErrorAction Stop
2026-01-11T19:28:14.2454594Z                                          Write-Log "Removed Xbox app: $app (Game Pass BROKEN)" "SUCCESS"
2026-01-11T19:28:14.2454983Z                                          $removed++
2026-01-11T19:28:14.2455590Z                                      }
2026-01-11T19:28:14.2456494Z                                  } catch {
2026-01-11T19:28:14.2457648Z                                      Write-Log "Error removing Xbox app $app : $_" "ERROR"
2026-01-11T19:28:14.2457978Z                                  }
2026-01-11T19:28:14.2458893Z                              }
2026-01-11T19:28:14.2458991Z                      
2026-01-11T19:28:14.2459840Z                              Write-Log "Xbox app removal complete: $removed apps removed (Game Pass BROKEN)" "SUCCESS"
2026-01-11T19:28:14.2460370Z                      
2026-01-11T19:28:14.2461413Z                          } catch {
2026-01-11T19:28:14.2462281Z                              Write-Log "Error removing Xbox apps: $_" "ERROR"
2026-01-11T19:28:14.2462939Z                              throw
2026-01-11T19:28:14.2463981Z                          }
2026-01-11T19:28:14.2464110Z                      }
2026-01-11T19:28:14.2465159Z                      
2026-01-11T19:28:14.2465951Z                      
2026-01-11T19:28:14.2466801Z                      
2026-01-11T19:28:14.2467748Z                      
2026-01-11T19:28:14.2468023Z                      function Set-BackgroundAppsOff {
2026-01-11T19:28:14.2469032Z                          <#
2026-01-11T19:28:14.2469487Z                          .SYNOPSIS
2026-01-11T19:28:14.2470412Z                              Disables background UWP app activity.
2026-01-11T19:28:14.2471105Z                          .DESCRIPTION
2026-01-11T19:28:14.2472126Z                              Turns off background app access and related search toggles.
2026-01-11T19:28:14.2472744Z                          .OUTPUTS
2026-01-11T19:28:14.2473624Z                              None.
2026-01-11T19:28:14.2474070Z                          #>
2026-01-11T19:28:14.2474542Z                          try {
2026-01-11T19:28:14.2476066Z                              $path = "HKCU:\Software\Microsoft\Windows\CurrentVersion\BackgroundAccessApplications"
2026-01-11T19:28:14.2476369Z                              Backup-RegistryKey -Path $path
2026-01-11T19:28:14.2476782Z                              Set-RegistryValue -Path $path -Name "GlobalUserDisabled" -Value 1 -Type "DWORD"
2026-01-11T19:28:14.2477486Z                      
2026-01-11T19:28:14.2478581Z                              $searchPath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\Search"
2026-01-11T19:28:14.2479031Z                              Backup-RegistryKey -Path $searchPath
2026-01-11T19:28:14.2480587Z                              Set-RegistryValue -Path $searchPath -Name "BackgroundAppGlobalToggle" -Value 0 -Type 
2026-01-11T19:28:14.2480697Z                      "DWORD"
2026-01-11T19:28:14.2480790Z                      
2026-01-11T19:28:14.2481714Z                              Write-Log "Background Store apps disabled" "SUCCESS"
2026-01-11T19:28:14.2482609Z                          } catch {
2026-01-11T19:28:14.2482961Z                              Write-Log "Error disabling background apps: $_" "ERROR"
2026-01-11T19:28:14.2484161Z                              throw
2026-01-11T19:28:14.2484803Z                          }
2026-01-11T19:28:14.2485799Z                      }
2026-01-11T19:28:14.2486746Z                      
2026-01-11T19:28:14.2487192Z                      
2026-01-11T19:28:14.2488271Z                      function Apply-EdgeDebloat {
2026-01-11T19:28:14.2488381Z                          <#
2026-01-11T19:28:14.2489524Z                          .SYNOPSIS
2026-01-11T19:28:14.2489815Z                              Applies Microsoft Edge policy debloat settings.
2026-01-11T19:28:14.2490523Z                          .DESCRIPTION
2026-01-11T19:28:14.2491580Z                              Disables select Edge UI features and prompts via policy keys.
2026-01-11T19:28:14.2492033Z                          .OUTPUTS
2026-01-11T19:28:14.2492950Z                              None.
2026-01-11T19:28:14.2493067Z                          #>
2026-01-11T19:28:14.2494127Z                          try {
2026-01-11T19:28:14.2494466Z                              $edge = "HKLM:\SOFTWARE\Policies\Microsoft\Edge"
2026-01-11T19:28:14.2495385Z                              Backup-RegistryKey -Path $edge
2026-01-11T19:28:14.2496272Z                              Set-RegistryValue -Path $edge -Name "HideFirstRunExperience" -Value 1 -Type "DWORD"
2026-01-11T19:28:14.2496909Z                              Set-RegistryValue -Path $edge -Name "EdgeShoppingAssistantEnabled" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.2498165Z                              Set-RegistryValue -Path $edge -Name "WebWidgetAllowed" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.2498788Z                              Set-RegistryValue -Path $edge -Name "NewTabPageCompanyLogoVisible" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.2499041Z                              Write-Log "Applied Edge debloat policies" "SUCCESS"
2026-01-11T19:28:14.2499137Z                          } catch {
2026-01-11T19:28:14.2499408Z                              Write-Log "Error applying Edge debloat: $_" "ERROR"
2026-01-11T19:28:14.2499794Z                              throw
2026-01-11T19:28:14.2500443Z                          }
2026-01-11T19:28:14.2501336Z                      }
2026-01-11T19:28:14.2502237Z                      
2026-01-11T19:28:14.2502347Z                      
2026-01-11T19:28:14.2503138Z                      function Disable-Copilot {
2026-01-11T19:28:14.2503882Z                          <#
2026-01-11T19:28:14.2505006Z                          .SYNOPSIS
2026-01-11T19:28:14.2505189Z                              Disables Windows Copilot completely.
2026-01-11T19:28:14.2506262Z                          .DESCRIPTION
2026-01-11T19:28:14.2506801Z                              Applies 8 registry keys and removes Copilot AppX packages.
2026-01-11T19:28:14.2507306Z                          .OUTPUTS
2026-01-11T19:28:14.2507413Z                              None.
2026-01-11T19:28:14.2508495Z                          #>
2026-01-11T19:28:14.2508617Z                          try {
2026-01-11T19:28:14.2509637Z                              Write-Log "Disabling Copilot..." "INFO"
2026-01-11T19:28:14.2509982Z                      
2026-01-11T19:28:14.2511410Z                              # Policy keys (HKLM and HKCU) - most authoritative
2026-01-11T19:28:14.2511879Z                              $policyCopilotLM = "HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsCopilot"
2026-01-11T19:28:14.2512037Z                              Backup-RegistryKey -Path $policyCopilotLM
2026-01-11T19:28:14.2513486Z                              Set-RegistryValue -Path $policyCopilotLM -Name "TurnOffWindowsCopilot" -Value 1 -Type 
2026-01-11T19:28:14.2513599Z                      "DWORD"
2026-01-11T19:28:14.2514409Z                      
2026-01-11T19:28:14.2515799Z                              $policyCopilotCU = "HKCU:\Software\Policies\Microsoft\Windows\WindowsCopilot"
2026-01-11T19:28:14.2516380Z                              Backup-RegistryKey -Path $policyCopilotCU
2026-01-11T19:28:14.2517369Z                              Set-RegistryValue -Path $policyCopilotCU -Name "TurnOffWindowsCopilot" -Value 1 -Type 
2026-01-11T19:28:14.2517482Z                      "DWORD"
2026-01-11T19:28:14.2517573Z                      
2026-01-11T19:28:14.2517743Z                              # UI visibility - hide button from taskbar
2026-01-11T19:28:14.2518830Z                              $explorerAdvanced = "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced"
2026-01-11T19:28:14.2519086Z                              Backup-RegistryKey -Path $explorerAdvanced
2026-01-11T19:28:14.2519906Z                              Set-RegistryValue -Path $explorerAdvanced -Name "ShowCopilotButton" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.2520303Z                      
2026-01-11T19:28:14.2521465Z                              # Availability flags
2026-01-11T19:28:14.2522148Z                              $shellCopilot = "HKLM:\SOFTWARE\Microsoft\Windows\Shell\Copilot"
2026-01-11T19:28:14.2522391Z                              Backup-RegistryKey -Path $shellCopilot
2026-01-11T19:28:14.2523237Z                              Set-RegistryValue -Path $shellCopilot -Name "IsCopilotAvailable" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.2523652Z                              Set-RegistryValue -Path $shellCopilot -Name "CopilotDisabledReason" -Value 
2026-01-11T19:28:14.2523913Z                      "IsEnabledForGeographicRegionFailed" -Type "String"
2026-01-11T19:28:14.2524014Z                      
2026-01-11T19:28:14.2524449Z                              $windowsCopilot = "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsCopilot"
2026-01-11T19:28:14.2524695Z                              Backup-RegistryKey -Path $windowsCopilot
2026-01-11T19:28:14.2526108Z                              Set-RegistryValue -Path $windowsCopilot -Name "AllowCopilotRuntime" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.2526217Z                      
2026-01-11T19:28:14.2527092Z                              # Block shell extension
2026-01-11T19:28:14.2527543Z                              $blockedExtensions = "HKLM:\SOFTWARE\Microsoft\Windows\Shell Extensions\Blocked"
2026-01-11T19:28:14.2528408Z                              Backup-RegistryKey -Path $blockedExtensions
2026-01-11T19:28:14.2529848Z                              Set-RegistryValue -Path $blockedExtensions -Name "{CB3B0003-8088-4EDE-8769-8B354AB2FF8C}" 
2026-01-11T19:28:14.2529999Z                      -Value "" -Type "String"
2026-01-11T19:28:14.2530104Z                      
2026-01-11T19:28:14.2531534Z                              # BingChat eligibility
2026-01-11T19:28:14.2531924Z                              $bingChat = "HKLM:\SOFTWARE\Microsoft\Windows\Shell\Copilot\BingChat"
2026-01-11T19:28:14.2532450Z                              Backup-RegistryKey -Path $bingChat
2026-01-11T19:28:14.2532892Z                              Set-RegistryValue -Path $bingChat -Name "IsUserEligible" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.2533803Z                      
2026-01-11T19:28:14.2534485Z                              # Remove Copilot AppX packages
2026-01-11T19:28:14.2535079Z                              Write-Log "Removing Copilot packages..." "INFO"
2026-01-11T19:28:14.2535709Z                              Get-AppxPackage -AllUsers *Copilot* -ErrorAction SilentlyContinue | Remove-AppxPackage 
2026-01-11T19:28:14.2536652Z                      -AllUsers -ErrorAction SilentlyContinue
2026-01-11T19:28:14.2538227Z                              Get-AppxPackage -AllUsers Microsoft.MicrosoftOfficeHub -ErrorAction SilentlyContinue | 
2026-01-11T19:28:14.2538491Z                      Remove-AppxPackage -AllUsers -ErrorAction SilentlyContinue
2026-01-11T19:28:14.2538591Z                      
2026-01-11T19:28:14.2539181Z                              Write-Log "Copilot disabled and packages removed" "SUCCESS"
2026-01-11T19:28:14.2540044Z                          } catch {
2026-01-11T19:28:14.2540562Z                              Write-Log "Error disabling Copilot: $_" "ERROR"
2026-01-11T19:28:14.2541571Z                              throw
2026-01-11T19:28:14.2541682Z                          }
2026-01-11T19:28:14.2542779Z                      }
2026-01-11T19:28:14.2543069Z                      
2026-01-11T19:28:14.2544201Z                      
2026-01-11T19:28:14.2545111Z                      function Disable-Notifications {
2026-01-11T19:28:14.2545611Z                          <#
2026-01-11T19:28:14.2546581Z                          .SYNOPSIS
2026-01-11T19:28:14.2547014Z                              Disables Windows notification center and toast notifications.
2026-01-11T19:28:14.2547885Z                          .DESCRIPTION
2026-01-11T19:28:14.2548852Z                              Prevents popup distractions during gaming sessions.
2026-01-11T19:28:14.2549501Z                              Disables both the notification center and individual toast popups.
2026-01-11T19:28:14.2549917Z                          .PARAMETER Enable
2026-01-11T19:28:14.2551171Z                              When true, disables notifications.
2026-01-11T19:28:14.2551286Z                          .OUTPUTS
2026-01-11T19:28:14.2552187Z                              None.
2026-01-11T19:28:14.2552918Z                          #>
2026-01-11T19:28:14.2553279Z                          param(
2026-01-11T19:28:14.2554506Z                              [bool]$Enable = $true
2026-01-11T19:28:14.2554623Z                          )
2026-01-11T19:28:14.2555422Z                      
2026-01-11T19:28:14.2555640Z                          if (-not $Enable) {
2026-01-11T19:28:14.2557576Z                              Write-Log "Disable notifications: skipped" "INFO"
2026-01-11T19:28:14.2558003Z                              return
2026-01-11T19:28:14.2559048Z                          }
2026-01-11T19:28:14.2559827Z                      
2026-01-11T19:28:14.2560650Z                          try {
2026-01-11T19:28:14.2561744Z                              # Disable Notification Center
2026-01-11T19:28:14.2562039Z                              $notifPath = "HKCU:\Software\Policies\Microsoft\Windows\Explorer"
2026-01-11T19:28:14.2563039Z                              Backup-RegistryKey -Path $notifPath
2026-01-11T19:28:14.2563559Z                              Set-RegistryValue -Path $notifPath -Name "DisableNotificationCenter" -Value 1 -Type 
2026-01-11T19:28:14.2564450Z                      "DWORD"
2026-01-11T19:28:14.2564579Z                      
2026-01-11T19:28:14.2565516Z                              # Disable toast notifications
2026-01-11T19:28:14.2566334Z                              $toastPath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\PushNotifications"
2026-01-11T19:28:14.2566833Z                              Backup-RegistryKey -Path $toastPath
2026-01-11T19:28:14.2568054Z                              Set-RegistryValue -Path $toastPath -Name "ToastEnabled" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.2568189Z                      
2026-01-11T19:28:14.2568623Z                              # Disable lock screen notifications
2026-01-11T19:28:14.2569987Z                              $lockPath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\Notifications\Settings"
2026-01-11T19:28:14.2570205Z                              Backup-RegistryKey -Path $lockPath
2026-01-11T19:28:14.2571450Z                              Set-RegistryValue -Path $lockPath -Name "NOC_GLOBAL_SETTING_ALLOW_TOASTS_ABOVE_LOCK" 
2026-01-11T19:28:14.2571625Z                      -Value 0 -Type "DWORD"
2026-01-11T19:28:14.2573035Z                              Set-RegistryValue -Path $lockPath -Name 
2026-01-11T19:28:14.2574074Z                      "NOC_GLOBAL_SETTING_ALLOW_CRITICAL_TOASTS_ABOVE_LOCK" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.2574207Z                      
2026-01-11T19:28:14.2574573Z                              Write-Log "Disabled notifications (no popups during gaming)" "SUCCESS"
2026-01-11T19:28:14.2574964Z                          } catch {
2026-01-11T19:28:14.2575845Z                              Write-Log "Error disabling notifications: $_" "ERROR"
2026-01-11T19:28:14.2576219Z                          }
2026-01-11T19:28:14.2576555Z                      }
2026-01-11T19:28:14.2577504Z                      
2026-01-11T19:28:14.2578588Z                      
2026-01-11T19:28:14.2579352Z                      function Disable-PS7Telemetry {
2026-01-11T19:28:14.2580525Z                          <#
2026-01-11T19:28:14.2580706Z                          .SYNOPSIS
2026-01-11T19:28:14.2581479Z                              Disables PowerShell 7 telemetry collection.
2026-01-11T19:28:14.2582147Z                          .DESCRIPTION
2026-01-11T19:28:14.2583099Z                              Sets the POWERSHELL_TELEMETRY_OPTOUT environment variable.
2026-01-11T19:28:14.2583837Z                              Only relevant if PowerShell 7 is installed.
2026-01-11T19:28:14.2584495Z                          .PARAMETER Enable
2026-01-11T19:28:14.2585510Z                              When true, sets the opt-out environment variable.
2026-01-11T19:28:14.2586182Z                          .OUTPUTS
2026-01-11T19:28:14.2586945Z                              None.
2026-01-11T19:28:14.2587939Z                          #>
2026-01-11T19:28:14.2588150Z                          param(
2026-01-11T19:28:14.2588990Z                              [bool]$Enable = $true
2026-01-11T19:28:14.2589459Z                          )
2026-01-11T19:28:14.2590508Z                      
2026-01-11T19:28:14.2590650Z                          if (-not $Enable) {
2026-01-11T19:28:14.2591941Z                              Write-Log "Disable PS7 telemetry: skipped" "INFO"
2026-01-11T19:28:14.2592041Z                              return
2026-01-11T19:28:14.2592627Z                          }
2026-01-11T19:28:14.2592963Z                      
2026-01-11T19:28:14.2594311Z                          try {
2026-01-11T19:28:14.2594497Z                              # Check if PowerShell 7 is installed
2026-01-11T19:28:14.2595406Z                              $ps7Path = "$env:ProgramFiles\PowerShell\7\pwsh.exe"
2026-01-11T19:28:14.2596438Z                              if (-not (Test-Path $ps7Path)) {
2026-01-11T19:28:14.2597207Z                                  Write-Log "PowerShell 7 not installed - skipping telemetry opt-out" "INFO"
2026-01-11T19:28:14.2597395Z                                  return
2026-01-11T19:28:14.2597851Z                              }
2026-01-11T19:28:14.2598977Z                      
2026-01-11T19:28:14.2600324Z                              # Set environment variable to opt out of PS7 telemetry
2026-01-11T19:28:14.2601092Z                              [Environment]::SetEnvironmentVariable("POWERSHELL_TELEMETRY_OPTOUT", "1", "Machine")
2026-01-11T19:28:14.2601452Z                              Write-Log "Disabled PowerShell 7 telemetry (env var set)" "SUCCESS"
2026-01-11T19:28:14.2601605Z                          } catch {
2026-01-11T19:28:14.2602813Z                              Write-Log "Error disabling PS7 telemetry: $_" "ERROR"
2026-01-11T19:28:14.2602936Z                          }
2026-01-11T19:28:14.2603852Z                      }
2026-01-11T19:28:14.2603957Z                      
2026-01-11T19:28:14.2605108Z                      
2026-01-11T19:28:14.2606001Z                      function Disable-WPBT {
2026-01-11T19:28:14.2606105Z                          <#
2026-01-11T19:28:14.2606717Z                          .SYNOPSIS
2026-01-11T19:28:14.2607355Z                              Disables Windows Platform Binary Table (WPBT).
2026-01-11T19:28:14.2608395Z                          .DESCRIPTION
2026-01-11T19:28:14.2608710Z                              WPBT allows OEMs to inject software at boot time.
2026-01-11T19:28:14.2609080Z                              Disabling prevents manufacturer bloatware from auto-installing.
2026-01-11T19:28:14.2610301Z                          .PARAMETER Enable
2026-01-11T19:28:14.2610707Z                              When true, disables WPBT execution.
2026-01-11T19:28:14.2611149Z                          .OUTPUTS
2026-01-11T19:28:14.2611945Z                              None.
2026-01-11T19:28:14.2612563Z                          #>
2026-01-11T19:28:14.2613749Z                          param(
2026-01-11T19:28:14.2614444Z                              [bool]$Enable = $true
2026-01-11T19:28:14.2614875Z                          )
2026-01-11T19:28:14.2615234Z                      
2026-01-11T19:28:14.2615768Z                          if (-not $Enable) {
2026-01-11T19:28:14.2616223Z                              Write-Log "Disable WPBT: skipped" "INFO"
2026-01-11T19:28:14.2617196Z                              return
2026-01-11T19:28:14.2618059Z                          }
2026-01-11T19:28:14.2618702Z                      
2026-01-11T19:28:14.2619479Z                          try {
2026-01-11T19:28:14.2620762Z                              $wpbtPath = "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager"
2026-01-11T19:28:14.2620971Z                              Backup-RegistryKey -Path $wpbtPath
2026-01-11T19:28:14.2621722Z                              Set-RegistryValue -Path $wpbtPath -Name "DisableWpbtExecution" -Value 1 -Type "DWORD"
2026-01-11T19:28:14.2622068Z                      
2026-01-11T19:28:14.2623536Z                              Write-Log "Disabled WPBT (blocks OEM bloatware injection at boot)" "SUCCESS"
2026-01-11T19:28:14.2623662Z                          } catch {
2026-01-11T19:28:14.2624523Z                              Write-Log "Error disabling WPBT: $_" "ERROR"
2026-01-11T19:28:14.2624666Z                          }
2026-01-11T19:28:14.2624761Z                      }
2026-01-11T19:28:14.2625525Z                      
2026-01-11T19:28:14.2626562Z                      
2026-01-11T19:28:14.2626655Z                      
2026-01-11T19:28:14.2627008Z                      
2026-01-11T19:28:14.2628400Z                      function Invoke-PrivacyOptimizations {
2026-01-11T19:28:14.2628516Z                          <#
2026-01-11T19:28:14.2628896Z                          .SYNOPSIS
2026-01-11T19:28:14.2630077Z                              Applies selected privacy optimization tiers and extras.
2026-01-11T19:28:14.2630200Z                          .DESCRIPTION
2026-01-11T19:28:14.2630891Z                              Runs tiered privacy settings
2026-01-11T19:28:14.2631334Z                          .PARAMETER Tier1Safe
2026-01-11T19:28:14.2632215Z                              Applies safe privacy defaults when true.
2026-01-11T19:28:14.2632567Z                          .PARAMETER Tier2Moderate
2026-01-11T19:28:14.2634102Z                              Applies moderate privacy settings when true.
2026-01-11T19:28:14.2634484Z                          .PARAMETER Tier3Aggressive
2026-01-11T19:28:14.2634808Z                              Applies aggressive settings (breaks Xbox/Game Pass) when true.
2026-01-11T19:28:14.2634976Z                          .PARAMETER RemoveBloatware
2026-01-11T19:28:14.2635737Z                              Removes select built-in apps when true.
2026-01-11T19:28:14.2636263Z                          .PARAMETER RemoveXboxApps
2026-01-11T19:28:14.2637289Z                              Removes Xbox apps (breaks Game Pass) when true.
2026-01-11T19:28:14.2637484Z                          .PARAMETER BackgroundAppsOff
2026-01-11T19:28:14.2638688Z                              Disables background UWP apps when true.
2026-01-11T19:28:14.2638858Z                          .PARAMETER EdgeDebloat
2026-01-11T19:28:14.2639908Z                              Applies Edge policy debloat settings when true.
2026-01-11T19:28:14.2640299Z                          .PARAMETER DisableCopilot
2026-01-11T19:28:14.2640720Z                              Disables Windows Copilot when true.
2026-01-11T19:28:14.2641899Z                          .PARAMETER DisableNotifications
2026-01-11T19:28:14.2642376Z                              Disables notifications when true.
2026-01-11T19:28:14.2642800Z                          .PARAMETER DisablePS7Telemetry
2026-01-11T19:28:14.2643823Z                              Disables PowerShell 7 telemetry when true.
2026-01-11T19:28:14.2644422Z                          .PARAMETER DisableWPBT
2026-01-11T19:28:14.2645637Z                              Disables WPBT execution when true.
2026-01-11T19:28:14.2645754Z                          .OUTPUTS
2026-01-11T19:28:14.2646456Z                              None.
2026-01-11T19:28:14.2647189Z                          #>
2026-01-11T19:28:14.2648041Z                          param(
2026-01-11T19:28:14.2648810Z                              [bool]$Tier1Safe = $true,
2026-01-11T19:28:14.2649777Z                              [bool]$Tier2Moderate = $false,
2026-01-11T19:28:14.2650275Z                              [bool]$Tier3Aggressive = $false,
2026-01-11T19:28:14.2650678Z                              [bool]$RemoveBloatware = $true,
2026-01-11T19:28:14.2651059Z                              [bool]$RemoveXboxApps = $false,
2026-01-11T19:28:14.2652412Z                              [bool]$BackgroundAppsOff = $true,
2026-01-11T19:28:14.2652596Z                              [bool]$EdgeDebloat = $true,
2026-01-11T19:28:14.2652993Z                              [bool]$DisableCopilot = $true,
2026-01-11T19:28:14.2654413Z                              [bool]$DisableNotifications = $true,
2026-01-11T19:28:14.2654779Z                              [bool]$DisablePS7Telemetry = $true,
2026-01-11T19:28:14.2654959Z                              [bool]$DisableWPBT = $true
2026-01-11T19:28:14.2656778Z                          )
2026-01-11T19:28:14.2658045Z                      
2026-01-11T19:28:14.2659038Z                          Write-Log "Applying privacy optimizations..." "INFO"
2026-01-11T19:28:14.2659201Z                      
2026-01-11T19:28:14.2660867Z                          try {
2026-01-11T19:28:14.2661084Z                              if ($Tier1Safe) {
2026-01-11T19:28:14.2661664Z                                  Apply-PrivacyTier1Safe
2026-01-11T19:28:14.2662310Z                              }
2026-01-11T19:28:14.2663270Z                      
2026-01-11T19:28:14.2663526Z                              if ($Tier2Moderate) {
2026-01-11T19:28:14.2664512Z                                  Apply-PrivacyTier2Moderate
2026-01-11T19:28:14.2664969Z                              }
2026-01-11T19:28:14.2665739Z                      
2026-01-11T19:28:14.2666746Z                              if ($Tier3Aggressive) {
2026-01-11T19:28:14.2667567Z                                  Apply-PrivacyTier3Aggressive
2026-01-11T19:28:14.2668549Z                              }
2026-01-11T19:28:14.2668661Z                      
2026-01-11T19:28:14.2669855Z                              if ($RemoveBloatware) {
2026-01-11T19:28:14.2670043Z                                  Remove-Bloatware
2026-01-11T19:28:14.2671063Z                              }
2026-01-11T19:28:14.2671244Z                      
2026-01-11T19:28:14.2672151Z                              if ($RemoveXboxApps) {
2026-01-11T19:28:14.2673275Z                                  Remove-XboxApps
2026-01-11T19:28:14.2673418Z                              }
2026-01-11T19:28:14.2674697Z                      
2026-01-11T19:28:14.2675035Z                              if ($BackgroundAppsOff) {
2026-01-11T19:28:14.2675193Z                                  Set-BackgroundAppsOff
2026-01-11T19:28:14.2675282Z                              }
2026-01-11T19:28:14.2676306Z                      
2026-01-11T19:28:14.2677370Z                              if ($EdgeDebloat) {
2026-01-11T19:28:14.2678224Z                                  Apply-EdgeDebloat
2026-01-11T19:28:14.2679181Z                              }
2026-01-11T19:28:14.2679560Z                      
2026-01-11T19:28:14.2680573Z                              if ($DisableCopilot) {
2026-01-11T19:28:14.2680720Z                                  Disable-Copilot
2026-01-11T19:28:14.2681347Z                              }
2026-01-11T19:28:14.2682325Z                      
2026-01-11T19:28:14.2683397Z                              Disable-Notifications -Enable $DisableNotifications
2026-01-11T19:28:14.2683501Z                      
2026-01-11T19:28:14.2684919Z                              Disable-PS7Telemetry -Enable $DisablePS7Telemetry
2026-01-11T19:28:14.2685024Z                      
2026-01-11T19:28:14.2685348Z                              Disable-WPBT -Enable $DisableWPBT
2026-01-11T19:28:14.2686329Z                      
2026-01-11T19:28:14.2687321Z                              Write-Log "Privacy optimizations complete" "SUCCESS"
2026-01-11T19:28:14.2687972Z                              Write-Log "SmartScreen and Windows Update remain ENABLED (security)" "INFO"
2026-01-11T19:28:14.2688356Z                      
2026-01-11T19:28:14.2689330Z                          } catch {
2026-01-11T19:28:14.2689764Z                              Write-Log "Error applying privacy optimizations: $_" "ERROR"
2026-01-11T19:28:14.2690460Z                              throw
2026-01-11T19:28:14.2691532Z                          }
2026-01-11T19:28:14.2691633Z                      }
2026-01-11T19:28:14.2692142Z                      
2026-01-11T19:28:14.2693141Z                      
2026-01-11T19:28:14.2693338Z                      function Undo-PrivacyOptimizations {
2026-01-11T19:28:14.2694486Z                          <#
2026-01-11T19:28:14.2694992Z                          .SYNOPSIS
2026-01-11T19:28:14.2696011Z                              Reverts privacy-related changes.
2026-01-11T19:28:14.2696835Z                          .DESCRIPTION
2026-01-11T19:28:14.2697739Z                              Re-enables services and restores backed up registry values.
2026-01-11T19:28:14.2698117Z                          .OUTPUTS
2026-01-11T19:28:14.2698566Z                              None.
2026-01-11T19:28:14.2698925Z                          #>
2026-01-11T19:28:14.2699903Z                          Write-Log "Rolling back privacy optimizations..." "INFO"
2026-01-11T19:28:14.2700261Z                      
2026-01-11T19:28:14.2701405Z                          try {
2026-01-11T19:28:14.2702608Z                              $services = @("DiagTrack", "dmwappushservice", "SysMain", "XblAuthManager", 
2026-01-11T19:28:14.2703034Z                      "XblGameSave", "XboxGipSvc", "XboxNetApiSvc")
2026-01-11T19:28:14.2703219Z                              foreach ($serviceName in $services) {
2026-01-11T19:28:14.2703913Z                                  try {
2026-01-11T19:28:14.2705196Z                                      $service = Get-Service -Name $serviceName -ErrorAction SilentlyContinue
2026-01-11T19:28:14.2705370Z                                      if ($service) {
2026-01-11T19:28:14.2706807Z                                          Set-Service -Name $serviceName -StartupType Automatic -ErrorAction Stop
2026-01-11T19:28:14.2707263Z                                          Start-Service -Name $serviceName -ErrorAction SilentlyContinue
2026-01-11T19:28:14.2707560Z                                          Write-Log "Re-enabled service: $serviceName" "SUCCESS"
2026-01-11T19:28:14.2708466Z                                      }
2026-01-11T19:28:14.2708596Z                                  } catch {
2026-01-11T19:28:14.2709692Z                                      Write-Log "Error re-enabling service $serviceName : $_" "ERROR"
2026-01-11T19:28:14.2710200Z                                  }
2026-01-11T19:28:14.2711057Z                              }
2026-01-11T19:28:14.2712001Z                      
2026-01-11T19:28:14.2713029Z                              $paths = @(
2026-01-11T19:28:14.2713387Z                                  "HKCU:\Software\Microsoft\Windows\CurrentVersion\AdvertisingInfo",
2026-01-11T19:28:14.2714491Z                                  "HKLM:\SOFTWARE\Policies\Microsoft\Windows\AdvertisingInfo",
2026-01-11T19:28:14.2715596Z                                  "HKLM:\SOFTWARE\Policies\Microsoft\Windows\System",
2026-01-11T19:28:14.2716408Z                                  "HKLM:\SOFTWARE\Microsoft\WcmSvc\wifinetworkmanager\config",
2026-01-11T19:28:14.2716575Z                                  "HKCU:\Software\Microsoft\Siuf\Rules",
2026-01-11T19:28:14.2717651Z                                  "HKCU:\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager",
2026-01-11T19:28:14.2717880Z                                  "HKCU:\Software\Microsoft\Clipboard",
2026-01-11T19:28:14.2719319Z                                  "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\DataCollection",
2026-01-11T19:28:14.2719619Z                                  "HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting",
2026-01-11T19:28:14.2720006Z                                  "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\DeliveryOptimization\Config",
2026-01-11T19:28:14.2720497Z                                  "HKCU:\Software\Microsoft\Windows\CurrentVersion\BackgroundAccessApplications",
2026-01-11T19:28:14.2721585Z                                  "HKCU:\Software\Microsoft\Windows\CurrentVersion\Search",
2026-01-11T19:28:14.2721788Z                                  "HKLM:\SOFTWARE\Policies\Microsoft\Edge",
2026-01-11T19:28:14.2722282Z                                  "HKCU:\SOFTWARE\Microsoft\Windows\Shell\CopilotAI",
2026-01-11T19:28:14.2722599Z                                  "HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsCopilot"
2026-01-11T19:28:14.2723524Z                              )
2026-01-11T19:28:14.2723636Z                      
2026-01-11T19:28:14.2724845Z                              foreach ($path in $paths) {
2026-01-11T19:28:14.2725229Z                                  if (Restore-RegistryKey -Path $path) {
2026-01-11T19:28:14.2726499Z                                      Write-Log "Restored registry: $path" "SUCCESS"
2026-01-11T19:28:14.2726641Z                                  }
2026-01-11T19:28:14.2726885Z                              }
2026-01-11T19:28:14.2727877Z                      
2026-01-11T19:28:14.2728545Z                              Write-Log "Privacy optimization rollback complete" "SUCCESS"
2026-01-11T19:28:14.2728971Z                      
2026-01-11T19:28:14.2729877Z                          } catch {
2026-01-11T19:28:14.2730651Z                              Write-Log "Error during rollback: $_" "ERROR"
2026-01-11T19:28:14.2731007Z                              throw
2026-01-11T19:28:14.2731832Z                          }
2026-01-11T19:28:14.2732341Z                      }
2026-01-11T19:28:14.2733342Z                      
2026-01-11T19:28:14.2733443Z                      
2026-01-11T19:28:14.2734035Z                      Export-ModuleMember -Function @(
2026-01-11T19:28:14.2735713Z                          'Apply-PrivacyTier1Safe',
2026-01-11T19:28:14.2735916Z                          'Apply-PrivacyTier2Moderate',
2026-01-11T19:28:14.2736103Z                          'Apply-PrivacyTier3Aggressive',
2026-01-11T19:28:14.2737491Z                          'Remove-Bloatware',
2026-01-11T19:28:14.2737628Z                          'Remove-XboxApps',
2026-01-11T19:28:14.2738157Z                          'Set-BackgroundAppsOff',
2026-01-11T19:28:14.2739296Z                          'Apply-EdgeDebloat',
2026-01-11T19:28:14.2739650Z                          'Disable-Copilot',
2026-01-11T19:28:14.2740106Z                          'Disable-Notifications',
2026-01-11T19:28:14.2741207Z                          'Disable-PS7Telemetry',
2026-01-11T19:28:14.2741342Z                          'Disable-WPBT',
2026-01-11T19:28:14.2742448Z                          'Test-PrivacyOptimizations',
2026-01-11T19:28:14.2742631Z                          'Invoke-PrivacyOptimizations',
2026-01-11T19:28:14.2743145Z                          'Undo-PrivacyOptimizations'
2026-01-11T19:28:14.2743968Z                      )
2026-01-11T19:28:14.2744088Z                      
2026-01-11T19:28:14.2745217Z [32;1mParent             : [0m
2026-01-11T19:28:14.2745492Z 
2026-01-11T19:28:14.2781954Z [32;1mAttributes         : [0m{}
Ôªø2026-01-11T19:28:14.2790390Z [32;1mUsingStatements    : [0m{}
2026-01-11T19:28:14.2790519Z [32;1mParamBlock         : [0m
2026-01-11T19:28:14.2790624Z [32;1mBeginBlock         : [0m
2026-01-11T19:28:14.2790722Z [32;1mProcessBlock       : [0m
2026-01-11T19:28:14.2791244Z [32;1mEndBlock           : [0mImport-Module (Join-Path $PSScriptRoot "..\core\logger.psm1") -Force -Global
2026-01-11T19:28:14.2791636Z                      Import-Module (Join-Path $PSScriptRoot "..\core\registry.psm1") -Force -Global
2026-01-11T19:28:14.2791732Z                      
2026-01-11T19:28:14.2791806Z                      
2026-01-11T19:28:14.2791906Z                      function Backup-ConfigFile {
2026-01-11T19:28:14.2791981Z                          <#
2026-01-11T19:28:14.2792109Z                          .SYNOPSIS
2026-01-11T19:28:14.2792321Z                              Creates a timestamped backup of a config file.
2026-01-11T19:28:14.2792478Z                          .DESCRIPTION
2026-01-11T19:28:14.2794455Z                              Copies the file to a .backup_TIMESTAMP extension in the same directory.
2026-01-11T19:28:14.2794831Z                              Returns backup path on success or $false on failure.
2026-01-11T19:28:14.2796005Z                          .PARAMETER Path
2026-01-11T19:28:14.2796220Z                              Path to the config file to backup.
2026-01-11T19:28:14.2796989Z                          .OUTPUTS
2026-01-11T19:28:14.2797983Z                              [string] Backup file path, or [bool]$false on failure.
2026-01-11T19:28:14.2798295Z                          #>
2026-01-11T19:28:14.2799495Z                          param(
2026-01-11T19:28:14.2800299Z                              [Parameter(Mandatory = $true)]
2026-01-11T19:28:14.2801064Z                              [string]$Path
2026-01-11T19:28:14.2802215Z                          )
2026-01-11T19:28:14.2802415Z                      
2026-01-11T19:28:14.2803075Z                          try {
2026-01-11T19:28:14.2804159Z                              if (-not (Test-Path $Path)) {
2026-01-11T19:28:14.2804721Z                                  Write-Log "Cannot backup: file not found: $Path" "WARNING"
2026-01-11T19:28:14.2805556Z                                  return $false
2026-01-11T19:28:14.2806247Z                              }
2026-01-11T19:28:14.2806718Z                      
2026-01-11T19:28:14.2807578Z                              $timestamp = Get-Date -Format "yyyyMMdd_HHmmss"
2026-01-11T19:28:14.2808358Z                              $backupPath = "$Path.backup_$timestamp"
2026-01-11T19:28:14.2809041Z                      
2026-01-11T19:28:14.2810432Z                              Copy-Item -Path $Path -Destination $backupPath -Force -ErrorAction Stop
2026-01-11T19:28:14.2810723Z                              Write-Log "Backup created: $backupPath" "INFO"
2026-01-11T19:28:14.2811789Z                              return $backupPath
2026-01-11T19:28:14.2812209Z                          }
2026-01-11T19:28:14.2813562Z                          catch {
2026-01-11T19:28:14.2813905Z                              Write-Log "Failed to backup $Path : $_" "ERROR"
2026-01-11T19:28:14.2814536Z                              return $false
2026-01-11T19:28:14.2815816Z                          }
2026-01-11T19:28:14.2815919Z                      }
2026-01-11T19:28:14.2816635Z                      
2026-01-11T19:28:14.2817699Z                      
2026-01-11T19:28:14.2817986Z                      function Set-DiscordGamingSettings {
2026-01-11T19:28:14.2819161Z                          <#
2026-01-11T19:28:14.2819617Z                          .SYNOPSIS
2026-01-11T19:28:14.2820648Z                              Applies gaming-optimized settings to Discord.
2026-01-11T19:28:14.2820818Z                          .DESCRIPTION
2026-01-11T19:28:14.2822265Z                              Modifies Discord's settings.json to disable performance-impacting features.
2026-01-11T19:28:14.2822829Z                              Creates backup before changes. Skips if Discord is running or not installed.
2026-01-11T19:28:14.2824340Z                          .PARAMETER DisableHardwareAccel
2026-01-11T19:28:14.2824507Z                              Disable GPU hardware acceleration (reduces GPU load).
2026-01-11T19:28:14.2824749Z                          .PARAMETER DisableOverlay
2026-01-11T19:28:14.2825839Z                              Disable in-game overlay (reduces latency).
2026-01-11T19:28:14.2826384Z                          .PARAMETER DisableActivityStatus
2026-01-11T19:28:14.2827313Z                              Disable activity status broadcasting (reduces network traffic).
2026-01-11T19:28:14.2827846Z                          .PARAMETER DisableEchoCancellation
2026-01-11T19:28:14.2828702Z                              Disable echo cancellation (reduces CPU load, use headphones).
2026-01-11T19:28:14.2829406Z                          .PARAMETER StandardNoiseSuppression
2026-01-11T19:28:14.2830291Z                              Set noise suppression to standard (balanced).
2026-01-11T19:28:14.2830998Z                          .PARAMETER DisableAutoGainControl
2026-01-11T19:28:14.2832312Z                              Disable automatic gain control (consistent mic volume).
2026-01-11T19:28:14.2832497Z                          .OUTPUTS
2026-01-11T19:28:14.2832687Z                              None.
2026-01-11T19:28:14.2833884Z                          .NOTES
2026-01-11T19:28:14.2834268Z                              Discord may overwrite these settings on launch in rare cases. If settings
2026-01-11T19:28:14.2835511Z                              revert, consider using Discord's UI to apply them manually.
2026-01-11T19:28:14.2835834Z                          #>
2026-01-11T19:28:14.2836839Z                          [CmdletBinding()]
2026-01-11T19:28:14.2837462Z                          param(
2026-01-11T19:28:14.2838276Z                              [bool]$DisableHardwareAccel = $false,
2026-01-11T19:28:14.2839426Z                              [bool]$DisableOverlay = $false,
2026-01-11T19:28:14.2840186Z                              [bool]$DisableActivityStatus = $false,
2026-01-11T19:28:14.2841215Z                              [bool]$DisableEchoCancellation = $false,
2026-01-11T19:28:14.2841681Z                              [bool]$StandardNoiseSuppression = $false,
2026-01-11T19:28:14.2842518Z                              [bool]$DisableAutoGainControl = $false
2026-01-11T19:28:14.2843378Z                          )
2026-01-11T19:28:14.2843624Z                      
2026-01-11T19:28:14.2844938Z                          Write-Log "Configuring Discord gaming settings..." "INFO"
2026-01-11T19:28:14.2845269Z                      
2026-01-11T19:28:14.2851772Z                          $settingsPath = Join-Path $env:APPDATA "discord\settings.json"
2026-01-11T19:28:14.2851924Z                      
2026-01-11T19:28:14.2852102Z                          # Check if Discord is installed
2026-01-11T19:28:14.2852279Z                          if (-not (Test-Path $settingsPath)) {
2026-01-11T19:28:14.2852592Z                              Write-Log "Discord not found at $settingsPath - skipping" "INFO"
2026-01-11T19:28:14.2852693Z                              return
2026-01-11T19:28:14.2852784Z                          }
2026-01-11T19:28:14.2852879Z                      
2026-01-11T19:28:14.2853027Z                          # Check if Discord is running
2026-01-11T19:28:14.2853413Z                          $discordProcess = Get-Process -Name "Discord" -ErrorAction SilentlyContinue
2026-01-11T19:28:14.2853543Z                          if ($discordProcess) {
2026-01-11T19:28:14.2854043Z                              Write-Log "‚ö†Ô∏è  Discord is running! Please close Discord and re-run this script." "WARNING"
2026-01-11T19:28:14.2854779Z                              Write-Log "Discord settings NOT applied (app must be closed first)" "WARNING"
2026-01-11T19:28:14.2855082Z                              return
2026-01-11T19:28:14.2855172Z                          }
2026-01-11T19:28:14.2855740Z                      
2026-01-11T19:28:14.2855851Z                          try {
2026-01-11T19:28:14.2856438Z                              # Backup existing settings
2026-01-11T19:28:14.2856729Z                              $backup = Backup-ConfigFile -Path $settingsPath
2026-01-11T19:28:14.2857748Z                              if ($backup -eq $false) {
2026-01-11T19:28:14.2858088Z                                  Write-Log "Skipping Discord settings (backup failed)" "WARNING"
2026-01-11T19:28:14.2859291Z                                  return
2026-01-11T19:28:14.2859489Z                              }
2026-01-11T19:28:14.2860164Z                      
2026-01-11T19:28:14.2860324Z                              # Read existing settings
2026-01-11T19:28:14.2861570Z                              $settingsJson = Get-Content $settingsPath -Raw -ErrorAction Stop
2026-01-11T19:28:14.2861779Z                              $settings = $settingsJson | ConvertFrom-Json
2026-01-11T19:28:14.2862746Z                      
2026-01-11T19:28:14.2862892Z                              # Apply settings
2026-01-11T19:28:14.2863229Z                              $changesMade = $false
2026-01-11T19:28:14.2864348Z                      
2026-01-11T19:28:14.2864782Z                              # Note: Hardware acceleration is NOT exposed in settings.json
2026-01-11T19:28:14.2866221Z                              # It can only be disabled via UI or by modifying Discord shortcuts with 
2026-01-11T19:28:14.2866448Z                      --disable-hardware-acceleration flag
2026-01-11T19:28:14.2867459Z                              if ($DisableHardwareAccel) {
2026-01-11T19:28:14.2867938Z                                  Write-Log "  ‚ö†Ô∏è  Hardware acceleration requires manual configuration:" "WARNING"
2026-01-11T19:28:14.2869609Z                                  Write-Log "      Option 1: User Settings ‚Üí Advanced ‚Üí Toggle Hardware Acceleration 
2026-01-11T19:28:14.2869749Z                      OFF" "INFO"
2026-01-11T19:28:14.2871015Z                                  Write-Log "      Option 2: Add --disable-hardware-acceleration to Discord shortcut 
2026-01-11T19:28:14.2871158Z                      target" "INFO"
2026-01-11T19:28:14.2872168Z                              }
2026-01-11T19:28:14.2872355Z                      
2026-01-11T19:28:14.2873383Z                              if ($DisableOverlay) {
2026-01-11T19:28:14.2874750Z                                  $settings | Add-Member -NotePropertyName "OVERLAY" -NotePropertyValue $false -Force
2026-01-11T19:28:14.2874889Z                                  $changesMade = $true
2026-01-11T19:28:14.2876460Z                                  Write-Log "  ‚úì Overlay disabled" "INFO"
2026-01-11T19:28:14.2876596Z                              }
2026-01-11T19:28:14.2878150Z                      
2026-01-11T19:28:14.2878417Z                              if ($DisableActivityStatus) {
2026-01-11T19:28:14.2878910Z                                  $settings | Add-Member -NotePropertyName "status" -NotePropertyValue "invisible" 
2026-01-11T19:28:14.2879021Z                      -Force
2026-01-11T19:28:14.2880024Z                                  $changesMade = $true
2026-01-11T19:28:14.2881275Z                                  Write-Log "  ‚úì Activity status hidden" "INFO"
2026-01-11T19:28:14.2881416Z                              }
2026-01-11T19:28:14.2882566Z                      
2026-01-11T19:28:14.2883317Z                              if ($DisableEchoCancellation) {
2026-01-11T19:28:14.2884678Z                                  $settings | Add-Member -NotePropertyName "echoCancellation" -NotePropertyValue $false 
2026-01-11T19:28:14.2885179Z                      -Force
2026-01-11T19:28:14.2885334Z                                  $changesMade = $true
2026-01-11T19:28:14.2886158Z                                  Write-Log "  ‚úì Echo cancellation disabled" "INFO"
2026-01-11T19:28:14.2886436Z                              }
2026-01-11T19:28:14.2887587Z                      
2026-01-11T19:28:14.2887883Z                              if ($StandardNoiseSuppression) {
2026-01-11T19:28:14.2889386Z                                  $settings | Add-Member -NotePropertyName "noiseSuppression" -NotePropertyValue 
2026-01-11T19:28:14.2889508Z                      "standard" -Force
2026-01-11T19:28:14.2890116Z                                  $changesMade = $true
2026-01-11T19:28:14.2891428Z                                  Write-Log "  ‚úì Noise suppression set to standard" "INFO"
2026-01-11T19:28:14.2891579Z                              }
2026-01-11T19:28:14.2892522Z                      
2026-01-11T19:28:14.2893058Z                              if ($DisableAutoGainControl) {
2026-01-11T19:28:14.2894795Z                                  $settings | Add-Member -NotePropertyName "automaticGainControl" -NotePropertyValue 
2026-01-11T19:28:14.2894924Z                      $false -Force
2026-01-11T19:28:14.2895087Z                                  $changesMade = $true
2026-01-11T19:28:14.2896215Z                                  Write-Log "  ‚úì Auto gain control disabled" "INFO"
2026-01-11T19:28:14.2896674Z                              }
2026-01-11T19:28:14.2897857Z                      
2026-01-11T19:28:14.2898007Z                              if ($changesMade) {
2026-01-11T19:28:14.2898954Z                                  # Write settings back to file
2026-01-11T19:28:14.2900218Z                                  $settings | ConvertTo-Json -Depth 10 | Set-Content $settingsPath -ErrorAction Stop
2026-01-11T19:28:14.2900590Z                                  Write-Log "Discord gaming settings applied successfully" "SUCCESS"
2026-01-11T19:28:14.2901672Z                                  Write-Log "Backup: $backup" "INFO"
2026-01-11T19:28:14.2901833Z                              }
2026-01-11T19:28:14.2902811Z                              else {
2026-01-11T19:28:14.2904030Z                                  Write-Log "No Discord settings were changed (all parameters false)" "INFO"
2026-01-11T19:28:14.2904148Z                              }
2026-01-11T19:28:14.2904508Z                          }
2026-01-11T19:28:14.2905129Z                          catch {
2026-01-11T19:28:14.2905518Z                              Write-Log "Failed to apply Discord settings: $_" "ERROR"
2026-01-11T19:28:14.2906024Z                              Write-Log "You can restore from backup: $backup" "INFO"
2026-01-11T19:28:14.2907088Z                          }
2026-01-11T19:28:14.2907496Z                      }
2026-01-11T19:28:14.2908399Z                      
2026-01-11T19:28:14.2909475Z                      
2026-01-11T19:28:14.2909853Z                      function Set-AudioDeviceProperties {
2026-01-11T19:28:14.2910181Z                          <#
2026-01-11T19:28:14.2912800Z                          .SYNOPSIS
2026-01-11T19:28:14.2913402Z                              Configures Windows audio device properties for low-latency gaming.
2026-01-11T19:28:14.2913546Z                          .DESCRIPTION
2026-01-11T19:28:14.2922392Z                              Modifies registry settings for the default playback device to optimize
2026-01-11T19:28:14.2922719Z                              sample rate, bit depth, exclusive mode, and disable enhancements.
2026-01-11T19:28:14.2922928Z                              Creates registry backups before changes.
2026-01-11T19:28:14.2923076Z                          .PARAMETER SampleRate
2026-01-11T19:28:14.2923351Z                              Sample rate in Hz (e.g., 48000, 96000, 192000). Higher = more CPU.
2026-01-11T19:28:14.2923517Z                              Default: 48000 (most compatible).
2026-01-11T19:28:14.2923625Z                          .PARAMETER BitDepth
2026-01-11T19:28:14.2923847Z                              Bit depth: 16 or 24. Higher = better quality, slightly more CPU.
2026-01-11T19:28:14.2924130Z                              Default: 24.
2026-01-11T19:28:14.2924281Z                          .PARAMETER DisableSpatialAudio
2026-01-11T19:28:14.2924613Z                              Disable spatial audio processing (lower latency).
2026-01-11T19:28:14.2924771Z                          .PARAMETER EnableExclusiveMode
2026-01-11T19:28:14.2925046Z                              Allow apps to take exclusive control (lowest latency for games).
2026-01-11T19:28:14.2925209Z                          .PARAMETER DisableEnhancements
2026-01-11T19:28:14.2925522Z                              Disable all audio enhancements (lower latency, predictable output).
2026-01-11T19:28:14.2925623Z                          .OUTPUTS
2026-01-11T19:28:14.2925728Z                              None.
2026-01-11T19:28:14.2925836Z                          .NOTES
2026-01-11T19:28:14.2926153Z                              Requires Administrator. Only modifies default playback device.
2026-01-11T19:28:14.2926268Z                          #>
2026-01-11T19:28:14.2926389Z                          [CmdletBinding()]
2026-01-11T19:28:14.2926498Z                          param(
2026-01-11T19:28:14.2926763Z                              [int]$SampleRate = 48000,
2026-01-11T19:28:14.2927134Z                              [int]$BitDepth = 24,
2026-01-11T19:28:14.2928115Z                              [bool]$DisableSpatialAudio = $false,
2026-01-11T19:28:14.2928315Z                              [bool]$EnableExclusiveMode = $false,
2026-01-11T19:28:14.2929305Z                              [bool]$DisableEnhancements = $false
2026-01-11T19:28:14.2929834Z                          )
2026-01-11T19:28:14.2929992Z                      
2026-01-11T19:28:14.2931275Z                          Write-Log "Configuring audio device properties..." "INFO"
2026-01-11T19:28:14.2931380Z                      
2026-01-11T19:28:14.2931983Z                          try {
2026-01-11T19:28:14.2932112Z                              # Get default audio device
2026-01-11T19:28:14.2933800Z                              $audioDevices = Get-ItemProperty -Path 
2026-01-11T19:28:14.2934371Z                      "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\MMDevices\Audio\Render\*" -ErrorAction Stop
2026-01-11T19:28:14.2935193Z                      
2026-01-11T19:28:14.2935360Z                              if (-not $audioDevices) {
2026-01-11T19:28:14.2936182Z                                  Write-Log "No audio devices found - skipping" "WARNING"
2026-01-11T19:28:14.2936785Z                                  return
2026-01-11T19:28:14.2938078Z                              }
2026-01-11T19:28:14.2938285Z                      
2026-01-11T19:28:14.2938864Z                              # Find default device (there should be one marked as default)
2026-01-11T19:28:14.2940704Z                              $defaultDevice = $audioDevices | Where-Object { $_."(default)" -ne $null } | 
2026-01-11T19:28:14.2941008Z                      Select-Object -First 1
2026-01-11T19:28:14.2941138Z                      
2026-01-11T19:28:14.2941518Z                              if (-not $defaultDevice) {
2026-01-11T19:28:14.2942393Z                                  # Fallback: use first device
2026-01-11T19:28:14.2943618Z                                  $defaultDevice = $audioDevices | Select-Object -First 1
2026-01-11T19:28:14.2943937Z                                  Write-Log "Using first available audio device" "INFO"
2026-01-11T19:28:14.2944080Z                              }
2026-01-11T19:28:14.2944936Z                      
2026-01-11T19:28:14.2945913Z                              $devicePath = $defaultDevice.PSPath
2026-01-11T19:28:14.2946662Z                              $deviceName = $defaultDevice."FriendlyName"
2026-01-11T19:28:14.2947545Z                      
2026-01-11T19:28:14.2947888Z                              Write-Log "Configuring device: $deviceName" "INFO"
2026-01-11T19:28:14.2948960Z                      
2026-01-11T19:28:14.2949778Z                              # Backup registry key
2026-01-11T19:28:14.2949968Z                              Backup-RegistryKey -Path $devicePath
2026-01-11T19:28:14.2950528Z                      
2026-01-11T19:28:14.2950898Z                              $changesMade = $false
2026-01-11T19:28:14.2951019Z                      
2026-01-11T19:28:14.2952401Z                              # Sample rate and bit depth
2026-01-11T19:28:14.2952818Z                              # Format GUID for audio properties: {f19f064d-082c-4e27-bc73-6882a1bb8e4c}
2026-01-11T19:28:14.2953258Z                              $formatKey = "{f19f064d-082c-4e27-bc73-6882a1bb8e4c},0"
2026-01-11T19:28:14.2954278Z                      
2026-01-11T19:28:14.2955171Z                              # Calculate format value (sample rate + bit depth)
2026-01-11T19:28:14.2955529Z                              # This is a complex binary value - simplified approach
2026-01-11T19:28:14.2956474Z                              if ($SampleRate -or $BitDepth) {
2026-01-11T19:28:14.2957087Z                                  Write-Log "  ‚ö†Ô∏è  Sample rate/bit depth changes require manual configuration" "WARNING"
2026-01-11T19:28:14.2958507Z                                  Write-Log "  Open Sound settings > Device properties > Additional device properties" 
2026-01-11T19:28:14.2958631Z                      "INFO"
2026-01-11T19:28:14.2958729Z                              }
2026-01-11T19:28:14.2959819Z                      
2026-01-11T19:28:14.2960520Z                              # Spatial audio (uses protected registry - requires ownership change)
2026-01-11T19:28:14.2960703Z                              if ($DisableSpatialAudio) {
2026-01-11T19:28:14.2961734Z                                  $spatialPath = Join-Path $devicePath "FxProperties"
2026-01-11T19:28:14.2963134Z                                  if (Set-ProtectedRegistryValue -Path $spatialPath -Name 
2026-01-11T19:28:14.2963698Z                      "{e4870e26-3cc5-4cd2-ba46-ca0a9a70ed04},3" -Value 0 -Type "DWORD") {
2026-01-11T19:28:14.2963886Z                                      $changesMade = $true
2026-01-11T19:28:14.2964712Z                                      Write-Log "  ‚úì Spatial audio disabled" "INFO"
2026-01-11T19:28:14.2964890Z                                  }
2026-01-11T19:28:14.2966220Z                              }
2026-01-11T19:28:14.2966330Z                      
2026-01-11T19:28:14.2966839Z                              # Exclusive mode (uses protected registry - requires ownership change)
2026-01-11T19:28:14.2967621Z                              if ($EnableExclusiveMode) {
2026-01-11T19:28:14.2969137Z                                  if (Set-ProtectedRegistryValue -Path $devicePath -Name 
2026-01-11T19:28:14.2969636Z                      "PKEY_AudioEndpoint_Disable_SysFx" -Value 0 -Type "DWORD") {
2026-01-11T19:28:14.2970143Z                                      $changesMade = $true
2026-01-11T19:28:14.2970746Z                                      Write-Log "  ‚úì Exclusive mode enabled" "INFO"
2026-01-11T19:28:14.2970902Z                                  }
2026-01-11T19:28:14.2972178Z                              }
2026-01-11T19:28:14.2972504Z                      
2026-01-11T19:28:14.2973235Z                              # Audio enhancements (uses protected registry - requires ownership change)
2026-01-11T19:28:14.2974016Z                              if ($DisableEnhancements) {
2026-01-11T19:28:14.2975185Z                                  if (Set-ProtectedRegistryValue -Path $devicePath -Name 
2026-01-11T19:28:14.2975861Z                      "{fc52a749-4be9-4510-896e-966ba6525980},3" -Value 0 -Type "DWORD") {
2026-01-11T19:28:14.2976032Z                                      $changesMade = $true
2026-01-11T19:28:14.2976694Z                                      Write-Log "  ‚úì Audio enhancements disabled" "INFO"
2026-01-11T19:28:14.2977472Z                                  }
2026-01-11T19:28:14.2978299Z                              }
2026-01-11T19:28:14.2978845Z                      
2026-01-11T19:28:14.2980047Z                              if ($changesMade) {
2026-01-11T19:28:14.2980678Z                                  Write-Log "Audio device properties configured successfully" "SUCCESS"
2026-01-11T19:28:14.2982309Z                                  Write-Log "‚ö†Ô∏è  Reboot or restart audio service for changes to take effect" "WARNING"
2026-01-11T19:28:14.2982428Z                              }
2026-01-11T19:28:14.2982535Z                              else {
2026-01-11T19:28:14.2983078Z                                  Write-Log "No audio settings were changed" "INFO"
2026-01-11T19:28:14.2984042Z                              }
2026-01-11T19:28:14.2984403Z                          }
2026-01-11T19:28:14.2985634Z                          catch {
2026-01-11T19:28:14.2985946Z                              Write-Log "Failed to configure audio device: $_" "ERROR"
2026-01-11T19:28:14.2986158Z                          }
2026-01-11T19:28:14.2987161Z                      }
2026-01-11T19:28:14.2987363Z                      
2026-01-11T19:28:14.2988513Z                      
2026-01-11T19:28:14.2988726Z                      function Set-SteamGamingSettings {
2026-01-11T19:28:14.2989811Z                          <#
2026-01-11T19:28:14.2989938Z                          .SYNOPSIS
2026-01-11T19:28:14.2991167Z                              Applies gaming-optimized settings to Steam.
2026-01-11T19:28:14.2991287Z                          .DESCRIPTION
2026-01-11T19:28:14.2992336Z                              Modifies Steam's localconfig.vdf to disable overlay, downloads during
2026-01-11T19:28:14.2992726Z                              gameplay, and enable low bandwidth mode. Creates backup before changes.
2026-01-11T19:28:14.2993514Z                              Skips if Steam is running or not installed.
2026-01-11T19:28:14.2993675Z                          .PARAMETER DisableOverlay
2026-01-11T19:28:14.2993879Z                              Disable Steam overlay (reduces latency).
2026-01-11T19:28:14.2994505Z                          .PARAMETER DisableDownloadsDuringGameplay
2026-01-11T19:28:14.2995415Z                              Prevent Steam from downloading updates while gaming.
2026-01-11T19:28:14.2995896Z                          .PARAMETER EnableLowBandwidthMode
2026-01-11T19:28:14.2996235Z                              Reduce Steam's bandwidth usage for UI/chat.
2026-01-11T19:28:14.2996375Z                          .OUTPUTS
2026-01-11T19:28:14.2997765Z                              None.
2026-01-11T19:28:14.2998222Z                          .NOTES
2026-01-11T19:28:14.2999353Z                              Auto-detects Steam user ID from most recently modified userdata folder.
2026-01-11T19:28:14.3000198Z                              Steam must be closed before running this function.
2026-01-11T19:28:14.3000319Z                          #>
2026-01-11T19:28:14.3001760Z                          [CmdletBinding()]
2026-01-11T19:28:14.3001913Z                          param(
2026-01-11T19:28:14.3002536Z                              [bool]$DisableOverlay = $false,
2026-01-11T19:28:14.3002762Z                              [bool]$DisableDownloadsDuringGameplay = $false,
2026-01-11T19:28:14.3003761Z                              [bool]$EnableLowBandwidthMode = $false
2026-01-11T19:28:14.3003983Z                          )
2026-01-11T19:28:14.3004724Z                      
2026-01-11T19:28:14.3006281Z                          Write-Log "Configuring Steam gaming settings..." "INFO"
2026-01-11T19:28:14.3006427Z                      
2026-01-11T19:28:14.3006645Z                          # Detect Steam installation path
2026-01-11T19:28:14.3007731Z                          $steamPath = $null
2026-01-11T19:28:14.3008195Z                          try {
2026-01-11T19:28:14.3009680Z                              $steamReg = Get-ItemProperty -Path "HKLM:\SOFTWARE\WOW6432Node\Valve\Steam" -ErrorAction 
2026-01-11T19:28:14.3009821Z                      SilentlyContinue
2026-01-11T19:28:14.3010167Z                              if ($steamReg) {
2026-01-11T19:28:14.3010735Z                                  $steamPath = $steamReg.InstallPath
2026-01-11T19:28:14.3011303Z                              }
2026-01-11T19:28:14.3012536Z                          }
2026-01-11T19:28:14.3012683Z                          catch {}
2026-01-11T19:28:14.3014226Z                      
2026-01-11T19:28:14.3014492Z                          if (-not $steamPath -or -not (Test-Path $steamPath)) {
2026-01-11T19:28:14.3014722Z                              Write-Log "Steam not found - skipping" "INFO"
2026-01-11T19:28:14.3015814Z                              return
2026-01-11T19:28:14.3016239Z                          }
2026-01-11T19:28:14.3017455Z                      
2026-01-11T19:28:14.3017737Z                          Write-Log "Steam found at: $steamPath" "INFO"
2026-01-11T19:28:14.3018787Z                      
2026-01-11T19:28:14.3018942Z                          # Check if Steam is running
2026-01-11T19:28:14.3020089Z                          $steamProcess = Get-Process -Name "steam" -ErrorAction SilentlyContinue
2026-01-11T19:28:14.3020555Z                          if ($steamProcess) {
2026-01-11T19:28:14.3022068Z                              Write-Log "‚ö†Ô∏è  Steam is running! Please close Steam and re-run this script." "WARNING"
2026-01-11T19:28:14.3022465Z                              Write-Log "Steam settings NOT applied (app must be closed first)" "WARNING"
2026-01-11T19:28:14.3022573Z                              return
2026-01-11T19:28:14.3023566Z                          }
2026-01-11T19:28:14.3023782Z                      
2026-01-11T19:28:14.3025379Z                          # Auto-detect user ID (most recent userdata folder)
2026-01-11T19:28:14.3025857Z                          $userdataPath = Join-Path $steamPath "userdata"
2026-01-11T19:28:14.3026608Z                      
2026-01-11T19:28:14.3027587Z                          if (-not (Test-Path $userdataPath)) {
2026-01-11T19:28:14.3028374Z                              Write-Log "Steam userdata folder not found - skipping" "WARNING"
2026-01-11T19:28:14.3028904Z                              return
2026-01-11T19:28:14.3029910Z                          }
2026-01-11T19:28:14.3030567Z                      
2026-01-11T19:28:14.3032312Z                          $userFolders = Get-ChildItem -Path $userdataPath -Directory -ErrorAction SilentlyContinue |
2026-01-11T19:28:14.3032544Z                              Sort-Object LastWriteTime -Descending
2026-01-11T19:28:14.3032657Z                      
2026-01-11T19:28:14.3033666Z                          if (-not $userFolders) {
2026-01-11T19:28:14.3034666Z                              Write-Log "No Steam user profiles found - skipping" "WARNING"
2026-01-11T19:28:14.3035002Z                              return
2026-01-11T19:28:14.3035892Z                          }
2026-01-11T19:28:14.3036482Z                      
2026-01-11T19:28:14.3037530Z                          $userId = $userFolders[0].Name
2026-01-11T19:28:14.3038128Z                          Write-Log "Using Steam user ID: $userId" "INFO"
2026-01-11T19:28:14.3038295Z                      
2026-01-11T19:28:14.3040235Z                          $configPath = Join-Path $userdataPath "$userId\config\localconfig.vdf"
2026-01-11T19:28:14.3040349Z                      
2026-01-11T19:28:14.3040525Z                          if (-not (Test-Path $configPath)) {
2026-01-11T19:28:14.3040925Z                              Write-Log "Steam config not found at $configPath - skipping" "WARNING"
2026-01-11T19:28:14.3041764Z                              return
2026-01-11T19:28:14.3041903Z                          }
2026-01-11T19:28:14.3043080Z                      
2026-01-11T19:28:14.3043869Z                          try {
2026-01-11T19:28:14.3044053Z                              # Backup config
2026-01-11T19:28:14.3045456Z                              $backup = Backup-ConfigFile -Path $configPath
2026-01-11T19:28:14.3045781Z                              if ($backup -eq $false) {
2026-01-11T19:28:14.3046262Z                                  Write-Log "Skipping Steam settings (backup failed)" "WARNING"
2026-01-11T19:28:14.3047089Z                                  return
2026-01-11T19:28:14.3048014Z                              }
2026-01-11T19:28:14.3048458Z                      
2026-01-11T19:28:14.3049392Z                              # Read config file
2026-01-11T19:28:14.3049739Z                              $configContent = Get-Content $configPath -Raw -ErrorAction Stop
2026-01-11T19:28:14.3050044Z                      
2026-01-11T19:28:14.3051187Z                              $changesMade = $false
2026-01-11T19:28:14.3051632Z                      
2026-01-11T19:28:14.3052801Z                              # Disable overlay (InGameOverlayShowFPSContrast)
2026-01-11T19:28:14.3053819Z                              if ($DisableOverlay) {
2026-01-11T19:28:14.3054206Z                                  # VDF uses key-value format: "key"		"value"
2026-01-11T19:28:14.3055471Z                                  $configContent = $configContent -replace 
2026-01-11T19:28:14.3056006Z                      '("InGameOverlayShowFPSContrast"\s+")\d+(")', '${1}0${2}'
2026-01-11T19:28:14.3056536Z                                  $changesMade = $true
2026-01-11T19:28:14.3057636Z                                  Write-Log "  ‚úì Steam overlay disabled" "INFO"
2026-01-11T19:28:14.3057771Z                              }
2026-01-11T19:28:14.3058613Z                      
2026-01-11T19:28:14.3059427Z                              # Disable downloads during gameplay
2026-01-11T19:28:14.3059658Z                              if ($DisableDownloadsDuringGameplay) {
2026-01-11T19:28:14.3061541Z                                  $configContent = $configContent -replace '("AllowDownloadsWhileRunning"\s+")\d+(")', 
2026-01-11T19:28:14.3061692Z                      '${1}0${2}'
2026-01-11T19:28:14.3061823Z                                  $changesMade = $true
2026-01-11T19:28:14.3063439Z                                  Write-Log "  ‚úì Downloads during gameplay disabled" "INFO"
2026-01-11T19:28:14.3063577Z                              }
2026-01-11T19:28:14.3063675Z                      
2026-01-11T19:28:14.3064209Z                              # Enable low bandwidth mode
2026-01-11T19:28:14.3064999Z                              if ($EnableLowBandwidthMode) {
2026-01-11T19:28:14.3065539Z                                  $configContent = $configContent -replace '("LowBandwidthMode"\s+")\d+(")', '${1}1${2}'
2026-01-11T19:28:14.3066613Z                                  $changesMade = $true
2026-01-11T19:28:14.3067388Z                                  Write-Log "  ‚úì Low bandwidth mode enabled" "INFO"
2026-01-11T19:28:14.3067847Z                              }
2026-01-11T19:28:14.3068721Z                      
2026-01-11T19:28:14.3069648Z                              if ($changesMade) {
2026-01-11T19:28:14.3069853Z                                  # Write config back
2026-01-11T19:28:14.3071712Z                                  Set-Content -Path $configPath -Value $configContent -ErrorAction Stop
2026-01-11T19:28:14.3072054Z                                  Write-Log "Steam gaming settings applied successfully" "SUCCESS"
2026-01-11T19:28:14.3072234Z                                  Write-Log "Backup: $backup" "INFO"
2026-01-11T19:28:14.3072384Z                              }
2026-01-11T19:28:14.3073468Z                              else {
2026-01-11T19:28:14.3074190Z                                  Write-Log "No Steam settings were changed (all parameters false)" "INFO"
2026-01-11T19:28:14.3074556Z                              }
2026-01-11T19:28:14.3075552Z                          }
2026-01-11T19:28:14.3075777Z                          catch {
2026-01-11T19:28:14.3076968Z                              Write-Log "Failed to apply Steam settings: $_" "ERROR"
2026-01-11T19:28:14.3077262Z                              Write-Log "You can restore from backup: $backup" "INFO"
2026-01-11T19:28:14.3078368Z                          }
2026-01-11T19:28:14.3079056Z                      }
2026-01-11T19:28:14.3079155Z                      
2026-01-11T19:28:14.3079977Z                      
2026-01-11T19:28:14.3080539Z                      function Set-MonitorRefreshRate {
2026-01-11T19:28:14.3081323Z                          <#
2026-01-11T19:28:14.3082491Z                          .SYNOPSIS
2026-01-11T19:28:14.3082993Z                              Sets monitor refresh rate to maximum supported value.
2026-01-11T19:28:14.3083757Z                          .DESCRIPTION
2026-01-11T19:28:14.3084094Z                              Enumerates display modes via WMI and applies the highest refresh rate
2026-01-11T19:28:14.3085431Z                              available for the current resolution. Supports primary monitor only.
2026-01-11T19:28:14.3085635Z                          .PARAMETER SetToMaximum
2026-01-11T19:28:14.3085976Z                              When true, sets refresh rate to highest supported. When false, only logs.
2026-01-11T19:28:14.3086382Z                          .OUTPUTS
2026-01-11T19:28:14.3087595Z                              None.
2026-01-11T19:28:14.3087703Z                          .NOTES
2026-01-11T19:28:14.3088933Z                              Requires Administrator. Multi-monitor setups will only affect primary.
2026-01-11T19:28:14.3089292Z                              Resolution remains unchanged - only refresh rate is modified.
2026-01-11T19:28:14.3089516Z                          #>
2026-01-11T19:28:14.3091144Z                          [CmdletBinding()]
2026-01-11T19:28:14.3091532Z                          param(
2026-01-11T19:28:14.3092497Z                              [bool]$SetToMaximum = $false
2026-01-11T19:28:14.3092935Z                          )
2026-01-11T19:28:14.3094013Z                      
2026-01-11T19:28:14.3094277Z                          Write-Log "Detecting monitor refresh rate..." "INFO"
2026-01-11T19:28:14.3095148Z                      
2026-01-11T19:28:14.3095370Z                          try {
2026-01-11T19:28:14.3095943Z                              # Get current display configuration
2026-01-11T19:28:14.3096992Z                              Add-Type -TypeDefinition @"
2026-01-11T19:28:14.3097444Z                              using System;
2026-01-11T19:28:14.3098600Z                              using System.Runtime.InteropServices;
2026-01-11T19:28:14.3099047Z                      
2026-01-11T19:28:14.3099940Z                              public class DisplayConfig {
2026-01-11T19:28:14.3100543Z                                  [DllImport("user32.dll")]
2026-01-11T19:28:14.3101916Z                                  public static extern int EnumDisplaySettings(string deviceName, int modeNum, ref 
2026-01-11T19:28:14.3102058Z                      DEVMODE devMode);
2026-01-11T19:28:14.3102702Z                      
2026-01-11T19:28:14.3103680Z                                  [DllImport("user32.dll")]
2026-01-11T19:28:14.3104477Z                                  public static extern int ChangeDisplaySettings(ref DEVMODE devMode, int flags);
2026-01-11T19:28:14.3104589Z                      
2026-01-11T19:28:14.3105485Z                                  [StructLayout(LayoutKind.Sequential)]
2026-01-11T19:28:14.3106186Z                                  public struct DEVMODE {
2026-01-11T19:28:14.3107169Z                                      [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 32)]
2026-01-11T19:28:14.3107887Z                                      public string dmDeviceName;
2026-01-11T19:28:14.3109000Z                                      public short dmSpecVersion;
2026-01-11T19:28:14.3109219Z                                      public short dmDriverVersion;
2026-01-11T19:28:14.3109502Z                                      public short dmSize;
2026-01-11T19:28:14.3110568Z                                      public short dmDriverExtra;
2026-01-11T19:28:14.3110898Z                                      public int dmFields;
2026-01-11T19:28:14.3111911Z                                      public int dmPositionX;
2026-01-11T19:28:14.3112402Z                                      public int dmPositionY;
2026-01-11T19:28:14.3113350Z                                      public int dmDisplayOrientation;
2026-01-11T19:28:14.3114126Z                                      public int dmDisplayFixedOutput;
2026-01-11T19:28:14.3114982Z                                      public short dmColor;
2026-01-11T19:28:14.3115282Z                                      public short dmDuplex;
2026-01-11T19:28:14.3116580Z                                      public short dmYResolution;
2026-01-11T19:28:14.3116741Z                                      public short dmTTOption;
2026-01-11T19:28:14.3117730Z                                      public short dmCollate;
2026-01-11T19:28:14.3118533Z                                      [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 32)]
2026-01-11T19:28:14.3118692Z                                      public string dmFormName;
2026-01-11T19:28:14.3119174Z                                      public short dmLogPixels;
2026-01-11T19:28:14.3119573Z                                      public int dmBitsPerPel;
2026-01-11T19:28:14.3120004Z                                      public int dmPelsWidth;
2026-01-11T19:28:14.3120387Z                                      public int dmPelsHeight;
2026-01-11T19:28:14.3120834Z                                      public int dmDisplayFlags;
2026-01-11T19:28:14.3121231Z                                      public int dmDisplayFrequency;
2026-01-11T19:28:14.3121649Z                                      public int dmICMMethod;
2026-01-11T19:28:14.3122014Z                                      public int dmICMIntent;
2026-01-11T19:28:14.3123075Z                                      public int dmMediaType;
2026-01-11T19:28:14.3123248Z                                      public int dmDitherType;
2026-01-11T19:28:14.3124150Z                                      public int dmReserved1;
2026-01-11T19:28:14.3124988Z                                      public int dmReserved2;
2026-01-11T19:28:14.3125494Z                                      public int dmPanningWidth;
2026-01-11T19:28:14.3126640Z                                      public int dmPanningHeight;
2026-01-11T19:28:14.3126767Z                                  }
2026-01-11T19:28:14.3127846Z                              }
2026-01-11T19:28:14.3128109Z                      "@ -ErrorAction SilentlyContinue
2026-01-11T19:28:14.3129381Z                      
2026-01-11T19:28:14.3129594Z                              $devMode = New-Object DisplayConfig+DEVMODE
2026-01-11T19:28:14.3131936Z                              $devMode.dmSize = [System.Runtime.InteropServices.Marshal]::SizeOf($devMode)
2026-01-11T19:28:14.3132080Z                      
2026-01-11T19:28:14.3132603Z                              # Get current settings (mode -1 = current)
2026-01-11T19:28:14.3133048Z                              $result = [DisplayConfig]::EnumDisplaySettings($null, -1, [ref]$devMode)
2026-01-11T19:28:14.3133141Z                      
2026-01-11T19:28:14.3134066Z                              if ($result -eq 0) {
2026-01-11T19:28:14.3134710Z                                  Write-Log "Failed to detect current display settings" "ERROR"
2026-01-11T19:28:14.3135514Z                                  return
2026-01-11T19:28:14.3136302Z                              }
2026-01-11T19:28:14.3136719Z                      
2026-01-11T19:28:14.3138157Z                              $currentHz = $devMode.dmDisplayFrequency
2026-01-11T19:28:14.3138393Z                              $currentWidth = $devMode.dmPelsWidth
2026-01-11T19:28:14.3138634Z                              $currentHeight = $devMode.dmPelsHeight
2026-01-11T19:28:14.3138958Z                      
2026-01-11T19:28:14.3140363Z                              Write-Log "Current: ${currentWidth}x${currentHeight} @ ${currentHz}Hz" "INFO"
2026-01-11T19:28:14.3140624Z                      
2026-01-11T19:28:14.3141722Z                              # Enumerate all available modes to find max refresh rate
2026-01-11T19:28:14.3142040Z                              $maxHz = $currentHz
2026-01-11T19:28:14.3143091Z                              $modeNum = 0
2026-01-11T19:28:14.3143345Z                              $testMode = New-Object DisplayConfig+DEVMODE
2026-01-11T19:28:14.3144588Z                              $testMode.dmSize = [System.Runtime.InteropServices.Marshal]::SizeOf($testMode)
2026-01-11T19:28:14.3144741Z                      
2026-01-11T19:28:14.3146094Z                              while ([DisplayConfig]::EnumDisplaySettings($null, $modeNum, [ref]$testMode) -ne 0) {
2026-01-11T19:28:14.3146439Z                                  # Only consider modes with current resolution
2026-01-11T19:28:14.3147103Z                                  if ($testMode.dmPelsWidth -eq $currentWidth -and $testMode.dmPelsHeight -eq 
2026-01-11T19:28:14.3148104Z                      $currentHeight) {
2026-01-11T19:28:14.3148353Z                                      if ($testMode.dmDisplayFrequency -gt $maxHz) {
2026-01-11T19:28:14.3149114Z                                          $maxHz = $testMode.dmDisplayFrequency
2026-01-11T19:28:14.3150058Z                                      }
2026-01-11T19:28:14.3150741Z                                  }
2026-01-11T19:28:14.3151885Z                                  $modeNum++
2026-01-11T19:28:14.3152714Z                              }
2026-01-11T19:28:14.3153868Z                      
2026-01-11T19:28:14.3154132Z                              Write-Log "Maximum supported: ${maxHz}Hz" "INFO"
2026-01-11T19:28:14.3154901Z                      
2026-01-11T19:28:14.3155998Z                              if ($maxHz -eq $currentHz) {
2026-01-11T19:28:14.3156669Z                                  Write-Log "Already running at maximum refresh rate" "SUCCESS"
2026-01-11T19:28:14.3156949Z                                  return
2026-01-11T19:28:14.3158102Z                              }
2026-01-11T19:28:14.3158212Z                      
2026-01-11T19:28:14.3159297Z                              if ($SetToMaximum) {
2026-01-11T19:28:14.3159463Z                                  # Apply new refresh rate
2026-01-11T19:28:14.3160171Z                                  $devMode.dmDisplayFrequency = $maxHz
2026-01-11T19:28:14.3160576Z                                  $devMode.dmFields = 0x00400000  # DM_DISPLAYFREQUENCY
2026-01-11T19:28:14.3160821Z                      
2026-01-11T19:28:14.3161907Z                                  $changeResult = [DisplayConfig]::ChangeDisplaySettings([ref]$devMode, 0)
2026-01-11T19:28:14.3162044Z                      
2026-01-11T19:28:14.3163165Z                                  if ($changeResult -eq 0) {
2026-01-11T19:28:14.3164277Z                                      Write-Log "Refresh rate set to ${maxHz}Hz successfully" "SUCCESS"
2026-01-11T19:28:14.3164407Z                                  }
2026-01-11T19:28:14.3164516Z                                  else {
2026-01-11T19:28:14.3165676Z                                      Write-Log "Failed to change refresh rate (error code: $changeResult)" "ERROR"
2026-01-11T19:28:14.3165834Z                                  }
2026-01-11T19:28:14.3165954Z                              }
2026-01-11T19:28:14.3167079Z                              else {
2026-01-11T19:28:14.3167401Z                                  Write-Log "Set -SetToMaximum `$true to apply ${maxHz}Hz" "INFO"
2026-01-11T19:28:14.3167704Z                              }
2026-01-11T19:28:14.3168802Z                          }
2026-01-11T19:28:14.3168993Z                          catch {
2026-01-11T19:28:14.3169712Z                              Write-Log "Failed to configure monitor refresh rate: $_" "ERROR"
2026-01-11T19:28:14.3170609Z                          }
2026-01-11T19:28:14.3170802Z                      }
2026-01-11T19:28:14.3172059Z                      
2026-01-11T19:28:14.3172884Z                      
2026-01-11T19:28:14.3173874Z                      # Export functions
2026-01-11T19:28:14.3174464Z                      Export-ModuleMember -Function @(
2026-01-11T19:28:14.3175357Z                          'Set-DiscordGamingSettings',
2026-01-11T19:28:14.3175760Z                          'Set-AudioDeviceProperties',
2026-01-11T19:28:14.3176610Z                          'Set-SteamGamingSettings',
2026-01-11T19:28:14.3177669Z                          'Set-MonitorRefreshRate'
2026-01-11T19:28:14.3178068Z                      )
2026-01-11T19:28:14.3179269Z [32;1mCleanBlock         : [0m
2026-01-11T19:28:14.3179766Z [32;1mDynamicParamBlock  : [0m
2026-01-11T19:28:14.3180759Z [32;1mScriptRequirements : [0m
2026-01-11T19:28:14.3182676Z [32;1mExtent             : [0m<#
2026-01-11T19:28:14.3182800Z                      .SYNOPSIS
2026-01-11T19:28:14.3183972Z                          Software configuration automation (Discord, Steam, Audio, Monitor).
2026-01-11T19:28:14.3184112Z                      .DESCRIPTION
2026-01-11T19:28:14.3185514Z                          Automates settings for gaming software and Windows multimedia devices that
2026-01-11T19:28:14.3185900Z                          are typically manual. Requires apps to be closed before running. Creates
2026-01-11T19:28:14.3186109Z                          backups of all config files before modification.
2026-01-11T19:28:14.3187022Z                      .NOTES
2026-01-11T19:28:14.3187433Z                          Requires Administrator for audio registry changes. Discord and Steam config
2026-01-11T19:28:14.3187800Z                          modifications work without elevation but apps must be closed.
2026-01-11T19:28:14.3188464Z                      #>
2026-01-11T19:28:14.3189325Z                      
2026-01-11T19:28:14.3190470Z                      Import-Module (Join-Path $PSScriptRoot "..\core\logger.psm1") -Force -Global
2026-01-11T19:28:14.3191138Z                      Import-Module (Join-Path $PSScriptRoot "..\core\registry.psm1") -Force -Global
2026-01-11T19:28:14.3191874Z                      
2026-01-11T19:28:14.3192816Z                      
2026-01-11T19:28:14.3193733Z                      function Backup-ConfigFile {
2026-01-11T19:28:14.3194453Z                          <#
2026-01-11T19:28:14.3195724Z                          .SYNOPSIS
2026-01-11T19:28:14.3195951Z                              Creates a timestamped backup of a config file.
2026-01-11T19:28:14.3196886Z                          .DESCRIPTION
2026-01-11T19:28:14.3197826Z                              Copies the file to a .backup_TIMESTAMP extension in the same directory.
2026-01-11T19:28:14.3198394Z                              Returns backup path on success or $false on failure.
2026-01-11T19:28:14.3199720Z                          .PARAMETER Path
2026-01-11T19:28:14.3200359Z                              Path to the config file to backup.
2026-01-11T19:28:14.3200527Z                          .OUTPUTS
2026-01-11T19:28:14.3201232Z                              [string] Backup file path, or [bool]$false on failure.
2026-01-11T19:28:14.3202082Z                          #>
2026-01-11T19:28:14.3202335Z                          param(
2026-01-11T19:28:14.3203136Z                              [Parameter(Mandatory = $true)]
2026-01-11T19:28:14.3203275Z                              [string]$Path
2026-01-11T19:28:14.3204383Z                          )
2026-01-11T19:28:14.3204568Z                      
2026-01-11T19:28:14.3205659Z                          try {
2026-01-11T19:28:14.3205882Z                              if (-not (Test-Path $Path)) {
2026-01-11T19:28:14.3206885Z                                  Write-Log "Cannot backup: file not found: $Path" "WARNING"
2026-01-11T19:28:14.3207243Z                                  return $false
2026-01-11T19:28:14.3208268Z                              }
2026-01-11T19:28:14.3208459Z                      
2026-01-11T19:28:14.3209244Z                              $timestamp = Get-Date -Format "yyyyMMdd_HHmmss"
2026-01-11T19:28:14.3209729Z                              $backupPath = "$Path.backup_$timestamp"
2026-01-11T19:28:14.3210821Z                      
2026-01-11T19:28:14.3211856Z                              Copy-Item -Path $Path -Destination $backupPath -Force -ErrorAction Stop
2026-01-11T19:28:14.3212213Z                              Write-Log "Backup created: $backupPath" "INFO"
2026-01-11T19:28:14.3213368Z                              return $backupPath
2026-01-11T19:28:14.3213778Z                          }
2026-01-11T19:28:14.3214864Z                          catch {
2026-01-11T19:28:14.3215198Z                              Write-Log "Failed to backup $Path : $_" "ERROR"
2026-01-11T19:28:14.3216194Z                              return $false
2026-01-11T19:28:14.3216309Z                          }
2026-01-11T19:28:14.3217095Z                      }
2026-01-11T19:28:14.3217206Z                      
2026-01-11T19:28:14.3218312Z                      
2026-01-11T19:28:14.3218670Z                      function Set-DiscordGamingSettings {
2026-01-11T19:28:14.3219843Z                          <#
2026-01-11T19:28:14.3220624Z                          .SYNOPSIS
2026-01-11T19:28:14.3221364Z                              Applies gaming-optimized settings to Discord.
2026-01-11T19:28:14.3222249Z                          .DESCRIPTION
2026-01-11T19:28:14.3222993Z                              Modifies Discord's settings.json to disable performance-impacting features.
2026-01-11T19:28:14.3224532Z                              Creates backup before changes. Skips if Discord is running or not installed.
2026-01-11T19:28:14.3224716Z                          .PARAMETER DisableHardwareAccel
2026-01-11T19:28:14.3224932Z                              Disable GPU hardware acceleration (reduces GPU load).
2026-01-11T19:28:14.3225129Z                          .PARAMETER DisableOverlay
2026-01-11T19:28:14.3226176Z                              Disable in-game overlay (reduces latency).
2026-01-11T19:28:14.3226342Z                          .PARAMETER DisableActivityStatus
2026-01-11T19:28:14.3226983Z                              Disable activity status broadcasting (reduces network traffic).
2026-01-11T19:28:14.3227930Z                          .PARAMETER DisableEchoCancellation
2026-01-11T19:28:14.3228215Z                              Disable echo cancellation (reduces CPU load, use headphones).
2026-01-11T19:28:14.3229313Z                          .PARAMETER StandardNoiseSuppression
2026-01-11T19:28:14.3229569Z                              Set noise suppression to standard (balanced).
2026-01-11T19:28:14.3230792Z                          .PARAMETER DisableAutoGainControl
2026-01-11T19:28:14.3232457Z                              Disable automatic gain control (consistent mic volume).
2026-01-11T19:28:14.3232593Z                          .OUTPUTS
2026-01-11T19:28:14.3232799Z                              None.
2026-01-11T19:28:14.3232907Z                          .NOTES
2026-01-11T19:28:14.3233749Z                              Discord may overwrite these settings on launch in rare cases. If settings
2026-01-11T19:28:14.3234071Z                              revert, consider using Discord's UI to apply them manually.
2026-01-11T19:28:14.3234464Z                          #>
2026-01-11T19:28:14.3235287Z                          [CmdletBinding()]
2026-01-11T19:28:14.3236002Z                          param(
2026-01-11T19:28:14.3236663Z                              [bool]$DisableHardwareAccel = $false,
2026-01-11T19:28:14.3237119Z                              [bool]$DisableOverlay = $false,
2026-01-11T19:28:14.3237618Z                              [bool]$DisableActivityStatus = $false,
2026-01-11T19:28:14.3238856Z                              [bool]$DisableEchoCancellation = $false,
2026-01-11T19:28:14.3239552Z                              [bool]$StandardNoiseSuppression = $false,
2026-01-11T19:28:14.3240227Z                              [bool]$DisableAutoGainControl = $false
2026-01-11T19:28:14.3240750Z                          )
2026-01-11T19:28:14.3241507Z                      
2026-01-11T19:28:14.3242295Z                          Write-Log "Configuring Discord gaming settings..." "INFO"
2026-01-11T19:28:14.3242427Z                      
2026-01-11T19:28:14.3242747Z                          $settingsPath = Join-Path $env:APPDATA "discord\settings.json"
2026-01-11T19:28:14.3243561Z                      
2026-01-11T19:28:14.3244624Z                          # Check if Discord is installed
2026-01-11T19:28:14.3244871Z                          if (-not (Test-Path $settingsPath)) {
2026-01-11T19:28:14.3245247Z                              Write-Log "Discord not found at $settingsPath - skipping" "INFO"
2026-01-11T19:28:14.3245480Z                              return
2026-01-11T19:28:14.3246284Z                          }
2026-01-11T19:28:14.3247252Z                      
2026-01-11T19:28:14.3247499Z                          # Check if Discord is running
2026-01-11T19:28:14.3248169Z                          $discordProcess = Get-Process -Name "Discord" -ErrorAction SilentlyContinue
2026-01-11T19:28:14.3248352Z                          if ($discordProcess) {
2026-01-11T19:28:14.3249050Z                              Write-Log "‚ö†Ô∏è  Discord is running! Please close Discord and re-run this script." "WARNING"
2026-01-11T19:28:14.3249484Z                              Write-Log "Discord settings NOT applied (app must be closed first)" "WARNING"
2026-01-11T19:28:14.3249591Z                              return
2026-01-11T19:28:14.3250359Z                          }
2026-01-11T19:28:14.3250902Z                      
2026-01-11T19:28:14.3251607Z                          try {
2026-01-11T19:28:14.3252563Z                              # Backup existing settings
2026-01-11T19:28:14.3252806Z                              $backup = Backup-ConfigFile -Path $settingsPath
2026-01-11T19:28:14.3253016Z                              if ($backup -eq $false) {
2026-01-11T19:28:14.3253896Z                                  Write-Log "Skipping Discord settings (backup failed)" "WARNING"
2026-01-11T19:28:14.3254274Z                                  return
2026-01-11T19:28:14.3254851Z                              }
2026-01-11T19:28:14.3255501Z                      
2026-01-11T19:28:14.3255837Z                              # Read existing settings
2026-01-11T19:28:14.3256344Z                              $settingsJson = Get-Content $settingsPath -Raw -ErrorAction Stop
2026-01-11T19:28:14.3256712Z                              $settings = $settingsJson | ConvertFrom-Json
2026-01-11T19:28:14.3257525Z                      
2026-01-11T19:28:14.3258348Z                              # Apply settings
2026-01-11T19:28:14.3258804Z                              $changesMade = $false
2026-01-11T19:28:14.3258949Z                      
2026-01-11T19:28:14.3259932Z                              # Note: Hardware acceleration is NOT exposed in settings.json
2026-01-11T19:28:14.3261287Z                              # It can only be disabled via UI or by modifying Discord shortcuts with 
2026-01-11T19:28:14.3261524Z                      --disable-hardware-acceleration flag
2026-01-11T19:28:14.3261737Z                              if ($DisableHardwareAccel) {
2026-01-11T19:28:14.3263049Z                                  Write-Log "  ‚ö†Ô∏è  Hardware acceleration requires manual configuration:" "WARNING"
2026-01-11T19:28:14.3264736Z                                  Write-Log "      Option 1: User Settings ‚Üí Advanced ‚Üí Toggle Hardware Acceleration 
2026-01-11T19:28:14.3264866Z                      OFF" "INFO"
2026-01-11T19:28:14.3265353Z                                  Write-Log "      Option 2: Add --disable-hardware-acceleration to Discord shortcut 
2026-01-11T19:28:14.3265655Z                      target" "INFO"
2026-01-11T19:28:14.3266414Z                              }
2026-01-11T19:28:14.3267545Z                      
2026-01-11T19:28:14.3267755Z                              if ($DisableOverlay) {
2026-01-11T19:28:14.3268560Z                                  $settings | Add-Member -NotePropertyName "OVERLAY" -NotePropertyValue $false -Force
2026-01-11T19:28:14.3268867Z                                  $changesMade = $true
2026-01-11T19:28:14.3270531Z                                  Write-Log "  ‚úì Overlay disabled" "INFO"
2026-01-11T19:28:14.3270644Z                              }
2026-01-11T19:28:14.3270867Z                      
2026-01-11T19:28:14.3271471Z                              if ($DisableActivityStatus) {
2026-01-11T19:28:14.3272517Z                                  $settings | Add-Member -NotePropertyName "status" -NotePropertyValue "invisible" 
2026-01-11T19:28:14.3273360Z                      -Force
2026-01-11T19:28:14.3273533Z                                  $changesMade = $true
2026-01-11T19:28:14.3274774Z                                  Write-Log "  ‚úì Activity status hidden" "INFO"
2026-01-11T19:28:14.3274895Z                              }
2026-01-11T19:28:14.3275149Z                      
2026-01-11T19:28:14.3275558Z                              if ($DisableEchoCancellation) {
2026-01-11T19:28:14.3276277Z                                  $settings | Add-Member -NotePropertyName "echoCancellation" -NotePropertyValue $false 
2026-01-11T19:28:14.3276400Z                      -Force
2026-01-11T19:28:14.3277065Z                                  $changesMade = $true
2026-01-11T19:28:14.3277918Z                                  Write-Log "  ‚úì Echo cancellation disabled" "INFO"
2026-01-11T19:28:14.3278130Z                              }
2026-01-11T19:28:14.3279048Z                      
2026-01-11T19:28:14.3279633Z                              if ($StandardNoiseSuppression) {
2026-01-11T19:28:14.3280677Z                                  $settings | Add-Member -NotePropertyName "noiseSuppression" -NotePropertyValue 
2026-01-11T19:28:14.3280863Z                      "standard" -Force
2026-01-11T19:28:14.3281013Z                                  $changesMade = $true
2026-01-11T19:28:14.3281708Z                                  Write-Log "  ‚úì Noise suppression set to standard" "INFO"
2026-01-11T19:28:14.3281966Z                              }
2026-01-11T19:28:14.3282554Z                      
2026-01-11T19:28:14.3283230Z                              if ($DisableAutoGainControl) {
2026-01-11T19:28:14.3284944Z                                  $settings | Add-Member -NotePropertyName "automaticGainControl" -NotePropertyValue 
2026-01-11T19:28:14.3285096Z                      $false -Force
2026-01-11T19:28:14.3285266Z                                  $changesMade = $true
2026-01-11T19:28:14.3286257Z                                  Write-Log "  ‚úì Auto gain control disabled" "INFO"
2026-01-11T19:28:14.3286660Z                              }
2026-01-11T19:28:14.3287220Z                      
2026-01-11T19:28:14.3288355Z                              if ($changesMade) {
2026-01-11T19:28:14.3288669Z                                  # Write settings back to file
2026-01-11T19:28:14.3289940Z                                  $settings | ConvertTo-Json -Depth 10 | Set-Content $settingsPath -ErrorAction Stop
2026-01-11T19:28:14.3290718Z                                  Write-Log "Discord gaming settings applied successfully" "SUCCESS"
2026-01-11T19:28:14.3290913Z                                  Write-Log "Backup: $backup" "INFO"
2026-01-11T19:28:14.3291592Z                              }
2026-01-11T19:28:14.3292167Z                              else {
2026-01-11T19:28:14.3293298Z                                  Write-Log "No Discord settings were changed (all parameters false)" "INFO"
2026-01-11T19:28:14.3293398Z                              }
2026-01-11T19:28:14.3293851Z                          }
2026-01-11T19:28:14.3294467Z                          catch {
2026-01-11T19:28:14.3295757Z                              Write-Log "Failed to apply Discord settings: $_" "ERROR"
2026-01-11T19:28:14.3296639Z                              Write-Log "You can restore from backup: $backup" "INFO"
2026-01-11T19:28:14.3296916Z                          }
2026-01-11T19:28:14.3297231Z                      }
2026-01-11T19:28:14.3297842Z                      
2026-01-11T19:28:14.3298381Z                      
2026-01-11T19:28:14.3299334Z                      function Set-AudioDeviceProperties {
2026-01-11T19:28:14.3299616Z                          <#
2026-01-11T19:28:14.3300588Z                          .SYNOPSIS
2026-01-11T19:28:14.3301147Z                              Configures Windows audio device properties for low-latency gaming.
2026-01-11T19:28:14.3301562Z                          .DESCRIPTION
2026-01-11T19:28:14.3302379Z                              Modifies registry settings for the default playback device to optimize
2026-01-11T19:28:14.3302745Z                              sample rate, bit depth, exclusive mode, and disable enhancements.
2026-01-11T19:28:14.3302942Z                              Creates registry backups before changes.
2026-01-11T19:28:14.3303362Z                          .PARAMETER SampleRate
2026-01-11T19:28:14.3304062Z                              Sample rate in Hz (e.g., 48000, 96000, 192000). Higher = more CPU.
2026-01-11T19:28:14.3304392Z                              Default: 48000 (most compatible).
2026-01-11T19:28:14.3305516Z                          .PARAMETER BitDepth
2026-01-11T19:28:14.3305853Z                              Bit depth: 16 or 24. Higher = better quality, slightly more CPU.
2026-01-11T19:28:14.3306013Z                              Default: 24.
2026-01-11T19:28:14.3306930Z                          .PARAMETER DisableSpatialAudio
2026-01-11T19:28:14.3308198Z                              Disable spatial audio processing (lower latency).
2026-01-11T19:28:14.3308391Z                          .PARAMETER EnableExclusiveMode
2026-01-11T19:28:14.3309295Z                              Allow apps to take exclusive control (lowest latency for games).
2026-01-11T19:28:14.3309482Z                          .PARAMETER DisableEnhancements
2026-01-11T19:28:14.3310401Z                              Disable all audio enhancements (lower latency, predictable output).
2026-01-11T19:28:14.3310554Z                          .OUTPUTS
2026-01-11T19:28:14.3311717Z                              None.
2026-01-11T19:28:14.3312679Z                          .NOTES
2026-01-11T19:28:14.3313055Z                              Requires Administrator. Only modifies default playback device.
2026-01-11T19:28:14.3313354Z                          #>
2026-01-11T19:28:14.3313497Z                          [CmdletBinding()]
2026-01-11T19:28:14.3314146Z                          param(
2026-01-11T19:28:14.3315226Z                              [int]$SampleRate = 48000,
2026-01-11T19:28:14.3316094Z                              [int]$BitDepth = 24,
2026-01-11T19:28:14.3316612Z                              [bool]$DisableSpatialAudio = $false,
2026-01-11T19:28:14.3317407Z                              [bool]$EnableExclusiveMode = $false,
2026-01-11T19:28:14.3317965Z                              [bool]$DisableEnhancements = $false
2026-01-11T19:28:14.3318349Z                          )
2026-01-11T19:28:14.3318929Z                      
2026-01-11T19:28:14.3319978Z                          Write-Log "Configuring audio device properties..." "INFO"
2026-01-11T19:28:14.3320075Z                      
2026-01-11T19:28:14.3320644Z                          try {
2026-01-11T19:28:14.3321306Z                              # Get default audio device
2026-01-11T19:28:14.3322478Z                              $audioDevices = Get-ItemProperty -Path 
2026-01-11T19:28:14.3323168Z                      "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\MMDevices\Audio\Render\*" -ErrorAction Stop
2026-01-11T19:28:14.3323464Z                      
2026-01-11T19:28:14.3324328Z                              if (-not $audioDevices) {
2026-01-11T19:28:14.3324898Z                                  Write-Log "No audio devices found - skipping" "WARNING"
2026-01-11T19:28:14.3325964Z                                  return
2026-01-11T19:28:14.3326737Z                              }
2026-01-11T19:28:14.3327573Z                      
2026-01-11T19:28:14.3327890Z                              # Find default device (there should be one marked as default)
2026-01-11T19:28:14.3328593Z                              $defaultDevice = $audioDevices | Where-Object { $_."(default)" -ne $null } | 
2026-01-11T19:28:14.3328778Z                      Select-Object -First 1
2026-01-11T19:28:14.3330432Z                      
2026-01-11T19:28:14.3330650Z                              if (-not $defaultDevice) {
2026-01-11T19:28:14.3331304Z                                  # Fallback: use first device
2026-01-11T19:28:14.3332559Z                                  $defaultDevice = $audioDevices | Select-Object -First 1
2026-01-11T19:28:14.3332843Z                                  Write-Log "Using first available audio device" "INFO"
2026-01-11T19:28:14.3334141Z                              }
2026-01-11T19:28:14.3334766Z                      
2026-01-11T19:28:14.3335664Z                              $devicePath = $defaultDevice.PSPath
2026-01-11T19:28:14.3336509Z                              $deviceName = $defaultDevice."FriendlyName"
2026-01-11T19:28:14.3336621Z                      
2026-01-11T19:28:14.3337401Z                              Write-Log "Configuring device: $deviceName" "INFO"
2026-01-11T19:28:14.3337505Z                      
2026-01-11T19:28:14.3337870Z                              # Backup registry key
2026-01-11T19:28:14.3338776Z                              Backup-RegistryKey -Path $devicePath
2026-01-11T19:28:14.3339732Z                      
2026-01-11T19:28:14.3339891Z                              $changesMade = $false
2026-01-11T19:28:14.3340855Z                      
2026-01-11T19:28:14.3341670Z                              # Sample rate and bit depth
2026-01-11T19:28:14.3342681Z                              # Format GUID for audio properties: {f19f064d-082c-4e27-bc73-6882a1bb8e4c}
2026-01-11T19:28:14.3343017Z                              $formatKey = "{f19f064d-082c-4e27-bc73-6882a1bb8e4c},0"
2026-01-11T19:28:14.3343240Z                      
2026-01-11T19:28:14.3344162Z                              # Calculate format value (sample rate + bit depth)
2026-01-11T19:28:14.3345012Z                              # This is a complex binary value - simplified approach
2026-01-11T19:28:14.3345189Z                              if ($SampleRate -or $BitDepth) {
2026-01-11T19:28:14.3347098Z                                  Write-Log "  ‚ö†Ô∏è  Sample rate/bit depth changes require manual configuration" "WARNING"
2026-01-11T19:28:14.3347625Z                                  Write-Log "  Open Sound settings > Device properties > Additional device properties" 
2026-01-11T19:28:14.3347912Z                      "INFO"
2026-01-11T19:28:14.3348033Z                              }
2026-01-11T19:28:14.3348242Z                      
2026-01-11T19:28:14.3348850Z                              # Spatial audio (uses protected registry - requires ownership change)
2026-01-11T19:28:14.3349135Z                              if ($DisableSpatialAudio) {
2026-01-11T19:28:14.3350288Z                                  $spatialPath = Join-Path $devicePath "FxProperties"
2026-01-11T19:28:14.3351880Z                                  if (Set-ProtectedRegistryValue -Path $spatialPath -Name 
2026-01-11T19:28:14.3352286Z                      "{e4870e26-3cc5-4cd2-ba46-ca0a9a70ed04},3" -Value 0 -Type "DWORD") {
2026-01-11T19:28:14.3352603Z                                      $changesMade = $true
2026-01-11T19:28:14.3353329Z                                      Write-Log "  ‚úì Spatial audio disabled" "INFO"
2026-01-11T19:28:14.3353466Z                                  }
2026-01-11T19:28:14.3353815Z                              }
2026-01-11T19:28:14.3354593Z                      
2026-01-11T19:28:14.3355774Z                              # Exclusive mode (uses protected registry - requires ownership change)
2026-01-11T19:28:14.3356183Z                              if ($EnableExclusiveMode) {
2026-01-11T19:28:14.3357075Z                                  if (Set-ProtectedRegistryValue -Path $devicePath -Name 
2026-01-11T19:28:14.3357555Z                      "PKEY_AudioEndpoint_Disable_SysFx" -Value 0 -Type "DWORD") {
2026-01-11T19:28:14.3357956Z                                      $changesMade = $true
2026-01-11T19:28:14.3358746Z                                      Write-Log "  ‚úì Exclusive mode enabled" "INFO"
2026-01-11T19:28:14.3358875Z                                  }
2026-01-11T19:28:14.3359503Z                              }
2026-01-11T19:28:14.3359964Z                      
2026-01-11T19:28:14.3361558Z                              # Audio enhancements (uses protected registry - requires ownership change)
2026-01-11T19:28:14.3361733Z                              if ($DisableEnhancements) {
2026-01-11T19:28:14.3362090Z                                  if (Set-ProtectedRegistryValue -Path $devicePath -Name 
2026-01-11T19:28:14.3362729Z                      "{fc52a749-4be9-4510-896e-966ba6525980},3" -Value 0 -Type "DWORD") {
2026-01-11T19:28:14.3363201Z                                      $changesMade = $true
2026-01-11T19:28:14.3364243Z                                      Write-Log "  ‚úì Audio enhancements disabled" "INFO"
2026-01-11T19:28:14.3364403Z                                  }
2026-01-11T19:28:14.3364979Z                              }
2026-01-11T19:28:14.3365539Z                      
2026-01-11T19:28:14.3366204Z                              if ($changesMade) {
2026-01-11T19:28:14.3367067Z                                  Write-Log "Audio device properties configured successfully" "SUCCESS"
2026-01-11T19:28:14.3367878Z                                  Write-Log "‚ö†Ô∏è  Reboot or restart audio service for changes to take effect" "WARNING"
2026-01-11T19:28:14.3367998Z                              }
2026-01-11T19:28:14.3368740Z                              else {
2026-01-11T19:28:14.3370166Z                                  Write-Log "No audio settings were changed" "INFO"
2026-01-11T19:28:14.3370344Z                              }
2026-01-11T19:28:14.3371311Z                          }
2026-01-11T19:28:14.3371893Z                          catch {
2026-01-11T19:28:14.3373376Z                              Write-Log "Failed to configure audio device: $_" "ERROR"
2026-01-11T19:28:14.3373513Z                          }
2026-01-11T19:28:14.3373738Z                      }
2026-01-11T19:28:14.3374336Z                      
2026-01-11T19:28:14.3374919Z                      
2026-01-11T19:28:14.3376154Z                      function Set-SteamGamingSettings {
2026-01-11T19:28:14.3376261Z                          <#
2026-01-11T19:28:14.3376494Z                          .SYNOPSIS
2026-01-11T19:28:14.3377588Z                              Applies gaming-optimized settings to Steam.
2026-01-11T19:28:14.3378705Z                          .DESCRIPTION
2026-01-11T19:28:14.3379144Z                              Modifies Steam's localconfig.vdf to disable overlay, downloads during
2026-01-11T19:28:14.3379542Z                              gameplay, and enable low bandwidth mode. Creates backup before changes.
2026-01-11T19:28:14.3379828Z                              Skips if Steam is running or not installed.
2026-01-11T19:28:14.3380327Z                          .PARAMETER DisableOverlay
2026-01-11T19:28:14.3381260Z                              Disable Steam overlay (reduces latency).
2026-01-11T19:28:14.3381962Z                          .PARAMETER DisableDownloadsDuringGameplay
2026-01-11T19:28:14.3382334Z                              Prevent Steam from downloading updates while gaming.
2026-01-11T19:28:14.3382654Z                          .PARAMETER EnableLowBandwidthMode
2026-01-11T19:28:14.3383074Z                              Reduce Steam's bandwidth usage for UI/chat.
2026-01-11T19:28:14.3383378Z                          .OUTPUTS
2026-01-11T19:28:14.3384343Z                              None.
2026-01-11T19:28:14.3385095Z                          .NOTES
2026-01-11T19:28:14.3385539Z                              Auto-detects Steam user ID from most recently modified userdata folder.
2026-01-11T19:28:14.3386078Z                              Steam must be closed before running this function.
2026-01-11T19:28:14.3386643Z                          #>
2026-01-11T19:28:14.3387366Z                          [CmdletBinding()]
2026-01-11T19:28:14.3388320Z                          param(
2026-01-11T19:28:14.3389374Z                              [bool]$DisableOverlay = $false,
2026-01-11T19:28:14.3390339Z                              [bool]$DisableDownloadsDuringGameplay = $false,
2026-01-11T19:28:14.3390754Z                              [bool]$EnableLowBandwidthMode = $false
2026-01-11T19:28:14.3391523Z                          )
2026-01-11T19:28:14.3392087Z                      
2026-01-11T19:28:14.3393041Z                          Write-Log "Configuring Steam gaming settings..." "INFO"
2026-01-11T19:28:14.3393177Z                      
2026-01-11T19:28:14.3393757Z                          # Detect Steam installation path
2026-01-11T19:28:14.3394822Z                          $steamPath = $null
2026-01-11T19:28:14.3395569Z                          try {
2026-01-11T19:28:14.3397272Z                              $steamReg = Get-ItemProperty -Path "HKLM:\SOFTWARE\WOW6432Node\Valve\Steam" -ErrorAction 
2026-01-11T19:28:14.3397408Z                      SilentlyContinue
2026-01-11T19:28:14.3397565Z                              if ($steamReg) {
2026-01-11T19:28:14.3398470Z                                  $steamPath = $steamReg.InstallPath
2026-01-11T19:28:14.3399372Z                              }
2026-01-11T19:28:14.3399502Z                          }
2026-01-11T19:28:14.3400071Z                          catch {}
2026-01-11T19:28:14.3401018Z                      
2026-01-11T19:28:14.3401341Z                          if (-not $steamPath -or -not (Test-Path $steamPath)) {
2026-01-11T19:28:14.3401903Z                              Write-Log "Steam not found - skipping" "INFO"
2026-01-11T19:28:14.3402326Z                              return
2026-01-11T19:28:14.3403003Z                          }
2026-01-11T19:28:14.3403598Z                      
2026-01-11T19:28:14.3404908Z                          Write-Log "Steam found at: $steamPath" "INFO"
2026-01-11T19:28:14.3405216Z                      
2026-01-11T19:28:14.3405948Z                          # Check if Steam is running
2026-01-11T19:28:14.3406338Z                          $steamProcess = Get-Process -Name "steam" -ErrorAction SilentlyContinue
2026-01-11T19:28:14.3406474Z                          if ($steamProcess) {
2026-01-11T19:28:14.3407511Z                              Write-Log "‚ö†Ô∏è  Steam is running! Please close Steam and re-run this script." "WARNING"
2026-01-11T19:28:14.3408299Z                              Write-Log "Steam settings NOT applied (app must be closed first)" "WARNING"
2026-01-11T19:28:14.3408435Z                              return
2026-01-11T19:28:14.3408529Z                          }
2026-01-11T19:28:14.3408667Z                      
2026-01-11T19:28:14.3409571Z                          # Auto-detect user ID (most recent userdata folder)
2026-01-11T19:28:14.3410181Z                          $userdataPath = Join-Path $steamPath "userdata"
2026-01-11T19:28:14.3410783Z                      
2026-01-11T19:28:14.3411393Z                          if (-not (Test-Path $userdataPath)) {
2026-01-11T19:28:14.3412175Z                              Write-Log "Steam userdata folder not found - skipping" "WARNING"
2026-01-11T19:28:14.3412868Z                              return
2026-01-11T19:28:14.3412988Z                          }
2026-01-11T19:28:14.3413388Z                      
2026-01-11T19:28:14.3414668Z                          $userFolders = Get-ChildItem -Path $userdataPath -Directory -ErrorAction SilentlyContinue |
2026-01-11T19:28:14.3414879Z                              Sort-Object LastWriteTime -Descending
2026-01-11T19:28:14.3415195Z                      
2026-01-11T19:28:14.3415342Z                          if (-not $userFolders) {
2026-01-11T19:28:14.3416125Z                              Write-Log "No Steam user profiles found - skipping" "WARNING"
2026-01-11T19:28:14.3416740Z                              return
2026-01-11T19:28:14.3418112Z                          }
2026-01-11T19:28:14.3418251Z                      
2026-01-11T19:28:14.3418435Z                          $userId = $userFolders[0].Name
2026-01-11T19:28:14.3418972Z                          Write-Log "Using Steam user ID: $userId" "INFO"
2026-01-11T19:28:14.3419327Z                      
2026-01-11T19:28:14.3420384Z                          $configPath = Join-Path $userdataPath "$userId\config\localconfig.vdf"
2026-01-11T19:28:14.3421133Z                      
2026-01-11T19:28:14.3421858Z                          if (-not (Test-Path $configPath)) {
2026-01-11T19:28:14.3422685Z                              Write-Log "Steam config not found at $configPath - skipping" "WARNING"
2026-01-11T19:28:14.3422929Z                              return
2026-01-11T19:28:14.3423977Z                          }
2026-01-11T19:28:14.3424091Z                      
2026-01-11T19:28:14.3424527Z                          try {
2026-01-11T19:28:14.3425344Z                              # Backup config
2026-01-11T19:28:14.3426306Z                              $backup = Backup-ConfigFile -Path $configPath
2026-01-11T19:28:14.3426762Z                              if ($backup -eq $false) {
2026-01-11T19:28:14.3427841Z                                  Write-Log "Skipping Steam settings (backup failed)" "WARNING"
2026-01-11T19:28:14.3427961Z                                  return
2026-01-11T19:28:14.3428760Z                              }
2026-01-11T19:28:14.3428881Z                      
2026-01-11T19:28:14.3429688Z                              # Read config file
2026-01-11T19:28:14.3430072Z                              $configContent = Get-Content $configPath -Raw -ErrorAction Stop
2026-01-11T19:28:14.3430299Z                      
2026-01-11T19:28:14.3431257Z                              $changesMade = $false
2026-01-11T19:28:14.3431969Z                      
2026-01-11T19:28:14.3433148Z                              # Disable overlay (InGameOverlayShowFPSContrast)
2026-01-11T19:28:14.3433337Z                              if ($DisableOverlay) {
2026-01-11T19:28:14.3433843Z                                  # VDF uses key-value format: "key"		"value"
2026-01-11T19:28:14.3435186Z                                  $configContent = $configContent -replace 
2026-01-11T19:28:14.3435468Z                      '("InGameOverlayShowFPSContrast"\s+")\d+(")', '${1}0${2}'
2026-01-11T19:28:14.3436858Z                                  $changesMade = $true
2026-01-11T19:28:14.3437335Z                                  Write-Log "  ‚úì Steam overlay disabled" "INFO"
2026-01-11T19:28:14.3437556Z                              }
2026-01-11T19:28:14.3437914Z                      
2026-01-11T19:28:14.3439132Z                              # Disable downloads during gameplay
2026-01-11T19:28:14.3439568Z                              if ($DisableDownloadsDuringGameplay) {
2026-01-11T19:28:14.3441283Z                                  $configContent = $configContent -replace '("AllowDownloadsWhileRunning"\s+")\d+(")', 
2026-01-11T19:28:14.3441408Z                      '${1}0${2}'
2026-01-11T19:28:14.3441611Z                                  $changesMade = $true
2026-01-11T19:28:14.3442684Z                                  Write-Log "  ‚úì Downloads during gameplay disabled" "INFO"
2026-01-11T19:28:14.3442862Z                              }
2026-01-11T19:28:14.3443409Z                      
2026-01-11T19:28:14.3444090Z                              # Enable low bandwidth mode
2026-01-11T19:28:14.3445280Z                              if ($EnableLowBandwidthMode) {
2026-01-11T19:28:14.3445791Z                                  $configContent = $configContent -replace '("LowBandwidthMode"\s+")\d+(")', '${1}1${2}'
2026-01-11T19:28:14.3446702Z                                  $changesMade = $true
2026-01-11T19:28:14.3447263Z                                  Write-Log "  ‚úì Low bandwidth mode enabled" "INFO"
2026-01-11T19:28:14.3447376Z                              }
2026-01-11T19:28:14.3447503Z                      
2026-01-11T19:28:14.3448338Z                              if ($changesMade) {
2026-01-11T19:28:14.3449048Z                                  # Write config back
2026-01-11T19:28:14.3450151Z                                  Set-Content -Path $configPath -Value $configContent -ErrorAction Stop
2026-01-11T19:28:14.3450516Z                                  Write-Log "Steam gaming settings applied successfully" "SUCCESS"
2026-01-11T19:28:14.3450830Z                                  Write-Log "Backup: $backup" "INFO"
2026-01-11T19:28:14.3451509Z                              }
2026-01-11T19:28:14.3451837Z                              else {
2026-01-11T19:28:14.3452611Z                                  Write-Log "No Steam settings were changed (all parameters false)" "INFO"
2026-01-11T19:28:14.3452797Z                              }
2026-01-11T19:28:14.3454245Z                          }
2026-01-11T19:28:14.3454369Z                          catch {
2026-01-11T19:28:14.3454629Z                              Write-Log "Failed to apply Steam settings: $_" "ERROR"
2026-01-11T19:28:14.3455063Z                              Write-Log "You can restore from backup: $backup" "INFO"
2026-01-11T19:28:14.3456005Z                          }
2026-01-11T19:28:14.3456603Z                      }
2026-01-11T19:28:14.3457210Z                      
2026-01-11T19:28:14.3457493Z                      
2026-01-11T19:28:14.3457991Z                      function Set-MonitorRefreshRate {
2026-01-11T19:28:14.3458301Z                          <#
2026-01-11T19:28:14.3458799Z                          .SYNOPSIS
2026-01-11T19:28:14.3460190Z                              Sets monitor refresh rate to maximum supported value.
2026-01-11T19:28:14.3460333Z                          .DESCRIPTION
2026-01-11T19:28:14.3461002Z                              Enumerates display modes via WMI and applies the highest refresh rate
2026-01-11T19:28:14.3461394Z                              available for the current resolution. Supports primary monitor only.
2026-01-11T19:28:14.3461539Z                          .PARAMETER SetToMaximum
2026-01-11T19:28:14.3462298Z                              When true, sets refresh rate to highest supported. When false, only logs.
2026-01-11T19:28:14.3462693Z                          .OUTPUTS
2026-01-11T19:28:14.3463217Z                              None.
2026-01-11T19:28:14.3463659Z                          .NOTES
2026-01-11T19:28:14.3464916Z                              Requires Administrator. Multi-monitor setups will only affect primary.
2026-01-11T19:28:14.3465377Z                              Resolution remains unchanged - only refresh rate is modified.
2026-01-11T19:28:14.3465532Z                          #>
2026-01-11T19:28:14.3466284Z                          [CmdletBinding()]
2026-01-11T19:28:14.3467243Z                          param(
2026-01-11T19:28:14.3467485Z                              [bool]$SetToMaximum = $false
2026-01-11T19:28:14.3467587Z                          )
2026-01-11T19:28:14.3468201Z                      
2026-01-11T19:28:14.3469336Z                          Write-Log "Detecting monitor refresh rate..." "INFO"
2026-01-11T19:28:14.3470196Z                      
2026-01-11T19:28:14.3470495Z                          try {
2026-01-11T19:28:14.3470837Z                              # Get current display configuration
2026-01-11T19:28:14.3471842Z                              Add-Type -TypeDefinition @"
2026-01-11T19:28:14.3472569Z                              using System;
2026-01-11T19:28:14.3473435Z                              using System.Runtime.InteropServices;
2026-01-11T19:28:14.3474210Z                      
2026-01-11T19:28:14.3475008Z                              public class DisplayConfig {
2026-01-11T19:28:14.3475754Z                                  [DllImport("user32.dll")]
2026-01-11T19:28:14.3477223Z                                  public static extern int EnumDisplaySettings(string deviceName, int modeNum, ref 
2026-01-11T19:28:14.3478213Z                      DEVMODE devMode);
2026-01-11T19:28:14.3478824Z                      
2026-01-11T19:28:14.3479398Z                                  [DllImport("user32.dll")]
2026-01-11T19:28:14.3480478Z                                  public static extern int ChangeDisplaySettings(ref DEVMODE devMode, int flags);
2026-01-11T19:28:14.3481309Z                      
2026-01-11T19:28:14.3481675Z                                  [StructLayout(LayoutKind.Sequential)]
2026-01-11T19:28:14.3482197Z                                  public struct DEVMODE {
2026-01-11T19:28:14.3482775Z                                      [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 32)]
2026-01-11T19:28:14.3483383Z                                      public string dmDeviceName;
2026-01-11T19:28:14.3483898Z                                      public short dmSpecVersion;
2026-01-11T19:28:14.3484442Z                                      public short dmDriverVersion;
2026-01-11T19:28:14.3484968Z                                      public short dmSize;
2026-01-11T19:28:14.3485471Z                                      public short dmDriverExtra;
2026-01-11T19:28:14.3485993Z                                      public int dmFields;
2026-01-11T19:28:14.3486489Z                                      public int dmPositionX;
2026-01-11T19:28:14.3486991Z                                      public int dmPositionY;
2026-01-11T19:28:14.3487532Z                                      public int dmDisplayOrientation;
2026-01-11T19:28:14.3488110Z                                      public int dmDisplayFixedOutput;
2026-01-11T19:28:14.3488636Z                                      public short dmColor;
2026-01-11T19:28:14.3489398Z                                      public short dmDuplex;
2026-01-11T19:28:14.3490327Z                                      public short dmYResolution;
2026-01-11T19:28:14.3490840Z                                      public short dmTTOption;
2026-01-11T19:28:14.3491718Z                                      public short dmCollate;
2026-01-11T19:28:14.3492426Z                                      [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 32)]
2026-01-11T19:28:14.3493079Z                                      public string dmFormName;
2026-01-11T19:28:14.3493593Z                                      public short dmLogPixels;
2026-01-11T19:28:14.3494116Z                                      public int dmBitsPerPel;
2026-01-11T19:28:14.3495392Z                                      public int dmPelsWidth;
2026-01-11T19:28:14.3496049Z                                      public int dmPelsHeight;
2026-01-11T19:28:14.3496578Z                                      public int dmDisplayFlags;
2026-01-11T19:28:14.3497120Z                                      public int dmDisplayFrequency;
2026-01-11T19:28:14.3497628Z                                      public int dmICMMethod;
2026-01-11T19:28:14.3498111Z                                      public int dmICMIntent;
2026-01-11T19:28:14.3498596Z                                      public int dmMediaType;
2026-01-11T19:28:14.3499170Z                                      public int dmDitherType;
2026-01-11T19:28:14.3499898Z                                      public int dmReserved1;
2026-01-11T19:28:14.3500384Z                                      public int dmReserved2;
2026-01-11T19:28:14.3501233Z                                      public int dmPanningWidth;
2026-01-11T19:28:14.3501794Z                                      public int dmPanningHeight;
2026-01-11T19:28:14.3502316Z                                  }
2026-01-11T19:28:14.3502982Z                              }
2026-01-11T19:28:14.3503663Z                      "@ -ErrorAction SilentlyContinue
2026-01-11T19:28:14.3504557Z                      
2026-01-11T19:28:14.3505220Z                              $devMode = New-Object DisplayConfig+DEVMODE
2026-01-11T19:28:14.3506431Z                              $devMode.dmSize = [System.Runtime.InteropServices.Marshal]::SizeOf($devMode)
2026-01-11T19:28:14.3507247Z                      
2026-01-11T19:28:14.3507633Z                              # Get current settings (mode -1 = current)
2026-01-11T19:28:14.3508395Z                              $result = [DisplayConfig]::EnumDisplaySettings($null, -1, [ref]$devMode)
2026-01-11T19:28:14.3509053Z                      
2026-01-11T19:28:14.3509364Z                              if ($result -eq 0) {
2026-01-11T19:28:14.3510007Z                                  Write-Log "Failed to detect current display settings" "ERROR"
2026-01-11T19:28:14.3511098Z                                  return
2026-01-11T19:28:14.3511468Z                              }
2026-01-11T19:28:14.3511790Z                      
2026-01-11T19:28:14.3512173Z                              $currentHz = $devMode.dmDisplayFrequency
2026-01-11T19:28:14.3512748Z                              $currentWidth = $devMode.dmPelsWidth
2026-01-11T19:28:14.3513312Z                              $currentHeight = $devMode.dmPelsHeight
2026-01-11T19:28:14.3513782Z                      
2026-01-11T19:28:14.3514373Z                              Write-Log "Current: ${currentWidth}x${currentHeight} @ ${currentHz}Hz" "INFO"
2026-01-11T19:28:14.3515061Z                      
2026-01-11T19:28:14.3515504Z                              # Enumerate all available modes to find max refresh rate
2026-01-11T19:28:14.3516082Z                              $maxHz = $currentHz
2026-01-11T19:28:14.3516509Z                              $modeNum = 0
2026-01-11T19:28:14.3516976Z                              $testMode = New-Object DisplayConfig+DEVMODE
2026-01-11T19:28:14.3517858Z                              $testMode.dmSize = [System.Runtime.InteropServices.Marshal]::SizeOf($testMode)
2026-01-11T19:28:14.3518615Z                      
2026-01-11T19:28:14.3519296Z                              while ([DisplayConfig]::EnumDisplaySettings($null, $modeNum, [ref]$testMode) -ne 0) {
2026-01-11T19:28:14.3520197Z                                  # Only consider modes with current resolution
2026-01-11T19:28:14.3521069Z                                  if ($testMode.dmPelsWidth -eq $currentWidth -and $testMode.dmPelsHeight -eq 
2026-01-11T19:28:14.3521833Z                      $currentHeight) {
2026-01-11T19:28:14.3522361Z                                      if ($testMode.dmDisplayFrequency -gt $maxHz) {
2026-01-11T19:28:14.3523011Z                                          $maxHz = $testMode.dmDisplayFrequency
2026-01-11T19:28:14.3523713Z                                      }
2026-01-11T19:28:14.3524076Z                                  }
2026-01-11T19:28:14.3524523Z                                  $modeNum++
2026-01-11T19:28:14.3524921Z                              }
2026-01-11T19:28:14.3525223Z                      
2026-01-11T19:28:14.3525621Z                              Write-Log "Maximum supported: ${maxHz}Hz" "INFO"
2026-01-11T19:28:14.3526117Z                      
2026-01-11T19:28:14.3526457Z                              if ($maxHz -eq $currentHz) {
2026-01-11T19:28:14.3527081Z                                  Write-Log "Already running at maximum refresh rate" "SUCCESS"
2026-01-11T19:28:14.3527680Z                                  return
2026-01-11T19:28:14.3528039Z                              }
2026-01-11T19:28:14.3528338Z                      
2026-01-11T19:28:14.3528646Z                              if ($SetToMaximum) {
2026-01-11T19:28:14.3529094Z                                  # Apply new refresh rate
2026-01-11T19:28:14.3529608Z                                  $devMode.dmDisplayFrequency = $maxHz
2026-01-11T19:28:14.3530228Z                                  $devMode.dmFields = 0x00400000  # DM_DISPLAYFREQUENCY
2026-01-11T19:28:14.3531360Z                      
2026-01-11T19:28:14.3531938Z                                  $changeResult = [DisplayConfig]::ChangeDisplaySettings([ref]$devMode, 0)
2026-01-11T19:28:14.3532729Z                      
2026-01-11T19:28:14.3533056Z                                  if ($changeResult -eq 0) {
2026-01-11T19:28:14.3533737Z                                      Write-Log "Refresh rate set to ${maxHz}Hz successfully" "SUCCESS"
2026-01-11T19:28:14.3534406Z                                  }
2026-01-11T19:28:14.3534778Z                                  else {
2026-01-11T19:28:14.3535394Z                                      Write-Log "Failed to change refresh rate (error code: $changeResult)" "ERROR"
2026-01-11T19:28:14.3536130Z                                  }
2026-01-11T19:28:14.3536415Z                              }
2026-01-11T19:28:14.3536756Z                              else {
2026-01-11T19:28:14.3537575Z                                  Write-Log "Set -SetToMaximum `$true to apply ${maxHz}Hz" "INFO"
2026-01-11T19:28:14.3538293Z                              }
2026-01-11T19:28:14.3538617Z                          }
2026-01-11T19:28:14.3539184Z                          catch {
2026-01-11T19:28:14.3539774Z                              Write-Log "Failed to configure monitor refresh rate: $_" "ERROR"
2026-01-11T19:28:14.3540509Z                          }
2026-01-11T19:28:14.3541545Z                      }
2026-01-11T19:28:14.3541834Z                      
2026-01-11T19:28:14.3542124Z                      
2026-01-11T19:28:14.3543370Z                      # Export functions
2026-01-11T19:28:14.3543796Z                      Export-ModuleMember -Function @(
2026-01-11T19:28:14.3544313Z                          'Set-DiscordGamingSettings',
2026-01-11T19:28:14.3544786Z                          'Set-AudioDeviceProperties',
2026-01-11T19:28:14.3545223Z                          'Set-SteamGamingSettings',
2026-01-11T19:28:14.3546341Z                          'Set-MonitorRefreshRate'
2026-01-11T19:28:14.3546792Z                      )
2026-01-11T19:28:14.3547376Z                      
2026-01-11T19:28:14.3547914Z [32;1mParent             : [0m
2026-01-11T19:28:14.3548471Z 
2026-01-11T19:28:14.4056754Z [32;1mAttributes         : [0m{}
2026-01-11T19:28:14.4057391Z [32;1mUsingStatements    : [0m{}
2026-01-11T19:28:14.4057857Z [32;1mParamBlock         : [0m
2026-01-11T19:28:14.4058318Z [32;1mBeginBlock         : [0m
2026-01-11T19:28:14.4058782Z [32;1mProcessBlock       : [0m
2026-01-11T19:28:14.4062221Z [32;1mEndBlock           : [0mImport-Module (Join-Path $PSScriptRoot "..\core\logger.psm1") -Force -Global
2026-01-11T19:28:14.4063347Z                      Import-Module (Join-Path $PSScriptRoot "..\core\registry.psm1") -Force -Global
2026-01-11T19:28:14.4064386Z                      
2026-01-11T19:28:14.4064715Z                      
2026-01-11T19:28:14.4065126Z                      
2026-01-11T19:28:14.4065452Z                      function Get-SystemRAM {
2026-01-11T19:28:14.4066110Z                          <#
2026-01-11T19:28:14.4066569Z                          .SYNOPSIS
2026-01-11T19:28:14.4067269Z                              Returns total system RAM in GB.
2026-01-11T19:28:14.4068392Z                          .DESCRIPTION
2026-01-11T19:28:14.4069020Z                              Queries Win32_PhysicalMemory and sums capacity to produce total RAM.
2026-01-11T19:28:14.4069701Z                          .OUTPUTS
2026-01-11T19:28:14.4070353Z                              [int] Total RAM in gigabytes, or 0 on failure.
2026-01-11T19:28:14.4070802Z                          #>
2026-01-11T19:28:14.4071255Z                          try {
2026-01-11T19:28:14.4072130Z                              $totalRAM = [math]::Round((Get-CimInstance Win32_PhysicalMemory -ErrorAction Stop |
2026-01-11T19:28:14.4073068Z                                  Measure-Object -Property Capacity -Sum).Sum / 1GB)
2026-01-11T19:28:14.4073451Z                      
2026-01-11T19:28:14.4073962Z                              Write-Log "System RAM detected: ${totalRAM}GB" "INFO"
2026-01-11T19:28:14.4074361Z                              return $totalRAM
2026-01-11T19:28:14.4074735Z                          } catch {
2026-01-11T19:28:14.4075100Z                              Write-Log "Error detecting system RAM: $_" "ERROR"
2026-01-11T19:28:14.4075697Z                              return 0
2026-01-11T19:28:14.4076201Z                          }
2026-01-11T19:28:14.4076749Z                      }
2026-01-11T19:28:14.4077239Z                      
2026-01-11T19:28:14.4077571Z                      
2026-01-11T19:28:14.4078901Z                      function Test-SystemOptimizations {
2026-01-11T19:28:14.4079385Z                          <#
2026-01-11T19:28:14.4079707Z                          .SYNOPSIS
2026-01-11T19:28:14.4080261Z                              Verifies key system optimizations.
2026-01-11T19:28:14.4080702Z                          .DESCRIPTION
2026-01-11T19:28:14.4081312Z                              Checks page file policy, fast startup setting, and logs memory compression
2026-01-11T19:28:14.4082009Z                              state for visibility.
2026-01-11T19:28:14.4082241Z                          .OUTPUTS
2026-01-11T19:28:14.4082770Z                              [bool] True when checks pass, else false.
2026-01-11T19:28:14.4083197Z                          #>
2026-01-11T19:28:14.4083692Z                          $allPassed = $true
2026-01-11T19:28:14.4084034Z                      
2026-01-11T19:28:14.4085305Z                          Write-Log "Verifying system optimizations..." "INFO"
2026-01-11T19:28:14.4086081Z                      
2026-01-11T19:28:14.4087236Z                          try {
2026-01-11T19:28:14.4087829Z                              $ComputerSystem = Get-WmiObject Win32_ComputerSystem -EnableAllPrivileges
2026-01-11T19:28:14.4088557Z                              $totalRAM = Get-SystemRAM
2026-01-11T19:28:14.4088857Z                      
2026-01-11T19:28:14.4089133Z                              if ($totalRAM -ge 16) {
2026-01-11T19:28:14.4090113Z                                  if ($ComputerSystem.AutomaticManagedPagefile -eq $false) {
2026-01-11T19:28:14.4091126Z                                      Write-Log "‚úì Automatic page file management disabled" "SUCCESS"
2026-01-11T19:28:14.4091767Z                      
2026-01-11T19:28:14.4093089Z                                      $PageFile = Get-WmiObject -Query "Select * From Win32_PageFileSetting Where 
2026-01-11T19:28:14.4093755Z                      Name='C:\\pagefile.sys'"
2026-01-11T19:28:14.4094008Z                                      if ($PageFile) {
2026-01-11T19:28:14.4094658Z                                          $expectedSize = if ($totalRAM -ge 32) { 4096 } else { 8192 }
2026-01-11T19:28:14.4095189Z                      
2026-01-11T19:28:14.4096011Z                                          if ($PageFile.InitialSize -eq $expectedSize -and $PageFile.MaximumSize -eq 
2026-01-11T19:28:14.4096518Z                      $expectedSize) {
2026-01-11T19:28:14.4099096Z                                              Write-Log "‚úì Page file size: ${expectedSize}MB (correct for ${totalRAM}GB 
2026-01-11T19:28:14.4099768Z                      RAM)" "SUCCESS"
2026-01-11T19:28:14.4100002Z                                          } else {
2026-01-11T19:28:14.4100844Z                                              Write-Log "‚úó Page file size mismatch (current: 
2026-01-11T19:28:14.4101387Z                      $($PageFile.InitialSize)MB, expected: ${expectedSize}MB)" "ERROR"
2026-01-11T19:28:14.4101916Z                                              $allPassed = $false
2026-01-11T19:28:14.4102174Z                                          }
2026-01-11T19:28:14.4102517Z                                      } else {
2026-01-11T19:28:14.4103007Z                                          Write-Log "‚úó Page file not found" "ERROR"
2026-01-11T19:28:14.4103624Z                                          $allPassed = $false
2026-01-11T19:28:14.4104041Z                                      }
2026-01-11T19:28:14.4104516Z                                  } else {
2026-01-11T19:28:14.4105679Z                                      Write-Log "‚úó Automatic page file management still enabled" "ERROR"
2026-01-11T19:28:14.4106361Z                                      $allPassed = $false
2026-01-11T19:28:14.4106693Z                                  }
2026-01-11T19:28:14.4107922Z                              }
2026-01-11T19:28:14.4108301Z                      
2026-01-11T19:28:14.4110191Z                              $hiberboot = Get-RegistryValue -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Session 
2026-01-11T19:28:14.4111097Z                      Manager\Power" -Name "HiberbootEnabled"
2026-01-11T19:28:14.4111415Z                              if ($hiberboot -eq 0) {
2026-01-11T19:28:14.4112094Z                                  Write-Log "‚úì Fast Startup disabled" "SUCCESS"
2026-01-11T19:28:14.4112405Z                              } else {
2026-01-11T19:28:14.4113030Z                                  Write-Log "‚úó Fast Startup not disabled (current value: $hiberboot)" "ERROR"
2026-01-11T19:28:14.4113497Z                                  $allPassed = $false
2026-01-11T19:28:14.4113804Z                              }
2026-01-11T19:28:14.4114074Z                      
2026-01-11T19:28:14.4114379Z                              $mmAgent = Get-MMAgent -ErrorAction SilentlyContinue
2026-01-11T19:28:14.4115005Z                              if ($mmAgent) {
2026-01-11T19:28:14.4115757Z                                  $compressionStatus = if ($mmAgent.MemoryCompression) { "enabled" } else { "disabled" }
2026-01-11T19:28:14.4116522Z                                  Write-Log "Memory compression: $compressionStatus" "INFO"
2026-01-11T19:28:14.4117044Z                              }
2026-01-11T19:28:14.4117232Z                      
2026-01-11T19:28:14.4117474Z                          } catch {
2026-01-11T19:28:14.4118745Z                              Write-Log "Error during verification: $_" "ERROR"
2026-01-11T19:28:14.4119304Z                              $allPassed = $false
2026-01-11T19:28:14.4119670Z                          }
2026-01-11T19:28:14.4120008Z                      
2026-01-11T19:28:14.4120265Z                          return $allPassed
2026-01-11T19:28:14.4120893Z                      }
2026-01-11T19:28:14.4121438Z                      
2026-01-11T19:28:14.4121751Z                      
2026-01-11T19:28:14.4122818Z                      
2026-01-11T19:28:14.4123356Z                      
2026-01-11T19:28:14.4124307Z                      function Set-PageFile {
2026-01-11T19:28:14.4124677Z                          <#
2026-01-11T19:28:14.4125986Z                          .SYNOPSIS
2026-01-11T19:28:14.4127075Z                              Configures a fixed page file size on systems with sufficient RAM.
2026-01-11T19:28:14.4127692Z                          .DESCRIPTION
2026-01-11T19:28:14.4128157Z                              Disables automatic page file management and sets a fixed size based on
2026-01-11T19:28:14.4128655Z                              total RAM (4GB for 32GB+, 8GB for 16-31GB).
2026-01-11T19:28:14.4129126Z                          .OUTPUTS
2026-01-11T19:28:14.4129934Z                              None.
2026-01-11T19:28:14.4130253Z                          #>
2026-01-11T19:28:14.4131367Z                          try {
2026-01-11T19:28:14.4131764Z                              $totalRAM = Get-SystemRAM
2026-01-11T19:28:14.4132179Z                      
2026-01-11T19:28:14.4133147Z                              if ($totalRAM -lt 16) {
2026-01-11T19:28:14.4134723Z                                  Write-Log "System has ${totalRAM}GB RAM - keeping automatic page file management" 
2026-01-11T19:28:14.4135378Z                      "INFO"
2026-01-11T19:28:14.4135601Z                                  return
2026-01-11T19:28:14.4136144Z                              }
2026-01-11T19:28:14.4136385Z                      
2026-01-11T19:28:14.4137441Z                              $pageFileSize = if ($totalRAM -ge 32) {
2026-01-11T19:28:14.4138091Z                                  4096
2026-01-11T19:28:14.4138480Z                              } else {
2026-01-11T19:28:14.4139261Z                                  8192
2026-01-11T19:28:14.4139808Z                              }
2026-01-11T19:28:14.4140465Z                      
2026-01-11T19:28:14.4140996Z                              Write-Log "System has ${totalRAM}GB RAM - setting ${pageFileSize}MB fixed page file" 
2026-01-11T19:28:14.4141642Z                      "INFO"
2026-01-11T19:28:14.4142724Z                      
2026-01-11T19:28:14.4143312Z                              $ComputerSystem = Get-WmiObject Win32_ComputerSystem -EnableAllPrivileges
2026-01-11T19:28:14.4143973Z                              if ($ComputerSystem.AutomaticManagedPagefile) {
2026-01-11T19:28:14.4144475Z                                  $ComputerSystem.AutomaticManagedPagefile = $false
2026-01-11T19:28:14.4145051Z                                  $ComputerSystem.Put() | Out-Null
2026-01-11T19:28:14.4145424Z                                  Write-Log "Disabled automatic page file management" "SUCCESS"
2026-01-11T19:28:14.4146691Z                              }
2026-01-11T19:28:14.4147068Z                      
2026-01-11T19:28:14.4148931Z                              $PageFile = Get-WmiObject -Query "Select * From Win32_PageFileSetting Where 
2026-01-11T19:28:14.4149615Z                      Name='C:\\pagefile.sys'"
2026-01-11T19:28:14.4149855Z                              if ($PageFile) {
2026-01-11T19:28:14.4150341Z                                  $PageFile.InitialSize = $pageFileSize
2026-01-11T19:28:14.4151329Z                                  $PageFile.MaximumSize = $pageFileSize
2026-01-11T19:28:14.4151874Z                                  $PageFile.Put() | Out-Null
2026-01-11T19:28:14.4152245Z                                  $sizeGB = [math]::Round($pageFileSize / 1024, 1)
2026-01-11T19:28:14.4153014Z                                  Write-Log "Set page file to fixed ${pageFileSize}MB size (${sizeGB}GB)" "SUCCESS"
2026-01-11T19:28:14.4153428Z                              } else {
2026-01-11T19:28:14.4154085Z                                  $PageFile = ([WMIClass]"Win32_PageFileSetting").CreateInstance()
2026-01-11T19:28:14.4154583Z                                  $PageFile.Name = "C:\pagefile.sys"
2026-01-11T19:28:14.4155117Z                                  $PageFile.InitialSize = $pageFileSize
2026-01-11T19:28:14.4155427Z                                  $PageFile.MaximumSize = $pageFileSize
2026-01-11T19:28:14.4155788Z                                  $PageFile.Put() | Out-Null
2026-01-11T19:28:14.4156587Z                                  Write-Log "Created fixed ${pageFileSize}MB page file" "SUCCESS"
2026-01-11T19:28:14.4157367Z                              }
2026-01-11T19:28:14.4157684Z                      
2026-01-11T19:28:14.4158056Z                              Write-Log "Page file changes require restart to take effect" "INFO"
2026-01-11T19:28:14.4158670Z                      
2026-01-11T19:28:14.4158955Z                          } catch {
2026-01-11T19:28:14.4159345Z                              Write-Log "Error configuring page file: $_" "ERROR"
2026-01-11T19:28:14.4159771Z                              throw
2026-01-11T19:28:14.4160063Z                          }
2026-01-11T19:28:14.4160238Z                      }
2026-01-11T19:28:14.4160733Z                      
2026-01-11T19:28:14.4161201Z                      
2026-01-11T19:28:14.4161649Z                      function Set-MemoryCompression {
2026-01-11T19:28:14.4162668Z                          <#
2026-01-11T19:28:14.4163184Z                          .SYNOPSIS
2026-01-11T19:28:14.4164509Z                              Toggles Windows memory compression (opt-in).
2026-01-11T19:28:14.4164967Z                          .DESCRIPTION
2026-01-11T19:28:14.4165623Z                              Disables memory compression only on high-RAM systems when requested.
2026-01-11T19:28:14.4166345Z                          .PARAMETER Disable
2026-01-11T19:28:14.4167054Z                              When true, attempts to disable memory compression.
2026-01-11T19:28:14.4167556Z                          .OUTPUTS
2026-01-11T19:28:14.4167819Z                              None.
2026-01-11T19:28:14.4168426Z                          #>
2026-01-11T19:28:14.4168901Z                          param(
2026-01-11T19:28:14.4170014Z                              [bool]$Disable = $false
2026-01-11T19:28:14.4170426Z                          )
2026-01-11T19:28:14.4171452Z                      
2026-01-11T19:28:14.4171749Z                          try {
2026-01-11T19:28:14.4172959Z                              $totalRAM = Get-SystemRAM
2026-01-11T19:28:14.4173485Z                      
2026-01-11T19:28:14.4174190Z                              if ($Disable -and $totalRAM -ge 32) {
2026-01-11T19:28:14.4174788Z                                  Disable-MMAgent -MemoryCompression -ErrorAction SilentlyContinue
2026-01-11T19:28:14.4175574Z                                  Write-Log "Disabled memory compression (system has ${totalRAM}GB RAM)" "SUCCESS"
2026-01-11T19:28:14.4176344Z                              } else {
2026-01-11T19:28:14.4176785Z                                  if ($totalRAM -ge 32) {
2026-01-11T19:28:14.4177589Z                                      Write-Log "Keeping memory compression enabled (default, even with ${totalRAM}GB 
2026-01-11T19:28:14.4189089Z                      RAM)" "INFO"
2026-01-11T19:28:14.4189759Z                                  } else {
2026-01-11T19:28:14.4190516Z                                      Write-Log "Keeping memory compression enabled (system has ${totalRAM}GB RAM)" 
2026-01-11T19:28:14.4190968Z                      "INFO"
2026-01-11T19:28:14.4191285Z                                  }
2026-01-11T19:28:14.4191563Z                              }
2026-01-11T19:28:14.4191745Z                      
2026-01-11T19:28:14.4191903Z                          } catch {
2026-01-11T19:28:14.4192327Z                              Write-Log "Error configuring memory compression: $_" "ERROR"
2026-01-11T19:28:14.4192811Z                              throw
2026-01-11T19:28:14.4193117Z                          }
2026-01-11T19:28:14.4193378Z                      }
2026-01-11T19:28:14.4193648Z                      
2026-01-11T19:28:14.4193890Z                      
2026-01-11T19:28:14.4194202Z                      function Disable-FastStartup {
2026-01-11T19:28:14.4194652Z                          <#
2026-01-11T19:28:14.4194873Z                          .SYNOPSIS
2026-01-11T19:28:14.4195318Z                              Disables Windows Fast Startup.
2026-01-11T19:28:14.4195757Z                          .DESCRIPTION
2026-01-11T19:28:14.4196321Z                              Writes HiberbootEnabled to 0 to force clean boots.
2026-01-11T19:28:14.4196730Z                          .OUTPUTS
2026-01-11T19:28:14.4197002Z                              None.
2026-01-11T19:28:14.4197312Z                          #>
2026-01-11T19:28:14.4197732Z                          $regPath = "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Power"
2026-01-11T19:28:14.4198300Z                      
2026-01-11T19:28:14.4198567Z                          Backup-RegistryKey -Path $regPath
2026-01-11T19:28:14.4198964Z                      
2026-01-11T19:28:14.4199204Z                          try {
2026-01-11T19:28:14.4199827Z                              Set-RegistryValue -Path $regPath -Name "HiberbootEnabled" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.4200462Z                              Write-Log "Disabled Fast Startup (cleaner boots, better for gaming)" "SUCCESS"
2026-01-11T19:28:14.4201095Z                      
2026-01-11T19:28:14.4201387Z                          } catch {
2026-01-11T19:28:14.4201864Z                              Write-Log "Error disabling fast startup: $_" "ERROR"
2026-01-11T19:28:14.4202310Z                              throw
2026-01-11T19:28:14.4202724Z                          }
2026-01-11T19:28:14.4202981Z                      }
2026-01-11T19:28:14.4203200Z                      
2026-01-11T19:28:14.4203347Z                      
2026-01-11T19:28:14.4203708Z                      function Disable-ExplorerAutoType {
2026-01-11T19:28:14.4204061Z                          <#
2026-01-11T19:28:14.4204558Z                          .SYNOPSIS
2026-01-11T19:28:14.4205008Z                              Disables Explorer automatic folder type detection.
2026-01-11T19:28:14.4205445Z                          .DESCRIPTION
2026-01-11T19:28:14.4205893Z                              Forces a generic folder type to reduce Explorer metadata churn.
2026-01-11T19:28:14.4206437Z                          .OUTPUTS
2026-01-11T19:28:14.4206758Z                              None.
2026-01-11T19:28:14.4207006Z                          #>
2026-01-11T19:28:14.4207323Z                          try {
2026-01-11T19:28:14.4207756Z                              $shellPath = "HKCU:\Software\Classes\Local 
2026-01-11T19:28:14.4208474Z                      Settings\Software\Microsoft\Windows\Shell\Bags\AllFolders\Shell"
2026-01-11T19:28:14.4209177Z                              Backup-RegistryKey -Path $shellPath
2026-01-11T19:28:14.4209960Z                              Set-RegistryValue -Path $shellPath -Name "FolderType" -Value "NotSpecified" -Type "String"
2026-01-11T19:28:14.4210777Z                              Write-Log "Disabled Explorer auto folder-type detection" "SUCCESS"
2026-01-11T19:28:14.4211340Z                          } catch {
2026-01-11T19:28:14.4211732Z                              Write-Log "Error disabling Explorer auto-type: $_" "ERROR"
2026-01-11T19:28:14.4212284Z                              throw
2026-01-11T19:28:14.4212658Z                          }
2026-01-11T19:28:14.4212940Z                      }
2026-01-11T19:28:14.4213192Z                      
2026-01-11T19:28:14.4213351Z                      
2026-01-11T19:28:14.4213582Z                      function Invoke-DiskCleanup {
2026-01-11T19:28:14.4213994Z                          <#
2026-01-11T19:28:14.4214270Z                          .SYNOPSIS
2026-01-11T19:28:14.4214668Z                              Runs disk cleanup when usage exceeds a threshold.
2026-01-11T19:28:14.4215210Z                          .DESCRIPTION
2026-01-11T19:28:14.4215629Z                              Executes cleanmgr and optional DISM ResetBase to reclaim disk space.
2026-01-11T19:28:14.4216281Z                              Can run DISM asynchronously with a toast notification on completion.
2026-01-11T19:28:14.4216848Z                          .PARAMETER Async
2026-01-11T19:28:14.4217357Z                              When true, runs DISM cleanup asynchronously.
2026-01-11T19:28:14.4217888Z                          .PARAMETER ThresholdPercent
2026-01-11T19:28:14.4218437Z                              Minimum disk usage percentage required to run cleanup.
2026-01-11T19:28:14.4218771Z                          .OUTPUTS
2026-01-11T19:28:14.4218964Z                              None.
2026-01-11T19:28:14.4219300Z                          #>
2026-01-11T19:28:14.4220476Z                          param(
2026-01-11T19:28:14.4220764Z                              [switch]$Async,
2026-01-11T19:28:14.4221289Z                              [int]$ThresholdPercent = 90
2026-01-11T19:28:14.4222390Z                          )
2026-01-11T19:28:14.4222879Z                      
2026-01-11T19:28:14.4223858Z                          try {
2026-01-11T19:28:14.4225260Z                              # Check disk usage before running expensive cleanup
2026-01-11T19:28:14.4225935Z                              $sysDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive
2026-01-11T19:28:14.4226719Z                              $disk = Get-CimInstance Win32_LogicalDisk -Filter "DeviceID='$sysDrive'"
2026-01-11T19:28:14.4227649Z                              $usedPercent = [math]::Round((($disk.Size - $disk.FreeSpace) / $disk.Size) * 100, 1)
2026-01-11T19:28:14.4228277Z                              $freeGB = [math]::Round($disk.FreeSpace / 1GB, 1)
2026-01-11T19:28:14.4228694Z                      
2026-01-11T19:28:14.4228914Z                              if ($usedPercent -lt $ThresholdPercent) {
2026-01-11T19:28:14.4229577Z                                  Write-Log "System drive $usedPercent% full (${freeGB}GB free) - skipping cleanup 
2026-01-11T19:28:14.4230062Z                      (threshold: ${ThresholdPercent}%)" "INFO"
2026-01-11T19:28:14.4230462Z                                  return
2026-01-11T19:28:14.4230769Z                              }
2026-01-11T19:28:14.4231372Z                      
2026-01-11T19:28:14.4232964Z                              Write-Log "System drive $usedPercent% full (${freeGB}GB free) - running cleanup" "INFO"
2026-01-11T19:28:14.4233405Z                      
2026-01-11T19:28:14.4233738Z                              # Set cleanup flags for cleanmgr
2026-01-11T19:28:14.4234526Z                              $cleanupKey = "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VolumeCaches"
2026-01-11T19:28:14.4235067Z                              Get-ChildItem $cleanupKey -EA SilentlyContinue | ForEach-Object {
2026-01-11T19:28:14.4235892Z                                  Set-ItemProperty -Path $_.PSPath -Name "StateFlags0100" -Value 2 -EA SilentlyContinue
2026-01-11T19:28:14.4236453Z                              }
2026-01-11T19:28:14.4236801Z                      
2026-01-11T19:28:14.4237207Z                              # Run cleanmgr synchronously (reasonably fast)
2026-01-11T19:28:14.4237972Z                              Start-Process "cleanmgr.exe" -ArgumentList "/sagerun:100" -Wait -WindowStyle Hidden
2026-01-11T19:28:14.4238841Z                              Write-Log "Disk Cleanup (cleanmgr) complete" "SUCCESS"
2026-01-11T19:28:14.4239248Z                      
2026-01-11T19:28:14.4239512Z                              if ($Async) {
2026-01-11T19:28:14.4239894Z                                  # DISM ResetBase can take 10-30+ minutes, run async with notification
2026-01-11T19:28:14.4240449Z                                  $dismJob = Start-Job -ScriptBlock {
2026-01-11T19:28:14.4241280Z                                      Dism.exe /Online /Cleanup-Image /StartComponentCleanup /ResetBase 2>&1 | Out-Null
2026-01-11T19:28:14.4241981Z                                  }
2026-01-11T19:28:14.4242315Z                      
2026-01-11T19:28:14.4242791Z                                  Register-ObjectEvent -InputObject $dismJob -EventName StateChanged -Action {
2026-01-11T19:28:14.4243747Z                                      if ($Sender.State -eq 'Completed') {
2026-01-11T19:28:14.4244047Z                                          try {
2026-01-11T19:28:14.4245142Z                                              [Windows.UI.Notifications.ToastNotificationManager, 
2026-01-11T19:28:14.4245892Z                      Windows.UI.Notifications, ContentType = WindowsRuntime] | Out-Null
2026-01-11T19:28:14.4246666Z                                              $template = [Windows.UI.Notifications.ToastNotificationManager]::GetTempla
2026-01-11T19:28:14.4247625Z                      teContent([Windows.UI.Notifications.ToastTemplateType]::ToastText02)
2026-01-11T19:28:14.4248249Z                                              $text = $template.GetElementsByTagName("text")
2026-01-11T19:28:14.4248925Z                                              $text.Item(0).AppendChild($template.CreateTextNode("Gaming PC Setup")) | 
2026-01-11T19:28:14.4249426Z                      Out-Null
2026-01-11T19:28:14.4249979Z                                              $text.Item(1).AppendChild($template.CreateTextNode("DISM ResetBase 
2026-01-11T19:28:14.4250528Z                      complete! Disk space reclaimed.")) | Out-Null
2026-01-11T19:28:14.4251854Z                                              $notifier = 
2026-01-11T19:28:14.4252666Z                      [Windows.UI.Notifications.ToastNotificationManager]::CreateToastNotifier("Gaming PC Setup")
2026-01-11T19:28:14.4253435Z                                              
2026-01-11T19:28:14.4253910Z                      $notifier.Show([Windows.UI.Notifications.ToastNotification]::new($template))
2026-01-11T19:28:14.4254424Z                                          } catch {
2026-01-11T19:28:14.4254812Z                                              # Toast failed silently
2026-01-11T19:28:14.4255379Z                                          }
2026-01-11T19:28:14.4256062Z                                          Unregister-Event -SourceIdentifier $Event.SourceIdentifier
2026-01-11T19:28:14.4256785Z                                          Remove-Job $Sender
2026-01-11T19:28:14.4257814Z                                      }
2026-01-11T19:28:14.4258242Z                                  } | Out-Null
2026-01-11T19:28:14.4259104Z                      
2026-01-11T19:28:14.4260726Z                                  Write-Log "DISM ResetBase started in background (toast notification on completion)" 
2026-01-11T19:28:14.4261378Z                      "INFO"
2026-01-11T19:28:14.4261662Z                              } else {
2026-01-11T19:28:14.4262142Z                                  # Synchronous mode for backwards compatibility
2026-01-11T19:28:14.4262797Z                                  Dism.exe /Online /Cleanup-Image /StartComponentCleanup /ResetBase 2>&1 | Out-Null
2026-01-11T19:28:14.4263507Z                                  Write-Log "DISM ResetBase complete" "SUCCESS"
2026-01-11T19:28:14.4263793Z                              }
2026-01-11T19:28:14.4264067Z                          } catch {
2026-01-11T19:28:14.4264499Z                              Write-Log "Error running Disk Cleanup: $_" "ERROR"
2026-01-11T19:28:14.4265197Z                              throw
2026-01-11T19:28:14.4265531Z                          }
2026-01-11T19:28:14.4265775Z                      }
2026-01-11T19:28:14.4266928Z                      
2026-01-11T19:28:14.4267397Z                      
2026-01-11T19:28:14.4268546Z                      function Invoke-TempPurge {
2026-01-11T19:28:14.4268987Z                          <#
2026-01-11T19:28:14.4269336Z                          .SYNOPSIS
2026-01-11T19:28:14.4270709Z                              Clears common temporary folders.
2026-01-11T19:28:14.4271208Z                          .DESCRIPTION
2026-01-11T19:28:14.4271981Z                              Removes files under %TEMP% and %WINDIR%\Temp with best-effort error handling.
2026-01-11T19:28:14.4272514Z                          .OUTPUTS
2026-01-11T19:28:14.4272858Z                              None.
2026-01-11T19:28:14.4273323Z                          #>
2026-01-11T19:28:14.4273657Z                          try {
2026-01-11T19:28:14.4274398Z                              $tempPaths = @("$env:TEMP","$env:WINDIR\Temp")
2026-01-11T19:28:14.4274911Z                              foreach ($p in $tempPaths) {
2026-01-11T19:28:14.4275258Z                                  if (Test-Path $p) {
2026-01-11T19:28:14.4276580Z                                      Get-ChildItem -Path $p -Recurse -Force -ErrorAction SilentlyContinue | 
2026-01-11T19:28:14.4277426Z                      Remove-Item -Force -Recurse -ErrorAction SilentlyContinue
2026-01-11T19:28:14.4277994Z                                  }
2026-01-11T19:28:14.4278242Z                              }
2026-01-11T19:28:14.4278698Z                              Write-Log "Temp folders cleared" "SUCCESS"
2026-01-11T19:28:14.4279186Z                          } catch {
2026-01-11T19:28:14.4279665Z                              Write-Log "Error purging temp folders: $_" "ERROR"
2026-01-11T19:28:14.4280130Z                              throw
2026-01-11T19:28:14.4281447Z                          }
2026-01-11T19:28:14.4281779Z                      }
2026-01-11T19:28:14.4282501Z                      
2026-01-11T19:28:14.4283129Z                      
2026-01-11T19:28:14.4283684Z                      function Set-ServiceTrimSafe {
2026-01-11T19:28:14.4285141Z                          <#
2026-01-11T19:28:14.4285527Z                          .SYNOPSIS
2026-01-11T19:28:14.4286787Z                              Sets select services to Manual to reduce background load.
2026-01-11T19:28:14.4287342Z                          .DESCRIPTION
2026-01-11T19:28:14.4287766Z                              Targets a curated list of non-essential services and stops them.
2026-01-11T19:28:14.4288473Z                          .PARAMETER Enable
2026-01-11T19:28:14.4288988Z                              When true, applies service trimming.
2026-01-11T19:28:14.4289345Z                          .OUTPUTS
2026-01-11T19:28:14.4290702Z                              None.
2026-01-11T19:28:14.4291400Z                          #>
2026-01-11T19:28:14.4291727Z                          param(
2026-01-11T19:28:14.4292908Z                              [bool]$Enable = $true
2026-01-11T19:28:14.4293018Z                          )
2026-01-11T19:28:14.4294354Z                      
2026-01-11T19:28:14.4295259Z                          if (-not $Enable) {
2026-01-11T19:28:14.4295603Z                              Write-Log "Service trim skipped" "INFO"
2026-01-11T19:28:14.4296705Z                              return
2026-01-11T19:28:14.4297554Z                          }
2026-01-11T19:28:14.4298189Z                      
2026-01-11T19:28:14.4299785Z                          $services = @("DiagTrack","dmwappushservice","lfsvc","RetailDemo","Fax","SharedAccess","XblGam
2026-01-11T19:28:14.4300016Z                      eSave","XblAuthManager","XboxNetApiSvc")
2026-01-11T19:28:14.4300125Z                      
2026-01-11T19:28:14.4301181Z                          foreach ($svc in $services) {
2026-01-11T19:28:14.4301321Z                              try {
2026-01-11T19:28:14.4302700Z                                  Set-Service -Name $svc -StartupType Manual -EA SilentlyContinue
2026-01-11T19:28:14.4303237Z                                  Stop-Service -Name $svc -Force -EA SilentlyContinue
2026-01-11T19:28:14.4304358Z                                  Write-Log "Trimmed service to Manual: $svc" "SUCCESS"
2026-01-11T19:28:14.4304689Z                              } catch {
2026-01-11T19:28:14.4305731Z                                  Write-Log "Could not trim service $svc : $_" "ERROR"
2026-01-11T19:28:14.4306597Z                              }
2026-01-11T19:28:14.4307435Z                          }
2026-01-11T19:28:14.4308202Z                      }
2026-01-11T19:28:14.4308934Z                      
2026-01-11T19:28:14.4309685Z                      
2026-01-11T19:28:14.4310734Z                      function Disable-RazerAutoInstall {
2026-01-11T19:28:14.4311213Z                          <#
2026-01-11T19:28:14.4312738Z                          .SYNOPSIS
2026-01-11T19:28:14.4313037Z                              Disables Razer/OEM auto-install services and tasks.
2026-01-11T19:28:14.4313709Z                          .DESCRIPTION
2026-01-11T19:28:14.4315143Z                              Stops and disables Razer-related services and scheduled tasks that can
2026-01-11T19:28:14.4315325Z                              install software automatically.
2026-01-11T19:28:14.4315455Z                          .PARAMETER Enable
2026-01-11T19:28:14.4315880Z                              When true, applies the block.
2026-01-11T19:28:14.4316789Z                          .OUTPUTS
2026-01-11T19:28:14.4317622Z                              None.
2026-01-11T19:28:14.4318370Z                          #>
2026-01-11T19:28:14.4319180Z                          param(
2026-01-11T19:28:14.4320482Z                              [bool]$Enable = $true
2026-01-11T19:28:14.4320587Z                          )
2026-01-11T19:28:14.4321439Z                      
2026-01-11T19:28:14.4322306Z                          if (-not $Enable) {
2026-01-11T19:28:14.4323222Z                              Write-Log "Razer/OEM block skipped" "INFO"
2026-01-11T19:28:14.4324500Z                              return
2026-01-11T19:28:14.4325634Z                          }
2026-01-11T19:28:14.4325751Z                      
2026-01-11T19:28:14.4326787Z                          try {
2026-01-11T19:28:14.4327451Z                              $razerServices = Get-Service | Where-Object { $_.Name -like "Razer*" }
2026-01-11T19:28:14.4327975Z                              foreach ($svc in $razerServices) {
2026-01-11T19:28:14.4328436Z                                  try { Stop-Service $svc -Force -EA SilentlyContinue; Set-Service $svc -StartupType 
2026-01-11T19:28:14.4329495Z                      Disabled -EA SilentlyContinue } catch {}
2026-01-11T19:28:14.4330416Z                              }
2026-01-11T19:28:14.4330528Z                      
2026-01-11T19:28:14.4331924Z                              $razerTasks = Get-ScheduledTask | Where-Object { $_.TaskName -like "*Razer*" }
2026-01-11T19:28:14.4332206Z                              if ($razerTasks) { $razerTasks | Disable-ScheduledTask -EA SilentlyContinue | Out-Null }
2026-01-11T19:28:14.4332353Z                      
2026-01-11T19:28:14.4333714Z                              Write-Log "Razer/OEM auto-install payloads blocked (services/tasks disabled)" "SUCCESS"
2026-01-11T19:28:14.4333828Z                          } catch {
2026-01-11T19:28:14.4334094Z                              Write-Log "Error blocking Razer/OEM auto-installs: $_" "ERROR"
2026-01-11T19:28:14.4335060Z                          }
2026-01-11T19:28:14.4335173Z                      }
2026-01-11T19:28:14.4336184Z                      
2026-01-11T19:28:14.4336438Z                      
2026-01-11T19:28:14.4337627Z                      function New-RestorePoint {
2026-01-11T19:28:14.4337748Z                          <#
2026-01-11T19:28:14.4338268Z                          .SYNOPSIS
2026-01-11T19:28:14.4338598Z                              Creates a Windows System Restore Point before applying optimizations.
2026-01-11T19:28:14.4339560Z                          .DESCRIPTION
2026-01-11T19:28:14.4341100Z                              Safety feature - creates a restore point so user can roll back if needed.
2026-01-11T19:28:14.4341424Z                              Requires System Restore to be enabled on the system drive.
2026-01-11T19:28:14.4341582Z                          .PARAMETER Description
2026-01-11T19:28:14.4341825Z                              Restore point description string.
2026-01-11T19:28:14.4341946Z                          .OUTPUTS
2026-01-11T19:28:14.4343738Z                              [bool] True if created, false otherwise.
2026-01-11T19:28:14.4344089Z                          #>
2026-01-11T19:28:14.4345438Z                          param(
2026-01-11T19:28:14.4345782Z                              [string]$Description = "Pre-Gaming-PC-Setup"
2026-01-11T19:28:14.4346234Z                          )
2026-01-11T19:28:14.4347189Z                      
2026-01-11T19:28:14.4347649Z                          try {
2026-01-11T19:28:14.4348703Z                              # Check if System Restore is enabled
2026-01-11T19:28:14.4349024Z                              $srStatus = Get-ComputerRestorePoint -ErrorAction SilentlyContinue
2026-01-11T19:28:14.4349931Z                      
2026-01-11T19:28:14.4351161Z                              # Enable System Restore on C: if needed (will fail silently if already enabled)
2026-01-11T19:28:14.4351525Z                              Enable-ComputerRestore -Drive "C:\" -ErrorAction SilentlyContinue
2026-01-11T19:28:14.4351636Z                      
2026-01-11T19:28:14.4352205Z                              # Create restore point
2026-01-11T19:28:14.4353565Z                              Checkpoint-Computer -Description $Description -RestorePointType "MODIFY_SETTINGS" 
2026-01-11T19:28:14.4353656Z                      -ErrorAction Stop
2026-01-11T19:28:14.4354835Z                              Write-Log "Created System Restore Point: $Description" "SUCCESS"
2026-01-11T19:28:14.4355125Z                              return $true
2026-01-11T19:28:14.4356195Z                          } catch {
2026-01-11T19:28:14.4356647Z                              if ($_.Exception.Message -like "*1058*" -or $_.Exception.Message -like "*disabled*") {
2026-01-11T19:28:14.4357611Z                                  Write-Log "System Restore is disabled - skipping restore point creation" "INFO"
2026-01-11T19:28:14.4358229Z                              } elseif ($_.Exception.Message -like "*frequency*" -or $_.Exception.Message -like 
2026-01-11T19:28:14.4358819Z                      "*already*") {
2026-01-11T19:28:14.4360184Z                                  Write-Log "Restore point recently created (Windows limits frequency) - continuing" 
2026-01-11T19:28:14.4360258Z                      "INFO"
2026-01-11T19:28:14.4361216Z                              } else {
2026-01-11T19:28:14.4361492Z                                  Write-Log "Could not create restore point: $_" "ERROR"
2026-01-11T19:28:14.4361920Z                              }
2026-01-11T19:28:14.4362980Z                              return $false
2026-01-11T19:28:14.4363838Z                          }
2026-01-11T19:28:14.4365073Z                      }
2026-01-11T19:28:14.4365196Z                      
2026-01-11T19:28:14.4366318Z                      
2026-01-11T19:28:14.4366526Z                      function Set-ClassicContextMenu {
2026-01-11T19:28:14.4367269Z                          <#
2026-01-11T19:28:14.4368556Z                          .SYNOPSIS
2026-01-11T19:28:14.4369128Z                              Restores the classic Windows 10-style right-click context menu on Windows 11.
2026-01-11T19:28:14.4369566Z                          .DESCRIPTION
2026-01-11T19:28:14.4370836Z                              Windows 11's new context menu is slower and requires extra clicks.
2026-01-11T19:28:14.4371354Z                              This tweak restores the full classic menu for faster navigation.
2026-01-11T19:28:14.4371653Z                          .PARAMETER Enable
2026-01-11T19:28:14.4372807Z                              When true, enables the classic context menu on Windows 11.
2026-01-11T19:28:14.4373172Z                          .OUTPUTS
2026-01-11T19:28:14.4374012Z                              None.
2026-01-11T19:28:14.4374839Z                          #>
2026-01-11T19:28:14.4375654Z                          param(
2026-01-11T19:28:14.4376613Z                              [bool]$Enable = $true
2026-01-11T19:28:14.4376715Z                          )
2026-01-11T19:28:14.4377405Z                      
2026-01-11T19:28:14.4378305Z                          if (-not $Enable) {
2026-01-11T19:28:14.4379591Z                              Write-Log "Classic context menu: skipped" "INFO"
2026-01-11T19:28:14.4380440Z                              return
2026-01-11T19:28:14.4380811Z                          }
2026-01-11T19:28:14.4381379Z                      
2026-01-11T19:28:14.4381544Z                          try {
2026-01-11T19:28:14.4382744Z                              # Check if Windows 11
2026-01-11T19:28:14.4383627Z                              $build = [int](Get-CimInstance Win32_OperatingSystem).BuildNumber
2026-01-11T19:28:14.4384533Z                              if ($build -lt 22000) {
2026-01-11T19:28:14.4384978Z                                  Write-Log "Classic context menu: Not needed (Windows 10 detected)" "INFO"
2026-01-11T19:28:14.4385630Z                                  return
2026-01-11T19:28:14.4386861Z                              }
2026-01-11T19:28:14.4386989Z                      
2026-01-11T19:28:14.4388063Z                              $classicMenuPath = 
2026-01-11T19:28:14.4389581Z                      "HKCU:\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}\InprocServer32"
2026-01-11T19:28:14.4389701Z                      
2026-01-11T19:28:14.4390174Z                              # Create the key path if it doesn't exist
2026-01-11T19:28:14.4391588Z                              if (-not (Test-Path $classicMenuPath)) {
2026-01-11T19:28:14.4392042Z                                  New-Item -Path $classicMenuPath -Force | Out-Null
2026-01-11T19:28:14.4392463Z                              }
2026-01-11T19:28:14.4393456Z                      
2026-01-11T19:28:14.4393867Z                              # Set empty default value to enable classic menu
2026-01-11T19:28:14.4395294Z                              Set-ItemProperty -Path $classicMenuPath -Name "(Default)" -Value "" -Force
2026-01-11T19:28:14.4395430Z                      
2026-01-11T19:28:14.4396932Z                              Write-Log "Classic right-click context menu enabled (restart Explorer to apply)" "SUCCESS"
2026-01-11T19:28:14.4397010Z                          } catch {
2026-01-11T19:28:14.4398108Z                              Write-Log "Error setting classic context menu: $_" "ERROR"
2026-01-11T19:28:14.4398477Z                          }
2026-01-11T19:28:14.4399530Z                      }
2026-01-11T19:28:14.4399643Z                      
2026-01-11T19:28:14.4400587Z                      
2026-01-11T19:28:14.4401104Z                      function Disable-StorageSense {
2026-01-11T19:28:14.4401824Z                          <#
2026-01-11T19:28:14.4403005Z                          .SYNOPSIS
2026-01-11T19:28:14.4403413Z                              Disables Windows Storage Sense automatic cleanup.
2026-01-11T19:28:14.4404207Z                          .DESCRIPTION
2026-01-11T19:28:14.4405147Z                              Storage Sense can cause background disk activity during gaming.
2026-01-11T19:28:14.4405441Z                              Disabling it prevents unexpected cleanup operations.
2026-01-11T19:28:14.4406216Z                          .PARAMETER Enable
2026-01-11T19:28:14.4407180Z                              When true, disables Storage Sense.
2026-01-11T19:28:14.4407326Z                          .OUTPUTS
2026-01-11T19:28:14.4408493Z                              None.
2026-01-11T19:28:14.4408948Z                          #>
2026-01-11T19:28:14.4409966Z                          param(
2026-01-11T19:28:14.4410127Z                              [bool]$Enable = $true
2026-01-11T19:28:14.4411117Z                          )
2026-01-11T19:28:14.4411224Z                      
2026-01-11T19:28:14.4412642Z                          if (-not $Enable) {
2026-01-11T19:28:14.4412868Z                              Write-Log "Disable Storage Sense: skipped" "INFO"
2026-01-11T19:28:14.4413887Z                              return
2026-01-11T19:28:14.4414741Z                          }
2026-01-11T19:28:14.4414943Z                      
2026-01-11T19:28:14.4416196Z                          try {
2026-01-11T19:28:14.4417091Z                              $storagePath = 
2026-01-11T19:28:14.4417660Z                      "HKCU:\Software\Microsoft\Windows\CurrentVersion\StorageSense\Parameters\StoragePolicy"
2026-01-11T19:28:14.4418073Z                              Backup-RegistryKey -Path $storagePath
2026-01-11T19:28:14.4419033Z                      
2026-01-11T19:28:14.4419205Z                              # Disable Storage Sense
2026-01-11T19:28:14.4420387Z                              Set-RegistryValue -Path $storagePath -Name "01" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.4421649Z                              Set-RegistryValue -Path $storagePath -Name "StoragePoliciesNotified" -Value 1 -Type 
2026-01-11T19:28:14.4421773Z                      "DWORD"
2026-01-11T19:28:14.4422087Z                      
2026-01-11T19:28:14.4423719Z                              Write-Log "Disabled Storage Sense (no background cleanup during gaming)" "SUCCESS"
2026-01-11T19:28:14.4423806Z                          } catch {
2026-01-11T19:28:14.4424355Z                              Write-Log "Error disabling Storage Sense: $_" "ERROR"
2026-01-11T19:28:14.4424614Z                          }
2026-01-11T19:28:14.4425824Z                      }
2026-01-11T19:28:14.4426297Z                      
2026-01-11T19:28:14.4427424Z                      
2026-01-11T19:28:14.4427627Z                      function Set-DisplayPerformance {
2026-01-11T19:28:14.4428643Z                          <#
2026-01-11T19:28:14.4428787Z                          .SYNOPSIS
2026-01-11T19:28:14.4429934Z                              Configures Windows visual effects for maximum performance.
2026-01-11T19:28:14.4430960Z                          .DESCRIPTION
2026-01-11T19:28:14.4431352Z                              Disables animations, shadows, and other visual effects that consume GPU/CPU resources.
2026-01-11T19:28:14.4432546Z                              Reduces visual overhead for slightly better gaming performance.
2026-01-11T19:28:14.4432724Z                          .PARAMETER Enable
2026-01-11T19:28:14.4433807Z                              When true, applies performance-oriented visual settings.
2026-01-11T19:28:14.4434287Z                          .OUTPUTS
2026-01-11T19:28:14.4434689Z                              None.
2026-01-11T19:28:14.4435709Z                          #>
2026-01-11T19:28:14.4435829Z                          param(
2026-01-11T19:28:14.4437086Z                              [bool]$Enable = $true
2026-01-11T19:28:14.4437206Z                          )
2026-01-11T19:28:14.4438465Z                      
2026-01-11T19:28:14.4438623Z                          if (-not $Enable) {
2026-01-11T19:28:14.4440075Z                              Write-Log "Display performance mode: skipped" "INFO"
2026-01-11T19:28:14.4440260Z                              return
2026-01-11T19:28:14.4441355Z                          }
2026-01-11T19:28:14.4441465Z                      
2026-01-11T19:28:14.4442778Z                          try {
2026-01-11T19:28:14.4444500Z                              $visualPath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects"
2026-01-11T19:28:14.4444708Z                              Backup-RegistryKey -Path $visualPath
2026-01-11T19:28:14.4446106Z                              Set-RegistryValue -Path $visualPath -Name "VisualFXSetting" -Value 2 -Type "DWORD"  # 2 = 
2026-01-11T19:28:14.4446424Z                      Custom (we'll set individual settings)
2026-01-11T19:28:14.4446525Z                      
2026-01-11T19:28:14.4447720Z                              $advancedPath = "HKCU:\Control Panel\Desktop"
2026-01-11T19:28:14.4447957Z                              Backup-RegistryKey -Path $advancedPath
2026-01-11T19:28:14.4448703Z                              Set-RegistryValue -Path $advancedPath -Name "DragFullWindows" -Value "0" -Type "String"
2026-01-11T19:28:14.4449385Z                              Set-RegistryValue -Path $advancedPath -Name "MenuShowDelay" -Value "0" -Type "String"
2026-01-11T19:28:14.4449526Z                      
2026-01-11T19:28:14.4450168Z                              $windowMetrics = "HKCU:\Control Panel\Desktop\WindowMetrics"
2026-01-11T19:28:14.4451125Z                              Backup-RegistryKey -Path $windowMetrics
2026-01-11T19:28:14.4451886Z                              Set-RegistryValue -Path $windowMetrics -Name "MinAnimate" -Value "0" -Type "String"
2026-01-11T19:28:14.4452072Z                      
2026-01-11T19:28:14.4452767Z                              $explorerPath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced"
2026-01-11T19:28:14.4453009Z                              Backup-RegistryKey -Path $explorerPath
2026-01-11T19:28:14.4453715Z                              Set-RegistryValue -Path $explorerPath -Name "TaskbarAnimations" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.4455099Z                              Set-RegistryValue -Path $explorerPath -Name "ListviewAlphaSelect" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.4455430Z                              Set-RegistryValue -Path $explorerPath -Name "ListviewShadow" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.4455715Z                      
2026-01-11T19:28:14.4456801Z                              Write-Log "Set display for performance (reduced visual effects)" "SUCCESS"
2026-01-11T19:28:14.4457016Z                          } catch {
2026-01-11T19:28:14.4458159Z                              Write-Log "Error setting display performance: $_" "ERROR"
2026-01-11T19:28:14.4458290Z                          }
2026-01-11T19:28:14.4459391Z                      }
2026-01-11T19:28:14.4460217Z                      
2026-01-11T19:28:14.4461025Z                      
2026-01-11T19:28:14.4461212Z                      function Enable-TaskbarEndTask {
2026-01-11T19:28:14.4462488Z                          <#
2026-01-11T19:28:14.4462605Z                          .SYNOPSIS
2026-01-11T19:28:14.4464140Z                              Enables "End Task" option when right-clicking taskbar items.
2026-01-11T19:28:14.4464256Z                          .DESCRIPTION
2026-01-11T19:28:14.4464861Z                              Useful for quickly killing frozen games or unresponsive applications
2026-01-11T19:28:14.4466067Z                              without needing to open Task Manager.
2026-01-11T19:28:14.4466212Z                          .PARAMETER Enable
2026-01-11T19:28:14.4467014Z                              When true, enables the taskbar End Task option.
2026-01-11T19:28:14.4468226Z                          .OUTPUTS
2026-01-11T19:28:14.4468387Z                              None.
2026-01-11T19:28:14.4469361Z                          #>
2026-01-11T19:28:14.4470216Z                          param(
2026-01-11T19:28:14.4471359Z                              [bool]$Enable = $true
2026-01-11T19:28:14.4471492Z                          )
2026-01-11T19:28:14.4472381Z                      
2026-01-11T19:28:14.4473279Z                          if (-not $Enable) {
2026-01-11T19:28:14.4474512Z                              Write-Log "Taskbar End Task: skipped" "INFO"
2026-01-11T19:28:14.4474897Z                              return
2026-01-11T19:28:14.4475850Z                          }
2026-01-11T19:28:14.4475978Z                      
2026-01-11T19:28:14.4477002Z                          try {
2026-01-11T19:28:14.4478024Z                              $taskbarPath = 
2026-01-11T19:28:14.4478514Z                      "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced\TaskbarDeveloperSettings"
2026-01-11T19:28:14.4479792Z                      
2026-01-11T19:28:14.4480021Z                              if (-not (Test-Path $taskbarPath)) {
2026-01-11T19:28:14.4481048Z                                  New-Item -Path $taskbarPath -Force | Out-Null
2026-01-11T19:28:14.4481701Z                              }
2026-01-11T19:28:14.4482651Z                      
2026-01-11T19:28:14.4482886Z                              Backup-RegistryKey -Path $taskbarPath
2026-01-11T19:28:14.4485258Z                              Set-RegistryValue -Path $taskbarPath -Name "TaskbarEndTask" -Value 1 -Type "DWORD"
2026-01-11T19:28:14.4485382Z                      
2026-01-11T19:28:14.4485746Z                              Write-Log "Enabled 'End Task' in taskbar right-click menu" "SUCCESS"
2026-01-11T19:28:14.4486656Z                          } catch {
2026-01-11T19:28:14.4487725Z                              Write-Log "Error enabling taskbar End Task: $_" "ERROR"
2026-01-11T19:28:14.4487886Z                          }
2026-01-11T19:28:14.4489017Z                      }
2026-01-11T19:28:14.4489119Z                      
2026-01-11T19:28:14.4490282Z                      
2026-01-11T19:28:14.4490512Z                      function Remove-ExplorerClutter {
2026-01-11T19:28:14.4491342Z                          <#
2026-01-11T19:28:14.4491464Z                          .SYNOPSIS
2026-01-11T19:28:14.4492992Z                              Removes Home and Gallery from Windows 11 Explorer navigation pane.
2026-01-11T19:28:14.4493120Z                          .DESCRIPTION
2026-01-11T19:28:14.4494168Z                              Cleans up Explorer navigation for faster access to files.
2026-01-11T19:28:14.4494513Z                              Only applies to Windows 11.
2026-01-11T19:28:14.4495554Z                          .PARAMETER Enable
2026-01-11T19:28:14.4495766Z                              When true, removes Home/Gallery entries.
2026-01-11T19:28:14.4496885Z                          .OUTPUTS
2026-01-11T19:28:14.4496998Z                              None.
2026-01-11T19:28:14.4498117Z                          #>
2026-01-11T19:28:14.4498241Z                          param(
2026-01-11T19:28:14.4499472Z                              [bool]$Enable = $true
2026-01-11T19:28:14.4499584Z                          )
2026-01-11T19:28:14.4500875Z                      
2026-01-11T19:28:14.4501015Z                          if (-not $Enable) {
2026-01-11T19:28:14.4502989Z                              Write-Log "Remove Explorer clutter: skipped" "INFO"
2026-01-11T19:28:14.4503118Z                              return
2026-01-11T19:28:14.4504026Z                          }
2026-01-11T19:28:14.4504784Z                      
2026-01-11T19:28:14.4505727Z                          try {
2026-01-11T19:28:14.4506695Z                              # Check if Windows 11
2026-01-11T19:28:14.4507047Z                              $build = [int](Get-CimInstance Win32_OperatingSystem).BuildNumber
2026-01-11T19:28:14.4507587Z                              if ($build -lt 22000) {
2026-01-11T19:28:14.4508798Z                                  Write-Log "Remove Explorer clutter: Not needed (Windows 10 detected)" "INFO"
2026-01-11T19:28:14.4508928Z                                  return
2026-01-11T19:28:14.4509972Z                              }
2026-01-11T19:28:14.4510459Z                      
2026-01-11T19:28:14.4510711Z                              # Remove Home from Explorer
2026-01-11T19:28:14.4512398Z                              $homePath = "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Desktop\NameSpace\{f
2026-01-11T19:28:14.4512571Z                      874310e-b6b7-47dc-bc84-b9e6b38f5903}"
2026-01-11T19:28:14.4512766Z                              if (Test-Path $homePath) {
2026-01-11T19:28:14.4513827Z                                  Remove-Item -Path $homePath -Force -ErrorAction SilentlyContinue
2026-01-11T19:28:14.4514473Z                                  Write-Log "Removed 'Home' from Explorer navigation" "SUCCESS"
2026-01-11T19:28:14.4514927Z                              }
2026-01-11T19:28:14.4515877Z                      
2026-01-11T19:28:14.4516042Z                              # Remove Gallery from Explorer
2026-01-11T19:28:14.4517585Z                              $galleryPath = "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Desktop\NameSpace
2026-01-11T19:28:14.4517775Z                      \{e88865ea-0e1c-4e20-9aa6-edcd0212c87c}"
2026-01-11T19:28:14.4519014Z                              if (Test-Path $galleryPath) {
2026-01-11T19:28:14.4519495Z                                  Remove-Item -Path $galleryPath -Force -ErrorAction SilentlyContinue
2026-01-11T19:28:14.4519843Z                                  Write-Log "Removed 'Gallery' from Explorer navigation" "SUCCESS"
2026-01-11T19:28:14.4520503Z                              }
2026-01-11T19:28:14.4520617Z                      
2026-01-11T19:28:14.4522332Z                          } catch {
2026-01-11T19:28:14.4522626Z                              Write-Log "Error removing Explorer clutter: $_" "ERROR"
2026-01-11T19:28:14.4523748Z                          }
2026-01-11T19:28:14.4523850Z                      }
2026-01-11T19:28:14.4524998Z                      
2026-01-11T19:28:14.4525100Z                      
2026-01-11T19:28:14.4526554Z                      function Disable-MouseAcceleration {
2026-01-11T19:28:14.4526669Z                          <#
2026-01-11T19:28:14.4527572Z                          .SYNOPSIS
2026-01-11T19:28:14.4528142Z                              Disables Windows mouse acceleration for consistent 1:1 movement.
2026-01-11T19:28:14.4528561Z                          .DESCRIPTION
2026-01-11T19:28:14.4530062Z                              Essential for competitive FPS players - ensures mouse movement
2026-01-11T19:28:14.4530432Z                              is linear and predictable regardless of speed.
2026-01-11T19:28:14.4530778Z                          .PARAMETER Enable
2026-01-11T19:28:14.4532078Z                              When true, disables enhanced pointer precision.
2026-01-11T19:28:14.4532188Z                          .OUTPUTS
2026-01-11T19:28:14.4532611Z                              None.
2026-01-11T19:28:14.4533514Z                          #>
2026-01-11T19:28:14.4533641Z                          param(
2026-01-11T19:28:14.4535049Z                              [bool]$Enable = $true
2026-01-11T19:28:14.4535842Z                          )
2026-01-11T19:28:14.4536322Z                      
2026-01-11T19:28:14.4537197Z                          if (-not $Enable) {
2026-01-11T19:28:14.4537537Z                              Write-Log "Disable mouse acceleration: skipped" "INFO"
2026-01-11T19:28:14.4538564Z                              return
2026-01-11T19:28:14.4538693Z                          }
2026-01-11T19:28:14.4540108Z                      
2026-01-11T19:28:14.4540229Z                          try {
2026-01-11T19:28:14.4541501Z                              $mousePath = "HKCU:\Control Panel\Mouse"
2026-01-11T19:28:14.4542849Z                              Backup-RegistryKey -Path $mousePath
2026-01-11T19:28:14.4542937Z                      
2026-01-11T19:28:14.4543963Z                              # Disable enhanced pointer precision (mouse acceleration)
2026-01-11T19:28:14.4544697Z                              Set-RegistryValue -Path $mousePath -Name "MouseSpeed" -Value "0" -Type "String"
2026-01-11T19:28:14.4545409Z                              Set-RegistryValue -Path $mousePath -Name "MouseThreshold1" -Value "0" -Type "String"
2026-01-11T19:28:14.4545852Z                              Set-RegistryValue -Path $mousePath -Name "MouseThreshold2" -Value "0" -Type "String"
2026-01-11T19:28:14.4546175Z                      
2026-01-11T19:28:14.4547152Z                              Write-Log "Disabled mouse acceleration (1:1 movement)" "SUCCESS"
2026-01-11T19:28:14.4547536Z                          } catch {
2026-01-11T19:28:14.4548110Z                              Write-Log "Error disabling mouse acceleration: $_" "ERROR"
2026-01-11T19:28:14.4548378Z                          }
2026-01-11T19:28:14.4548702Z                      }
2026-01-11T19:28:14.4549529Z                      
2026-01-11T19:28:14.4550372Z                      
2026-01-11T19:28:14.4551623Z                      function Set-BackgroundPollingUnlock {
2026-01-11T19:28:14.4551742Z                          <#
2026-01-11T19:28:14.4552523Z                          .SYNOPSIS
2026-01-11T19:28:14.4553856Z                              Unlocks full mouse polling rate in background windows.
2026-01-11T19:28:14.4554140Z                          .DESCRIPTION
2026-01-11T19:28:14.4554754Z                              FR33THY optimization - removes Windows throttling of mouse input
2026-01-11T19:28:14.4555696Z                              when windows are in background, improving alt-tab responsiveness.
2026-01-11T19:28:14.4556142Z                          .PARAMETER Enable
2026-01-11T19:28:14.4556578Z                              When true, unlocks background polling.
2026-01-11T19:28:14.4557689Z                          .OUTPUTS
2026-01-11T19:28:14.4558760Z                              None.
2026-01-11T19:28:14.4559037Z                          #>
2026-01-11T19:28:14.4560366Z                          param(
2026-01-11T19:28:14.4560522Z                              [bool]$Enable = $true
2026-01-11T19:28:14.4561757Z                          )
2026-01-11T19:28:14.4561888Z                      
2026-01-11T19:28:14.4563164Z                          if (-not $Enable) {
2026-01-11T19:28:14.4563771Z                              Write-Log "Background polling unlock: skipped" "INFO"
2026-01-11T19:28:14.4564093Z                              return
2026-01-11T19:28:14.4565272Z                          }
2026-01-11T19:28:14.4565517Z                      
2026-01-11T19:28:14.4566577Z                          try {
2026-01-11T19:28:14.4566785Z                              $mousePath = "HKCU:\Control Panel\Mouse"
2026-01-11T19:28:14.4567899Z                              Backup-RegistryKey -Path $mousePath
2026-01-11T19:28:14.4568270Z                      
2026-01-11T19:28:14.4569516Z                              # FR33THY: RawMouseThrottleEnabled=0 removes background mouse throttling
2026-01-11T19:28:14.4570037Z                              Set-RegistryValue -Path $mousePath -Name "RawMouseThrottleEnabled" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.4570320Z                      
2026-01-11T19:28:14.4571763Z                              Write-Log "Background mouse polling unlocked (full rate in background windows)" "SUCCESS"
2026-01-11T19:28:14.4571888Z                          } catch {
2026-01-11T19:28:14.4572410Z                              Write-Log "Error unlocking background polling: $_" "ERROR"
2026-01-11T19:28:14.4573307Z                          }
2026-01-11T19:28:14.4573541Z                      }
2026-01-11T19:28:14.4574655Z                      
2026-01-11T19:28:14.4574862Z                      
2026-01-11T19:28:14.4576209Z                      function Set-KeyboardResponse {
2026-01-11T19:28:14.4576322Z                          <#
2026-01-11T19:28:14.4577024Z                          .SYNOPSIS
2026-01-11T19:28:14.4577961Z                              Maximizes keyboard response speed.
2026-01-11T19:28:14.4578722Z                          .DESCRIPTION
2026-01-11T19:28:14.4579735Z                              Sets keyboard repeat delay to minimum and repeat rate to maximum
2026-01-11T19:28:14.4580277Z                              for faster key response in games.
2026-01-11T19:28:14.4581192Z                          .PARAMETER Enable
2026-01-11T19:28:14.4581691Z                              When true, applies the keyboard response settings.
2026-01-11T19:28:14.4582076Z                          .OUTPUTS
2026-01-11T19:28:14.4582851Z                              None.
2026-01-11T19:28:14.4584042Z                          #>
2026-01-11T19:28:14.4584166Z                          param(
2026-01-11T19:28:14.4585181Z                              [bool]$Enable = $true
2026-01-11T19:28:14.4585622Z                          )
2026-01-11T19:28:14.4586363Z                      
2026-01-11T19:28:14.4587195Z                          if (-not $Enable) {
2026-01-11T19:28:14.4587555Z                              Write-Log "Keyboard response optimization: skipped" "INFO"
2026-01-11T19:28:14.4588686Z                              return
2026-01-11T19:28:14.4589328Z                          }
2026-01-11T19:28:14.4589727Z                      
2026-01-11T19:28:14.4590499Z                          try {
2026-01-11T19:28:14.4591623Z                              $keyboardPath = "HKCU:\Control Panel\Keyboard"
2026-01-11T19:28:14.4591857Z                              Backup-RegistryKey -Path $keyboardPath
2026-01-11T19:28:14.4592905Z                      
2026-01-11T19:28:14.4593560Z                              # KeyboardDelay: 0 = shortest delay (250ms), 3 = longest (1000ms)
2026-01-11T19:28:14.4594188Z                              # KeyboardSpeed: 0 = slowest, 31 = fastest repeat rate
2026-01-11T19:28:14.4595247Z                              Set-RegistryValue -Path $keyboardPath -Name "KeyboardDelay" -Value "0" -Type "String"
2026-01-11T19:28:14.4596012Z                              Set-RegistryValue -Path $keyboardPath -Name "KeyboardSpeed" -Value "31" -Type "String"
2026-01-11T19:28:14.4596131Z                      
2026-01-11T19:28:14.4597464Z                              Write-Log "Keyboard response maximized (fastest repeat)" "SUCCESS"
2026-01-11T19:28:14.4597807Z                          } catch {
2026-01-11T19:28:14.4598864Z                              Write-Log "Error setting keyboard response: $_" "ERROR"
2026-01-11T19:28:14.4599127Z                          }
2026-01-11T19:28:14.4600265Z                      }
2026-01-11T19:28:14.4601048Z                      
2026-01-11T19:28:14.4601942Z                      
2026-01-11T19:28:14.4602150Z                      function Disable-USBSelectiveSuspend {
2026-01-11T19:28:14.4603000Z                          <#
2026-01-11T19:28:14.4603756Z                          .SYNOPSIS
2026-01-11T19:28:14.4605123Z                              Disables USB selective suspend to prevent input device sleep.
2026-01-11T19:28:14.4605238Z                          .DESCRIPTION
2026-01-11T19:28:14.4606115Z                              Prevents Windows from putting USB devices to sleep, which can
2026-01-11T19:28:14.4607288Z                              cause input lag or disconnection issues with gaming peripherals.
2026-01-11T19:28:14.4607432Z                          .PARAMETER Enable
2026-01-11T19:28:14.4608312Z                              When true, disables USB selective suspend.
2026-01-11T19:28:14.4608881Z                          .OUTPUTS
2026-01-11T19:28:14.4609815Z                              None.
2026-01-11T19:28:14.4610004Z                          #>
2026-01-11T19:28:14.4611324Z                          param(
2026-01-11T19:28:14.4611466Z                              [bool]$Enable = $true
2026-01-11T19:28:14.4612589Z                          )
2026-01-11T19:28:14.4613552Z                      
2026-01-11T19:28:14.4613952Z                          if (-not $Enable) {
2026-01-11T19:28:14.4615019Z                              Write-Log "Disable USB selective suspend: skipped" "INFO"
2026-01-11T19:28:14.4615426Z                              return
2026-01-11T19:28:14.4616733Z                          }
2026-01-11T19:28:14.4616844Z                      
2026-01-11T19:28:14.4617871Z                          try {
2026-01-11T19:28:14.4618749Z                              # Disable via power scheme settings (all schemes)
2026-01-11T19:28:14.4619377Z                              $schemes = powercfg /list 2>&1 | Select-String "GUID" | ForEach-Object {
2026-01-11T19:28:14.4619933Z                                  if ($_ -match '([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})') {
2026-01-11T19:28:14.4620092Z                                      $matches[1]
2026-01-11T19:28:14.4621039Z                                  }
2026-01-11T19:28:14.4621240Z                              }
2026-01-11T19:28:14.4622562Z                      
2026-01-11T19:28:14.4622780Z                              foreach ($scheme in $schemes) {
2026-01-11T19:28:14.4623771Z                                  if ($scheme) {
2026-01-11T19:28:14.4624369Z                                      # USB selective suspend setting GUID
2026-01-11T19:28:14.4625803Z                                      powercfg /setacvalueindex $scheme 2a737441-1930-4402-8d77-b2bebba308a3 
2026-01-11T19:28:14.4626070Z                      48e6b7a6-50f5-4782-a5d4-53bb8f07e226 0 2>&1 | Out-Null
2026-01-11T19:28:14.4627189Z                                      powercfg /setdcvalueindex $scheme 2a737441-1930-4402-8d77-b2bebba308a3 
2026-01-11T19:28:14.4627443Z                      48e6b7a6-50f5-4782-a5d4-53bb8f07e226 0 2>&1 | Out-Null
2026-01-11T19:28:14.4627738Z                                  }
2026-01-11T19:28:14.4628974Z                              }
2026-01-11T19:28:14.4629078Z                      
2026-01-11T19:28:14.4630453Z                              # Also set via registry for USB hub power management
2026-01-11T19:28:14.4630669Z                              $usbPath = "HKLM:\SYSTEM\CurrentControlSet\Services\USB"
2026-01-11T19:28:14.4631656Z                              if (-not (Test-Path $usbPath)) {
2026-01-11T19:28:14.4632203Z                                  New-Item -Path $usbPath -Force | Out-Null
2026-01-11T19:28:14.4633221Z                              }
2026-01-11T19:28:14.4633535Z                              Backup-RegistryKey -Path $usbPath
2026-01-11T19:28:14.4634481Z                              Set-RegistryValue -Path $usbPath -Name "DisableSelectiveSuspend" -Value 1 -Type "DWORD"
2026-01-11T19:28:14.4634749Z                      
2026-01-11T19:28:14.4636109Z                              Write-Log "Disabled USB selective suspend (no input device sleep)" "SUCCESS"
2026-01-11T19:28:14.4636223Z                          } catch {
2026-01-11T19:28:14.4636772Z                              Write-Log "Error disabling USB selective suspend: $_" "ERROR"
2026-01-11T19:28:14.4637694Z                          }
2026-01-11T19:28:14.4637795Z                      }
2026-01-11T19:28:14.4638948Z                      
2026-01-11T19:28:14.4639050Z                      
2026-01-11T19:28:14.4640479Z                      function Set-AudioExclusiveMode {
2026-01-11T19:28:14.4640599Z                          <#
2026-01-11T19:28:14.4641570Z                          .SYNOPSIS
2026-01-11T19:28:14.4641830Z                              Configures audio for exclusive mode and lower latency.
2026-01-11T19:28:14.4643255Z                          .DESCRIPTION
2026-01-11T19:28:14.4643658Z                              Enables WASAPI exclusive mode hints and reduces audio buffer
2026-01-11T19:28:14.4645067Z                              for lower latency audio in competitive games.
2026-01-11T19:28:14.4645212Z                          .PARAMETER Enable
2026-01-11T19:28:14.4646528Z                              When true, applies exclusive mode-related settings.
2026-01-11T19:28:14.4646656Z                          .OUTPUTS
2026-01-11T19:28:14.4647665Z                              None.
2026-01-11T19:28:14.4648424Z                          #>
2026-01-11T19:28:14.4649021Z                          param(
2026-01-11T19:28:14.4649911Z                              [bool]$Enable = $true
2026-01-11T19:28:14.4650925Z                          )
2026-01-11T19:28:14.4651057Z                      
2026-01-11T19:28:14.4651883Z                          if (-not $Enable) {
2026-01-11T19:28:14.4652789Z                              Write-Log "Audio exclusive mode: skipped" "INFO"
2026-01-11T19:28:14.4653513Z                              return
2026-01-11T19:28:14.4654441Z                          }
2026-01-11T19:28:14.4655188Z                      
2026-01-11T19:28:14.4656159Z                          try {
2026-01-11T19:28:14.4656436Z                              # Get default audio endpoint
2026-01-11T19:28:14.4657704Z                              $audioPath = "HKCU:\Software\Microsoft\Multimedia\Audio"
2026-01-11T19:28:14.4657924Z                              if (-not (Test-Path $audioPath)) {
2026-01-11T19:28:14.4658426Z                                  New-Item -Path $audioPath -Force | Out-Null
2026-01-11T19:28:14.4659188Z                              }
2026-01-11T19:28:14.4660856Z                              Backup-RegistryKey -Path $audioPath
2026-01-11T19:28:14.4661080Z                      
2026-01-11T19:28:14.4661597Z                              # Enable exclusive mode application priority
2026-01-11T19:28:14.4663547Z                              Set-RegistryValue -Path $audioPath -Name "UserDuckingPreference" -Value 3 -Type "DWORD"
2026-01-11T19:28:14.4663672Z                      
2026-01-11T19:28:14.4663836Z                              # Reduce system sounds impact
2026-01-11T19:28:14.4664020Z                              $soundPath = "HKCU:\AppEvents\Schemes"
2026-01-11T19:28:14.4665107Z                              Backup-RegistryKey -Path $soundPath
2026-01-11T19:28:14.4665552Z                              Set-RegistryValue -Path $soundPath -Name "(Default)" -Value ".None" -Type "String"
2026-01-11T19:28:14.4665991Z                      
2026-01-11T19:28:14.4666983Z                              Write-Log "Audio configured for exclusive mode / lower latency" "SUCCESS"
2026-01-11T19:28:14.4668085Z                          } catch {
2026-01-11T19:28:14.4668432Z                              Write-Log "Error setting audio exclusive mode: $_" "ERROR"
2026-01-11T19:28:14.4669223Z                          }
2026-01-11T19:28:14.4670251Z                      }
2026-01-11T19:28:14.4670580Z                      
2026-01-11T19:28:14.4671581Z                      
2026-01-11T19:28:14.4672445Z                      function Invoke-SystemOptimizations {
2026-01-11T19:28:14.4673151Z                          <#
2026-01-11T19:28:14.4674026Z                          .SYNOPSIS
2026-01-11T19:28:14.4675240Z                              Applies system optimization bundle.
2026-01-11T19:28:14.4675719Z                          .DESCRIPTION
2026-01-11T19:28:14.4676411Z                              Runs page file tuning, fast startup changes, cleanup, service trimming,
2026-01-11T19:28:14.4676900Z                              UI tweaks, and device-related settings as configured.
2026-01-11T19:28:14.4677408Z                          .PARAMETER DisableMemoryCompression
2026-01-11T19:28:14.4678375Z                              Disables memory compression when true (opt-in).
2026-01-11T19:28:14.4678784Z                          .PARAMETER DisableExplorerAutoType
2026-01-11T19:28:14.4679349Z                              Disables Explorer auto folder type detection when true.
2026-01-11T19:28:14.4680052Z                          .PARAMETER RunDiskCleanup
2026-01-11T19:28:14.4681143Z                              Runs Disk Cleanup and DISM ResetBase when true.
2026-01-11T19:28:14.4681331Z                          .PARAMETER RunTempPurge
2026-01-11T19:28:14.4682605Z                              Purges temp folders when true.
2026-01-11T19:28:14.4682928Z                          .PARAMETER ServiceTrimSafe
2026-01-11T19:28:14.4683990Z                              Trims select services when true.
2026-01-11T19:28:14.4684457Z                          .PARAMETER BlockRazer
2026-01-11T19:28:14.4685522Z                              Blocks Razer/OEM auto-installs when true.
2026-01-11T19:28:14.4685941Z                          .PARAMETER ClassicContextMenu
2026-01-11T19:28:14.4687241Z                              Enables the classic Windows 11 context menu when true.
2026-01-11T19:28:14.4687412Z                          .PARAMETER DisableStorageSense
2026-01-11T19:28:14.4688264Z                              Disables Storage Sense when true.
2026-01-11T19:28:14.4688463Z                          .PARAMETER DisplayPerformance
2026-01-11T19:28:14.4689876Z                              Applies visual performance settings when true.
2026-01-11T19:28:14.4690010Z                          .PARAMETER TaskbarEndTask
2026-01-11T19:28:14.4691139Z                              Enables taskbar End Task option when true.
2026-01-11T19:28:14.4691671Z                          .PARAMETER RemoveExplorerClutter
2026-01-11T19:28:14.4692916Z                              Removes Explorer Home/Gallery entries when true.
2026-01-11T19:28:14.4693119Z                          .OUTPUTS
2026-01-11T19:28:14.4694206Z                              None.
2026-01-11T19:28:14.4694736Z                          #>
2026-01-11T19:28:14.4695489Z                          param(
2026-01-11T19:28:14.4696875Z                              [bool]$DisableMemoryCompression = $false,
2026-01-11T19:28:14.4697112Z                              [bool]$DisableExplorerAutoType = $true,
2026-01-11T19:28:14.4697879Z                              [bool]$RunDiskCleanup = $true,
2026-01-11T19:28:14.4698714Z                              [bool]$RunTempPurge = $true,
2026-01-11T19:28:14.4699472Z                              [bool]$ServiceTrimSafe = $true,
2026-01-11T19:28:14.4701289Z                              [bool]$BlockRazer = $true,
2026-01-11T19:28:14.4701486Z                              [bool]$ClassicContextMenu = $true,
2026-01-11T19:28:14.4702263Z                              [bool]$DisableStorageSense = $true,
2026-01-11T19:28:14.4703486Z                              [bool]$DisplayPerformance = $true,
2026-01-11T19:28:14.4703714Z                              [bool]$TaskbarEndTask = $true,
2026-01-11T19:28:14.4705013Z                              [bool]$RemoveExplorerClutter = $true
2026-01-11T19:28:14.4705774Z                          )
2026-01-11T19:28:14.4706337Z                      
2026-01-11T19:28:14.4707484Z                          Write-Log "Applying system optimizations..." "INFO"
2026-01-11T19:28:14.4707802Z                      
2026-01-11T19:28:14.4708629Z                          try {
2026-01-11T19:28:14.4709662Z                              Set-PageFile
2026-01-11T19:28:14.4709791Z                      
2026-01-11T19:28:14.4710892Z                              Disable-FastStartup
2026-01-11T19:28:14.4711306Z                      
2026-01-11T19:28:14.4712539Z                              Set-MemoryCompression -Disable $DisableMemoryCompression
2026-01-11T19:28:14.4712955Z                      
2026-01-11T19:28:14.4713676Z                              if ($DisableExplorerAutoType) {
2026-01-11T19:28:14.4714744Z                                  Disable-ExplorerAutoType
2026-01-11T19:28:14.4714872Z                              }
2026-01-11T19:28:14.4716023Z                      
2026-01-11T19:28:14.4716161Z                              if ($RunDiskCleanup) {
2026-01-11T19:28:14.4717409Z                                  Invoke-DiskCleanup -Async
2026-01-11T19:28:14.4717519Z                              }
2026-01-11T19:28:14.4718620Z                      
2026-01-11T19:28:14.4719589Z                              if ($RunTempPurge) {
2026-01-11T19:28:14.4719756Z                                  Invoke-TempPurge
2026-01-11T19:28:14.4720870Z                              }
2026-01-11T19:28:14.4721717Z                      
2026-01-11T19:28:14.4722932Z                              Set-ServiceTrimSafe -Enable $ServiceTrimSafe
2026-01-11T19:28:14.4723045Z                      
2026-01-11T19:28:14.4724497Z                              Disable-RazerAutoInstall -Enable $BlockRazer
2026-01-11T19:28:14.4724925Z                      
2026-01-11T19:28:14.4725740Z                              Set-ClassicContextMenu -Enable $ClassicContextMenu
2026-01-11T19:28:14.4726127Z                      
2026-01-11T19:28:14.4727432Z                              Disable-StorageSense -Enable $DisableStorageSense
2026-01-11T19:28:14.4727592Z                      
2026-01-11T19:28:14.4728832Z                              Set-DisplayPerformance -Enable $DisplayPerformance
2026-01-11T19:28:14.4729133Z                      
2026-01-11T19:28:14.4730239Z                              Enable-TaskbarEndTask -Enable $TaskbarEndTask
2026-01-11T19:28:14.4730364Z                      
2026-01-11T19:28:14.4731728Z                              Remove-ExplorerClutter -Enable $RemoveExplorerClutter
2026-01-11T19:28:14.4731834Z                      
2026-01-11T19:28:14.4732917Z                              Write-Log "System optimizations complete" "SUCCESS"
2026-01-11T19:28:14.4733229Z                      
2026-01-11T19:28:14.4733907Z                          } catch {
2026-01-11T19:28:14.4734195Z                              Write-Log "Error applying system optimizations: $_" "ERROR"
2026-01-11T19:28:14.4734508Z                              throw
2026-01-11T19:28:14.4735721Z                          }
2026-01-11T19:28:14.4735825Z                      }
2026-01-11T19:28:14.4736869Z                      
2026-01-11T19:28:14.4736979Z                      
2026-01-11T19:28:14.4738298Z                      function Undo-SystemOptimizations {
2026-01-11T19:28:14.4738719Z                          <#
2026-01-11T19:28:14.4739649Z                          .SYNOPSIS
2026-01-11T19:28:14.4740201Z                              Reverts system optimizations where possible.
2026-01-11T19:28:14.4741659Z                          .DESCRIPTION
2026-01-11T19:28:14.4742639Z                              Restores page file management, fast startup registry state, and other
2026-01-11T19:28:14.4743034Z                              backed up settings. Some changes still require reboot.
2026-01-11T19:28:14.4743840Z                          .OUTPUTS
2026-01-11T19:28:14.4744737Z                              None.
2026-01-11T19:28:14.4746019Z                          #>
2026-01-11T19:28:14.4747164Z                          Write-Log "Rolling back system optimizations..." "INFO"
2026-01-11T19:28:14.4747268Z                      
2026-01-11T19:28:14.4747773Z                          try {
2026-01-11T19:28:14.4748836Z                              $ComputerSystem = Get-WmiObject Win32_ComputerSystem -EnableAllPrivileges
2026-01-11T19:28:14.4749311Z                              if (-not $ComputerSystem.AutomaticManagedPagefile) {
2026-01-11T19:28:14.4749875Z                                  $ComputerSystem.AutomaticManagedPagefile = $true
2026-01-11T19:28:14.4750229Z                                  $ComputerSystem.Put() | Out-Null
2026-01-11T19:28:14.4751366Z                                  Write-Log "Restored automatic page file management" "SUCCESS"
2026-01-11T19:28:14.4751500Z                              }
2026-01-11T19:28:14.4752253Z                      
2026-01-11T19:28:14.4753777Z                              $PageFile = Get-WmiObject -Query "Select * From Win32_PageFileSetting Where 
2026-01-11T19:28:14.4754010Z                      Name='C:\\pagefile.sys'"
2026-01-11T19:28:14.4755534Z                              if ($PageFile) {
2026-01-11T19:28:14.4755763Z                                  $PageFile.Delete()
2026-01-11T19:28:14.4756447Z                                  Write-Log "Removed custom page file settings" "SUCCESS"
2026-01-11T19:28:14.4757774Z                              }
2026-01-11T19:28:14.4757922Z                      
2026-01-11T19:28:14.4759037Z                              $regPath = "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Power"
2026-01-11T19:28:14.4759256Z                              if (Restore-RegistryKey -Path $regPath) {
2026-01-11T19:28:14.4759606Z                                  Write-Log "Restored Fast Startup registry settings" "SUCCESS"
2026-01-11T19:28:14.4760053Z                              } else {
2026-01-11T19:28:14.4760832Z                                  Set-RegistryValue -Path $regPath -Name "HiberbootEnabled" -Value 1 -Type "DWORD"
2026-01-11T19:28:14.4761075Z                                  Write-Log "Re-enabled Fast Startup" "SUCCESS"
2026-01-11T19:28:14.4761196Z                              }
2026-01-11T19:28:14.4761746Z                      
2026-01-11T19:28:14.4763399Z                              $shellPath = "HKCU:\Software\Classes\Local 
2026-01-11T19:28:14.4764033Z                      Settings\Software\Microsoft\Windows\Shell\Bags\AllFolders\Shell"
2026-01-11T19:28:14.4764298Z                              Restore-RegistryKey -Path $shellPath | Out-Null
2026-01-11T19:28:14.4764405Z                      
2026-01-11T19:28:14.4765114Z                              Enable-MMAgent -MemoryCompression -ErrorAction SilentlyContinue
2026-01-11T19:28:14.4765556Z                              Write-Log "Re-enabled memory compression" "SUCCESS"
2026-01-11T19:28:14.4765810Z                      
2026-01-11T19:28:14.4766656Z                              Write-Log "System optimization rollback complete (restart required)" "SUCCESS"
2026-01-11T19:28:14.4766791Z                      
2026-01-11T19:28:14.4767662Z                          } catch {
2026-01-11T19:28:14.4768423Z                              Write-Log "Error during rollback: $_" "ERROR"
2026-01-11T19:28:14.4768669Z                              throw
2026-01-11T19:28:14.4769351Z                          }
2026-01-11T19:28:14.4769999Z                      }
2026-01-11T19:28:14.4770576Z                      
2026-01-11T19:28:14.4770923Z                      
2026-01-11T19:28:14.4771526Z                      Export-ModuleMember -Function @(
2026-01-11T19:28:14.4772097Z                          'Get-SystemRAM',
2026-01-11T19:28:14.4772254Z                          'Set-PageFile',
2026-01-11T19:28:14.4773255Z                          'Set-MemoryCompression',
2026-01-11T19:28:14.4773573Z                          'Disable-FastStartup',
2026-01-11T19:28:14.4773736Z                          'Disable-ExplorerAutoType',
2026-01-11T19:28:14.4774116Z                          'Invoke-DiskCleanup',
2026-01-11T19:28:14.4774991Z                          'Invoke-TempPurge',
2026-01-11T19:28:14.4775546Z                          'Set-ServiceTrimSafe',
2026-01-11T19:28:14.4776228Z                          'Disable-RazerAutoInstall',
2026-01-11T19:28:14.4776822Z                          'New-RestorePoint',
2026-01-11T19:28:14.4777230Z                          'Set-ClassicContextMenu',
2026-01-11T19:28:14.4778309Z                          'Disable-StorageSense',
2026-01-11T19:28:14.4778851Z                          'Set-DisplayPerformance',
2026-01-11T19:28:14.4779206Z                          'Enable-TaskbarEndTask',
2026-01-11T19:28:14.4780292Z                          'Remove-ExplorerClutter',
2026-01-11T19:28:14.4781034Z                          'Disable-MouseAcceleration',
2026-01-11T19:28:14.4782219Z                          'Set-BackgroundPollingUnlock',
2026-01-11T19:28:14.4782351Z                          'Set-KeyboardResponse',
2026-01-11T19:28:14.4783363Z                          'Disable-USBSelectiveSuspend',
2026-01-11T19:28:14.4784198Z                          'Set-AudioExclusiveMode',
2026-01-11T19:28:14.4784745Z                          'Test-SystemOptimizations',
2026-01-11T19:28:14.4785773Z                          'Invoke-SystemOptimizations',
2026-01-11T19:28:14.4786454Z                          'Undo-SystemOptimizations'
2026-01-11T19:28:14.4787197Z                      )
2026-01-11T19:28:14.4788417Z [32;1mCleanBlock         : [0m
2026-01-11T19:28:14.4789038Z [32;1mDynamicParamBlock  : [0m
2026-01-11T19:28:14.4789650Z [32;1mScriptRequirements : [0mSystem.Management.Automation.Language.ScriptRequirements
2026-01-11T19:28:14.4792566Z [32;1mExtent             : [0m<#
2026-01-11T19:28:14.4792947Z                      .SYNOPSIS
2026-01-11T19:28:14.4793879Z                          System-level optimizations and housekeeping.
2026-01-11T19:28:14.4794009Z                      .DESCRIPTION
2026-01-11T19:28:14.4795462Z                          Applies page file sizing, fast startup changes, storage cleanup, UI tweaks,
2026-01-11T19:28:14.4795777Z                          input settings, and service trimming intended for gaming stability.
2026-01-11T19:28:14.4795928Z                      .NOTES
2026-01-11T19:28:14.4797372Z                          Requires Administrator. Several changes require a reboot to take effect.
2026-01-11T19:28:14.4797491Z                      #>
2026-01-11T19:28:14.4798502Z                      #Requires -RunAsAdministrator
2026-01-11T19:28:14.4798601Z                      
2026-01-11T19:28:14.4799817Z                      
2026-01-11T19:28:14.4800083Z                      
2026-01-11T19:28:14.4801490Z                      Import-Module (Join-Path $PSScriptRoot "..\core\logger.psm1") -Force -Global
2026-01-11T19:28:14.4801888Z                      Import-Module (Join-Path $PSScriptRoot "..\core\registry.psm1") -Force -Global
2026-01-11T19:28:14.4801957Z                      
2026-01-11T19:28:14.4803122Z                      
2026-01-11T19:28:14.4803305Z                      
2026-01-11T19:28:14.4804579Z                      function Get-SystemRAM {
2026-01-11T19:28:14.4805324Z                          <#
2026-01-11T19:28:14.4806163Z                          .SYNOPSIS
2026-01-11T19:28:14.4807217Z                              Returns total system RAM in GB.
2026-01-11T19:28:14.4807690Z                          .DESCRIPTION
2026-01-11T19:28:14.4808877Z                              Queries Win32_PhysicalMemory and sums capacity to produce total RAM.
2026-01-11T19:28:14.4809001Z                          .OUTPUTS
2026-01-11T19:28:14.4809759Z                              [int] Total RAM in gigabytes, or 0 on failure.
2026-01-11T19:28:14.4810495Z                          #>
2026-01-11T19:28:14.4811307Z                          try {
2026-01-11T19:28:14.4812573Z                              $totalRAM = [math]::Round((Get-CimInstance Win32_PhysicalMemory -ErrorAction Stop |
2026-01-11T19:28:14.4813063Z                                  Measure-Object -Property Capacity -Sum).Sum / 1GB)
2026-01-11T19:28:14.4813306Z                      
2026-01-11T19:28:14.4814480Z                              Write-Log "System RAM detected: ${totalRAM}GB" "INFO"
2026-01-11T19:28:14.4814616Z                              return $totalRAM
2026-01-11T19:28:14.4815811Z                          } catch {
2026-01-11T19:28:14.4816066Z                              Write-Log "Error detecting system RAM: $_" "ERROR"
2026-01-11T19:28:14.4816602Z                              return 0
2026-01-11T19:28:14.4817388Z                          }
2026-01-11T19:28:14.4817767Z                      }
2026-01-11T19:28:14.4818650Z                      
2026-01-11T19:28:14.4820276Z                      
2026-01-11T19:28:14.4821283Z                      function Test-SystemOptimizations {
2026-01-11T19:28:14.4821381Z                          <#
2026-01-11T19:28:14.4822516Z                          .SYNOPSIS
2026-01-11T19:28:14.4822730Z                              Verifies key system optimizations.
2026-01-11T19:28:14.4823951Z                          .DESCRIPTION
2026-01-11T19:28:14.4824963Z                              Checks page file policy, fast startup setting, and logs memory compression
2026-01-11T19:28:14.4825467Z                              state for visibility.
2026-01-11T19:28:14.4826211Z                          .OUTPUTS
2026-01-11T19:28:14.4827120Z                              [bool] True when checks pass, else false.
2026-01-11T19:28:14.4827808Z                          #>
2026-01-11T19:28:14.4828760Z                          $allPassed = $true
2026-01-11T19:28:14.4829516Z                      
2026-01-11T19:28:14.4830380Z                          Write-Log "Verifying system optimizations..." "INFO"
2026-01-11T19:28:14.4830973Z                      
2026-01-11T19:28:14.4831865Z                          try {
2026-01-11T19:28:14.4832982Z                              $ComputerSystem = Get-WmiObject Win32_ComputerSystem -EnableAllPrivileges
2026-01-11T19:28:14.4833468Z                              $totalRAM = Get-SystemRAM
2026-01-11T19:28:14.4834226Z                      
2026-01-11T19:28:14.4835077Z                              if ($totalRAM -ge 16) {
2026-01-11T19:28:14.4835982Z                                  if ($ComputerSystem.AutomaticManagedPagefile -eq $false) {
2026-01-11T19:28:14.4836791Z                                      Write-Log "‚úì Automatic page file management disabled" "SUCCESS"
2026-01-11T19:28:14.4837719Z                      
2026-01-11T19:28:14.4838349Z                                      $PageFile = Get-WmiObject -Query "Select * From Win32_PageFileSetting Where 
2026-01-11T19:28:14.4838721Z                      Name='C:\\pagefile.sys'"
2026-01-11T19:28:14.4839908Z                                      if ($PageFile) {
2026-01-11T19:28:14.4840636Z                                          $expectedSize = if ($totalRAM -ge 32) { 4096 } else { 8192 }
2026-01-11T19:28:14.4841279Z                      
2026-01-11T19:28:14.4842652Z                                          if ($PageFile.InitialSize -eq $expectedSize -and $PageFile.MaximumSize -eq 
2026-01-11T19:28:14.4842792Z                      $expectedSize) {
2026-01-11T19:28:14.4844528Z                                              Write-Log "‚úì Page file size: ${expectedSize}MB (correct for ${totalRAM}GB 
2026-01-11T19:28:14.4844860Z                      RAM)" "SUCCESS"
2026-01-11T19:28:14.4845566Z                                          } else {
2026-01-11T19:28:14.4846818Z                                              Write-Log "‚úó Page file size mismatch (current: 
2026-01-11T19:28:14.4847174Z                      $($PageFile.InitialSize)MB, expected: ${expectedSize}MB)" "ERROR"
2026-01-11T19:28:14.4847559Z                                              $allPassed = $false
2026-01-11T19:28:14.4848629Z                                          }
2026-01-11T19:28:14.4849395Z                                      } else {
2026-01-11T19:28:14.4850925Z                                          Write-Log "‚úó Page file not found" "ERROR"
2026-01-11T19:28:14.4851098Z                                          $allPassed = $false
2026-01-11T19:28:14.4852257Z                                      }
2026-01-11T19:28:14.4852382Z                                  } else {
2026-01-11T19:28:14.4853716Z                                      Write-Log "‚úó Automatic page file management still enabled" "ERROR"
2026-01-11T19:28:14.4853917Z                                      $allPassed = $false
2026-01-11T19:28:14.4855058Z                                  }
2026-01-11T19:28:14.4855529Z                              }
2026-01-11T19:28:14.4856455Z                      
2026-01-11T19:28:14.4857193Z                              $hiberboot = Get-RegistryValue -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Session 
2026-01-11T19:28:14.4857605Z                      Manager\Power" -Name "HiberbootEnabled"
2026-01-11T19:28:14.4858501Z                              if ($hiberboot -eq 0) {
2026-01-11T19:28:14.4859215Z                                  Write-Log "‚úì Fast Startup disabled" "SUCCESS"
2026-01-11T19:28:14.4860028Z                              } else {
2026-01-11T19:28:14.4861230Z                                  Write-Log "‚úó Fast Startup not disabled (current value: $hiberboot)" "ERROR"
2026-01-11T19:28:14.4861393Z                                  $allPassed = $false
2026-01-11T19:28:14.4862470Z                              }
2026-01-11T19:28:14.4862584Z                      
2026-01-11T19:28:14.4863737Z                              $mmAgent = Get-MMAgent -ErrorAction SilentlyContinue
2026-01-11T19:28:14.4863891Z                              if ($mmAgent) {
2026-01-11T19:28:14.4865217Z                                  $compressionStatus = if ($mmAgent.MemoryCompression) { "enabled" } else { "disabled" }
2026-01-11T19:28:14.4865745Z                                  Write-Log "Memory compression: $compressionStatus" "INFO"
2026-01-11T19:28:14.4866218Z                              }
2026-01-11T19:28:14.4866896Z                      
2026-01-11T19:28:14.4868091Z                          } catch {
2026-01-11T19:28:14.4868562Z                              Write-Log "Error during verification: $_" "ERROR"
2026-01-11T19:28:14.4869473Z                              $allPassed = $false
2026-01-11T19:28:14.4869591Z                          }
2026-01-11T19:28:14.4870553Z                      
2026-01-11T19:28:14.4870800Z                          return $allPassed
2026-01-11T19:28:14.4871904Z                      }
2026-01-11T19:28:14.4872012Z                      
2026-01-11T19:28:14.4873358Z                      
2026-01-11T19:28:14.4873472Z                      
2026-01-11T19:28:14.4874619Z                      
2026-01-11T19:28:14.4874823Z                      function Set-PageFile {
2026-01-11T19:28:14.4875557Z                          <#
2026-01-11T19:28:14.4876755Z                          .SYNOPSIS
2026-01-11T19:28:14.4877103Z                              Configures a fixed page file size on systems with sufficient RAM.
2026-01-11T19:28:14.4877584Z                          .DESCRIPTION
2026-01-11T19:28:14.4878584Z                              Disables automatic page file management and sets a fixed size based on
2026-01-11T19:28:14.4879156Z                              total RAM (4GB for 32GB+, 8GB for 16-31GB).
2026-01-11T19:28:14.4880298Z                          .OUTPUTS
2026-01-11T19:28:14.4880958Z                              None.
2026-01-11T19:28:14.4882189Z                          #>
2026-01-11T19:28:14.4882393Z                          try {
2026-01-11T19:28:14.4883725Z                              $totalRAM = Get-SystemRAM
2026-01-11T19:28:14.4883852Z                      
2026-01-11T19:28:14.4884896Z                              if ($totalRAM -lt 16) {
2026-01-11T19:28:14.4886396Z                                  Write-Log "System has ${totalRAM}GB RAM - keeping automatic page file management" 
2026-01-11T19:28:14.4887367Z                      "INFO"
2026-01-11T19:28:14.4887438Z                                  return
2026-01-11T19:28:14.4887628Z                              }
2026-01-11T19:28:14.4888845Z                      
2026-01-11T19:28:14.4889077Z                              $pageFileSize = if ($totalRAM -ge 32) {
2026-01-11T19:28:14.4889970Z                                  4096
2026-01-11T19:28:14.4891274Z                              } else {
2026-01-11T19:28:14.4891529Z                                  8192
2026-01-11T19:28:14.4892142Z                              }
2026-01-11T19:28:14.4892980Z                      
2026-01-11T19:28:14.4894350Z                              Write-Log "System has ${totalRAM}GB RAM - setting ${pageFileSize}MB fixed page file" 
2026-01-11T19:28:14.4894504Z                      "INFO"
2026-01-11T19:28:14.4894957Z                      
2026-01-11T19:28:14.4895957Z                              $ComputerSystem = Get-WmiObject Win32_ComputerSystem -EnableAllPrivileges
2026-01-11T19:28:14.4896478Z                              if ($ComputerSystem.AutomaticManagedPagefile) {
2026-01-11T19:28:14.4897376Z                                  $ComputerSystem.AutomaticManagedPagefile = $false
2026-01-11T19:28:14.4897885Z                                  $ComputerSystem.Put() | Out-Null
2026-01-11T19:28:14.4898418Z                                  Write-Log "Disabled automatic page file management" "SUCCESS"
2026-01-11T19:28:14.4899401Z                              }
2026-01-11T19:28:14.4899775Z                      
2026-01-11T19:28:14.4901418Z                              $PageFile = Get-WmiObject -Query "Select * From Win32_PageFileSetting Where 
2026-01-11T19:28:14.4901570Z                      Name='C:\\pagefile.sys'"
2026-01-11T19:28:14.4901690Z                              if ($PageFile) {
2026-01-11T19:28:14.4902443Z                                  $PageFile.InitialSize = $pageFileSize
2026-01-11T19:28:14.4903175Z                                  $PageFile.MaximumSize = $pageFileSize
2026-01-11T19:28:14.4903951Z                                  $PageFile.Put() | Out-Null
2026-01-11T19:28:14.4905257Z                                  $sizeGB = [math]::Round($pageFileSize / 1024, 1)
2026-01-11T19:28:14.4905695Z                                  Write-Log "Set page file to fixed ${pageFileSize}MB size (${sizeGB}GB)" "SUCCESS"
2026-01-11T19:28:14.4905842Z                              } else {
2026-01-11T19:28:14.4907069Z                                  $PageFile = ([WMIClass]"Win32_PageFileSetting").CreateInstance()
2026-01-11T19:28:14.4907281Z                                  $PageFile.Name = "C:\pagefile.sys"
2026-01-11T19:28:14.4907895Z                                  $PageFile.InitialSize = $pageFileSize
2026-01-11T19:28:14.4908839Z                                  $PageFile.MaximumSize = $pageFileSize
2026-01-11T19:28:14.4909359Z                                  $PageFile.Put() | Out-Null
2026-01-11T19:28:14.4910514Z                                  Write-Log "Created fixed ${pageFileSize}MB page file" "SUCCESS"
2026-01-11T19:28:14.4910624Z                              }
2026-01-11T19:28:14.4911798Z                      
2026-01-11T19:28:14.4912136Z                              Write-Log "Page file changes require restart to take effect" "INFO"
2026-01-11T19:28:14.4913021Z                      
2026-01-11T19:28:14.4913735Z                          } catch {
2026-01-11T19:28:14.4914696Z                              Write-Log "Error configuring page file: $_" "ERROR"
2026-01-11T19:28:14.4915356Z                              throw
2026-01-11T19:28:14.4916175Z                          }
2026-01-11T19:28:14.4916840Z                      }
2026-01-11T19:28:14.4917766Z                      
2026-01-11T19:28:14.4918544Z                      
2026-01-11T19:28:14.4919253Z                      function Set-MemoryCompression {
2026-01-11T19:28:14.4920305Z                          <#
2026-01-11T19:28:14.4921480Z                          .SYNOPSIS
2026-01-11T19:28:14.4921895Z                              Toggles Windows memory compression (opt-in).
2026-01-11T19:28:14.4922406Z                          .DESCRIPTION
2026-01-11T19:28:14.4923484Z                              Disables memory compression only on high-RAM systems when requested.
2026-01-11T19:28:14.4923647Z                          .PARAMETER Disable
2026-01-11T19:28:14.4924713Z                              When true, attempts to disable memory compression.
2026-01-11T19:28:14.4925115Z                          .OUTPUTS
2026-01-11T19:28:14.4926318Z                              None.
2026-01-11T19:28:14.4926427Z                          #>
2026-01-11T19:28:14.4927240Z                          param(
2026-01-11T19:28:14.4928143Z                              [bool]$Disable = $false
2026-01-11T19:28:14.4928846Z                          )
2026-01-11T19:28:14.4929581Z                      
2026-01-11T19:28:14.4930450Z                          try {
2026-01-11T19:28:14.4931347Z                              $totalRAM = Get-SystemRAM
2026-01-11T19:28:14.4932021Z                      
2026-01-11T19:28:14.4933062Z                              if ($Disable -and $totalRAM -ge 32) {
2026-01-11T19:28:14.4933747Z                                  Disable-MMAgent -MemoryCompression -ErrorAction SilentlyContinue
2026-01-11T19:28:14.4934215Z                                  Write-Log "Disabled memory compression (system has ${totalRAM}GB RAM)" "SUCCESS"
2026-01-11T19:28:14.4934647Z                              } else {
2026-01-11T19:28:14.4935370Z                                  if ($totalRAM -ge 32) {
2026-01-11T19:28:14.4936653Z                                      Write-Log "Keeping memory compression enabled (default, even with ${totalRAM}GB 
2026-01-11T19:28:14.4936734Z                      RAM)" "INFO"
2026-01-11T19:28:14.4937726Z                                  } else {
2026-01-11T19:28:14.4938834Z                                      Write-Log "Keeping memory compression enabled (system has ${totalRAM}GB RAM)" 
2026-01-11T19:28:14.4938941Z                      "INFO"
2026-01-11T19:28:14.4939835Z                                  }
2026-01-11T19:28:14.4940100Z                              }
2026-01-11T19:28:14.4941332Z                      
2026-01-11T19:28:14.4942201Z                          } catch {
2026-01-11T19:28:14.4942857Z                              Write-Log "Error configuring memory compression: $_" "ERROR"
2026-01-11T19:28:14.4943196Z                              throw
2026-01-11T19:28:14.4944041Z                          }
2026-01-11T19:28:14.4944236Z                      }
2026-01-11T19:28:14.4945338Z                      
2026-01-11T19:28:14.4945595Z                      
2026-01-11T19:28:14.4946882Z                      function Disable-FastStartup {
2026-01-11T19:28:14.4947082Z                          <#
2026-01-11T19:28:14.4947962Z                          .SYNOPSIS
2026-01-11T19:28:14.4948164Z                              Disables Windows Fast Startup.
2026-01-11T19:28:14.4949493Z                          .DESCRIPTION
2026-01-11T19:28:14.4949985Z                              Writes HiberbootEnabled to 0 to force clean boots.
2026-01-11T19:28:14.4950387Z                          .OUTPUTS
2026-01-11T19:28:14.4950835Z                              None.
2026-01-11T19:28:14.4951897Z                          #>
2026-01-11T19:28:14.4952240Z                          $regPath = "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Power"
2026-01-11T19:28:14.4953173Z                      
2026-01-11T19:28:14.4954013Z                          Backup-RegistryKey -Path $regPath
2026-01-11T19:28:14.4954401Z                      
2026-01-11T19:28:14.4955154Z                          try {
2026-01-11T19:28:14.4956375Z                              Set-RegistryValue -Path $regPath -Name "HiberbootEnabled" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.4956971Z                              Write-Log "Disabled Fast Startup (cleaner boots, better for gaming)" "SUCCESS"
2026-01-11T19:28:14.4957491Z                      
2026-01-11T19:28:14.4958052Z                          } catch {
2026-01-11T19:28:14.4959330Z                              Write-Log "Error disabling fast startup: $_" "ERROR"
2026-01-11T19:28:14.4959665Z                              throw
2026-01-11T19:28:14.4960780Z                          }
2026-01-11T19:28:14.4961555Z                      }
2026-01-11T19:28:14.4962521Z                      
2026-01-11T19:28:14.4963301Z                      
2026-01-11T19:28:14.4963636Z                      function Disable-ExplorerAutoType {
2026-01-11T19:28:14.4964702Z                          <#
2026-01-11T19:28:14.4965082Z                          .SYNOPSIS
2026-01-11T19:28:14.4966375Z                              Disables Explorer automatic folder type detection.
2026-01-11T19:28:14.4966502Z                          .DESCRIPTION
2026-01-11T19:28:14.4967815Z                              Forces a generic folder type to reduce Explorer metadata churn.
2026-01-11T19:28:14.4967966Z                          .OUTPUTS
2026-01-11T19:28:14.4968874Z                              None.
2026-01-11T19:28:14.4969738Z                          #>
2026-01-11T19:28:14.4970533Z                          try {
2026-01-11T19:28:14.4971742Z                              $shellPath = "HKCU:\Software\Classes\Local 
2026-01-11T19:28:14.4972059Z                      Settings\Software\Microsoft\Windows\Shell\Bags\AllFolders\Shell"
2026-01-11T19:28:14.4973164Z                              Backup-RegistryKey -Path $shellPath
2026-01-11T19:28:14.4973687Z                              Set-RegistryValue -Path $shellPath -Name "FolderType" -Value "NotSpecified" -Type "String"
2026-01-11T19:28:14.4974058Z                              Write-Log "Disabled Explorer auto folder-type detection" "SUCCESS"
2026-01-11T19:28:14.4974677Z                          } catch {
2026-01-11T19:28:14.4974968Z                              Write-Log "Error disabling Explorer auto-type: $_" "ERROR"
2026-01-11T19:28:14.4976072Z                              throw
2026-01-11T19:28:14.4976180Z                          }
2026-01-11T19:28:14.4977203Z                      }
2026-01-11T19:28:14.4977756Z                      
2026-01-11T19:28:14.4978370Z                      
2026-01-11T19:28:14.4979566Z                      function Invoke-DiskCleanup {
2026-01-11T19:28:14.4980177Z                          <#
2026-01-11T19:28:14.4981223Z                          .SYNOPSIS
2026-01-11T19:28:14.4981479Z                              Runs disk cleanup when usage exceeds a threshold.
2026-01-11T19:28:14.4982527Z                          .DESCRIPTION
2026-01-11T19:28:14.4983018Z                              Executes cleanmgr and optional DISM ResetBase to reclaim disk space.
2026-01-11T19:28:14.4984367Z                              Can run DISM asynchronously with a toast notification on completion.
2026-01-11T19:28:14.4984583Z                          .PARAMETER Async
2026-01-11T19:28:14.4985627Z                              When true, runs DISM cleanup asynchronously.
2026-01-11T19:28:14.4986039Z                          .PARAMETER ThresholdPercent
2026-01-11T19:28:14.4987165Z                              Minimum disk usage percentage required to run cleanup.
2026-01-11T19:28:14.4987280Z                          .OUTPUTS
2026-01-11T19:28:14.4988245Z                              None.
2026-01-11T19:28:14.4988372Z                          #>
2026-01-11T19:28:14.4989504Z                          param(
2026-01-11T19:28:14.4989647Z                              [switch]$Async,
2026-01-11T19:28:14.4990783Z                              [int]$ThresholdPercent = 90
2026-01-11T19:28:14.4990900Z                          )
2026-01-11T19:28:14.4992118Z                      
2026-01-11T19:28:14.4992239Z                          try {
2026-01-11T19:28:14.4993315Z                              # Check disk usage before running expensive cleanup
2026-01-11T19:28:14.4993999Z                              $sysDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive
2026-01-11T19:28:14.4994699Z                              $disk = Get-CimInstance Win32_LogicalDisk -Filter "DeviceID='$sysDrive'"
2026-01-11T19:28:14.4995121Z                              $usedPercent = [math]::Round((($disk.Size - $disk.FreeSpace) / $disk.Size) * 100, 1)
2026-01-11T19:28:14.4996419Z                              $freeGB = [math]::Round($disk.FreeSpace / 1GB, 1)
2026-01-11T19:28:14.4996542Z                      
2026-01-11T19:28:14.4997323Z                              if ($usedPercent -lt $ThresholdPercent) {
2026-01-11T19:28:14.4998210Z                                  Write-Log "System drive $usedPercent% full (${freeGB}GB free) - skipping cleanup 
2026-01-11T19:28:14.4999248Z                      (threshold: ${ThresholdPercent}%)" "INFO"
2026-01-11T19:28:14.4999397Z                                  return
2026-01-11T19:28:14.5000633Z                              }
2026-01-11T19:28:14.5001336Z                      
2026-01-11T19:28:14.5002810Z                              Write-Log "System drive $usedPercent% full (${freeGB}GB free) - running cleanup" "INFO"
2026-01-11T19:28:14.5002947Z                      
2026-01-11T19:28:14.5003837Z                              # Set cleanup flags for cleanmgr
2026-01-11T19:28:14.5004251Z                              $cleanupKey = "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VolumeCaches"
2026-01-11T19:28:14.5005442Z                              Get-ChildItem $cleanupKey -EA SilentlyContinue | ForEach-Object {
2026-01-11T19:28:14.5006141Z                                  Set-ItemProperty -Path $_.PSPath -Name "StateFlags0100" -Value 2 -EA SilentlyContinue
2026-01-11T19:28:14.5006288Z                              }
2026-01-11T19:28:14.5007434Z                      
2026-01-11T19:28:14.5008333Z                              # Run cleanmgr synchronously (reasonably fast)
2026-01-11T19:28:14.5009098Z                              Start-Process "cleanmgr.exe" -ArgumentList "/sagerun:100" -Wait -WindowStyle Hidden
2026-01-11T19:28:14.5009580Z                              Write-Log "Disk Cleanup (cleanmgr) complete" "SUCCESS"
2026-01-11T19:28:14.5009891Z                      
2026-01-11T19:28:14.5010341Z                              if ($Async) {
2026-01-11T19:28:14.5010955Z                                  # DISM ResetBase can take 10-30+ minutes, run async with notification
2026-01-11T19:28:14.5011164Z                                  $dismJob = Start-Job -ScriptBlock {
2026-01-11T19:28:14.5012313Z                                      Dism.exe /Online /Cleanup-Image /StartComponentCleanup /ResetBase 2>&1 | Out-Null
2026-01-11T19:28:14.5012616Z                                  }
2026-01-11T19:28:14.5013491Z                      
2026-01-11T19:28:14.5014733Z                                  Register-ObjectEvent -InputObject $dismJob -EventName StateChanged -Action {
2026-01-11T19:28:14.5015296Z                                      if ($Sender.State -eq 'Completed') {
2026-01-11T19:28:14.5015572Z                                          try {
2026-01-11T19:28:14.5016195Z                                              [Windows.UI.Notifications.ToastNotificationManager, 
2026-01-11T19:28:14.5016795Z                      Windows.UI.Notifications, ContentType = WindowsRuntime] | Out-Null
2026-01-11T19:28:14.5018128Z                                              $template = [Windows.UI.Notifications.ToastNotificationManager]::GetTempla
2026-01-11T19:28:14.5018818Z                      teContent([Windows.UI.Notifications.ToastTemplateType]::ToastText02)
2026-01-11T19:28:14.5019042Z                                              $text = $template.GetElementsByTagName("text")
2026-01-11T19:28:14.5019709Z                                              $text.Item(0).AppendChild($template.CreateTextNode("Gaming PC Setup")) | 
2026-01-11T19:28:14.5020628Z                      Out-Null
2026-01-11T19:28:14.5021350Z                                              $text.Item(1).AppendChild($template.CreateTextNode("DISM ResetBase 
2026-01-11T19:28:14.5022156Z                      complete! Disk space reclaimed.")) | Out-Null
2026-01-11T19:28:14.5022565Z                                              $notifier = 
2026-01-11T19:28:14.5023819Z                      [Windows.UI.Notifications.ToastNotificationManager]::CreateToastNotifier("Gaming PC Setup")
2026-01-11T19:28:14.5023994Z                                              
2026-01-11T19:28:14.5025503Z                      $notifier.Show([Windows.UI.Notifications.ToastNotification]::new($template))
2026-01-11T19:28:14.5025616Z                                          } catch {
2026-01-11T19:28:14.5026534Z                                              # Toast failed silently
2026-01-11T19:28:14.5026665Z                                          }
2026-01-11T19:28:14.5028233Z                                          Unregister-Event -SourceIdentifier $Event.SourceIdentifier
2026-01-11T19:28:14.5028434Z                                          Remove-Job $Sender
2026-01-11T19:28:14.5029490Z                                      }
2026-01-11T19:28:14.5029972Z                                  } | Out-Null
2026-01-11T19:28:14.5030414Z                      
2026-01-11T19:28:14.5031761Z                                  Write-Log "DISM ResetBase started in background (toast notification on completion)" 
2026-01-11T19:28:14.5031922Z                      "INFO"
2026-01-11T19:28:14.5032863Z                              } else {
2026-01-11T19:28:14.5033430Z                                  # Synchronous mode for backwards compatibility
2026-01-11T19:28:14.5034032Z                                  Dism.exe /Online /Cleanup-Image /StartComponentCleanup /ResetBase 2>&1 | Out-Null
2026-01-11T19:28:14.5034565Z                                  Write-Log "DISM ResetBase complete" "SUCCESS"
2026-01-11T19:28:14.5034981Z                              }
2026-01-11T19:28:14.5035816Z                          } catch {
2026-01-11T19:28:14.5036722Z                              Write-Log "Error running Disk Cleanup: $_" "ERROR"
2026-01-11T19:28:14.5037185Z                              throw
2026-01-11T19:28:14.5038443Z                          }
2026-01-11T19:28:14.5038554Z                      }
2026-01-11T19:28:14.5039608Z                      
2026-01-11T19:28:14.5040074Z                      
2026-01-11T19:28:14.5041242Z                      function Invoke-TempPurge {
2026-01-11T19:28:14.5041424Z                          <#
2026-01-11T19:28:14.5041879Z                          .SYNOPSIS
2026-01-11T19:28:14.5043129Z                              Clears common temporary folders.
2026-01-11T19:28:14.5043425Z                          .DESCRIPTION
2026-01-11T19:28:14.5044901Z                              Removes files under %TEMP% and %WINDIR%\Temp with best-effort error handling.
2026-01-11T19:28:14.5045004Z                          .OUTPUTS
2026-01-11T19:28:14.5046107Z                              None.
2026-01-11T19:28:14.5046393Z                          #>
2026-01-11T19:28:14.5047589Z                          try {
2026-01-11T19:28:14.5048580Z                              $tempPaths = @("$env:TEMP","$env:WINDIR\Temp")
2026-01-11T19:28:14.5049134Z                              foreach ($p in $tempPaths) {
2026-01-11T19:28:14.5049942Z                                  if (Test-Path $p) {
2026-01-11T19:28:14.5051297Z                                      Get-ChildItem -Path $p -Recurse -Force -ErrorAction SilentlyContinue | 
2026-01-11T19:28:14.5051470Z                      Remove-Item -Force -Recurse -ErrorAction SilentlyContinue
2026-01-11T19:28:14.5052410Z                                  }
2026-01-11T19:28:14.5053260Z                              }
2026-01-11T19:28:14.5053508Z                              Write-Log "Temp folders cleared" "SUCCESS"
2026-01-11T19:28:14.5054590Z                          } catch {
2026-01-11T19:28:14.5054963Z                              Write-Log "Error purging temp folders: $_" "ERROR"
2026-01-11T19:28:14.5055999Z                              throw
2026-01-11T19:28:14.5056812Z                          }
2026-01-11T19:28:14.5057609Z                      }
2026-01-11T19:28:14.5057918Z                      
2026-01-11T19:28:14.5059145Z                      
2026-01-11T19:28:14.5060310Z                      function Set-ServiceTrimSafe {
2026-01-11T19:28:14.5060431Z                          <#
2026-01-11T19:28:14.5061658Z                          .SYNOPSIS
2026-01-11T19:28:14.5061927Z                              Sets select services to Manual to reduce background load.
2026-01-11T19:28:14.5063191Z                          .DESCRIPTION
2026-01-11T19:28:14.5063556Z                              Targets a curated list of non-essential services and stops them.
2026-01-11T19:28:14.5063979Z                          .PARAMETER Enable
2026-01-11T19:28:14.5065217Z                              When true, applies service trimming.
2026-01-11T19:28:14.5065350Z                          .OUTPUTS
2026-01-11T19:28:14.5065655Z                              None.
2026-01-11T19:28:14.5067584Z                          #>
2026-01-11T19:28:14.5067711Z                          param(
2026-01-11T19:28:14.5068704Z                              [bool]$Enable = $true
2026-01-11T19:28:14.5068810Z                          )
2026-01-11T19:28:14.5069982Z                      
2026-01-11T19:28:14.5070736Z                          if (-not $Enable) {
2026-01-11T19:28:14.5071937Z                              Write-Log "Service trim skipped" "INFO"
2026-01-11T19:28:14.5072069Z                              return
2026-01-11T19:28:14.5072758Z                          }
2026-01-11T19:28:14.5073502Z                      
2026-01-11T19:28:14.5074874Z                          $services = @("DiagTrack","dmwappushservice","lfsvc","RetailDemo","Fax","SharedAccess","XblGam
2026-01-11T19:28:14.5075001Z                      eSave","XblAuthManager","XboxNetApiSvc")
2026-01-11T19:28:14.5076020Z                      
2026-01-11T19:28:14.5076756Z                          foreach ($svc in $services) {
2026-01-11T19:28:14.5077224Z                              try {
2026-01-11T19:28:14.5078375Z                                  Set-Service -Name $svc -StartupType Manual -EA SilentlyContinue
2026-01-11T19:28:14.5079266Z                                  Stop-Service -Name $svc -Force -EA SilentlyContinue
2026-01-11T19:28:14.5079829Z                                  Write-Log "Trimmed service to Manual: $svc" "SUCCESS"
2026-01-11T19:28:14.5080095Z                              } catch {
2026-01-11T19:28:14.5081492Z                                  Write-Log "Could not trim service $svc : $_" "ERROR"
2026-01-11T19:28:14.5082529Z                              }
2026-01-11T19:28:14.5082682Z                          }
2026-01-11T19:28:14.5082874Z                      }
2026-01-11T19:28:14.5083873Z                      
2026-01-11T19:28:14.5084507Z                      
2026-01-11T19:28:14.5085756Z                      function Disable-RazerAutoInstall {
2026-01-11T19:28:14.5086170Z                          <#
2026-01-11T19:28:14.5086328Z                          .SYNOPSIS
2026-01-11T19:28:14.5087583Z                              Disables Razer/OEM auto-install services and tasks.
2026-01-11T19:28:14.5087702Z                          .DESCRIPTION
2026-01-11T19:28:14.5089068Z                              Stops and disables Razer-related services and scheduled tasks that can
2026-01-11T19:28:14.5089266Z                              install software automatically.
2026-01-11T19:28:14.5090136Z                          .PARAMETER Enable
2026-01-11T19:28:14.5090408Z                              When true, applies the block.
2026-01-11T19:28:14.5091600Z                          .OUTPUTS
2026-01-11T19:28:14.5091749Z                              None.
2026-01-11T19:28:14.5092955Z                          #>
2026-01-11T19:28:14.5093492Z                          param(
2026-01-11T19:28:14.5094342Z                              [bool]$Enable = $true
2026-01-11T19:28:14.5094970Z                          )
2026-01-11T19:28:14.5096012Z                      
2026-01-11T19:28:14.5096134Z                          if (-not $Enable) {
2026-01-11T19:28:14.5097308Z                              Write-Log "Razer/OEM block skipped" "INFO"
2026-01-11T19:28:14.5097427Z                              return
2026-01-11T19:28:14.5098846Z                          }
2026-01-11T19:28:14.5098959Z                      
2026-01-11T19:28:14.5099073Z                          try {
2026-01-11T19:28:14.5100520Z                              $razerServices = Get-Service | Where-Object { $_.Name -like "Razer*" }
2026-01-11T19:28:14.5100663Z                              foreach ($svc in $razerServices) {
2026-01-11T19:28:14.5101980Z                                  try { Stop-Service $svc -Force -EA SilentlyContinue; Set-Service $svc -StartupType 
2026-01-11T19:28:14.5102215Z                      Disabled -EA SilentlyContinue } catch {}
2026-01-11T19:28:14.5102407Z                              }
2026-01-11T19:28:14.5103491Z                      
2026-01-11T19:28:14.5104253Z                              $razerTasks = Get-ScheduledTask | Where-Object { $_.TaskName -like "*Razer*" }
2026-01-11T19:28:14.5104766Z                              if ($razerTasks) { $razerTasks | Disable-ScheduledTask -EA SilentlyContinue | Out-Null }
2026-01-11T19:28:14.5104886Z                      
2026-01-11T19:28:14.5114816Z                              Write-Log "Razer/OEM auto-install payloads blocked (services/tasks disabled)" "SUCCESS"
2026-01-11T19:28:14.5114963Z                          } catch {
2026-01-11T19:28:14.5115267Z                              Write-Log "Error blocking Razer/OEM auto-installs: $_" "ERROR"
2026-01-11T19:28:14.5115365Z                          }
2026-01-11T19:28:14.5115455Z                      }
2026-01-11T19:28:14.5115542Z                      
2026-01-11T19:28:14.5115627Z                      
2026-01-11T19:28:14.5115755Z                      function New-RestorePoint {
2026-01-11T19:28:14.5115841Z                          <#
2026-01-11T19:28:14.5115949Z                          .SYNOPSIS
2026-01-11T19:28:14.5116314Z                              Creates a Windows System Restore Point before applying optimizations.
2026-01-11T19:28:14.5116417Z                          .DESCRIPTION
2026-01-11T19:28:14.5116667Z                              Safety feature - creates a restore point so user can roll back if needed.
2026-01-11T19:28:14.5116937Z                              Requires System Restore to be enabled on the system drive.
2026-01-11T19:28:14.5117058Z                          .PARAMETER Description
2026-01-11T19:28:14.5117395Z                              Restore point description string.
2026-01-11T19:28:14.5117578Z                          .OUTPUTS
2026-01-11T19:28:14.5117762Z                              [bool] True if created, false otherwise.
2026-01-11T19:28:14.5117889Z                          #>
2026-01-11T19:28:14.5117992Z                          param(
2026-01-11T19:28:14.5118189Z                              [string]$Description = "Pre-Gaming-PC-Setup"
2026-01-11T19:28:14.5118276Z                          )
2026-01-11T19:28:14.5118429Z                      
2026-01-11T19:28:14.5119357Z                          try {
2026-01-11T19:28:14.5120368Z                              # Check if System Restore is enabled
2026-01-11T19:28:14.5121316Z                              $srStatus = Get-ComputerRestorePoint -ErrorAction SilentlyContinue
2026-01-11T19:28:14.5121903Z                      
2026-01-11T19:28:14.5122271Z                              # Enable System Restore on C: if needed (will fail silently if already enabled)
2026-01-11T19:28:14.5123465Z                              Enable-ComputerRestore -Drive "C:\" -ErrorAction SilentlyContinue
2026-01-11T19:28:14.5123591Z                      
2026-01-11T19:28:14.5124563Z                              # Create restore point
2026-01-11T19:28:14.5125880Z                              Checkpoint-Computer -Description $Description -RestorePointType "MODIFY_SETTINGS" 
2026-01-11T19:28:14.5126229Z                      -ErrorAction Stop
2026-01-11T19:28:14.5127569Z                              Write-Log "Created System Restore Point: $Description" "SUCCESS"
2026-01-11T19:28:14.5127711Z                              return $true
2026-01-11T19:28:14.5127864Z                          } catch {
2026-01-11T19:28:14.5129257Z                              if ($_.Exception.Message -like "*1058*" -or $_.Exception.Message -like "*disabled*") {
2026-01-11T19:28:14.5129644Z                                  Write-Log "System Restore is disabled - skipping restore point creation" "INFO"
2026-01-11T19:28:14.5130845Z                              } elseif ($_.Exception.Message -like "*frequency*" -or $_.Exception.Message -like 
2026-01-11T19:28:14.5130990Z                      "*already*") {
2026-01-11T19:28:14.5132886Z                                  Write-Log "Restore point recently created (Windows limits frequency) - continuing" 
2026-01-11T19:28:14.5132992Z                      "INFO"
2026-01-11T19:28:14.5133058Z                              } else {
2026-01-11T19:28:14.5134168Z                                  Write-Log "Could not create restore point: $_" "ERROR"
2026-01-11T19:28:14.5134538Z                              }
2026-01-11T19:28:14.5135384Z                              return $false
2026-01-11T19:28:14.5137066Z                          }
2026-01-11T19:28:14.5137198Z                      }
2026-01-11T19:28:14.5137673Z                      
2026-01-11T19:28:14.5138904Z                      
2026-01-11T19:28:14.5139106Z                      function Set-ClassicContextMenu {
2026-01-11T19:28:14.5140209Z                          <#
2026-01-11T19:28:14.5140561Z                          .SYNOPSIS
2026-01-11T19:28:14.5141711Z                              Restores the classic Windows 10-style right-click context menu on Windows 11.
2026-01-11T19:28:14.5141834Z                          .DESCRIPTION
2026-01-11T19:28:14.5143123Z                              Windows 11's new context menu is slower and requires extra clicks.
2026-01-11T19:28:14.5143375Z                              This tweak restores the full classic menu for faster navigation.
2026-01-11T19:28:14.5144335Z                          .PARAMETER Enable
2026-01-11T19:28:14.5145372Z                              When true, enables the classic context menu on Windows 11.
2026-01-11T19:28:14.5145751Z                          .OUTPUTS
2026-01-11T19:28:14.5146766Z                              None.
2026-01-11T19:28:14.5147547Z                          #>
2026-01-11T19:28:14.5147881Z                          param(
2026-01-11T19:28:14.5148958Z                              [bool]$Enable = $true
2026-01-11T19:28:14.5149580Z                          )
2026-01-11T19:28:14.5150478Z                      
2026-01-11T19:28:14.5150623Z                          if (-not $Enable) {
2026-01-11T19:28:14.5151751Z                              Write-Log "Classic context menu: skipped" "INFO"
2026-01-11T19:28:14.5152091Z                              return
2026-01-11T19:28:14.5153135Z                          }
2026-01-11T19:28:14.5153579Z                      
2026-01-11T19:28:14.5154453Z                          try {
2026-01-11T19:28:14.5154604Z                              # Check if Windows 11
2026-01-11T19:28:14.5156017Z                              $build = [int](Get-CimInstance Win32_OperatingSystem).BuildNumber
2026-01-11T19:28:14.5156166Z                              if ($build -lt 22000) {
2026-01-11T19:28:14.5157784Z                                  Write-Log "Classic context menu: Not needed (Windows 10 detected)" "INFO"
2026-01-11T19:28:14.5157920Z                                  return
2026-01-11T19:28:14.5159016Z                              }
2026-01-11T19:28:14.5159124Z                      
2026-01-11T19:28:14.5160170Z                              $classicMenuPath = 
2026-01-11T19:28:14.5161317Z                      "HKCU:\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}\InprocServer32"
2026-01-11T19:28:14.5161597Z                      
2026-01-11T19:28:14.5162434Z                              # Create the key path if it doesn't exist
2026-01-11T19:28:14.5163330Z                              if (-not (Test-Path $classicMenuPath)) {
2026-01-11T19:28:14.5163613Z                                  New-Item -Path $classicMenuPath -Force | Out-Null
2026-01-11T19:28:14.5164693Z                              }
2026-01-11T19:28:14.5164801Z                      
2026-01-11T19:28:14.5165864Z                              # Set empty default value to enable classic menu
2026-01-11T19:28:14.5166296Z                              Set-ItemProperty -Path $classicMenuPath -Name "(Default)" -Value "" -Force
2026-01-11T19:28:14.5167149Z                      
2026-01-11T19:28:14.5167954Z                              Write-Log "Classic right-click context menu enabled (restart Explorer to apply)" "SUCCESS"
2026-01-11T19:28:14.5168105Z                          } catch {
2026-01-11T19:28:14.5169421Z                              Write-Log "Error setting classic context menu: $_" "ERROR"
2026-01-11T19:28:14.5169531Z                          }
2026-01-11T19:28:14.5170437Z                      }
2026-01-11T19:28:14.5170552Z                      
2026-01-11T19:28:14.5172123Z                      
2026-01-11T19:28:14.5172625Z                      function Disable-StorageSense {
2026-01-11T19:28:14.5173016Z                          <#
2026-01-11T19:28:14.5173455Z                          .SYNOPSIS
2026-01-11T19:28:14.5173989Z                              Disables Windows Storage Sense automatic cleanup.
2026-01-11T19:28:14.5174245Z                          .DESCRIPTION
2026-01-11T19:28:14.5175552Z                              Storage Sense can cause background disk activity during gaming.
2026-01-11T19:28:14.5175857Z                              Disabling it prevents unexpected cleanup operations.
2026-01-11T19:28:14.5176389Z                          .PARAMETER Enable
2026-01-11T19:28:14.5177759Z                              When true, disables Storage Sense.
2026-01-11T19:28:14.5177924Z                          .OUTPUTS
2026-01-11T19:28:14.5178963Z                              None.
2026-01-11T19:28:14.5179750Z                          #>
2026-01-11T19:28:14.5179914Z                          param(
2026-01-11T19:28:14.5181071Z                              [bool]$Enable = $true
2026-01-11T19:28:14.5181404Z                          )
2026-01-11T19:28:14.5182262Z                      
2026-01-11T19:28:14.5183039Z                          if (-not $Enable) {
2026-01-11T19:28:14.5184181Z                              Write-Log "Disable Storage Sense: skipped" "INFO"
2026-01-11T19:28:14.5184863Z                              return
2026-01-11T19:28:14.5184992Z                          }
2026-01-11T19:28:14.5186131Z                      
2026-01-11T19:28:14.5186243Z                          try {
2026-01-11T19:28:14.5187383Z                              $storagePath = 
2026-01-11T19:28:14.5188539Z                      "HKCU:\Software\Microsoft\Windows\CurrentVersion\StorageSense\Parameters\StoragePolicy"
2026-01-11T19:28:14.5188668Z                              Backup-RegistryKey -Path $storagePath
2026-01-11T19:28:14.5189438Z                      
2026-01-11T19:28:14.5190298Z                              # Disable Storage Sense
2026-01-11T19:28:14.5191416Z                              Set-RegistryValue -Path $storagePath -Name "01" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.5191946Z                              Set-RegistryValue -Path $storagePath -Name "StoragePoliciesNotified" -Value 1 -Type 
2026-01-11T19:28:14.5192352Z                      "DWORD"
2026-01-11T19:28:14.5193247Z                      
2026-01-11T19:28:14.5193648Z                              Write-Log "Disabled Storage Sense (no background cleanup during gaming)" "SUCCESS"
2026-01-11T19:28:14.5194535Z                          } catch {
2026-01-11T19:28:14.5195730Z                              Write-Log "Error disabling Storage Sense: $_" "ERROR"
2026-01-11T19:28:14.5195835Z                          }
2026-01-11T19:28:14.5197130Z                      }
2026-01-11T19:28:14.5197455Z                      
2026-01-11T19:28:14.5198465Z                      
2026-01-11T19:28:14.5198989Z                      function Set-DisplayPerformance {
2026-01-11T19:28:14.5200052Z                          <#
2026-01-11T19:28:14.5200449Z                          .SYNOPSIS
2026-01-11T19:28:14.5201610Z                              Configures Windows visual effects for maximum performance.
2026-01-11T19:28:14.5201744Z                          .DESCRIPTION
2026-01-11T19:28:14.5203180Z                              Disables animations, shadows, and other visual effects that consume GPU/CPU resources.
2026-01-11T19:28:14.5203522Z                              Reduces visual overhead for slightly better gaming performance.
2026-01-11T19:28:14.5203687Z                          .PARAMETER Enable
2026-01-11T19:28:14.5204961Z                              When true, applies performance-oriented visual settings.
2026-01-11T19:28:14.5205115Z                          .OUTPUTS
2026-01-11T19:28:14.5206262Z                              None.
2026-01-11T19:28:14.5206429Z                          #>
2026-01-11T19:28:14.5207762Z                          param(
2026-01-11T19:28:14.5207917Z                              [bool]$Enable = $true
2026-01-11T19:28:14.5209041Z                          )
2026-01-11T19:28:14.5209185Z                      
2026-01-11T19:28:14.5209896Z                          if (-not $Enable) {
2026-01-11T19:28:14.5211199Z                              Write-Log "Display performance mode: skipped" "INFO"
2026-01-11T19:28:14.5211353Z                              return
2026-01-11T19:28:14.5212388Z                          }
2026-01-11T19:28:14.5213193Z                      
2026-01-11T19:28:14.5214002Z                          try {
2026-01-11T19:28:14.5214995Z                              $visualPath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects"
2026-01-11T19:28:14.5215225Z                              Backup-RegistryKey -Path $visualPath
2026-01-11T19:28:14.5217366Z                              Set-RegistryValue -Path $visualPath -Name "VisualFXSetting" -Value 2 -Type "DWORD"  # 2 = 
2026-01-11T19:28:14.5217742Z                      Custom (we'll set individual settings)
2026-01-11T19:28:14.5217880Z                      
2026-01-11T19:28:14.5218865Z                              $advancedPath = "HKCU:\Control Panel\Desktop"
2026-01-11T19:28:14.5219301Z                              Backup-RegistryKey -Path $advancedPath
2026-01-11T19:28:14.5219873Z                              Set-RegistryValue -Path $advancedPath -Name "DragFullWindows" -Value "0" -Type "String"
2026-01-11T19:28:14.5220633Z                              Set-RegistryValue -Path $advancedPath -Name "MenuShowDelay" -Value "0" -Type "String"
2026-01-11T19:28:14.5220742Z                      
2026-01-11T19:28:14.5222091Z                              $windowMetrics = "HKCU:\Control Panel\Desktop\WindowMetrics"
2026-01-11T19:28:14.5222307Z                              Backup-RegistryKey -Path $windowMetrics
2026-01-11T19:28:14.5223078Z                              Set-RegistryValue -Path $windowMetrics -Name "MinAnimate" -Value "0" -Type "String"
2026-01-11T19:28:14.5223491Z                      
2026-01-11T19:28:14.5224807Z                              $explorerPath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced"
2026-01-11T19:28:14.5224952Z                              Backup-RegistryKey -Path $explorerPath
2026-01-11T19:28:14.5226153Z                              Set-RegistryValue -Path $explorerPath -Name "TaskbarAnimations" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.5226443Z                              Set-RegistryValue -Path $explorerPath -Name "ListviewAlphaSelect" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.5227132Z                              Set-RegistryValue -Path $explorerPath -Name "ListviewShadow" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.5227547Z                      
2026-01-11T19:28:14.5228943Z                              Write-Log "Set display for performance (reduced visual effects)" "SUCCESS"
2026-01-11T19:28:14.5229023Z                          } catch {
2026-01-11T19:28:14.5230165Z                              Write-Log "Error setting display performance: $_" "ERROR"
2026-01-11T19:28:14.5230524Z                          }
2026-01-11T19:28:14.5231462Z                      }
2026-01-11T19:28:14.5231574Z                      
2026-01-11T19:28:14.5232774Z                      
2026-01-11T19:28:14.5233590Z                      function Enable-TaskbarEndTask {
2026-01-11T19:28:14.5234321Z                          <#
2026-01-11T19:28:14.5234765Z                          .SYNOPSIS
2026-01-11T19:28:14.5235864Z                              Enables "End Task" option when right-clicking taskbar items.
2026-01-11T19:28:14.5236033Z                          .DESCRIPTION
2026-01-11T19:28:14.5237507Z                              Useful for quickly killing frozen games or unresponsive applications
2026-01-11T19:28:14.5237637Z                              without needing to open Task Manager.
2026-01-11T19:28:14.5238909Z                          .PARAMETER Enable
2026-01-11T19:28:14.5239152Z                              When true, enables the taskbar End Task option.
2026-01-11T19:28:14.5239908Z                          .OUTPUTS
2026-01-11T19:28:14.5240752Z                              None.
2026-01-11T19:28:14.5241215Z                          #>
2026-01-11T19:28:14.5242109Z                          param(
2026-01-11T19:28:14.5242296Z                              [bool]$Enable = $true
2026-01-11T19:28:14.5243327Z                          )
2026-01-11T19:28:14.5244075Z                      
2026-01-11T19:28:14.5244795Z                          if (-not $Enable) {
2026-01-11T19:28:14.5245729Z                              Write-Log "Taskbar End Task: skipped" "INFO"
2026-01-11T19:28:14.5246444Z                              return
2026-01-11T19:28:14.5247265Z                          }
2026-01-11T19:28:14.5248023Z                      
2026-01-11T19:28:14.5248824Z                          try {
2026-01-11T19:28:14.5249967Z                              $taskbarPath = 
2026-01-11T19:28:14.5250730Z                      "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced\TaskbarDeveloperSettings"
2026-01-11T19:28:14.5250851Z                      
2026-01-11T19:28:14.5252037Z                              if (-not (Test-Path $taskbarPath)) {
2026-01-11T19:28:14.5252391Z                                  New-Item -Path $taskbarPath -Force | Out-Null
2026-01-11T19:28:14.5253401Z                              }
2026-01-11T19:28:14.5253813Z                      
2026-01-11T19:28:14.5254949Z                              Backup-RegistryKey -Path $taskbarPath
2026-01-11T19:28:14.5255639Z                              Set-RegistryValue -Path $taskbarPath -Name "TaskbarEndTask" -Value 1 -Type "DWORD"
2026-01-11T19:28:14.5255727Z                      
2026-01-11T19:28:14.5256947Z                              Write-Log "Enabled 'End Task' in taskbar right-click menu" "SUCCESS"
2026-01-11T19:28:14.5257052Z                          } catch {
2026-01-11T19:28:14.5258796Z                              Write-Log "Error enabling taskbar End Task: $_" "ERROR"
2026-01-11T19:28:14.5258910Z                          }
2026-01-11T19:28:14.5259004Z                      }
2026-01-11T19:28:14.5259974Z                      
2026-01-11T19:28:14.5260770Z                      
2026-01-11T19:28:14.5261632Z                      function Remove-ExplorerClutter {
2026-01-11T19:28:14.5262662Z                          <#
2026-01-11T19:28:14.5262818Z                          .SYNOPSIS
2026-01-11T19:28:14.5263968Z                              Removes Home and Gallery from Windows 11 Explorer navigation pane.
2026-01-11T19:28:14.5264296Z                          .DESCRIPTION
2026-01-11T19:28:14.5264604Z                              Cleans up Explorer navigation for faster access to files.
2026-01-11T19:28:14.5265113Z                              Only applies to Windows 11.
2026-01-11T19:28:14.5266051Z                          .PARAMETER Enable
2026-01-11T19:28:14.5266721Z                              When true, removes Home/Gallery entries.
2026-01-11T19:28:14.5267271Z                          .OUTPUTS
2026-01-11T19:28:14.5267634Z                              None.
2026-01-11T19:28:14.5268647Z                          #>
2026-01-11T19:28:14.5268768Z                          param(
2026-01-11T19:28:14.5270123Z                              [bool]$Enable = $true
2026-01-11T19:28:14.5270566Z                          )
2026-01-11T19:28:14.5271009Z                      
2026-01-11T19:28:14.5271462Z                          if (-not $Enable) {
2026-01-11T19:28:14.5271936Z                              Write-Log "Remove Explorer clutter: skipped" "INFO"
2026-01-11T19:28:14.5272355Z                              return
2026-01-11T19:28:14.5273536Z                          }
2026-01-11T19:28:14.5273649Z                      
2026-01-11T19:28:14.5274756Z                          try {
2026-01-11T19:28:14.5275638Z                              # Check if Windows 11
2026-01-11T19:28:14.5276989Z                              $build = [int](Get-CimInstance Win32_OperatingSystem).BuildNumber
2026-01-11T19:28:14.5277155Z                              if ($build -lt 22000) {
2026-01-11T19:28:14.5278322Z                                  Write-Log "Remove Explorer clutter: Not needed (Windows 10 detected)" "INFO"
2026-01-11T19:28:14.5278671Z                                  return
2026-01-11T19:28:14.5279695Z                              }
2026-01-11T19:28:14.5279797Z                      
2026-01-11T19:28:14.5280907Z                              # Remove Home from Explorer
2026-01-11T19:28:14.5282249Z                              $homePath = "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Desktop\NameSpace\{f
2026-01-11T19:28:14.5282366Z                      874310e-b6b7-47dc-bc84-b9e6b38f5903}"
2026-01-11T19:28:14.5283573Z                              if (Test-Path $homePath) {
2026-01-11T19:28:14.5284010Z                                  Remove-Item -Path $homePath -Force -ErrorAction SilentlyContinue
2026-01-11T19:28:14.5284894Z                                  Write-Log "Removed 'Home' from Explorer navigation" "SUCCESS"
2026-01-11T19:28:14.5285691Z                              }
2026-01-11T19:28:14.5286323Z                      
2026-01-11T19:28:14.5287374Z                              # Remove Gallery from Explorer
2026-01-11T19:28:14.5288185Z                              $galleryPath = "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Desktop\NameSpace
2026-01-11T19:28:14.5288623Z                      \{e88865ea-0e1c-4e20-9aa6-edcd0212c87c}"
2026-01-11T19:28:14.5289556Z                              if (Test-Path $galleryPath) {
2026-01-11T19:28:14.5289940Z                                  Remove-Item -Path $galleryPath -Force -ErrorAction SilentlyContinue
2026-01-11T19:28:14.5290868Z                                  Write-Log "Removed 'Gallery' from Explorer navigation" "SUCCESS"
2026-01-11T19:28:14.5291006Z                              }
2026-01-11T19:28:14.5291298Z                      
2026-01-11T19:28:14.5292035Z                          } catch {
2026-01-11T19:28:14.5293335Z                              Write-Log "Error removing Explorer clutter: $_" "ERROR"
2026-01-11T19:28:14.5293475Z                          }
2026-01-11T19:28:14.5294437Z                      }
2026-01-11T19:28:14.5295169Z                      
2026-01-11T19:28:14.5295399Z                      
2026-01-11T19:28:14.5296947Z                      function Disable-MouseAcceleration {
2026-01-11T19:28:14.5297239Z                          <#
2026-01-11T19:28:14.5298267Z                          .SYNOPSIS
2026-01-11T19:28:14.5299237Z                              Disables Windows mouse acceleration for consistent 1:1 movement.
2026-01-11T19:28:14.5299728Z                          .DESCRIPTION
2026-01-11T19:28:14.5300937Z                              Essential for competitive FPS players - ensures mouse movement
2026-01-11T19:28:14.5301204Z                              is linear and predictable regardless of speed.
2026-01-11T19:28:14.5302082Z                          .PARAMETER Enable
2026-01-11T19:28:14.5303026Z                              When true, disables enhanced pointer precision.
2026-01-11T19:28:14.5303484Z                          .OUTPUTS
2026-01-11T19:28:14.5304558Z                              None.
2026-01-11T19:28:14.5305017Z                          #>
2026-01-11T19:28:14.5306143Z                          param(
2026-01-11T19:28:14.5306300Z                              [bool]$Enable = $true
2026-01-11T19:28:14.5307318Z                          )
2026-01-11T19:28:14.5307431Z                      
2026-01-11T19:28:14.5308551Z                          if (-not $Enable) {
2026-01-11T19:28:14.5309165Z                              Write-Log "Disable mouse acceleration: skipped" "INFO"
2026-01-11T19:28:14.5310000Z                              return
2026-01-11T19:28:14.5310744Z                          }
2026-01-11T19:28:14.5311209Z                      
2026-01-11T19:28:14.5312120Z                          try {
2026-01-11T19:28:14.5312488Z                              $mousePath = "HKCU:\Control Panel\Mouse"
2026-01-11T19:28:14.5313774Z                              Backup-RegistryKey -Path $mousePath
2026-01-11T19:28:14.5313909Z                      
2026-01-11T19:28:14.5314835Z                              # Disable enhanced pointer precision (mouse acceleration)
2026-01-11T19:28:14.5315876Z                              Set-RegistryValue -Path $mousePath -Name "MouseSpeed" -Value "0" -Type "String"
2026-01-11T19:28:14.5317185Z                              Set-RegistryValue -Path $mousePath -Name "MouseThreshold1" -Value "0" -Type "String"
2026-01-11T19:28:14.5317860Z                              Set-RegistryValue -Path $mousePath -Name "MouseThreshold2" -Value "0" -Type "String"
2026-01-11T19:28:14.5317981Z                      
2026-01-11T19:28:14.5319216Z                              Write-Log "Disabled mouse acceleration (1:1 movement)" "SUCCESS"
2026-01-11T19:28:14.5319335Z                          } catch {
2026-01-11T19:28:14.5320007Z                              Write-Log "Error disabling mouse acceleration: $_" "ERROR"
2026-01-11T19:28:14.5320887Z                          }
2026-01-11T19:28:14.5320998Z                      }
2026-01-11T19:28:14.5322202Z                      
2026-01-11T19:28:14.5322713Z                      
2026-01-11T19:28:14.5323190Z                      function Set-BackgroundPollingUnlock {
2026-01-11T19:28:14.5324070Z                          <#
2026-01-11T19:28:14.5324889Z                          .SYNOPSIS
2026-01-11T19:28:14.5325794Z                              Unlocks full mouse polling rate in background windows.
2026-01-11T19:28:14.5326528Z                          .DESCRIPTION
2026-01-11T19:28:14.5327552Z                              FR33THY optimization - removes Windows throttling of mouse input
2026-01-11T19:28:14.5328154Z                              when windows are in background, improving alt-tab responsiveness.
2026-01-11T19:28:14.5329070Z                          .PARAMETER Enable
2026-01-11T19:28:14.5329438Z                              When true, unlocks background polling.
2026-01-11T19:28:14.5330698Z                          .OUTPUTS
2026-01-11T19:28:14.5331192Z                              None.
2026-01-11T19:28:14.5332271Z                          #>
2026-01-11T19:28:14.5332392Z                          param(
2026-01-11T19:28:14.5333665Z                              [bool]$Enable = $true
2026-01-11T19:28:14.5333948Z                          )
2026-01-11T19:28:14.5334856Z                      
2026-01-11T19:28:14.5335380Z                          if (-not $Enable) {
2026-01-11T19:28:14.5336895Z                              Write-Log "Background polling unlock: skipped" "INFO"
2026-01-11T19:28:14.5337000Z                              return
2026-01-11T19:28:14.5338059Z                          }
2026-01-11T19:28:14.5338244Z                      
2026-01-11T19:28:14.5338874Z                          try {
2026-01-11T19:28:14.5339775Z                              $mousePath = "HKCU:\Control Panel\Mouse"
2026-01-11T19:28:14.5340601Z                              Backup-RegistryKey -Path $mousePath
2026-01-11T19:28:14.5341286Z                      
2026-01-11T19:28:14.5342378Z                              # FR33THY: RawMouseThrottleEnabled=0 removes background mouse throttling
2026-01-11T19:28:14.5343766Z                              Set-RegistryValue -Path $mousePath -Name "RawMouseThrottleEnabled" -Value 0 -Type "DWORD"
2026-01-11T19:28:14.5343880Z                      
2026-01-11T19:28:14.5344411Z                              Write-Log "Background mouse polling unlocked (full rate in background windows)" "SUCCESS"
2026-01-11T19:28:14.5344565Z                          } catch {
2026-01-11T19:28:14.5345216Z                              Write-Log "Error unlocking background polling: $_" "ERROR"
2026-01-11T19:28:14.5345539Z                          }
2026-01-11T19:28:14.5346661Z                      }
2026-01-11T19:28:14.5346759Z                      
2026-01-11T19:28:14.5347806Z                      
2026-01-11T19:28:14.5348587Z                      function Set-KeyboardResponse {
2026-01-11T19:28:14.5349298Z                          <#
2026-01-11T19:28:14.5350308Z                          .SYNOPSIS
2026-01-11T19:28:14.5350641Z                              Maximizes keyboard response speed.
2026-01-11T19:28:14.5351904Z                          .DESCRIPTION
2026-01-11T19:28:14.5352233Z                              Sets keyboard repeat delay to minimum and repeat rate to maximum
2026-01-11T19:28:14.5352721Z                              for faster key response in games.
2026-01-11T19:28:14.5352847Z                          .PARAMETER Enable
2026-01-11T19:28:14.5354155Z                              When true, applies the keyboard response settings.
2026-01-11T19:28:14.5354279Z                          .OUTPUTS
2026-01-11T19:28:14.5355139Z                              None.
2026-01-11T19:28:14.5355896Z                          #>
2026-01-11T19:28:14.5356538Z                          param(
2026-01-11T19:28:14.5357392Z                              [bool]$Enable = $true
2026-01-11T19:28:14.5358176Z                          )
2026-01-11T19:28:14.5358924Z                      
2026-01-11T19:28:14.5360172Z                          if (-not $Enable) {
2026-01-11T19:28:14.5360836Z                              Write-Log "Keyboard response optimization: skipped" "INFO"
2026-01-11T19:28:14.5361100Z                              return
2026-01-11T19:28:14.5362114Z                          }
2026-01-11T19:28:14.5362232Z                      
2026-01-11T19:28:14.5363522Z                          try {
2026-01-11T19:28:14.5364438Z                              $keyboardPath = "HKCU:\Control Panel\Keyboard"
2026-01-11T19:28:14.5365081Z                              Backup-RegistryKey -Path $keyboardPath
2026-01-11T19:28:14.5365620Z                      
2026-01-11T19:28:14.5365908Z                              # KeyboardDelay: 0 = shortest delay (250ms), 3 = longest (1000ms)
2026-01-11T19:28:14.5367060Z                              # KeyboardSpeed: 0 = slowest, 31 = fastest repeat rate
2026-01-11T19:28:14.5367557Z                              Set-RegistryValue -Path $keyboardPath -Name "KeyboardDelay" -Value "0" -Type "String"
2026-01-11T19:28:14.5368084Z                              Set-RegistryValue -Path $keyboardPath -Name "KeyboardSpeed" -Value "31" -Type "String"
2026-01-11T19:28:14.5368374Z                      
2026-01-11T19:28:14.5369386Z                              Write-Log "Keyboard response maximized (fastest repeat)" "SUCCESS"
2026-01-11T19:28:14.5369686Z                          } catch {
2026-01-11T19:28:14.5370966Z                              Write-Log "Error setting keyboard response: $_" "ERROR"
2026-01-11T19:28:14.5371077Z                          }
2026-01-11T19:28:14.5372132Z                      }
2026-01-11T19:28:14.5372258Z                      
2026-01-11T19:28:14.5373544Z                      
2026-01-11T19:28:14.5373763Z                      function Disable-USBSelectiveSuspend {
2026-01-11T19:28:14.5374685Z                          <#
2026-01-11T19:28:14.5375486Z                          .SYNOPSIS
2026-01-11T19:28:14.5376573Z                              Disables USB selective suspend to prevent input device sleep.
2026-01-11T19:28:14.5377184Z                          .DESCRIPTION
2026-01-11T19:28:14.5377673Z                              Prevents Windows from putting USB devices to sleep, which can
2026-01-11T19:28:14.5378625Z                              cause input lag or disconnection issues with gaming peripherals.
2026-01-11T19:28:14.5378858Z                          .PARAMETER Enable
2026-01-11T19:28:14.5379314Z                              When true, disables USB selective suspend.
2026-01-11T19:28:14.5380215Z                          .OUTPUTS
2026-01-11T19:28:14.5380388Z                              None.
2026-01-11T19:28:14.5380488Z                          #>
2026-01-11T19:28:14.5381126Z                          param(
2026-01-11T19:28:14.5381896Z                              [bool]$Enable = $true
2026-01-11T19:28:14.5382897Z                          )
2026-01-11T19:28:14.5383009Z                      
2026-01-11T19:28:14.5384315Z                          if (-not $Enable) {
2026-01-11T19:28:14.5384914Z                              Write-Log "Disable USB selective suspend: skipped" "INFO"
2026-01-11T19:28:14.5385740Z                              return
2026-01-11T19:28:14.5386550Z                          }
2026-01-11T19:28:14.5386677Z                      
2026-01-11T19:28:14.5387988Z                          try {
2026-01-11T19:28:14.5388248Z                              # Disable via power scheme settings (all schemes)
2026-01-11T19:28:14.5389218Z                              $schemes = powercfg /list 2>&1 | Select-String "GUID" | ForEach-Object {
2026-01-11T19:28:14.5389892Z                                  if ($_ -match '([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})') {
2026-01-11T19:28:14.5390376Z                                      $matches[1]
2026-01-11T19:28:14.5391174Z                                  }
2026-01-11T19:28:14.5391660Z                              }
2026-01-11T19:28:14.5392895Z                      
2026-01-11T19:28:14.5393079Z                              foreach ($scheme in $schemes) {
2026-01-11T19:28:14.5393881Z                                  if ($scheme) {
2026-01-11T19:28:14.5394819Z                                      # USB selective suspend setting GUID
2026-01-11T19:28:14.5395357Z                                      powercfg /setacvalueindex $scheme 2a737441-1930-4402-8d77-b2bebba308a3 
2026-01-11T19:28:14.5396653Z                      48e6b7a6-50f5-4782-a5d4-53bb8f07e226 0 2>&1 | Out-Null
2026-01-11T19:28:14.5397918Z                                      powercfg /setdcvalueindex $scheme 2a737441-1930-4402-8d77-b2bebba308a3 
2026-01-11T19:28:14.5398169Z                      48e6b7a6-50f5-4782-a5d4-53bb8f07e226 0 2>&1 | Out-Null
2026-01-11T19:28:14.5399082Z                                  }
2026-01-11T19:28:14.5399995Z                              }
2026-01-11T19:28:14.5400094Z                      
2026-01-11T19:28:14.5401518Z                              # Also set via registry for USB hub power management
2026-01-11T19:28:14.5401995Z                              $usbPath = "HKLM:\SYSTEM\CurrentControlSet\Services\USB"
2026-01-11T19:28:14.5402937Z                              if (-not (Test-Path $usbPath)) {
2026-01-11T19:28:14.5403503Z                                  New-Item -Path $usbPath -Force | Out-Null
2026-01-11T19:28:14.5404123Z                              }
2026-01-11T19:28:14.5405370Z                              Backup-RegistryKey -Path $usbPath
2026-01-11T19:28:14.5405872Z                              Set-RegistryValue -Path $usbPath -Name "DisableSelectiveSuspend" -Value 1 -Type "DWORD"
2026-01-11T19:28:14.5406001Z                      
2026-01-11T19:28:14.5407463Z                              Write-Log "Disabled USB selective suspend (no input device sleep)" "SUCCESS"
2026-01-11T19:28:14.5407573Z                          } catch {
2026-01-11T19:28:14.5408610Z                              Write-Log "Error disabling USB selective suspend: $_" "ERROR"
2026-01-11T19:28:14.5408750Z                          }
2026-01-11T19:28:14.5409928Z                      }
2026-01-11T19:28:14.5410045Z                      
2026-01-11T19:28:14.5411058Z                      
2026-01-11T19:28:14.5411629Z                      function Set-AudioExclusiveMode {
2026-01-11T19:28:14.5412454Z                          <#
2026-01-11T19:28:14.5412933Z                          .SYNOPSIS
2026-01-11T19:28:14.5413993Z                              Configures audio for exclusive mode and lower latency.
2026-01-11T19:28:14.5414681Z                          .DESCRIPTION
2026-01-11T19:28:14.5416007Z                              Enables WASAPI exclusive mode hints and reduces audio buffer
2026-01-11T19:28:14.5416185Z                              for lower latency audio in competitive games.
2026-01-11T19:28:14.5417665Z                          .PARAMETER Enable
2026-01-11T19:28:14.5418598Z                              When true, applies exclusive mode-related settings.
2026-01-11T19:28:14.5419026Z                          .OUTPUTS
2026-01-11T19:28:14.5420013Z                              None.
2026-01-11T19:28:14.5420131Z                          #>
2026-01-11T19:28:14.5421310Z                          param(
2026-01-11T19:28:14.5421457Z                              [bool]$Enable = $true
2026-01-11T19:28:14.5422592Z                          )
2026-01-11T19:28:14.5422693Z                      
2026-01-11T19:28:14.5423578Z                          if (-not $Enable) {
2026-01-11T19:28:14.5424497Z                              Write-Log "Audio exclusive mode: skipped" "INFO"
2026-01-11T19:28:14.5425119Z                              return
2026-01-11T19:28:14.5426097Z                          }
2026-01-11T19:28:14.5426885Z                      
2026-01-11T19:28:14.5427536Z                          try {
2026-01-11T19:28:14.5428622Z                              # Get default audio endpoint
2026-01-11T19:28:14.5429092Z                              $audioPath = "HKCU:\Software\Microsoft\Multimedia\Audio"
2026-01-11T19:28:14.5430279Z                              if (-not (Test-Path $audioPath)) {
2026-01-11T19:28:14.5430560Z                                  New-Item -Path $audioPath -Force | Out-Null
2026-01-11T19:28:14.5431281Z                              }
2026-01-11T19:28:14.5432377Z                              Backup-RegistryKey -Path $audioPath
2026-01-11T19:28:14.5432792Z                      
2026-01-11T19:28:14.5433655Z                              # Enable exclusive mode application priority
2026-01-11T19:28:14.5434789Z                              Set-RegistryValue -Path $audioPath -Name "UserDuckingPreference" -Value 3 -Type "DWORD"
2026-01-11T19:28:14.5434922Z                      
2026-01-11T19:28:14.5436111Z                              # Reduce system sounds impact
2026-01-11T19:28:14.5436310Z                              $soundPath = "HKCU:\AppEvents\Schemes"
2026-01-11T19:28:14.5437736Z                              Backup-RegistryKey -Path $soundPath
2026-01-11T19:28:14.5438203Z                              Set-RegistryValue -Path $soundPath -Name "(Default)" -Value ".None" -Type "String"
2026-01-11T19:28:14.5438290Z                      
2026-01-11T19:28:14.5439097Z                              Write-Log "Audio configured for exclusive mode / lower latency" "SUCCESS"
2026-01-11T19:28:14.5440298Z                          } catch {
2026-01-11T19:28:14.5440568Z                              Write-Log "Error setting audio exclusive mode: $_" "ERROR"
2026-01-11T19:28:14.5440656Z                          }
2026-01-11T19:28:14.5441081Z                      }
2026-01-11T19:28:14.5442279Z                      
2026-01-11T19:28:14.5442390Z                      
2026-01-11T19:28:14.5443509Z                      function Invoke-SystemOptimizations {
2026-01-11T19:28:14.5443649Z                          <#
2026-01-11T19:28:14.5444682Z                          .SYNOPSIS
2026-01-11T19:28:14.5445525Z                              Applies system optimization bundle.
2026-01-11T19:28:14.5446160Z                          .DESCRIPTION
2026-01-11T19:28:14.5447422Z                              Runs page file tuning, fast startup changes, cleanup, service trimming,
2026-01-11T19:28:14.5447705Z                              UI tweaks, and device-related settings as configured.
2026-01-11T19:28:14.5448735Z                          .PARAMETER DisableMemoryCompression
2026-01-11T19:28:14.5448949Z                              Disables memory compression when true (opt-in).
2026-01-11T19:28:14.5449446Z                          .PARAMETER DisableExplorerAutoType
2026-01-11T19:28:14.5449715Z                              Disables Explorer auto folder type detection when true.
2026-01-11T19:28:14.5450850Z                          .PARAMETER RunDiskCleanup
2026-01-11T19:28:14.5451092Z                              Runs Disk Cleanup and DISM ResetBase when true.
2026-01-11T19:28:14.5452247Z                          .PARAMETER RunTempPurge
2026-01-11T19:28:14.5453512Z                              Purges temp folders when true.
2026-01-11T19:28:14.5455295Z                          .PARAMETER ServiceTrimSafe
2026-01-11T19:28:14.5455483Z                              Trims select services when true.
2026-01-11T19:28:14.5456473Z                          .PARAMETER BlockRazer
2026-01-11T19:28:14.5457040Z                              Blocks Razer/OEM auto-installs when true.
2026-01-11T19:28:14.5457783Z                          .PARAMETER ClassicContextMenu
2026-01-11T19:28:14.5458713Z                              Enables the classic Windows 11 context menu when true.
2026-01-11T19:28:14.5459881Z                          .PARAMETER DisableStorageSense
2026-01-11T19:28:14.5460081Z                              Disables Storage Sense when true.
2026-01-11T19:28:14.5461229Z                          .PARAMETER DisplayPerformance
2026-01-11T19:28:14.5461691Z                              Applies visual performance settings when true.
2026-01-11T19:28:14.5462315Z                          .PARAMETER TaskbarEndTask
2026-01-11T19:28:14.5462985Z                              Enables taskbar End Task option when true.
2026-01-11T19:28:14.5463507Z                          .PARAMETER RemoveExplorerClutter
2026-01-11T19:28:14.5464546Z                              Removes Explorer Home/Gallery entries when true.
2026-01-11T19:28:14.5465223Z                          .OUTPUTS
2026-01-11T19:28:14.5465339Z                              None.
2026-01-11T19:28:14.5465662Z                          #>
2026-01-11T19:28:14.5466789Z                          param(
2026-01-11T19:28:14.5467743Z                              [bool]$DisableMemoryCompression = $false,
2026-01-11T19:28:14.5468884Z                              [bool]$DisableExplorerAutoType = $true,
2026-01-11T19:28:14.5469067Z                              [bool]$RunDiskCleanup = $true,
2026-01-11T19:28:14.5470000Z                              [bool]$RunTempPurge = $true,
2026-01-11T19:28:14.5470381Z                              [bool]$ServiceTrimSafe = $true,
2026-01-11T19:28:14.5471234Z                              [bool]$BlockRazer = $true,
2026-01-11T19:28:14.5471752Z                              [bool]$ClassicContextMenu = $true,
2026-01-11T19:28:14.5472783Z                              [bool]$DisableStorageSense = $true,
2026-01-11T19:28:14.5473446Z                              [bool]$DisplayPerformance = $true,
2026-01-11T19:28:14.5473616Z                              [bool]$TaskbarEndTask = $true,
2026-01-11T19:28:14.5475209Z                              [bool]$RemoveExplorerClutter = $true
2026-01-11T19:28:14.5475300Z                          )
2026-01-11T19:28:14.5476445Z                      
2026-01-11T19:28:14.5476705Z                          Write-Log "Applying system optimizations..." "INFO"
2026-01-11T19:28:14.5477741Z                      
2026-01-11T19:28:14.5478151Z                          try {
2026-01-11T19:28:14.5479489Z                              Set-PageFile
2026-01-11T19:28:14.5479604Z                      
2026-01-11T19:28:14.5480626Z                              Disable-FastStartup
2026-01-11T19:28:14.5481094Z                      
2026-01-11T19:28:14.5482175Z                              Set-MemoryCompression -Disable $DisableMemoryCompression
2026-01-11T19:28:14.5482439Z                      
2026-01-11T19:28:14.5483451Z                              if ($DisableExplorerAutoType) {
2026-01-11T19:28:14.5483914Z                                  Disable-ExplorerAutoType
2026-01-11T19:28:14.5485188Z                              }
2026-01-11T19:28:14.5485494Z                      
2026-01-11T19:28:14.5486575Z                              if ($RunDiskCleanup) {
2026-01-11T19:28:14.5487435Z                                  Invoke-DiskCleanup -Async
2026-01-11T19:28:14.5487927Z                              }
2026-01-11T19:28:14.5488918Z                      
2026-01-11T19:28:14.5489776Z                              if ($RunTempPurge) {
2026-01-11T19:28:14.5490505Z                                  Invoke-TempPurge
2026-01-11T19:28:14.5491689Z                              }
2026-01-11T19:28:14.5491815Z                      
2026-01-11T19:28:14.5492811Z                              Set-ServiceTrimSafe -Enable $ServiceTrimSafe
2026-01-11T19:28:14.5493446Z                      
2026-01-11T19:28:14.5494699Z                              Disable-RazerAutoInstall -Enable $BlockRazer
2026-01-11T19:28:14.5494785Z                      
2026-01-11T19:28:14.5496414Z                              Set-ClassicContextMenu -Enable $ClassicContextMenu
2026-01-11T19:28:14.5496501Z                      
2026-01-11T19:28:14.5497503Z                              Disable-StorageSense -Enable $DisableStorageSense
2026-01-11T19:28:14.5497846Z                      
2026-01-11T19:28:14.5498873Z                              Set-DisplayPerformance -Enable $DisplayPerformance
2026-01-11T19:28:14.5499154Z                      
2026-01-11T19:28:14.5500013Z                              Enable-TaskbarEndTask -Enable $TaskbarEndTask
2026-01-11T19:28:14.5501116Z                      
2026-01-11T19:28:14.5502371Z                              Remove-ExplorerClutter -Enable $RemoveExplorerClutter
2026-01-11T19:28:14.5502543Z                      
2026-01-11T19:28:14.5503135Z                              Write-Log "System optimizations complete" "SUCCESS"
2026-01-11T19:28:14.5504110Z                      
2026-01-11T19:28:14.5504243Z                          } catch {
2026-01-11T19:28:14.5505472Z                              Write-Log "Error applying system optimizations: $_" "ERROR"
2026-01-11T19:28:14.5505603Z                              throw
2026-01-11T19:28:14.5506762Z                          }
2026-01-11T19:28:14.5506869Z                      }
2026-01-11T19:28:14.5507899Z                      
2026-01-11T19:28:14.5508218Z                      
2026-01-11T19:28:14.5508969Z                      function Undo-SystemOptimizations {
2026-01-11T19:28:14.5509917Z                          <#
2026-01-11T19:28:14.5510043Z                          .SYNOPSIS
2026-01-11T19:28:14.5511275Z                              Reverts system optimizations where possible.
2026-01-11T19:28:14.5511543Z                          .DESCRIPTION
2026-01-11T19:28:14.5512107Z                              Restores page file management, fast startup registry state, and other
2026-01-11T19:28:14.5512573Z                              backed up settings. Some changes still require reboot.
2026-01-11T19:28:14.5513476Z                          .OUTPUTS
2026-01-11T19:28:14.5513953Z                              None.
2026-01-11T19:28:14.5514546Z                          #>
2026-01-11T19:28:14.5515818Z                          Write-Log "Rolling back system optimizations..." "INFO"
2026-01-11T19:28:14.5516125Z                      
2026-01-11T19:28:14.5517074Z                          try {
2026-01-11T19:28:14.5517531Z                              $ComputerSystem = Get-WmiObject Win32_ComputerSystem -EnableAllPrivileges
2026-01-11T19:28:14.5518095Z                              if (-not $ComputerSystem.AutomaticManagedPagefile) {
2026-01-11T19:28:14.5519307Z                                  $ComputerSystem.AutomaticManagedPagefile = $true
2026-01-11T19:28:14.5519488Z                                  $ComputerSystem.Put() | Out-Null
2026-01-11T19:28:14.5520803Z                                  Write-Log "Restored automatic page file management" "SUCCESS"
2026-01-11T19:28:14.5520909Z                              }
2026-01-11T19:28:14.5521606Z                      
2026-01-11T19:28:14.5522798Z                              $PageFile = Get-WmiObject -Query "Select * From Win32_PageFileSetting Where 
2026-01-11T19:28:14.5523022Z                      Name='C:\\pagefile.sys'"
2026-01-11T19:28:14.5523479Z                              if ($PageFile) {
2026-01-11T19:28:14.5524311Z                                  $PageFile.Delete()
2026-01-11T19:28:14.5525241Z                                  Write-Log "Removed custom page file settings" "SUCCESS"
2026-01-11T19:28:14.5526135Z                              }
2026-01-11T19:28:14.5526244Z                      
2026-01-11T19:28:14.5527654Z                              $regPath = "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Power"
2026-01-11T19:28:14.5527803Z                              if (Restore-RegistryKey -Path $regPath) {
2026-01-11T19:28:14.5529200Z                                  Write-Log "Restored Fast Startup registry settings" "SUCCESS"
2026-01-11T19:28:14.5529317Z                              } else {
2026-01-11T19:28:14.5530113Z                                  Set-RegistryValue -Path $regPath -Name "HiberbootEnabled" -Value 1 -Type "DWORD"
2026-01-11T19:28:14.5530540Z                                  Write-Log "Re-enabled Fast Startup" "SUCCESS"
2026-01-11T19:28:14.5531592Z                              }
2026-01-11T19:28:14.5531694Z                      
2026-01-11T19:28:14.5533281Z                              $shellPath = "HKCU:\Software\Classes\Local 
2026-01-11T19:28:14.5533723Z                      Settings\Software\Microsoft\Windows\Shell\Bags\AllFolders\Shell"
2026-01-11T19:28:14.5534218Z                              Restore-RegistryKey -Path $shellPath | Out-Null
2026-01-11T19:28:14.5535513Z                      
2026-01-11T19:28:14.5536194Z                              Enable-MMAgent -MemoryCompression -ErrorAction SilentlyContinue
2026-01-11T19:28:14.5536802Z                              Write-Log "Re-enabled memory compression" "SUCCESS"
2026-01-11T19:28:14.5536976Z                      
2026-01-11T19:28:14.5537913Z                              Write-Log "System optimization rollback complete (restart required)" "SUCCESS"
2026-01-11T19:28:14.5538031Z                      
2026-01-11T19:28:14.5539173Z                          } catch {
2026-01-11T19:28:14.5539409Z                              Write-Log "Error during rollback: $_" "ERROR"
2026-01-11T19:28:14.5539788Z                              throw
2026-01-11T19:28:14.5540197Z                          }
2026-01-11T19:28:14.5541305Z                      }
2026-01-11T19:28:14.5541404Z                      
2026-01-11T19:28:14.5542468Z                      
2026-01-11T19:28:14.5542666Z                      Export-ModuleMember -Function @(
2026-01-11T19:28:14.5543834Z                          'Get-SystemRAM',
2026-01-11T19:28:14.5544129Z                          'Set-PageFile',
2026-01-11T19:28:14.5545283Z                          'Set-MemoryCompression',
2026-01-11T19:28:14.5545677Z                          'Disable-FastStartup',
2026-01-11T19:28:14.5547015Z                          'Disable-ExplorerAutoType',
2026-01-11T19:28:14.5547178Z                          'Invoke-DiskCleanup',
2026-01-11T19:28:14.5548113Z                          'Invoke-TempPurge',
2026-01-11T19:28:14.5548277Z                          'Set-ServiceTrimSafe',
2026-01-11T19:28:14.5549247Z                          'Disable-RazerAutoInstall',
2026-01-11T19:28:14.5549696Z                          'New-RestorePoint',
2026-01-11T19:28:14.5550905Z                          'Set-ClassicContextMenu',
2026-01-11T19:28:14.5551060Z                          'Disable-StorageSense',
2026-01-11T19:28:14.5551727Z                          'Set-DisplayPerformance',
2026-01-11T19:28:14.5552081Z                          'Enable-TaskbarEndTask',
2026-01-11T19:28:14.5553160Z                          'Remove-ExplorerClutter',
2026-01-11T19:28:14.5553672Z                          'Disable-MouseAcceleration',
2026-01-11T19:28:14.5554637Z                          'Set-BackgroundPollingUnlock',
2026-01-11T19:28:14.5555003Z                          'Set-KeyboardResponse',
2026-01-11T19:28:14.5556334Z                          'Disable-USBSelectiveSuspend',
2026-01-11T19:28:14.5556530Z                          'Set-AudioExclusiveMode',
2026-01-11T19:28:14.5557758Z                          'Test-SystemOptimizations',
2026-01-11T19:28:14.5557931Z                          'Invoke-SystemOptimizations',
2026-01-11T19:28:14.5559220Z                          'Undo-SystemOptimizations'
2026-01-11T19:28:14.5559325Z                      )
2026-01-11T19:28:14.5560086Z                      
2026-01-11T19:28:14.5560869Z [32;1mParent             : [0m
2026-01-11T19:28:14.5561036Z 
2026-01-11T19:28:14.5586954Z [32;1mAttributes         : [0m{}
2026-01-11T19:28:14.5587191Z [32;1mUsingStatements    : [0m{}
2026-01-11T19:28:14.5587428Z [32;1mParamBlock         : [0m
2026-01-11T19:28:14.5588403Z [32;1mBeginBlock         : [0m
2026-01-11T19:28:14.5588778Z [32;1mProcessBlock       : [0m
2026-01-11T19:28:14.5591376Z [32;1mEndBlock           : [0mImport-Module (Join-Path $PSScriptRoot "..\core\logger.psm1") -Force -Global
2026-01-11T19:28:14.5591450Z                      
2026-01-11T19:28:14.5592421Z                      
2026-01-11T19:28:14.5593429Z                      
2026-01-11T19:28:14.5594138Z                      function Test-WingetAvailable {
2026-01-11T19:28:14.5595165Z                          <#
2026-01-11T19:28:14.5595725Z                          .SYNOPSIS
2026-01-11T19:28:14.5596988Z                              Checks whether winget is available.
2026-01-11T19:28:14.5597164Z                          .DESCRIPTION
2026-01-11T19:28:14.5598467Z                              Invokes winget --version and returns success based on exit code.
2026-01-11T19:28:14.5598598Z                          .OUTPUTS
2026-01-11T19:28:14.5599756Z                              [bool] True if winget is callable.
2026-01-11T19:28:14.5599898Z                          #>
2026-01-11T19:28:14.5600751Z                          try {
2026-01-11T19:28:14.5601745Z                              $null = winget --version 2>&1
2026-01-11T19:28:14.5602236Z                              return ($LASTEXITCODE -eq 0)
2026-01-11T19:28:14.5603027Z                          } catch {
2026-01-11T19:28:14.5603801Z                              return $false
2026-01-11T19:28:14.5604767Z                          }
2026-01-11T19:28:14.5605668Z                      }
2026-01-11T19:28:14.5605778Z                      
2026-01-11T19:28:14.5606844Z                      
2026-01-11T19:28:14.5607032Z                      function Install-Winget {
2026-01-11T19:28:14.5607989Z                          <#
2026-01-11T19:28:14.5608908Z                          .SYNOPSIS
2026-01-11T19:28:14.5609385Z                              Attempts to install winget if missing.
2026-01-11T19:28:14.5610362Z                          .DESCRIPTION
2026-01-11T19:28:14.5610740Z                              First attempts to open the Microsoft Store App Installer page, then
2026-01-11T19:28:14.5612129Z                              falls back to downloading the App Installer bundle directly.
2026-01-11T19:28:14.5612255Z                          .OUTPUTS
2026-01-11T19:28:14.5614224Z                              [bool] True if winget is already installed; otherwise false to indicate
2026-01-11T19:28:14.5614405Z                              a restart/install is required.
2026-01-11T19:28:14.5614796Z                          #>
2026-01-11T19:28:14.5615954Z                          Write-Log "Checking for winget..." "INFO"
2026-01-11T19:28:14.5617018Z                      
2026-01-11T19:28:14.5617298Z                          if (Test-WingetAvailable) {
2026-01-11T19:28:14.5617989Z                              $wingetVersion = winget --version 2>&1
2026-01-11T19:28:14.5619575Z                              Write-Log "winget is available: $wingetVersion" "SUCCESS"
2026-01-11T19:28:14.5619749Z                              return $true
2026-01-11T19:28:14.5620066Z                          }
2026-01-11T19:28:14.5621025Z                      
2026-01-11T19:28:14.5622424Z                          Write-Log "winget not found. Attempting to install..." "INFO"
2026-01-11T19:28:14.5622574Z                      
2026-01-11T19:28:14.5623074Z                          Write-Log "Method 1: Installing via Microsoft Store..." "INFO"
2026-01-11T19:28:14.5623316Z                          try {
2026-01-11T19:28:14.5624964Z                              $storeApp = Get-AppxPackage -Name "Microsoft.WindowsStore" -ErrorAction SilentlyContinue
2026-01-11T19:28:14.5625277Z                              if ($storeApp) {
2026-01-11T19:28:14.5626347Z                                  Write-Log "Microsoft Store found, opening App Installer page..." "INFO"
2026-01-11T19:28:14.5627281Z                                  Start-Process "ms-windows-store://pdp/?ProductId=9NBLGGH4NNS1" -ErrorAction 
2026-01-11T19:28:14.5627502Z                      SilentlyContinue
2026-01-11T19:28:14.5629122Z                                  Write-Log "Please install 'App Installer' from Microsoft Store, then restart script" 
2026-01-11T19:28:14.5629439Z                      "ERROR"
2026-01-11T19:28:14.5629615Z                                  return $false
2026-01-11T19:28:14.5630278Z                              } else {
2026-01-11T19:28:14.5632581Z                                  Write-Log "Microsoft Store not available (common on X-Lite builds)" "ERROR"
2026-01-11T19:28:14.5632733Z                              }
2026-01-11T19:28:14.5633276Z                          } catch {
2026-01-11T19:28:14.5633546Z                              Write-Log "Could not open Microsoft Store: $_" "ERROR"
2026-01-11T19:28:14.5633641Z                          }
2026-01-11T19:28:14.5634924Z                      
2026-01-11T19:28:14.5635255Z                          Write-Log "Method 2: Downloading App Installer directly..." "INFO"
2026-01-11T19:28:14.5636442Z                          try {
2026-01-11T19:28:14.5637304Z                              $appInstallerUrl = "https://aka.ms/getwinget"
2026-01-11T19:28:14.5637701Z                              $downloadPath = "$env:TEMP\Microsoft.DesktopAppInstaller.msixbundle"
2026-01-11T19:28:14.5638655Z                      
2026-01-11T19:28:14.5639053Z                              Write-Log "Downloading App Installer from Microsoft..." "INFO"
2026-01-11T19:28:14.5640487Z                              Invoke-WebRequest -Uri $appInstallerUrl -OutFile $downloadPath -UseBasicParsing 
2026-01-11T19:28:14.5640654Z                      -ErrorAction Stop
2026-01-11T19:28:14.5641563Z                      
2026-01-11T19:28:14.5641966Z                              Write-Log "Installing App Installer..." "INFO"
2026-01-11T19:28:14.5642693Z                              Add-AppxPackage -Path $downloadPath -ErrorAction Stop
2026-01-11T19:28:14.5643102Z                      
2026-01-11T19:28:14.5644310Z                              Remove-Item $downloadPath -ErrorAction SilentlyContinue
2026-01-11T19:28:14.5644403Z                      
2026-01-11T19:28:14.5644900Z                              Write-Log "App Installer installed successfully. Please restart PowerShell." "SUCCESS"
2026-01-11T19:28:14.5645718Z                              return $false
2026-01-11T19:28:14.5646384Z                      
2026-01-11T19:28:14.5647208Z                          } catch {
2026-01-11T19:28:14.5648456Z                              Write-Log "Failed to download/install App Installer: $_" "ERROR"
2026-01-11T19:28:14.5648778Z                              Write-Log "Install manually from: https://aka.ms/getwinget" "ERROR"
2026-01-11T19:28:14.5649678Z                              return $false
2026-01-11T19:28:14.5650007Z                          }
2026-01-11T19:28:14.5650391Z                      }
2026-01-11T19:28:14.5651374Z                      
2026-01-11T19:28:14.5652155Z                      
2026-01-11T19:28:14.5652330Z                      
2026-01-11T19:28:14.5653784Z                      
2026-01-11T19:28:14.5654260Z                      function Get-SoftwareCatalog {
2026-01-11T19:28:14.5654366Z                          <#
2026-01-11T19:28:14.5655528Z                          .SYNOPSIS
2026-01-11T19:28:14.5655717Z                              Loads the software catalog JSON.
2026-01-11T19:28:14.5656981Z                          .DESCRIPTION
2026-01-11T19:28:14.5657322Z                              Reads the catalog from the web folder and returns it as a PSCustomObject.
2026-01-11T19:28:14.5658482Z                          .OUTPUTS
2026-01-11T19:28:14.5658744Z                              [PSCustomObject] Catalog data or $null on failure.
2026-01-11T19:28:14.5659217Z                          #>
2026-01-11T19:28:14.5660105Z                          try {
2026-01-11T19:28:14.5660728Z                              $catalogPath = Join-Path $PSScriptRoot "..\..\data\software-catalog.json"
2026-01-11T19:28:14.5661862Z                      
2026-01-11T19:28:14.5662078Z                              if (-not (Test-Path $catalogPath)) {
2026-01-11T19:28:14.5663142Z                                  Write-Log "Software catalog not found: $catalogPath" "ERROR"
2026-01-11T19:28:14.5663626Z                                  return $null
2026-01-11T19:28:14.5664570Z                              }
2026-01-11T19:28:14.5664677Z                      
2026-01-11T19:28:14.5666964Z                              $catalog = Get-Content $catalogPath -Raw | ConvertFrom-Json
2026-01-11T19:28:14.5667434Z                              Write-Log "Loaded software catalog (version $($catalog.version))" "SUCCESS"
2026-01-11T19:28:14.5667574Z                      
2026-01-11T19:28:14.5667715Z                              return $catalog
2026-01-11T19:28:14.5668172Z                          } catch {
2026-01-11T19:28:14.5669566Z                              Write-Log "Error loading software catalog: $_" "ERROR"
2026-01-11T19:28:14.5669691Z                              return $null
2026-01-11T19:28:14.5670365Z                          }
2026-01-11T19:28:14.5671291Z                      }
2026-01-11T19:28:14.5672223Z                      
2026-01-11T19:28:14.5672349Z                      
2026-01-11T19:28:14.5673314Z                      
2026-01-11T19:28:14.5673484Z                      
2026-01-11T19:28:14.5674942Z                      function Test-HardwarePeripherals {
2026-01-11T19:28:14.5675076Z                          <#
2026-01-11T19:28:14.5675190Z                          .SYNOPSIS
2026-01-11T19:28:14.5676344Z                              Detects connected gaming peripherals by vendor ID.
2026-01-11T19:28:14.5676637Z                          .DESCRIPTION
2026-01-11T19:28:14.5677893Z                              Scans HID/USB devices for known VID values and returns vendor names.
2026-01-11T19:28:14.5678201Z                          .OUTPUTS
2026-01-11T19:28:14.5678970Z                              [string[]] Detected vendor names.
2026-01-11T19:28:14.5679759Z                          #>
2026-01-11T19:28:14.5680314Z                          try {
2026-01-11T19:28:14.5680719Z                              Write-Log "Detecting gaming peripheral hardware..." "INFO"
2026-01-11T19:28:14.5681094Z                      
2026-01-11T19:28:14.5682463Z                              $usbDevices = Get-PnpDevice -Class "HIDClass", "USB" -ErrorAction SilentlyContinue |
2026-01-11T19:28:14.5682739Z                                  Where-Object { $_.InstanceId -match "USB\\VID_" }
2026-01-11T19:28:14.5683754Z                      
2026-01-11T19:28:14.5683915Z                              $detectedVendors = @()
2026-01-11T19:28:14.5684562Z                      
2026-01-11T19:28:14.5685442Z                              foreach ($device in $usbDevices) {
2026-01-11T19:28:14.5686328Z                                  if ($device.InstanceId -match "VID_([0-9A-F]{4})") {
2026-01-11T19:28:14.5687202Z                                      $vid = $matches[1]
2026-01-11T19:28:14.5687313Z                      
2026-01-11T19:28:14.5688530Z                                      switch ($vid) {
2026-01-11T19:28:14.5688685Z                                          "046D" {
2026-01-11T19:28:14.5690019Z                                              if ($detectedVendors -notcontains "Logitech") {
2026-01-11T19:28:14.5690563Z                                                  $detectedVendors += "Logitech"
2026-01-11T19:28:14.5691862Z                                                  Write-Log "Detected Logitech peripheral: $($device.FriendlyName)" 
2026-01-11T19:28:14.5692095Z                      "SUCCESS"
2026-01-11T19:28:14.5692756Z                                              }
2026-01-11T19:28:14.5693654Z                                          }
2026-01-11T19:28:14.5693933Z                                          "1532" {
2026-01-11T19:28:14.5695502Z                                              if ($detectedVendors -notcontains "Razer") {
2026-01-11T19:28:14.5695700Z                                                  $detectedVendors += "Razer"
2026-01-11T19:28:14.5696956Z                                                  Write-Log "Detected Razer peripheral: $($device.FriendlyName)" 
2026-01-11T19:28:14.5697091Z                      "SUCCESS"
2026-01-11T19:28:14.5698537Z                                              }
2026-01-11T19:28:14.5699300Z                                          }
2026-01-11T19:28:14.5700123Z                                          "1B1C" {
2026-01-11T19:28:14.5701719Z                                              if ($detectedVendors -notcontains "Corsair") {
2026-01-11T19:28:14.5701883Z                                                  $detectedVendors += "Corsair"
2026-01-11T19:28:14.5702370Z                                                  Write-Log "Detected Corsair peripheral: $($device.FriendlyName)" 
2026-01-11T19:28:14.5703374Z                      "SUCCESS"
2026-01-11T19:28:14.5703512Z                                              }
2026-01-11T19:28:14.5704340Z                                          }
2026-01-11T19:28:14.5705156Z                                      }
2026-01-11T19:28:14.5706319Z                                  }
2026-01-11T19:28:14.5706646Z                              }
2026-01-11T19:28:14.5707488Z                      
2026-01-11T19:28:14.5708788Z                              if ($detectedVendors.Count -eq 0) {
2026-01-11T19:28:14.5709056Z                                  Write-Log "No gaming peripherals detected" "INFO"
2026-01-11T19:28:14.5709871Z                              }
2026-01-11T19:28:14.5710077Z                      
2026-01-11T19:28:14.5711329Z                              return $detectedVendors
2026-01-11T19:28:14.5711608Z                          } catch {
2026-01-11T19:28:14.5712999Z                              Write-Log "Error detecting hardware peripherals: $_" "ERROR"
2026-01-11T19:28:14.5713115Z                              return @()
2026-01-11T19:28:14.5713483Z                          }
2026-01-11T19:28:14.5714123Z                      }
2026-01-11T19:28:14.5715235Z                      
2026-01-11T19:28:14.5715437Z                      
2026-01-11T19:28:14.5716481Z                      
2026-01-11T19:28:14.5717315Z                      
2026-01-11T19:28:14.5718486Z                      function Install-PackageFromCatalog {
2026-01-11T19:28:14.5718595Z                          <#
2026-01-11T19:28:14.5719622Z                          .SYNOPSIS
2026-01-11T19:28:14.5720847Z                              Installs a single package from the catalog using winget.
2026-01-11T19:28:14.5720971Z                          .DESCRIPTION
2026-01-11T19:28:14.5721544Z                              Runs winget install for the given package id, then verifies install
2026-01-11T19:28:14.5721931Z                              status when winget returns a non-zero exit code.
2026-01-11T19:28:14.5723011Z                          .PARAMETER Package
2026-01-11T19:28:14.5723830Z                              Package object from the catalog.
2026-01-11T19:28:14.5724320Z                          .PARAMETER PackageName
2026-01-11T19:28:14.5725259Z                              Catalog key name used for logging.
2026-01-11T19:28:14.5726261Z                          .OUTPUTS
2026-01-11T19:28:14.5726778Z                              [bool] True if installed or already present, else false.
2026-01-11T19:28:14.5727472Z                          #>
2026-01-11T19:28:14.5728238Z                          param(
2026-01-11T19:28:14.5729096Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:14.5729872Z                              [PSCustomObject]$Package,
2026-01-11T19:28:14.5730594Z                      
2026-01-11T19:28:14.5731558Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:14.5732370Z                              [string]$PackageName
2026-01-11T19:28:14.5732855Z                          )
2026-01-11T19:28:14.5733791Z                      
2026-01-11T19:28:14.5734924Z                          try {
2026-01-11T19:28:14.5735457Z                              Write-Log "Installing $($Package.name)..." "INFO"
2026-01-11T19:28:14.5736080Z                      
2026-01-11T19:28:14.5737547Z                              $result = winget install --id $Package.id --source winget --accept-package-agreements 
2026-01-11T19:28:14.5737693Z                      --accept-source-agreements --silent 2>&1
2026-01-11T19:28:14.5738883Z                      
2026-01-11T19:28:14.5739076Z                              if ($LASTEXITCODE -eq 0) {
2026-01-11T19:28:14.5740200Z                                  Write-Log "Installed: $($Package.name)" "SUCCESS"
2026-01-11T19:28:14.5740387Z                                  return $true
2026-01-11T19:28:14.5741021Z                              } else {
2026-01-11T19:28:14.5742069Z                                  $installedCheck = winget list --id $Package.id --source winget 
2026-01-11T19:28:14.5742469Z                      --accept-source-agreements 2>&1
2026-01-11T19:28:14.5743389Z                                  if ($LASTEXITCODE -eq 0 -and $installedCheck -match $Package.id) {
2026-01-11T19:28:14.5743939Z                                      Write-Log "Already installed: $($Package.name)" "SUCCESS"
2026-01-11T19:28:14.5744237Z                                      return $true
2026-01-11T19:28:14.5745124Z                                  } else {
2026-01-11T19:28:14.5745954Z                                      Write-Log "Failed to install $($Package.name) (exit code: $LASTEXITCODE)" "ERROR"
2026-01-11T19:28:14.5746321Z                                      return $false
2026-01-11T19:28:14.5747119Z                                  }
2026-01-11T19:28:14.5747539Z                              }
2026-01-11T19:28:14.5748750Z                          } catch {
2026-01-11T19:28:14.5749082Z                              Write-Log "Error installing $($Package.name): $_" "ERROR"
2026-01-11T19:28:14.5749887Z                              return $false
2026-01-11T19:28:14.5750662Z                          }
2026-01-11T19:28:14.5751755Z                      }
2026-01-11T19:28:14.5751873Z                      
2026-01-11T19:28:14.5752873Z                      
2026-01-11T19:28:14.5753610Z                      function Install-PeripheralSoftware {
2026-01-11T19:28:14.5754830Z                          <#
2026-01-11T19:28:14.5755149Z                          .SYNOPSIS
2026-01-11T19:28:14.5756533Z                              Installs peripheral software based on detected hardware.
2026-01-11T19:28:14.5756665Z                          .DESCRIPTION
2026-01-11T19:28:14.5757992Z                              Compares detected vendor names to the catalog's hardware vendor map
2026-01-11T19:28:14.5758218Z                              and installs matching peripheral packages.
2026-01-11T19:28:14.5758600Z                          .PARAMETER Catalog
2026-01-11T19:28:14.5759404Z                              Catalog object containing package definitions.
2026-01-11T19:28:14.5760440Z                          .PARAMETER DetectedVendors
2026-01-11T19:28:14.5760769Z                              List of detected vendor names.
2026-01-11T19:28:14.5761794Z                          .OUTPUTS
2026-01-11T19:28:14.5762622Z                              [int] Count of installed packages.
2026-01-11T19:28:14.5763619Z                          #>
2026-01-11T19:28:14.5764493Z                          param(
2026-01-11T19:28:14.5764699Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:14.5766148Z                              [PSCustomObject]$Catalog,
2026-01-11T19:28:14.5766262Z                      
2026-01-11T19:28:14.5767354Z                              [string[]]$DetectedVendors
2026-01-11T19:28:14.5767592Z                          )
2026-01-11T19:28:14.5768764Z                      
2026-01-11T19:28:14.5769554Z                          $installed = 0
2026-01-11T19:28:14.5770160Z                      
2026-01-11T19:28:14.5771193Z                          try {
2026-01-11T19:28:14.5772719Z                              $peripheralPackages = $Catalog.packages.PSObject.Properties |
2026-01-11T19:28:14.5773231Z                                  Where-Object { $_.Value.category -eq "peripheral" }
2026-01-11T19:28:14.5773541Z                      
2026-01-11T19:28:14.5774660Z                              foreach ($pkg in $peripheralPackages) {
2026-01-11T19:28:14.5775560Z                                  $package = $pkg.Value
2026-01-11T19:28:14.5776355Z                                  $packageName = $pkg.Name
2026-01-11T19:28:14.5776859Z                      
2026-01-11T19:28:14.5777955Z                                  $shouldInstall = $false
2026-01-11T19:28:14.5778260Z                                  foreach ($vendorId in $package.hardware_detection.vendor_ids) {
2026-01-11T19:28:14.5779119Z                                      $vendorName = $Catalog.hardware_vendor_ids.$vendorId
2026-01-11T19:28:14.5779352Z                                      if ($DetectedVendors -contains $vendorName) {
2026-01-11T19:28:14.5780073Z                                          $shouldInstall = $true
2026-01-11T19:28:14.5785046Z                                          break
2026-01-11T19:28:14.5785694Z                                      }
2026-01-11T19:28:14.5786562Z                                  }
2026-01-11T19:28:14.5787541Z                      
2026-01-11T19:28:14.5787732Z                                  if ($shouldInstall) {
2026-01-11T19:28:14.5788953Z                                      if (Install-PackageFromCatalog -Package $package -PackageName $packageName) {
2026-01-11T19:28:14.5789287Z                                          $installed++
2026-01-11T19:28:14.5790216Z                                      }
2026-01-11T19:28:14.5790473Z                                  } else {
2026-01-11T19:28:14.5790965Z                                      Write-Log "Skipping $($package.name) (hardware not detected)" "INFO"
2026-01-11T19:28:14.5791996Z                                  }
2026-01-11T19:28:14.5792135Z                              }
2026-01-11T19:28:14.5793305Z                      
2026-01-11T19:28:14.5793739Z                          } catch {
2026-01-11T19:28:14.5794946Z                              Write-Log "Error installing peripheral software: $_" "ERROR"
2026-01-11T19:28:14.5795261Z                          }
2026-01-11T19:28:14.5796192Z                      
2026-01-11T19:28:14.5796326Z                          return $installed
2026-01-11T19:28:14.5797675Z                      }
2026-01-11T19:28:14.5797806Z                      
2026-01-11T19:28:14.5798597Z                      
2026-01-11T19:28:14.5799054Z                      
2026-01-11T19:28:14.5800086Z                      
2026-01-11T19:28:14.5800317Z                      function Invoke-SoftwareInstallation {
2026-01-11T19:28:14.5801065Z                          <#
2026-01-11T19:28:14.5801611Z                          .SYNOPSIS
2026-01-11T19:28:14.5802658Z                              Installs software packages by category.
2026-01-11T19:28:14.5803439Z                          .DESCRIPTION
2026-01-11T19:28:14.5804164Z                              Ensures winget is available, loads the catalog, installs packages in
2026-01-11T19:28:14.5804555Z                              the requested categories, and optionally includes optional/peripheral
2026-01-11T19:28:14.5804680Z                              packages.
2026-01-11T19:28:14.5804868Z                          .PARAMETER Categories
2026-01-11T19:28:14.5806368Z                              List of catalog categories to install (default: essential, recommended, keep).
2026-01-11T19:28:14.5806537Z                          .PARAMETER IncludeOptional
2026-01-11T19:28:14.5807543Z                              When true, also installs optional category packages.
2026-01-11T19:28:14.5807705Z                          .PARAMETER IncludePeripherals
2026-01-11T19:28:14.5808560Z                              When true, installs peripheral packages based on hardware detection.
2026-01-11T19:28:14.5809527Z                          .OUTPUTS
2026-01-11T19:28:14.5809637Z                              None.
2026-01-11T19:28:14.5810746Z                          #>
2026-01-11T19:28:14.5810876Z                          param(
2026-01-11T19:28:14.5812222Z                              [string[]]$Categories = @("essential", "recommended", "keep"),
2026-01-11T19:28:14.5813569Z                              [bool]$IncludeOptional = $false,
2026-01-11T19:28:14.5813957Z                              [bool]$IncludePeripherals = $true
2026-01-11T19:28:14.5814927Z                          )
2026-01-11T19:28:14.5815570Z                      
2026-01-11T19:28:14.5816686Z                          Write-Log "Starting software installation..." "INFO"
2026-01-11T19:28:14.5816800Z                      
2026-01-11T19:28:14.5818017Z                          if (-not (Test-WingetAvailable)) {
2026-01-11T19:28:14.5818312Z                              Write-Log "winget not available. Attempting to install..." "INFO"
2026-01-11T19:28:14.5819381Z                              if (-not (Install-Winget)) {
2026-01-11T19:28:14.5820050Z                                  Write-Log "winget installation failed. Skipping software installation." "ERROR"
2026-01-11T19:28:14.5820202Z                                  return
2026-01-11T19:28:14.5821016Z                              }
2026-01-11T19:28:14.5821128Z                          }
2026-01-11T19:28:14.5822340Z                      
2026-01-11T19:28:14.5822835Z                          $catalog = Get-SoftwareCatalog
2026-01-11T19:28:14.5823384Z                          if (-not $catalog) {
2026-01-11T19:28:14.5824766Z                              Write-Log "Could not load software catalog. Skipping software installation." "ERROR"
2026-01-11T19:28:14.5824975Z                              return
2026-01-11T19:28:14.5826117Z                          }
2026-01-11T19:28:14.5826249Z                      
2026-01-11T19:28:14.5827122Z                          $installed = 0
2026-01-11T19:28:14.5827967Z                          $failed = 0
2026-01-11T19:28:14.5828138Z                      
2026-01-11T19:28:14.5829416Z                          try {
2026-01-11T19:28:14.5830075Z                              $packagesToInstall = $catalog.packages.PSObject.Properties |
2026-01-11T19:28:14.5831093Z                                  Where-Object { $Categories -contains $_.Value.category }
2026-01-11T19:28:14.5831221Z                      
2026-01-11T19:28:14.5832279Z                              foreach ($pkg in $packagesToInstall) {
2026-01-11T19:28:14.5832670Z                                  $package = $pkg.Value
2026-01-11T19:28:14.5833961Z                                  $packageName = $pkg.Name
2026-01-11T19:28:14.5834071Z                      
2026-01-11T19:28:14.5835376Z                                  if (Install-PackageFromCatalog -Package $package -PackageName $packageName) {
2026-01-11T19:28:14.5835493Z                                      $installed++
2026-01-11T19:28:14.5836105Z                                  } else {
2026-01-11T19:28:14.5836824Z                                      $failed++
2026-01-11T19:28:14.5837112Z                                  }
2026-01-11T19:28:14.5837719Z                              }
2026-01-11T19:28:14.5838005Z                      
2026-01-11T19:28:14.5838845Z                              if ($IncludeOptional) {
2026-01-11T19:28:14.5839566Z                                  $optionalPackages = $catalog.packages.PSObject.Properties |
2026-01-11T19:28:14.5839812Z                                      Where-Object { $_.Value.category -eq "optional" }
2026-01-11T19:28:14.5839960Z                      
2026-01-11T19:28:14.5840939Z                                  foreach ($pkg in $optionalPackages) {
2026-01-11T19:28:14.5841581Z                                      $package = $pkg.Value
2026-01-11T19:28:14.5841969Z                                      $packageName = $pkg.Name
2026-01-11T19:28:14.5842780Z                      
2026-01-11T19:28:14.5843270Z                                      if (Install-PackageFromCatalog -Package $package -PackageName $packageName) {
2026-01-11T19:28:14.5843453Z                                          $installed++
2026-01-11T19:28:14.5843991Z                                      } else {
2026-01-11T19:28:14.5844653Z                                          $failed++
2026-01-11T19:28:14.5844865Z                                      }
2026-01-11T19:28:14.5846074Z                                  }
2026-01-11T19:28:14.5846190Z                              }
2026-01-11T19:28:14.5846486Z                      
2026-01-11T19:28:14.5846851Z                              if ($IncludePeripherals) {
2026-01-11T19:28:14.5847796Z                                  $detectedVendors = Test-HardwarePeripherals
2026-01-11T19:28:14.5848350Z                                  $peripheralInstalled = Install-PeripheralSoftware -Catalog $catalog -DetectedVendors 
2026-01-11T19:28:14.5848471Z                      $detectedVendors
2026-01-11T19:28:14.5848838Z                                  $installed += $peripheralInstalled
2026-01-11T19:28:14.5849148Z                              }
2026-01-11T19:28:14.5849544Z                      
2026-01-11T19:28:14.5850362Z                              Write-Log "Software installation complete: $installed installed, $failed failed" "SUCCESS"
2026-01-11T19:28:14.5850481Z                      
2026-01-11T19:28:14.5851555Z                          } catch {
2026-01-11T19:28:14.5852522Z                              Write-Log "Error during software installation: $_" "ERROR"
2026-01-11T19:28:14.5853035Z                          }
2026-01-11T19:28:14.5853259Z                      }
2026-01-11T19:28:14.5854538Z                      
2026-01-11T19:28:14.5854663Z                      
2026-01-11T19:28:14.5855231Z                      Export-ModuleMember -Function @(
2026-01-11T19:28:14.5855580Z                          'Test-WingetAvailable',
2026-01-11T19:28:14.5856413Z                          'Install-Winget',
2026-01-11T19:28:14.5857275Z                          'Get-SoftwareCatalog',
2026-01-11T19:28:14.5857477Z                          'Test-HardwarePeripherals',
2026-01-11T19:28:14.5857653Z                          'Install-PackageFromCatalog',
2026-01-11T19:28:14.5858376Z                          'Install-PeripheralSoftware',
2026-01-11T19:28:14.5858541Z                          'Invoke-SoftwareInstallation'
2026-01-11T19:28:14.5859179Z                      )
2026-01-11T19:28:14.5859842Z [32;1mCleanBlock         : [0m
2026-01-11T19:28:14.5860215Z [32;1mDynamicParamBlock  : [0m
2026-01-11T19:28:14.5861411Z [32;1mScriptRequirements : [0mSystem.Management.Automation.Language.ScriptRequirements
2026-01-11T19:28:14.5863136Z [32;1mExtent             : [0m<#
2026-01-11T19:28:14.5863257Z                      .SYNOPSIS
2026-01-11T19:28:14.5863799Z                          Software installation helpers based on the catalog definition.
2026-01-11T19:28:14.5864110Z                      .DESCRIPTION
2026-01-11T19:28:14.5865029Z                          Ensures winget availability, loads the software catalog, detects peripherals,
2026-01-11T19:28:14.5865210Z                          and installs packages by category.
2026-01-11T19:28:14.5865393Z                      .NOTES
2026-01-11T19:28:14.5866429Z                          Requires Administrator. Uses winget and may prompt for Store installation.
2026-01-11T19:28:14.5866539Z                      #>
2026-01-11T19:28:14.5866784Z                      #Requires -RunAsAdministrator
2026-01-11T19:28:14.5867390Z                      
2026-01-11T19:28:14.5867660Z                      
2026-01-11T19:28:14.5867976Z                      
2026-01-11T19:28:14.5868883Z                      Import-Module (Join-Path $PSScriptRoot "..\core\logger.psm1") -Force -Global
2026-01-11T19:28:14.5868984Z                      
2026-01-11T19:28:14.5869293Z                      
2026-01-11T19:28:14.5869822Z                      
2026-01-11T19:28:14.5870216Z                      function Test-WingetAvailable {
2026-01-11T19:28:14.5870812Z                          <#
2026-01-11T19:28:14.5870998Z                          .SYNOPSIS
2026-01-11T19:28:14.5871467Z                              Checks whether winget is available.
2026-01-11T19:28:14.5872593Z                          .DESCRIPTION
2026-01-11T19:28:14.5873812Z                              Invokes winget --version and returns success based on exit code.
2026-01-11T19:28:14.5873937Z                          .OUTPUTS
2026-01-11T19:28:14.5874328Z                              [bool] True if winget is callable.
2026-01-11T19:28:14.5874648Z                          #>
2026-01-11T19:28:14.5875065Z                          try {
2026-01-11T19:28:14.5875981Z                              $null = winget --version 2>&1
2026-01-11T19:28:14.5876138Z                              return ($LASTEXITCODE -eq 0)
2026-01-11T19:28:14.5876860Z                          } catch {
2026-01-11T19:28:14.5877032Z                              return $false
2026-01-11T19:28:14.5877903Z                          }
2026-01-11T19:28:14.5878083Z                      }
2026-01-11T19:28:14.5879026Z                      
2026-01-11T19:28:14.5879149Z                      
2026-01-11T19:28:14.5879529Z                      function Install-Winget {
2026-01-11T19:28:14.5880032Z                          <#
2026-01-11T19:28:14.5880423Z                          .SYNOPSIS
2026-01-11T19:28:14.5881363Z                              Attempts to install winget if missing.
2026-01-11T19:28:14.5881653Z                          .DESCRIPTION
2026-01-11T19:28:14.5882015Z                              First attempts to open the Microsoft Store App Installer page, then
2026-01-11T19:28:14.5882403Z                              falls back to downloading the App Installer bundle directly.
2026-01-11T19:28:14.5882509Z                          .OUTPUTS
2026-01-11T19:28:14.5883310Z                              [bool] True if winget is already installed; otherwise false to indicate
2026-01-11T19:28:14.5883582Z                              a restart/install is required.
2026-01-11T19:28:14.5884389Z                          #>
2026-01-11T19:28:14.5885321Z                          Write-Log "Checking for winget..." "INFO"
2026-01-11T19:28:14.5885437Z                      
2026-01-11T19:28:14.5885589Z                          if (Test-WingetAvailable) {
2026-01-11T19:28:14.5886351Z                              $wingetVersion = winget --version 2>&1
2026-01-11T19:28:14.5886756Z                              Write-Log "winget is available: $wingetVersion" "SUCCESS"
2026-01-11T19:28:14.5887060Z                              return $true
2026-01-11T19:28:14.5887573Z                          }
2026-01-11T19:28:14.5888066Z                      
2026-01-11T19:28:14.5888776Z                          Write-Log "winget not found. Attempting to install..." "INFO"
2026-01-11T19:28:14.5889477Z                      
2026-01-11T19:28:14.5889812Z                          Write-Log "Method 1: Installing via Microsoft Store..." "INFO"
2026-01-11T19:28:14.5890434Z                          try {
2026-01-11T19:28:14.5890985Z                              $storeApp = Get-AppxPackage -Name "Microsoft.WindowsStore" -ErrorAction SilentlyContinue
2026-01-11T19:28:14.5891136Z                              if ($storeApp) {
2026-01-11T19:28:14.5891860Z                                  Write-Log "Microsoft Store found, opening App Installer page..." "INFO"
2026-01-11T19:28:14.5892578Z                                  Start-Process "ms-windows-store://pdp/?ProductId=9NBLGGH4NNS1" -ErrorAction 
2026-01-11T19:28:14.5893273Z                      SilentlyContinue
2026-01-11T19:28:14.5894178Z                                  Write-Log "Please install 'App Installer' from Microsoft Store, then restart script" 
2026-01-11T19:28:14.5894291Z                      "ERROR"
2026-01-11T19:28:14.5894753Z                                  return $false
2026-01-11T19:28:14.5895204Z                              } else {
2026-01-11T19:28:14.5896199Z                                  Write-Log "Microsoft Store not available (common on X-Lite builds)" "ERROR"
2026-01-11T19:28:14.5896315Z                              }
2026-01-11T19:28:14.5896559Z                          } catch {
2026-01-11T19:28:14.5897421Z                              Write-Log "Could not open Microsoft Store: $_" "ERROR"
2026-01-11T19:28:14.5897645Z                          }
2026-01-11T19:28:14.5898320Z                      
2026-01-11T19:28:14.5899412Z                          Write-Log "Method 2: Downloading App Installer directly..." "INFO"
2026-01-11T19:28:14.5899534Z                          try {
2026-01-11T19:28:14.5899765Z                              $appInstallerUrl = "https://aka.ms/getwinget"
2026-01-11T19:28:14.5900267Z                              $downloadPath = "$env:TEMP\Microsoft.DesktopAppInstaller.msixbundle"
2026-01-11T19:28:14.5900386Z                      
2026-01-11T19:28:14.5901019Z                              Write-Log "Downloading App Installer from Microsoft..." "INFO"
2026-01-11T19:28:14.5902192Z                              Invoke-WebRequest -Uri $appInstallerUrl -OutFile $downloadPath -UseBasicParsing 
2026-01-11T19:28:14.5902350Z                      -ErrorAction Stop
2026-01-11T19:28:14.5902575Z                      
2026-01-11T19:28:14.5903682Z                              Write-Log "Installing App Installer..." "INFO"
2026-01-11T19:28:14.5903976Z                              Add-AppxPackage -Path $downloadPath -ErrorAction Stop
2026-01-11T19:28:14.5904252Z                      
2026-01-11T19:28:14.5904520Z                              Remove-Item $downloadPath -ErrorAction SilentlyContinue
2026-01-11T19:28:14.5904713Z                      
2026-01-11T19:28:14.5905338Z                              Write-Log "App Installer installed successfully. Please restart PowerShell." "SUCCESS"
2026-01-11T19:28:14.5905482Z                              return $false
2026-01-11T19:28:14.5906192Z                      
2026-01-11T19:28:14.5906386Z                          } catch {
2026-01-11T19:28:14.5907683Z                              Write-Log "Failed to download/install App Installer: $_" "ERROR"
2026-01-11T19:28:14.5908076Z                              Write-Log "Install manually from: https://aka.ms/getwinget" "ERROR"
2026-01-11T19:28:14.5908207Z                              return $false
2026-01-11T19:28:14.5908727Z                          }
2026-01-11T19:28:14.5909308Z                      }
2026-01-11T19:28:14.5910075Z                      
2026-01-11T19:28:14.5910180Z                      
2026-01-11T19:28:14.5910767Z                      
2026-01-11T19:28:14.5911046Z                      
2026-01-11T19:28:14.5911534Z                      function Get-SoftwareCatalog {
2026-01-11T19:28:14.5912445Z                          <#
2026-01-11T19:28:14.5913436Z                          .SYNOPSIS
2026-01-11T19:28:14.5913622Z                              Loads the software catalog JSON.
2026-01-11T19:28:14.5913973Z                          .DESCRIPTION
2026-01-11T19:28:14.5915039Z                              Reads the catalog from the web folder and returns it as a PSCustomObject.
2026-01-11T19:28:14.5915298Z                          .OUTPUTS
2026-01-11T19:28:14.5915944Z                              [PSCustomObject] Catalog data or $null on failure.
2026-01-11T19:28:14.5916247Z                          #>
2026-01-11T19:28:14.5917217Z                          try {
2026-01-11T19:28:14.5917686Z                              $catalogPath = Join-Path $PSScriptRoot "..\..\data\software-catalog.json"
2026-01-11T19:28:14.5917792Z                      
2026-01-11T19:28:14.5918136Z                              if (-not (Test-Path $catalogPath)) {
2026-01-11T19:28:14.5918871Z                                  Write-Log "Software catalog not found: $catalogPath" "ERROR"
2026-01-11T19:28:14.5919027Z                                  return $null
2026-01-11T19:28:14.5919446Z                              }
2026-01-11T19:28:14.5920284Z                      
2026-01-11T19:28:14.5921427Z                              $catalog = Get-Content $catalogPath -Raw | ConvertFrom-Json
2026-01-11T19:28:14.5922038Z                              Write-Log "Loaded software catalog (version $($catalog.version))" "SUCCESS"
2026-01-11T19:28:14.5922509Z                      
2026-01-11T19:28:14.5923264Z                              return $catalog
2026-01-11T19:28:14.5923953Z                          } catch {
2026-01-11T19:28:14.5924437Z                              Write-Log "Error loading software catalog: $_" "ERROR"
2026-01-11T19:28:14.5925233Z                              return $null
2026-01-11T19:28:14.5925451Z                          }
2026-01-11T19:28:14.5926455Z                      }
2026-01-11T19:28:14.5926625Z                      
2026-01-11T19:28:14.5926724Z                      
2026-01-11T19:28:14.5927446Z                      
2026-01-11T19:28:14.5928111Z                      
2026-01-11T19:28:14.5928973Z                      function Test-HardwarePeripherals {
2026-01-11T19:28:14.5929348Z                          <#
2026-01-11T19:28:14.5929495Z                          .SYNOPSIS
2026-01-11T19:28:14.5930434Z                              Detects connected gaming peripherals by vendor ID.
2026-01-11T19:28:14.5930565Z                          .DESCRIPTION
2026-01-11T19:28:14.5932488Z                              Scans HID/USB devices for known VID values and returns vendor names.
2026-01-11T19:28:14.5933943Z                          .OUTPUTS
2026-01-11T19:28:14.5934955Z                              [string[]] Detected vendor names.
2026-01-11T19:28:14.5935926Z                          #>
2026-01-11T19:28:14.5936418Z                          try {
2026-01-11T19:28:14.5937497Z                              Write-Log "Detecting gaming peripheral hardware..." "INFO"
2026-01-11T19:28:14.5937627Z                      
2026-01-11T19:28:14.5939027Z                              $usbDevices = Get-PnpDevice -Class "HIDClass", "USB" -ErrorAction SilentlyContinue |
2026-01-11T19:28:14.5939317Z                                  Where-Object { $_.InstanceId -match "USB\\VID_" }
2026-01-11T19:28:14.5940135Z                      
2026-01-11T19:28:14.5940294Z                              $detectedVendors = @()
2026-01-11T19:28:14.5940750Z                      
2026-01-11T19:28:14.5941596Z                              foreach ($device in $usbDevices) {
2026-01-11T19:28:14.5941872Z                                  if ($device.InstanceId -match "VID_([0-9A-F]{4})") {
2026-01-11T19:28:14.5942396Z                                      $vid = $matches[1]
2026-01-11T19:28:14.5942536Z                      
2026-01-11T19:28:14.5942758Z                                      switch ($vid) {
2026-01-11T19:28:14.5943578Z                                          "046D" {
2026-01-11T19:28:14.5943850Z                                              if ($detectedVendors -notcontains "Logitech") {
2026-01-11T19:28:14.5944187Z                                                  $detectedVendors += "Logitech"
2026-01-11T19:28:14.5945495Z                                                  Write-Log "Detected Logitech peripheral: $($device.FriendlyName)" 
2026-01-11T19:28:14.5945635Z                      "SUCCESS"
2026-01-11T19:28:14.5946080Z                                              }
2026-01-11T19:28:14.5946710Z                                          }
2026-01-11T19:28:14.5946860Z                                          "1532" {
2026-01-11T19:28:14.5947878Z                                              if ($detectedVendors -notcontains "Razer") {
2026-01-11T19:28:14.5948250Z                                                  $detectedVendors += "Razer"
2026-01-11T19:28:14.5949460Z                                                  Write-Log "Detected Razer peripheral: $($device.FriendlyName)" 
2026-01-11T19:28:14.5949607Z                      "SUCCESS"
2026-01-11T19:28:14.5950577Z                                              }
2026-01-11T19:28:14.5950699Z                                          }
2026-01-11T19:28:14.5951385Z                                          "1B1C" {
2026-01-11T19:28:14.5952992Z                                              if ($detectedVendors -notcontains "Corsair") {
2026-01-11T19:28:14.5953384Z                                                  $detectedVendors += "Corsair"
2026-01-11T19:28:14.5954671Z                                                  Write-Log "Detected Corsair peripheral: $($device.FriendlyName)" 
2026-01-11T19:28:14.5954830Z                      "SUCCESS"
2026-01-11T19:28:14.5955319Z                                              }
2026-01-11T19:28:14.5955543Z                                          }
2026-01-11T19:28:14.5956670Z                                      }
2026-01-11T19:28:14.5956783Z                                  }
2026-01-11T19:28:14.5957624Z                              }
2026-01-11T19:28:14.5957802Z                      
2026-01-11T19:28:14.5958249Z                              if ($detectedVendors.Count -eq 0) {
2026-01-11T19:28:14.5959282Z                                  Write-Log "No gaming peripherals detected" "INFO"
2026-01-11T19:28:14.5959401Z                              }
2026-01-11T19:28:14.5959961Z                      
2026-01-11T19:28:14.5960599Z                              return $detectedVendors
2026-01-11T19:28:14.5960777Z                          } catch {
2026-01-11T19:28:14.5961771Z                              Write-Log "Error detecting hardware peripherals: $_" "ERROR"
2026-01-11T19:28:14.5962057Z                              return @()
2026-01-11T19:28:14.5962248Z                          }
2026-01-11T19:28:14.5962595Z                      }
2026-01-11T19:28:14.5963069Z                      
2026-01-11T19:28:14.5964044Z                      
2026-01-11T19:28:14.5964214Z                      
2026-01-11T19:28:14.5964938Z                      
2026-01-11T19:28:14.5965702Z                      function Install-PackageFromCatalog {
2026-01-11T19:28:14.5965824Z                          <#
2026-01-11T19:28:14.5966567Z                          .SYNOPSIS
2026-01-11T19:28:14.5966911Z                              Installs a single package from the catalog using winget.
2026-01-11T19:28:14.5967252Z                          .DESCRIPTION
2026-01-11T19:28:14.5968040Z                              Runs winget install for the given package id, then verifies install
2026-01-11T19:28:14.5968293Z                              status when winget returns a non-zero exit code.
2026-01-11T19:28:14.5968590Z                          .PARAMETER Package
2026-01-11T19:28:14.5969550Z                              Package object from the catalog.
2026-01-11T19:28:14.5969705Z                          .PARAMETER PackageName
2026-01-11T19:28:14.5969884Z                              Catalog key name used for logging.
2026-01-11T19:28:14.5970233Z                          .OUTPUTS
2026-01-11T19:28:14.5971549Z                              [bool] True if installed or already present, else false.
2026-01-11T19:28:14.5971922Z                          #>
2026-01-11T19:28:14.5972038Z                          param(
2026-01-11T19:28:14.5972906Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:14.5973580Z                              [PSCustomObject]$Package,
2026-01-11T19:28:14.5973676Z                      
2026-01-11T19:28:14.5974594Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:14.5974965Z                              [string]$PackageName
2026-01-11T19:28:14.5975792Z                          )
2026-01-11T19:28:14.5975900Z                      
2026-01-11T19:28:14.5976927Z                          try {
2026-01-11T19:28:14.5977179Z                              Write-Log "Installing $($Package.name)..." "INFO"
2026-01-11T19:28:14.5977431Z                      
2026-01-11T19:28:14.5979307Z                              $result = winget install --id $Package.id --source winget --accept-package-agreements 
2026-01-11T19:28:14.5979525Z                      --accept-source-agreements --silent 2>&1
2026-01-11T19:28:14.5979659Z                      
2026-01-11T19:28:14.5980434Z                              if ($LASTEXITCODE -eq 0) {
2026-01-11T19:28:14.5980857Z                                  Write-Log "Installed: $($Package.name)" "SUCCESS"
2026-01-11T19:28:14.5981085Z                                  return $true
2026-01-11T19:28:14.5982436Z                              } else {
2026-01-11T19:28:14.5982814Z                                  $installedCheck = winget list --id $Package.id --source winget 
2026-01-11T19:28:14.5983000Z                      --accept-source-agreements 2>&1
2026-01-11T19:28:14.5983367Z                                  if ($LASTEXITCODE -eq 0 -and $installedCheck -match $Package.id) {
2026-01-11T19:28:14.5983713Z                                      Write-Log "Already installed: $($Package.name)" "SUCCESS"
2026-01-11T19:28:14.5983854Z                                      return $true
2026-01-11T19:28:14.5985037Z                                  } else {
2026-01-11T19:28:14.5985537Z                                      Write-Log "Failed to install $($Package.name) (exit code: $LASTEXITCODE)" "ERROR"
2026-01-11T19:28:14.5985672Z                                      return $false
2026-01-11T19:28:14.5985781Z                                  }
2026-01-11T19:28:14.5986450Z                              }
2026-01-11T19:28:14.5986637Z                          } catch {
2026-01-11T19:28:14.5987181Z                              Write-Log "Error installing $($Package.name): $_" "ERROR"
2026-01-11T19:28:14.5988365Z                              return $false
2026-01-11T19:28:14.5988517Z                          }
2026-01-11T19:28:14.5989315Z                      }
2026-01-11T19:28:14.5989430Z                      
2026-01-11T19:28:14.5990339Z                      
2026-01-11T19:28:14.5991106Z                      function Install-PeripheralSoftware {
2026-01-11T19:28:14.5991499Z                          <#
2026-01-11T19:28:14.5992383Z                          .SYNOPSIS
2026-01-11T19:28:14.5992895Z                              Installs peripheral software based on detected hardware.
2026-01-11T19:28:14.5994074Z                          .DESCRIPTION
2026-01-11T19:28:14.5994828Z                              Compares detected vendor names to the catalog's hardware vendor map
2026-01-11T19:28:14.5996415Z                              and installs matching peripheral packages.
2026-01-11T19:28:14.5997190Z                          .PARAMETER Catalog
2026-01-11T19:28:14.5997896Z                              Catalog object containing package definitions.
2026-01-11T19:28:14.5998895Z                          .PARAMETER DetectedVendors
2026-01-11T19:28:14.5999560Z                              List of detected vendor names.
2026-01-11T19:28:14.6000035Z                          .OUTPUTS
2026-01-11T19:28:14.6000788Z                              [int] Count of installed packages.
2026-01-11T19:28:14.6001237Z                          #>
2026-01-11T19:28:14.6001817Z                          param(
2026-01-11T19:28:14.6002265Z                              [Parameter(Mandatory=$true)]
2026-01-11T19:28:14.6002765Z                              [PSCustomObject]$Catalog,
2026-01-11T19:28:14.6003542Z                      
2026-01-11T19:28:14.6003869Z                              [string[]]$DetectedVendors
2026-01-11T19:28:14.6004262Z                          )
2026-01-11T19:28:14.6004531Z                      
2026-01-11T19:28:14.6004788Z                          $installed = 0
2026-01-11T19:28:14.6005126Z                      
2026-01-11T19:28:14.6005403Z                          try {
2026-01-11T19:28:14.6005928Z                              $peripheralPackages = $Catalog.packages.PSObject.Properties |
2026-01-11T19:28:14.6006648Z                                  Where-Object { $_.Value.category -eq "peripheral" }
2026-01-11T19:28:14.6007168Z                      
2026-01-11T19:28:14.6007559Z                              foreach ($pkg in $peripheralPackages) {
2026-01-11T19:28:14.6008081Z                                  $package = $pkg.Value
2026-01-11T19:28:14.6008546Z                                  $packageName = $pkg.Name
2026-01-11T19:28:14.6008987Z                      
2026-01-11T19:28:14.6009510Z                                  $shouldInstall = $false
2026-01-11T19:28:14.6010328Z                                  foreach ($vendorId in $package.hardware_detection.vendor_ids) {
2026-01-11T19:28:14.6011160Z                                      $vendorName = $Catalog.hardware_vendor_ids.$vendorId
2026-01-11T19:28:14.6012210Z                                      if ($DetectedVendors -contains $vendorName) {
2026-01-11T19:28:14.6012789Z                                          $shouldInstall = $true
2026-01-11T19:28:14.6013251Z                                          break
2026-01-11T19:28:14.6013651Z                                      }
2026-01-11T19:28:14.6013988Z                                  }
2026-01-11T19:28:14.6014292Z                      
2026-01-11T19:28:14.6014597Z                                  if ($shouldInstall) {
2026-01-11T19:28:14.6015409Z                                      if (Install-PackageFromCatalog -Package $package -PackageName $packageName) {
2026-01-11T19:28:14.6016211Z                                          $installed++
2026-01-11T19:28:14.6016597Z                                      }
2026-01-11T19:28:14.6016955Z                                  } else {
2026-01-11T19:28:14.6017729Z                                      Write-Log "Skipping $($package.name) (hardware not detected)" "INFO"
2026-01-11T19:28:14.6018496Z                                  }
2026-01-11T19:28:14.6018826Z                              }
2026-01-11T19:28:14.6019126Z                      
2026-01-11T19:28:14.6019547Z                          } catch {
2026-01-11T19:28:14.6020211Z                              Write-Log "Error installing peripheral software: $_" "ERROR"
2026-01-11T19:28:14.6021320Z                          }
2026-01-11T19:28:14.6021666Z                      
2026-01-11T19:28:14.6021990Z                          return $installed
2026-01-11T19:28:14.6022369Z                      }
2026-01-11T19:28:14.6022649Z                      
2026-01-11T19:28:14.6022906Z                      
2026-01-11T19:28:14.6023363Z                      
2026-01-11T19:28:14.6023756Z                      
2026-01-11T19:28:14.6024243Z                      function Invoke-SoftwareInstallation {
2026-01-11T19:28:14.6024699Z                          <#
2026-01-11T19:28:14.6025019Z                          .SYNOPSIS
2026-01-11T19:28:14.6025517Z                              Installs software packages by category.
2026-01-11T19:28:14.6026011Z                          .DESCRIPTION
2026-01-11T19:28:14.6026664Z                              Ensures winget is available, loads the catalog, installs packages in
2026-01-11T19:28:14.6027555Z                              the requested categories, and optionally includes optional/peripheral
2026-01-11T19:28:14.6028222Z                              packages.
2026-01-11T19:28:14.6028611Z                          .PARAMETER Categories
2026-01-11T19:28:14.6029332Z                              List of catalog categories to install (default: essential, recommended, keep).
2026-01-11T19:28:14.6030083Z                          .PARAMETER IncludeOptional
2026-01-11T19:28:14.6030642Z                              When true, also installs optional category packages.
2026-01-11T19:28:14.6031268Z                          .PARAMETER IncludePeripherals
2026-01-11T19:28:14.6031936Z                              When true, installs peripheral packages based on hardware detection.
2026-01-11T19:28:14.6032969Z                          .OUTPUTS
2026-01-11T19:28:14.6033313Z                              None.
2026-01-11T19:28:14.6033639Z                          #>
2026-01-11T19:28:14.6033944Z                          param(
2026-01-11T19:28:14.6034464Z                              [string[]]$Categories = @("essential", "recommended", "keep"),
2026-01-11T19:28:14.6035148Z                              [bool]$IncludeOptional = $false,
2026-01-11T19:28:14.6035669Z                              [bool]$IncludePeripherals = $true
2026-01-11T19:28:14.6036317Z                          )
2026-01-11T19:28:14.6036633Z                      
2026-01-11T19:28:14.6037591Z                          Write-Log "Starting software installation..." "INFO"
2026-01-11T19:28:14.6038173Z                      
2026-01-11T19:28:14.6038538Z                          if (-not (Test-WingetAvailable)) {
2026-01-11T19:28:14.6039227Z                              Write-Log "winget not available. Attempting to install..." "INFO"
2026-01-11T19:28:14.6039880Z                              if (-not (Install-Winget)) {
2026-01-11T19:28:14.6040658Z                                  Write-Log "winget installation failed. Skipping software installation." "ERROR"
2026-01-11T19:28:14.6041421Z                                  return
2026-01-11T19:28:14.6041780Z                              }
2026-01-11T19:28:14.6042098Z                          }
2026-01-11T19:28:14.6042384Z                      
2026-01-11T19:28:14.6042714Z                          $catalog = Get-SoftwareCatalog
2026-01-11T19:28:14.6043169Z                          if (-not $catalog) {
2026-01-11T19:28:14.6043928Z                              Write-Log "Could not load software catalog. Skipping software installation." "ERROR"
2026-01-11T19:28:14.6044876Z                              return
2026-01-11T19:28:14.6045223Z                          }
2026-01-11T19:28:14.6045654Z                      
2026-01-11T19:28:14.6045938Z                          $installed = 0
2026-01-11T19:28:14.6046320Z                          $failed = 0
2026-01-11T19:28:14.6046662Z                      
2026-01-11T19:28:14.6047008Z                          try {
2026-01-11T19:28:14.6059629Z                              $packagesToInstall = $catalog.packages.PSObject.Properties |
2026-01-11T19:28:14.6060628Z                                  Where-Object { $Categories -contains $_.Value.category }
2026-01-11T19:28:14.6061172Z                      
2026-01-11T19:28:14.6061544Z                              foreach ($pkg in $packagesToInstall) {
2026-01-11T19:28:14.6062029Z                                  $package = $pkg.Value
2026-01-11T19:28:14.6062476Z                                  $packageName = $pkg.Name
2026-01-11T19:28:14.6062929Z                      
2026-01-11T19:28:14.6063715Z                                  if (Install-PackageFromCatalog -Package $package -PackageName $packageName) {
2026-01-11T19:28:14.6064460Z                                      $installed++
2026-01-11T19:28:14.6064845Z                                  } else {
2026-01-11T19:28:14.6065216Z                                      $failed++
2026-01-11T19:28:14.6065582Z                                  }
2026-01-11T19:28:14.6065911Z                              }
2026-01-11T19:28:14.6066223Z                      
2026-01-11T19:28:14.6066518Z                              if ($IncludeOptional) {
2026-01-11T19:28:14.6067133Z                                  $optionalPackages = $catalog.packages.PSObject.Properties |
2026-01-11T19:28:14.6067878Z                                      Where-Object { $_.Value.category -eq "optional" }
2026-01-11T19:28:14.6068394Z                      
2026-01-11T19:28:14.6068747Z                                  foreach ($pkg in $optionalPackages) {
2026-01-11T19:28:14.6069235Z                                      $package = $pkg.Value
2026-01-11T19:28:14.6069706Z                                      $packageName = $pkg.Name
2026-01-11T19:28:14.6070092Z                      
2026-01-11T19:28:14.6070705Z                                      if (Install-PackageFromCatalog -Package $package -PackageName $packageName) {
2026-01-11T19:28:14.6071443Z                                          $installed++
2026-01-11T19:28:14.6072155Z                                      } else {
2026-01-11T19:28:14.6072530Z                                          $failed++
2026-01-11T19:28:14.6072892Z                                      }
2026-01-11T19:28:14.6073205Z                                  }
2026-01-11T19:28:14.6073719Z                              }
2026-01-11T19:28:14.6074030Z                      
2026-01-11T19:28:14.6074463Z                              if ($IncludePeripherals) {
2026-01-11T19:28:14.6074995Z                                  $detectedVendors = Test-HardwarePeripherals
2026-01-11T19:28:14.6075901Z                                  $peripheralInstalled = Install-PeripheralSoftware -Catalog $catalog -DetectedVendors 
2026-01-11T19:28:14.6076780Z                      $detectedVendors
2026-01-11T19:28:14.6077661Z                                  $installed += $peripheralInstalled
2026-01-11T19:28:14.6078094Z                              }
2026-01-11T19:28:14.6078314Z                      
2026-01-11T19:28:14.6078687Z                              Write-Log "Software installation complete: $installed installed, $failed failed" "SUCCESS"
2026-01-11T19:28:14.6079112Z                      
2026-01-11T19:28:14.6079267Z                          } catch {
2026-01-11T19:28:14.6079557Z                              Write-Log "Error during software installation: $_" "ERROR"
2026-01-11T19:28:14.6079860Z                          }
2026-01-11T19:28:14.6080028Z                      }
2026-01-11T19:28:14.6080320Z                      
2026-01-11T19:28:14.6080464Z                      
2026-01-11T19:28:14.6080652Z                      Export-ModuleMember -Function @(
2026-01-11T19:28:14.6080971Z                          'Test-WingetAvailable',
2026-01-11T19:28:14.6081225Z                          'Install-Winget',
2026-01-11T19:28:14.6081456Z                          'Get-SoftwareCatalog',
2026-01-11T19:28:14.6081711Z                          'Test-HardwarePeripherals',
2026-01-11T19:28:14.6081976Z                          'Install-PackageFromCatalog',
2026-01-11T19:28:14.6082249Z                          'Install-PeripheralSoftware',
2026-01-11T19:28:14.6082510Z                          'Invoke-SoftwareInstallation'
2026-01-11T19:28:14.6082733Z                      )
2026-01-11T19:28:14.6082890Z                      
2026-01-11T19:28:14.6083282Z [32;1mParent             : [0m
2026-01-11T19:28:14.6083436Z 
2026-01-11T19:28:14.8635444Z ‚ùå PowerShell syntax errors found:
2026-01-11T19:28:14.8666993Z   benchmark-setup.ps1: An empty pipe element is not allowed. An empty pipe element is not allowed. An empty pipe element is not allowed. An empty pipe element is not allowed. An empty pipe element is not allowed. An empty pipe element is not allowed. An empty pipe element is not allowed. Expressions are only allowed as the first element of a pipeline. Missing file specification after redirection operator. The '<' operator is reserved for future use. An empty pipe element is not allowed. An empty pipe element is not allowed. An empty pipe element is not allowed. An empty pipe element is not allowed. An empty pipe element is not allowed. An empty pipe element is not allowed. An empty pipe element is not allowed. An empty pipe element is not allowed. An empty pipe element is not allowed. An empty pipe element is not allowed. Expressions are only allowed as the first element of a pipeline. Unexpected token 'FIRST' in expression or statement. Missing statement body in do loop. Missing closing '}' in statement block or type definition. Unexpected token ')' in expression or statement. Unexpected token ')' in expression or statement. Unexpected token ')' in expression or statement. The string is missing the terminator: ".
2026-01-11T19:28:14.8677940Z   benchmark.ps1: An empty pipe element is not allowed. An empty pipe element is not allowed. An empty pipe element is not allowed. An empty pipe element is not allowed. An empty pipe element is not allowed. An empty pipe element is not allowed. An empty pipe element is not allowed. Expressions are only allowed as the first element of a pipeline. Missing file specification after redirection operator. The '<' operator is reserved for future use. An empty pipe element is not allowed. An empty pipe element is not allowed. An empty pipe element is not allowed. An empty pipe element is not allowed. An empty pipe element is not allowed. An empty pipe element is not allowed. An empty pipe element is not allowed. An empty pipe element is not allowed. An empty pipe element is not allowed. An empty pipe element is not allowed. Expressions are only allowed as the first element of a pipeline. Unexpected token 'FIRST' in expression or statement. Missing statement body in do loop. Missing closing '}' in statement block or type definition. Unexpected token ')' in expression or statement. Unexpected token ')' in expression or statement. Unexpected token ')' in expression or statement. The string is missing the terminator: ".
2026-01-11T19:28:15.1696732Z ##[error]Process completed with exit code 1.
2026-01-11T19:28:15.1941744Z Post job cleanup.
2026-01-11T19:28:15.4709482Z [command]"C:\Program Files\Git\bin\git.exe" version
2026-01-11T19:28:15.5041457Z git version 2.52.0.windows.1
2026-01-11T19:28:15.5135141Z Temporarily overriding HOME='D:\a\_temp\914bab12-6cee-44da-b7a5-5f932e23b4e9' before making global git config changes
2026-01-11T19:28:15.5136676Z Adding repository directory to the temporary git global config as a safe directory
2026-01-11T19:28:15.5148719Z [command]"C:\Program Files\Git\bin\git.exe" config --global --add safe.directory D:\a\rocktune\rocktune
2026-01-11T19:28:15.5527015Z [command]"C:\Program Files\Git\bin\git.exe" config --local --name-only --get-regexp core\.sshCommand
2026-01-11T19:28:15.5969979Z [command]"C:\Program Files\Git\bin\git.exe" submodule foreach --recursive "sh -c \"git config --local --name-only --get-regexp 'core\.sshCommand' && git config --local --unset-all 'core.sshCommand' || :\""
2026-01-11T19:28:16.2212108Z [command]"C:\Program Files\Git\bin\git.exe" config --local --name-only --get-regexp http\.https\:\/\/github\.com\/\.extraheader
2026-01-11T19:28:16.2550015Z http.https://github.com/.extraheader
2026-01-11T19:28:16.2609479Z [command]"C:\Program Files\Git\bin\git.exe" config --local --unset-all http.https://github.com/.extraheader
2026-01-11T19:28:16.2990088Z [command]"C:\Program Files\Git\bin\git.exe" submodule foreach --recursive "sh -c \"git config --local --name-only --get-regexp 'http\.https\:\/\/github\.com\/\.extraheader' && git config --local --unset-all 'http.https://github.com/.extraheader' || :\""
2026-01-11T19:28:16.8966518Z [command]"C:\Program Files\Git\bin\git.exe" config --local --name-only --get-regexp ^includeIf\.gitdir:
2026-01-11T19:28:16.9292256Z [command]"C:\Program Files\Git\bin\git.exe" submodule foreach --recursive "git config --local --show-origin --name-only --get-regexp remote.origin.url"
2026-01-11T19:28:17.5514356Z Cleaning up orphan processes